let blueRouter={router:function(t){if(this.options={},blueRouter.utils.extend(this.options,blueRouter.defaultOptions,t),this.checkOptions(),this.options.preloadPagesOnLoad){let t=this;void blueRouter.htmlFetcher.loadAllUrls(this,()=>{t.init()})}else this.init()}};blueRouter.router.prototype.init=function(){this.routesMap=this.createRoutesMap(),this.stack=[],this.addEventListenersForWindow(),this.navigateUrl(this.options.updateOnLoad?window.location.href:"",this.options.animateTransitionsOnLoad)},blueRouter.router.prototype.checkOptions=function(){let t=0,e="";this.options.routes||(++t,e+="routes must be defined. "),this.options.eventsByPage||(++t,e+="eventsByPage must be defined. "),t&&this.alertError("Unable to initalize Blue router. "+t+" errors found: "+e)},blueRouter.router.prototype.alertError=function(t){throw alert(t),t},blueRouter.router.prototype.addEventListenersForWindow=function(){window.onpopstate=t=>{this.navigateUrl(window.location.href,!0)}},blueRouter.router.prototype.addEventListenersForLinks=function(t){let o=this;blueRouter.utils.addEventListenerOnList(document.getElementById(t).getElementsByTagName("a"),"click",t=>{var e=t.target.getAttribute("href");e.startsWith(o.options.PAGE_PREFIX)&&(t.preventDefault(),history.pushState({page:e},"page "+e,"#"+e),o.navigateUrl(e,!0))})},blueRouter.router.prototype.createRoutesMap=function(){let e={};return(this.options.routes||[]).map(t=>{e[t.id]=t}),e},blueRouter.router.prototype.getRouteItem=function(t){var e=this.routesMap[t];return e||this.routesMap[this.options.PAGE_ID_404_ERROR]||{id:this.options.PAGE_ID_404_ERROR,content:"<h3>404 - Page not found: "+t+"</h3>"}},blueRouter.router.prototype.navigateUrl=function(t,o){let n=blueRouter.utils.analizeUrl(t,this.options),r=this.updateStack(n.page);if(r!=n.page){t=this.getContentForPage(n.page);let e=this;t instanceof Promise?t.then(function(t){e.getRouteItem(n.page).content=t,e.doPageTransition(t,n.page,r,n,o)}):this.doPageTransition(t,n.page,r,n,o)}},blueRouter.router.prototype.updateStack=function(t){var e;return this.stack[this.stack.length-2]==t?this.stack.pop():(e=this.stack[this.stack.length-1],this.stack.push(t),e)},blueRouter.router.prototype.getContentForPage=function(t){t=this.getRouteItem(t);return this.getContentForRoute(t)},blueRouter.router.prototype.getContentForRoute=function(t){if(t.keepAlive){var e=document.getElementById(t.id);if(e)return e}var e=t.content;return e||((e=t.url)?blueRouter.htmlFetcher.loadUrl(e):'<div id="error">No content found for route from path '+t.id+"</div>")},blueRouter.router.prototype.doPageTransition=function(t,e,o,n,r){var i=r&&!!this.options.animationOut;let u=r&&!!this.options.animationIn,s=t instanceof HTMLElement?blueRouter.defaultOptions.EVENT_REINIT:blueRouter.defaultOptions.EVENT_INIT,a=(this.runEvent(blueRouter.defaultOptions.EVENT_BEFORE_OUT,o,{}),document.getElementsByClassName("currentPage")[0]),l=this.addNextPage(a,t,e),p=(this.runRenderRelated(s,e,n),this),d=()=>{a.removeEventListener("animationend",d),l.classList.remove("hidden"),u&&l.classList.add(this.options.animationIn),this.retireCurrentPage(o,a),p.runEvent(blueRouter.defaultOptions.EVENT_AFTER_OUT,o,{}),u||E()},E=()=>{l.removeEventListener("animationend",E),l.classList.remove("nextPage"),l.classList.add("currentPage"),u&&l.classList.remove(this.options.animationIn),p.runEvent(s,e,n),p.runEvent(blueRouter.defaultOptions.EVENT_MOUNTED,e,n)};i&&a.addEventListener("animationend",d),u&&l.addEventListener("animationend",E),i?a.classList.add(this.options.animationOut):d()},blueRouter.router.prototype.runRenderRelated=function(t,e,o){var n=t===this.options.EVENT_INIT?this.options.EVENT_PRE_INIT:this.options.EVENT_PRE_REINIT,n=(this.runEvent(n,e,o),this.getRouteItem(e)),o=t===this.options.EVENT_INIT?this.options.RUN_RENDER_BEFORE_EVENT_INIT:this.options.RUN_RENDER_BEFORE_EVENT_REINIT,t=t===this.options.EVENT_INIT?"runRenderBeforeInit":"runRenderBeforeReinit";(void 0===n[t]?o:n[t])&&this.options.renderFunction&&blueRouter.utils.isFunction(this.options.renderFunction)&&this.options.renderFunction(this.buildPageInstance(e))},blueRouter.router.prototype.buildPageInstance=function(t){return{id:t,el:document.getElementById(t)}},blueRouter.router.prototype.addNextPage=function(t,e,o){return e instanceof HTMLElement?(t.insertAdjacentElement("afterend",e),e.classList.add("nextPage"),e.classList.add("hidden"),e.classList.remove("alive")):t.insertAdjacentHTML("afterend",'<div class="nextPage hidden page" id="'+o+'">'+e+"</div>"),document.getElementById(o)},blueRouter.router.prototype.retireCurrentPage=function(t,e){t=this.getRouteItem(t);t&&t.keepAlive?(e.removeAttribute("class"),e.classList.add("page"),e.classList.add("alive")):e.remove()},blueRouter.router.prototype.runEvent=function(t,e,o){t==blueRouter.defaultOptions.EVENT_INIT&&this.addEventListenersForLinks(e);e=this.options.eventsByPage[e];e&&(o={params:o.params||{}},e[t])&&blueRouter.utils.isFunction(e[t])&&e[t](o)},blueRouter.defaultOptions={updateOnLoad:!0,preloadPagesOnLoad:!1,animationOut:"slide-out-top",animationIn:"scale-in-center",animateTransitionsOnLoad:!1,PAGE_PREFIX:"!",PAGE_ID_HOME:"[home]",PAGE_ID_404_ERROR:"[404]",EVENT_PRE_INIT:"preInit",EVENT_INIT:"init",EVENT_PRE_REINIT:"preReinit",EVENT_REINIT:"reinit",EVENT_MOUNTED:"mounted",EVENT_BEFORE_OUT:"beforeOut",EVENT_AFTER_OUT:"afterOut",RUN_RENDER_BEFORE_EVENT_INIT:!0,RUN_RENDER_BEFORE_EVENT_REINIT:!1},blueRouter.htmlFetcher={},blueRouter.htmlFetcher.loadAllUrls=function(t,o){t=t.options.routes||[];let n=0;t.map(e=>{var t=e.url;t&&(++n,blueRouter.htmlFetcher.loadUrl(t).then(function(t){e.content=t,0==--n&&o&&blueRouter.utils.isFunction(o)&&o()}))})},blueRouter.htmlFetcher.loadUrl=async function(t){var e=await fetch(t);if(e.ok)return await e.text();throw t=`Error fetching ${t} has occured: `+e.status,alert(t),new Error(t)},blueRouter.utils={},blueRouter.utils.analizeUrl=function(t,e){var o={},t=t.split(e.PAGE_PREFIX),t=(o.prepage=t[0],t[1]||""),t=(o.prepage.endsWith("#")&&(o.prepage=o.prepage.slice(0,-1)),t.split("?")),e=(o.page=t[0],""==o.page&&(o.page=e.PAGE_ID_HOME),t[1]||"");if(o.params={},""!=e){var n=e.split("&");for(let t=0;t<n.length;t++){var r=n[t].split("="),i=r[0];o.params[i]=r[1]}}return o},blueRouter.utils.addEventListenerOnList=function(o,n,r){for(let t=0,e=o.length;t<e;t++)o[t].addEventListener(n,r,!1)},blueRouter.utils.extend=function(t,e,o){t=t||{};for(var n=1;n<arguments.length;n++)if(arguments[n])for(var r in arguments[n])arguments[n].hasOwnProperty(r)&&(t[r]=arguments[n][r]);return t},blueRouter.utils.formatString=function(t){var o=Array.prototype.slice.call(arguments,1);return t.replace(/{(\d+)}/g,function(t,e){return void 0!==o[e]?o[e]:t})},blueRouter.utils.isFunction=function(t){return"function"==typeof t&&"number"!=typeof t.nodeType},"object"==typeof module&&module.exports&&(module.exports=blueRouter);
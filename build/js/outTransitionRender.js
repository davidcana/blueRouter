(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/*! bluerouter - v0.1.0 - 2025-01-16 13:31:28 */
/**
 * A namespace.
 * @const
 */
const blueRouter = {};


/** @constructor */
blueRouter.router = function ( userOptions ) {

    // Init options
    this.options = {};
    blueRouter.utils.extend( this.options, blueRouter.defaultOptions, userOptions );
    this.checkOptions();

    // Preload pages if needed
    if ( this.options.preloadPagesOnLoad ){
        let self = this;
        blueRouter.htmlFetcher.loadAllUrls(
            this,
            () => {
                self.init();
            }
        );
        return;
    }

    // Do not preload pages, run init
    this.init();
};

/* Methods */

/** @suppress {missingProperties} */
blueRouter.router.prototype.init = function() {

    // Init some other vars
    this.routesMap = this.createRoutesMap();
    this.stack = [];

    // Add event listeners
    this.addEventListenersForWindow();

    // Navigate to window.location.href or home
    this.navigateUrl(
        this.options.updateOnLoad? window.location.href: '',
        this.options.animateTransitionsOnLoad
    );
};

// Check that mandatory user defined properties are defined
/** @suppress {missingProperties} */
blueRouter.router.prototype.checkOptions = function() {

    let errors = 0;
    let errorMessages = '';

    if ( ! this.options.routes ){
        ++errors;
        errorMessages += 'routes must be defined. ';
    }

    if ( ! this.options.eventsByPage ){
        ++errors;
        errorMessages += 'eventsByPage must be defined. ';
    }

    if ( errors ){
        this.alertError( 'Unable to initalize Blue router. ' + errors + ' errors found: ' + errorMessages );
    }
};

blueRouter.router.prototype.alertError = function( message ){
    alert( message );
    throw message;
};

blueRouter.router.prototype.addEventListenersForWindow = function() {
    /*
    window.onload = () => {
        this.navigateUrl( this.options.updateOnLoad? window.location.href: '', true );
    }
    */
    window.onpopstate = ( e ) => {
        this.navigateUrl( window.location.href, true );
        //this.navigateUrl( e.state[ 'page' ], true );
    };
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.addEventListenersForLinks = function( pageId ) {
    
    let self = this;

    // Add event listeners for a elements
    blueRouter.utils.addEventListenerOnList(
        //document.getElementsByTagName( 'a' ),
        document.getElementById( pageId ).getElementsByTagName( 'a' ),
        'click', 
        (e) => {
            const href = e.target.getAttribute( 'href' );

            // Follow the link if it is external (if it is marked as external in the class list)
            /*
            if ( e.target.classList.contains ( self.options.externalClass ) ){
                return;
            }
            */
            // Follow the link if it is external (if it does not start by !)
            if ( ! href.startsWith( self.options.PAGE_PREFIX ) ){
                return;
            }

            e.preventDefault();
            history.pushState(
                {
                    'page': href
                },
                'page ' + href,
                '#' + href
            );
            self.navigateUrl( href, true );
        }
    );
};

// Create a map with the data in routes, using the path as the key
blueRouter.router.prototype.createRoutesMap = function() {

    const routerMap = {};
    const routes = this.options.routes || [];

    routes.map( routeItem => {
        routerMap[ routeItem.id ] = routeItem;
    });

    return routerMap;
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.getRouteItem = function( pageId ) {

    // Look for the route
    let routeItem = this.routesMap[ pageId ];
    if ( routeItem ){
        return routeItem;
    }

    // No route found, 404 error
    routeItem = this.routesMap[ this.options.PAGE_ID_404_ERROR ];
    if ( routeItem ){
        return routeItem;
    }

    // No 404 page, build a 404 route
    return {
        id: this.options.PAGE_ID_404_ERROR,
        content: '<h3>404 - Page not found: ' + pageId + '</h3>'
    };
    //this.alertError( 'No route found with id ' + pageId + ' and no 404 page found.' );
};

blueRouter.router.prototype.navigateUrl = function( url, mustAnimateByCode ) {
    //alert( 'navigateUrl\nurl: ' + url );

    // Create an url object to make it easy everything
    let urlObject = blueRouter.utils.analizeUrl( url, this.options );

    // Update stack and get currentPageId
    let currentPageId = this.updateStack( urlObject.page );

    // Exit if trying to navigate to current page
    if ( currentPageId == urlObject.page ){
        return;
    }

    // Get the content
    let content = this.getContentForPage( urlObject.page );
    
    // If content is a Promise wait and resolve it
    let self = this;
    if ( content instanceof Promise ){
        content.then( function( text ){
            // Update content of route
            let routeItem = self.getRouteItem( urlObject.page );
            routeItem.content = text;

            // Run doPageTransition
            self.doPageTransition( text, urlObject.page, currentPageId, urlObject, mustAnimateByCode );
        });
        return;
    }

    // content is NOT a Promise: update current page
    this.doPageTransition( content, urlObject.page, currentPageId, urlObject, mustAnimateByCode );
};

blueRouter.router.prototype.updateStack = function( pageId ) {
    
    // If the penultimate element is the pageId then we are going backwards; otherwise we are going forward
    let isBackward = this.stack[ this.stack.length - 2 ] == pageId;

    if ( isBackward ){
        // Is backward
        return this.stack.pop();
    }

    // Is forward
    var currentPageId = this.stack[ this.stack.length - 1 ];
    this.stack.push( pageId );
    return currentPageId;
};

blueRouter.router.prototype.getContentForPage = function( pageId ) {

    // Get the routeItem from the routesMap
    let routeItem = this.getRouteItem( pageId );

    // Get the content of that route
    return this.getContentForRoute( routeItem );
};

blueRouter.router.prototype.getContentForRoute = function( routeItem ) {
    
    // Check keepAlive
    if ( routeItem.keepAlive ){
        let alivePage = document.getElementById( routeItem.id );
        if ( alivePage ){
            return alivePage;
        }
    }

    // Check content
    let content = routeItem.content;
    if ( content ){
        return content;
    }

    // Check url
    let url = routeItem.url;
    if ( url ){
        return blueRouter.htmlFetcher.loadUrl( url );
    }

    return '<div id="error">No content found for route from path ' + routeItem.id + '</div>';
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.doPageTransition = function( content, nextPageId, currentPageId, urlObject, mustAnimateByCode ) {

    // Get mustAnimateOut and mustAnimateIn
    const mustAnimateOut = mustAnimateByCode && !!this.options.animationOut;
    const mustAnimateIn = mustAnimateByCode && !!this.options.animationIn;

    // Get the initEvent
    const initEvent = content instanceof HTMLElement? blueRouter.defaultOptions.EVENT_REINIT: blueRouter.defaultOptions.EVENT_INIT;

    // Run events
    this.runEvent( blueRouter.defaultOptions.EVENT_BEFORE_OUT, currentPageId, {} );

    // Get the currentPage and add next page
    let currentPage = document.getElementsByClassName( 'currentPage' )[0];
    let newPage = this.addNextPage( currentPage, content, nextPageId );

    // Render next page
    this.runRenderRelated( initEvent, nextPageId, urlObject );

    // Define currentPageAnimationendListener and newPageAnimationendListener
    let self = this;
    let currentPageAnimationendListener = () => {
        currentPage.removeEventListener( 'animationend', currentPageAnimationendListener );
        
        // Remove hidden class, add animationIn class
        newPage.classList.remove( 'hidden' );
        if ( mustAnimateIn ){
            newPage.classList.add( this.options.animationIn );
        }

        // Retire current page: save it as an alive page or remove it
        this.retireCurrentPage( currentPageId, currentPage );
        self.runEvent( blueRouter.defaultOptions.EVENT_AFTER_OUT, currentPageId, {} );

        //  Run newPageAnimationendListener if listener of amimationend on newPage was not added
        if ( ! mustAnimateIn ) {
            newPageAnimationendListener();
        }
    };

    let newPageAnimationendListener = () => {
        newPage.removeEventListener( 'animationend', newPageAnimationendListener );

        // Remove nextPage class, add currentPage class, remove animationIn class
        newPage.classList.remove( 'nextPage' );
        newPage.classList.add( 'currentPage' );
        if ( mustAnimateIn ){
            newPage.classList.remove( this.options.animationIn );
        }

        // Run EVENT_INIT or EVENT_REINIT
        self.runEvent( initEvent, nextPageId, urlObject );

        // Run EVENT_MOUNTED
        self.runEvent( blueRouter.defaultOptions.EVENT_MOUNTED, nextPageId, urlObject );
    };

    // Add event listeners
    if ( mustAnimateOut ){
        currentPage.addEventListener( 'animationend', currentPageAnimationendListener );
    }
    if ( mustAnimateIn ){
        newPage.addEventListener( 'animationend', newPageAnimationendListener );
    }

    // Animate!
    if ( mustAnimateOut ){
        currentPage.classList.add( this.options.animationOut );
    } else {
        currentPageAnimationendListener();
    }
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.runRenderRelated = function( initEvent, nextPageId, urlObject ){

    // Run preEvent (EVENT_PRE_INIT or EVENT_PRE_REINIT)
    const preEvent = initEvent ===  this.options.EVENT_INIT?
        this.options.EVENT_PRE_INIT:
        this.options.EVENT_PRE_REINIT

    this.runEvent( preEvent, nextPageId, urlObject );

    // Run render if needed
    const routeItem = this.getRouteItem( nextPageId );
    const renderOption = initEvent ===  this.options.EVENT_INIT?
        this.options.RUN_RENDER_BEFORE_EVENT_INIT:
        this.options.RUN_RENDER_BEFORE_EVENT_REINIT;
    const routeProperty = initEvent ===  this.options.EVENT_INIT?
        'runRenderBeforeInit':
        'runRenderBeforeReinit';
    const mustRunRender = routeItem[ routeProperty ] === undefined?
        renderOption:
        routeItem[ routeProperty ];

    if ( mustRunRender && this.options.renderFunction && blueRouter.utils.isFunction( this.options.renderFunction ) ){
        this.options.renderFunction(
            this.buildPageInstance( nextPageId )
        );
    }
};

blueRouter.router.prototype.buildPageInstance = function( pageId ){

    return {
         'id': pageId,
         'el': document.getElementById( pageId )
    };
};

blueRouter.router.prototype.addNextPage = function( currentPage, content, nextPageId ){

    if ( content instanceof HTMLElement ){
        // content is HTMLElement
        currentPage.insertAdjacentElement(
            'afterend',
            content
        );
        content.classList.add( 'nextPage' );
        content.classList.add( 'hidden' );
        content.classList.remove( 'alive' );

    } else {
        // content must be text
        currentPage.insertAdjacentHTML(
            'afterend',
            '<div class="nextPage hidden page" id="' + nextPageId + '">'
            + content
            + '</div>'
        );
    }

    return document.getElementById( nextPageId );
};

// Retire current page: save it as an alive page or remove it
blueRouter.router.prototype.retireCurrentPage = function( currentPageId, currentPage ){

    let currentRoute = this.getRouteItem( currentPageId );

    // If must keep alive current page, set page and alive as classes removing the rest
    if ( currentRoute && currentRoute.keepAlive){
        currentPage.removeAttribute( 'class' );
        currentPage.classList.add( 'page' );
        currentPage.classList.add( 'alive' );
        return;
    }

    // Do not keep alive current page, so remove it
    currentPage.remove();
};

blueRouter.router.prototype.runEvent = function( eventId, pageId, urlObject ) {

    if ( eventId == blueRouter.defaultOptions.EVENT_INIT ){
        this.addEventListenersForLinks( pageId );
    }

    // Get the page object from options
    /** @suppress {missingProperties} */
    let page = this.options.eventsByPage[ pageId ];

    // If a page is found, run the event handler
    if ( page ){
        let event = {
            params: urlObject.params || {}
        };
        if ( page[ eventId ] && blueRouter.utils.isFunction( page[ eventId ] ) ){
            page[ eventId ]( event );
        }
    }
};


// Default options

blueRouter.defaultOptions = {
    updateOnLoad: true,
    preloadPagesOnLoad: false,

    // Animations
    animationOut: 'slide-out-top',
    //animationOut: false,
    animationIn: 'scale-in-center',
    //animationIn: false,
    animateTransitionsOnLoad: false,
    
    // Misc
    PAGE_PREFIX: '!',

    // Special pages ids
    PAGE_ID_HOME: '[home]',
    PAGE_ID_404_ERROR: '[404]',

    // Events
    EVENT_PRE_INIT: 'preInit',
    EVENT_INIT: 'init',
    EVENT_PRE_REINIT: 'preReinit',
    EVENT_REINIT: 'reinit',
    EVENT_MOUNTED: 'mounted',
    EVENT_BEFORE_OUT: 'beforeOut',
    EVENT_AFTER_OUT: 'afterOut',

    RUN_RENDER_BEFORE_EVENT_INIT: true,
    RUN_RENDER_BEFORE_EVENT_REINIT: false

};


blueRouter.htmlFetcher = {};

blueRouter.htmlFetcher.loadAllUrls = function( router, callback ){

    // Get the routes to use
    const routes = router.options.routes || [];

    // Init the number ot urls to get
    let pending = 0;

    // Iterate urlRoutes and load each routeItem if needed
    routes.map( routeItem => {
        let url = routeItem.url;
        if ( url ){
            ++pending;
            blueRouter.htmlFetcher.loadUrl( url ).then(
                function( text ){
                    // Update content of route
                    routeItem.content = text;

                    // Run callback when all files have been loaded
                    if ( --pending == 0 && callback && blueRouter.utils.isFunction( callback ) ){
                        callback();
                    }
                }
            );
        }
    });
};

/**
 * @param {string} url
 * 
 */
blueRouter.htmlFetcher.loadUrl = async function( url ){

    const response = await fetch( url );

    if ( ! response.ok ) {
        const message = `Error fetching ${url} has occured: ${response.status}`;
        alert ( message );
        throw new Error( message );
    }
  
    const text = await response.text();
    return text;
};

blueRouter.utils = {};

/*
    Builds an object with data about the url. An example:

    url : http://127.0.0.1:9000/samples/sample.html#!about?param1=a&param2=b"

    prepage: http://127.0.0.1:9000/samples/sample.html
    page: about
    params: {
        param1: a
        param2: b
    }
*/
blueRouter.utils.analizeUrl = function( url, options ) {
    
    let result = {};

    // Extract the parts before and after PAGE_PREFIX
    let urlParts = url.split( options.PAGE_PREFIX );
    result.prepage = urlParts[ 0 ];
    let postPath = urlParts[ 1 ] || '';

    // Remove # if present
    if ( result.prepage.endsWith( '#' ) ){
        result.prepage = result.prepage.slice( 0, -1 );
    }

    // Extract the parts before and after ?
    let pathParts = postPath.split( '?' );
    result.page = pathParts[ 0 ];

    // Fix home page
    if ( result.page == '') {
        result.page = options.PAGE_ID_HOME;
    }

    let paramsString = pathParts[ 1 ] || '';

    // Add params
    result.params = {};
    if ( paramsString == '' ){
        return result;
    }
    let vars = paramsString.split( '&' );
    for ( let i = 0; i < vars.length; i++ ) {
        let pair = vars[ i ].split( '=' );
        let paramName = pair[ 0 ];
        let paramValue = pair[ 1 ];
        result.params[ paramName ] = paramValue;
    }

    return result;
};

blueRouter.utils.addEventListenerOnList = function( list, event, fn ) {

    for ( let i = 0, len = list.length; i < len; i++ ) {
        list[ i ].addEventListener( event, fn, false );
    }
};

blueRouter.utils.extend = function( out, from1, from2 ) {
    out = out || {};

    for ( var i = 1; i < arguments.length; i++ ) {
        if ( ! arguments[ i ] ){
            continue;
        }

        for ( var key in arguments[ i ] ) {
            if ( arguments[ i ].hasOwnProperty( key ) ){
                out[ key ] = arguments[ i ][ key ];
            }
        }
    }

    return out;
};

/* formatString */
// Example: itils.formatString( '{0} is dead, but {1} is alive!', 'ASP', 'ASP.NET' )
/**
 * Takes 1 or more strings and do something cool with them.
 * @param {...string|number} format
 */
blueRouter.utils.formatString = function( format ) {
    
    var args = Array.prototype.slice.call( arguments, 1 );
    return format.replace(/{(\d+)}/g, function ( match, number ) {
        return typeof args[ number ] != 'undefined'? args[ number ] : match;
    });
};

blueRouter.utils.isFunction = function isFunction( obj ) {

    // Support: Chrome <=57, Firefox <=52
    // In some browsers, typeof returns "function" for HTML <object> elements
    // (i.e., `typeof document.createElement( "object" ) === "function"`).
    // We don't want to classify *any* DOM node as a function.
    return typeof obj === "function" && typeof obj.nodeType !== "number";
};
/* end of utils */

// Register blueRouter if we are using Node
if ( typeof module === 'object' && module.exports ) {
    module.exports = blueRouter;
}

},{}],2:[function(require,module,exports){
(function(root, factory) {
  if (typeof define === 'function' && define.amd) {
    define([], factory);
  } else if (typeof exports === 'object') {
    module.exports = factory();
  } else {
    root.loadjs = factory();
  }
}(this, function() {
/**
 * Global dependencies.
 * @global {Object} document - DOM
 */

var devnull = function() {},
    bundleIdCache = {},
    bundleResultCache = {},
    bundleCallbackQueue = {};


/**
 * Subscribe to bundle load event.
 * @param {string[]} bundleIds - Bundle ids
 * @param {Function} callbackFn - The callback function
 */
function subscribe(bundleIds, callbackFn) {
  // listify
  bundleIds = bundleIds.push ? bundleIds : [bundleIds];

  var depsNotFound = [],
      i = bundleIds.length,
      numWaiting = i,
      fn,
      bundleId,
      r,
      q;

  // define callback function
  fn = function (bundleId, pathsNotFound) {
    if (pathsNotFound.length) depsNotFound.push(bundleId);

    numWaiting--;
    if (!numWaiting) callbackFn(depsNotFound);
  };

  // register callback
  while (i--) {
    bundleId = bundleIds[i];

    // execute callback if in result cache
    r = bundleResultCache[bundleId];
    if (r) {
      fn(bundleId, r);
      continue;
    }

    // add to callback queue
    q = bundleCallbackQueue[bundleId] = bundleCallbackQueue[bundleId] || [];
    q.push(fn);
  }
}


/**
 * Publish bundle load event.
 * @param {string} bundleId - Bundle id
 * @param {string[]} pathsNotFound - List of files not found
 */
function publish(bundleId, pathsNotFound) {
  // exit if id isn't defined
  if (!bundleId) return;

  var q = bundleCallbackQueue[bundleId];

  // cache result
  bundleResultCache[bundleId] = pathsNotFound;

  // exit if queue is empty
  if (!q) return;

  // empty callback queue
  while (q.length) {
    q[0](bundleId, pathsNotFound);
    q.splice(0, 1);
  }
}


/**
 * Execute callbacks.
 * @param {Object or Function} args - The callback args
 * @param {string[]} depsNotFound - List of dependencies not found
 */
function executeCallbacks(args, depsNotFound) {
  // accept function as argument
  if (args.call) args = {success: args};

  // success and error callbacks
  if (depsNotFound.length) (args.error || devnull)(depsNotFound);
  else (args.success || devnull)(args);
}


/**
 * Load individual file.
 * @param {string} path - The file path
 * @param {Function} callbackFn - The callback function
 */
function loadFile(path, callbackFn, args, numTries) {
  var doc = document,
      async = args.async,
      maxTries = (args.numRetries || 0) + 1,
      beforeCallbackFn = args.before || devnull,
      pathname = path.replace(/[\?|#].*$/, ''),
      pathStripped = path.replace(/^(css|img|module|nomodule)!/, ''),
      isLegacyIECss,
      hasModuleSupport,
      e;

  numTries = numTries || 0;

  if (/(^css!|\.css$)/.test(pathname)) {
    // css
    e = doc.createElement('link');
    e.rel = 'stylesheet';
    e.href = pathStripped;

    // tag IE9+
    isLegacyIECss = 'hideFocus' in e;

    // use preload in IE Edge (to detect load errors)
    if (isLegacyIECss && e.relList) {
      isLegacyIECss = 0;
      e.rel = 'preload';
      e.as = 'style';
    }
  } else if (/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(pathname)) {
    // image
    e = doc.createElement('img');
    e.src = pathStripped;    
  } else {
    // javascript
    e = doc.createElement('script');
    e.src = pathStripped;
    e.async = async === undefined ? true : async;

    // handle es modules
    // modern browsers:
    //   module: add to dom with type="module"
    //   nomodule: call success() callback without adding to dom
    // legacy browsers:
    //   module: call success() callback without adding to dom
    //   nomodule: add to dom with default type ("text/javascript")
    hasModuleSupport = 'noModule' in e;
    if (/^module!/.test(pathname)) {
      if (!hasModuleSupport) return callbackFn(path, 'l');
      e.type = "module";
    } else if (/^nomodule!/.test(pathname) && hasModuleSupport) return callbackFn(path, 'l');
  }

  e.onload = e.onerror = e.onbeforeload = function (ev) {
    var result = ev.type[0];

    // treat empty stylesheets as failures to get around lack of onerror
    // support in IE9-11
    if (isLegacyIECss) {
      try {
        if (!e.sheet.cssText.length) result = 'e';
      } catch (x) {
        // sheets objects created from load errors don't allow access to
        // `cssText` (unless error is Code:18 SecurityError)
        if (x.code != 18) result = 'e';
      }
    }

    // handle retries in case of load failure
    if (result == 'e') {
      // increment counter
      numTries += 1;

      // exit function and try again
      if (numTries < maxTries) {
        return loadFile(path, callbackFn, args, numTries);
      }
    } else if (e.rel == 'preload' && e.as == 'style') {
      // activate preloaded stylesheets
      return e.rel = 'stylesheet'; // jshint ignore:line
    }
    
    // execute callback
    callbackFn(path, result, ev.defaultPrevented);
  };

  // add to document (unless callback returns `false`)
  if (beforeCallbackFn(path, e) !== false) doc.head.appendChild(e);
}


/**
 * Load multiple files.
 * @param {string[]} paths - The file paths
 * @param {Function} callbackFn - The callback function
 */
function loadFiles(paths, callbackFn, args) {
  // listify paths
  paths = paths.push ? paths : [paths];

  var numWaiting = paths.length,
      x = numWaiting,
      pathsNotFound = [],
      fn,
      i;

  // define callback function
  fn = function(path, result, defaultPrevented) {
    // handle error
    if (result == 'e') pathsNotFound.push(path);

    // handle beforeload event. If defaultPrevented then that means the load
    // will be blocked (ex. Ghostery/ABP on Safari)
    if (result == 'b') {
      if (defaultPrevented) pathsNotFound.push(path);
      else return;
    }

    numWaiting--;
    if (!numWaiting) callbackFn(pathsNotFound);
  };

  // load scripts
  for (i=0; i < x; i++) loadFile(paths[i], fn, args);
}


/**
 * Initiate script load and register bundle.
 * @param {(string|string[])} paths - The file paths
 * @param {(string|Function|Object)} [arg1] - The (1) bundleId or (2) success
 *   callback or (3) object literal with success/error arguments, numRetries,
 *   etc.
 * @param {(Function|Object)} [arg2] - The (1) success callback or (2) object
 *   literal with success/error arguments, numRetries, etc.
 */
function loadjs(paths, arg1, arg2) {
  var bundleId,
      args;

  // bundleId (if string)
  if (arg1 && arg1.trim) bundleId = arg1;

  // args (default is {})
  args = (bundleId ? arg2 : arg1) || {};

  // throw error if bundle is already defined
  if (bundleId) {
    if (bundleId in bundleIdCache) {
      throw "LoadJS";
    } else {
      bundleIdCache[bundleId] = true;
    }
  }

  function loadFn(resolve, reject) {
    loadFiles(paths, function (pathsNotFound) {
      // execute callbacks
      executeCallbacks(args, pathsNotFound);
      
      // resolve Promise
      if (resolve) {
        executeCallbacks({success: resolve, error: reject}, pathsNotFound);
      }

      // publish bundle load event
      publish(bundleId, pathsNotFound);
    }, args);
  }
  
  if (args.returnPromise) return new Promise(loadFn);
  else loadFn();
}


/**
 * Execute callbacks when dependencies have been satisfied.
 * @param {(string|string[])} deps - List of bundle ids
 * @param {Object} args - success/error arguments
 */
loadjs.ready = function ready(deps, args) {
  // subscribe to bundle load event
  subscribe(deps, function (depsNotFound) {
    // execute callbacks
    executeCallbacks(args, depsNotFound);
  });

  return loadjs;
};


/**
 * Manually satisfy bundle dependencies.
 * @param {string} bundleId - The bundle id
 */
loadjs.done = function done(bundleId) {
  publish(bundleId, []);
};


/**
 * Reset loadjs dependencies statuses
 */
loadjs.reset = function reset() {
  bundleIdCache = {};
  bundleResultCache = {};
  bundleCallbackQueue = {};
};


/**
 * Determine if bundle has already been defined
 * @param String} bundleId - The bundle id
 */
loadjs.isDefined = function isDefined(bundleId) {
  return bundleId in bundleIdCache;
};


// export
return loadjs;

}));

},{}],3:[function(require,module,exports){
/**
 * Copyright 2015 Tim Down.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


(function(factory,root){if(typeof define=="function"&&define.amd){define(factory);}else if(typeof module!="undefined"&&typeof exports=="object"){module.exports=factory();}else{root.log4javascript=factory();}})(function(){if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}
return this.length;};}
if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}
this.length=this.length-1;return firstItem;}};}
if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}
var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}
return itemsDeleted;};}
function isUndefined(obj){return typeof obj=="undefined";}
function EventSupport(){}
EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(eventTypesParam){if(eventTypesParam instanceof Array){this.eventTypes=eventTypesParam;this.eventListeners={};for(var i=0,len=this.eventTypes.length;i<len;i++){this.eventListeners[this.eventTypes[i]]=[];}}else{handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array");}},addEventListener:function(eventType,listener){if(typeof listener=="function"){if(!array_contains(this.eventTypes,eventType)){handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+eventType+"'");}
this.eventListeners[eventType].push(listener);}else{handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function");}},removeEventListener:function(eventType,listener){if(typeof listener=="function"){if(!array_contains(this.eventTypes,eventType)){handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+eventType+"'");}
array_remove(this.eventListeners[eventType],listener);}else{handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function");}},dispatchEvent:function(eventType,eventArgs){if(array_contains(this.eventTypes,eventType)){var listeners=this.eventListeners[eventType];for(var i=0,len=listeners.length;i<len;i++){listeners[i](this,eventType,eventArgs);}}else{handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+eventType+"'");}}};var applicationStartDate=new Date();var uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+
Math.floor(Math.random()*100000000);var emptyFunction=function(){};var newLine="\r\n";var pageLoaded=false;function Log4JavaScript(){}
Log4JavaScript.prototype=new EventSupport();var log4javascript=new Log4JavaScript();log4javascript.version="1.4.13";log4javascript.edition="log4javascript";function toStr(obj){if(obj&&obj.toString){return obj.toString();}else{return String(obj);}}
function getExceptionMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}else{return toStr(ex);}}
function getUrlFileName(url){var lastSlashIndex=Math.max(url.lastIndexOf("/"),url.lastIndexOf("\\"));return url.substr(lastSlashIndex+1);}
function getExceptionStringRep(ex){if(ex){var exStr="Exception: "+getExceptionMessage(ex);try{if(ex.lineNumber){exStr+=" on line number "+ex.lineNumber;}
if(ex.fileName){exStr+=" in file "+getUrlFileName(ex.fileName);}}catch(localEx){logLog.warn("Unable to obtain file and line information for error");}
if(showStackTraces&&ex.stack){exStr+=newLine+"Stack trace:"+newLine+ex.stack;}
return exStr;}
return null;}
function bool(obj){return Boolean(obj);}
function trim(str){return str.replace(/^\s+/,"").replace(/\s+$/,"");}
function splitIntoLines(text){var text2=text.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return text2.split("\n");}
var urlEncode=(typeof window.encodeURIComponent!="undefined")?function(str){return encodeURIComponent(str);}:function(str){return escape(str).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D");};function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}
if(index>=0){arr.splice(index,1);return true;}else{return false;}}
function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}
return false;}
function extractBooleanFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{return bool(param);}}
function extractStringFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{return String(param);}}
function extractIntFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{try{var value=parseInt(param,10);return isNaN(value)?defaultValue:value;}catch(ex){logLog.warn("Invalid int param "+param,ex);return defaultValue;}}}
function extractFunctionFromParam(param,defaultValue){if(typeof param=="function"){return param;}else{return defaultValue;}}
function isError(err){return(err instanceof Error);}
if(!Function.prototype.apply){Function.prototype.apply=function(obj,args){var methodName="__apply__";if(typeof obj[methodName]!="undefined"){methodName+=String(Math.random()).substr(2);}
obj[methodName]=this;var argsStrings=[];for(var i=0,len=args.length;i<len;i++){argsStrings[i]="args["+i+"]";}
var script="obj."+methodName+"("+argsStrings.join(",")+")";var returnValue=eval(script);delete obj[methodName];return returnValue;};}
if(!Function.prototype.call){Function.prototype.call=function(obj){var args=[];for(var i=1,len=arguments.length;i<len;i++){args[i-1]=arguments[i];}
return this.apply(obj,args);};}
var logLog={quietMode:false,debugMessages:[],setQuietMode:function(quietMode){this.quietMode=bool(quietMode);},numberOfErrors:0,alertAllErrors:false,setAlertAllErrors:function(alertAllErrors){this.alertAllErrors=alertAllErrors;},debug:function(message){this.debugMessages.push(message);},displayDebug:function(){alert(this.debugMessages.join(newLine));},warn:function(message,exception){},error:function(message,exception){if(++this.numberOfErrors==1||this.alertAllErrors){if(!this.quietMode){var alertMessage="log4javascript error: "+message;if(exception){alertMessage+=newLine+newLine+"Original error: "+getExceptionStringRep(exception);}
alert(alertMessage);}}}};log4javascript.logLog=logLog;log4javascript.setEventTypes(["load","error"]);function handleError(message,exception){logLog.error(message,exception);log4javascript.dispatchEvent("error",{"message":message,"exception":exception});}
log4javascript.handleError=handleError;var enabled=!((typeof log4javascript_disabled!="undefined")&&log4javascript_disabled);log4javascript.setEnabled=function(enable){enabled=bool(enable);};log4javascript.isEnabled=function(){return enabled;};var useTimeStampsInMilliseconds=true;log4javascript.setTimeStampsInMilliseconds=function(timeStampsInMilliseconds){useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds);};log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds;};log4javascript.evalInScope=function(expr){return eval(expr);};var showStackTraces=false;log4javascript.setShowStackTraces=function(show){showStackTraces=bool(show);};var Level=function(level,name){this.level=level;this.name=name;};Level.prototype={toString:function(){return this.name;},equals:function(level){return this.level==level.level;},isGreaterOrEqual:function(level){return this.level>=level.level;}};Level.ALL=new Level(Number.MIN_VALUE,"ALL");Level.TRACE=new Level(10000,"TRACE");Level.DEBUG=new Level(20000,"DEBUG");Level.INFO=new Level(30000,"INFO");Level.WARN=new Level(40000,"WARN");Level.ERROR=new Level(50000,"ERROR");Level.FATAL=new Level(60000,"FATAL");Level.OFF=new Level(Number.MAX_VALUE,"OFF");log4javascript.Level=Level;function Timer(name,level){this.name=name;this.level=isUndefined(level)?Level.INFO:level;this.start=new Date();}
Timer.prototype.getElapsedTime=function(){return new Date().getTime()-this.start.getTime();};var anonymousLoggerName="[anonymous]";var defaultLoggerName="[default]";var nullLoggerName="[null]";var rootLoggerName="root";function Logger(name){this.name=name;this.parent=null;this.children=[];var appenders=[];var loggerLevel=null;var isRoot=(this.name===rootLoggerName);var isNull=(this.name===nullLoggerName);var appenderCache=null;var appenderCacheInvalidated=false;this.addChild=function(childLogger){this.children.push(childLogger);childLogger.parent=this;childLogger.invalidateAppenderCache();};var additive=true;this.getAdditivity=function(){return additive;};this.setAdditivity=function(additivity){var valueChanged=(additive!=additivity);additive=additivity;if(valueChanged){this.invalidateAppenderCache();}};this.addAppender=function(appender){if(isNull){handleError("Logger.addAppender: you may not add an appender to the null logger");}else{if(appender instanceof log4javascript.Appender){if(!array_contains(appenders,appender)){appenders.push(appender);appender.setAddedToLogger(this);this.invalidateAppenderCache();}}else{handleError("Logger.addAppender: appender supplied ('"+
toStr(appender)+"') is not a subclass of Appender");}}};this.removeAppender=function(appender){array_remove(appenders,appender);appender.setRemovedFromLogger(this);this.invalidateAppenderCache();};this.removeAllAppenders=function(){var appenderCount=appenders.length;if(appenderCount>0){for(var i=0;i<appenderCount;i++){appenders[i].setRemovedFromLogger(this);}
appenders.length=0;this.invalidateAppenderCache();}};this.getEffectiveAppenders=function(){if(appenderCache===null||appenderCacheInvalidated){var parentEffectiveAppenders=(isRoot||!this.getAdditivity())?[]:this.parent.getEffectiveAppenders();appenderCache=parentEffectiveAppenders.concat(appenders);appenderCacheInvalidated=false;}
return appenderCache;};this.invalidateAppenderCache=function(){appenderCacheInvalidated=true;for(var i=0,len=this.children.length;i<len;i++){this.children[i].invalidateAppenderCache();}};this.log=function(level,params){if(enabled&&level.isGreaterOrEqual(this.getEffectiveLevel())){var exception;var finalParamIndex=params.length-1;var lastParam=params[finalParamIndex];if(params.length>1&&isError(lastParam)){exception=lastParam;finalParamIndex--;}
var messages=[];for(var i=0;i<=finalParamIndex;i++){messages[i]=params[i];}
var loggingEvent=new LoggingEvent(this,new Date(),level,messages,exception);this.callAppenders(loggingEvent);}};this.callAppenders=function(loggingEvent){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].doAppend(loggingEvent);}};this.setLevel=function(level){if(isRoot&&level===null){handleError("Logger.setLevel: you cannot set the level of the root logger to null");}else if(level instanceof Level){loggerLevel=level;}else{handleError("Logger.setLevel: level supplied to logger "+
this.name+" is not an instance of log4javascript.Level");}};this.getLevel=function(){return loggerLevel;};this.getEffectiveLevel=function(){for(var logger=this;logger!==null;logger=logger.parent){var level=logger.getLevel();if(level!==null){return level;}}};this.group=function(name,initiallyExpanded){if(enabled){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].group(name,initiallyExpanded);}}};this.groupEnd=function(){if(enabled){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].groupEnd();}}};var timers={};this.time=function(name,level){if(enabled){if(isUndefined(name)){handleError("Logger.time: a name for the timer must be supplied");}else if(level&&!(level instanceof Level)){handleError("Logger.time: level supplied to timer "+
name+" is not an instance of log4javascript.Level");}else{timers[name]=new Timer(name,level);}}};this.timeEnd=function(name){if(enabled){if(isUndefined(name)){handleError("Logger.timeEnd: a name for the timer must be supplied");}else if(timers[name]){var timer=timers[name];var milliseconds=timer.getElapsedTime();this.log(timer.level,["Timer "+toStr(name)+" completed in "+milliseconds+"ms"]);delete timers[name];}else{logLog.warn("Logger.timeEnd: no timer found with name "+name);}}};this.assert=function(expr){if(enabled&&!expr){var args=[];for(var i=1,len=arguments.length;i<len;i++){args.push(arguments[i]);}
args=(args.length>0)?args:["Assertion Failure"];args.push(newLine);args.push(expr);this.log(Level.ERROR,args);}};this.toString=function(){return"Logger["+this.name+"]";};}
Logger.prototype={trace:function(){this.log(Level.TRACE,arguments);},debug:function(){this.log(Level.DEBUG,arguments);},info:function(){this.log(Level.INFO,arguments);},warn:function(){this.log(Level.WARN,arguments);},error:function(){this.log(Level.ERROR,arguments);},fatal:function(){this.log(Level.FATAL,arguments);},isEnabledFor:function(level){return level.isGreaterOrEqual(this.getEffectiveLevel());},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE);},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG);},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO);},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN);},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR);},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL);}};Logger.prototype.trace.isEntryPoint=true;Logger.prototype.debug.isEntryPoint=true;Logger.prototype.info.isEntryPoint=true;Logger.prototype.warn.isEntryPoint=true;Logger.prototype.error.isEntryPoint=true;Logger.prototype.fatal.isEntryPoint=true;var loggers={};var loggerNames=[];var ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG;var rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL);log4javascript.getRootLogger=function(){return rootLogger;};log4javascript.getLogger=function(loggerName){if(typeof loggerName!="string"){loggerName=anonymousLoggerName;logLog.warn("log4javascript.getLogger: non-string logger name "+
toStr(loggerName)+" supplied, returning anonymous logger");}
if(loggerName==rootLoggerName){handleError("log4javascript.getLogger: root logger may not be obtained by name");}
if(!loggers[loggerName]){var logger=new Logger(loggerName);loggers[loggerName]=logger;loggerNames.push(loggerName);var lastDotIndex=loggerName.lastIndexOf(".");var parentLogger;if(lastDotIndex>-1){var parentLoggerName=loggerName.substring(0,lastDotIndex);parentLogger=log4javascript.getLogger(parentLoggerName);}else{parentLogger=rootLogger;}
parentLogger.addChild(logger);}
return loggers[loggerName];};var defaultLogger=null;log4javascript.getDefaultLogger=function(){if(!defaultLogger){defaultLogger=createDefaultLogger();}
return defaultLogger;};var nullLogger=null;log4javascript.getNullLogger=function(){if(!nullLogger){nullLogger=new Logger(nullLoggerName);nullLogger.setLevel(Level.OFF);}
return nullLogger;};log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL);loggers={};};var LoggingEvent=function(logger,timeStamp,level,messages,exception){this.logger=logger;this.timeStamp=timeStamp;this.timeStampInMilliseconds=timeStamp.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1000);this.milliseconds=this.timeStamp.getMilliseconds();this.level=level;this.messages=messages;this.exception=exception;};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):"";},getCombinedMessages:function(){return(this.messages.length==1)?this.messages[0]:this.messages.join(newLine);},toString:function(){return"LoggingEvent["+this.level+"]";}};log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:false,overrideTimeStampsSetting:false,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method");},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method");},getContentType:function(){return"text/plain";},allowBatching:function(){return true;},setTimeStampsInMilliseconds:function(timeStampsInMilliseconds){this.overrideTimeStampsSetting=true;this.useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds);},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds;},getTimeStampValue:function(loggingEvent){return this.isTimeStampsInMilliseconds()?loggingEvent.timeStampInMilliseconds:loggingEvent.timeStampInSeconds;},getDataValues:function(loggingEvent,combineMessages){var dataValues=[[this.loggerKey,loggingEvent.logger.name],[this.timeStampKey,this.getTimeStampValue(loggingEvent)],[this.levelKey,loggingEvent.level.name],[this.urlKey,window.location.href],[this.messageKey,combineMessages?loggingEvent.getCombinedMessages():loggingEvent.messages]];if(!this.isTimeStampsInMilliseconds()){dataValues.push([this.millisecondsKey,loggingEvent.milliseconds]);}
if(loggingEvent.exception){dataValues.push([this.exceptionKey,getExceptionStringRep(loggingEvent.exception)]);}
if(this.hasCustomFields()){for(var i=0,len=this.customFields.length;i<len;i++){var val=this.customFields[i].value;if(typeof val==="function"){val=val(this,loggingEvent);}
dataValues.push([this.customFields[i].name,val]);}}
return dataValues;},setKeys:function(loggerKey,timeStampKey,levelKey,messageKey,exceptionKey,urlKey,millisecondsKey){this.loggerKey=extractStringFromParam(loggerKey,this.defaults.loggerKey);this.timeStampKey=extractStringFromParam(timeStampKey,this.defaults.timeStampKey);this.levelKey=extractStringFromParam(levelKey,this.defaults.levelKey);this.messageKey=extractStringFromParam(messageKey,this.defaults.messageKey);this.exceptionKey=extractStringFromParam(exceptionKey,this.defaults.exceptionKey);this.urlKey=extractStringFromParam(urlKey,this.defaults.urlKey);this.millisecondsKey=extractStringFromParam(millisecondsKey,this.defaults.millisecondsKey);},setCustomField:function(name,value){var fieldUpdated=false;for(var i=0,len=this.customFields.length;i<len;i++){if(this.customFields[i].name===name){this.customFields[i].value=value;fieldUpdated=true;}}
if(!fieldUpdated){this.customFields.push({"name":name,"value":value});}},hasCustomFields:function(){return(this.customFields.length>0);},formatWithException:function(loggingEvent){var formatted=this.format(loggingEvent);if(loggingEvent.exception&&this.ignoresThrowable()){formatted+=loggingEvent.getThrowableStrRep();}
return formatted;},toString:function(){handleError("Layout.toString: all layouts must override this method");}};log4javascript.Layout=Layout;var Appender=function(){};Appender.prototype=new EventSupport();Appender.prototype.layout=new PatternLayout();Appender.prototype.threshold=Level.ALL;Appender.prototype.loggers=[];Appender.prototype.doAppend=function(loggingEvent){if(enabled&&loggingEvent.level.level>=this.threshold.level){this.append(loggingEvent);}};Appender.prototype.append=function(loggingEvent){};Appender.prototype.setLayout=function(layout){if(layout instanceof Layout){this.layout=layout;}else{handleError("Appender.setLayout: layout supplied to "+
this.toString()+" is not a subclass of Layout");}};Appender.prototype.getLayout=function(){return this.layout;};Appender.prototype.setThreshold=function(threshold){if(threshold instanceof Level){this.threshold=threshold;}else{handleError("Appender.setThreshold: threshold supplied to "+
this.toString()+" is not a subclass of Level");}};Appender.prototype.getThreshold=function(){return this.threshold;};Appender.prototype.setAddedToLogger=function(logger){this.loggers.push(logger);};Appender.prototype.setRemovedFromLogger=function(logger){array_remove(this.loggers,logger);};Appender.prototype.group=emptyFunction;Appender.prototype.groupEnd=emptyFunction;Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method");};log4javascript.Appender=Appender;function SimpleLayout(){this.customFields=[];}
SimpleLayout.prototype=new Layout();SimpleLayout.prototype.format=function(loggingEvent){return loggingEvent.level.name+" - "+loggingEvent.getCombinedMessages();};SimpleLayout.prototype.ignoresThrowable=function(){return true;};SimpleLayout.prototype.toString=function(){return"SimpleLayout";};log4javascript.SimpleLayout=SimpleLayout;function NullLayout(){this.customFields=[];}
NullLayout.prototype=new Layout();NullLayout.prototype.format=function(loggingEvent){return loggingEvent.messages;};NullLayout.prototype.ignoresThrowable=function(){return true;};NullLayout.prototype.formatWithException=function(loggingEvent){var messages=loggingEvent.messages,ex=loggingEvent.exception;return ex?messages.concat([ex]):messages;};NullLayout.prototype.toString=function(){return"NullLayout";};log4javascript.NullLayout=NullLayout;function XmlLayout(combineMessages){this.combineMessages=extractBooleanFromParam(combineMessages,true);this.customFields=[];}
XmlLayout.prototype=new Layout();XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages;};XmlLayout.prototype.getContentType=function(){return"text/xml";};XmlLayout.prototype.escapeCdata=function(str){return str.replace(/\]\]>/,"]]>]]&gt;<![CDATA[");};XmlLayout.prototype.format=function(loggingEvent){var layout=this;var i,len;function formatMessage(message){message=(typeof message==="string")?message:toStr(message);return"<log4javascript:message><![CDATA["+
layout.escapeCdata(message)+"]]></log4javascript:message>";}
var str="<log4javascript:event logger=\""+loggingEvent.logger.name+"\" timestamp=\""+this.getTimeStampValue(loggingEvent)+"\"";if(!this.isTimeStampsInMilliseconds()){str+=" milliseconds=\""+loggingEvent.milliseconds+"\"";}
str+=" level=\""+loggingEvent.level.name+"\">"+newLine;if(this.combineMessages){str+=formatMessage(loggingEvent.getCombinedMessages());}else{str+="<log4javascript:messages>"+newLine;for(i=0,len=loggingEvent.messages.length;i<len;i++){str+=formatMessage(loggingEvent.messages[i])+newLine;}
str+="</log4javascript:messages>"+newLine;}
if(this.hasCustomFields()){for(i=0,len=this.customFields.length;i<len;i++){str+="<log4javascript:customfield name=\""+
this.customFields[i].name+"\"><![CDATA["+
this.customFields[i].value.toString()+"]]></log4javascript:customfield>"+newLine;}}
if(loggingEvent.exception){str+="<log4javascript:exception><![CDATA["+
getExceptionStringRep(loggingEvent.exception)+"]]></log4javascript:exception>"+newLine;}
str+="</log4javascript:event>"+newLine+newLine;return str;};XmlLayout.prototype.ignoresThrowable=function(){return false;};XmlLayout.prototype.toString=function(){return"XmlLayout";};log4javascript.XmlLayout=XmlLayout;function escapeNewLines(str){return str.replace(/\r\n|\r|\n/g,"\\r\\n");}
function JsonLayout(readable,combineMessages){this.readable=extractBooleanFromParam(readable,false);this.combineMessages=extractBooleanFromParam(combineMessages,true);this.batchHeader=this.readable?"["+newLine:"[";this.batchFooter=this.readable?"]"+newLine:"]";this.batchSeparator=this.readable?","+newLine:",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?newLine:"";this.customFields=[];}
JsonLayout.prototype=new Layout();JsonLayout.prototype.isReadable=function(){return this.readable;};JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages;};JsonLayout.prototype.format=function(loggingEvent){var layout=this;var dataValues=this.getDataValues(loggingEvent,this.combineMessages);var str="{"+this.lineBreak;var i,len;function formatValue(val,prefix,expand){var formattedValue;var valType=typeof val;if(val instanceof Date){formattedValue=String(val.getTime());}else if(expand&&(val instanceof Array)){formattedValue="["+layout.lineBreak;for(var i=0,len=val.length;i<len;i++){var childPrefix=prefix+layout.tab;formattedValue+=childPrefix+formatValue(val[i],childPrefix,false);if(i<val.length-1){formattedValue+=",";}
formattedValue+=layout.lineBreak;}
formattedValue+=prefix+"]";}else if(valType!=="number"&&valType!=="boolean"){formattedValue="\""+escapeNewLines(toStr(val).replace(/\"/g,"\\\""))+"\"";}else{formattedValue=val;}
return formattedValue;}
for(i=0,len=dataValues.length-1;i<=len;i++){str+=this.tab+"\""+dataValues[i][0]+"\""+this.colon+formatValue(dataValues[i][1],this.tab,true);if(i<len){str+=",";}
str+=this.lineBreak;}
str+="}"+this.lineBreak;return str;};JsonLayout.prototype.ignoresThrowable=function(){return false;};JsonLayout.prototype.toString=function(){return"JsonLayout";};JsonLayout.prototype.getContentType=function(){return"application/json";};log4javascript.JsonLayout=JsonLayout;function HttpPostDataLayout(){this.setKeys();this.customFields=[];this.returnsPostData=true;}
HttpPostDataLayout.prototype=new Layout();HttpPostDataLayout.prototype.allowBatching=function(){return false;};HttpPostDataLayout.prototype.format=function(loggingEvent){var dataValues=this.getDataValues(loggingEvent);var queryBits=[];for(var i=0,len=dataValues.length;i<len;i++){var val=(dataValues[i][1]instanceof Date)?String(dataValues[i][1].getTime()):dataValues[i][1];queryBits.push(urlEncode(dataValues[i][0])+"="+urlEncode(val));}
return queryBits.join("&");};HttpPostDataLayout.prototype.ignoresThrowable=function(loggingEvent){return false;};HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout";};log4javascript.HttpPostDataLayout=HttpPostDataLayout;function formatObjectExpansion(obj,depth,indentation){var objectsExpanded=[];function doFormat(obj,depth,indentation){var i,len,childDepth,childIndentation,childLines,expansion,childExpansion;if(!indentation){indentation="";}
function formatString(text){var lines=splitIntoLines(text);for(var j=1,jLen=lines.length;j<jLen;j++){lines[j]=indentation+lines[j];}
return lines.join(newLine);}
if(obj===null){return"null";}else if(typeof obj=="undefined"){return"undefined";}else if(typeof obj=="string"){return formatString(obj);}else if(typeof obj=="object"&&array_contains(objectsExpanded,obj)){try{expansion=toStr(obj);}catch(ex){expansion="Error formatting property. Details: "+getExceptionStringRep(ex);}
return expansion+" [already expanded]";}else if((obj instanceof Array)&&depth>0){objectsExpanded.push(obj);expansion="["+newLine;childDepth=depth-1;childIndentation=indentation+"  ";childLines=[];for(i=0,len=obj.length;i<len;i++){try{childExpansion=doFormat(obj[i],childDepth,childIndentation);childLines.push(childIndentation+childExpansion);}catch(ex){childLines.push(childIndentation+"Error formatting array member. Details: "+
getExceptionStringRep(ex)+"");}}
expansion+=childLines.join(","+newLine)+newLine+indentation+"]";return expansion;}else if(Object.prototype.toString.call(obj)=="[object Date]"){return obj.toString();}else if(typeof obj=="object"&&depth>0){objectsExpanded.push(obj);expansion="{"+newLine;childDepth=depth-1;childIndentation=indentation+"  ";childLines=[];for(i in obj){try{childExpansion=doFormat(obj[i],childDepth,childIndentation);childLines.push(childIndentation+i+": "+childExpansion);}catch(ex){childLines.push(childIndentation+i+": Error formatting property. Details: "+
getExceptionStringRep(ex));}}
expansion+=childLines.join(","+newLine)+newLine+indentation+"}";return expansion;}else{return formatString(toStr(obj));}}
return doFormat(obj,depth,indentation);}
var SimpleDateFormat;(function(){var regex=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/;var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var TEXT2=0,TEXT3=1,NUMBER=2,YEAR=3,MONTH=4,TIMEZONE=5;var types={G:TEXT2,y:YEAR,M:MONTH,w:NUMBER,W:NUMBER,D:NUMBER,d:NUMBER,F:NUMBER,E:TEXT3,a:TEXT2,H:NUMBER,k:NUMBER,K:NUMBER,h:NUMBER,m:NUMBER,s:NUMBER,S:NUMBER,Z:TIMEZONE};var ONE_DAY=24*60*60*1000;var ONE_WEEK=7*ONE_DAY;var DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK=1;var newDateAtMidnight=function(year,month,day){var d=new Date(year,month,day,0,0,0);d.setMilliseconds(0);return d;};Date.prototype.getDifference=function(date){return this.getTime()-date.getTime();};Date.prototype.isBefore=function(d){return this.getTime()<d.getTime();};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds());};Date.prototype.getTimeSince=function(d){return this.getUTCTime()-d.getUTCTime();};Date.prototype.getPreviousSunday=function(){var midday=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0);var previousSunday=new Date(midday.getTime()-this.getDay()*ONE_DAY);return newDateAtMidnight(previousSunday.getFullYear(),previousSunday.getMonth(),previousSunday.getDate());};Date.prototype.getWeekInYear=function(minimalDaysInFirstWeek){if(isUndefined(this.minimalDaysInFirstWeek)){minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK;}
var previousSunday=this.getPreviousSunday();var startOfYear=newDateAtMidnight(this.getFullYear(),0,1);var numberOfSundays=previousSunday.isBefore(startOfYear)?0:1+Math.floor(previousSunday.getTimeSince(startOfYear)/ONE_WEEK);var numberOfDaysInFirstWeek=7-startOfYear.getDay();var weekInYear=numberOfSundays;if(numberOfDaysInFirstWeek<minimalDaysInFirstWeek){weekInYear--;}
return weekInYear;};Date.prototype.getWeekInMonth=function(minimalDaysInFirstWeek){if(isUndefined(this.minimalDaysInFirstWeek)){minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK;}
var previousSunday=this.getPreviousSunday();var startOfMonth=newDateAtMidnight(this.getFullYear(),this.getMonth(),1);var numberOfSundays=previousSunday.isBefore(startOfMonth)?0:1+Math.floor(previousSunday.getTimeSince(startOfMonth)/ONE_WEEK);var numberOfDaysInFirstWeek=7-startOfMonth.getDay();var weekInMonth=numberOfSundays;if(numberOfDaysInFirstWeek>=minimalDaysInFirstWeek){weekInMonth++;}
return weekInMonth;};Date.prototype.getDayInYear=function(){var startOfYear=newDateAtMidnight(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(startOfYear)/ONE_DAY);};SimpleDateFormat=function(formatString){this.formatString=formatString;};SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(days){this.minimalDaysInFirstWeek=days;};SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK:this.minimalDaysInFirstWeek;};var padWithZeroes=function(str,len){while(str.length<len){str="0"+str;}
return str;};var formatText=function(data,numberOfLetters,minLength){return(numberOfLetters>=4)?data:data.substr(0,Math.max(minLength,numberOfLetters));};var formatNumber=function(data,numberOfLetters){var dataString=""+data;return padWithZeroes(dataString,numberOfLetters);};SimpleDateFormat.prototype.format=function(date){var formattedString="";var result;var searchString=this.formatString;while((result=regex.exec(searchString))){var quotedString=result[1];var patternLetters=result[2];var otherLetters=result[3];var otherCharacters=result[4];if(quotedString){if(quotedString=="''"){formattedString+="'";}else{formattedString+=quotedString.substring(1,quotedString.length-1);}}else if(otherLetters){}else if(otherCharacters){formattedString+=otherCharacters;}else if(patternLetters){var patternLetter=patternLetters.charAt(0);var numberOfLetters=patternLetters.length;var rawData="";switch(patternLetter){case"G":rawData="AD";break;case"y":rawData=date.getFullYear();break;case"M":rawData=date.getMonth();break;case"w":rawData=date.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":rawData=date.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":rawData=date.getDayInYear();break;case"d":rawData=date.getDate();break;case"F":rawData=1+Math.floor((date.getDate()-1)/7);break;case"E":rawData=dayNames[date.getDay()];break;case"a":rawData=(date.getHours()>=12)?"PM":"AM";break;case"H":rawData=date.getHours();break;case"k":rawData=date.getHours()||24;break;case"K":rawData=date.getHours()%12;break;case"h":rawData=(date.getHours()%12)||12;break;case"m":rawData=date.getMinutes();break;case"s":rawData=date.getSeconds();break;case"S":rawData=date.getMilliseconds();break;case"Z":rawData=date.getTimezoneOffset();break;}
switch(types[patternLetter]){case TEXT2:formattedString+=formatText(rawData,numberOfLetters,2);break;case TEXT3:formattedString+=formatText(rawData,numberOfLetters,3);break;case NUMBER:formattedString+=formatNumber(rawData,numberOfLetters);break;case YEAR:if(numberOfLetters<=3){var dataString=""+rawData;formattedString+=dataString.substr(2,2);}else{formattedString+=formatNumber(rawData,numberOfLetters);}
break;case MONTH:if(numberOfLetters>=3){formattedString+=formatText(monthNames[rawData],numberOfLetters,numberOfLetters);}else{formattedString+=formatNumber(rawData+1,numberOfLetters);}
break;case TIMEZONE:var isPositive=(rawData>0);var prefix=isPositive?"-":"+";var absData=Math.abs(rawData);var hours=""+Math.floor(absData/60);hours=padWithZeroes(hours,2);var minutes=""+(absData%60);minutes=padWithZeroes(minutes,2);formattedString+=prefix+hours+minutes;break;}}
searchString=searchString.substr(result.index+result[0].length);}
return formattedString;};})();log4javascript.SimpleDateFormat=SimpleDateFormat;function PatternLayout(pattern){if(pattern){this.pattern=pattern;}else{this.pattern=PatternLayout.DEFAULT_CONVERSION_PATTERN;}
this.customFields=[];}
PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n";PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";PatternLayout.prototype=new Layout();PatternLayout.prototype.format=function(loggingEvent){var regex=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/;var formattedString="";var result;var searchString=this.pattern;while((result=regex.exec(searchString))){var matchedString=result[0];var padding=result[1];var truncation=result[2];var conversionCharacter=result[3];var specifier=result[5];var text=result[6];if(text){formattedString+=""+text;}else{var replacement="";switch(conversionCharacter){case"a":case"m":var depth=0;if(specifier){depth=parseInt(specifier,10);if(isNaN(depth)){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character '"+conversionCharacter+"' - should be a number");depth=0;}}
var messages=(conversionCharacter==="a")?loggingEvent.messages[0]:loggingEvent.messages;for(var i=0,len=messages.length;i<len;i++){if(i>0&&(replacement.charAt(replacement.length-1)!==" ")){replacement+=" ";}
if(depth===0){replacement+=messages[i];}else{replacement+=formatObjectExpansion(messages[i],depth);}}
break;case"c":var loggerName=loggingEvent.logger.name;if(specifier){var precision=parseInt(specifier,10);var loggerNameBits=loggingEvent.logger.name.split(".");if(precision>=loggerNameBits.length){replacement=loggerName;}else{replacement=loggerNameBits.slice(loggerNameBits.length-precision).join(".");}}else{replacement=loggerName;}
break;case"d":var dateFormat=PatternLayout.ISO8601_DATEFORMAT;if(specifier){dateFormat=specifier;if(dateFormat=="ISO8601"){dateFormat=PatternLayout.ISO8601_DATEFORMAT;}else if(dateFormat=="ABSOLUTE"){dateFormat=PatternLayout.ABSOLUTETIME_DATEFORMAT;}else if(dateFormat=="DATE"){dateFormat=PatternLayout.DATETIME_DATEFORMAT;}}
replacement=(new SimpleDateFormat(dateFormat)).format(loggingEvent.timeStamp);break;case"f":if(this.hasCustomFields()){var fieldIndex=0;if(specifier){fieldIndex=parseInt(specifier,10);if(isNaN(fieldIndex)){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - should be a number");}else if(fieldIndex===0){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - must be greater than zero");}else if(fieldIndex>this.customFields.length){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - there aren't that many custom fields");}else{fieldIndex=fieldIndex-1;}}
var val=this.customFields[fieldIndex].value;if(typeof val=="function"){val=val(this,loggingEvent);}
replacement=val;}
break;case"n":replacement=newLine;break;case"p":replacement=loggingEvent.level.name;break;case"r":replacement=""+loggingEvent.timeStamp.getDifference(applicationStartDate);break;case"%":replacement="%";break;default:replacement=matchedString;break;}
var l;if(truncation){l=parseInt(truncation.substr(1),10);var strLen=replacement.length;if(l<strLen){replacement=replacement.substring(strLen-l,strLen);}}
if(padding){if(padding.charAt(0)=="-"){l=parseInt(padding.substr(1),10);while(replacement.length<l){replacement+=" ";}}else{l=parseInt(padding,10);while(replacement.length<l){replacement=" "+replacement;}}}
formattedString+=replacement;}
searchString=searchString.substr(result.index+result[0].length);}
return formattedString;};PatternLayout.prototype.ignoresThrowable=function(){return true;};PatternLayout.prototype.toString=function(){return"PatternLayout";};log4javascript.PatternLayout=PatternLayout;function AlertAppender(){}
AlertAppender.prototype=new Appender();AlertAppender.prototype.layout=new SimpleLayout();AlertAppender.prototype.append=function(loggingEvent){alert(this.getLayout().formatWithException(loggingEvent));};AlertAppender.prototype.toString=function(){return"AlertAppender";};log4javascript.AlertAppender=AlertAppender;function BrowserConsoleAppender(){}
BrowserConsoleAppender.prototype=new log4javascript.Appender();BrowserConsoleAppender.prototype.layout=new NullLayout();BrowserConsoleAppender.prototype.threshold=Level.DEBUG;BrowserConsoleAppender.prototype.append=function(loggingEvent){var appender=this;var getFormattedMessage=function(concatenate){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);return(typeof formattedMessage=="string")?(concatenate?formattedMessage:[formattedMessage]):(concatenate?formattedMessage.join(" "):formattedMessage);};var console=window.console;if(console&&console.log){var consoleMethodName;if(console.debug&&Level.DEBUG.isGreaterOrEqual(loggingEvent.level)){consoleMethodName="debug";}else if(console.info&&Level.INFO.equals(loggingEvent.level)){consoleMethodName="info";}else if(console.warn&&Level.WARN.equals(loggingEvent.level)){consoleMethodName="warn";}else if(console.error&&loggingEvent.level.isGreaterOrEqual(Level.ERROR)){consoleMethodName="error";}else{consoleMethodName="log";}
if(typeof console[consoleMethodName].apply=="function"){console[consoleMethodName].apply(console,getFormattedMessage(false));}else{console[consoleMethodName](getFormattedMessage(true));}}else if((typeof opera!="undefined")&&opera.postError){opera.postError(getFormattedMessage(true));}};BrowserConsoleAppender.prototype.group=function(name){if(window.console&&window.console.group){window.console.group(name);}};BrowserConsoleAppender.prototype.groupEnd=function(){if(window.console&&window.console.groupEnd){window.console.groupEnd();}};BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender";};log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xhrFactory=function(){return new XMLHttpRequest();};var xmlHttpFactories=[xhrFactory,function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];var withCredentialsSupported=false;var getXmlHttp=function(errorHandler){var xmlHttp=null,factory;for(var i=0,len=xmlHttpFactories.length;i<len;i++){factory=xmlHttpFactories[i];try{xmlHttp=factory();withCredentialsSupported=(factory==xhrFactory&&("withCredentials"in xmlHttp));getXmlHttp=factory;return xmlHttp;}catch(e){}}
if(errorHandler){errorHandler();}else{handleError("getXmlHttp: unable to obtain XMLHttpRequest object");}};function isHttpRequestSuccessful(xmlHttp){return isUndefined(xmlHttp.status)||xmlHttp.status===0||(xmlHttp.status>=200&&xmlHttp.status<300)||xmlHttp.status==1223;}
function AjaxAppender(url,withCredentials){var appender=this;var isSupported=true;if(!url){handleError("AjaxAppender: URL must be specified in constructor");isSupported=false;}
var timed=this.defaults.timed;var waitForResponse=this.defaults.waitForResponse;var batchSize=this.defaults.batchSize;var timerInterval=this.defaults.timerInterval;var requestSuccessCallback=this.defaults.requestSuccessCallback;var failCallback=this.defaults.failCallback;var postVarName=this.defaults.postVarName;var sendAllOnUnload=this.defaults.sendAllOnUnload;var contentType=this.defaults.contentType;var sessionId=null;var queuedLoggingEvents=[];var queuedRequests=[];var headers=[];var sending=false;var initialized=false;function checkCanConfigure(configOptionName){if(initialized){handleError("AjaxAppender: configuration option '"+
configOptionName+"' may not be set after the appender has been initialized");return false;}
return true;}
this.getSessionId=function(){return sessionId;};this.setSessionId=function(sessionIdParam){sessionId=extractStringFromParam(sessionIdParam,null);this.layout.setCustomField("sessionid",sessionId);};this.setLayout=function(layoutParam){if(checkCanConfigure("layout")){this.layout=layoutParam;if(sessionId!==null){this.setSessionId(sessionId);}}};this.isTimed=function(){return timed;};this.setTimed=function(timedParam){if(checkCanConfigure("timed")){timed=bool(timedParam);}};this.getTimerInterval=function(){return timerInterval;};this.setTimerInterval=function(timerIntervalParam){if(checkCanConfigure("timerInterval")){timerInterval=extractIntFromParam(timerIntervalParam,timerInterval);}};this.isWaitForResponse=function(){return waitForResponse;};this.setWaitForResponse=function(waitForResponseParam){if(checkCanConfigure("waitForResponse")){waitForResponse=bool(waitForResponseParam);}};this.getBatchSize=function(){return batchSize;};this.setBatchSize=function(batchSizeParam){if(checkCanConfigure("batchSize")){batchSize=extractIntFromParam(batchSizeParam,batchSize);}};this.isSendAllOnUnload=function(){return sendAllOnUnload;};this.setSendAllOnUnload=function(sendAllOnUnloadParam){if(checkCanConfigure("sendAllOnUnload")){sendAllOnUnload=extractBooleanFromParam(sendAllOnUnloadParam,sendAllOnUnload);}};this.setRequestSuccessCallback=function(requestSuccessCallbackParam){requestSuccessCallback=extractFunctionFromParam(requestSuccessCallbackParam,requestSuccessCallback);};this.setFailCallback=function(failCallbackParam){failCallback=extractFunctionFromParam(failCallbackParam,failCallback);};this.getPostVarName=function(){return postVarName;};this.setPostVarName=function(postVarNameParam){if(checkCanConfigure("postVarName")){postVarName=extractStringFromParam(postVarNameParam,postVarName);}};this.getHeaders=function(){return headers;};this.addHeader=function(name,value){if(name.toLowerCase()=="content-type"){contentType=value;}else{headers.push({name:name,value:value});}};function sendAll(){if(isSupported&&enabled){sending=true;var currentRequestBatch;if(waitForResponse){if(queuedRequests.length>0){currentRequestBatch=queuedRequests.shift();sendRequest(preparePostData(currentRequestBatch),sendAll);}else{sending=false;if(timed){scheduleSending();}}}else{while((currentRequestBatch=queuedRequests.shift())){sendRequest(preparePostData(currentRequestBatch));}
sending=false;if(timed){scheduleSending();}}}}
this.sendAll=sendAll;function sendAllRemaining(){var sendingAnything=false;if(isSupported&&enabled){var actualBatchSize=appender.getLayout().allowBatching()?batchSize:1;var currentLoggingEvent;var batchedLoggingEvents=[];while((currentLoggingEvent=queuedLoggingEvents.shift())){batchedLoggingEvents.push(currentLoggingEvent);if(queuedLoggingEvents.length>=actualBatchSize){queuedRequests.push(batchedLoggingEvents);batchedLoggingEvents=[];}}
if(batchedLoggingEvents.length>0){queuedRequests.push(batchedLoggingEvents);}
sendingAnything=(queuedRequests.length>0);waitForResponse=false;timed=false;sendAll();}
return sendingAnything;}
this.sendAllRemaining=sendAllRemaining;function preparePostData(batchedLoggingEvents){var formattedMessages=[];var currentLoggingEvent;var postData="";while((currentLoggingEvent=batchedLoggingEvents.shift())){formattedMessages.push(appender.getLayout().formatWithException(currentLoggingEvent));}
if(batchedLoggingEvents.length==1){postData=formattedMessages.join("");}else{postData=appender.getLayout().batchHeader+
formattedMessages.join(appender.getLayout().batchSeparator)+
appender.getLayout().batchFooter;}
if(contentType==appender.defaults.contentType){postData=appender.getLayout().returnsPostData?postData:urlEncode(postVarName)+"="+urlEncode(postData);if(postData.length>0){postData+="&";}
postData+="layout="+urlEncode(appender.getLayout().toString());}
return postData;}
function scheduleSending(){window.setTimeout(sendAll,timerInterval);}
function xmlHttpErrorHandler(){var msg="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(msg);isSupported=false;if(failCallback){failCallback(msg);}}
function sendRequest(postData,successCallback){try{var xmlHttp=getXmlHttp(xmlHttpErrorHandler);if(isSupported){xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState==4){if(isHttpRequestSuccessful(xmlHttp)){if(requestSuccessCallback){requestSuccessCallback(xmlHttp);}
if(successCallback){successCallback(xmlHttp);}}else{var msg="AjaxAppender.append: XMLHttpRequest request to URL "+
url+" returned status code "+xmlHttp.status;handleError(msg);if(failCallback){failCallback(msg);}}
xmlHttp.onreadystatechange=emptyFunction;xmlHttp=null;}};xmlHttp.open("POST",url,true);if(withCredentials&&withCredentialsSupported){xmlHttp.withCredentials=true;}
try{for(var i=0,header;header=headers[i++];){xmlHttp.setRequestHeader(header.name,header.value);}
xmlHttp.setRequestHeader("Content-Type",contentType);}catch(headerEx){var msg="AjaxAppender.append: your browser's XMLHttpRequest implementation"+" does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";handleError(msg);isSupported=false;if(failCallback){failCallback(msg);}
return;}
xmlHttp.send(postData);}}catch(ex){var errMsg="AjaxAppender.append: error sending log message to "+url;handleError(errMsg,ex);isSupported=false;if(failCallback){failCallback(errMsg+". Details: "+getExceptionStringRep(ex));}}}
this.append=function(loggingEvent){if(isSupported){if(!initialized){init();}
queuedLoggingEvents.push(loggingEvent);var actualBatchSize=this.getLayout().allowBatching()?batchSize:1;if(queuedLoggingEvents.length>=actualBatchSize){var currentLoggingEvent;var batchedLoggingEvents=[];while((currentLoggingEvent=queuedLoggingEvents.shift())){batchedLoggingEvents.push(currentLoggingEvent);}
queuedRequests.push(batchedLoggingEvents);if(!timed&&(!waitForResponse||(waitForResponse&&!sending))){sendAll();}}}};function init(){initialized=true;if(sendAllOnUnload){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){if(oldBeforeUnload){oldBeforeUnload();}
sendAllRemaining();};}
if(timed){scheduleSending();}}}
AjaxAppender.prototype=new Appender();AjaxAppender.prototype.defaults={waitForResponse:false,timed:false,timerInterval:1000,batchSize:1,sendAllOnUnload:false,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};AjaxAppender.prototype.layout=new HttpPostDataLayout();AjaxAppender.prototype.toString=function(){return"AjaxAppender";};log4javascript.AjaxAppender=AjaxAppender;function setCookie(name,value,days,path){var expires;path=path?"; path="+path:"";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}else{expires="";}
document.cookie=escape(name)+"="+escape(value)+expires+path;}
function getCookie(name){var nameEquals=escape(name)+"=";var ca=document.cookie.split(";");for(var i=0,len=ca.length;i<len;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length);}
if(c.indexOf(nameEquals)===0){return unescape(c.substring(nameEquals.length,c.length));}}
return null;}
function getBaseUrl(){var scripts=document.getElementsByTagName("script");for(var i=0,len=scripts.length;i<len;++i){if(scripts[i].src.indexOf("log4javascript")!=-1){var lastSlash=scripts[i].src.lastIndexOf("/");return(lastSlash==-1)?"":scripts[i].src.substr(0,lastSlash+1);}}
return null;}
function isLoaded(win){try{return bool(win.loaded);}catch(ex){return false;}}
var ConsoleAppender;(function(){var getConsoleHtmlLines=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">','<head>','<title>log4javascript</title>','<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />','<!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->','<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;</script>','<!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','<!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','<script type="text/javascript">','//<![CDATA[','var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}','function LogItem(){}','LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}','this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}','this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}','if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}','if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}','LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}','SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}','Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}','GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}','replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}','while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}','Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}','this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}','this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}','this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}','this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}','if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}','LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}','LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}','LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}','LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}','LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}','for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}','this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}','return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}','LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}','GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}','logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}','break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}','break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}','break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}','appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}','function setLoggingEnabled(enable){loggingEnabled=enable;}','var appender=null;function setAppender(appenderParam){appender=appenderParam;}','function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}','var newestAtTop=false;function LogItemContentReverser(){}','LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}','matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}','currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}','$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}','var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}','$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}','var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}','var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}','var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}','function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}','return items;}','function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}','loggingEnabled=loggingReallyEnabled;}','function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}','logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}','function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}','if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}','displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}','if(scrollToLatest){doScrollToLatest();}','unrenderedLogItemsExist=false;}','function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}','var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}','logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}','return false;}','function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}','logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}','function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}','function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}','function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}','function hide(){if(appender&&mainWindowExists()){appender.hide();}}','var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}','function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}','function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}','return false;}','var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}','function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}','function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}','updateSearchFromFilters();}','function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}','function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}','function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}','function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}','refreshCurrentMatch();}','var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}','searchTimer=setTimeout(doSearch,500);}','function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}','Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}','return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}','return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}','for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}','return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}','for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}','return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\\"searchterm\\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\\"pre\\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+','preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+','matchedText+searchTermReplacementEndTag;}','startIndex=endTokenIndex+endToken.length;}','logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+','this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+','preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+','matchedText+searchTermReplacementEndTag;}','startIndex=searchIndex+searchTermLength;}','var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}','logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}','return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}','var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}','for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}','if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}','setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}','return y;}','function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}','var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}','function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}','this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}','Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}','currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}','addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}','setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}','function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}','var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}','function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}','function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}','function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}','if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}','setLogContainerHeight();}','function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','refreshCurrentMatch();}','function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}','function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}','function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}','function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}','function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}','return false;}','function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}','function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}','function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}','return matches;}','function $(id){return document.getElementById(id);}','function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}','node=node.parentNode;}','return false;}','function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}','currentNode=currentNode.parentNode;}','return true;}','function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}','function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}','return 0;}','function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}','return 0;}','function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}','return height;}','function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-','($("evaluateButton").offsetWidth+13))+"px";}}','window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}','return this.length;};}','if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}','if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}','this.length=this.length-1;return firstItem;}};}','if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}','var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}','return itemsDeleted;};}','function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}','if(index>=0){arr.splice(index,1);return index;}else{return false;}}','function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}','array.length=array.length-numberToRemove;}','return array;}','function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}','return false;}','function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}','return""+ex;}','function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}','input.focus();}','function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}','function getEvent(evt){return evt?evt:event;}','function getTarget(evt){return evt.target?evt.target:evt.srcElement;}','function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}','function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}','function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}','function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}','var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}','if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}','currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}','//]]>','</script>','<style type="text/css">','body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}','</style>','</head>','<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">','Filters:','<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>','</div>','<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>','</div>','</div>','<div id="options" class="toolbar">','Options:','<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />','</div>','</div>','</div>','<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />','</div>','</div>','</body>','</html>',''];};var defaultCommandLineFunctions=[];ConsoleAppender=function(){};var consoleAppenderIdCounter=1;ConsoleAppender.prototype=new Appender();ConsoleAppender.prototype.create=function(inPage,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,focusConsoleWindow){var appender=this;var initialized=false;var consoleWindowCreated=false;var consoleWindowLoaded=false;var consoleClosed=false;var queuedLoggingEvents=[];var isSupported=true;var consoleAppenderId=consoleAppenderIdCounter++;initiallyMinimized=extractBooleanFromParam(initiallyMinimized,this.defaults.initiallyMinimized);lazyInit=extractBooleanFromParam(lazyInit,this.defaults.lazyInit);useDocumentWrite=extractBooleanFromParam(useDocumentWrite,this.defaults.useDocumentWrite);var newestMessageAtTop=this.defaults.newestMessageAtTop;var scrollToLatestMessage=this.defaults.scrollToLatestMessage;width=width?width:this.defaults.width;height=height?height:this.defaults.height;var maxMessages=this.defaults.maxMessages;var showCommandLine=this.defaults.showCommandLine;var commandLineObjectExpansionDepth=this.defaults.commandLineObjectExpansionDepth;var showHideButton=this.defaults.showHideButton;var showCloseButton=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var init,createWindow,safeToAppend,getConsoleWindow,open;var appenderName=inPage?"InPageAppender":"PopUpAppender";var checkCanConfigure=function(configOptionName){if(consoleWindowCreated){handleError(appenderName+": configuration option '"+configOptionName+"' may not be set after the appender has been initialized");return false;}
return true;};var consoleWindowExists=function(){return(consoleWindowLoaded&&isSupported&&!consoleClosed);};this.isNewestMessageAtTop=function(){return newestMessageAtTop;};this.setNewestMessageAtTop=function(newestMessageAtTopParam){newestMessageAtTop=bool(newestMessageAtTopParam);if(consoleWindowExists()){getConsoleWindow().setNewestAtTop(newestMessageAtTop);}};this.isScrollToLatestMessage=function(){return scrollToLatestMessage;};this.setScrollToLatestMessage=function(scrollToLatestMessageParam){scrollToLatestMessage=bool(scrollToLatestMessageParam);if(consoleWindowExists()){getConsoleWindow().setScrollToLatest(scrollToLatestMessage);}};this.getWidth=function(){return width;};this.setWidth=function(widthParam){if(checkCanConfigure("width")){width=extractStringFromParam(widthParam,width);}};this.getHeight=function(){return height;};this.setHeight=function(heightParam){if(checkCanConfigure("height")){height=extractStringFromParam(heightParam,height);}};this.getMaxMessages=function(){return maxMessages;};this.setMaxMessages=function(maxMessagesParam){maxMessages=extractIntFromParam(maxMessagesParam,maxMessages);if(consoleWindowExists()){getConsoleWindow().setMaxMessages(maxMessages);}};this.isShowCommandLine=function(){return showCommandLine;};this.setShowCommandLine=function(showCommandLineParam){showCommandLine=bool(showCommandLineParam);if(consoleWindowExists()){getConsoleWindow().setShowCommandLine(showCommandLine);}};this.isShowHideButton=function(){return showHideButton;};this.setShowHideButton=function(showHideButtonParam){showHideButton=bool(showHideButtonParam);if(consoleWindowExists()){getConsoleWindow().setShowHideButton(showHideButton);}};this.isShowCloseButton=function(){return showCloseButton;};this.setShowCloseButton=function(showCloseButtonParam){showCloseButton=bool(showCloseButtonParam);if(consoleWindowExists()){getConsoleWindow().setShowCloseButton(showCloseButton);}};this.getCommandLineObjectExpansionDepth=function(){return commandLineObjectExpansionDepth;};this.setCommandLineObjectExpansionDepth=function(commandLineObjectExpansionDepthParam){commandLineObjectExpansionDepth=extractIntFromParam(commandLineObjectExpansionDepthParam,commandLineObjectExpansionDepth);};var minimized=initiallyMinimized;this.isInitiallyMinimized=function(){return initiallyMinimized;};this.setInitiallyMinimized=function(initiallyMinimizedParam){if(checkCanConfigure("initiallyMinimized")){initiallyMinimized=bool(initiallyMinimizedParam);minimized=initiallyMinimized;}};this.isUseDocumentWrite=function(){return useDocumentWrite;};this.setUseDocumentWrite=function(useDocumentWriteParam){if(checkCanConfigure("useDocumentWrite")){useDocumentWrite=bool(useDocumentWriteParam);}};function QueuedLoggingEvent(loggingEvent,formattedMessage){this.loggingEvent=loggingEvent;this.levelName=loggingEvent.level.name;this.formattedMessage=formattedMessage;}
QueuedLoggingEvent.prototype.append=function(){getConsoleWindow().log(this.levelName,this.formattedMessage);};function QueuedGroup(name,initiallyExpanded){this.name=name;this.initiallyExpanded=initiallyExpanded;}
QueuedGroup.prototype.append=function(){getConsoleWindow().group(this.name,this.initiallyExpanded);};function QueuedGroupEnd(){}
QueuedGroupEnd.prototype.append=function(){getConsoleWindow().groupEnd();};var checkAndAppend=function(){safeToAppend();if(!initialized){init();}else if(consoleClosed&&reopenWhenClosed){createWindow();}
if(safeToAppend()){appendQueuedLoggingEvents();}};this.append=function(loggingEvent){if(isSupported){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);queuedLoggingEvents.push(new QueuedLoggingEvent(loggingEvent,formattedMessage));checkAndAppend();}};this.group=function(name,initiallyExpanded){if(isSupported){queuedLoggingEvents.push(new QueuedGroup(name,initiallyExpanded));checkAndAppend();}};this.groupEnd=function(){if(isSupported){queuedLoggingEvents.push(new QueuedGroupEnd());checkAndAppend();}};var appendQueuedLoggingEvents=function(){while(queuedLoggingEvents.length>0){queuedLoggingEvents.shift().append();}
if(focusConsoleWindow){getConsoleWindow().focus();}};this.setAddedToLogger=function(logger){this.loggers.push(logger);if(enabled&&!lazyInit){init();}};this.clear=function(){if(consoleWindowExists()){getConsoleWindow().clearLog();}
queuedLoggingEvents.length=0;};this.focus=function(){if(consoleWindowExists()){getConsoleWindow().focus();}};this.focusCommandLine=function(){if(consoleWindowExists()){getConsoleWindow().focusCommandLine();}};this.focusSearch=function(){if(consoleWindowExists()){getConsoleWindow().focusSearch();}};var commandWindow=window;this.getCommandWindow=function(){return commandWindow;};this.setCommandWindow=function(commandWindowParam){commandWindow=commandWindowParam;};this.executeLastCommand=function(){if(consoleWindowExists()){getConsoleWindow().evalLastCommand();}};var commandLayout=new PatternLayout("%m");this.getCommandLayout=function(){return commandLayout;};this.setCommandLayout=function(commandLayoutParam){commandLayout=commandLayoutParam;};this.evalCommandAndAppend=function(expr){var commandReturnValue={appendResult:true,isError:false};var commandOutput="";try{var result,i;if(!commandWindow.eval&&commandWindow.execScript){commandWindow.execScript("null");}
var commandLineFunctionsHash={};for(i=0,len=commandLineFunctions.length;i<len;i++){commandLineFunctionsHash[commandLineFunctions[i][0]]=commandLineFunctions[i][1];}
var objectsToRestore=[];var addObjectToRestore=function(name){objectsToRestore.push([name,commandWindow[name]]);};addObjectToRestore("appender");commandWindow.appender=appender;addObjectToRestore("commandReturnValue");commandWindow.commandReturnValue=commandReturnValue;addObjectToRestore("commandLineFunctionsHash");commandWindow.commandLineFunctionsHash=commandLineFunctionsHash;var addFunctionToWindow=function(name){addObjectToRestore(name);commandWindow[name]=function(){return this.commandLineFunctionsHash[name](appender,arguments,commandReturnValue);};};for(i=0,len=commandLineFunctions.length;i<len;i++){addFunctionToWindow(commandLineFunctions[i][0]);}
if(commandWindow===window&&commandWindow.execScript){addObjectToRestore("evalExpr");addObjectToRestore("result");window.evalExpr=expr;commandWindow.execScript("window.result=eval(window.evalExpr);");result=window.result;}else{result=commandWindow.eval(expr);}
commandOutput=isUndefined(result)?result:formatObjectExpansion(result,commandLineObjectExpansionDepth);for(i=0,len=objectsToRestore.length;i<len;i++){commandWindow[objectsToRestore[i][0]]=objectsToRestore[i][1];}}catch(ex){commandOutput="Error evaluating command: "+getExceptionStringRep(ex);commandReturnValue.isError=true;}
if(commandReturnValue.appendResult){var message=">>> "+expr;if(!isUndefined(commandOutput)){message+=newLine+commandOutput;}
var level=commandReturnValue.isError?Level.ERROR:Level.INFO;var loggingEvent=new LoggingEvent(null,new Date(),level,[message],null);var mainLayout=this.getLayout();this.setLayout(commandLayout);this.append(loggingEvent);this.setLayout(mainLayout);}};var commandLineFunctions=defaultCommandLineFunctions.concat([]);this.addCommandLineFunction=function(functionName,commandLineFunction){commandLineFunctions.push([functionName,commandLineFunction]);};var commandHistoryCookieName="log4javascriptCommandHistory";this.storeCommandHistory=function(commandHistory){setCookie(commandHistoryCookieName,commandHistory.join(","));};var writeHtml=function(doc){var lines=getConsoleHtmlLines();doc.open();for(var i=0,len=lines.length;i<len;i++){doc.writeln(lines[i]);}
doc.close();};this.setEventTypes(["load","unload"]);var consoleWindowLoadHandler=function(){var win=getConsoleWindow();win.setAppender(appender);win.setNewestAtTop(newestMessageAtTop);win.setScrollToLatest(scrollToLatestMessage);win.setMaxMessages(maxMessages);win.setShowCommandLine(showCommandLine);win.setShowHideButton(showHideButton);win.setShowCloseButton(showCloseButton);win.setMainWindow(window);var storedValue=getCookie(commandHistoryCookieName);if(storedValue){win.commandHistory=storedValue.split(",");win.currentCommandIndex=win.commandHistory.length;}
appender.dispatchEvent("load",{"win":win});};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller);if(!consoleClosed){logLog.debug("really doing unload "+this);consoleClosed=true;consoleWindowLoaded=false;consoleWindowCreated=false;appender.dispatchEvent("unload",{});}};var pollConsoleWindow=function(windowTest,interval,successCallback,errorMessage){function doPoll(){try{if(consoleClosed){clearInterval(poll);}
if(windowTest(getConsoleWindow())){clearInterval(poll);successCallback();}}catch(ex){clearInterval(poll);isSupported=false;handleError(errorMessage,ex);}}
var poll=setInterval(doPoll,interval);};var getConsoleUrl=function(){var documentDomainSet=(document.domain!=location.hostname);return useDocumentWrite?"":getBaseUrl()+"console.html"+
(documentDomainSet?"?log4javascript_domain="+escape(document.domain):"");};if(inPage){var containerElement=null;var cssProperties=[];this.addCssProperty=function(name,value){if(checkCanConfigure("cssProperties")){cssProperties.push([name,value]);}};var windowCreationStarted=false;var iframeContainerDiv;var iframeId=uniqueId+"_InPageAppender_"+consoleAppenderId;this.hide=function(){if(initialized&&consoleWindowCreated){if(consoleWindowExists()){getConsoleWindow().$("command").blur();}
iframeContainerDiv.style.display="none";minimized=true;}};this.show=function(){if(initialized){if(consoleWindowCreated){iframeContainerDiv.style.display="block";this.setShowCommandLine(showCommandLine);minimized=false;}else if(!windowCreationStarted){createWindow(true);}}};this.isVisible=function(){return!minimized&&!consoleClosed;};this.close=function(fromButton){if(!consoleClosed&&(!fromButton||confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?"))){iframeContainerDiv.parentNode.removeChild(iframeContainerDiv);this.unload();}};open=function(){var initErrorMessage="InPageAppender.open: unable to create console iframe";function finalInit(){try{if(!initiallyMinimized){appender.show();}
consoleWindowLoadHandler();consoleWindowLoaded=true;appendQueuedLoggingEvents();}catch(ex){isSupported=false;handleError(initErrorMessage,ex);}}
function writeToDocument(){try{var windowTest=function(win){return isLoaded(win);};if(useDocumentWrite){writeHtml(getConsoleWindow().document);}
if(windowTest(getConsoleWindow())){finalInit();}else{pollConsoleWindow(windowTest,100,finalInit,initErrorMessage);}}catch(ex){isSupported=false;handleError(initErrorMessage,ex);}}
minimized=false;iframeContainerDiv=containerElement.appendChild(document.createElement("div"));iframeContainerDiv.style.width=width;iframeContainerDiv.style.height=height;iframeContainerDiv.style.border="solid gray 1px";for(var i=0,len=cssProperties.length;i<len;i++){iframeContainerDiv.style[cssProperties[i][0]]=cssProperties[i][1];}
var iframeSrc=useDocumentWrite?"":" src='"+getConsoleUrl()+"'";iframeContainerDiv.innerHTML="<iframe id='"+iframeId+"' name='"+iframeId+"' width='100%' height='100%' frameborder='0'"+iframeSrc+" scrolling='no'></iframe>";consoleClosed=false;var iframeDocumentExistsTest=function(win){try{return bool(win)&&bool(win.document);}catch(ex){return false;}};if(iframeDocumentExistsTest(getConsoleWindow())){writeToDocument();}else{pollConsoleWindow(iframeDocumentExistsTest,100,writeToDocument,initErrorMessage);}
consoleWindowCreated=true;};createWindow=function(show){if(show||!initiallyMinimized){var pageLoadHandler=function(){if(!container){containerElement=document.createElement("div");containerElement.style.position="fixed";containerElement.style.left="0";containerElement.style.right="0";containerElement.style.bottom="0";document.body.appendChild(containerElement);appender.addCssProperty("borderWidth","1px 0 0 0");appender.addCssProperty("zIndex",1000000);open();}else{try{var el=document.getElementById(container);if(el.nodeType==1){containerElement=el;}
open();}catch(ex){handleError("InPageAppender.init: invalid container element '"+container+"' supplied",ex);}}};if(pageLoaded&&container&&container.appendChild){containerElement=container;open();}else if(pageLoaded){pageLoadHandler();}else{log4javascript.addEventListener("load",pageLoadHandler);}
windowCreationStarted=true;}};init=function(){createWindow();initialized=true;};getConsoleWindow=function(){var iframe=window.frames[iframeId];if(iframe){return iframe;}};safeToAppend=function(){if(isSupported&&!consoleClosed){if(consoleWindowCreated&&!consoleWindowLoaded&&getConsoleWindow()&&isLoaded(getConsoleWindow())){consoleWindowLoaded=true;}
return consoleWindowLoaded;}
return false;};}else{var useOldPopUp=appender.defaults.useOldPopUp;var complainAboutPopUpBlocking=appender.defaults.complainAboutPopUpBlocking;var reopenWhenClosed=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return useOldPopUp;};this.setUseOldPopUp=function(useOldPopUpParam){if(checkCanConfigure("useOldPopUp")){useOldPopUp=bool(useOldPopUpParam);}};this.isComplainAboutPopUpBlocking=function(){return complainAboutPopUpBlocking;};this.setComplainAboutPopUpBlocking=function(complainAboutPopUpBlockingParam){if(checkCanConfigure("complainAboutPopUpBlocking")){complainAboutPopUpBlocking=bool(complainAboutPopUpBlockingParam);}};this.isFocusPopUp=function(){return focusConsoleWindow;};this.setFocusPopUp=function(focusPopUpParam){focusConsoleWindow=bool(focusPopUpParam);};this.isReopenWhenClosed=function(){return reopenWhenClosed;};this.setReopenWhenClosed=function(reopenWhenClosedParam){reopenWhenClosed=bool(reopenWhenClosedParam);};this.close=function(){logLog.debug("close "+this);try{popUp.close();this.unload();}catch(ex){}};this.hide=function(){logLog.debug("hide "+this);if(consoleWindowExists()){this.close();}};this.show=function(){logLog.debug("show "+this);if(!consoleWindowCreated){open();}};this.isVisible=function(){return safeToAppend();};var popUp;open=function(){var windowProperties="width="+width+",height="+height+",status,resizable";var frameInfo="";try{var frameEl=window.frameElement;if(frameEl){frameInfo="_"+frameEl.tagName+"_"+(frameEl.name||frameEl.id||"");}}catch(e){frameInfo="_inaccessibleParentFrame";}
var windowName="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+consoleAppenderId+frameInfo;if(!useOldPopUp||!useDocumentWrite){windowName=windowName+"_"+uniqueId;}
var checkPopUpClosed=function(win){if(consoleClosed){return true;}else{try{return bool(win)&&win.closed;}catch(ex){}}
return false;};var popUpClosedCallback=function(){if(!consoleClosed){appender.unload();}};function finalInit(){getConsoleWindow().setCloseIfOpenerCloses(!useOldPopUp||!useDocumentWrite);consoleWindowLoadHandler();consoleWindowLoaded=true;appendQueuedLoggingEvents();pollConsoleWindow(checkPopUpClosed,500,popUpClosedCallback,"PopUpAppender.checkPopUpClosed: error checking pop-up window");}
try{popUp=window.open(getConsoleUrl(),windowName,windowProperties);consoleClosed=false;consoleWindowCreated=true;if(popUp&&popUp.document){if(useDocumentWrite&&useOldPopUp&&isLoaded(popUp)){popUp.mainPageReloaded();finalInit();}else{if(useDocumentWrite){writeHtml(popUp.document);}
var popUpLoadedTest=function(win){return bool(win)&&isLoaded(win);};if(isLoaded(popUp)){finalInit();}else{pollConsoleWindow(popUpLoadedTest,100,finalInit,"PopUpAppender.init: unable to create console window");}}}else{isSupported=false;logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender");if(complainAboutPopUpBlocking){handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.");}}}catch(ex){handleError("PopUpAppender.init: error creating pop-up",ex);}};createWindow=function(){if(!initiallyMinimized){open();}};init=function(){createWindow();initialized=true;};getConsoleWindow=function(){return popUp;};safeToAppend=function(){if(isSupported&&!isUndefined(popUp)&&!consoleClosed){if(popUp.closed||(consoleWindowLoaded&&isUndefined(popUp.closed))){appender.unload();logLog.debug("PopUpAppender: pop-up closed");return false;}
if(!consoleWindowLoaded&&isLoaded(popUp)){consoleWindowLoaded=true;}}
return isSupported&&consoleWindowLoaded&&!consoleClosed;};}
this.getConsoleWindow=getConsoleWindow;};ConsoleAppender.addGlobalCommandLineFunction=function(functionName,commandLineFunction){defaultCommandLineFunctions.push([functionName,commandLineFunction]);};function PopUpAppender(lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(false,null,lazyInit,initiallyMinimized,useDocumentWrite,width,height,this.defaults.focusPopUp);}
PopUpAppender.prototype=new ConsoleAppender();PopUpAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:false,focusPopUp:false,lazyInit:true,useOldPopUp:true,complainAboutPopUpBlocking:true,newestMessageAtTop:false,scrollToLatestMessage:true,width:"600",height:"400",reopenWhenClosed:false,maxMessages:null,showCommandLine:true,commandLineObjectExpansionDepth:1,showHideButton:false,showCloseButton:true,useDocumentWrite:true};PopUpAppender.prototype.toString=function(){return"PopUpAppender";};log4javascript.PopUpAppender=PopUpAppender;function InPageAppender(container,lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(true,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,false);}
InPageAppender.prototype=new ConsoleAppender();InPageAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:false,lazyInit:true,newestMessageAtTop:false,scrollToLatestMessage:true,width:"100%",height:"220px",maxMessages:null,showCommandLine:true,commandLineObjectExpansionDepth:1,showHideButton:false,showCloseButton:false,showLogEntryDeleteButtons:true,useDocumentWrite:true};InPageAppender.prototype.toString=function(){return"InPageAppender";};log4javascript.InPageAppender=InPageAppender;log4javascript.InlineAppender=InPageAppender;})();function padWithSpaces(str,len){if(str.length<len){var spaces=[];var numberOfSpaces=Math.max(0,len-str.length);for(var i=0;i<numberOfSpaces;i++){spaces[i]=" ";}
str+=spaces.join("");}
return str;}
(function(){function dir(obj){var maxLen=0;for(var p in obj){maxLen=Math.max(toStr(p).length,maxLen);}
var propList=[];for(p in obj){var propNameStr="  "+padWithSpaces(toStr(p),maxLen+2);var propVal;try{propVal=splitIntoLines(toStr(obj[p])).join(padWithSpaces(newLine,maxLen+6));}catch(ex){propVal="[Error obtaining property. Details: "+getExceptionMessage(ex)+"]";}
propList.push(propNameStr+propVal);}
return propList.join(newLine);}
var nodeTypes={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};var preFormattedElements=["script","pre"];var emptyElements=["br","img","hr","param","link","area","input","col","base","meta"];var indentationUnit="  ";function getXhtml(rootNode,includeRootNode,indentation,startNewLine,preformatted){includeRootNode=(typeof includeRootNode=="undefined")?true:!!includeRootNode;if(typeof indentation!="string"){indentation="";}
startNewLine=!!startNewLine;preformatted=!!preformatted;var xhtml;function isWhitespace(node){return((node.nodeType==nodeTypes.TEXT_NODE)&&/^[ \t\r\n]*$/.test(node.nodeValue));}
function fixAttributeValue(attrValue){return attrValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");}
function getStyleAttributeValue(el){var stylePairs=el.style.cssText.split(";");var styleValue="";for(var j=0,len=stylePairs.length;j<len;j++){var nameValueBits=stylePairs[j].split(":");var props=[];if(!/^\s*$/.test(nameValueBits[0])){props.push(trim(nameValueBits[0]).toLowerCase()+":"+trim(nameValueBits[1]));}
styleValue=props.join(";");}
return styleValue;}
function getNamespace(el){if(el.prefix){return el.prefix;}else if(el.outerHTML){var regex=new RegExp("<([^:]+):"+el.tagName+"[^>]*>","i");if(regex.test(el.outerHTML)){return RegExp.$1.toLowerCase();}}
return"";}
var lt="<";var gt=">";var i,len;if(includeRootNode&&rootNode.nodeType!=nodeTypes.DOCUMENT_FRAGMENT_NODE){switch(rootNode.nodeType){case nodeTypes.ELEMENT_NODE:var tagName=rootNode.tagName.toLowerCase();xhtml=startNewLine?newLine+indentation:"";xhtml+=lt;var prefix=getNamespace(rootNode);var hasPrefix=!!prefix;if(hasPrefix){xhtml+=prefix+":";}
xhtml+=tagName;for(i=0,len=rootNode.attributes.length;i<len;i++){var currentAttr=rootNode.attributes[i];if(!currentAttr.specified||currentAttr.nodeValue===null||currentAttr.nodeName.toLowerCase()==="style"||typeof currentAttr.nodeValue!=="string"||currentAttr.nodeName.indexOf("_moz")===0){continue;}
xhtml+=" "+currentAttr.nodeName.toLowerCase()+"=\"";xhtml+=fixAttributeValue(currentAttr.nodeValue);xhtml+="\"";}
if(rootNode.style.cssText){var styleValue=getStyleAttributeValue(rootNode);if(styleValue!==""){xhtml+=" style=\""+getStyleAttributeValue(rootNode)+"\"";}}
if(array_contains(emptyElements,tagName)||(hasPrefix&&!rootNode.hasChildNodes())){xhtml+="/"+gt;}else{xhtml+=gt;var childStartNewLine=!(rootNode.childNodes.length===1&&rootNode.childNodes[0].nodeType===nodeTypes.TEXT_NODE);var childPreformatted=array_contains(preFormattedElements,tagName);for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation+indentationUnit,childStartNewLine,childPreformatted);}
var endTag=lt+"/"+tagName+gt;xhtml+=childStartNewLine?newLine+indentation+endTag:endTag;}
return xhtml;case nodeTypes.TEXT_NODE:if(isWhitespace(rootNode)){xhtml="";}else{if(preformatted){xhtml=rootNode.nodeValue;}else{var lines=splitIntoLines(trim(rootNode.nodeValue));var trimmedLines=[];for(i=0,len=lines.length;i<len;i++){trimmedLines[i]=trim(lines[i]);}
xhtml=trimmedLines.join(newLine+indentation);}
if(startNewLine){xhtml=newLine+indentation+xhtml;}}
return xhtml;case nodeTypes.CDATA_SECTION_NODE:return"<![CDA"+"TA["+rootNode.nodeValue+"]"+"]>"+newLine;case nodeTypes.DOCUMENT_NODE:xhtml="";for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation);}
return xhtml;default:return"";}}else{xhtml="";for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation+indentationUnit);}
return xhtml;}}
function createCommandLineFunctions(){ConsoleAppender.addGlobalCommandLineFunction("$",function(appender,args,returnValue){return document.getElementById(args[0]);});ConsoleAppender.addGlobalCommandLineFunction("dir",function(appender,args,returnValue){var lines=[];for(var i=0,len=args.length;i<len;i++){lines[i]=dir(args[i]);}
return lines.join(newLine+newLine);});ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(appender,args,returnValue){var lines=[];for(var i=0,len=args.length;i<len;i++){lines[i]=getXhtml(args[i]);}
return lines.join(newLine+newLine);});ConsoleAppender.addGlobalCommandLineFunction("cd",function(appender,args,returnValue){var win,message;if(args.length===0||args[0]===""){win=window;message="Command line set to run in main window";}else{if(args[0].window==args[0]){win=args[0];message="Command line set to run in frame '"+args[0].name+"'";}else{win=window.frames[args[0]];if(win){message="Command line set to run in frame '"+args[0]+"'";}else{returnValue.isError=true;message="Frame '"+args[0]+"' does not exist";win=appender.getCommandWindow();}}}
appender.setCommandWindow(win);return message;});ConsoleAppender.addGlobalCommandLineFunction("clear",function(appender,args,returnValue){returnValue.appendResult=false;appender.clear();});ConsoleAppender.addGlobalCommandLineFunction("keys",function(appender,args,returnValue){var keys=[];for(var k in args[0]){keys.push(k);}
return keys;});ConsoleAppender.addGlobalCommandLineFunction("values",function(appender,args,returnValue){var values=[];for(var k in args[0]){try{values.push(args[0][k]);}catch(ex){logLog.warn("values(): Unable to obtain value for key "+k+". Details: "+getExceptionMessage(ex));}}
return values;});ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(appender,args,returnValue){var expansionDepth=parseInt(args[0],10);if(isNaN(expansionDepth)||expansionDepth<0){returnValue.isError=true;return""+args[0]+" is not a valid expansion depth";}else{appender.setCommandLineObjectExpansionDepth(expansionDepth);return"Object expansion depth set to "+expansionDepth;}});}
function init(){createCommandLineFunctions();}
init();})();function createDefaultLogger(){var logger=log4javascript.getLogger(defaultLoggerName);var a=new log4javascript.PopUpAppender();logger.addAppender(a);return logger;}
log4javascript.setDocumentReady=function(){pageLoaded=true;log4javascript.dispatchEvent("load",{});};if(window.addEventListener){window.addEventListener("load",log4javascript.setDocumentReady,false);}else if(window.attachEvent){window.attachEvent("onload",log4javascript.setDocumentReady);}else{var oldOnload=window.onload;if(typeof window.onload!="function"){window.onload=log4javascript.setDocumentReady;}else{window.onload=function(evt){if(oldOnload){oldOnload(evt);}
log4javascript.setDocumentReady();};}}
return log4javascript;},this);

},{}],4:[function(require,module,exports){
!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.MessageFormat=r():t.MessageFormat=r()}(this,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=8)}([function(t,r,e){var n,o;void 0===(o="function"==typeof(n={af:function(t,r){return r?"other":1==t?"one":"other"},ak:function(t,r){return r?"other":0==t||1==t?"one":"other"},am:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ar:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":0==t?"zero":1==t?"one":2==t?"two":o>=3&&o<=10?"few":o>=11&&o<=99?"many":"other"},ars:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":0==t?"zero":1==t?"one":2==t?"two":o>=3&&o<=10?"few":o>=11&&o<=99?"many":"other"},as:function(t,r){return r?1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},asa:function(t,r){return r?"other":1==t?"one":"other"},ast:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},az:function(t,r){var e=String(t).split("."),n=e[0],o=n.slice(-1),i=n.slice(-2),u=n.slice(-3);return r?1==o||2==o||5==o||7==o||8==o||20==i||50==i||70==i||80==i?"one":3==o||4==o||100==u||200==u||300==u||400==u||500==u||600==u||700==u||800==u||900==u?"few":0==n||6==o||40==i||60==i||90==i?"many":"other":1==t?"one":"other"},be:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2);return r?2!=o&&3!=o||12==i||13==i?"other":"few":1==o&&11!=i?"one":o>=2&&o<=4&&(i<12||i>14)?"few":n&&0==o||o>=5&&o<=9||i>=11&&i<=14?"many":"other"},bem:function(t,r){return r?"other":1==t?"one":"other"},bez:function(t,r){return r?"other":1==t?"one":"other"},bg:function(t,r){return r?"other":1==t?"one":"other"},bh:function(t,r){return r?"other":0==t||1==t?"one":"other"},bm:function(t,r){return"other"},bn:function(t,r){return r?1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},bo:function(t,r){return"other"},br:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2),u=n&&e[0].slice(-6);return r?"other":1==o&&11!=i&&71!=i&&91!=i?"one":2==o&&12!=i&&72!=i&&92!=i?"two":(3==o||4==o||9==o)&&(i<10||i>19)&&(i<70||i>79)&&(i<90||i>99)?"few":0!=t&&n&&0==u?"many":"other"},brx:function(t,r){return r?"other":1==t?"one":"other"},bs:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},ca:function(t,r){var e=String(t).split("."),n=!e[1];return r?1==t||3==t?"one":2==t?"two":4==t?"few":"other":1==t&&n?"one":"other"},ce:function(t,r){return r?"other":1==t?"one":"other"},cgg:function(t,r){return r?"other":1==t?"one":"other"},chr:function(t,r){return r?"other":1==t?"one":"other"},ckb:function(t,r){return r?"other":1==t?"one":"other"},cs:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1];return r?"other":1==t&&o?"one":n>=2&&n<=4&&o?"few":o?"other":"many"},cy:function(t,r){return r?0==t||7==t||8==t||9==t?"zero":1==t?"one":2==t?"two":3==t||4==t?"few":5==t||6==t?"many":"other":0==t?"zero":1==t?"one":2==t?"two":3==t?"few":6==t?"many":"other"},da:function(t,r){var e=String(t).split("."),n=e[0],o=Number(e[0])==t;return r?"other":1!=t&&(o||0!=n&&1!=n)?"other":"one"},de:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},dsb:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-2),a=o.slice(-2);return r?"other":i&&1==u||1==a?"one":i&&2==u||2==a?"two":i&&(3==u||4==u)||3==a||4==a?"few":"other"},dv:function(t,r){return r?"other":1==t?"one":"other"},dz:function(t,r){return"other"},ee:function(t,r){return r?"other":1==t?"one":"other"},el:function(t,r){return r?"other":1==t?"one":"other"},en:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?1==i&&11!=u?"one":2==i&&12!=u?"two":3==i&&13!=u?"few":"other":1==t&&n?"one":"other"},eo:function(t,r){return r?"other":1==t?"one":"other"},es:function(t,r){return r?"other":1==t?"one":"other"},et:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},eu:function(t,r){return r?"other":1==t?"one":"other"},fa:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ff:function(t,r){return r?"other":t>=0&&t<2?"one":"other"},fi:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},fil:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=o.slice(-1);return r?1==t?"one":"other":i&&(1==n||2==n||3==n)||i&&4!=u&&6!=u&&9!=u||!i&&4!=a&&6!=a&&9!=a?"one":"other"},fo:function(t,r){return r?"other":1==t?"one":"other"},fr:function(t,r){return r?1==t?"one":"other":t>=0&&t<2?"one":"other"},fur:function(t,r){return r?"other":1==t?"one":"other"},fy:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},ga:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t?"one":"other":1==t?"one":2==t?"two":n&&t>=3&&t<=6?"few":n&&t>=7&&t<=10?"many":"other"},gd:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t||11==t?"one":2==t||12==t?"two":3==t||13==t?"few":"other":1==t||11==t?"one":2==t||12==t?"two":n&&t>=3&&t<=10||n&&t>=13&&t<=19?"few":"other"},gl:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},gsw:function(t,r){return r?"other":1==t?"one":"other"},gu:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},guw:function(t,r){return r?"other":0==t||1==t?"one":"other"},gv:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i?"one":o&&2==i?"two":!o||0!=u&&20!=u&&40!=u&&60!=u&&80!=u?o?"other":"many":"few"},ha:function(t,r){return r?"other":1==t?"one":"other"},haw:function(t,r){return r?"other":1==t?"one":"other"},he:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1);return r?"other":1==t&&o?"one":2==n&&o?"two":o&&(t<0||t>10)&&i&&0==u?"many":"other"},hi:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},hr:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},hsb:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-2),a=o.slice(-2);return r?"other":i&&1==u||1==a?"one":i&&2==u||2==a?"two":i&&(3==u||4==u)||3==a||4==a?"few":"other"},hu:function(t,r){return r?1==t||5==t?"one":"other":1==t?"one":"other"},hy:function(t,r){return r?1==t?"one":"other":t>=0&&t<2?"one":"other"},ia:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},id:function(t,r){return"other"},ig:function(t,r){return"other"},ii:function(t,r){return"other"},in:function(t,r){return"other"},io:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},is:function(t,r){var e=String(t).split("."),n=e[0],o=Number(e[0])==t,i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i&&11!=u||!o?"one":"other"},it:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},iu:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},iw:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1);return r?"other":1==t&&o?"one":2==n&&o?"two":o&&(t<0||t>10)&&i&&0==u?"many":"other"},ja:function(t,r){return"other"},jbo:function(t,r){return"other"},jgo:function(t,r){return r?"other":1==t?"one":"other"},ji:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},jmc:function(t,r){return r?"other":1==t?"one":"other"},jv:function(t,r){return"other"},jw:function(t,r){return"other"},ka:function(t,r){var e=String(t).split("."),n=e[0],o=n.slice(-2);return r?1==n?"one":0==n||o>=2&&o<=20||40==o||60==o||80==o?"many":"other":1==t?"one":"other"},kab:function(t,r){return r?"other":t>=0&&t<2?"one":"other"},kaj:function(t,r){return r?"other":1==t?"one":"other"},kcg:function(t,r){return r?"other":1==t?"one":"other"},kde:function(t,r){return"other"},kea:function(t,r){return"other"},kk:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1);return r?6==o||9==o||n&&0==o&&0!=t?"many":"other":1==t?"one":"other"},kkj:function(t,r){return r?"other":1==t?"one":"other"},kl:function(t,r){return r?"other":1==t?"one":"other"},km:function(t,r){return"other"},kn:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ko:function(t,r){return"other"},ks:function(t,r){return r?"other":1==t?"one":"other"},ksb:function(t,r){return r?"other":1==t?"one":"other"},ksh:function(t,r){return r?"other":0==t?"zero":1==t?"one":"other"},ku:function(t,r){return r?"other":1==t?"one":"other"},kw:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},ky:function(t,r){return r?"other":1==t?"one":"other"},lag:function(t,r){var e=String(t).split("."),n=e[0];return r?"other":0==t?"zero":0!=n&&1!=n||0==t?"other":"one"},lb:function(t,r){return r?"other":1==t?"one":"other"},lg:function(t,r){return r?"other":1==t?"one":"other"},lkt:function(t,r){return"other"},ln:function(t,r){return r?"other":0==t||1==t?"one":"other"},lo:function(t,r){return r&&1==t?"one":"other"},lt:function(t,r){var e=String(t).split("."),n=e[1]||"",o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?"other":1==i&&(u<11||u>19)?"one":i>=2&&i<=9&&(u<11||u>19)?"few":0!=n?"many":"other"},lv:function(t,r){var e=String(t).split("."),n=e[1]||"",o=n.length,i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-2),h=n.slice(-1);return r?"other":i&&0==u||a>=11&&a<=19||2==o&&c>=11&&c<=19?"zero":1==u&&11!=a||2==o&&1==h&&11!=c||2!=o&&1==h?"one":"other"},mas:function(t,r){return r?"other":1==t?"one":"other"},mg:function(t,r){return r?"other":0==t||1==t?"one":"other"},mgo:function(t,r){return r?"other":1==t?"one":"other"},mk:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?1==u&&11!=a?"one":2==u&&12!=a?"two":7!=u&&8!=u||17==a||18==a?"other":"many":i&&1==u&&11!=a||1==c&&11!=h?"one":"other"},ml:function(t,r){return r?"other":1==t?"one":"other"},mn:function(t,r){return r?"other":1==t?"one":"other"},mo:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-2);return r?1==t?"one":"other":1==t&&n?"one":!n||0==t||1!=t&&i>=1&&i<=19?"few":"other"},mr:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":"other":t>=0&&t<=1?"one":"other"},ms:function(t,r){return r&&1==t?"one":"other"},mt:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":1==t?"one":0==t||o>=2&&o<=10?"few":o>=11&&o<=19?"many":"other"},my:function(t,r){return"other"},nah:function(t,r){return r?"other":1==t?"one":"other"},naq:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},nb:function(t,r){return r?"other":1==t?"one":"other"},nd:function(t,r){return r?"other":1==t?"one":"other"},ne:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?n&&t>=1&&t<=4?"one":"other":1==t?"one":"other"},nl:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},nn:function(t,r){return r?"other":1==t?"one":"other"},nnh:function(t,r){return r?"other":1==t?"one":"other"},no:function(t,r){return r?"other":1==t?"one":"other"},nqo:function(t,r){return"other"},nr:function(t,r){return r?"other":1==t?"one":"other"},nso:function(t,r){return r?"other":0==t||1==t?"one":"other"},ny:function(t,r){return r?"other":1==t?"one":"other"},nyn:function(t,r){return r?"other":1==t?"one":"other"},om:function(t,r){return r?"other":1==t?"one":"other"},or:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t||5==t||n&&t>=7&&t<=9?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":1==t?"one":"other"},os:function(t,r){return r?"other":1==t?"one":"other"},pa:function(t,r){return r?"other":0==t||1==t?"one":"other"},pap:function(t,r){return r?"other":1==t?"one":"other"},pl:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":1==t&&o?"one":o&&i>=2&&i<=4&&(u<12||u>14)?"few":o&&1!=n&&(0==i||1==i)||o&&i>=5&&i<=9||o&&u>=12&&u<=14?"many":"other"},prg:function(t,r){var e=String(t).split("."),n=e[1]||"",o=n.length,i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-2),h=n.slice(-1);return r?"other":i&&0==u||a>=11&&a<=19||2==o&&c>=11&&c<=19?"zero":1==u&&11!=a||2==o&&1==h&&11!=c||2!=o&&1==h?"one":"other"},ps:function(t,r){return r?"other":1==t?"one":"other"},pt:function(t,r){var e=String(t).split("."),n=e[0];return r?"other":0==n||1==n?"one":"other"},"pt-PT":function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},rm:function(t,r){return r?"other":1==t?"one":"other"},ro:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-2);return r?1==t?"one":"other":1==t&&n?"one":!n||0==t||1!=t&&i>=1&&i<=19?"few":"other"},rof:function(t,r){return r?"other":1==t?"one":"other"},root:function(t,r){return"other"},ru:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i&&11!=u?"one":o&&i>=2&&i<=4&&(u<12||u>14)?"few":o&&0==i||o&&i>=5&&i<=9||o&&u>=11&&u<=14?"many":"other"},rwk:function(t,r){return r?"other":1==t?"one":"other"},sah:function(t,r){return"other"},saq:function(t,r){return r?"other":1==t?"one":"other"},sc:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},scn:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},sd:function(t,r){return r?"other":1==t?"one":"other"},sdh:function(t,r){return r?"other":1==t?"one":"other"},se:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},seh:function(t,r){return r?"other":1==t?"one":"other"},ses:function(t,r){return"other"},sg:function(t,r){return"other"},sh:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},shi:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?"other":t>=0&&t<=1?"one":n&&t>=2&&t<=10?"few":"other"},si:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"";return r?"other":0==t||1==t||0==n&&1==o?"one":"other"},sk:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1];return r?"other":1==t&&o?"one":n>=2&&n<=4&&o?"few":o?"other":"many"},sl:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-2);return r?"other":o&&1==i?"one":o&&2==i?"two":o&&(3==i||4==i)||!o?"few":"other"},sma:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smi:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smj:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smn:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},sms:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},sn:function(t,r){return r?"other":1==t?"one":"other"},so:function(t,r){return r?"other":1==t?"one":"other"},sq:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2);return r?1==t?"one":4==o&&14!=i?"many":"other":1==t?"one":"other"},sr:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},ss:function(t,r){return r?"other":1==t?"one":"other"},ssy:function(t,r){return r?"other":1==t?"one":"other"},st:function(t,r){return r?"other":1==t?"one":"other"},sv:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?1!=i&&2!=i||11==u||12==u?"other":"one":1==t&&n?"one":"other"},sw:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},syr:function(t,r){return r?"other":1==t?"one":"other"},ta:function(t,r){return r?"other":1==t?"one":"other"},te:function(t,r){return r?"other":1==t?"one":"other"},teo:function(t,r){return r?"other":1==t?"one":"other"},th:function(t,r){return"other"},ti:function(t,r){return r?"other":0==t||1==t?"one":"other"},tig:function(t,r){return r?"other":1==t?"one":"other"},tk:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1);return r?6==o||9==o||10==t?"few":"other":1==t?"one":"other"},tl:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=o.slice(-1);return r?1==t?"one":"other":i&&(1==n||2==n||3==n)||i&&4!=u&&6!=u&&9!=u||!i&&4!=a&&6!=a&&9!=a?"one":"other"},tn:function(t,r){return r?"other":1==t?"one":"other"},to:function(t,r){return"other"},tr:function(t,r){return r?"other":1==t?"one":"other"},ts:function(t,r){return r?"other":1==t?"one":"other"},tzm:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?"other":0==t||1==t||n&&t>=11&&t<=99?"one":"other"},ug:function(t,r){return r?"other":1==t?"one":"other"},uk:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-1),h=n.slice(-2);return r?3==u&&13!=a?"few":"other":o&&1==c&&11!=h?"one":o&&c>=2&&c<=4&&(h<12||h>14)?"few":o&&0==c||o&&c>=5&&c<=9||o&&h>=11&&h<=14?"many":"other"},ur:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},uz:function(t,r){return r?"other":1==t?"one":"other"},ve:function(t,r){return r?"other":1==t?"one":"other"},vi:function(t,r){return r&&1==t?"one":"other"},vo:function(t,r){return r?"other":1==t?"one":"other"},vun:function(t,r){return r?"other":1==t?"one":"other"},wa:function(t,r){return r?"other":0==t||1==t?"one":"other"},wae:function(t,r){return r?"other":1==t?"one":"other"},wo:function(t,r){return"other"},xh:function(t,r){return r?"other":1==t?"one":"other"},xog:function(t,r){return r?"other":1==t?"one":"other"},yi:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},yo:function(t,r){return"other"},yue:function(t,r){return"other"},zh:function(t,r){return"other"},zu:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"}})?n.call(r,e,r,t):n)||(t.exports=o)},function(t,r,e){t.exports={date:e(4),duration:e(5),number:e(6),time:e(7)}},function(t,r,e){"use strict";function n(t,r,e,o){this.message=t,this.expected=r,this.found=e,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}(n,Error),n.buildMessage=function(t,r){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r,e="";for(r=0;r<t.parts.length;r++)e+=t.parts[r]instanceof Array?i(t.parts[r][0])+"-"+i(t.parts[r][1]):i(t.parts[r]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}return"Expected "+function(t){var r,n,o,i=new Array(t.length);for(r=0;r<t.length;r++)i[r]=(o=t[r],e[o.type](o));if(i.sort(),i.length>0){for(r=1,n=1;r<i.length;r++)i[r-1]!==i[r]&&(i[n]=i[r],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(r)+" found."},t.exports={SyntaxError:n,parse:function(t,r){r=void 0!==r?r:{};var e,o={},i={start:tr},u=tr,a="#",c=It("#",!1),h=function(){return pr[0]},f=function(){return{type:"octothorpe"}},s=function(t){return t.join("")},l="{",p=It("{",!1),m="}",d=It("}",!1),y=function(t){return{type:"argument",arg:t}},g=",",v=It(",",!1),w="select",b=It("select",!1),S=function(t,e){return r.strict&&pr.unshift(!1),e},k=function(t,e){return r.strict&&pr.shift(),{type:"select",arg:t,cases:e}},x="plural",A=It("plural",!1),j="selectordinal",N=It("selectordinal",!1),C=function(t,r){return pr.unshift(!0),r},F=function(t,e,n,o){var i=("selectordinal"===e?r.ordinal:r.cardinal)||["zero","one","two","few","many","other"];return i&&i.length&&o.forEach(function(r){if(isNaN(r.key)&&i.indexOf(r.key)<0)throw new Error("Invalid key `"+r.key+"` for argument `"+t+"`. Valid "+e+" keys for this locale are `"+i.join("`, `")+"`, and explicit keys like `=0`.")}),pr.shift(),{type:e,arg:t,offset:n||0,cases:o}},O=function(t,r,e){return{type:"function",arg:t,key:r,param:e}},E=Vt("identifier"),z=/^[^\t-\r \x85\u200E\u200F\u2028\u2029!-\/:-@[-\^`{-~\xA1-\xA7\xA9\xAB\xAC\xAE\xB0\xB1\xB6\xBB\xBF\xD7\xF7\u2010-\u2027\u2030-\u203E\u2041-\u2053\u2055-\u205E\u2190-\u245F\u2500-\u2775\u2794-\u2BFF\u2E00-\u2E7F\u3001-\u3003\u3008-\u3020\u3030\uFD3E\uFD3F\uFE45\uFE46]/,P=Yt([["\t","\r"]," ","","‎","‏","\u2028","\u2029",["!","/"],[":","@"],["[","^"],"`",["{","~"],["¡","§"],"©","«","¬","®","°","±","¶","»","¿","×","÷",["‐","‧"],["‰","‾"],["⁁","⁓"],["⁕","⁞"],["←","⑟"],["─","❵"],["➔","⯿"],["⸀","⹿"],["、","〃"],["〈","〠"],"〰","﴾","﴿","﹅","﹆"],!0,!1),L=function(t,r){return{key:t,tokens:r}},J=function(t){return t},D=Vt("plural offset"),M="offset",_=It("offset",!1),T=":",R=It(":",!1),B=function(t){return t},q="=",$=It("=",!1),K="number",G=It("number",!1),U="date",Z=It("date",!1),I="time",Y=It("time",!1),V="spellout",W=It("spellout",!1),H="ordinal",Q=It("ordinal",!1),X="duration",tt=It("duration",!1),rt=function(t){if(r.strict||/^\d/.test(t))return!1;switch(t.toLowerCase()){case"select":case"plural":case"selectordinal":return!1;default:return!0}},et=function(t){return t},nt=function(t){return!r.strict},ot=function(t){return{tokens:t}},it=function(t){return{tokens:[t.join("")]}},ut=Vt("a valid (strict) function parameter"),at=/^[^'{}]/,ct=Yt(["'","{","}"],!0,!1),ht=function(t){return t.join("")},ft="'",st=It("'",!1),lt=function(t){return t},pt=function(t){return"{"+t.join("")+"}"},mt=Vt("doubled apostrophe"),dt="''",yt=It("''",!1),gt=function(){return"'"},vt=/^[^']/,wt=Yt(["'"],!0,!1),bt="'{",St=It("'{",!1),kt=function(t){return"{"+t.join("")},xt="'}",At=It("'}",!1),jt=function(t){return"}"+t.join("")},Nt=Vt("escaped string"),Ct="'#",Ft=It("'#",!1),Ot=function(t){return"#"+t.join("")},Et=function(t){return t[0]},zt=Vt("plain char"),Pt=/^[^{}#\0-\x08\x0E-\x1F\x7F]/,Lt=Yt(["{","}","#",["\0","\b"],["",""],""],!0,!1),Jt=function(t){return!pr[0]},Dt=function(t){return t},Mt=Vt("integer"),_t=/^[0-9]/,Tt=Yt([["0","9"]],!1,!1),Rt=Vt("white space"),Bt=/^[\t-\r \x85\u200E\u200F\u2028\u2029]/,qt=Yt([["\t","\r"]," ","","‎","‏","\u2028","\u2029"],!1,!1),$t=0,Kt=[{line:1,column:1}],Gt=0,Ut=[],Zt=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');u=i[r.startRule]}function It(t,r){return{type:"literal",text:t,ignoreCase:r}}function Yt(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function Vt(t){return{type:"other",description:t}}function Wt(r){var e,n=Kt[r];if(n)return n;for(e=r-1;!Kt[e];)e--;for(n={line:(n=Kt[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return Kt[r]=n,n}function Ht(t,r){var e=Wt(t),n=Wt(r);return{start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function Qt(t){$t<Gt||($t>Gt&&(Gt=$t,Ut=[]),Ut.push(t))}function Xt(t,r,e){return new n(n.buildMessage(t,r),t,r,e)}function tr(){var t,r;for(t=[],r=rr();r!==o;)t.push(r),r=rr();return t}function rr(){var r,e,n;if((r=function(){var r,e,n,i;return r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o&&lr()!==o&&(n=er())!==o&&lr()!==o?(125===t.charCodeAt($t)?(i=m,$t++):(i=o,0===Zt&&Qt(d)),i!==o?(e=y(n),r=e):($t=r,r=o)):($t=r,r=o),r}())===o&&(r=function(){var r,e,n,i,u,a,c,h,f;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(lr()!==o)if((n=er())!==o)if(lr()!==o)if(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o)if(lr()!==o)if($t,t.substr($t,6)===w?(u=w,$t+=6):(u=o,0===Zt&&Qt(b)),u!==o&&(u=S(n,u)),u!==o)if((u=lr())!==o)if(44===t.charCodeAt($t)?(a=g,$t++):(a=o,0===Zt&&Qt(v)),a!==o)if(lr()!==o){if(c=[],(h=nr())!==o)for(;h!==o;)c.push(h),h=nr();else c=o;c!==o&&(h=lr())!==o?(125===t.charCodeAt($t)?(f=m,$t++):(f=o,0===Zt&&Qt(d)),f!==o?(e=k(n,c),r=e):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;return r}())===o&&(r=function(){var r,e,n,i,u,a,c,h,f,s,y;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(lr()!==o)if((n=er())!==o)if(lr()!==o)if(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o)if(lr()!==o)if(u=$t,t.substr($t,6)===x?(a=x,$t+=6):(a=o,0===Zt&&Qt(A)),a===o&&(t.substr($t,13)===j?(a=j,$t+=13):(a=o,0===Zt&&Qt(N))),a!==o&&(a=C(n,a)),(u=a)!==o)if((a=lr())!==o)if(44===t.charCodeAt($t)?(c=g,$t++):(c=o,0===Zt&&Qt(v)),c!==o)if(lr()!==o)if((h=function(){var r,e,n,i,u;return Zt++,r=$t,(e=lr())!==o?(t.substr($t,6)===M?(n=M,$t+=6):(n=o,0===Zt&&Qt(_)),n!==o&&lr()!==o?(58===t.charCodeAt($t)?(i=T,$t++):(i=o,0===Zt&&Qt(R)),i!==o&&lr()!==o&&(u=sr())!==o&&lr()!==o?(e=B(u),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o),Zt--,r===o&&(e=o,0===Zt&&Qt(D)),r}())===o&&(h=null),h!==o){if(f=[],(s=or())!==o)for(;s!==o;)f.push(s),s=or();else f=o;f!==o&&(s=lr())!==o?(125===t.charCodeAt($t)?(y=m,$t++):(y=o,0===Zt&&Qt(d)),y!==o?(e=F(n,u,h,f),r=e):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;return r}())===o&&(r=function(){var r,e,n,i,u,a,c;return r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o&&lr()!==o&&(n=er())!==o&&lr()!==o?(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o&&lr()!==o&&(u=function(){var r,e,n,i,u;return t.substr($t,6)===K?(r=K,$t+=6):(r=o,0===Zt&&Qt(G)),r===o&&(t.substr($t,4)===U?(r=U,$t+=4):(r=o,0===Zt&&Qt(Z)),r===o&&(t.substr($t,4)===I?(r=I,$t+=4):(r=o,0===Zt&&Qt(Y)),r===o&&(t.substr($t,8)===V?(r=V,$t+=8):(r=o,0===Zt&&Qt(W)),r===o&&(t.substr($t,7)===H?(r=H,$t+=7):(r=o,0===Zt&&Qt(Q)),r===o&&(t.substr($t,8)===X?(r=X,$t+=8):(r=o,0===Zt&&Qt(tt)),r===o&&(r=$t,e=$t,Zt++,t.substr($t,6)===w?(n=w,$t+=6):(n=o,0===Zt&&Qt(b)),Zt--,n===o?e=void 0:($t=e,e=o),e!==o?(n=$t,Zt++,t.substr($t,6)===x?(i=x,$t+=6):(i=o,0===Zt&&Qt(A)),Zt--,i===o?n=void 0:($t=n,n=o),n!==o?(i=$t,Zt++,t.substr($t,13)===j?(u=j,$t+=13):(u=o,0===Zt&&Qt(N)),Zt--,u===o?i=void 0:($t=i,i=o),i!==o&&(u=er())!==o&&(rt(u)?void 0:o)!==o?(e=et(u),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o))))))),r}())!==o&&lr()!==o?((a=function(){var r,e,n,i,u;if(r=$t,(e=lr())!==o)if(44===t.charCodeAt($t)?(n=g,$t++):(n=o,0===Zt&&Qt(v)),n!==o){for(i=[],u=rr();u!==o;)i.push(u),u=rr();i!==o&&(u=(u=nt(i))?void 0:o)!==o?(e=ot(i),r=e):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;if(r===o)if(r=$t,(e=lr())!==o)if(44===t.charCodeAt($t)?(n=g,$t++):(n=o,0===Zt&&Qt(v)),n!==o){for(i=[],u=ur();u!==o;)i.push(u),u=ur();i!==o?(e=it(i),r=e):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;return r}())===o&&(a=null),a!==o?(125===t.charCodeAt($t)?(c=m,$t++):(c=o,0===Zt&&Qt(d)),c!==o?(e=O(n,u,a),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o)):($t=r,r=o),r}())===o&&(r=$t,35===t.charCodeAt($t)?(e=a,$t++):(e=o,0===Zt&&Qt(c)),e!==o&&(n=(n=h())?void 0:o)!==o?r=e=f():($t=r,r=o),r===o)){if(r=$t,e=[],(n=fr())!==o)for(;n!==o;)e.push(n),n=fr();else e=o;e!==o&&(e=s(e)),r=e}return r}function er(){var r,e,n;if(Zt++,r=$t,e=[],z.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(P)),n!==o)for(;n!==o;)e.push(n),z.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(P));else e=o;return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(E)),r}function nr(){var t,r,e;return t=$t,lr()!==o&&(r=er())!==o&&lr()!==o&&(e=ir())!==o?t=L(r,e):($t=t,t=o),t}function or(){var r,e,n;return r=$t,lr()!==o&&(e=function(){var r,e,n;return(r=er())===o&&(r=$t,61===t.charCodeAt($t)?(e=q,$t++):(e=o,0===Zt&&Qt($)),e!==o&&(n=sr())!==o?(e=B(n),r=e):($t=r,r=o)),r}())!==o&&lr()!==o&&(n=ir())!==o?r=L(e,n):($t=r,r=o),r}function ir(){var r,e,n,i,u,a;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(n=$t,(i=lr())!==o?(u=$t,Zt++,123===t.charCodeAt($t)?(a=l,$t++):(a=o,0===Zt&&Qt(p)),Zt--,a!==o?($t=u,u=void 0):u=o,u!==o?n=i=[i,u]:($t=n,n=o)):($t=n,n=o),n===o&&(n=null),n!==o){for(i=[],u=rr();u!==o;)i.push(u),u=rr();i!==o&&(u=lr())!==o?(125===t.charCodeAt($t)?(a=m,$t++):(a=o,0===Zt&&Qt(d)),a!==o?r=e=J(i):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;return r}function ur(){var r,e,n,i;if(Zt++,r=$t,e=[],at.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(ct)),n!==o)for(;n!==o;)e.push(n),at.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(ct));else e=o;if(e!==o&&(e=ht(e)),(r=e)===o&&(r=ar())===o&&(r=$t,39===t.charCodeAt($t)?(e=ft,$t++):(e=o,0===Zt&&Qt(st)),e!==o&&(n=cr())!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=lt(n):($t=r,r=o)):($t=r,r=o),r===o))if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o){for(n=[],i=ur();i!==o;)n.push(i),i=ur();n!==o?(125===t.charCodeAt($t)?(i=m,$t++):(i=o,0===Zt&&Qt(d)),i!==o?r=e=pt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;return Zt--,r===o&&(e=o,0===Zt&&Qt(ut)),r}function ar(){var r,e;return Zt++,r=$t,t.substr($t,2)===dt?(e=dt,$t+=2):(e=o,0===Zt&&Qt(yt)),e!==o&&(e=gt()),Zt--,(r=e)===o&&(e=o,0===Zt&&Qt(mt)),r}function cr(){var r,e,n;if((r=ar())===o){if(r=$t,e=[],vt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(wt)),n!==o)for(;n!==o;)e.push(n),vt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(wt));else e=o;e!==o&&(e=s(e)),r=e}return r}function hr(){var r,e,n,i,u,a;if(Zt++,(r=function(){var r,e,n,i;if(r=$t,t.substr($t,2)===bt?(e=bt,$t+=2):(e=o,0===Zt&&Qt(St)),e!==o){for(n=[],i=cr();i!==o;)n.push(i),i=cr();n!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=kt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;if(r===o)if(r=$t,t.substr($t,2)===xt?(e=xt,$t+=2):(e=o,0===Zt&&Qt(At)),e!==o){for(n=[],i=cr();i!==o;)n.push(i),i=cr();n!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=jt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;return r}())===o){if(r=$t,e=$t,n=$t,t.substr($t,2)===Ct?(i=Ct,$t+=2):(i=o,0===Zt&&Qt(Ft)),i!==o){for(u=[],a=cr();a!==o;)u.push(a),a=cr();u!==o?(39===t.charCodeAt($t)?(a=ft,$t++):(a=o,0===Zt&&Qt(st)),a!==o?n=i=Ot(u):($t=n,n=o)):($t=n,n=o)}else $t=n,n=o;n!==o&&(i=(i=h())?void 0:o)!==o?e=n=[n,i]:($t=e,e=o),e!==o&&(e=Et(e)),(r=e)===o&&(39===t.charCodeAt($t)?(r=ft,$t++):(r=o,0===Zt&&Qt(st)))}return Zt--,r===o&&(e=o,0===Zt&&Qt(Nt)),r}function fr(){var r,e;return(r=ar())===o&&(r=hr())===o&&(r=$t,35===t.charCodeAt($t)?(e=a,$t++):(e=o,0===Zt&&Qt(c)),e!==o&&(Jt(e)?void 0:o)!==o?r=e=Dt(e):($t=r,r=o),r===o&&(r=function(){var r;return Zt++,Pt.test(t.charAt($t))?(r=t.charAt($t),$t++):(r=o,0===Zt&&Qt(Lt)),Zt--,r===o&&0===Zt&&Qt(zt),r}())),r}function sr(){var r,e,n;if(Zt++,r=$t,e=[],_t.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(Tt)),n!==o)for(;n!==o;)e.push(n),_t.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(Tt));else e=o;return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(Mt)),r}function lr(){var r,e,n;for(Zt++,r=$t,e=[],Bt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(qt));n!==o;)e.push(n),Bt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(qt));return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(Rt)),r}var pr=[!1];if((e=u())!==o&&$t===t.length)return e;throw e!==o&&$t<t.length&&Qt({type:"end"}),Xt(Ut,Gt<t.length?t.charAt(Gt):null,Gt<t.length?Ht(Gt,Gt+1):Ht(Gt,Gt))}}},function(t,r,e){var n,o,i=[{cardinal:["other"],ordinal:["other"]},{cardinal:["one","other"],ordinal:["other"]},{cardinal:["one","other"],ordinal:["one","other"]},{cardinal:["one","two","other"],ordinal:["other"]}];void 0===(o="function"==typeof(n={af:i[1],ak:i[1],am:i[1],ar:{cardinal:["zero","one","two","few","many","other"],ordinal:["other"]},ars:{cardinal:["zero","one","two","few","many","other"],ordinal:["other"]},as:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},asa:i[1],ast:i[1],az:{cardinal:["one","other"],ordinal:["one","few","many","other"]},be:{cardinal:["one","few","many","other"],ordinal:["few","other"]},bem:i[1],bez:i[1],bg:i[1],bh:i[1],bm:i[0],bn:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},bo:i[0],br:{cardinal:["one","two","few","many","other"],ordinal:["other"]},brx:i[1],bs:{cardinal:["one","few","other"],ordinal:["other"]},ca:{cardinal:["one","other"],ordinal:["one","two","few","other"]},ce:i[1],cgg:i[1],chr:i[1],ckb:i[1],cs:{cardinal:["one","few","many","other"],ordinal:["other"]},cy:{cardinal:["zero","one","two","few","many","other"],ordinal:["zero","one","two","few","many","other"]},da:i[1],de:i[1],dsb:{cardinal:["one","two","few","other"],ordinal:["other"]},dv:i[1],dz:i[0],ee:i[1],el:i[1],en:{cardinal:["one","other"],ordinal:["one","two","few","other"]},eo:i[1],es:i[1],et:i[1],eu:i[1],fa:i[1],ff:i[1],fi:i[1],fil:i[2],fo:i[1],fr:i[2],fur:i[1],fy:i[1],ga:{cardinal:["one","two","few","many","other"],ordinal:["one","other"]},gd:{cardinal:["one","two","few","other"],ordinal:["one","two","few","other"]},gl:i[1],gsw:i[1],gu:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},guw:i[1],gv:{cardinal:["one","two","few","many","other"],ordinal:["other"]},ha:i[1],haw:i[1],he:{cardinal:["one","two","many","other"],ordinal:["other"]},hi:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},hr:{cardinal:["one","few","other"],ordinal:["other"]},hsb:{cardinal:["one","two","few","other"],ordinal:["other"]},hu:i[2],hy:i[2],ia:i[1],id:i[0],ig:i[0],ii:i[0],in:i[0],io:i[1],is:i[1],it:{cardinal:["one","other"],ordinal:["many","other"]},iu:i[3],iw:{cardinal:["one","two","many","other"],ordinal:["other"]},ja:i[0],jbo:i[0],jgo:i[1],ji:i[1],jmc:i[1],jv:i[0],jw:i[0],ka:{cardinal:["one","other"],ordinal:["one","many","other"]},kab:i[1],kaj:i[1],kcg:i[1],kde:i[0],kea:i[0],kk:{cardinal:["one","other"],ordinal:["many","other"]},kkj:i[1],kl:i[1],km:i[0],kn:i[1],ko:i[0],ks:i[1],ksb:i[1],ksh:{cardinal:["zero","one","other"],ordinal:["other"]},ku:i[1],kw:i[3],ky:i[1],lag:{cardinal:["zero","one","other"],ordinal:["other"]},lb:i[1],lg:i[1],lkt:i[0],ln:i[1],lo:{cardinal:["other"],ordinal:["one","other"]},lt:{cardinal:["one","few","many","other"],ordinal:["other"]},lv:{cardinal:["zero","one","other"],ordinal:["other"]},mas:i[1],mg:i[1],mgo:i[1],mk:{cardinal:["one","other"],ordinal:["one","two","many","other"]},ml:i[1],mn:i[1],mo:{cardinal:["one","few","other"],ordinal:["one","other"]},mr:{cardinal:["one","other"],ordinal:["one","two","few","other"]},ms:{cardinal:["other"],ordinal:["one","other"]},mt:{cardinal:["one","few","many","other"],ordinal:["other"]},my:i[0],nah:i[1],naq:i[3],nb:i[1],nd:i[1],ne:i[2],nl:i[1],nn:i[1],nnh:i[1],no:i[1],nqo:i[0],nr:i[1],nso:i[1],ny:i[1],nyn:i[1],om:i[1],or:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},os:i[1],pa:i[1],pap:i[1],pl:{cardinal:["one","few","many","other"],ordinal:["other"]},prg:{cardinal:["zero","one","other"],ordinal:["other"]},ps:i[1],pt:i[1],"pt-PT":i[1],rm:i[1],ro:{cardinal:["one","few","other"],ordinal:["one","other"]},rof:i[1],root:i[0],ru:{cardinal:["one","few","many","other"],ordinal:["other"]},rwk:i[1],sah:i[0],saq:i[1],sc:{cardinal:["one","other"],ordinal:["many","other"]},scn:{cardinal:["one","other"],ordinal:["many","other"]},sd:i[1],sdh:i[1],se:i[3],seh:i[1],ses:i[0],sg:i[0],sh:{cardinal:["one","few","other"],ordinal:["other"]},shi:{cardinal:["one","few","other"],ordinal:["other"]},si:i[1],sk:{cardinal:["one","few","many","other"],ordinal:["other"]},sl:{cardinal:["one","two","few","other"],ordinal:["other"]},sma:i[3],smi:i[3],smj:i[3],smn:i[3],sms:i[3],sn:i[1],so:i[1],sq:{cardinal:["one","other"],ordinal:["one","many","other"]},sr:{cardinal:["one","few","other"],ordinal:["other"]},ss:i[1],ssy:i[1],st:i[1],sv:i[2],sw:i[1],syr:i[1],ta:i[1],te:i[1],teo:i[1],th:i[0],ti:i[1],tig:i[1],tk:{cardinal:["one","other"],ordinal:["few","other"]},tl:i[2],tn:i[1],to:i[0],tr:i[1],ts:i[1],tzm:i[1],ug:i[1],uk:{cardinal:["one","few","many","other"],ordinal:["few","other"]},ur:i[1],uz:i[1],ve:i[1],vi:{cardinal:["other"],ordinal:["one","other"]},vo:i[1],vun:i[1],wa:i[1],wae:i[1],wo:i[0],xh:i[1],xog:i[1],yi:i[1],yo:i[0],yue:i[0],zh:i[0],zu:i[1]})?n.call(r,e,r,t):n)||(t.exports=o)},function(t,r){function e(t,r,e){var n={day:"numeric",month:"short",year:"numeric"};switch(e){case"full":n.weekday="long";case"long":n.month="long";break;case"short":n.month="numeric"}return new Date(t).toLocaleDateString(r,n)}t.exports=function(){return e}},function(t,r){function e(t){if(!isFinite(t))return String(t);var r="";t<0?(r="-",t=Math.abs(t)):t=Number(t);var e=t%60,n=[Math.round(e)===e?e:e.toFixed(3)];return t<60?n.unshift(0):(t=Math.round((t-n[0])/60),n.unshift(t%60),t>=60&&(t=Math.round((t-n[0])/60),n.unshift(t))),r+n.shift()+":"+n.map(function(t){return t<10?"0"+String(t):String(t)}).join(":")}t.exports=function(){return e}},function(t,r){t.exports=function(t){var r=function(t,r,e){var n=e&&e.split(":")||[],o={integer:{maximumFractionDigits:0},percent:{style:"percent"},currency:{style:"currency",currency:n[1]&&n[1].trim()||CURRENCY,minimumFractionDigits:2,maximumFractionDigits:2}};return new Intl.NumberFormat(r,o[n[0]]||{}).format(t)}.toString().replace("CURRENCY",JSON.stringify(t.currency||"USD")).match(/\(([^)]*)\)[^{]*{([\s\S]*)}/);return new Function(r[1],r[2])}},function(t,r){function e(t,r,e){var n={second:"numeric",minute:"numeric",hour:"numeric"};switch(e){case"full":case"long":n.timeZoneName="short";break;case"short":delete n.second}return new Date(t).toLocaleTimeString(r,n)}t.exports=function(){return e}},function(t,r,e){"use strict";e.r(r);var n=e(1),o=e.n(n),i=e(2),u={break:!0,continue:!0,delete:!0,else:!0,for:!0,function:!0,if:!0,in:!0,new:!0,return:!0,this:!0,typeof:!0,var:!0,void:!0,while:!0,with:!0,case:!0,catch:!0,default:!0,do:!0,finally:!0,instanceof:!0,switch:!0,throw:!0,try:!0},a={debugger:!0,class:!0,enum:!0,extends:!0,super:!0,const:!0,export:!0,import:!0,null:!0,true:!0,false:!0,implements:!0,let:!0,private:!0,public:!0,yield:!0,interface:!0,package:!0,protected:!0,static:!0};function c(t,r){if(/^[A-Z_$][0-9A-Z_$]*$/i.test(t)&&!u[t])return r?"".concat(r,".").concat(t):t;var e=JSON.stringify(t);return r?r+"[".concat(e,"]"):e}function h(t){var r=t.trim().replace(/\W+/g,"_");return u[r]||a[r]||/^\d/.test(r)?"_"+r:r}var f=new RegExp("^"+["ar","ckb","fa","he","ks($|[^bfh])","lrc","mzn","pa-Arab","ps","ug","ur","uz-Arab","yi"].join("|^"));function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.mf=r,this.lc=null,this.locales={},this.runtime={},this.formatters={}}var r,e,n;return r=t,(e=[{key:"compile",value:function(t,r,e){var n=this;if("object"!=s(t)){this.lc=r;var o=e[r]||{cardinal:[],ordinal:[]};o.strict=!!this.mf.options.strictNumberSign;var u=Object(i.parse)(t,o).map(function(t){return n.token(t)});return"function(d) { return ".concat(u.join(" + ")||'""',"; }")}var a={};for(var c in t){var h=e.hasOwnProperty(c)?c:r;a[c]=this.compile(t[c],h,e)}return a}},{key:"cases",value:function(t,r){var e=this,n="select"===t.type||!this.mf.hasCustomPluralFuncs,o=t.cases.map(function(t){var o=t.key,i=t.tokens;"other"===o&&(n=!1);var u=i.map(function(t){return e.token(t,r)});return c(o)+": "+(u.join(" + ")||'""')});if(n)throw new Error("No 'other' form found in "+JSON.stringify(t));return"{ ".concat(o.join(", ")," }")}},{key:"token",value:function(t,r){var e,n=this;if("string"==typeof t)return JSON.stringify(t);var o,i,u,a,s=[c(t.arg,"d")];switch(t.type){case"argument":return this.mf.options.biDiSupport?(o=s[0],i=this.lc,u=f.test(i),a=JSON.stringify(u?"‏":"‎"),"".concat(a," + ").concat(o," + ").concat(a)):s[0];case"select":e="select",r&&this.mf.options.strictNumberSign&&(r=null),s.push(this.cases(t,r)),this.runtime.select=!0;break;case"selectordinal":e="plural",s.push(0,h(this.lc),this.cases(t,t),1),this.locales[this.lc]=!0,this.runtime.plural=!0;break;case"plural":e="plural",s.push(t.offset||0,h(this.lc),this.cases(t,t)),this.locales[this.lc]=!0,this.runtime.plural=!0;break;case"function":if(!(t.key in this.mf.fmt)&&t.key in this.mf.constructor.formatters){var l=this.mf.constructor.formatters[t.key];this.mf.fmt[t.key]=l(this.mf)}if(!this.mf.fmt[t.key])throw new Error("Formatting function ".concat(JSON.stringify(t.key)," not found!"));if(s.push(JSON.stringify(this.lc)),t.param){r&&this.mf.options.strictNumberSign&&(r=null);var p=t.param.tokens.map(function(t){return n.token(t,r)});s.push("("+(p.join(" + ")||'""')+").trim()")}e=c(t.key,"fmt"),this.formatters[t.key]=!0;break;case"octothorpe":if(!r)return'"#"';e="number",s=[c(r.arg,"d"),JSON.stringify(r.arg)],r.offset&&s.push(r.offset),this.runtime.number=!0}if(!e)throw new Error("Parser error for token "+JSON.stringify(t));return"".concat(e,"(").concat(s.join(", "),")")}}])&&l(r.prototype,e),n&&l(r,n),t}(),m=e(3),d=e.n(m),y=e(0),g=e.n(y);function v(t,r,e){var n=function(){return r.apply(this,arguments)};if(n.toString=function(){return r.toString()},e){var o=d.a[t]||{};n.cardinal=o.cardinal,n.ordinal=o.ordinal}else n.cardinal=[],n.ordinal=[];return n}function w(t,r){for(var e=r.pluralKeyChecks,n=String(t);n;n=n.replace(/[-_]?[^-_]*$/,"")){var o=g.a[n];if(o)return v(n,o,e)}throw new Error("Localisation function not found for locale "+JSON.stringify(t))}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var k=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.plural=function(t,r,e,n,o){if({}.hasOwnProperty.call(n,t))return n[t];r&&(t-=r);var i=e(t,o);return i in n?n[i]:n.other},this.select=function(t,r){return{}.hasOwnProperty.call(r,t)?r[t]:r.other},this.mf=r,this.setStrictNumber(r.options.strictNumberSign)}var r,e,n;return r=t,(e=[{key:"setStrictNumber",value:function(r){this.number=r?t.strictNumber:t.defaultNumber}},{key:"toString",value:function(t,r){for(var e={},n=Object.keys(r.locales),o=0;o<n.length;++o){var i=n[o];e[h(i)]=t[i]}for(var u=Object.keys(r.runtime),a=0;a<u.length;++a){var f=u[a];e[f]=this[f]}var s=Object.keys(r.formatters);if(s.length>0){e.fmt={};for(var l=0;l<s.length;++l){var p=s[l];e.fmt[p]=this.mf.fmt[p]}}return function t(r,e){if("object"!=b(r)){var n=r.toString().replace(/^(function )\w*/,"$1"),o=/([ \t]*)\S.*$/.exec(n);return o?n.replace(new RegExp("^"+o[1],"mg"),""):n}var i=[];for(var u in r){var a=t(r[u],e+1);i.push(0===e?"var ".concat(u," = ").concat(a,";\n"):"".concat(c(u),": ").concat(a))}if(0===e)return i.join("");if(0===i.length)return"{}";for(var h="  ";--e;)h+="  ";var f=i.join(",\n").replace(/^/gm,h);return"{\n".concat(f,"\n}")}(e,0)}}])&&S(r.prototype,e),n&&S(r,n),t}();function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,r,e){return r&&A(t.prototype,r),e&&A(t,e),t}k.defaultNumber=function(t,r,e){if(!e)return t;if(isNaN(t))throw new Error("Can't apply offset:"+e+" to argument `"+r+"` with non-numerical value "+JSON.stringify(t)+".");return t-e},k.strictNumber=function(t,r,e){if(isNaN(t))throw new Error("Argument `"+r+"` has non-numerical value "+JSON.stringify(t)+".");return t-(e||0)},e.d(r,"default",function(){return N});var N=function(){function t(r,e){var n=this;if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=Object.assign({biDiSupport:!1,customFormatters:null,pluralKeyChecks:!0,strictNumberSign:!1},e),this.pluralFuncs={},"string"==typeof r)this.pluralFuncs[r]=w(r,this.options),this.defaultLocale=r;else if(Array.isArray(r))r.forEach(function(t){n.pluralFuncs[t]=w(t,n.options)}),this.defaultLocale=r[0];else{if(r)for(var o=Object.keys(r),i=0;i<o.length;++i){var u=o[i];if("function"!=typeof r[u]){var a="Expected function value for locale "+String(u);throw new Error(a)}this.pluralFuncs[u]=r[u],this.defaultLocale||(this.defaultLocale=u)}this.defaultLocale?this.hasCustomPluralFuncs=!0:(this.defaultLocale=t.defaultLocale,this.hasCustomPluralFuncs=!1)}this.fmt=Object.assign({},this.options.customFormatters),this.runtime=new k(this)}return j(t,null,[{key:"escape",value:function(t,r){var e=r?/[#{}]/g:/[{}]/g;return String(t).replace(e,"'$&'")}}]),j(t,[{key:"addFormatters",value:function(t){for(var r=Object.keys(t),e=0;e<r.length;++e){var n=r[e];this.fmt[n]=t[n]}return this}},{key:"disablePluralKeyChecks",value:function(){for(var t in this.options.pluralKeyChecks=!1,this.pluralFuncs){var r=this.pluralFuncs[t];r&&(r.cardinal=[],r.ordinal=[])}return this}},{key:"setBiDiSupport",value:function(t){return this.options.biDiSupport=!!t||void 0===t,this}},{key:"setStrictNumberSign",value:function(t){return this.options.strictNumberSign=!!t||void 0===t,this.runtime.setStrictNumber(this.options.strictNumberSign),this}},{key:"compile",value:function(t,r){var e={};if(0===Object.keys(this.pluralFuncs).length)if(r){var n=w(r,this.options);if(!n){var o=JSON.stringify(r);throw new Error("Locale ".concat(o," not found!"))}e[r]=n}else r=this.defaultLocale,e=function(t){for(var r=t.pluralKeyChecks,e={},n=Object.keys(g.a),o=0;o<n.length;++o){var i=n[o];e[i]=v(i,g.a[i],r)}return e}(this.options);else if(r){var i=this.pluralFuncs[r];if(!i){var u=JSON.stringify(r),a=JSON.stringify(this.pluralFuncs);throw new Error("Locale ".concat(u," not found in ").concat(a,"!"))}e[r]=i}else r=this.defaultLocale,e=this.pluralFuncs;var f=new p(this),s=f.compile(t,r,e);if("object"!=x(t)){var l=new Function("number, plural, select, fmt",h(r),"return "+s),m=this.runtime;return l(m.number,m.plural,m.select,this.fmt,e[r])}var d=this.runtime.toString(e,f)+"\n",y=function t(r,e){if(e||(e=0),"object"!=x(r))return r;for(var n="",o=0;o<e;++o)n+="  ";var i=[];for(var u in r){var a=t(r[u],e+1);i.push("\n".concat(n,"  ").concat(c(u),": ").concat(a))}return"{".concat(i.join(","),"\n").concat(n,"}")}(s),b=new Function(d+"return "+y)();if(b.hasOwnProperty("toString"))throw new Error("The top-level message key `toString` is reserved");return b.toString=function(t){return t&&"export default"!==t?t.indexOf(".")>-1?d+t+" = "+y:d+["(function (root, G) {",'  if (typeof define === "function" && define.amd) { define(G); }','  else if (typeof exports === "object") { module.exports = G; }',"  else { "+c(t,"root")+" = G; }","})(this, "+y+");"].join("\n"):d+"export default "+y},b}}]),t}();N.defaultLocale="en",N.formatters=o.a}]).default});

},{}],5:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],6:[function(require,module,exports){
(function (process,global,setImmediate){(function (){
/*!
 * QUnit 2.11.3
 * https://qunitjs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2020-10-05T01:34Z
 */
(function (global$1) {
	'use strict';

	function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

	var global__default = /*#__PURE__*/_interopDefaultLegacy(global$1);

	var window$1 = global__default['default'].window;
	var self$1 = global__default['default'].self;
	var console = global__default['default'].console;
	var setTimeout$1 = global__default['default'].setTimeout;
	var clearTimeout = global__default['default'].clearTimeout;
	var document$1 = window$1 && window$1.document;
	var navigator = window$1 && window$1.navigator;
	var localSessionStorage = function () {
	  var x = "qunit-test-string";

	  try {
	    global__default['default'].sessionStorage.setItem(x, x);
	    global__default['default'].sessionStorage.removeItem(x);
	    return global__default['default'].sessionStorage;
	  } catch (e) {
	    return undefined;
	  }
	}(); // Support IE 9-10: Fallback for fuzzysort.js used by /reporter/html.js

	if (!global__default['default'].Map) {
	  global__default['default'].Map = function StringMap() {
	    var store = Object.create(null);

	    this.get = function (strKey) {
	      return store[strKey];
	    };

	    this.set = function (strKey, val) {
	      store[strKey] = val;
	      return this;
	    };

	    this.clear = function () {
	      store = Object.create(null);
	    };
	  };
	}

	function _typeof(obj) {
	  "@babel/helpers - typeof";

	  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
	    _typeof = function (obj) {
	      return typeof obj;
	    };
	  } else {
	    _typeof = function (obj) {
	      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
	    };
	  }

	  return _typeof(obj);
	}

	function _classCallCheck(instance, Constructor) {
	  if (!(instance instanceof Constructor)) {
	    throw new TypeError("Cannot call a class as a function");
	  }
	}

	function _defineProperties(target, props) {
	  for (var i = 0; i < props.length; i++) {
	    var descriptor = props[i];
	    descriptor.enumerable = descriptor.enumerable || false;
	    descriptor.configurable = true;
	    if ("value" in descriptor) descriptor.writable = true;
	    Object.defineProperty(target, descriptor.key, descriptor);
	  }
	}

	function _createClass(Constructor, protoProps, staticProps) {
	  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
	  if (staticProps) _defineProperties(Constructor, staticProps);
	  return Constructor;
	}

	function _toConsumableArray(arr) {
	  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
	}

	function _arrayWithoutHoles(arr) {
	  if (Array.isArray(arr)) return _arrayLikeToArray(arr);
	}

	function _iterableToArray(iter) {
	  if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);
	}

	function _unsupportedIterableToArray(o, minLen) {
	  if (!o) return;
	  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
	  var n = Object.prototype.toString.call(o).slice(8, -1);
	  if (n === "Object" && o.constructor) n = o.constructor.name;
	  if (n === "Map" || n === "Set") return Array.from(o);
	  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
	}

	function _arrayLikeToArray(arr, len) {
	  if (len == null || len > arr.length) len = arr.length;

	  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

	  return arr2;
	}

	function _nonIterableSpread() {
	  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
	}

	function _createForOfIteratorHelper(o, allowArrayLike) {
	  var it;

	  if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) {
	    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
	      if (it) o = it;
	      var i = 0;

	      var F = function () {};

	      return {
	        s: F,
	        n: function () {
	          if (i >= o.length) return {
	            done: true
	          };
	          return {
	            done: false,
	            value: o[i++]
	          };
	        },
	        e: function (e) {
	          throw e;
	        },
	        f: F
	      };
	    }

	    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
	  }

	  var normalCompletion = true,
	      didErr = false,
	      err;
	  return {
	    s: function () {
	      it = o[Symbol.iterator]();
	    },
	    n: function () {
	      var step = it.next();
	      normalCompletion = step.done;
	      return step;
	    },
	    e: function (e) {
	      didErr = true;
	      err = e;
	    },
	    f: function () {
	      try {
	        if (!normalCompletion && it.return != null) it.return();
	      } finally {
	        if (didErr) throw err;
	      }
	    }
	  };
	}

	// This allows support for IE 9, which doesn't have a console
	// object if the developer tools are not open.

	var Logger = {
	  warn: console ? console.warn.bind(console) : function () {}
	};

	var toString = Object.prototype.toString;
	var hasOwn = Object.prototype.hasOwnProperty;
	var now = Date.now || function () {
	  return new Date().getTime();
	};
	var hasPerformanceApi = detectPerformanceApi();
	var performance = hasPerformanceApi ? window$1.performance : undefined;
	var performanceNow = hasPerformanceApi ? performance.now.bind(performance) : now;

	function detectPerformanceApi() {
	  return window$1 && typeof window$1.performance !== "undefined" && typeof window$1.performance.mark === "function" && typeof window$1.performance.measure === "function";
	}

	function measure(comment, startMark, endMark) {
	  // `performance.measure` may fail if the mark could not be found.
	  // reasons a specific mark could not be found include: outside code invoking `performance.clearMarks()`
	  try {
	    performance.measure(comment, startMark, endMark);
	  } catch (ex) {
	    Logger.warn("performance.measure could not be executed because of ", ex.message);
	  }
	}
	var defined = {
	  document: window$1 && window$1.document !== undefined,
	  setTimeout: setTimeout$1 !== undefined
	}; // Returns a new Array with the elements that are in a but not in b

	function diff(a, b) {
	  var i,
	      j,
	      result = a.slice();

	  for (i = 0; i < result.length; i++) {
	    for (j = 0; j < b.length; j++) {
	      if (result[i] === b[j]) {
	        result.splice(i, 1);
	        i--;
	        break;
	      }
	    }
	  }

	  return result;
	}
	/**
	 * Determines whether an element exists in a given array or not.
	 *
	 * @method inArray
	 * @param {Any} elem
	 * @param {Array} array
	 * @return {Boolean}
	 */

	function inArray(elem, array) {
	  return array.indexOf(elem) !== -1;
	}
	/**
	 * Makes a clone of an object using only Array or Object as base,
	 * and copies over the own enumerable properties.
	 *
	 * @param {Object} obj
	 * @return {Object} New object with only the own properties (recursively).
	 */

	function objectValues(obj) {
	  var key,
	      val,
	      vals = is("array", obj) ? [] : {};

	  for (key in obj) {
	    if (hasOwn.call(obj, key)) {
	      val = obj[key];
	      vals[key] = val === Object(val) ? objectValues(val) : val;
	    }
	  }

	  return vals;
	}
	function extend(a, b, undefOnly) {
	  for (var prop in b) {
	    if (hasOwn.call(b, prop)) {
	      if (b[prop] === undefined) {
	        delete a[prop];
	      } else if (!(undefOnly && typeof a[prop] !== "undefined")) {
	        a[prop] = b[prop];
	      }
	    }
	  }

	  return a;
	}
	function objectType(obj) {
	  if (typeof obj === "undefined") {
	    return "undefined";
	  } // Consider: typeof null === object


	  if (obj === null) {
	    return "null";
	  }

	  var match = toString.call(obj).match(/^\[object\s(.*)\]$/),
	      type = match && match[1];

	  switch (type) {
	    case "Number":
	      if (isNaN(obj)) {
	        return "nan";
	      }

	      return "number";

	    case "String":
	    case "Boolean":
	    case "Array":
	    case "Set":
	    case "Map":
	    case "Date":
	    case "RegExp":
	    case "Function":
	    case "Symbol":
	      return type.toLowerCase();

	    default:
	      return _typeof(obj);
	  }
	} // Safe object type checking

	function is(type, obj) {
	  return objectType(obj) === type;
	} // Based on Java's String.hashCode, a simple but not
	// rigorously collision resistant hashing function

	function generateHash(module, testName) {
	  var str = module + "\x1C" + testName;
	  var hash = 0;

	  for (var i = 0; i < str.length; i++) {
	    hash = (hash << 5) - hash + str.charCodeAt(i);
	    hash |= 0;
	  } // Convert the possibly negative integer hash code into an 8 character hex string, which isn't
	  // strictly necessary but increases user understanding that the id is a SHA-like hash


	  var hex = (0x100000000 + hash).toString(16);

	  if (hex.length < 8) {
	    hex = "0000000" + hex;
	  }

	  return hex.slice(-8);
	}

	// Authors: Philippe Rathé <prathe@gmail.com>, David Chan <david@troi.org>

	var equiv = (function () {
	  // Value pairs queued for comparison. Used for breadth-first processing order, recursion
	  // detection and avoiding repeated comparison (see below for details).
	  // Elements are { a: val, b: val }.
	  var pairs = [];

	  var getProto = Object.getPrototypeOf || function (obj) {
	    return obj.__proto__;
	  };

	  function useStrictEquality(a, b) {
	    // This only gets called if a and b are not strict equal, and is used to compare on
	    // the primitive values inside object wrappers. For example:
	    // `var i = 1;`
	    // `var j = new Number(1);`
	    // Neither a nor b can be null, as a !== b and they have the same type.
	    if (_typeof(a) === "object") {
	      a = a.valueOf();
	    }

	    if (_typeof(b) === "object") {
	      b = b.valueOf();
	    }

	    return a === b;
	  }

	  function compareConstructors(a, b) {
	    var protoA = getProto(a);
	    var protoB = getProto(b); // Comparing constructors is more strict than using `instanceof`

	    if (a.constructor === b.constructor) {
	      return true;
	    } // Ref #851
	    // If the obj prototype descends from a null constructor, treat it
	    // as a null prototype.


	    if (protoA && protoA.constructor === null) {
	      protoA = null;
	    }

	    if (protoB && protoB.constructor === null) {
	      protoB = null;
	    } // Allow objects with no prototype to be equivalent to
	    // objects with Object as their constructor.


	    if (protoA === null && protoB === Object.prototype || protoB === null && protoA === Object.prototype) {
	      return true;
	    }

	    return false;
	  }

	  function getRegExpFlags(regexp) {
	    return "flags" in regexp ? regexp.flags : regexp.toString().match(/[gimuy]*$/)[0];
	  }

	  function isContainer(val) {
	    return ["object", "array", "map", "set"].indexOf(objectType(val)) !== -1;
	  }

	  function breadthFirstCompareChild(a, b) {
	    // If a is a container not reference-equal to b, postpone the comparison to the
	    // end of the pairs queue -- unless (a, b) has been seen before, in which case skip
	    // over the pair.
	    if (a === b) {
	      return true;
	    }

	    if (!isContainer(a)) {
	      return typeEquiv(a, b);
	    }

	    if (pairs.every(function (pair) {
	      return pair.a !== a || pair.b !== b;
	    })) {
	      // Not yet started comparing this pair
	      pairs.push({
	        a: a,
	        b: b
	      });
	    }

	    return true;
	  }

	  var callbacks = {
	    "string": useStrictEquality,
	    "boolean": useStrictEquality,
	    "number": useStrictEquality,
	    "null": useStrictEquality,
	    "undefined": useStrictEquality,
	    "symbol": useStrictEquality,
	    "date": useStrictEquality,
	    "nan": function nan() {
	      return true;
	    },
	    "regexp": function regexp(a, b) {
	      return a.source === b.source && // Include flags in the comparison
	      getRegExpFlags(a) === getRegExpFlags(b);
	    },
	    // abort (identical references / instance methods were skipped earlier)
	    "function": function _function() {
	      return false;
	    },
	    "array": function array(a, b) {
	      var i, len;
	      len = a.length;

	      if (len !== b.length) {
	        // Safe and faster
	        return false;
	      }

	      for (i = 0; i < len; i++) {
	        // Compare non-containers; queue non-reference-equal containers
	        if (!breadthFirstCompareChild(a[i], b[i])) {
	          return false;
	        }
	      }

	      return true;
	    },
	    // Define sets a and b to be equivalent if for each element aVal in a, there
	    // is some element bVal in b such that aVal and bVal are equivalent. Element
	    // repetitions are not counted, so these are equivalent:
	    // a = new Set( [ {}, [], [] ] );
	    // b = new Set( [ {}, {}, [] ] );
	    "set": function set(a, b) {
	      var innerEq,
	          outerEq = true;

	      if (a.size !== b.size) {
	        // This optimization has certain quirks because of the lack of
	        // repetition counting. For instance, adding the same
	        // (reference-identical) element to two equivalent sets can
	        // make them non-equivalent.
	        return false;
	      }

	      a.forEach(function (aVal) {
	        // Short-circuit if the result is already known. (Using for...of
	        // with a break clause would be cleaner here, but it would cause
	        // a syntax error on older Javascript implementations even if
	        // Set is unused)
	        if (!outerEq) {
	          return;
	        }

	        innerEq = false;
	        b.forEach(function (bVal) {
	          var parentPairs; // Likewise, short-circuit if the result is already known

	          if (innerEq) {
	            return;
	          } // Swap out the global pairs list, as the nested call to
	          // innerEquiv will clobber its contents


	          parentPairs = pairs;

	          if (innerEquiv(bVal, aVal)) {
	            innerEq = true;
	          } // Replace the global pairs list


	          pairs = parentPairs;
	        });

	        if (!innerEq) {
	          outerEq = false;
	        }
	      });
	      return outerEq;
	    },
	    // Define maps a and b to be equivalent if for each key-value pair (aKey, aVal)
	    // in a, there is some key-value pair (bKey, bVal) in b such that
	    // [ aKey, aVal ] and [ bKey, bVal ] are equivalent. Key repetitions are not
	    // counted, so these are equivalent:
	    // a = new Map( [ [ {}, 1 ], [ {}, 1 ], [ [], 1 ] ] );
	    // b = new Map( [ [ {}, 1 ], [ [], 1 ], [ [], 1 ] ] );
	    "map": function map(a, b) {
	      var innerEq,
	          outerEq = true;

	      if (a.size !== b.size) {
	        // This optimization has certain quirks because of the lack of
	        // repetition counting. For instance, adding the same
	        // (reference-identical) key-value pair to two equivalent maps
	        // can make them non-equivalent.
	        return false;
	      }

	      a.forEach(function (aVal, aKey) {
	        // Short-circuit if the result is already known. (Using for...of
	        // with a break clause would be cleaner here, but it would cause
	        // a syntax error on older Javascript implementations even if
	        // Map is unused)
	        if (!outerEq) {
	          return;
	        }

	        innerEq = false;
	        b.forEach(function (bVal, bKey) {
	          var parentPairs; // Likewise, short-circuit if the result is already known

	          if (innerEq) {
	            return;
	          } // Swap out the global pairs list, as the nested call to
	          // innerEquiv will clobber its contents


	          parentPairs = pairs;

	          if (innerEquiv([bVal, bKey], [aVal, aKey])) {
	            innerEq = true;
	          } // Replace the global pairs list


	          pairs = parentPairs;
	        });

	        if (!innerEq) {
	          outerEq = false;
	        }
	      });
	      return outerEq;
	    },
	    "object": function object(a, b) {
	      var i,
	          aProperties = [],
	          bProperties = [];

	      if (compareConstructors(a, b) === false) {
	        return false;
	      } // Be strict: don't ensure hasOwnProperty and go deep


	      for (i in a) {
	        // Collect a's properties
	        aProperties.push(i); // Skip OOP methods that look the same

	        if (a.constructor !== Object && typeof a.constructor !== "undefined" && typeof a[i] === "function" && typeof b[i] === "function" && a[i].toString() === b[i].toString()) {
	          continue;
	        } // Compare non-containers; queue non-reference-equal containers


	        if (!breadthFirstCompareChild(a[i], b[i])) {
	          return false;
	        }
	      }

	      for (i in b) {
	        // Collect b's properties
	        bProperties.push(i);
	      } // Ensures identical properties name


	      return typeEquiv(aProperties.sort(), bProperties.sort());
	    }
	  };

	  function typeEquiv(a, b) {
	    var type = objectType(a); // Callbacks for containers will append to the pairs queue to achieve breadth-first
	    // search order. The pairs queue is also used to avoid reprocessing any pair of
	    // containers that are reference-equal to a previously visited pair (a special case
	    // this being recursion detection).
	    //
	    // Because of this approach, once typeEquiv returns a false value, it should not be
	    // called again without clearing the pair queue else it may wrongly report a visited
	    // pair as being equivalent.

	    return objectType(b) === type && callbacks[type](a, b);
	  }

	  function innerEquiv(a, b) {
	    var i, pair; // We're done when there's nothing more to compare

	    if (arguments.length < 2) {
	      return true;
	    } // Clear the global pair queue and add the top-level values being compared


	    pairs = [{
	      a: a,
	      b: b
	    }];

	    for (i = 0; i < pairs.length; i++) {
	      pair = pairs[i]; // Perform type-specific comparison on any pairs that are not strictly
	      // equal. For container types, that comparison will postpone comparison
	      // of any sub-container pair to the end of the pair queue. This gives
	      // breadth-first search order. It also avoids the reprocessing of
	      // reference-equal siblings, cousins etc, which can have a significant speed
	      // impact when comparing a container of small objects each of which has a
	      // reference to the same (singleton) large object.

	      if (pair.a !== pair.b && !typeEquiv(pair.a, pair.b)) {
	        return false;
	      }
	    } // ...across all consecutive argument pairs


	    return arguments.length === 2 || innerEquiv.apply(this, [].slice.call(arguments, 1));
	  }

	  return function () {
	    var result = innerEquiv.apply(void 0, arguments); // Release any retained objects

	    pairs.length = 0;
	    return result;
	  };
	})();

	/**
	 * Config object: Maintain internal state
	 * Later exposed as QUnit.config
	 * `config` initialized at top of scope
	 */

	var config = {
	  // The queue of tests to run
	  queue: [],
	  // Block until document ready
	  blocking: true,
	  // By default, run previously failed tests first
	  // very useful in combination with "Hide passed tests" checked
	  reorder: true,
	  // By default, modify document.title when suite is done
	  altertitle: true,
	  // HTML Reporter: collapse every test except the first failing test
	  // If false, all failing tests will be expanded
	  collapse: true,
	  // By default, scroll to top of the page when suite is done
	  scrolltop: true,
	  // Depth up-to which object will be dumped
	  maxDepth: 5,
	  // When enabled, all tests must call expect()
	  requireExpects: false,
	  // Placeholder for user-configurable form-exposed URL parameters
	  urlConfig: [],
	  // Set of all modules.
	  modules: [],
	  // The first unnamed module
	  currentModule: {
	    name: "",
	    tests: [],
	    childModules: [],
	    testsRun: 0,
	    unskippedTestsRun: 0,
	    hooks: {
	      before: [],
	      beforeEach: [],
	      afterEach: [],
	      after: []
	    }
	  },
	  callbacks: {},
	  // The storage module to use for reordering tests
	  storage: localSessionStorage
	}; // take a predefined QUnit.config and extend the defaults

	var globalConfig = window$1 && window$1.QUnit && window$1.QUnit.config; // only extend the global config if there is no QUnit overload

	if (window$1 && window$1.QUnit && !window$1.QUnit.version) {
	  extend(config, globalConfig);
	} // Push a loose unnamed module to the modules collection


	config.modules.push(config.currentModule);

	// https://flesler.blogspot.com/2008/05/jsdump-pretty-dump-of-any-javascript.html

	var dump = (function () {
	  function quote(str) {
	    return "\"" + str.toString().replace(/\\/g, "\\\\").replace(/"/g, "\\\"") + "\"";
	  }

	  function literal(o) {
	    return o + "";
	  }

	  function join(pre, arr, post) {
	    var s = dump.separator(),
	        base = dump.indent(),
	        inner = dump.indent(1);

	    if (arr.join) {
	      arr = arr.join("," + s + inner);
	    }

	    if (!arr) {
	      return pre + post;
	    }

	    return [pre, inner + arr, base + post].join(s);
	  }

	  function array(arr, stack) {
	    var i = arr.length,
	        ret = new Array(i);

	    if (dump.maxDepth && dump.depth > dump.maxDepth) {
	      return "[object Array]";
	    }

	    this.up();

	    while (i--) {
	      ret[i] = this.parse(arr[i], undefined, stack);
	    }

	    this.down();
	    return join("[", ret, "]");
	  }

	  function isArray(obj) {
	    return (//Native Arrays
	      toString.call(obj) === "[object Array]" || // NodeList objects
	      typeof obj.length === "number" && obj.item !== undefined && (obj.length ? obj.item(0) === obj[0] : obj.item(0) === null && obj[0] === undefined)
	    );
	  }

	  var reName = /^function (\w+)/,
	      dump = {
	    // The objType is used mostly internally, you can fix a (custom) type in advance
	    parse: function parse(obj, objType, stack) {
	      stack = stack || [];
	      var res,
	          parser,
	          parserType,
	          objIndex = stack.indexOf(obj);

	      if (objIndex !== -1) {
	        return "recursion(".concat(objIndex - stack.length, ")");
	      }

	      objType = objType || this.typeOf(obj);
	      parser = this.parsers[objType];
	      parserType = _typeof(parser);

	      if (parserType === "function") {
	        stack.push(obj);
	        res = parser.call(this, obj, stack);
	        stack.pop();
	        return res;
	      }

	      return parserType === "string" ? parser : this.parsers.error;
	    },
	    typeOf: function typeOf(obj) {
	      var type;

	      if (obj === null) {
	        type = "null";
	      } else if (typeof obj === "undefined") {
	        type = "undefined";
	      } else if (is("regexp", obj)) {
	        type = "regexp";
	      } else if (is("date", obj)) {
	        type = "date";
	      } else if (is("function", obj)) {
	        type = "function";
	      } else if (obj.setInterval !== undefined && obj.document !== undefined && obj.nodeType === undefined) {
	        type = "window";
	      } else if (obj.nodeType === 9) {
	        type = "document";
	      } else if (obj.nodeType) {
	        type = "node";
	      } else if (isArray(obj)) {
	        type = "array";
	      } else if (obj.constructor === Error.prototype.constructor) {
	        type = "error";
	      } else {
	        type = _typeof(obj);
	      }

	      return type;
	    },
	    separator: function separator() {
	      if (this.multiline) {
	        return this.HTML ? "<br />" : "\n";
	      } else {
	        return this.HTML ? "&#160;" : " ";
	      }
	    },
	    // Extra can be a number, shortcut for increasing-calling-decreasing
	    indent: function indent(extra) {
	      if (!this.multiline) {
	        return "";
	      }

	      var chr = this.indentChar;

	      if (this.HTML) {
	        chr = chr.replace(/\t/g, "   ").replace(/ /g, "&#160;");
	      }

	      return new Array(this.depth + (extra || 0)).join(chr);
	    },
	    up: function up(a) {
	      this.depth += a || 1;
	    },
	    down: function down(a) {
	      this.depth -= a || 1;
	    },
	    setParser: function setParser(name, parser) {
	      this.parsers[name] = parser;
	    },
	    // The next 3 are exposed so you can use them
	    quote: quote,
	    literal: literal,
	    join: join,
	    depth: 1,
	    maxDepth: config.maxDepth,
	    // This is the list of parsers, to modify them, use dump.setParser
	    parsers: {
	      window: "[Window]",
	      document: "[Document]",
	      error: function error(_error) {
	        return "Error(\"" + _error.message + "\")";
	      },
	      unknown: "[Unknown]",
	      "null": "null",
	      "undefined": "undefined",
	      "function": function _function(fn) {
	        var ret = "function",
	            // Functions never have name in IE
	        name = "name" in fn ? fn.name : (reName.exec(fn) || [])[1];

	        if (name) {
	          ret += " " + name;
	        }

	        ret += "(";
	        ret = [ret, dump.parse(fn, "functionArgs"), "){"].join("");
	        return join(ret, dump.parse(fn, "functionCode"), "}");
	      },
	      array: array,
	      nodelist: array,
	      "arguments": array,
	      object: function object(map, stack) {
	        var keys,
	            key,
	            val,
	            i,
	            nonEnumerableProperties,
	            ret = [];

	        if (dump.maxDepth && dump.depth > dump.maxDepth) {
	          return "[object Object]";
	        }

	        dump.up();
	        keys = [];

	        for (key in map) {
	          keys.push(key);
	        } // Some properties are not always enumerable on Error objects.


	        nonEnumerableProperties = ["message", "name"];

	        for (i in nonEnumerableProperties) {
	          key = nonEnumerableProperties[i];

	          if (key in map && !inArray(key, keys)) {
	            keys.push(key);
	          }
	        }

	        keys.sort();

	        for (i = 0; i < keys.length; i++) {
	          key = keys[i];
	          val = map[key];
	          ret.push(dump.parse(key, "key") + ": " + dump.parse(val, undefined, stack));
	        }

	        dump.down();
	        return join("{", ret, "}");
	      },
	      node: function node(_node) {
	        var len,
	            i,
	            val,
	            open = dump.HTML ? "&lt;" : "<",
	            close = dump.HTML ? "&gt;" : ">",
	            tag = _node.nodeName.toLowerCase(),
	            ret = open + tag,
	            attrs = _node.attributes;

	        if (attrs) {
	          for (i = 0, len = attrs.length; i < len; i++) {
	            val = attrs[i].nodeValue; // IE6 includes all attributes in .attributes, even ones not explicitly
	            // set. Those have values like undefined, null, 0, false, "" or
	            // "inherit".

	            if (val && val !== "inherit") {
	              ret += " " + attrs[i].nodeName + "=" + dump.parse(val, "attribute");
	            }
	          }
	        }

	        ret += close; // Show content of TextNode or CDATASection

	        if (_node.nodeType === 3 || _node.nodeType === 4) {
	          ret += _node.nodeValue;
	        }

	        return ret + open + "/" + tag + close;
	      },
	      // Function calls it internally, it's the arguments part of the function
	      functionArgs: function functionArgs(fn) {
	        var args,
	            l = fn.length;

	        if (!l) {
	          return "";
	        }

	        args = new Array(l);

	        while (l--) {
	          // 97 is 'a'
	          args[l] = String.fromCharCode(97 + l);
	        }

	        return " " + args.join(", ") + " ";
	      },
	      // Object calls it internally, the key part of an item in a map
	      key: quote,
	      // Function calls it internally, it's the content of the function
	      functionCode: "[code]",
	      // Node calls it internally, it's a html attribute value
	      attribute: quote,
	      string: quote,
	      date: quote,
	      regexp: literal,
	      number: literal,
	      "boolean": literal,
	      symbol: function symbol(sym) {
	        return sym.toString();
	      }
	    },
	    // If true, entities are escaped ( <, >, \t, space and \n )
	    HTML: false,
	    // Indentation unit
	    indentChar: "  ",
	    // If true, items in a collection, are separated by a \n, else just a space.
	    multiline: true
	  };
	  return dump;
	})();

	var SuiteReport = /*#__PURE__*/function () {
	  function SuiteReport(name, parentSuite) {
	    _classCallCheck(this, SuiteReport);

	    this.name = name;
	    this.fullName = parentSuite ? parentSuite.fullName.concat(name) : [];
	    this.tests = [];
	    this.childSuites = [];

	    if (parentSuite) {
	      parentSuite.pushChildSuite(this);
	    }
	  }

	  _createClass(SuiteReport, [{
	    key: "start",
	    value: function start(recordTime) {
	      if (recordTime) {
	        this._startTime = performanceNow();

	        if (performance) {
	          var suiteLevel = this.fullName.length;
	          performance.mark("qunit_suite_".concat(suiteLevel, "_start"));
	        }
	      }

	      return {
	        name: this.name,
	        fullName: this.fullName.slice(),
	        tests: this.tests.map(function (test) {
	          return test.start();
	        }),
	        childSuites: this.childSuites.map(function (suite) {
	          return suite.start();
	        }),
	        testCounts: {
	          total: this.getTestCounts().total
	        }
	      };
	    }
	  }, {
	    key: "end",
	    value: function end(recordTime) {
	      if (recordTime) {
	        this._endTime = performanceNow();

	        if (performance) {
	          var suiteLevel = this.fullName.length;
	          performance.mark("qunit_suite_".concat(suiteLevel, "_end"));
	          var suiteName = this.fullName.join(" – ");
	          measure(suiteLevel === 0 ? "QUnit Test Run" : "QUnit Test Suite: ".concat(suiteName), "qunit_suite_".concat(suiteLevel, "_start"), "qunit_suite_".concat(suiteLevel, "_end"));
	        }
	      }

	      return {
	        name: this.name,
	        fullName: this.fullName.slice(),
	        tests: this.tests.map(function (test) {
	          return test.end();
	        }),
	        childSuites: this.childSuites.map(function (suite) {
	          return suite.end();
	        }),
	        testCounts: this.getTestCounts(),
	        runtime: this.getRuntime(),
	        status: this.getStatus()
	      };
	    }
	  }, {
	    key: "pushChildSuite",
	    value: function pushChildSuite(suite) {
	      this.childSuites.push(suite);
	    }
	  }, {
	    key: "pushTest",
	    value: function pushTest(test) {
	      this.tests.push(test);
	    }
	  }, {
	    key: "getRuntime",
	    value: function getRuntime() {
	      return this._endTime - this._startTime;
	    }
	  }, {
	    key: "getTestCounts",
	    value: function getTestCounts() {
	      var counts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
	        passed: 0,
	        failed: 0,
	        skipped: 0,
	        todo: 0,
	        total: 0
	      };
	      counts = this.tests.reduce(function (counts, test) {
	        if (test.valid) {
	          counts[test.getStatus()]++;
	          counts.total++;
	        }

	        return counts;
	      }, counts);
	      return this.childSuites.reduce(function (counts, suite) {
	        return suite.getTestCounts(counts);
	      }, counts);
	    }
	  }, {
	    key: "getStatus",
	    value: function getStatus() {
	      var _this$getTestCounts = this.getTestCounts(),
	          total = _this$getTestCounts.total,
	          failed = _this$getTestCounts.failed,
	          skipped = _this$getTestCounts.skipped,
	          todo = _this$getTestCounts.todo;

	      if (failed) {
	        return "failed";
	      } else {
	        if (skipped === total) {
	          return "skipped";
	        } else if (todo === total) {
	          return "todo";
	        } else {
	          return "passed";
	        }
	      }
	    }
	  }]);

	  return SuiteReport;
	}();

	var focused = false;
	var moduleStack = [];

	function isParentModuleInQueue() {
	  var modulesInQueue = config.modules.map(function (module) {
	    return module.moduleId;
	  });
	  return moduleStack.some(function (module) {
	    return modulesInQueue.includes(module.moduleId);
	  });
	}

	function createModule(name, testEnvironment, modifiers) {
	  var parentModule = moduleStack.length ? moduleStack.slice(-1)[0] : null;
	  var moduleName = parentModule !== null ? [parentModule.name, name].join(" > ") : name;
	  var parentSuite = parentModule ? parentModule.suiteReport : globalSuite;
	  var skip = parentModule !== null && parentModule.skip || modifiers.skip;
	  var todo = parentModule !== null && parentModule.todo || modifiers.todo;
	  var module = {
	    name: moduleName,
	    parentModule: parentModule,
	    tests: [],
	    moduleId: generateHash(moduleName),
	    testsRun: 0,
	    unskippedTestsRun: 0,
	    childModules: [],
	    suiteReport: new SuiteReport(name, parentSuite),
	    // Pass along `skip` and `todo` properties from parent module, in case
	    // there is one, to childs. And use own otherwise.
	    // This property will be used to mark own tests and tests of child suites
	    // as either `skipped` or `todo`.
	    skip: skip,
	    todo: skip ? false : todo
	  };
	  var env = {};

	  if (parentModule) {
	    parentModule.childModules.push(module);
	    extend(env, parentModule.testEnvironment);
	  }

	  extend(env, testEnvironment);
	  module.testEnvironment = env;
	  config.modules.push(module);
	  return module;
	}

	function processModule(name, options, executeNow) {
	  var modifiers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

	  if (objectType(options) === "function") {
	    executeNow = options;
	    options = undefined;
	  }

	  var module = createModule(name, options, modifiers); // Move any hooks to a 'hooks' object

	  var testEnvironment = module.testEnvironment;
	  var hooks = module.hooks = {};
	  setHookFromEnvironment(hooks, testEnvironment, "before");
	  setHookFromEnvironment(hooks, testEnvironment, "beforeEach");
	  setHookFromEnvironment(hooks, testEnvironment, "afterEach");
	  setHookFromEnvironment(hooks, testEnvironment, "after");
	  var moduleFns = {
	    before: setHookFunction(module, "before"),
	    beforeEach: setHookFunction(module, "beforeEach"),
	    afterEach: setHookFunction(module, "afterEach"),
	    after: setHookFunction(module, "after")
	  };
	  var currentModule = config.currentModule;

	  if (objectType(executeNow) === "function") {
	    moduleStack.push(module);
	    config.currentModule = module;
	    executeNow.call(module.testEnvironment, moduleFns);
	    moduleStack.pop();
	    module = module.parentModule || currentModule;
	  }

	  config.currentModule = module;

	  function setHookFromEnvironment(hooks, environment, name) {
	    var potentialHook = environment[name];
	    hooks[name] = typeof potentialHook === "function" ? [potentialHook] : [];
	    delete environment[name];
	  }

	  function setHookFunction(module, hookName) {
	    return function setHook(callback) {
	      module.hooks[hookName].push(callback);
	    };
	  }
	}

	function module$1(name, options, executeNow) {
	  if (focused && !isParentModuleInQueue()) {
	    return;
	  }

	  processModule(name, options, executeNow);
	}

	module$1.only = function () {
	  if (!focused) {
	    config.modules.length = 0;
	    config.queue.length = 0;
	  }

	  processModule.apply(void 0, arguments);
	  focused = true;
	};

	module$1.skip = function (name, options, executeNow) {
	  if (focused) {
	    return;
	  }

	  processModule(name, options, executeNow, {
	    skip: true
	  });
	};

	module$1.todo = function (name, options, executeNow) {
	  if (focused) {
	    return;
	  }

	  processModule(name, options, executeNow, {
	    todo: true
	  });
	};

	var LISTENERS = Object.create(null);
	var SUPPORTED_EVENTS = ["runStart", "suiteStart", "testStart", "assertion", "testEnd", "suiteEnd", "runEnd"];
	/**
	 * Emits an event with the specified data to all currently registered listeners.
	 * Callbacks will fire in the order in which they are registered (FIFO). This
	 * function is not exposed publicly; it is used by QUnit internals to emit
	 * logging events.
	 *
	 * @private
	 * @method emit
	 * @param {String} eventName
	 * @param {Object} data
	 * @return {Void}
	 */

	function emit(eventName, data) {
	  if (objectType(eventName) !== "string") {
	    throw new TypeError("eventName must be a string when emitting an event");
	  } // Clone the callbacks in case one of them registers a new callback


	  var originalCallbacks = LISTENERS[eventName];
	  var callbacks = originalCallbacks ? _toConsumableArray(originalCallbacks) : [];

	  for (var i = 0; i < callbacks.length; i++) {
	    callbacks[i](data);
	  }
	}
	/**
	 * Registers a callback as a listener to the specified event.
	 *
	 * @public
	 * @method on
	 * @param {String} eventName
	 * @param {Function} callback
	 * @return {Void}
	 */

	function on(eventName, callback) {
	  if (objectType(eventName) !== "string") {
	    throw new TypeError("eventName must be a string when registering a listener");
	  } else if (!inArray(eventName, SUPPORTED_EVENTS)) {
	    var events = SUPPORTED_EVENTS.join(", ");
	    throw new Error("\"".concat(eventName, "\" is not a valid event; must be one of: ").concat(events, "."));
	  } else if (objectType(callback) !== "function") {
	    throw new TypeError("callback must be a function when registering a listener");
	  }

	  if (!LISTENERS[eventName]) {
	    LISTENERS[eventName] = [];
	  } // Don't register the same callback more than once


	  if (!inArray(callback, LISTENERS[eventName])) {
	    LISTENERS[eventName].push(callback);
	  }
	}

	var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

	function createCommonjsModule(fn, basedir, module) {
		return module = {
		  path: basedir,
		  exports: {},
		  require: function (path, base) {
	      return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
	    }
		}, fn(module, module.exports), module.exports;
	}

	function commonjsRequire () {
		throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
	}

	var es6Promise = createCommonjsModule(function (module, exports) {
	  /*!
	   * @overview es6-promise - a tiny implementation of Promises/A+.
	   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	   * @license   Licensed under MIT license
	   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	   * @version   v4.2.8+1e68dce6
	   */
	  (function (global, factory) {
	     module.exports = factory() ;
	  })(commonjsGlobal, function () {

	    function objectOrFunction(x) {
	      var type = typeof x;
	      return x !== null && (type === 'object' || type === 'function');
	    }

	    function isFunction(x) {
	      return typeof x === 'function';
	    }

	    var _isArray = void 0;

	    if (Array.isArray) {
	      _isArray = Array.isArray;
	    } else {
	      _isArray = function (x) {
	        return Object.prototype.toString.call(x) === '[object Array]';
	      };
	    }

	    var isArray = _isArray;
	    var len = 0;
	    var vertxNext = void 0;
	    var customSchedulerFn = void 0;

	    var asap = function asap(callback, arg) {
	      queue[len] = callback;
	      queue[len + 1] = arg;
	      len += 2;

	      if (len === 2) {
	        // If len is 2, that means that we need to schedule an async flush.
	        // If additional callbacks are queued before the queue is flushed, they
	        // will be processed by this flush that we are scheduling.
	        if (customSchedulerFn) {
	          customSchedulerFn(flush);
	        } else {
	          scheduleFlush();
	        }
	      }
	    };

	    function setScheduler(scheduleFn) {
	      customSchedulerFn = scheduleFn;
	    }

	    function setAsap(asapFn) {
	      asap = asapFn;
	    }

	    var browserWindow = typeof window !== 'undefined' ? window : undefined;
	    var browserGlobal = browserWindow || {};
	    var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;
	    var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]'; // test for web worker but not in IE10

	    var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined'; // node

	    function useNextTick() {
	      // node version 0.10.x displays a deprecation warning when nextTick is used recursively
	      // see https://github.com/cujojs/when/issues/410 for details
	      return function () {
	        return process.nextTick(flush);
	      };
	    } // vertx


	    function useVertxTimer() {
	      if (typeof vertxNext !== 'undefined') {
	        return function () {
	          vertxNext(flush);
	        };
	      }

	      return useSetTimeout();
	    }

	    function useMutationObserver() {
	      var iterations = 0;
	      var observer = new BrowserMutationObserver(flush);
	      var node = document.createTextNode('');
	      observer.observe(node, {
	        characterData: true
	      });
	      return function () {
	        node.data = iterations = ++iterations % 2;
	      };
	    } // web worker


	    function useMessageChannel() {
	      var channel = new MessageChannel();
	      channel.port1.onmessage = flush;
	      return function () {
	        return channel.port2.postMessage(0);
	      };
	    }

	    function useSetTimeout() {
	      // Store setTimeout reference so es6-promise will be unaffected by
	      // other code modifying setTimeout (like sinon.useFakeTimers())
	      var globalSetTimeout = setTimeout;
	      return function () {
	        return globalSetTimeout(flush, 1);
	      };
	    }

	    var queue = new Array(1000);

	    function flush() {
	      for (var i = 0; i < len; i += 2) {
	        var callback = queue[i];
	        var arg = queue[i + 1];
	        callback(arg);
	        queue[i] = undefined;
	        queue[i + 1] = undefined;
	      }

	      len = 0;
	    }

	    function attemptVertx() {
	      try {
	        var vertx = Function('return this')().require('vertx');

	        vertxNext = vertx.runOnLoop || vertx.runOnContext;
	        return useVertxTimer();
	      } catch (e) {
	        return useSetTimeout();
	      }
	    }

	    var scheduleFlush = void 0; // Decide what async method to use to triggering processing of queued callbacks:

	    if (isNode) {
	      scheduleFlush = useNextTick();
	    } else if (BrowserMutationObserver) {
	      scheduleFlush = useMutationObserver();
	    } else if (isWorker) {
	      scheduleFlush = useMessageChannel();
	    } else if (browserWindow === undefined && typeof commonjsRequire === 'function') {
	      scheduleFlush = attemptVertx();
	    } else {
	      scheduleFlush = useSetTimeout();
	    }

	    function then(onFulfillment, onRejection) {
	      var parent = this;
	      var child = new this.constructor(noop);

	      if (child[PROMISE_ID] === undefined) {
	        makePromise(child);
	      }

	      var _state = parent._state;

	      if (_state) {
	        var callback = arguments[_state - 1];
	        asap(function () {
	          return invokeCallback(_state, child, callback, parent._result);
	        });
	      } else {
	        subscribe(parent, child, onFulfillment, onRejection);
	      }

	      return child;
	    }
	    /**
	      `Promise.resolve` returns a promise that will become resolved with the
	      passed `value`. It is shorthand for the following:
	    
	      ```javascript
	      let promise = new Promise(function(resolve, reject){
	        resolve(1);
	      });
	    
	      promise.then(function(value){
	        // value === 1
	      });
	      ```
	    
	      Instead of writing the above, your code now simply becomes the following:
	    
	      ```javascript
	      let promise = Promise.resolve(1);
	    
	      promise.then(function(value){
	        // value === 1
	      });
	      ```
	    
	      @method resolve
	      @static
	      @param {Any} value value that the returned promise will be resolved with
	      Useful for tooling.
	      @return {Promise} a promise that will become fulfilled with the given
	      `value`
	    */


	    function resolve$1(object) {
	      /*jshint validthis:true */
	      var Constructor = this;

	      if (object && typeof object === 'object' && object.constructor === Constructor) {
	        return object;
	      }

	      var promise = new Constructor(noop);
	      resolve(promise, object);
	      return promise;
	    }

	    var PROMISE_ID = Math.random().toString(36).substring(2);

	    function noop() {}

	    var PENDING = void 0;
	    var FULFILLED = 1;
	    var REJECTED = 2;

	    function selfFulfillment() {
	      return new TypeError("You cannot resolve a promise with itself");
	    }

	    function cannotReturnOwn() {
	      return new TypeError('A promises callback cannot return that same promise.');
	    }

	    function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {
	      try {
	        then$$1.call(value, fulfillmentHandler, rejectionHandler);
	      } catch (e) {
	        return e;
	      }
	    }

	    function handleForeignThenable(promise, thenable, then$$1) {
	      asap(function (promise) {
	        var sealed = false;
	        var error = tryThen(then$$1, thenable, function (value) {
	          if (sealed) {
	            return;
	          }

	          sealed = true;

	          if (thenable !== value) {
	            resolve(promise, value);
	          } else {
	            fulfill(promise, value);
	          }
	        }, function (reason) {
	          if (sealed) {
	            return;
	          }

	          sealed = true;
	          reject(promise, reason);
	        }, 'Settle: ' + (promise._label || ' unknown promise'));

	        if (!sealed && error) {
	          sealed = true;
	          reject(promise, error);
	        }
	      }, promise);
	    }

	    function handleOwnThenable(promise, thenable) {
	      if (thenable._state === FULFILLED) {
	        fulfill(promise, thenable._result);
	      } else if (thenable._state === REJECTED) {
	        reject(promise, thenable._result);
	      } else {
	        subscribe(thenable, undefined, function (value) {
	          return resolve(promise, value);
	        }, function (reason) {
	          return reject(promise, reason);
	        });
	      }
	    }

	    function handleMaybeThenable(promise, maybeThenable, then$$1) {
	      if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {
	        handleOwnThenable(promise, maybeThenable);
	      } else {
	        if (then$$1 === undefined) {
	          fulfill(promise, maybeThenable);
	        } else if (isFunction(then$$1)) {
	          handleForeignThenable(promise, maybeThenable, then$$1);
	        } else {
	          fulfill(promise, maybeThenable);
	        }
	      }
	    }

	    function resolve(promise, value) {
	      if (promise === value) {
	        reject(promise, selfFulfillment());
	      } else if (objectOrFunction(value)) {
	        var then$$1 = void 0;

	        try {
	          then$$1 = value.then;
	        } catch (error) {
	          reject(promise, error);
	          return;
	        }

	        handleMaybeThenable(promise, value, then$$1);
	      } else {
	        fulfill(promise, value);
	      }
	    }

	    function publishRejection(promise) {
	      if (promise._onerror) {
	        promise._onerror(promise._result);
	      }

	      publish(promise);
	    }

	    function fulfill(promise, value) {
	      if (promise._state !== PENDING) {
	        return;
	      }

	      promise._result = value;
	      promise._state = FULFILLED;

	      if (promise._subscribers.length !== 0) {
	        asap(publish, promise);
	      }
	    }

	    function reject(promise, reason) {
	      if (promise._state !== PENDING) {
	        return;
	      }

	      promise._state = REJECTED;
	      promise._result = reason;
	      asap(publishRejection, promise);
	    }

	    function subscribe(parent, child, onFulfillment, onRejection) {
	      var _subscribers = parent._subscribers;
	      var length = _subscribers.length;
	      parent._onerror = null;
	      _subscribers[length] = child;
	      _subscribers[length + FULFILLED] = onFulfillment;
	      _subscribers[length + REJECTED] = onRejection;

	      if (length === 0 && parent._state) {
	        asap(publish, parent);
	      }
	    }

	    function publish(promise) {
	      var subscribers = promise._subscribers;
	      var settled = promise._state;

	      if (subscribers.length === 0) {
	        return;
	      }

	      var child = void 0,
	          callback = void 0,
	          detail = promise._result;

	      for (var i = 0; i < subscribers.length; i += 3) {
	        child = subscribers[i];
	        callback = subscribers[i + settled];

	        if (child) {
	          invokeCallback(settled, child, callback, detail);
	        } else {
	          callback(detail);
	        }
	      }

	      promise._subscribers.length = 0;
	    }

	    function invokeCallback(settled, promise, callback, detail) {
	      var hasCallback = isFunction(callback),
	          value = void 0,
	          error = void 0,
	          succeeded = true;

	      if (hasCallback) {
	        try {
	          value = callback(detail);
	        } catch (e) {
	          succeeded = false;
	          error = e;
	        }

	        if (promise === value) {
	          reject(promise, cannotReturnOwn());
	          return;
	        }
	      } else {
	        value = detail;
	      }

	      if (promise._state !== PENDING) ; else if (hasCallback && succeeded) {
	        resolve(promise, value);
	      } else if (succeeded === false) {
	        reject(promise, error);
	      } else if (settled === FULFILLED) {
	        fulfill(promise, value);
	      } else if (settled === REJECTED) {
	        reject(promise, value);
	      }
	    }

	    function initializePromise(promise, resolver) {
	      try {
	        resolver(function resolvePromise(value) {
	          resolve(promise, value);
	        }, function rejectPromise(reason) {
	          reject(promise, reason);
	        });
	      } catch (e) {
	        reject(promise, e);
	      }
	    }

	    var id = 0;

	    function nextId() {
	      return id++;
	    }

	    function makePromise(promise) {
	      promise[PROMISE_ID] = id++;
	      promise._state = undefined;
	      promise._result = undefined;
	      promise._subscribers = [];
	    }

	    function validationError() {
	      return new Error('Array Methods must be provided an Array');
	    }

	    var Enumerator = function () {
	      function Enumerator(Constructor, input) {
	        this._instanceConstructor = Constructor;
	        this.promise = new Constructor(noop);

	        if (!this.promise[PROMISE_ID]) {
	          makePromise(this.promise);
	        }

	        if (isArray(input)) {
	          this.length = input.length;
	          this._remaining = input.length;
	          this._result = new Array(this.length);

	          if (this.length === 0) {
	            fulfill(this.promise, this._result);
	          } else {
	            this.length = this.length || 0;

	            this._enumerate(input);

	            if (this._remaining === 0) {
	              fulfill(this.promise, this._result);
	            }
	          }
	        } else {
	          reject(this.promise, validationError());
	        }
	      }

	      Enumerator.prototype._enumerate = function _enumerate(input) {
	        for (var i = 0; this._state === PENDING && i < input.length; i++) {
	          this._eachEntry(input[i], i);
	        }
	      };

	      Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {
	        var c = this._instanceConstructor;
	        var resolve$$1 = c.resolve;

	        if (resolve$$1 === resolve$1) {
	          var _then = void 0;

	          var error = void 0;
	          var didError = false;

	          try {
	            _then = entry.then;
	          } catch (e) {
	            didError = true;
	            error = e;
	          }

	          if (_then === then && entry._state !== PENDING) {
	            this._settledAt(entry._state, i, entry._result);
	          } else if (typeof _then !== 'function') {
	            this._remaining--;
	            this._result[i] = entry;
	          } else if (c === Promise$1) {
	            var promise = new c(noop);

	            if (didError) {
	              reject(promise, error);
	            } else {
	              handleMaybeThenable(promise, entry, _then);
	            }

	            this._willSettleAt(promise, i);
	          } else {
	            this._willSettleAt(new c(function (resolve$$1) {
	              return resolve$$1(entry);
	            }), i);
	          }
	        } else {
	          this._willSettleAt(resolve$$1(entry), i);
	        }
	      };

	      Enumerator.prototype._settledAt = function _settledAt(state, i, value) {
	        var promise = this.promise;

	        if (promise._state === PENDING) {
	          this._remaining--;

	          if (state === REJECTED) {
	            reject(promise, value);
	          } else {
	            this._result[i] = value;
	          }
	        }

	        if (this._remaining === 0) {
	          fulfill(promise, this._result);
	        }
	      };

	      Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {
	        var enumerator = this;
	        subscribe(promise, undefined, function (value) {
	          return enumerator._settledAt(FULFILLED, i, value);
	        }, function (reason) {
	          return enumerator._settledAt(REJECTED, i, reason);
	        });
	      };

	      return Enumerator;
	    }();
	    /**
	      `Promise.all` accepts an array of promises, and returns a new promise which
	      is fulfilled with an array of fulfillment values for the passed promises, or
	      rejected with the reason of the first passed promise to be rejected. It casts all
	      elements of the passed iterable to promises as it runs this algorithm.
	    
	      Example:
	    
	      ```javascript
	      let promise1 = resolve(1);
	      let promise2 = resolve(2);
	      let promise3 = resolve(3);
	      let promises = [ promise1, promise2, promise3 ];
	    
	      Promise.all(promises).then(function(array){
	        // The array here would be [ 1, 2, 3 ];
	      });
	      ```
	    
	      If any of the `promises` given to `all` are rejected, the first promise
	      that is rejected will be given as an argument to the returned promises's
	      rejection handler. For example:
	    
	      Example:
	    
	      ```javascript
	      let promise1 = resolve(1);
	      let promise2 = reject(new Error("2"));
	      let promise3 = reject(new Error("3"));
	      let promises = [ promise1, promise2, promise3 ];
	    
	      Promise.all(promises).then(function(array){
	        // Code here never runs because there are rejected promises!
	      }, function(error) {
	        // error.message === "2"
	      });
	      ```
	    
	      @method all
	      @static
	      @param {Array} entries array of promises
	      @param {String} label optional string for labeling the promise.
	      Useful for tooling.
	      @return {Promise} promise that is fulfilled when all `promises` have been
	      fulfilled, or rejected if any of them become rejected.
	      @static
	    */


	    function all(entries) {
	      return new Enumerator(this, entries).promise;
	    }
	    /**
	      `Promise.race` returns a new promise which is settled in the same way as the
	      first passed promise to settle.
	    
	      Example:
	    
	      ```javascript
	      let promise1 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 1');
	        }, 200);
	      });
	    
	      let promise2 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 2');
	        }, 100);
	      });
	    
	      Promise.race([promise1, promise2]).then(function(result){
	        // result === 'promise 2' because it was resolved before promise1
	        // was resolved.
	      });
	      ```
	    
	      `Promise.race` is deterministic in that only the state of the first
	      settled promise matters. For example, even if other promises given to the
	      `promises` array argument are resolved, but the first settled promise has
	      become rejected before the other promises became fulfilled, the returned
	      promise will become rejected:
	    
	      ```javascript
	      let promise1 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 1');
	        }, 200);
	      });
	    
	      let promise2 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          reject(new Error('promise 2'));
	        }, 100);
	      });
	    
	      Promise.race([promise1, promise2]).then(function(result){
	        // Code here never runs
	      }, function(reason){
	        // reason.message === 'promise 2' because promise 2 became rejected before
	        // promise 1 became fulfilled
	      });
	      ```
	    
	      An example real-world use case is implementing timeouts:
	    
	      ```javascript
	      Promise.race([ajax('foo.json'), timeout(5000)])
	      ```
	    
	      @method race
	      @static
	      @param {Array} promises array of promises to observe
	      Useful for tooling.
	      @return {Promise} a promise which settles in the same way as the first passed
	      promise to settle.
	    */


	    function race(entries) {
	      /*jshint validthis:true */
	      var Constructor = this;

	      if (!isArray(entries)) {
	        return new Constructor(function (_, reject) {
	          return reject(new TypeError('You must pass an array to race.'));
	        });
	      } else {
	        return new Constructor(function (resolve, reject) {
	          var length = entries.length;

	          for (var i = 0; i < length; i++) {
	            Constructor.resolve(entries[i]).then(resolve, reject);
	          }
	        });
	      }
	    }
	    /**
	      `Promise.reject` returns a promise rejected with the passed `reason`.
	      It is shorthand for the following:
	    
	      ```javascript
	      let promise = new Promise(function(resolve, reject){
	        reject(new Error('WHOOPS'));
	      });
	    
	      promise.then(function(value){
	        // Code here doesn't run because the promise is rejected!
	      }, function(reason){
	        // reason.message === 'WHOOPS'
	      });
	      ```
	    
	      Instead of writing the above, your code now simply becomes the following:
	    
	      ```javascript
	      let promise = Promise.reject(new Error('WHOOPS'));
	    
	      promise.then(function(value){
	        // Code here doesn't run because the promise is rejected!
	      }, function(reason){
	        // reason.message === 'WHOOPS'
	      });
	      ```
	    
	      @method reject
	      @static
	      @param {Any} reason value that the returned promise will be rejected with.
	      Useful for tooling.
	      @return {Promise} a promise rejected with the given `reason`.
	    */


	    function reject$1(reason) {
	      /*jshint validthis:true */
	      var Constructor = this;
	      var promise = new Constructor(noop);
	      reject(promise, reason);
	      return promise;
	    }

	    function needsResolver() {
	      throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');
	    }

	    function needsNew() {
	      throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
	    }
	    /**
	      Promise objects represent the eventual result of an asynchronous operation. The
	      primary way of interacting with a promise is through its `then` method, which
	      registers callbacks to receive either a promise's eventual value or the reason
	      why the promise cannot be fulfilled.
	    
	      Terminology
	      -----------
	    
	      - `promise` is an object or function with a `then` method whose behavior conforms to this specification.
	      - `thenable` is an object or function that defines a `then` method.
	      - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).
	      - `exception` is a value that is thrown using the throw statement.
	      - `reason` is a value that indicates why a promise was rejected.
	      - `settled` the final resting state of a promise, fulfilled or rejected.
	    
	      A promise can be in one of three states: pending, fulfilled, or rejected.
	    
	      Promises that are fulfilled have a fulfillment value and are in the fulfilled
	      state.  Promises that are rejected have a rejection reason and are in the
	      rejected state.  A fulfillment value is never a thenable.
	    
	      Promises can also be said to *resolve* a value.  If this value is also a
	      promise, then the original promise's settled state will match the value's
	      settled state.  So a promise that *resolves* a promise that rejects will
	      itself reject, and a promise that *resolves* a promise that fulfills will
	      itself fulfill.
	    
	    
	      Basic Usage:
	      ------------
	    
	      ```js
	      let promise = new Promise(function(resolve, reject) {
	        // on success
	        resolve(value);
	    
	        // on failure
	        reject(reason);
	      });
	    
	      promise.then(function(value) {
	        // on fulfillment
	      }, function(reason) {
	        // on rejection
	      });
	      ```
	    
	      Advanced Usage:
	      ---------------
	    
	      Promises shine when abstracting away asynchronous interactions such as
	      `XMLHttpRequest`s.
	    
	      ```js
	      function getJSON(url) {
	        return new Promise(function(resolve, reject){
	          let xhr = new XMLHttpRequest();
	    
	          xhr.open('GET', url);
	          xhr.onreadystatechange = handler;
	          xhr.responseType = 'json';
	          xhr.setRequestHeader('Accept', 'application/json');
	          xhr.send();
	    
	          function handler() {
	            if (this.readyState === this.DONE) {
	              if (this.status === 200) {
	                resolve(this.response);
	              } else {
	                reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));
	              }
	            }
	          };
	        });
	      }
	    
	      getJSON('/posts.json').then(function(json) {
	        // on fulfillment
	      }, function(reason) {
	        // on rejection
	      });
	      ```
	    
	      Unlike callbacks, promises are great composable primitives.
	    
	      ```js
	      Promise.all([
	        getJSON('/posts'),
	        getJSON('/comments')
	      ]).then(function(values){
	        values[0] // => postsJSON
	        values[1] // => commentsJSON
	    
	        return values;
	      });
	      ```
	    
	      @class Promise
	      @param {Function} resolver
	      Useful for tooling.
	      @constructor
	    */


	    var Promise$1 = function () {
	      function Promise(resolver) {
	        this[PROMISE_ID] = nextId();
	        this._result = this._state = undefined;
	        this._subscribers = [];

	        if (noop !== resolver) {
	          typeof resolver !== 'function' && needsResolver();
	          this instanceof Promise ? initializePromise(this, resolver) : needsNew();
	        }
	      }
	      /**
	      The primary way of interacting with a promise is through its `then` method,
	      which registers callbacks to receive either a promise's eventual value or the
	      reason why the promise cannot be fulfilled.
	       ```js
	      findUser().then(function(user){
	        // user is available
	      }, function(reason){
	        // user is unavailable, and you are given the reason why
	      });
	      ```
	       Chaining
	      --------
	       The return value of `then` is itself a promise.  This second, 'downstream'
	      promise is resolved with the return value of the first promise's fulfillment
	      or rejection handler, or rejected if the handler throws an exception.
	       ```js
	      findUser().then(function (user) {
	        return user.name;
	      }, function (reason) {
	        return 'default name';
	      }).then(function (userName) {
	        // If `findUser` fulfilled, `userName` will be the user's name, otherwise it
	        // will be `'default name'`
	      });
	       findUser().then(function (user) {
	        throw new Error('Found user, but still unhappy');
	      }, function (reason) {
	        throw new Error('`findUser` rejected and we're unhappy');
	      }).then(function (value) {
	        // never reached
	      }, function (reason) {
	        // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.
	        // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.
	      });
	      ```
	      If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.
	       ```js
	      findUser().then(function (user) {
	        throw new PedagogicalException('Upstream error');
	      }).then(function (value) {
	        // never reached
	      }).then(function (value) {
	        // never reached
	      }, function (reason) {
	        // The `PedgagocialException` is propagated all the way down to here
	      });
	      ```
	       Assimilation
	      ------------
	       Sometimes the value you want to propagate to a downstream promise can only be
	      retrieved asynchronously. This can be achieved by returning a promise in the
	      fulfillment or rejection handler. The downstream promise will then be pending
	      until the returned promise is settled. This is called *assimilation*.
	       ```js
	      findUser().then(function (user) {
	        return findCommentsByAuthor(user);
	      }).then(function (comments) {
	        // The user's comments are now available
	      });
	      ```
	       If the assimliated promise rejects, then the downstream promise will also reject.
	       ```js
	      findUser().then(function (user) {
	        return findCommentsByAuthor(user);
	      }).then(function (comments) {
	        // If `findCommentsByAuthor` fulfills, we'll have the value here
	      }, function (reason) {
	        // If `findCommentsByAuthor` rejects, we'll have the reason here
	      });
	      ```
	       Simple Example
	      --------------
	       Synchronous Example
	       ```javascript
	      let result;
	       try {
	        result = findResult();
	        // success
	      } catch(reason) {
	        // failure
	      }
	      ```
	       Errback Example
	       ```js
	      findResult(function(result, err){
	        if (err) {
	          // failure
	        } else {
	          // success
	        }
	      });
	      ```
	       Promise Example;
	       ```javascript
	      findResult().then(function(result){
	        // success
	      }, function(reason){
	        // failure
	      });
	      ```
	       Advanced Example
	      --------------
	       Synchronous Example
	       ```javascript
	      let author, books;
	       try {
	        author = findAuthor();
	        books  = findBooksByAuthor(author);
	        // success
	      } catch(reason) {
	        // failure
	      }
	      ```
	       Errback Example
	       ```js
	       function foundBooks(books) {
	       }
	       function failure(reason) {
	       }
	       findAuthor(function(author, err){
	        if (err) {
	          failure(err);
	          // failure
	        } else {
	          try {
	            findBoooksByAuthor(author, function(books, err) {
	              if (err) {
	                failure(err);
	              } else {
	                try {
	                  foundBooks(books);
	                } catch(reason) {
	                  failure(reason);
	                }
	              }
	            });
	          } catch(error) {
	            failure(err);
	          }
	          // success
	        }
	      });
	      ```
	       Promise Example;
	       ```javascript
	      findAuthor().
	        then(findBooksByAuthor).
	        then(function(books){
	          // found books
	      }).catch(function(reason){
	        // something went wrong
	      });
	      ```
	       @method then
	      @param {Function} onFulfilled
	      @param {Function} onRejected
	      Useful for tooling.
	      @return {Promise}
	      */

	      /**
	      `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same
	      as the catch block of a try/catch statement.
	      ```js
	      function findAuthor(){
	      throw new Error('couldn't find that author');
	      }
	      // synchronous
	      try {
	      findAuthor();
	      } catch(reason) {
	      // something went wrong
	      }
	      // async with promises
	      findAuthor().catch(function(reason){
	      // something went wrong
	      });
	      ```
	      @method catch
	      @param {Function} onRejection
	      Useful for tooling.
	      @return {Promise}
	      */


	      Promise.prototype.catch = function _catch(onRejection) {
	        return this.then(null, onRejection);
	      };
	      /**
	        `finally` will be invoked regardless of the promise's fate just as native
	        try/catch/finally behaves
	      
	        Synchronous example:
	      
	        ```js
	        findAuthor() {
	          if (Math.random() > 0.5) {
	            throw new Error();
	          }
	          return new Author();
	        }
	      
	        try {
	          return findAuthor(); // succeed or fail
	        } catch(error) {
	          return findOtherAuther();
	        } finally {
	          // always runs
	          // doesn't affect the return value
	        }
	        ```
	      
	        Asynchronous example:
	      
	        ```js
	        findAuthor().catch(function(reason){
	          return findOtherAuther();
	        }).finally(function(){
	          // author was either found, or not
	        });
	        ```
	      
	        @method finally
	        @param {Function} callback
	        @return {Promise}
	      */


	      Promise.prototype.finally = function _finally(callback) {
	        var promise = this;
	        var constructor = promise.constructor;

	        if (isFunction(callback)) {
	          return promise.then(function (value) {
	            return constructor.resolve(callback()).then(function () {
	              return value;
	            });
	          }, function (reason) {
	            return constructor.resolve(callback()).then(function () {
	              throw reason;
	            });
	          });
	        }

	        return promise.then(callback, callback);
	      };

	      return Promise;
	    }();

	    Promise$1.prototype.then = then;
	    Promise$1.all = all;
	    Promise$1.race = race;
	    Promise$1.resolve = resolve$1;
	    Promise$1.reject = reject$1;
	    Promise$1._setScheduler = setScheduler;
	    Promise$1._setAsap = setAsap;
	    Promise$1._asap = asap;
	    /*global self*/

	    function polyfill() {
	      var local = void 0;

	      if (typeof commonjsGlobal !== 'undefined') {
	        local = commonjsGlobal;
	      } else if (typeof self !== 'undefined') {
	        local = self;
	      } else {
	        try {
	          local = Function('return this')();
	        } catch (e) {
	          throw new Error('polyfill failed because global object is unavailable in this environment');
	        }
	      }

	      var P = local.Promise;

	      if (P) {
	        var promiseToString = null;

	        try {
	          promiseToString = Object.prototype.toString.call(P.resolve());
	        } catch (e) {// silently ignored
	        }

	        if (promiseToString === '[object Promise]' && !P.cast) {
	          return;
	        }
	      }

	      local.Promise = Promise$1;
	    } // Strange compat..


	    Promise$1.polyfill = polyfill;
	    Promise$1.Promise = Promise$1;
	    return Promise$1;
	  });
	});

	var Promise$1 = typeof Promise !== "undefined" ? Promise : es6Promise;

	function registerLoggingCallbacks(obj) {
	  var i,
	      l,
	      key,
	      callbackNames = ["begin", "done", "log", "testStart", "testDone", "moduleStart", "moduleDone"];

	  function registerLoggingCallback(key) {
	    var loggingCallback = function loggingCallback(callback) {
	      if (objectType(callback) !== "function") {
	        throw new Error("QUnit logging methods require a callback function as their first parameters.");
	      }

	      config.callbacks[key].push(callback);
	    };

	    return loggingCallback;
	  }

	  for (i = 0, l = callbackNames.length; i < l; i++) {
	    key = callbackNames[i]; // Initialize key collection of logging callback

	    if (objectType(config.callbacks[key]) === "undefined") {
	      config.callbacks[key] = [];
	    }

	    obj[key] = registerLoggingCallback(key);
	  }
	}
	function runLoggingCallbacks(key, args) {
	  var callbacks = config.callbacks[key]; // Handling 'log' callbacks separately. Unlike the other callbacks,
	  // the log callback is not controlled by the processing queue,
	  // but rather used by asserts. Hence to promisfy the 'log' callback
	  // would mean promisfying each step of a test

	  if (key === "log") {
	    callbacks.map(function (callback) {
	      return callback(args);
	    });
	    return;
	  } // ensure that each callback is executed serially


	  return callbacks.reduce(function (promiseChain, callback) {
	    return promiseChain.then(function () {
	      return Promise$1.resolve(callback(args));
	    });
	  }, Promise$1.resolve([]));
	}

	// Doesn't support IE9, it will return undefined on these browsers
	// See also https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error/Stack
	var fileName = (sourceFromStacktrace(0) || "").replace(/(:\d+)+\)?/, "").replace(/.+\//, "");
	function extractStacktrace(e, offset) {
	  offset = offset === undefined ? 4 : offset;
	  var stack, include, i;

	  if (e && e.stack) {
	    stack = e.stack.split("\n");

	    if (/^error$/i.test(stack[0])) {
	      stack.shift();
	    }

	    if (fileName) {
	      include = [];

	      for (i = offset; i < stack.length; i++) {
	        if (stack[i].indexOf(fileName) !== -1) {
	          break;
	        }

	        include.push(stack[i]);
	      }

	      if (include.length) {
	        return include.join("\n");
	      }
	    }

	    return stack[offset];
	  }
	}
	function sourceFromStacktrace(offset) {
	  var error = new Error(); // Support: Safari <=7 only, IE <=10 - 11 only
	  // Not all browsers generate the `stack` property for `new Error()`, see also #636

	  if (!error.stack) {
	    try {
	      throw error;
	    } catch (err) {
	      error = err;
	    }
	  }

	  return extractStacktrace(error, offset);
	}

	var priorityCount = 0;
	var unitSampler; // This is a queue of functions that are tasks within a single test.
	// After tests are dequeued from config.queue they are expanded into
	// a set of tasks in this queue.

	var taskQueue = [];
	/**
	 * Advances the taskQueue to the next task. If the taskQueue is empty,
	 * process the testQueue
	 */

	function advance() {
	  advanceTaskQueue();

	  if (!taskQueue.length && !config.blocking && !config.current) {
	    advanceTestQueue();
	  }
	}
	/**
	 * Advances the taskQueue with an increased depth
	 */


	function advanceTaskQueue() {
	  var start = now();
	  config.depth = (config.depth || 0) + 1;
	  processTaskQueue(start);
	  config.depth--;
	}
	/**
	 * Process the first task on the taskQueue as a promise.
	 * Each task is a function returned by https://github.com/qunitjs/qunit/blob/master/src/test.js#L381
	 */


	function processTaskQueue(start) {
	  if (taskQueue.length && !config.blocking) {
	    var elapsedTime = now() - start;

	    if (!defined.setTimeout || config.updateRate <= 0 || elapsedTime < config.updateRate) {
	      var task = taskQueue.shift();
	      Promise$1.resolve(task()).then(function () {
	        if (!taskQueue.length) {
	          advance();
	        } else {
	          processTaskQueue(start);
	        }
	      });
	    } else {
	      setTimeout$1(advance);
	    }
	  }
	}
	/**
	 * Advance the testQueue to the next test to process. Call done() if testQueue completes.
	 */


	function advanceTestQueue() {
	  if (!config.blocking && !config.queue.length && config.depth === 0) {
	    done();
	    return;
	  }

	  var testTasks = config.queue.shift();
	  addToTaskQueue(testTasks());

	  if (priorityCount > 0) {
	    priorityCount--;
	  }

	  advance();
	}
	/**
	 * Enqueue the tasks for a test into the task queue.
	 * @param {Array} tasksArray
	 */


	function addToTaskQueue(tasksArray) {
	  taskQueue.push.apply(taskQueue, _toConsumableArray(tasksArray));
	}
	/**
	 * Return the number of tasks remaining in the task queue to be processed.
	 * @return {Number}
	 */


	function taskQueueLength() {
	  return taskQueue.length;
	}
	/**
	 * Adds a test to the TestQueue for execution.
	 * @param {Function} testTasksFunc
	 * @param {Boolean} prioritize
	 * @param {String} seed
	 */


	function addToTestQueue(testTasksFunc, prioritize, seed) {
	  if (prioritize) {
	    config.queue.splice(priorityCount++, 0, testTasksFunc);
	  } else if (seed) {
	    if (!unitSampler) {
	      unitSampler = unitSamplerGenerator(seed);
	    } // Insert into a random position after all prioritized items


	    var index = Math.floor(unitSampler() * (config.queue.length - priorityCount + 1));
	    config.queue.splice(priorityCount + index, 0, testTasksFunc);
	  } else {
	    config.queue.push(testTasksFunc);
	  }
	}
	/**
	 * Creates a seeded "sample" generator which is used for randomizing tests.
	 */


	function unitSamplerGenerator(seed) {
	  // 32-bit xorshift, requires only a nonzero seed
	  // https://excamera.com/sphinx/article-xorshift.html
	  var sample = parseInt(generateHash(seed), 16) || -1;
	  return function () {
	    sample ^= sample << 13;
	    sample ^= sample >>> 17;
	    sample ^= sample << 5; // ECMAScript has no unsigned number type

	    if (sample < 0) {
	      sample += 0x100000000;
	    }

	    return sample / 0x100000000;
	  };
	}
	/**
	 * This function is called when the ProcessingQueue is done processing all
	 * items. It handles emitting the final run events.
	 */


	function done() {
	  var storage = config.storage;
	  ProcessingQueue.finished = true;
	  var runtime = now() - config.started;
	  var passed = config.stats.all - config.stats.bad;

	  if (config.stats.testCount === 0) {
	    if (config.filter && config.filter.length) {
	      throw new Error("No tests matched the filter \"".concat(config.filter, "\"."));
	    }

	    if (config.module && config.module.length) {
	      throw new Error("No tests matched the module \"".concat(config.module, "\"."));
	    }

	    if (config.moduleId && config.moduleId.length) {
	      throw new Error("No tests matched the moduleId \"".concat(config.moduleId, "\"."));
	    }

	    if (config.testId && config.testId.length) {
	      throw new Error("No tests matched the testId \"".concat(config.testId, "\"."));
	    }

	    throw new Error("No tests were run.");
	  }

	  emit("runEnd", globalSuite.end(true));
	  runLoggingCallbacks("done", {
	    passed: passed,
	    failed: config.stats.bad,
	    total: config.stats.all,
	    runtime: runtime
	  }).then(function () {
	    // Clear own storage items if all tests passed
	    if (storage && config.stats.bad === 0) {
	      for (var i = storage.length - 1; i >= 0; i--) {
	        var key = storage.key(i);

	        if (key.indexOf("qunit-test-") === 0) {
	          storage.removeItem(key);
	        }
	      }
	    }
	  });
	}

	var ProcessingQueue = {
	  finished: false,
	  add: addToTestQueue,
	  advance: advance,
	  taskCount: taskQueueLength
	};

	var TestReport = /*#__PURE__*/function () {
	  function TestReport(name, suite, options) {
	    _classCallCheck(this, TestReport);

	    this.name = name;
	    this.suiteName = suite.name;
	    this.fullName = suite.fullName.concat(name);
	    this.runtime = 0;
	    this.assertions = [];
	    this.skipped = !!options.skip;
	    this.todo = !!options.todo;
	    this.valid = options.valid;
	    this._startTime = 0;
	    this._endTime = 0;
	    suite.pushTest(this);
	  }

	  _createClass(TestReport, [{
	    key: "start",
	    value: function start(recordTime) {
	      if (recordTime) {
	        this._startTime = performanceNow();

	        if (performance) {
	          performance.mark("qunit_test_start");
	        }
	      }

	      return {
	        name: this.name,
	        suiteName: this.suiteName,
	        fullName: this.fullName.slice()
	      };
	    }
	  }, {
	    key: "end",
	    value: function end(recordTime) {
	      if (recordTime) {
	        this._endTime = performanceNow();

	        if (performance) {
	          performance.mark("qunit_test_end");
	          var testName = this.fullName.join(" – ");
	          measure("QUnit Test: ".concat(testName), "qunit_test_start", "qunit_test_end");
	        }
	      }

	      return extend(this.start(), {
	        runtime: this.getRuntime(),
	        status: this.getStatus(),
	        errors: this.getFailedAssertions(),
	        assertions: this.getAssertions()
	      });
	    }
	  }, {
	    key: "pushAssertion",
	    value: function pushAssertion(assertion) {
	      this.assertions.push(assertion);
	    }
	  }, {
	    key: "getRuntime",
	    value: function getRuntime() {
	      return this._endTime - this._startTime;
	    }
	  }, {
	    key: "getStatus",
	    value: function getStatus() {
	      if (this.skipped) {
	        return "skipped";
	      }

	      var testPassed = this.getFailedAssertions().length > 0 ? this.todo : !this.todo;

	      if (!testPassed) {
	        return "failed";
	      } else if (this.todo) {
	        return "todo";
	      } else {
	        return "passed";
	      }
	    }
	  }, {
	    key: "getFailedAssertions",
	    value: function getFailedAssertions() {
	      return this.assertions.filter(function (assertion) {
	        return !assertion.passed;
	      });
	    }
	  }, {
	    key: "getAssertions",
	    value: function getAssertions() {
	      return this.assertions.slice();
	    } // Remove actual and expected values from assertions. This is to prevent
	    // leaking memory throughout a test suite.

	  }, {
	    key: "slimAssertions",
	    value: function slimAssertions() {
	      this.assertions = this.assertions.map(function (assertion) {
	        delete assertion.actual;
	        delete assertion.expected;
	        return assertion;
	      });
	    }
	  }]);

	  return TestReport;
	}();

	var focused$1 = false;
	function Test(settings) {
	  var i, l;
	  ++Test.count;
	  this.expected = null;
	  this.assertions = [];
	  this.semaphore = 0;
	  this.module = config.currentModule;
	  this.steps = [];
	  this.timeout = undefined;
	  this.errorForStack = new Error(); // If a module is skipped, all its tests and the tests of the child suites
	  // should be treated as skipped even if they are defined as `only` or `todo`.
	  // As for `todo` module, all its tests will be treated as `todo` except for
	  // tests defined as `skip` which will be left intact.
	  //
	  // So, if a test is defined as `todo` and is inside a skipped module, we should
	  // then treat that test as if was defined as `skip`.

	  if (this.module.skip) {
	    settings.skip = true;
	    settings.todo = false; // Skipped tests should be left intact
	  } else if (this.module.todo && !settings.skip) {
	    settings.todo = true;
	  }

	  extend(this, settings);
	  this.testReport = new TestReport(settings.testName, this.module.suiteReport, {
	    todo: settings.todo,
	    skip: settings.skip,
	    valid: this.valid()
	  }); // Register unique strings

	  for (i = 0, l = this.module.tests; i < l.length; i++) {
	    if (this.module.tests[i].name === this.testName) {
	      this.testName += " ";
	    }
	  }

	  this.testId = generateHash(this.module.name, this.testName);
	  this.module.tests.push({
	    name: this.testName,
	    testId: this.testId,
	    skip: !!settings.skip
	  });

	  if (settings.skip) {
	    // Skipped tests will fully ignore any sent callback
	    this.callback = function () {};

	    this.async = false;
	    this.expected = 0;
	  } else {
	    if (typeof this.callback !== "function") {
	      var method = this.todo ? "todo" : "test"; // eslint-disable-next-line max-len

	      throw new TypeError("You must provide a function as a test callback to QUnit.".concat(method, "(\"").concat(settings.testName, "\")"));
	    }

	    this.assert = new Assert(this);
	  }
	}
	Test.count = 0;

	function getNotStartedModules(startModule) {
	  var module = startModule,
	      modules = [];

	  while (module && module.testsRun === 0) {
	    modules.push(module);
	    module = module.parentModule;
	  } // The above push modules from the child to the parent
	  // return a reversed order with the top being the top most parent module


	  return modules.reverse();
	}

	Test.prototype = {
	  // generating a stack trace can be expensive, so using a getter defers this until we need it
	  get stack() {
	    return extractStacktrace(this.errorForStack, 2);
	  },

	  before: function before() {
	    var _this = this;

	    var module = this.module,
	        notStartedModules = getNotStartedModules(module); // ensure the callbacks are executed serially for each module

	    var callbackPromises = notStartedModules.reduce(function (promiseChain, startModule) {
	      return promiseChain.then(function () {
	        startModule.stats = {
	          all: 0,
	          bad: 0,
	          started: now()
	        };
	        emit("suiteStart", startModule.suiteReport.start(true));
	        return runLoggingCallbacks("moduleStart", {
	          name: startModule.name,
	          tests: startModule.tests
	        });
	      });
	    }, Promise$1.resolve([]));
	    return callbackPromises.then(function () {
	      config.current = _this;
	      _this.testEnvironment = extend({}, module.testEnvironment);
	      _this.started = now();
	      emit("testStart", _this.testReport.start(true));
	      return runLoggingCallbacks("testStart", {
	        name: _this.testName,
	        module: module.name,
	        testId: _this.testId,
	        previousFailure: _this.previousFailure
	      }).then(function () {
	        if (!config.pollution) {
	          saveGlobal();
	        }
	      });
	    });
	  },
	  run: function run() {
	    var promise;
	    config.current = this;
	    this.callbackStarted = now();

	    if (config.notrycatch) {
	      runTest(this);
	      return;
	    }

	    try {
	      runTest(this);
	    } catch (e) {
	      this.pushFailure("Died on test #" + (this.assertions.length + 1) + " " + this.stack + ": " + (e.message || e), extractStacktrace(e, 0)); // Else next test will carry the responsibility

	      saveGlobal(); // Restart the tests if they're blocking

	      if (config.blocking) {
	        internalRecover(this);
	      }
	    }

	    function runTest(test) {
	      promise = test.callback.call(test.testEnvironment, test.assert);
	      test.resolvePromise(promise); // If the test has a "lock" on it, but the timeout is 0, then we push a
	      // failure as the test should be synchronous.

	      if (test.timeout === 0 && test.semaphore !== 0) {
	        pushFailure("Test did not finish synchronously even though assert.timeout( 0 ) was used.", sourceFromStacktrace(2));
	      }
	    }
	  },
	  after: function after() {
	    checkPollution();
	  },
	  queueHook: function queueHook(hook, hookName, hookOwner) {
	    var _this2 = this;

	    var callHook = function callHook() {
	      var promise = hook.call(_this2.testEnvironment, _this2.assert);

	      _this2.resolvePromise(promise, hookName);
	    };

	    var runHook = function runHook() {
	      if (hookName === "before") {
	        if (hookOwner.unskippedTestsRun !== 0) {
	          return;
	        }

	        _this2.preserveEnvironment = true;
	      } // The 'after' hook should only execute when there are not tests left and
	      // when the 'after' and 'finish' tasks are the only tasks left to process


	      if (hookName === "after" && hookOwner.unskippedTestsRun !== numberOfUnskippedTests(hookOwner) - 1 && (config.queue.length > 0 || ProcessingQueue.taskCount() > 2)) {
	        return;
	      }

	      config.current = _this2;

	      if (config.notrycatch) {
	        callHook();
	        return;
	      }

	      try {
	        callHook();
	      } catch (error) {
	        _this2.pushFailure(hookName + " failed on " + _this2.testName + ": " + (error.message || error), extractStacktrace(error, 0));
	      }
	    };

	    return runHook;
	  },
	  // Currently only used for module level hooks, can be used to add global level ones
	  hooks: function hooks(handler) {
	    var hooks = [];

	    function processHooks(test, module) {
	      if (module.parentModule) {
	        processHooks(test, module.parentModule);
	      }

	      if (module.hooks[handler].length) {
	        for (var i = 0; i < module.hooks[handler].length; i++) {
	          hooks.push(test.queueHook(module.hooks[handler][i], handler, module));
	        }
	      }
	    } // Hooks are ignored on skipped tests


	    if (!this.skip) {
	      processHooks(this, this.module);
	    }

	    return hooks;
	  },
	  finish: function finish() {
	    config.current = this; // Release the test callback to ensure that anything referenced has been
	    // released to be garbage collected.

	    this.callback = undefined;

	    if (this.steps.length) {
	      var stepsList = this.steps.join(", ");
	      this.pushFailure("Expected assert.verifySteps() to be called before end of test " + "after using assert.step(). Unverified steps: ".concat(stepsList), this.stack);
	    }

	    if (config.requireExpects && this.expected === null) {
	      this.pushFailure("Expected number of assertions to be defined, but expect() was " + "not called.", this.stack);
	    } else if (this.expected !== null && this.expected !== this.assertions.length) {
	      this.pushFailure("Expected " + this.expected + " assertions, but " + this.assertions.length + " were run", this.stack);
	    } else if (this.expected === null && !this.assertions.length) {
	      this.pushFailure("Expected at least one assertion, but none were run - call " + "expect(0) to accept zero assertions.", this.stack);
	    }

	    var i,
	        module = this.module,
	        moduleName = module.name,
	        testName = this.testName,
	        skipped = !!this.skip,
	        todo = !!this.todo,
	        bad = 0,
	        storage = config.storage;
	    this.runtime = now() - this.started;
	    config.stats.all += this.assertions.length;
	    config.stats.testCount += 1;
	    module.stats.all += this.assertions.length;

	    for (i = 0; i < this.assertions.length; i++) {
	      if (!this.assertions[i].result) {
	        bad++;
	        config.stats.bad++;
	        module.stats.bad++;
	      }
	    }

	    notifyTestsRan(module, skipped); // Store result when possible

	    if (storage) {
	      if (bad) {
	        storage.setItem("qunit-test-" + moduleName + "-" + testName, bad);
	      } else {
	        storage.removeItem("qunit-test-" + moduleName + "-" + testName);
	      }
	    } // After emitting the js-reporters event we cleanup the assertion data to
	    // avoid leaking it. It is not used by the legacy testDone callbacks.


	    emit("testEnd", this.testReport.end(true));
	    this.testReport.slimAssertions();
	    var test = this;
	    return runLoggingCallbacks("testDone", {
	      name: testName,
	      module: moduleName,
	      skipped: skipped,
	      todo: todo,
	      failed: bad,
	      passed: this.assertions.length - bad,
	      total: this.assertions.length,
	      runtime: skipped ? 0 : this.runtime,
	      // HTML Reporter use
	      assertions: this.assertions,
	      testId: this.testId,

	      // Source of Test
	      // generating stack trace is expensive, so using a getter will help defer this until we need it
	      get source() {
	        return test.stack;
	      }

	    }).then(function () {
	      if (module.testsRun === numberOfTests(module)) {
	        var completedModules = [module]; // Check if the parent modules, iteratively, are done. If that the case,
	        // we emit the `suiteEnd` event and trigger `moduleDone` callback.

	        var parent = module.parentModule;

	        while (parent && parent.testsRun === numberOfTests(parent)) {
	          completedModules.push(parent);
	          parent = parent.parentModule;
	        }

	        return completedModules.reduce(function (promiseChain, completedModule) {
	          return promiseChain.then(function () {
	            return logSuiteEnd(completedModule);
	          });
	        }, Promise$1.resolve([]));
	      }
	    }).then(function () {
	      config.current = undefined;
	    });

	    function logSuiteEnd(module) {
	      // Reset `module.hooks` to ensure that anything referenced in these hooks
	      // has been released to be garbage collected.
	      module.hooks = {};
	      emit("suiteEnd", module.suiteReport.end(true));
	      return runLoggingCallbacks("moduleDone", {
	        name: module.name,
	        tests: module.tests,
	        failed: module.stats.bad,
	        passed: module.stats.all - module.stats.bad,
	        total: module.stats.all,
	        runtime: now() - module.stats.started
	      });
	    }
	  },
	  preserveTestEnvironment: function preserveTestEnvironment() {
	    if (this.preserveEnvironment) {
	      this.module.testEnvironment = this.testEnvironment;
	      this.testEnvironment = extend({}, this.module.testEnvironment);
	    }
	  },
	  queue: function queue() {
	    var test = this;

	    if (!this.valid()) {
	      return;
	    }

	    function runTest() {
	      return [function () {
	        return test.before();
	      }].concat(_toConsumableArray(test.hooks("before")), [function () {
	        test.preserveTestEnvironment();
	      }], _toConsumableArray(test.hooks("beforeEach")), [function () {
	        test.run();
	      }], _toConsumableArray(test.hooks("afterEach").reverse()), _toConsumableArray(test.hooks("after").reverse()), [function () {
	        test.after();
	      }, function () {
	        return test.finish();
	      }]);
	    }

	    var previousFailCount = config.storage && +config.storage.getItem("qunit-test-" + this.module.name + "-" + this.testName); // Prioritize previously failed tests, detected from storage

	    var prioritize = config.reorder && !!previousFailCount;
	    this.previousFailure = !!previousFailCount;
	    ProcessingQueue.add(runTest, prioritize, config.seed); // If the queue has already finished, we manually process the new test

	    if (ProcessingQueue.finished) {
	      ProcessingQueue.advance();
	    }
	  },
	  pushResult: function pushResult(resultInfo) {
	    if (this !== config.current) {
	      throw new Error("Assertion occurred after test had finished.");
	    } // Destructure of resultInfo = { result, actual, expected, message, negative }


	    var source,
	        details = {
	      module: this.module.name,
	      name: this.testName,
	      result: resultInfo.result,
	      message: resultInfo.message,
	      actual: resultInfo.actual,
	      testId: this.testId,
	      negative: resultInfo.negative || false,
	      runtime: now() - this.started,
	      todo: !!this.todo
	    };

	    if (hasOwn.call(resultInfo, "expected")) {
	      details.expected = resultInfo.expected;
	    }

	    if (!resultInfo.result) {
	      source = resultInfo.source || sourceFromStacktrace();

	      if (source) {
	        details.source = source;
	      }
	    }

	    this.logAssertion(details);
	    this.assertions.push({
	      result: !!resultInfo.result,
	      message: resultInfo.message
	    });
	  },
	  pushFailure: function pushFailure(message, source, actual) {
	    if (!(this instanceof Test)) {
	      throw new Error("pushFailure() assertion outside test context, was " + sourceFromStacktrace(2));
	    }

	    this.pushResult({
	      result: false,
	      message: message || "error",
	      actual: actual || null,
	      source: source
	    });
	  },

	  /**
	   * Log assertion details using both the old QUnit.log interface and
	   * QUnit.on( "assertion" ) interface.
	   *
	   * @private
	   */
	  logAssertion: function logAssertion(details) {
	    runLoggingCallbacks("log", details);
	    var assertion = {
	      passed: details.result,
	      actual: details.actual,
	      expected: details.expected,
	      message: details.message,
	      stack: details.source,
	      todo: details.todo
	    };
	    this.testReport.pushAssertion(assertion);
	    emit("assertion", assertion);
	  },
	  resolvePromise: function resolvePromise(promise, phase) {
	    var then,
	        resume,
	        message,
	        test = this;

	    if (promise != null) {
	      then = promise.then;

	      if (objectType(then) === "function") {
	        resume = internalStop(test);

	        if (config.notrycatch) {
	          then.call(promise, function () {
	            resume();
	          });
	        } else {
	          then.call(promise, function () {
	            resume();
	          }, function (error) {
	            message = "Promise rejected " + (!phase ? "during" : phase.replace(/Each$/, "")) + " \"" + test.testName + "\": " + (error && error.message || error);
	            test.pushFailure(message, extractStacktrace(error, 0)); // Else next test will carry the responsibility

	            saveGlobal(); // Unblock

	            internalRecover(test);
	          });
	        }
	      }
	    }
	  },
	  valid: function valid() {
	    var filter = config.filter,
	        regexFilter = /^(!?)\/([\w\W]*)\/(i?$)/.exec(filter),
	        module = config.module && config.module.toLowerCase(),
	        fullName = this.module.name + ": " + this.testName;

	    function moduleChainNameMatch(testModule) {
	      var testModuleName = testModule.name ? testModule.name.toLowerCase() : null;

	      if (testModuleName === module) {
	        return true;
	      } else if (testModule.parentModule) {
	        return moduleChainNameMatch(testModule.parentModule);
	      } else {
	        return false;
	      }
	    }

	    function moduleChainIdMatch(testModule) {
	      return inArray(testModule.moduleId, config.moduleId) || testModule.parentModule && moduleChainIdMatch(testModule.parentModule);
	    } // Internally-generated tests are always valid


	    if (this.callback && this.callback.validTest) {
	      return true;
	    }

	    if (config.moduleId && config.moduleId.length > 0 && !moduleChainIdMatch(this.module)) {
	      return false;
	    }

	    if (config.testId && config.testId.length > 0 && !inArray(this.testId, config.testId)) {
	      return false;
	    }

	    if (module && !moduleChainNameMatch(this.module)) {
	      return false;
	    }

	    if (!filter) {
	      return true;
	    }

	    return regexFilter ? this.regexFilter(!!regexFilter[1], regexFilter[2], regexFilter[3], fullName) : this.stringFilter(filter, fullName);
	  },
	  regexFilter: function regexFilter(exclude, pattern, flags, fullName) {
	    var regex = new RegExp(pattern, flags);
	    var match = regex.test(fullName);
	    return match !== exclude;
	  },
	  stringFilter: function stringFilter(filter, fullName) {
	    filter = filter.toLowerCase();
	    fullName = fullName.toLowerCase();
	    var include = filter.charAt(0) !== "!";

	    if (!include) {
	      filter = filter.slice(1);
	    } // If the filter matches, we need to honour include


	    if (fullName.indexOf(filter) !== -1) {
	      return include;
	    } // Otherwise, do the opposite


	    return !include;
	  }
	};
	function pushFailure() {
	  if (!config.current) {
	    throw new Error("pushFailure() assertion outside test context, in " + sourceFromStacktrace(2));
	  } // Gets current test obj


	  var currentTest = config.current;
	  return currentTest.pushFailure.apply(currentTest, arguments);
	}

	function saveGlobal() {
	  config.pollution = [];

	  if (config.noglobals) {
	    for (var key in global__default['default']) {
	      if (hasOwn.call(global__default['default'], key)) {
	        // In Opera sometimes DOM element ids show up here, ignore them
	        if (/^qunit-test-output/.test(key)) {
	          continue;
	        }

	        config.pollution.push(key);
	      }
	    }
	  }
	}

	function checkPollution() {
	  var newGlobals,
	      deletedGlobals,
	      old = config.pollution;
	  saveGlobal();
	  newGlobals = diff(config.pollution, old);

	  if (newGlobals.length > 0) {
	    pushFailure("Introduced global variable(s): " + newGlobals.join(", "));
	  }

	  deletedGlobals = diff(old, config.pollution);

	  if (deletedGlobals.length > 0) {
	    pushFailure("Deleted global variable(s): " + deletedGlobals.join(", "));
	  }
	} // Will be exposed as QUnit.test


	function test(testName, callback) {
	  if (focused$1) {
	    return;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback
	  });
	  newTest.queue();
	}
	function todo(testName, callback) {
	  if (focused$1) {
	    return;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback,
	    todo: true
	  });
	  newTest.queue();
	} // Will be exposed as QUnit.skip

	function skip(testName) {
	  if (focused$1) {
	    return;
	  }

	  var test = new Test({
	    testName: testName,
	    skip: true
	  });
	  test.queue();
	} // Will be exposed as QUnit.only

	function only(testName, callback) {
	  if (!focused$1) {
	    config.queue.length = 0;
	    focused$1 = true;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback
	  });
	  newTest.queue();
	} // Resets config.timeout with a new timeout duration.

	function resetTestTimeout(timeoutDuration) {
	  clearTimeout(config.timeout);
	  config.timeout = setTimeout$1(config.timeoutHandler(timeoutDuration), timeoutDuration);
	} // Put a hold on processing and return a function that will release it.

	function internalStop(test) {
	  var released = false;
	  test.semaphore += 1;
	  config.blocking = true; // Set a recovery timeout, if so configured.

	  if (defined.setTimeout) {
	    var timeoutDuration;

	    if (typeof test.timeout === "number") {
	      timeoutDuration = test.timeout;
	    } else if (typeof config.testTimeout === "number") {
	      timeoutDuration = config.testTimeout;
	    }

	    if (typeof timeoutDuration === "number" && timeoutDuration > 0) {
	      clearTimeout(config.timeout);

	      config.timeoutHandler = function (timeout) {
	        return function () {
	          pushFailure("Test took longer than ".concat(timeout, "ms; test timed out."), sourceFromStacktrace(2));
	          released = true;
	          internalRecover(test);
	        };
	      };

	      config.timeout = setTimeout$1(config.timeoutHandler(timeoutDuration), timeoutDuration);
	    }
	  }

	  return function resume() {
	    if (released) {
	      return;
	    }

	    released = true;
	    test.semaphore -= 1;
	    internalStart(test);
	  };
	} // Forcefully release all processing holds.

	function internalRecover(test) {
	  test.semaphore = 0;
	  internalStart(test);
	} // Release a processing hold, scheduling a resumption attempt if no holds remain.


	function internalStart(test) {
	  // If semaphore is non-numeric, throw error
	  if (isNaN(test.semaphore)) {
	    test.semaphore = 0;
	    pushFailure("Invalid value on test.semaphore", sourceFromStacktrace(2));
	    return;
	  } // Don't start until equal number of stop-calls


	  if (test.semaphore > 0) {
	    return;
	  } // Throw an Error if start is called more often than stop


	  if (test.semaphore < 0) {
	    test.semaphore = 0;
	    pushFailure("Tried to restart test while already started (test's semaphore was 0 already)", sourceFromStacktrace(2));
	    return;
	  } // Add a slight delay to allow more assertions etc.


	  if (defined.setTimeout) {
	    if (config.timeout) {
	      clearTimeout(config.timeout);
	    }

	    config.timeout = setTimeout$1(function () {
	      if (test.semaphore > 0) {
	        return;
	      }

	      if (config.timeout) {
	        clearTimeout(config.timeout);
	      }

	      begin();
	    });
	  } else {
	    begin();
	  }
	}

	function collectTests(module) {
	  var tests = [].concat(module.tests);

	  var modules = _toConsumableArray(module.childModules); // Do a breadth-first traversal of the child modules


	  while (modules.length) {
	    var nextModule = modules.shift();
	    tests.push.apply(tests, nextModule.tests);
	    modules.push.apply(modules, _toConsumableArray(nextModule.childModules));
	  }

	  return tests;
	}

	function numberOfTests(module) {
	  return collectTests(module).length;
	}

	function numberOfUnskippedTests(module) {
	  return collectTests(module).filter(function (test) {
	    return !test.skip;
	  }).length;
	}

	function notifyTestsRan(module, skipped) {
	  module.testsRun++;

	  if (!skipped) {
	    module.unskippedTestsRun++;
	  }

	  while (module = module.parentModule) {
	    module.testsRun++;

	    if (!skipped) {
	      module.unskippedTestsRun++;
	    }
	  }
	}

	var Assert = /*#__PURE__*/function () {
	  function Assert(testContext) {
	    _classCallCheck(this, Assert);

	    this.test = testContext;
	  } // Assert helpers


	  _createClass(Assert, [{
	    key: "timeout",
	    value: function timeout(duration) {
	      if (typeof duration !== "number") {
	        throw new Error("You must pass a number as the duration to assert.timeout");
	      }

	      this.test.timeout = duration; // If a timeout has been set, clear it and reset with the new duration

	      if (config.timeout) {
	        clearTimeout(config.timeout);

	        if (config.timeoutHandler && this.test.timeout > 0) {
	          resetTestTimeout(this.test.timeout);
	        }
	      }
	    } // Documents a "step", which is a string value, in a test as a passing assertion

	  }, {
	    key: "step",
	    value: function step(message) {
	      var assertionMessage = message;
	      var result = !!message;
	      this.test.steps.push(message);

	      if (objectType(message) === "undefined" || message === "") {
	        assertionMessage = "You must provide a message to assert.step";
	      } else if (objectType(message) !== "string") {
	        assertionMessage = "You must provide a string value to assert.step";
	        result = false;
	      }

	      this.pushResult({
	        result: result,
	        message: assertionMessage
	      });
	    } // Verifies the steps in a test match a given array of string values

	  }, {
	    key: "verifySteps",
	    value: function verifySteps(steps, message) {
	      // Since the steps array is just string values, we can clone with slice
	      var actualStepsClone = this.test.steps.slice();
	      this.deepEqual(actualStepsClone, steps, message);
	      this.test.steps.length = 0;
	    } // Specify the number of expected assertions to guarantee that failed test
	    // (no assertions are run at all) don't slip through.

	  }, {
	    key: "expect",
	    value: function expect(asserts) {
	      if (arguments.length === 1) {
	        this.test.expected = asserts;
	      } else {
	        return this.test.expected;
	      }
	    } // Put a hold on processing and return a function that will release it a maximum of once.

	  }, {
	    key: "async",
	    value: function async(count) {
	      var test = this.test;
	      var popped = false,
	          acceptCallCount = count;

	      if (typeof acceptCallCount === "undefined") {
	        acceptCallCount = 1;
	      }

	      var resume = internalStop(test);
	      return function done() {
	        if (config.current !== test) {
	          throw Error("assert.async callback called after test finished.");
	        }

	        if (popped) {
	          test.pushFailure("Too many calls to the `assert.async` callback", sourceFromStacktrace(2));
	          return;
	        }

	        acceptCallCount -= 1;

	        if (acceptCallCount > 0) {
	          return;
	        }

	        popped = true;
	        resume();
	      };
	    } // Exports test.push() to the user API
	    // Alias of pushResult.

	  }, {
	    key: "push",
	    value: function push(result, actual, expected, message, negative) {
	      Logger.warn("assert.push is deprecated and will be removed in QUnit 3.0." + " Please use assert.pushResult instead (https://api.qunitjs.com/assert/pushResult).");
	      var currentAssert = this instanceof Assert ? this : config.current.assert;
	      return currentAssert.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: negative
	      });
	    }
	  }, {
	    key: "pushResult",
	    value: function pushResult(resultInfo) {
	      // Destructure of resultInfo = { result, actual, expected, message, negative }
	      var assert = this;
	      var currentTest = assert instanceof Assert && assert.test || config.current; // Backwards compatibility fix.
	      // Allows the direct use of global exported assertions and QUnit.assert.*
	      // Although, it's use is not recommended as it can leak assertions
	      // to other tests from async tests, because we only get a reference to the current test,
	      // not exactly the test where assertion were intended to be called.

	      if (!currentTest) {
	        throw new Error("assertion outside test context, in " + sourceFromStacktrace(2));
	      }

	      if (!(assert instanceof Assert)) {
	        assert = currentTest.assert;
	      }

	      return assert.test.pushResult(resultInfo);
	    }
	  }, {
	    key: "ok",
	    value: function ok(result, message) {
	      if (!message) {
	        message = result ? "okay" : "failed, expected argument to be truthy, was: ".concat(dump.parse(result));
	      }

	      this.pushResult({
	        result: !!result,
	        actual: result,
	        expected: true,
	        message: message
	      });
	    }
	  }, {
	    key: "notOk",
	    value: function notOk(result, message) {
	      if (!message) {
	        message = !result ? "okay" : "failed, expected argument to be falsy, was: ".concat(dump.parse(result));
	      }

	      this.pushResult({
	        result: !result,
	        actual: result,
	        expected: false,
	        message: message
	      });
	    }
	  }, {
	    key: "true",
	    value: function _true(result, message) {
	      this.pushResult({
	        result: result === true,
	        actual: result,
	        expected: true,
	        message: message
	      });
	    }
	  }, {
	    key: "false",
	    value: function _false(result, message) {
	      this.pushResult({
	        result: result === false,
	        actual: result,
	        expected: false,
	        message: message
	      });
	    }
	  }, {
	    key: "equal",
	    value: function equal(actual, expected, message) {
	      // eslint-disable-next-line eqeqeq
	      var result = expected == actual;
	      this.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notEqual",
	    value: function notEqual(actual, expected, message) {
	      // eslint-disable-next-line eqeqeq
	      var result = expected != actual;
	      this.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "propEqual",
	    value: function propEqual(actual, expected, message) {
	      actual = objectValues(actual);
	      expected = objectValues(expected);
	      this.pushResult({
	        result: equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notPropEqual",
	    value: function notPropEqual(actual, expected, message) {
	      actual = objectValues(actual);
	      expected = objectValues(expected);
	      this.pushResult({
	        result: !equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "deepEqual",
	    value: function deepEqual(actual, expected, message) {
	      this.pushResult({
	        result: equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notDeepEqual",
	    value: function notDeepEqual(actual, expected, message) {
	      this.pushResult({
	        result: !equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "strictEqual",
	    value: function strictEqual(actual, expected, message) {
	      this.pushResult({
	        result: expected === actual,
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notStrictEqual",
	    value: function notStrictEqual(actual, expected, message) {
	      this.pushResult({
	        result: expected !== actual,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "throws",
	    value: function throws(block, expected, message) {
	      var actual,
	          result = false;
	      var currentTest = this instanceof Assert && this.test || config.current; // 'expected' is optional unless doing string comparison

	      if (objectType(expected) === "string") {
	        if (message == null) {
	          message = expected;
	          expected = null;
	        } else {
	          throw new Error("throws/raises does not accept a string value for the expected argument.\n" + "Use a non-string object value (e.g. regExp) instead if it's necessary.");
	        }
	      }

	      currentTest.ignoreGlobalErrors = true;

	      try {
	        block.call(currentTest.testEnvironment);
	      } catch (e) {
	        actual = e;
	      }

	      currentTest.ignoreGlobalErrors = false;

	      if (actual) {
	        var expectedType = objectType(expected); // We don't want to validate thrown error

	        if (!expected) {
	          result = true; // Expected is a regexp
	        } else if (expectedType === "regexp") {
	          result = expected.test(errorString(actual)); // Log the string form of the regexp

	          expected = String(expected); // Expected is a constructor, maybe an Error constructor
	        } else if (expectedType === "function" && actual instanceof expected) {
	          result = true; // Expected is an Error object
	        } else if (expectedType === "object") {
	          result = actual instanceof expected.constructor && actual.name === expected.name && actual.message === expected.message; // Log the string form of the Error object

	          expected = errorString(expected); // Expected is a validation function which returns true if validation passed
	        } else if (expectedType === "function" && expected.call({}, actual) === true) {
	          expected = null;
	          result = true;
	        }
	      }

	      currentTest.assert.pushResult({
	        result: result,
	        // undefined if it didn't throw
	        actual: actual && errorString(actual),
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "rejects",
	    value: function rejects(promise, expected, message) {
	      var result = false;
	      var currentTest = this instanceof Assert && this.test || config.current; // 'expected' is optional unless doing string comparison

	      if (objectType(expected) === "string") {
	        if (message === undefined) {
	          message = expected;
	          expected = undefined;
	        } else {
	          message = "assert.rejects does not accept a string value for the expected " + "argument.\nUse a non-string object value (e.g. validator function) instead " + "if necessary.";
	          currentTest.assert.pushResult({
	            result: false,
	            message: message
	          });
	          return;
	        }
	      }

	      var then = promise && promise.then;

	      if (objectType(then) !== "function") {
	        var _message = "The value provided to `assert.rejects` in " + "\"" + currentTest.testName + "\" was not a promise.";

	        currentTest.assert.pushResult({
	          result: false,
	          message: _message,
	          actual: promise
	        });
	        return;
	      }

	      var done = this.async();
	      return then.call(promise, function handleFulfillment() {
	        var message = "The promise returned by the `assert.rejects` callback in " + "\"" + currentTest.testName + "\" did not reject.";
	        currentTest.assert.pushResult({
	          result: false,
	          message: message,
	          actual: promise
	        });
	        done();
	      }, function handleRejection(actual) {
	        var expectedType = objectType(expected); // We don't want to validate

	        if (expected === undefined) {
	          result = true; // Expected is a regexp
	        } else if (expectedType === "regexp") {
	          result = expected.test(errorString(actual)); // Log the string form of the regexp

	          expected = String(expected); // Expected is a constructor, maybe an Error constructor
	        } else if (expectedType === "function" && actual instanceof expected) {
	          result = true; // Expected is an Error object
	        } else if (expectedType === "object") {
	          result = actual instanceof expected.constructor && actual.name === expected.name && actual.message === expected.message; // Log the string form of the Error object

	          expected = errorString(expected); // Expected is a validation function which returns true if validation passed
	        } else {
	          if (expectedType === "function") {
	            result = expected.call({}, actual) === true;
	            expected = null; // Expected is some other invalid type
	          } else {
	            result = false;
	            message = "invalid expected value provided to `assert.rejects` " + "callback in \"" + currentTest.testName + "\": " + expectedType + ".";
	          }
	        }

	        currentTest.assert.pushResult({
	          result: result,
	          // leave rejection value of undefined as-is
	          actual: actual && errorString(actual),
	          expected: expected,
	          message: message
	        });
	        done();
	      });
	    }
	  }]);

	  return Assert;
	}(); // Provide an alternative to assert.throws(), for environments that consider throws a reserved word
	// Known to us are: Closure Compiler, Narwhal
	// eslint-disable-next-line dot-notation


	Assert.prototype.raises = Assert.prototype["throws"];
	/**
	 * Converts an error into a simple string for comparisons.
	 *
	 * @param {Error|Object} error
	 * @return {String}
	 */

	function errorString(error) {
	  var resultErrorString = error.toString(); // If the error wasn't a subclass of Error but something like
	  // an object literal with name and message properties...

	  if (resultErrorString.substring(0, 7) === "[object") {
	    var name = error.name ? error.name.toString() : "Error";
	    var message = error.message ? error.message.toString() : "";

	    if (name && message) {
	      return "".concat(name, ": ").concat(message);
	    } else if (name) {
	      return name;
	    } else if (message) {
	      return message;
	    } else {
	      return "Error";
	    }
	  } else {
	    return resultErrorString;
	  }
	}

	/* global module, exports, define */
	function exportQUnit(QUnit) {
	  if (defined.document) {
	    // QUnit may be defined when it is preconfigured but then only QUnit and QUnit.config may be defined.
	    if (window$1.QUnit && window$1.QUnit.version) {
	      throw new Error("QUnit has already been defined.");
	    }

	    window$1.QUnit = QUnit;
	  } // For nodejs


	  if (typeof module !== "undefined" && module && module.exports) {
	    module.exports = QUnit; // For consistency with CommonJS environments' exports

	    module.exports.QUnit = QUnit;
	  } // For CommonJS with exports, but without module.exports, like Rhino


	  if (typeof exports !== "undefined" && exports) {
	    exports.QUnit = QUnit;
	  }

	  if (typeof define === "function" && define.amd) {
	    define(function () {
	      return QUnit;
	    });
	    QUnit.config.autostart = false;
	  } // For Web/Service Workers


	  if (self$1 && self$1.WorkerGlobalScope && self$1 instanceof self$1.WorkerGlobalScope) {
	    self$1.QUnit = QUnit;
	  }
	}

	// error handling should be suppressed and false otherwise.
	// In this case, we will only suppress further error handling if the
	// "ignoreGlobalErrors" configuration option is enabled.

	function onError(error) {
	  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
	    args[_key - 1] = arguments[_key];
	  }

	  if (config.current) {
	    if (config.current.ignoreGlobalErrors) {
	      return true;
	    }

	    pushFailure.apply(void 0, [error.message, error.stacktrace || error.fileName + ":" + error.lineNumber].concat(args));
	  } else {
	    test("global failure", extend(function () {
	      pushFailure.apply(void 0, [error.message, error.stacktrace || error.fileName + ":" + error.lineNumber].concat(args));
	    }, {
	      validTest: true
	    }));
	  }

	  return false;
	}

	function onUnhandledRejection(reason) {
	  var resultInfo = {
	    result: false,
	    message: reason.message || "error",
	    actual: reason,
	    source: reason.stack || sourceFromStacktrace(3)
	  };
	  var currentTest = config.current;

	  if (currentTest) {
	    currentTest.assert.pushResult(resultInfo);
	  } else {
	    test("global failure", extend(function (assert) {
	      assert.pushResult(resultInfo);
	    }, {
	      validTest: true
	    }));
	  }
	}

	var QUnit = {};
	var globalSuite = new SuiteReport(); // The initial "currentModule" represents the global (or top-level) module that
	// is not explicitly defined by the user, therefore we add the "globalSuite" to
	// it since each module has a suiteReport associated with it.

	config.currentModule.suiteReport = globalSuite;
	var globalStartCalled = false;
	var runStarted = false; // Figure out if we're running the tests from a server or not

	QUnit.isLocal = !(defined.document && window$1.location.protocol !== "file:"); // Expose the current QUnit version

	QUnit.version = "2.11.3";
	extend(QUnit, {
	  on: on,
	  module: module$1,
	  test: test,
	  todo: todo,
	  skip: skip,
	  only: only,
	  start: function start(count) {
	    var globalStartAlreadyCalled = globalStartCalled;

	    if (!config.current) {
	      globalStartCalled = true;

	      if (runStarted) {
	        throw new Error("Called start() while test already started running");
	      } else if (globalStartAlreadyCalled || count > 1) {
	        throw new Error("Called start() outside of a test context too many times");
	      } else if (config.autostart) {
	        throw new Error("Called start() outside of a test context when " + "QUnit.config.autostart was true");
	      } else if (!config.pageLoaded) {
	        // The page isn't completely loaded yet, so we set autostart and then
	        // load if we're in Node or wait for the browser's load event.
	        config.autostart = true; // Starts from Node even if .load was not previously called. We still return
	        // early otherwise we'll wind up "beginning" twice.

	        if (!defined.document) {
	          QUnit.load();
	        }

	        return;
	      }
	    } else {
	      throw new Error("QUnit.start cannot be called inside a test context.");
	    }

	    scheduleBegin();
	  },
	  config: config,
	  is: is,
	  objectType: objectType,
	  extend: extend,
	  load: function load() {
	    config.pageLoaded = true; // Initialize the configuration options

	    extend(config, {
	      stats: {
	        all: 0,
	        bad: 0,
	        testCount: 0
	      },
	      started: 0,
	      updateRate: 1000,
	      autostart: true,
	      filter: ""
	    }, true);

	    if (!runStarted) {
	      config.blocking = false;

	      if (config.autostart) {
	        scheduleBegin();
	      }
	    }
	  },
	  stack: function stack(offset) {
	    offset = (offset || 0) + 2;
	    return sourceFromStacktrace(offset);
	  },
	  onError: onError,
	  onUnhandledRejection: onUnhandledRejection
	});
	QUnit.pushFailure = pushFailure;
	QUnit.assert = Assert.prototype;
	QUnit.equiv = equiv;
	QUnit.dump = dump;
	registerLoggingCallbacks(QUnit);

	function scheduleBegin() {
	  runStarted = true; // Add a slight delay to allow definition of more modules and tests.

	  if (defined.setTimeout) {
	    setTimeout$1(function () {
	      begin();
	    });
	  } else {
	    begin();
	  }
	}

	function unblockAndAdvanceQueue() {
	  config.blocking = false;
	  ProcessingQueue.advance();
	}

	function begin() {
	  var i,
	      l,
	      modulesLog = []; // If the test run hasn't officially begun yet

	  if (!config.started) {
	    // Record the time of the test run's beginning
	    config.started = now(); // Delete the loose unnamed module if unused.

	    if (config.modules[0].name === "" && config.modules[0].tests.length === 0) {
	      config.modules.shift();
	    } // Avoid unnecessary information by not logging modules' test environments


	    for (i = 0, l = config.modules.length; i < l; i++) {
	      modulesLog.push({
	        name: config.modules[i].name,
	        tests: config.modules[i].tests
	      });
	    } // The test run is officially beginning now


	    emit("runStart", globalSuite.start(true));
	    runLoggingCallbacks("begin", {
	      totalTests: Test.count,
	      modules: modulesLog
	    }).then(unblockAndAdvanceQueue);
	  } else {
	    unblockAndAdvanceQueue();
	  }
	}
	exportQUnit(QUnit);

	(function () {
	  if (typeof window$1 === "undefined" || typeof document$1 === "undefined") {
	    return;
	  }

	  var config = QUnit.config,
	      hasOwn = Object.prototype.hasOwnProperty; // Stores fixture HTML for resetting later

	  function storeFixture() {
	    // Avoid overwriting user-defined values
	    if (hasOwn.call(config, "fixture")) {
	      return;
	    }

	    var fixture = document$1.getElementById("qunit-fixture");

	    if (fixture) {
	      config.fixture = fixture.cloneNode(true);
	    }
	  }

	  QUnit.begin(storeFixture); // Resets the fixture DOM element if available.

	  function resetFixture() {
	    if (config.fixture == null) {
	      return;
	    }

	    var fixture = document$1.getElementById("qunit-fixture");

	    var resetFixtureType = _typeof(config.fixture);

	    if (resetFixtureType === "string") {
	      // support user defined values for `config.fixture`
	      var newFixture = document$1.createElement("div");
	      newFixture.setAttribute("id", "qunit-fixture");
	      newFixture.innerHTML = config.fixture;
	      fixture.parentNode.replaceChild(newFixture, fixture);
	    } else {
	      var clonedFixture = config.fixture.cloneNode(true);
	      fixture.parentNode.replaceChild(clonedFixture, fixture);
	    }
	  }

	  QUnit.testStart(resetFixture);
	})();

	(function () {
	  // Only interact with URLs via window.location
	  var location = typeof window$1 !== "undefined" && window$1.location;

	  if (!location) {
	    return;
	  }

	  var urlParams = getUrlParams();
	  QUnit.urlParams = urlParams; // Match module/test by inclusion in an array

	  QUnit.config.moduleId = [].concat(urlParams.moduleId || []);
	  QUnit.config.testId = [].concat(urlParams.testId || []); // Exact case-insensitive match of the module name

	  QUnit.config.module = urlParams.module; // Regular expression or case-insenstive substring match against "moduleName: testName"

	  QUnit.config.filter = urlParams.filter; // Test order randomization

	  if (urlParams.seed === true) {
	    // Generate a random seed if the option is specified without a value
	    QUnit.config.seed = Math.random().toString(36).slice(2);
	  } else if (urlParams.seed) {
	    QUnit.config.seed = urlParams.seed;
	  } // Add URL-parameter-mapped config values with UI form rendering data


	  QUnit.config.urlConfig.push({
	    id: "hidepassed",
	    label: "Hide passed tests",
	    tooltip: "Only show tests and assertions that fail. Stored as query-strings."
	  }, {
	    id: "noglobals",
	    label: "Check for Globals",
	    tooltip: "Enabling this will test if any test introduces new properties on the " + "global object (`window` in Browsers). Stored as query-strings."
	  }, {
	    id: "notrycatch",
	    label: "No try-catch",
	    tooltip: "Enabling this will run tests outside of a try-catch block. Makes debugging " + "exceptions in IE reasonable. Stored as query-strings."
	  });
	  QUnit.begin(function () {
	    var i,
	        option,
	        urlConfig = QUnit.config.urlConfig;

	    for (i = 0; i < urlConfig.length; i++) {
	      // Options can be either strings or objects with nonempty "id" properties
	      option = QUnit.config.urlConfig[i];

	      if (typeof option !== "string") {
	        option = option.id;
	      }

	      if (QUnit.config[option] === undefined) {
	        QUnit.config[option] = urlParams[option];
	      }
	    }
	  });

	  function getUrlParams() {
	    var i, param, name, value;
	    var urlParams = Object.create(null);
	    var params = location.search.slice(1).split("&");
	    var length = params.length;

	    for (i = 0; i < length; i++) {
	      if (params[i]) {
	        param = params[i].split("=");
	        name = decodeQueryParam(param[0]); // Allow just a key to turn on a flag, e.g., test.html?noglobals

	        value = param.length === 1 || decodeQueryParam(param.slice(1).join("="));

	        if (name in urlParams) {
	          urlParams[name] = [].concat(urlParams[name], value);
	        } else {
	          urlParams[name] = value;
	        }
	      }
	    }

	    return urlParams;
	  }

	  function decodeQueryParam(param) {
	    return decodeURIComponent(param.replace(/\+/g, "%20"));
	  }
	})();

	var fuzzysort = createCommonjsModule(function (module) {

	  (function (root, UMD) {
	    if ( module.exports) module.exports = UMD();else root.fuzzysort = UMD();
	  })(commonjsGlobal, function UMD() {
	    function fuzzysortNew(instanceOptions) {
	      var fuzzysort = {
	        single: function (search, target, options) {
	          if (!search) return null;
	          if (!isObj(search)) search = fuzzysort.getPreparedSearch(search);
	          if (!target) return null;
	          if (!isObj(target)) target = fuzzysort.getPrepared(target);
	          var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	          var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	          return algorithm(search, target, search[0]); // var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991
	          // var result = algorithm(search, target, search[0])
	          // if(result === null) return null
	          // if(result.score < threshold) return null
	          // return result
	        },
	        go: function (search, targets, options) {
	          if (!search) return noResults;
	          search = fuzzysort.prepareSearch(search);
	          var searchLowerCode = search[0];
	          var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991;
	          var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991;
	          var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	          var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	          var resultsLen = 0;
	          var limitedCount = 0;
	          var targetsLen = targets.length; // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]
	          // options.keys

	          if (options && options.keys) {
	            var scoreFn = options.scoreFn || defaultScoreFn;
	            var keys = options.keys;
	            var keysLen = keys.length;

	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var obj = targets[i];
	              var objResults = new Array(keysLen);

	              for (var keyI = keysLen - 1; keyI >= 0; --keyI) {
	                var key = keys[keyI];
	                var target = getValue(obj, key);

	                if (!target) {
	                  objResults[keyI] = null;
	                  continue;
	                }

	                if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                objResults[keyI] = algorithm(search, target, searchLowerCode);
	              }

	              objResults.obj = obj; // before scoreFn so scoreFn can use it

	              var score = scoreFn(objResults);
	              if (score === null) continue;
	              if (score < threshold) continue;
	              objResults.score = score;

	              if (resultsLen < limit) {
	                q.add(objResults);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (score > q.peek().score) q.replaceTop(objResults);
	              }
	            } // options.key

	          } else if (options && options.key) {
	            var key = options.key;

	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var obj = targets[i];
	              var target = getValue(obj, key);
	              if (!target) continue;
	              if (!isObj(target)) target = fuzzysort.getPrepared(target);
	              var result = algorithm(search, target, searchLowerCode);
	              if (result === null) continue;
	              if (result.score < threshold) continue; // have to clone result so duplicate targets from different obj can each reference the correct obj

	              result = {
	                target: result.target,
	                _targetLowerCodes: null,
	                _nextBeginningIndexes: null,
	                score: result.score,
	                indexes: result.indexes,
	                obj: obj
	              }; // hidden

	              if (resultsLen < limit) {
	                q.add(result);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (result.score > q.peek().score) q.replaceTop(result);
	              }
	            } // no keys

	          } else {
	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var target = targets[i];
	              if (!target) continue;
	              if (!isObj(target)) target = fuzzysort.getPrepared(target);
	              var result = algorithm(search, target, searchLowerCode);
	              if (result === null) continue;
	              if (result.score < threshold) continue;

	              if (resultsLen < limit) {
	                q.add(result);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (result.score > q.peek().score) q.replaceTop(result);
	              }
	            }
	          }

	          if (resultsLen === 0) return noResults;
	          var results = new Array(resultsLen);

	          for (var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll();

	          results.total = resultsLen + limitedCount;
	          return results;
	        },
	        goAsync: function (search, targets, options) {
	          var canceled = false;
	          var p = new Promise(function (resolve, reject) {
	            if (!search) return resolve(noResults);
	            search = fuzzysort.prepareSearch(search);
	            var searchLowerCode = search[0];
	            var q = fastpriorityqueue();
	            var iCurrent = targets.length - 1;
	            var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991;
	            var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991;
	            var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	            var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	            var resultsLen = 0;
	            var limitedCount = 0;

	            function step() {
	              if (canceled) return reject('canceled');
	              var startMs = Date.now(); // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]
	              // options.keys

	              if (options && options.keys) {
	                var scoreFn = options.scoreFn || defaultScoreFn;
	                var keys = options.keys;
	                var keysLen = keys.length;

	                for (; iCurrent >= 0; --iCurrent) {
	                  var obj = targets[iCurrent];
	                  var objResults = new Array(keysLen);

	                  for (var keyI = keysLen - 1; keyI >= 0; --keyI) {
	                    var key = keys[keyI];
	                    var target = getValue(obj, key);

	                    if (!target) {
	                      objResults[keyI] = null;
	                      continue;
	                    }

	                    if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                    objResults[keyI] = algorithm(search, target, searchLowerCode);
	                  }

	                  objResults.obj = obj; // before scoreFn so scoreFn can use it

	                  var score = scoreFn(objResults);
	                  if (score === null) continue;
	                  if (score < threshold) continue;
	                  objResults.score = score;

	                  if (resultsLen < limit) {
	                    q.add(objResults);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (score > q.peek().score) q.replaceTop(objResults);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                } // options.key

	              } else if (options && options.key) {
	                var key = options.key;

	                for (; iCurrent >= 0; --iCurrent) {
	                  var obj = targets[iCurrent];
	                  var target = getValue(obj, key);
	                  if (!target) continue;
	                  if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                  var result = algorithm(search, target, searchLowerCode);
	                  if (result === null) continue;
	                  if (result.score < threshold) continue; // have to clone result so duplicate targets from different obj can each reference the correct obj

	                  result = {
	                    target: result.target,
	                    _targetLowerCodes: null,
	                    _nextBeginningIndexes: null,
	                    score: result.score,
	                    indexes: result.indexes,
	                    obj: obj
	                  }; // hidden

	                  if (resultsLen < limit) {
	                    q.add(result);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (result.score > q.peek().score) q.replaceTop(result);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                } // no keys

	              } else {
	                for (; iCurrent >= 0; --iCurrent) {
	                  var target = targets[iCurrent];
	                  if (!target) continue;
	                  if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                  var result = algorithm(search, target, searchLowerCode);
	                  if (result === null) continue;
	                  if (result.score < threshold) continue;

	                  if (resultsLen < limit) {
	                    q.add(result);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (result.score > q.peek().score) q.replaceTop(result);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                }
	              }

	              if (resultsLen === 0) return resolve(noResults);
	              var results = new Array(resultsLen);

	              for (var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll();

	              results.total = resultsLen + limitedCount;
	              resolve(results);
	            }

	            isNode ? setImmediate(step) : step();
	          });

	          p.cancel = function () {
	            canceled = true;
	          };

	          return p;
	        },
	        highlight: function (result, hOpen, hClose) {
	          if (result === null) return null;
	          if (hOpen === undefined) hOpen = '<b>';
	          if (hClose === undefined) hClose = '</b>';
	          var highlighted = '';
	          var matchesIndex = 0;
	          var opened = false;
	          var target = result.target;
	          var targetLen = target.length;
	          var matchesBest = result.indexes;

	          for (var i = 0; i < targetLen; ++i) {
	            var char = target[i];

	            if (matchesBest[matchesIndex] === i) {
	              ++matchesIndex;

	              if (!opened) {
	                opened = true;
	                highlighted += hOpen;
	              }

	              if (matchesIndex === matchesBest.length) {
	                highlighted += char + hClose + target.substr(i + 1);
	                break;
	              }
	            } else {
	              if (opened) {
	                opened = false;
	                highlighted += hClose;
	              }
	            }

	            highlighted += char;
	          }

	          return highlighted;
	        },
	        prepare: function (target) {
	          if (!target) return;
	          return {
	            target: target,
	            _targetLowerCodes: fuzzysort.prepareLowerCodes(target),
	            _nextBeginningIndexes: null,
	            score: null,
	            indexes: null,
	            obj: null
	          }; // hidden
	        },
	        prepareSlow: function (target) {
	          if (!target) return;
	          return {
	            target: target,
	            _targetLowerCodes: fuzzysort.prepareLowerCodes(target),
	            _nextBeginningIndexes: fuzzysort.prepareNextBeginningIndexes(target),
	            score: null,
	            indexes: null,
	            obj: null
	          }; // hidden
	        },
	        prepareSearch: function (search) {
	          if (!search) return;
	          return fuzzysort.prepareLowerCodes(search);
	        },
	        // Below this point is only internal code
	        // Below this point is only internal code
	        // Below this point is only internal code
	        // Below this point is only internal code
	        getPrepared: function (target) {
	          if (target.length > 999) return fuzzysort.prepare(target); // don't cache huge targets

	          var targetPrepared = preparedCache.get(target);
	          if (targetPrepared !== undefined) return targetPrepared;
	          targetPrepared = fuzzysort.prepare(target);
	          preparedCache.set(target, targetPrepared);
	          return targetPrepared;
	        },
	        getPreparedSearch: function (search) {
	          if (search.length > 999) return fuzzysort.prepareSearch(search); // don't cache huge searches

	          var searchPrepared = preparedSearchCache.get(search);
	          if (searchPrepared !== undefined) return searchPrepared;
	          searchPrepared = fuzzysort.prepareSearch(search);
	          preparedSearchCache.set(search, searchPrepared);
	          return searchPrepared;
	        },
	        algorithm: function (searchLowerCodes, prepared, searchLowerCode) {
	          var targetLowerCodes = prepared._targetLowerCodes;
	          var searchLen = searchLowerCodes.length;
	          var targetLen = targetLowerCodes.length;
	          var searchI = 0; // where we at

	          var targetI = 0; // where you at

	          var typoSimpleI = 0;
	          var matchesSimpleLen = 0; // very basic fuzzy match; to remove non-matching targets ASAP!
	          // walk through target. find sequential matches.
	          // if all chars aren't found then exit

	          for (;;) {
	            var isMatch = searchLowerCode === targetLowerCodes[targetI];

	            if (isMatch) {
	              matchesSimple[matchesSimpleLen++] = targetI;
	              ++searchI;
	              if (searchI === searchLen) break;
	              searchLowerCode = searchLowerCodes[typoSimpleI === 0 ? searchI : typoSimpleI === searchI ? searchI + 1 : typoSimpleI === searchI - 1 ? searchI - 1 : searchI];
	            }

	            ++targetI;

	            if (targetI >= targetLen) {
	              // Failed to find searchI
	              // Check for typo or exit
	              // we go as far as possible before trying to transpose
	              // then we transpose backwards until we reach the beginning
	              for (;;) {
	                if (searchI <= 1) return null; // not allowed to transpose first char

	                if (typoSimpleI === 0) {
	                  // we haven't tried to transpose yet
	                  --searchI;
	                  var searchLowerCodeNew = searchLowerCodes[searchI];
	                  if (searchLowerCode === searchLowerCodeNew) continue; // doesn't make sense to transpose a repeat char

	                  typoSimpleI = searchI;
	                } else {
	                  if (typoSimpleI === 1) return null; // reached the end of the line for transposing

	                  --typoSimpleI;
	                  searchI = typoSimpleI;
	                  searchLowerCode = searchLowerCodes[searchI + 1];
	                  var searchLowerCodeNew = searchLowerCodes[searchI];
	                  if (searchLowerCode === searchLowerCodeNew) continue; // doesn't make sense to transpose a repeat char
	                }

	                matchesSimpleLen = searchI;
	                targetI = matchesSimple[matchesSimpleLen - 1] + 1;
	                break;
	              }
	            }
	          }

	          var searchI = 0;
	          var typoStrictI = 0;
	          var successStrict = false;
	          var matchesStrictLen = 0;
	          var nextBeginningIndexes = prepared._nextBeginningIndexes;
	          if (nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target);
	          var firstPossibleI = targetI = matchesSimple[0] === 0 ? 0 : nextBeginningIndexes[matchesSimple[0] - 1]; // Our target string successfully matched all characters in sequence!
	          // Let's try a more advanced and strict test to improve the score
	          // only count it as a match if it's consecutive or a beginning character!

	          if (targetI !== targetLen) for (;;) {
	            if (targetI >= targetLen) {
	              // We failed to find a good spot for this search char, go back to the previous search char and force it forward
	              if (searchI <= 0) {
	                // We failed to push chars forward for a better match
	                // transpose, starting from the beginning
	                ++typoStrictI;
	                if (typoStrictI > searchLen - 2) break;
	                if (searchLowerCodes[typoStrictI] === searchLowerCodes[typoStrictI + 1]) continue; // doesn't make sense to transpose a repeat char

	                targetI = firstPossibleI;
	                continue;
	              }

	              --searchI;
	              var lastMatch = matchesStrict[--matchesStrictLen];
	              targetI = nextBeginningIndexes[lastMatch];
	            } else {
	              var isMatch = searchLowerCodes[typoStrictI === 0 ? searchI : typoStrictI === searchI ? searchI + 1 : typoStrictI === searchI - 1 ? searchI - 1 : searchI] === targetLowerCodes[targetI];

	              if (isMatch) {
	                matchesStrict[matchesStrictLen++] = targetI;
	                ++searchI;

	                if (searchI === searchLen) {
	                  successStrict = true;
	                  break;
	                }

	                ++targetI;
	              } else {
	                targetI = nextBeginningIndexes[targetI];
	              }
	            }
	          }
	          {
	            // tally up the score & keep track of matches for highlighting later
	            if (successStrict) {
	              var matchesBest = matchesStrict;
	              var matchesBestLen = matchesStrictLen;
	            } else {
	              var matchesBest = matchesSimple;
	              var matchesBestLen = matchesSimpleLen;
	            }

	            var score = 0;
	            var lastTargetI = -1;

	            for (var i = 0; i < searchLen; ++i) {
	              var targetI = matchesBest[i]; // score only goes down if they're not consecutive

	              if (lastTargetI !== targetI - 1) score -= targetI;
	              lastTargetI = targetI;
	            }

	            if (!successStrict) {
	              score *= 1000;
	              if (typoSimpleI !== 0) score += -20;
	              /*typoPenalty*/
	            } else {
	              if (typoStrictI !== 0) score += -20;
	              /*typoPenalty*/
	            }

	            score -= targetLen - searchLen;
	            prepared.score = score;
	            prepared.indexes = new Array(matchesBestLen);

	            for (var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i];

	            return prepared;
	          }
	        },
	        algorithmNoTypo: function (searchLowerCodes, prepared, searchLowerCode) {
	          var targetLowerCodes = prepared._targetLowerCodes;
	          var searchLen = searchLowerCodes.length;
	          var targetLen = targetLowerCodes.length;
	          var searchI = 0; // where we at

	          var targetI = 0; // where you at

	          var matchesSimpleLen = 0; // very basic fuzzy match; to remove non-matching targets ASAP!
	          // walk through target. find sequential matches.
	          // if all chars aren't found then exit

	          for (;;) {
	            var isMatch = searchLowerCode === targetLowerCodes[targetI];

	            if (isMatch) {
	              matchesSimple[matchesSimpleLen++] = targetI;
	              ++searchI;
	              if (searchI === searchLen) break;
	              searchLowerCode = searchLowerCodes[searchI];
	            }

	            ++targetI;
	            if (targetI >= targetLen) return null; // Failed to find searchI
	          }

	          var searchI = 0;
	          var successStrict = false;
	          var matchesStrictLen = 0;
	          var nextBeginningIndexes = prepared._nextBeginningIndexes;
	          if (nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target);
	          var firstPossibleI = targetI = matchesSimple[0] === 0 ? 0 : nextBeginningIndexes[matchesSimple[0] - 1]; // Our target string successfully matched all characters in sequence!
	          // Let's try a more advanced and strict test to improve the score
	          // only count it as a match if it's consecutive or a beginning character!

	          if (targetI !== targetLen) for (;;) {
	            if (targetI >= targetLen) {
	              // We failed to find a good spot for this search char, go back to the previous search char and force it forward
	              if (searchI <= 0) break; // We failed to push chars forward for a better match

	              --searchI;
	              var lastMatch = matchesStrict[--matchesStrictLen];
	              targetI = nextBeginningIndexes[lastMatch];
	            } else {
	              var isMatch = searchLowerCodes[searchI] === targetLowerCodes[targetI];

	              if (isMatch) {
	                matchesStrict[matchesStrictLen++] = targetI;
	                ++searchI;

	                if (searchI === searchLen) {
	                  successStrict = true;
	                  break;
	                }

	                ++targetI;
	              } else {
	                targetI = nextBeginningIndexes[targetI];
	              }
	            }
	          }
	          {
	            // tally up the score & keep track of matches for highlighting later
	            if (successStrict) {
	              var matchesBest = matchesStrict;
	              var matchesBestLen = matchesStrictLen;
	            } else {
	              var matchesBest = matchesSimple;
	              var matchesBestLen = matchesSimpleLen;
	            }

	            var score = 0;
	            var lastTargetI = -1;

	            for (var i = 0; i < searchLen; ++i) {
	              var targetI = matchesBest[i]; // score only goes down if they're not consecutive

	              if (lastTargetI !== targetI - 1) score -= targetI;
	              lastTargetI = targetI;
	            }

	            if (!successStrict) score *= 1000;
	            score -= targetLen - searchLen;
	            prepared.score = score;
	            prepared.indexes = new Array(matchesBestLen);

	            for (var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i];

	            return prepared;
	          }
	        },
	        prepareLowerCodes: function (str) {
	          var strLen = str.length;
	          var lowerCodes = []; // new Array(strLen)    sparse array is too slow

	          var lower = str.toLowerCase();

	          for (var i = 0; i < strLen; ++i) lowerCodes[i] = lower.charCodeAt(i);

	          return lowerCodes;
	        },
	        prepareBeginningIndexes: function (target) {
	          var targetLen = target.length;
	          var beginningIndexes = [];
	          var beginningIndexesLen = 0;
	          var wasUpper = false;
	          var wasAlphanum = false;

	          for (var i = 0; i < targetLen; ++i) {
	            var targetCode = target.charCodeAt(i);
	            var isUpper = targetCode >= 65 && targetCode <= 90;
	            var isAlphanum = isUpper || targetCode >= 97 && targetCode <= 122 || targetCode >= 48 && targetCode <= 57;
	            var isBeginning = isUpper && !wasUpper || !wasAlphanum || !isAlphanum;
	            wasUpper = isUpper;
	            wasAlphanum = isAlphanum;
	            if (isBeginning) beginningIndexes[beginningIndexesLen++] = i;
	          }

	          return beginningIndexes;
	        },
	        prepareNextBeginningIndexes: function (target) {
	          var targetLen = target.length;
	          var beginningIndexes = fuzzysort.prepareBeginningIndexes(target);
	          var nextBeginningIndexes = []; // new Array(targetLen)     sparse array is too slow

	          var lastIsBeginning = beginningIndexes[0];
	          var lastIsBeginningI = 0;

	          for (var i = 0; i < targetLen; ++i) {
	            if (lastIsBeginning > i) {
	              nextBeginningIndexes[i] = lastIsBeginning;
	            } else {
	              lastIsBeginning = beginningIndexes[++lastIsBeginningI];
	              nextBeginningIndexes[i] = lastIsBeginning === undefined ? targetLen : lastIsBeginning;
	            }
	          }

	          return nextBeginningIndexes;
	        },
	        cleanup: cleanup,
	        new: fuzzysortNew
	      };
	      return fuzzysort;
	    } // fuzzysortNew
	    // This stuff is outside fuzzysortNew, because it's shared with instances of fuzzysort.new()


	    var isNode = typeof commonjsRequire !== 'undefined' && typeof window === 'undefined'; // var MAX_INT = Number.MAX_SAFE_INTEGER
	    // var MIN_INT = Number.MIN_VALUE

	    var preparedCache = new Map();
	    var preparedSearchCache = new Map();
	    var noResults = [];
	    noResults.total = 0;
	    var matchesSimple = [];
	    var matchesStrict = [];

	    function cleanup() {
	      preparedCache.clear();
	      preparedSearchCache.clear();
	      matchesSimple = [];
	      matchesStrict = [];
	    }

	    function defaultScoreFn(a) {
	      var max = -9007199254740991;

	      for (var i = a.length - 1; i >= 0; --i) {
	        var result = a[i];
	        if (result === null) continue;
	        var score = result.score;
	        if (score > max) max = score;
	      }

	      if (max === -9007199254740991) return null;
	      return max;
	    } // prop = 'key'              2.5ms optimized for this case, seems to be about as fast as direct obj[prop]
	    // prop = 'key1.key2'        10ms
	    // prop = ['key1', 'key2']   27ms


	    function getValue(obj, prop) {
	      var tmp = obj[prop];
	      if (tmp !== undefined) return tmp;
	      var segs = prop;
	      if (!Array.isArray(prop)) segs = prop.split('.');
	      var len = segs.length;
	      var i = -1;

	      while (obj && ++i < len) obj = obj[segs[i]];

	      return obj;
	    }

	    function isObj(x) {
	      return typeof x === 'object';
	    } // faster as a function
	    // Hacked version of https://github.com/lemire/FastPriorityQueue.js


	    var fastpriorityqueue = function () {
	      var r = [],
	          o = 0,
	          e = {};

	      function n() {
	        for (var e = 0, n = r[e], c = 1; c < o;) {
	          var f = c + 1;
	          e = c, f < o && r[f].score < r[c].score && (e = f), r[e - 1 >> 1] = r[e], c = 1 + (e << 1);
	        }

	        for (var a = e - 1 >> 1; e > 0 && n.score < r[a].score; a = (e = a) - 1 >> 1) r[e] = r[a];

	        r[e] = n;
	      }

	      return e.add = function (e) {
	        var n = o;
	        r[o++] = e;

	        for (var c = n - 1 >> 1; n > 0 && e.score < r[c].score; c = (n = c) - 1 >> 1) r[n] = r[c];

	        r[n] = e;
	      }, e.poll = function () {
	        if (0 !== o) {
	          var e = r[0];
	          return r[0] = r[--o], n(), e;
	        }
	      }, e.peek = function (e) {
	        if (0 !== o) return r[0];
	      }, e.replaceTop = function (o) {
	        r[0] = o, n();
	      }, e;
	    };

	    var q = fastpriorityqueue(); // reuse this, except for async, it needs to make its own

	    return fuzzysortNew();
	  }); // UMD
	  // TODO: (performance) wasm version!?
	  // TODO: (performance) layout memory in an optimal way to go fast by avoiding cache misses
	  // TODO: (performance) preparedCache is a memory leak
	  // TODO: (like sublime) backslash === forwardslash
	  // TODO: (performance) i have no idea how well optizmied the allowing typos algorithm is

	});

	var stats = {
	  passedTests: 0,
	  failedTests: 0,
	  skippedTests: 0,
	  todoTests: 0
	}; // Escape text for attribute or text content.

	function escapeText(s) {
	  if (!s) {
	    return "";
	  }

	  s = s + ""; // Both single quotes and double quotes (for attributes)

	  return s.replace(/['"<>&]/g, function (s) {
	    switch (s) {
	      case "'":
	        return "&#039;";

	      case "\"":
	        return "&quot;";

	      case "<":
	        return "&lt;";

	      case ">":
	        return "&gt;";

	      case "&":
	        return "&amp;";
	    }
	  });
	}

	(function () {
	  // Don't load the HTML Reporter on non-browser environments
	  if (typeof window$1 === "undefined" || !window$1.document) {
	    return;
	  }

	  var config = QUnit.config,
	      hiddenTests = [],
	      document = window$1.document,
	      collapseNext = false,
	      hasOwn = Object.prototype.hasOwnProperty,
	      unfilteredUrl = setUrl({
	    filter: undefined,
	    module: undefined,
	    moduleId: undefined,
	    testId: undefined
	  }),
	      modulesList = [];

	  function addEvent(elem, type, fn) {
	    elem.addEventListener(type, fn, false);
	  }

	  function removeEvent(elem, type, fn) {
	    elem.removeEventListener(type, fn, false);
	  }

	  function addEvents(elems, type, fn) {
	    var i = elems.length;

	    while (i--) {
	      addEvent(elems[i], type, fn);
	    }
	  }

	  function hasClass(elem, name) {
	    return (" " + elem.className + " ").indexOf(" " + name + " ") >= 0;
	  }

	  function addClass(elem, name) {
	    if (!hasClass(elem, name)) {
	      elem.className += (elem.className ? " " : "") + name;
	    }
	  }

	  function toggleClass(elem, name, force) {
	    if (force || typeof force === "undefined" && !hasClass(elem, name)) {
	      addClass(elem, name);
	    } else {
	      removeClass(elem, name);
	    }
	  }

	  function removeClass(elem, name) {
	    var set = " " + elem.className + " "; // Class name may appear multiple times

	    while (set.indexOf(" " + name + " ") >= 0) {
	      set = set.replace(" " + name + " ", " ");
	    } // Trim for prettiness


	    elem.className = typeof set.trim === "function" ? set.trim() : set.replace(/^\s+|\s+$/g, "");
	  }

	  function id(name) {
	    return document.getElementById && document.getElementById(name);
	  }

	  function abortTests() {
	    var abortButton = id("qunit-abort-tests-button");

	    if (abortButton) {
	      abortButton.disabled = true;
	      abortButton.innerHTML = "Aborting...";
	    }

	    QUnit.config.queue.length = 0;
	    return false;
	  }

	  function interceptNavigation(ev) {
	    applyUrlParams();

	    if (ev && ev.preventDefault) {
	      ev.preventDefault();
	    }

	    return false;
	  }

	  function getUrlConfigHtml() {
	    var i,
	        j,
	        val,
	        escaped,
	        escapedTooltip,
	        selection = false,
	        urlConfig = config.urlConfig,
	        urlConfigHtml = "";

	    for (i = 0; i < urlConfig.length; i++) {
	      // Options can be either strings or objects with nonempty "id" properties
	      val = config.urlConfig[i];

	      if (typeof val === "string") {
	        val = {
	          id: val,
	          label: val
	        };
	      }

	      escaped = escapeText(val.id);
	      escapedTooltip = escapeText(val.tooltip);

	      if (!val.value || typeof val.value === "string") {
	        urlConfigHtml += "<label for='qunit-urlconfig-" + escaped + "' title='" + escapedTooltip + "'><input id='qunit-urlconfig-" + escaped + "' name='" + escaped + "' type='checkbox'" + (val.value ? " value='" + escapeText(val.value) + "'" : "") + (config[val.id] ? " checked='checked'" : "") + " title='" + escapedTooltip + "' />" + escapeText(val.label) + "</label>";
	      } else {
	        urlConfigHtml += "<label for='qunit-urlconfig-" + escaped + "' title='" + escapedTooltip + "'>" + val.label + ": </label><select id='qunit-urlconfig-" + escaped + "' name='" + escaped + "' title='" + escapedTooltip + "'><option></option>";

	        if (QUnit.is("array", val.value)) {
	          for (j = 0; j < val.value.length; j++) {
	            escaped = escapeText(val.value[j]);
	            urlConfigHtml += "<option value='" + escaped + "'" + (config[val.id] === val.value[j] ? (selection = true) && " selected='selected'" : "") + ">" + escaped + "</option>";
	          }
	        } else {
	          for (j in val.value) {
	            if (hasOwn.call(val.value, j)) {
	              urlConfigHtml += "<option value='" + escapeText(j) + "'" + (config[val.id] === j ? (selection = true) && " selected='selected'" : "") + ">" + escapeText(val.value[j]) + "</option>";
	            }
	          }
	        }

	        if (config[val.id] && !selection) {
	          escaped = escapeText(config[val.id]);
	          urlConfigHtml += "<option value='" + escaped + "' selected='selected' disabled='disabled'>" + escaped + "</option>";
	        }

	        urlConfigHtml += "</select>";
	      }
	    }

	    return urlConfigHtml;
	  } // Handle "click" events on toolbar checkboxes and "change" for select menus.
	  // Updates the URL with the new state of `config.urlConfig` values.


	  function toolbarChanged() {
	    var updatedUrl,
	        value,
	        tests,
	        field = this,
	        params = {}; // Detect if field is a select menu or a checkbox

	    if ("selectedIndex" in field) {
	      value = field.options[field.selectedIndex].value || undefined;
	    } else {
	      value = field.checked ? field.defaultValue || true : undefined;
	    }

	    params[field.name] = value;
	    updatedUrl = setUrl(params); // Check if we can apply the change without a page refresh

	    if ("hidepassed" === field.name && "replaceState" in window$1.history) {
	      QUnit.urlParams[field.name] = value;
	      config[field.name] = value || false;
	      tests = id("qunit-tests");

	      if (tests) {
	        var length = tests.children.length;
	        var children = tests.children;

	        if (field.checked) {
	          for (var i = 0; i < length; i++) {
	            var test = children[i];
	            var className = test ? test.className : "";
	            var classNameHasPass = className.indexOf("pass") > -1;
	            var classNameHasSkipped = className.indexOf("skipped") > -1;

	            if (classNameHasPass || classNameHasSkipped) {
	              hiddenTests.push(test);
	            }
	          }

	          var _iterator = _createForOfIteratorHelper(hiddenTests),
	              _step;

	          try {
	            for (_iterator.s(); !(_step = _iterator.n()).done;) {
	              var hiddenTest = _step.value;
	              tests.removeChild(hiddenTest);
	            }
	          } catch (err) {
	            _iterator.e(err);
	          } finally {
	            _iterator.f();
	          }
	        } else {
	          while ((test = hiddenTests.pop()) != null) {
	            tests.appendChild(test);
	          }
	        }
	      }

	      window$1.history.replaceState(null, "", updatedUrl);
	    } else {
	      window$1.location = updatedUrl;
	    }
	  }

	  function setUrl(params) {
	    var key,
	        arrValue,
	        i,
	        querystring = "?",
	        location = window$1.location;
	    params = QUnit.extend(QUnit.extend({}, QUnit.urlParams), params);

	    for (key in params) {
	      // Skip inherited or undefined properties
	      if (hasOwn.call(params, key) && params[key] !== undefined) {
	        // Output a parameter for each value of this key
	        // (but usually just one)
	        arrValue = [].concat(params[key]);

	        for (i = 0; i < arrValue.length; i++) {
	          querystring += encodeURIComponent(key);

	          if (arrValue[i] !== true) {
	            querystring += "=" + encodeURIComponent(arrValue[i]);
	          }

	          querystring += "&";
	        }
	      }
	    }

	    return location.protocol + "//" + location.host + location.pathname + querystring.slice(0, -1);
	  }

	  function applyUrlParams() {
	    var i,
	        selectedModules = [],
	        modulesList = id("qunit-modulefilter-dropdown-list").getElementsByTagName("input"),
	        filter = id("qunit-filter-input").value;

	    for (i = 0; i < modulesList.length; i++) {
	      if (modulesList[i].checked) {
	        selectedModules.push(modulesList[i].value);
	      }
	    }

	    window$1.location = setUrl({
	      filter: filter === "" ? undefined : filter,
	      moduleId: selectedModules.length === 0 ? undefined : selectedModules,
	      // Remove module and testId filter
	      module: undefined,
	      testId: undefined
	    });
	  }

	  function toolbarUrlConfigContainer() {
	    var urlConfigContainer = document.createElement("span");
	    urlConfigContainer.innerHTML = getUrlConfigHtml();
	    addClass(urlConfigContainer, "qunit-url-config");
	    addEvents(urlConfigContainer.getElementsByTagName("input"), "change", toolbarChanged);
	    addEvents(urlConfigContainer.getElementsByTagName("select"), "change", toolbarChanged);
	    return urlConfigContainer;
	  }

	  function abortTestsButton() {
	    var button = document.createElement("button");
	    button.id = "qunit-abort-tests-button";
	    button.innerHTML = "Abort";
	    addEvent(button, "click", abortTests);
	    return button;
	  }

	  function toolbarLooseFilter() {
	    var filter = document.createElement("form"),
	        label = document.createElement("label"),
	        input = document.createElement("input"),
	        button = document.createElement("button");
	    addClass(filter, "qunit-filter");
	    label.innerHTML = "Filter: ";
	    input.type = "text";
	    input.value = config.filter || "";
	    input.name = "filter";
	    input.id = "qunit-filter-input";
	    button.innerHTML = "Go";
	    label.appendChild(input);
	    filter.appendChild(label);
	    filter.appendChild(document.createTextNode(" "));
	    filter.appendChild(button);
	    addEvent(filter, "submit", interceptNavigation);
	    return filter;
	  }

	  function moduleListHtml(modules) {
	    var i,
	        checked,
	        html = "";

	    for (i = 0; i < modules.length; i++) {
	      if (modules[i].name !== "") {
	        checked = config.moduleId.indexOf(modules[i].moduleId) > -1;
	        html += "<li><label class='clickable" + (checked ? " checked" : "") + "'><input type='checkbox' " + "value='" + modules[i].moduleId + "'" + (checked ? " checked='checked'" : "") + " />" + escapeText(modules[i].name) + "</label></li>";
	      }
	    }

	    return html;
	  }

	  function toolbarModuleFilter() {
	    var commit,
	        reset,
	        moduleFilter = document.createElement("form"),
	        label = document.createElement("label"),
	        moduleSearch = document.createElement("input"),
	        dropDown = document.createElement("div"),
	        actions = document.createElement("span"),
	        applyButton = document.createElement("button"),
	        resetButton = document.createElement("button"),
	        allModulesLabel = document.createElement("label"),
	        allCheckbox = document.createElement("input"),
	        dropDownList = document.createElement("ul"),
	        dirty = false;
	    moduleSearch.id = "qunit-modulefilter-search";
	    moduleSearch.autocomplete = "off";
	    addEvent(moduleSearch, "input", searchInput);
	    addEvent(moduleSearch, "input", searchFocus);
	    addEvent(moduleSearch, "focus", searchFocus);
	    addEvent(moduleSearch, "click", searchFocus);
	    config.modules.forEach(function (module) {
	      return module.namePrepared = fuzzysort.prepare(module.name);
	    });
	    label.id = "qunit-modulefilter-search-container";
	    label.innerHTML = "Module: ";
	    label.appendChild(moduleSearch);
	    applyButton.textContent = "Apply";
	    applyButton.style.display = "none";
	    resetButton.textContent = "Reset";
	    resetButton.type = "reset";
	    resetButton.style.display = "none";
	    allCheckbox.type = "checkbox";
	    allCheckbox.checked = config.moduleId.length === 0;
	    allModulesLabel.className = "clickable";

	    if (config.moduleId.length) {
	      allModulesLabel.className = "checked";
	    }

	    allModulesLabel.appendChild(allCheckbox);
	    allModulesLabel.appendChild(document.createTextNode("All modules"));
	    actions.id = "qunit-modulefilter-actions";
	    actions.appendChild(applyButton);
	    actions.appendChild(resetButton);
	    actions.appendChild(allModulesLabel);
	    commit = actions.firstChild;
	    reset = commit.nextSibling;
	    addEvent(commit, "click", applyUrlParams);
	    dropDownList.id = "qunit-modulefilter-dropdown-list";
	    dropDownList.innerHTML = moduleListHtml(config.modules);
	    dropDown.id = "qunit-modulefilter-dropdown";
	    dropDown.style.display = "none";
	    dropDown.appendChild(actions);
	    dropDown.appendChild(dropDownList);
	    addEvent(dropDown, "change", selectionChange);
	    selectionChange();
	    moduleFilter.id = "qunit-modulefilter";
	    moduleFilter.appendChild(label);
	    moduleFilter.appendChild(dropDown);
	    addEvent(moduleFilter, "submit", interceptNavigation);
	    addEvent(moduleFilter, "reset", function () {
	      // Let the reset happen, then update styles
	      window$1.setTimeout(selectionChange);
	    }); // Enables show/hide for the dropdown

	    function searchFocus() {
	      if (dropDown.style.display !== "none") {
	        return;
	      }

	      dropDown.style.display = "block";
	      addEvent(document, "click", hideHandler);
	      addEvent(document, "keydown", hideHandler); // Hide on Escape keydown or outside-container click

	      function hideHandler(e) {
	        var inContainer = moduleFilter.contains(e.target);

	        if (e.keyCode === 27 || !inContainer) {
	          if (e.keyCode === 27 && inContainer) {
	            moduleSearch.focus();
	          }

	          dropDown.style.display = "none";
	          removeEvent(document, "click", hideHandler);
	          removeEvent(document, "keydown", hideHandler);
	          moduleSearch.value = "";
	          searchInput();
	        }
	      }
	    }

	    function filterModules(searchText) {
	      if (searchText === "") {
	        return config.modules;
	      }

	      return fuzzysort.go(searchText, config.modules, {
	        key: "namePrepared",
	        threshold: -10000
	      }).map(function (module) {
	        return module.obj;
	      });
	    } // Processes module search box input


	    var searchInputTimeout;

	    function searchInput() {
	      window$1.clearTimeout(searchInputTimeout);
	      searchInputTimeout = window$1.setTimeout(function () {
	        var searchText = moduleSearch.value.toLowerCase(),
	            filteredModules = filterModules(searchText);
	        dropDownList.innerHTML = moduleListHtml(filteredModules);
	      }, 200);
	    } // Processes selection changes


	    function selectionChange(evt) {
	      var i,
	          item,
	          checkbox = evt && evt.target || allCheckbox,
	          modulesList = dropDownList.getElementsByTagName("input"),
	          selectedNames = [];
	      toggleClass(checkbox.parentNode, "checked", checkbox.checked);
	      dirty = false;

	      if (checkbox.checked && checkbox !== allCheckbox) {
	        allCheckbox.checked = false;
	        removeClass(allCheckbox.parentNode, "checked");
	      }

	      for (i = 0; i < modulesList.length; i++) {
	        item = modulesList[i];

	        if (!evt) {
	          toggleClass(item.parentNode, "checked", item.checked);
	        } else if (checkbox === allCheckbox && checkbox.checked) {
	          item.checked = false;
	          removeClass(item.parentNode, "checked");
	        }

	        dirty = dirty || item.checked !== item.defaultChecked;

	        if (item.checked) {
	          selectedNames.push(item.parentNode.textContent);
	        }
	      }

	      commit.style.display = reset.style.display = dirty ? "" : "none";
	      moduleSearch.placeholder = selectedNames.join(", ") || allCheckbox.parentNode.textContent;
	      moduleSearch.title = "Type to filter list. Current selection:\n" + (selectedNames.join("\n") || allCheckbox.parentNode.textContent);
	    }

	    return moduleFilter;
	  }

	  function toolbarFilters() {
	    var toolbarFilters = document.createElement("span");
	    toolbarFilters.id = "qunit-toolbar-filters";
	    toolbarFilters.appendChild(toolbarLooseFilter());
	    toolbarFilters.appendChild(toolbarModuleFilter());
	    return toolbarFilters;
	  }

	  function appendToolbar() {
	    var toolbar = id("qunit-testrunner-toolbar");

	    if (toolbar) {
	      toolbar.appendChild(toolbarUrlConfigContainer());
	      toolbar.appendChild(toolbarFilters());
	      toolbar.appendChild(document.createElement("div")).className = "clearfix";
	    }
	  }

	  function appendHeader() {
	    var header = id("qunit-header");

	    if (header) {
	      header.innerHTML = "<a href='" + escapeText(unfilteredUrl) + "'>" + header.innerHTML + "</a> ";
	    }
	  }

	  function appendBanner() {
	    var banner = id("qunit-banner");

	    if (banner) {
	      banner.className = "";
	    }
	  }

	  function appendTestResults() {
	    var tests = id("qunit-tests"),
	        result = id("qunit-testresult"),
	        controls;

	    if (result) {
	      result.parentNode.removeChild(result);
	    }

	    if (tests) {
	      tests.innerHTML = "";
	      result = document.createElement("p");
	      result.id = "qunit-testresult";
	      result.className = "result";
	      tests.parentNode.insertBefore(result, tests);
	      result.innerHTML = "<div id=\"qunit-testresult-display\">Running...<br />&#160;</div>" + "<div id=\"qunit-testresult-controls\"></div>" + "<div class=\"clearfix\"></div>";
	      controls = id("qunit-testresult-controls");
	    }

	    if (controls) {
	      controls.appendChild(abortTestsButton());
	    }
	  }

	  function appendFilteredTest() {
	    var testId = QUnit.config.testId;

	    if (!testId || testId.length <= 0) {
	      return "";
	    }

	    return "<div id='qunit-filteredTest'>Rerunning selected tests: " + escapeText(testId.join(", ")) + " <a id='qunit-clearFilter' href='" + escapeText(unfilteredUrl) + "'>Run all tests</a></div>";
	  }

	  function appendUserAgent() {
	    var userAgent = id("qunit-userAgent");

	    if (userAgent) {
	      userAgent.innerHTML = "";
	      userAgent.appendChild(document.createTextNode("QUnit " + QUnit.version + "; " + navigator.userAgent));
	    }
	  }

	  function appendInterface() {
	    var qunit = id("qunit"); // For compat with QUnit 1.2, and to support fully custom theme HTML,
	    // we will use any existing elements if no id="qunit" element exists.
	    //
	    // Note that we don't fail or fallback to creating it ourselves,
	    // because not having id="qunit" (and not having the below elements)
	    // simply means QUnit acts headless, allowing users to use their own
	    // reporters, or for a test runner to listen for events directly without
	    // having the HTML reporter actively render anything.

	    if (qunit) {
	      // Since QUnit 1.3, these are created automatically if the page
	      // contains id="qunit".
	      qunit.innerHTML = "<h1 id='qunit-header'>" + escapeText(document.title) + "</h1>" + "<h2 id='qunit-banner'></h2>" + "<div id='qunit-testrunner-toolbar'></div>" + appendFilteredTest() + "<h2 id='qunit-userAgent'></h2>" + "<ol id='qunit-tests'></ol>";
	    }

	    appendHeader();
	    appendBanner();
	    appendTestResults();
	    appendUserAgent();
	    appendToolbar();
	  }

	  function appendTest(name, testId, moduleName) {
	    var title,
	        rerunTrigger,
	        testBlock,
	        assertList,
	        tests = id("qunit-tests");

	    if (!tests) {
	      return;
	    }

	    title = document.createElement("strong");
	    title.innerHTML = getNameHtml(name, moduleName);
	    rerunTrigger = document.createElement("a");
	    rerunTrigger.innerHTML = "Rerun";
	    rerunTrigger.href = setUrl({
	      testId: testId
	    });
	    testBlock = document.createElement("li");
	    testBlock.appendChild(title);
	    testBlock.appendChild(rerunTrigger);
	    testBlock.id = "qunit-test-output-" + testId;
	    assertList = document.createElement("ol");
	    assertList.className = "qunit-assert-list";
	    testBlock.appendChild(assertList);
	    tests.appendChild(testBlock);
	  } // HTML Reporter initialization and load


	  QUnit.begin(function (details) {
	    var i, moduleObj; // Sort modules by name for the picker

	    for (i = 0; i < details.modules.length; i++) {
	      moduleObj = details.modules[i];

	      if (moduleObj.name) {
	        modulesList.push(moduleObj.name);
	      }
	    }

	    modulesList.sort(function (a, b) {
	      return a.localeCompare(b);
	    }); // Initialize QUnit elements

	    appendInterface();
	  });
	  QUnit.done(function (details) {
	    var banner = id("qunit-banner"),
	        tests = id("qunit-tests"),
	        abortButton = id("qunit-abort-tests-button"),
	        totalTests = stats.passedTests + stats.skippedTests + stats.todoTests + stats.failedTests,
	        html = [totalTests, " tests completed in ", details.runtime, " milliseconds, with ", stats.failedTests, " failed, ", stats.skippedTests, " skipped, and ", stats.todoTests, " todo.<br />", "<span class='passed'>", details.passed, "</span> assertions of <span class='total'>", details.total, "</span> passed, <span class='failed'>", details.failed, "</span> failed."].join(""),
	        test,
	        assertLi,
	        assertList; // Update remaining tests to aborted

	    if (abortButton && abortButton.disabled) {
	      html = "Tests aborted after " + details.runtime + " milliseconds.";

	      for (var i = 0; i < tests.children.length; i++) {
	        test = tests.children[i];

	        if (test.className === "" || test.className === "running") {
	          test.className = "aborted";
	          assertList = test.getElementsByTagName("ol")[0];
	          assertLi = document.createElement("li");
	          assertLi.className = "fail";
	          assertLi.innerHTML = "Test aborted.";
	          assertList.appendChild(assertLi);
	        }
	      }
	    }

	    if (banner && (!abortButton || abortButton.disabled === false)) {
	      banner.className = stats.failedTests ? "qunit-fail" : "qunit-pass";
	    }

	    if (abortButton) {
	      abortButton.parentNode.removeChild(abortButton);
	    }

	    if (tests) {
	      id("qunit-testresult-display").innerHTML = html;
	    }

	    if (config.altertitle && document.title) {
	      // Show ✖ for good, ✔ for bad suite result in title
	      // use escape sequences in case file gets loaded with non-utf-8
	      // charset
	      document.title = [stats.failedTests ? "\u2716" : "\u2714", document.title.replace(/^[\u2714\u2716] /i, "")].join(" ");
	    } // Scroll back to top to show results


	    if (config.scrolltop && window$1.scrollTo) {
	      window$1.scrollTo(0, 0);
	    }
	  });

	  function getNameHtml(name, module) {
	    var nameHtml = "";

	    if (module) {
	      nameHtml = "<span class='module-name'>" + escapeText(module) + "</span>: ";
	    }

	    nameHtml += "<span class='test-name'>" + escapeText(name) + "</span>";
	    return nameHtml;
	  }

	  function getProgressHtml(runtime, stats, total) {
	    var completed = stats.passedTests + stats.skippedTests + stats.todoTests + stats.failedTests;
	    return ["<br />", completed, " / ", total, " tests completed in ", runtime, " milliseconds, with ", stats.failedTests, " failed, ", stats.skippedTests, " skipped, and ", stats.todoTests, " todo."].join("");
	  }

	  QUnit.testStart(function (details) {
	    var running, bad;
	    appendTest(details.name, details.testId, details.module);
	    running = id("qunit-testresult-display");

	    if (running) {
	      addClass(running, "running");
	      bad = QUnit.config.reorder && details.previousFailure;
	      running.innerHTML = [bad ? "Rerunning previously failed test: <br />" : "Running: <br />", getNameHtml(details.name, details.module), getProgressHtml(now() - config.started, stats, Test.count)].join("");
	    }
	  });

	  function stripHtml(string) {
	    // Strip tags, html entity and whitespaces
	    return string.replace(/<\/?[^>]+(>|$)/g, "").replace(/&quot;/g, "").replace(/\s+/g, "");
	  }

	  QUnit.log(function (details) {
	    var assertList,
	        assertLi,
	        message,
	        expected,
	        actual,
	        diff,
	        showDiff = false,
	        testItem = id("qunit-test-output-" + details.testId);

	    if (!testItem) {
	      return;
	    }

	    message = escapeText(details.message) || (details.result ? "okay" : "failed");
	    message = "<span class='test-message'>" + message + "</span>";
	    message += "<span class='runtime'>@ " + details.runtime + " ms</span>"; // The pushFailure doesn't provide details.expected
	    // when it calls, it's implicit to also not show expected and diff stuff
	    // Also, we need to check details.expected existence, as it can exist and be undefined

	    if (!details.result && hasOwn.call(details, "expected")) {
	      if (details.negative) {
	        expected = "NOT " + QUnit.dump.parse(details.expected);
	      } else {
	        expected = QUnit.dump.parse(details.expected);
	      }

	      actual = QUnit.dump.parse(details.actual);
	      message += "<table><tr class='test-expected'><th>Expected: </th><td><pre>" + escapeText(expected) + "</pre></td></tr>";

	      if (actual !== expected) {
	        message += "<tr class='test-actual'><th>Result: </th><td><pre>" + escapeText(actual) + "</pre></td></tr>";

	        if (typeof details.actual === "number" && typeof details.expected === "number") {
	          if (!isNaN(details.actual) && !isNaN(details.expected)) {
	            showDiff = true;
	            diff = details.actual - details.expected;
	            diff = (diff > 0 ? "+" : "") + diff;
	          }
	        } else if (typeof details.actual !== "boolean" && typeof details.expected !== "boolean") {
	          diff = QUnit.diff(expected, actual); // don't show diff if there is zero overlap

	          showDiff = stripHtml(diff).length !== stripHtml(expected).length + stripHtml(actual).length;
	        }

	        if (showDiff) {
	          message += "<tr class='test-diff'><th>Diff: </th><td><pre>" + diff + "</pre></td></tr>";
	        }
	      } else if (expected.indexOf("[object Array]") !== -1 || expected.indexOf("[object Object]") !== -1) {
	        message += "<tr class='test-message'><th>Message: </th><td>" + "Diff suppressed as the depth of object is more than current max depth (" + QUnit.config.maxDepth + ").<p>Hint: Use <code>QUnit.dump.maxDepth</code> to " + " run with a higher max depth or <a href='" + escapeText(setUrl({
	          maxDepth: -1
	        })) + "'>" + "Rerun</a> without max depth.</p></td></tr>";
	      } else {
	        message += "<tr class='test-message'><th>Message: </th><td>" + "Diff suppressed as the expected and actual results have an equivalent" + " serialization</td></tr>";
	      }

	      if (details.source) {
	        message += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText(details.source) + "</pre></td></tr>";
	      }

	      message += "</table>"; // This occurs when pushFailure is set and we have an extracted stack trace
	    } else if (!details.result && details.source) {
	      message += "<table>" + "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText(details.source) + "</pre></td></tr>" + "</table>";
	    }

	    assertList = testItem.getElementsByTagName("ol")[0];
	    assertLi = document.createElement("li");
	    assertLi.className = details.result ? "pass" : "fail";
	    assertLi.innerHTML = message;
	    assertList.appendChild(assertLi);
	  });
	  QUnit.testDone(function (details) {
	    var testTitle,
	        time,
	        testItem,
	        assertList,
	        status,
	        good,
	        bad,
	        testCounts,
	        skipped,
	        sourceName,
	        tests = id("qunit-tests");

	    if (!tests) {
	      return;
	    }

	    testItem = id("qunit-test-output-" + details.testId);
	    removeClass(testItem, "running");

	    if (details.failed > 0) {
	      status = "failed";
	    } else if (details.todo) {
	      status = "todo";
	    } else {
	      status = details.skipped ? "skipped" : "passed";
	    }

	    assertList = testItem.getElementsByTagName("ol")[0];
	    good = details.passed;
	    bad = details.failed; // This test passed if it has no unexpected failed assertions

	    var testPassed = details.failed > 0 ? details.todo : !details.todo;

	    if (testPassed) {
	      // Collapse the passing tests
	      addClass(assertList, "qunit-collapsed");
	    } else if (config.collapse) {
	      if (!collapseNext) {
	        // Skip collapsing the first failing test
	        collapseNext = true;
	      } else {
	        // Collapse remaining tests
	        addClass(assertList, "qunit-collapsed");
	      }
	    } // The testItem.firstChild is the test name


	    testTitle = testItem.firstChild;
	    testCounts = bad ? "<b class='failed'>" + bad + "</b>, " + "<b class='passed'>" + good + "</b>, " : "";
	    testTitle.innerHTML += " <b class='counts'>(" + testCounts + details.assertions.length + ")</b>";

	    if (details.skipped) {
	      stats.skippedTests++;
	      testItem.className = "skipped";
	      skipped = document.createElement("em");
	      skipped.className = "qunit-skipped-label";
	      skipped.innerHTML = "skipped";
	      testItem.insertBefore(skipped, testTitle);
	    } else {
	      addEvent(testTitle, "click", function () {
	        toggleClass(assertList, "qunit-collapsed");
	      });
	      testItem.className = testPassed ? "pass" : "fail";

	      if (details.todo) {
	        var todoLabel = document.createElement("em");
	        todoLabel.className = "qunit-todo-label";
	        todoLabel.innerHTML = "todo";
	        testItem.className += " todo";
	        testItem.insertBefore(todoLabel, testTitle);
	      }

	      time = document.createElement("span");
	      time.className = "runtime";
	      time.innerHTML = details.runtime + " ms";
	      testItem.insertBefore(time, assertList);

	      if (!testPassed) {
	        stats.failedTests++;
	      } else if (details.todo) {
	        stats.todoTests++;
	      } else {
	        stats.passedTests++;
	      }
	    } // Show the source of the test when showing assertions


	    if (details.source) {
	      sourceName = document.createElement("p");
	      sourceName.innerHTML = "<strong>Source: </strong>" + escapeText(details.source);
	      addClass(sourceName, "qunit-source");

	      if (testPassed) {
	        addClass(sourceName, "qunit-collapsed");
	      }

	      addEvent(testTitle, "click", function () {
	        toggleClass(sourceName, "qunit-collapsed");
	      });
	      testItem.appendChild(sourceName);
	    }

	    if (config.hidepassed && (status === "passed" || details.skipped)) {
	      // use removeChild instead of remove because of support
	      hiddenTests.push(testItem);
	      tests.removeChild(testItem);
	    }
	  }); // Avoid readyState issue with phantomjs
	  // Ref: #818

	  var notPhantom = function (p) {
	    return !(p && p.version && p.version.major > 0);
	  }(window$1.phantom);

	  if (notPhantom && document.readyState === "complete") {
	    QUnit.load();
	  } else {
	    addEvent(window$1, "load", QUnit.load);
	  } // Wrap window.onerror. We will call the original window.onerror to see if
	  // the existing handler fully handles the error; if not, we will call the
	  // QUnit.onError function.


	  var originalWindowOnError = window$1.onerror; // Cover uncaught exceptions
	  // Returning true will suppress the default browser handler,
	  // returning false will let it run.

	  window$1.onerror = function (message, fileName, lineNumber, columnNumber, errorObj) {
	    var ret = false;

	    if (originalWindowOnError) {
	      for (var _len = arguments.length, args = new Array(_len > 5 ? _len - 5 : 0), _key = 5; _key < _len; _key++) {
	        args[_key - 5] = arguments[_key];
	      }

	      ret = originalWindowOnError.call.apply(originalWindowOnError, [this, message, fileName, lineNumber, columnNumber, errorObj].concat(args));
	    } // Treat return value as window.onerror itself does,
	    // Only do our handling if not suppressed.


	    if (ret !== true) {
	      var error = {
	        message: message,
	        fileName: fileName,
	        lineNumber: lineNumber
	      }; // According to
	      // https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror,
	      // most modern browsers support an errorObj argument; use that to
	      // get a full stack trace if it's available.

	      if (errorObj && errorObj.stack) {
	        error.stacktrace = extractStacktrace(errorObj, 0);
	      }

	      ret = QUnit.onError(error);
	    }

	    return ret;
	  }; // Listen for unhandled rejections, and call QUnit.onUnhandledRejection


	  window$1.addEventListener("unhandledrejection", function (event) {
	    QUnit.onUnhandledRejection(event.reason);
	  });
	})();

	/*
	 * This file is a modified version of google-diff-match-patch's JavaScript implementation
	 * (https://code.google.com/p/google-diff-match-patch/source/browse/trunk/javascript/diff_match_patch_uncompressed.js),
	 * modifications are licensed as more fully set forth in LICENSE.txt.
	 *
	 * The original source of google-diff-match-patch is attributable and licensed as follows:
	 *
	 * Copyright 2006 Google Inc.
	 * https://code.google.com/p/google-diff-match-patch/
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * https://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 *
	 * More Info:
	 *  https://code.google.com/p/google-diff-match-patch/
	 *
	 * Usage: QUnit.diff(expected, actual)
	 *
	 */

	QUnit.diff = function () {
	  function DiffMatchPatch() {} //  DIFF FUNCTIONS

	  /**
	   * The data structure representing a diff is an array of tuples:
	   * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]
	   * which means: delete 'Hello', add 'Goodbye' and keep ' world.'
	   */


	  var DIFF_DELETE = -1,
	      DIFF_INSERT = 1,
	      DIFF_EQUAL = 0,
	      hasOwn = Object.prototype.hasOwnProperty;
	  /**
	   * Find the differences between two texts.  Simplifies the problem by stripping
	   * any common prefix or suffix off the texts before diffing.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {boolean=} optChecklines Optional speedup flag. If present and false,
	   *     then don't run a line-level diff first to identify the changed areas.
	   *     Defaults to true, which does a faster, slightly less optimal diff.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   */

	  DiffMatchPatch.prototype.DiffMain = function (text1, text2, optChecklines) {
	    var deadline, checklines, commonlength, commonprefix, commonsuffix, diffs; // The diff must be complete in up to 1 second.

	    deadline = new Date().getTime() + 1000; // Check for null inputs.

	    if (text1 === null || text2 === null) {
	      throw new Error("Null input. (DiffMain)");
	    } // Check for equality (speedup).


	    if (text1 === text2) {
	      if (text1) {
	        return [[DIFF_EQUAL, text1]];
	      }

	      return [];
	    }

	    if (typeof optChecklines === "undefined") {
	      optChecklines = true;
	    }

	    checklines = optChecklines; // Trim off common prefix (speedup).

	    commonlength = this.diffCommonPrefix(text1, text2);
	    commonprefix = text1.substring(0, commonlength);
	    text1 = text1.substring(commonlength);
	    text2 = text2.substring(commonlength); // Trim off common suffix (speedup).

	    commonlength = this.diffCommonSuffix(text1, text2);
	    commonsuffix = text1.substring(text1.length - commonlength);
	    text1 = text1.substring(0, text1.length - commonlength);
	    text2 = text2.substring(0, text2.length - commonlength); // Compute the diff on the middle block.

	    diffs = this.diffCompute(text1, text2, checklines, deadline); // Restore the prefix and suffix.

	    if (commonprefix) {
	      diffs.unshift([DIFF_EQUAL, commonprefix]);
	    }

	    if (commonsuffix) {
	      diffs.push([DIFF_EQUAL, commonsuffix]);
	    }

	    this.diffCleanupMerge(diffs);
	    return diffs;
	  };
	  /**
	   * Reduce the number of edits by eliminating operationally trivial equalities.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupEfficiency = function (diffs) {
	    var changes, equalities, equalitiesLength, lastequality, pointer, preIns, preDel, postIns, postDel;
	    changes = false;
	    equalities = []; // Stack of indices where equalities are found.

	    equalitiesLength = 0; // Keeping our own length var is faster in JS.

	    /** @type {?string} */

	    lastequality = null; // Always equal to diffs[equalities[equalitiesLength - 1]][1]

	    pointer = 0; // Index of current position.
	    // Is there an insertion operation before the last equality.

	    preIns = false; // Is there a deletion operation before the last equality.

	    preDel = false; // Is there an insertion operation after the last equality.

	    postIns = false; // Is there a deletion operation after the last equality.

	    postDel = false;

	    while (pointer < diffs.length) {
	      // Equality found.
	      if (diffs[pointer][0] === DIFF_EQUAL) {
	        if (diffs[pointer][1].length < 4 && (postIns || postDel)) {
	          // Candidate found.
	          equalities[equalitiesLength++] = pointer;
	          preIns = postIns;
	          preDel = postDel;
	          lastequality = diffs[pointer][1];
	        } else {
	          // Not a candidate, and can never become one.
	          equalitiesLength = 0;
	          lastequality = null;
	        }

	        postIns = postDel = false; // An insertion or deletion.
	      } else {
	        if (diffs[pointer][0] === DIFF_DELETE) {
	          postDel = true;
	        } else {
	          postIns = true;
	        }
	        /*
	         * Five types to be split:
	         * <ins>A</ins><del>B</del>XY<ins>C</ins><del>D</del>
	         * <ins>A</ins>X<ins>C</ins><del>D</del>
	         * <ins>A</ins><del>B</del>X<ins>C</ins>
	         * <ins>A</del>X<ins>C</ins><del>D</del>
	         * <ins>A</ins><del>B</del>X<del>C</del>
	         */


	        if (lastequality && (preIns && preDel && postIns && postDel || lastequality.length < 2 && preIns + preDel + postIns + postDel === 3)) {
	          // Duplicate record.
	          diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastequality]); // Change second copy to insert.

	          diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;
	          equalitiesLength--; // Throw away the equality we just deleted;

	          lastequality = null;

	          if (preIns && preDel) {
	            // No changes made which could affect previous entry, keep going.
	            postIns = postDel = true;
	            equalitiesLength = 0;
	          } else {
	            equalitiesLength--; // Throw away the previous equality.

	            pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1;
	            postIns = postDel = false;
	          }

	          changes = true;
	        }
	      }

	      pointer++;
	    }

	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    }
	  };
	  /**
	   * Convert a diff array into a pretty HTML report.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   * @param {integer} string to be beautified.
	   * @return {string} HTML representation.
	   */


	  DiffMatchPatch.prototype.diffPrettyHtml = function (diffs) {
	    var op,
	        data,
	        x,
	        html = [];

	    for (x = 0; x < diffs.length; x++) {
	      op = diffs[x][0]; // Operation (insert, delete, equal)

	      data = diffs[x][1]; // Text of change.

	      switch (op) {
	        case DIFF_INSERT:
	          html[x] = "<ins>" + escapeText(data) + "</ins>";
	          break;

	        case DIFF_DELETE:
	          html[x] = "<del>" + escapeText(data) + "</del>";
	          break;

	        case DIFF_EQUAL:
	          html[x] = "<span>" + escapeText(data) + "</span>";
	          break;
	      }
	    }

	    return html.join("");
	  };
	  /**
	   * Determine the common prefix of two strings.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the start of each
	   *     string.
	   */


	  DiffMatchPatch.prototype.diffCommonPrefix = function (text1, text2) {
	    var pointermid, pointermax, pointermin, pointerstart; // Quick check for common null cases.

	    if (!text1 || !text2 || text1.charAt(0) !== text2.charAt(0)) {
	      return 0;
	    } // Binary search.
	    // Performance analysis: https://neil.fraser.name/news/2007/10/09/


	    pointermin = 0;
	    pointermax = Math.min(text1.length, text2.length);
	    pointermid = pointermax;
	    pointerstart = 0;

	    while (pointermin < pointermid) {
	      if (text1.substring(pointerstart, pointermid) === text2.substring(pointerstart, pointermid)) {
	        pointermin = pointermid;
	        pointerstart = pointermin;
	      } else {
	        pointermax = pointermid;
	      }

	      pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
	    }

	    return pointermid;
	  };
	  /**
	   * Determine the common suffix of two strings.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the end of each string.
	   */


	  DiffMatchPatch.prototype.diffCommonSuffix = function (text1, text2) {
	    var pointermid, pointermax, pointermin, pointerend; // Quick check for common null cases.

	    if (!text1 || !text2 || text1.charAt(text1.length - 1) !== text2.charAt(text2.length - 1)) {
	      return 0;
	    } // Binary search.
	    // Performance analysis: https://neil.fraser.name/news/2007/10/09/


	    pointermin = 0;
	    pointermax = Math.min(text1.length, text2.length);
	    pointermid = pointermax;
	    pointerend = 0;

	    while (pointermin < pointermid) {
	      if (text1.substring(text1.length - pointermid, text1.length - pointerend) === text2.substring(text2.length - pointermid, text2.length - pointerend)) {
	        pointermin = pointermid;
	        pointerend = pointermin;
	      } else {
	        pointermax = pointermid;
	      }

	      pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
	    }

	    return pointermid;
	  };
	  /**
	   * Find the differences between two texts.  Assumes that the texts do not
	   * have any common prefix or suffix.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {boolean} checklines Speedup flag.  If false, then don't run a
	   *     line-level diff first to identify the changed areas.
	   *     If true, then run a faster, slightly less optimal diff.
	   * @param {number} deadline Time when the diff should be complete by.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCompute = function (text1, text2, checklines, deadline) {
	    var diffs, longtext, shorttext, i, hm, text1A, text2A, text1B, text2B, midCommon, diffsA, diffsB;

	    if (!text1) {
	      // Just add some text (speedup).
	      return [[DIFF_INSERT, text2]];
	    }

	    if (!text2) {
	      // Just delete some text (speedup).
	      return [[DIFF_DELETE, text1]];
	    }

	    longtext = text1.length > text2.length ? text1 : text2;
	    shorttext = text1.length > text2.length ? text2 : text1;
	    i = longtext.indexOf(shorttext);

	    if (i !== -1) {
	      // Shorter text is inside the longer text (speedup).
	      diffs = [[DIFF_INSERT, longtext.substring(0, i)], [DIFF_EQUAL, shorttext], [DIFF_INSERT, longtext.substring(i + shorttext.length)]]; // Swap insertions for deletions if diff is reversed.

	      if (text1.length > text2.length) {
	        diffs[0][0] = diffs[2][0] = DIFF_DELETE;
	      }

	      return diffs;
	    }

	    if (shorttext.length === 1) {
	      // Single character string.
	      // After the previous speedup, the character can't be an equality.
	      return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];
	    } // Check to see if the problem can be split in two.


	    hm = this.diffHalfMatch(text1, text2);

	    if (hm) {
	      // A half-match was found, sort out the return data.
	      text1A = hm[0];
	      text1B = hm[1];
	      text2A = hm[2];
	      text2B = hm[3];
	      midCommon = hm[4]; // Send both pairs off for separate processing.

	      diffsA = this.DiffMain(text1A, text2A, checklines, deadline);
	      diffsB = this.DiffMain(text1B, text2B, checklines, deadline); // Merge the results.

	      return diffsA.concat([[DIFF_EQUAL, midCommon]], diffsB);
	    }

	    if (checklines && text1.length > 100 && text2.length > 100) {
	      return this.diffLineMode(text1, text2, deadline);
	    }

	    return this.diffBisect(text1, text2, deadline);
	  };
	  /**
	   * Do the two texts share a substring which is at least half the length of the
	   * longer text?
	   * This speedup can produce non-minimal diffs.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {Array.<string>} Five element Array, containing the prefix of
	   *     text1, the suffix of text1, the prefix of text2, the suffix of
	   *     text2 and the common middle.  Or null if there was no match.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffHalfMatch = function (text1, text2) {
	    var longtext, shorttext, dmp, text1A, text2B, text2A, text1B, midCommon, hm1, hm2, hm;
	    longtext = text1.length > text2.length ? text1 : text2;
	    shorttext = text1.length > text2.length ? text2 : text1;

	    if (longtext.length < 4 || shorttext.length * 2 < longtext.length) {
	      return null; // Pointless.
	    }

	    dmp = this; // 'this' becomes 'window' in a closure.

	    /**
	     * Does a substring of shorttext exist within longtext such that the substring
	     * is at least half the length of longtext?
	     * Closure, but does not reference any external variables.
	     * @param {string} longtext Longer string.
	     * @param {string} shorttext Shorter string.
	     * @param {number} i Start index of quarter length substring within longtext.
	     * @return {Array.<string>} Five element Array, containing the prefix of
	     *     longtext, the suffix of longtext, the prefix of shorttext, the suffix
	     *     of shorttext and the common middle.  Or null if there was no match.
	     * @private
	     */

	    function diffHalfMatchI(longtext, shorttext, i) {
	      var seed, j, bestCommon, prefixLength, suffixLength, bestLongtextA, bestLongtextB, bestShorttextA, bestShorttextB; // Start with a 1/4 length substring at position i as a seed.

	      seed = longtext.substring(i, i + Math.floor(longtext.length / 4));
	      j = -1;
	      bestCommon = "";

	      while ((j = shorttext.indexOf(seed, j + 1)) !== -1) {
	        prefixLength = dmp.diffCommonPrefix(longtext.substring(i), shorttext.substring(j));
	        suffixLength = dmp.diffCommonSuffix(longtext.substring(0, i), shorttext.substring(0, j));

	        if (bestCommon.length < suffixLength + prefixLength) {
	          bestCommon = shorttext.substring(j - suffixLength, j) + shorttext.substring(j, j + prefixLength);
	          bestLongtextA = longtext.substring(0, i - suffixLength);
	          bestLongtextB = longtext.substring(i + prefixLength);
	          bestShorttextA = shorttext.substring(0, j - suffixLength);
	          bestShorttextB = shorttext.substring(j + prefixLength);
	        }
	      }

	      if (bestCommon.length * 2 >= longtext.length) {
	        return [bestLongtextA, bestLongtextB, bestShorttextA, bestShorttextB, bestCommon];
	      } else {
	        return null;
	      }
	    } // First check if the second quarter is the seed for a half-match.


	    hm1 = diffHalfMatchI(longtext, shorttext, Math.ceil(longtext.length / 4)); // Check again based on the third quarter.

	    hm2 = diffHalfMatchI(longtext, shorttext, Math.ceil(longtext.length / 2));

	    if (!hm1 && !hm2) {
	      return null;
	    } else if (!hm2) {
	      hm = hm1;
	    } else if (!hm1) {
	      hm = hm2;
	    } else {
	      // Both matched.  Select the longest.
	      hm = hm1[4].length > hm2[4].length ? hm1 : hm2;
	    } // A half-match was found, sort out the return data.


	    if (text1.length > text2.length) {
	      text1A = hm[0];
	      text1B = hm[1];
	      text2A = hm[2];
	      text2B = hm[3];
	    } else {
	      text2A = hm[0];
	      text2B = hm[1];
	      text1A = hm[2];
	      text1B = hm[3];
	    }

	    midCommon = hm[4];
	    return [text1A, text1B, text2A, text2B, midCommon];
	  };
	  /**
	   * Do a quick line-level diff on both strings, then rediff the parts for
	   * greater accuracy.
	   * This speedup can produce non-minimal diffs.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} deadline Time when the diff should be complete by.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffLineMode = function (text1, text2, deadline) {
	    var a, diffs, linearray, pointer, countInsert, countDelete, textInsert, textDelete, j; // Scan the text on a line-by-line basis first.

	    a = this.diffLinesToChars(text1, text2);
	    text1 = a.chars1;
	    text2 = a.chars2;
	    linearray = a.lineArray;
	    diffs = this.DiffMain(text1, text2, false, deadline); // Convert the diff back to original text.

	    this.diffCharsToLines(diffs, linearray); // Eliminate freak matches (e.g. blank lines)

	    this.diffCleanupSemantic(diffs); // Rediff any replacement blocks, this time character-by-character.
	    // Add a dummy entry at the end.

	    diffs.push([DIFF_EQUAL, ""]);
	    pointer = 0;
	    countDelete = 0;
	    countInsert = 0;
	    textDelete = "";
	    textInsert = "";

	    while (pointer < diffs.length) {
	      switch (diffs[pointer][0]) {
	        case DIFF_INSERT:
	          countInsert++;
	          textInsert += diffs[pointer][1];
	          break;

	        case DIFF_DELETE:
	          countDelete++;
	          textDelete += diffs[pointer][1];
	          break;

	        case DIFF_EQUAL:
	          // Upon reaching an equality, check for prior redundancies.
	          if (countDelete >= 1 && countInsert >= 1) {
	            // Delete the offending records and add the merged ones.
	            diffs.splice(pointer - countDelete - countInsert, countDelete + countInsert);
	            pointer = pointer - countDelete - countInsert;
	            a = this.DiffMain(textDelete, textInsert, false, deadline);

	            for (j = a.length - 1; j >= 0; j--) {
	              diffs.splice(pointer, 0, a[j]);
	            }

	            pointer = pointer + a.length;
	          }

	          countInsert = 0;
	          countDelete = 0;
	          textDelete = "";
	          textInsert = "";
	          break;
	      }

	      pointer++;
	    }

	    diffs.pop(); // Remove the dummy entry at the end.

	    return diffs;
	  };
	  /**
	   * Find the 'middle snake' of a diff, split the problem in two
	   * and return the recursively constructed diff.
	   * See Myers 1986 paper: An O(ND) Difference Algorithm and Its Variations.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} deadline Time at which to bail if not yet complete.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffBisect = function (text1, text2, deadline) {
	    var text1Length, text2Length, maxD, vOffset, vLength, v1, v2, x, delta, front, k1start, k1end, k2start, k2end, k2Offset, k1Offset, x1, x2, y1, y2, d, k1, k2; // Cache the text lengths to prevent multiple calls.

	    text1Length = text1.length;
	    text2Length = text2.length;
	    maxD = Math.ceil((text1Length + text2Length) / 2);
	    vOffset = maxD;
	    vLength = 2 * maxD;
	    v1 = new Array(vLength);
	    v2 = new Array(vLength); // Setting all elements to -1 is faster in Chrome & Firefox than mixing
	    // integers and undefined.

	    for (x = 0; x < vLength; x++) {
	      v1[x] = -1;
	      v2[x] = -1;
	    }

	    v1[vOffset + 1] = 0;
	    v2[vOffset + 1] = 0;
	    delta = text1Length - text2Length; // If the total number of characters is odd, then the front path will collide
	    // with the reverse path.

	    front = delta % 2 !== 0; // Offsets for start and end of k loop.
	    // Prevents mapping of space beyond the grid.

	    k1start = 0;
	    k1end = 0;
	    k2start = 0;
	    k2end = 0;

	    for (d = 0; d < maxD; d++) {
	      // Bail out if deadline is reached.
	      if (new Date().getTime() > deadline) {
	        break;
	      } // Walk the front path one step.


	      for (k1 = -d + k1start; k1 <= d - k1end; k1 += 2) {
	        k1Offset = vOffset + k1;

	        if (k1 === -d || k1 !== d && v1[k1Offset - 1] < v1[k1Offset + 1]) {
	          x1 = v1[k1Offset + 1];
	        } else {
	          x1 = v1[k1Offset - 1] + 1;
	        }

	        y1 = x1 - k1;

	        while (x1 < text1Length && y1 < text2Length && text1.charAt(x1) === text2.charAt(y1)) {
	          x1++;
	          y1++;
	        }

	        v1[k1Offset] = x1;

	        if (x1 > text1Length) {
	          // Ran off the right of the graph.
	          k1end += 2;
	        } else if (y1 > text2Length) {
	          // Ran off the bottom of the graph.
	          k1start += 2;
	        } else if (front) {
	          k2Offset = vOffset + delta - k1;

	          if (k2Offset >= 0 && k2Offset < vLength && v2[k2Offset] !== -1) {
	            // Mirror x2 onto top-left coordinate system.
	            x2 = text1Length - v2[k2Offset];

	            if (x1 >= x2) {
	              // Overlap detected.
	              return this.diffBisectSplit(text1, text2, x1, y1, deadline);
	            }
	          }
	        }
	      } // Walk the reverse path one step.


	      for (k2 = -d + k2start; k2 <= d - k2end; k2 += 2) {
	        k2Offset = vOffset + k2;

	        if (k2 === -d || k2 !== d && v2[k2Offset - 1] < v2[k2Offset + 1]) {
	          x2 = v2[k2Offset + 1];
	        } else {
	          x2 = v2[k2Offset - 1] + 1;
	        }

	        y2 = x2 - k2;

	        while (x2 < text1Length && y2 < text2Length && text1.charAt(text1Length - x2 - 1) === text2.charAt(text2Length - y2 - 1)) {
	          x2++;
	          y2++;
	        }

	        v2[k2Offset] = x2;

	        if (x2 > text1Length) {
	          // Ran off the left of the graph.
	          k2end += 2;
	        } else if (y2 > text2Length) {
	          // Ran off the top of the graph.
	          k2start += 2;
	        } else if (!front) {
	          k1Offset = vOffset + delta - k2;

	          if (k1Offset >= 0 && k1Offset < vLength && v1[k1Offset] !== -1) {
	            x1 = v1[k1Offset];
	            y1 = vOffset + x1 - k1Offset; // Mirror x2 onto top-left coordinate system.

	            x2 = text1Length - x2;

	            if (x1 >= x2) {
	              // Overlap detected.
	              return this.diffBisectSplit(text1, text2, x1, y1, deadline);
	            }
	          }
	        }
	      }
	    } // Diff took too long and hit the deadline or
	    // number of diffs equals number of characters, no commonality at all.


	    return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];
	  };
	  /**
	   * Given the location of the 'middle snake', split the diff in two parts
	   * and recurse.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} x Index of split point in text1.
	   * @param {number} y Index of split point in text2.
	   * @param {number} deadline Time at which to bail if not yet complete.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffBisectSplit = function (text1, text2, x, y, deadline) {
	    var text1a, text1b, text2a, text2b, diffs, diffsb;
	    text1a = text1.substring(0, x);
	    text2a = text2.substring(0, y);
	    text1b = text1.substring(x);
	    text2b = text2.substring(y); // Compute both diffs serially.

	    diffs = this.DiffMain(text1a, text2a, false, deadline);
	    diffsb = this.DiffMain(text1b, text2b, false, deadline);
	    return diffs.concat(diffsb);
	  };
	  /**
	   * Reduce the number of edits by eliminating semantically trivial equalities.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupSemantic = function (diffs) {
	    var changes, equalities, equalitiesLength, lastequality, pointer, lengthInsertions2, lengthDeletions2, lengthInsertions1, lengthDeletions1, deletion, insertion, overlapLength1, overlapLength2;
	    changes = false;
	    equalities = []; // Stack of indices where equalities are found.

	    equalitiesLength = 0; // Keeping our own length var is faster in JS.

	    /** @type {?string} */

	    lastequality = null; // Always equal to diffs[equalities[equalitiesLength - 1]][1]

	    pointer = 0; // Index of current position.
	    // Number of characters that changed prior to the equality.

	    lengthInsertions1 = 0;
	    lengthDeletions1 = 0; // Number of characters that changed after the equality.

	    lengthInsertions2 = 0;
	    lengthDeletions2 = 0;

	    while (pointer < diffs.length) {
	      if (diffs[pointer][0] === DIFF_EQUAL) {
	        // Equality found.
	        equalities[equalitiesLength++] = pointer;
	        lengthInsertions1 = lengthInsertions2;
	        lengthDeletions1 = lengthDeletions2;
	        lengthInsertions2 = 0;
	        lengthDeletions2 = 0;
	        lastequality = diffs[pointer][1];
	      } else {
	        // An insertion or deletion.
	        if (diffs[pointer][0] === DIFF_INSERT) {
	          lengthInsertions2 += diffs[pointer][1].length;
	        } else {
	          lengthDeletions2 += diffs[pointer][1].length;
	        } // Eliminate an equality that is smaller or equal to the edits on both
	        // sides of it.


	        if (lastequality && lastequality.length <= Math.max(lengthInsertions1, lengthDeletions1) && lastequality.length <= Math.max(lengthInsertions2, lengthDeletions2)) {
	          // Duplicate record.
	          diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastequality]); // Change second copy to insert.

	          diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT; // Throw away the equality we just deleted.

	          equalitiesLength--; // Throw away the previous equality (it needs to be reevaluated).

	          equalitiesLength--;
	          pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1; // Reset the counters.

	          lengthInsertions1 = 0;
	          lengthDeletions1 = 0;
	          lengthInsertions2 = 0;
	          lengthDeletions2 = 0;
	          lastequality = null;
	          changes = true;
	        }
	      }

	      pointer++;
	    } // Normalize the diff.


	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    } // Find any overlaps between deletions and insertions.
	    // e.g: <del>abcxxx</del><ins>xxxdef</ins>
	    //   -> <del>abc</del>xxx<ins>def</ins>
	    // e.g: <del>xxxabc</del><ins>defxxx</ins>
	    //   -> <ins>def</ins>xxx<del>abc</del>
	    // Only extract an overlap if it is as big as the edit ahead or behind it.


	    pointer = 1;

	    while (pointer < diffs.length) {
	      if (diffs[pointer - 1][0] === DIFF_DELETE && diffs[pointer][0] === DIFF_INSERT) {
	        deletion = diffs[pointer - 1][1];
	        insertion = diffs[pointer][1];
	        overlapLength1 = this.diffCommonOverlap(deletion, insertion);
	        overlapLength2 = this.diffCommonOverlap(insertion, deletion);

	        if (overlapLength1 >= overlapLength2) {
	          if (overlapLength1 >= deletion.length / 2 || overlapLength1 >= insertion.length / 2) {
	            // Overlap found.  Insert an equality and trim the surrounding edits.
	            diffs.splice(pointer, 0, [DIFF_EQUAL, insertion.substring(0, overlapLength1)]);
	            diffs[pointer - 1][1] = deletion.substring(0, deletion.length - overlapLength1);
	            diffs[pointer + 1][1] = insertion.substring(overlapLength1);
	            pointer++;
	          }
	        } else {
	          if (overlapLength2 >= deletion.length / 2 || overlapLength2 >= insertion.length / 2) {
	            // Reverse overlap found.
	            // Insert an equality and swap and trim the surrounding edits.
	            diffs.splice(pointer, 0, [DIFF_EQUAL, deletion.substring(0, overlapLength2)]);
	            diffs[pointer - 1][0] = DIFF_INSERT;
	            diffs[pointer - 1][1] = insertion.substring(0, insertion.length - overlapLength2);
	            diffs[pointer + 1][0] = DIFF_DELETE;
	            diffs[pointer + 1][1] = deletion.substring(overlapLength2);
	            pointer++;
	          }
	        }

	        pointer++;
	      }

	      pointer++;
	    }
	  };
	  /**
	   * Determine if the suffix of one string is the prefix of another.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the end of the first
	   *     string and the start of the second string.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCommonOverlap = function (text1, text2) {
	    var text1Length, text2Length, textLength, best, length, pattern, found; // Cache the text lengths to prevent multiple calls.

	    text1Length = text1.length;
	    text2Length = text2.length; // Eliminate the null case.

	    if (text1Length === 0 || text2Length === 0) {
	      return 0;
	    } // Truncate the longer string.


	    if (text1Length > text2Length) {
	      text1 = text1.substring(text1Length - text2Length);
	    } else if (text1Length < text2Length) {
	      text2 = text2.substring(0, text1Length);
	    }

	    textLength = Math.min(text1Length, text2Length); // Quick check for the worst case.

	    if (text1 === text2) {
	      return textLength;
	    } // Start by looking for a single character match
	    // and increase length until no match is found.
	    // Performance analysis: https://neil.fraser.name/news/2010/11/04/


	    best = 0;
	    length = 1;

	    while (true) {
	      pattern = text1.substring(textLength - length);
	      found = text2.indexOf(pattern);

	      if (found === -1) {
	        return best;
	      }

	      length += found;

	      if (found === 0 || text1.substring(textLength - length) === text2.substring(0, length)) {
	        best = length;
	        length++;
	      }
	    }
	  };
	  /**
	   * Split two texts into an array of strings.  Reduce the texts to a string of
	   * hashes where each Unicode character represents one line.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {{chars1: string, chars2: string, lineArray: !Array.<string>}}
	   *     An object containing the encoded text1, the encoded text2 and
	   *     the array of unique strings.
	   *     The zeroth element of the array of unique strings is intentionally blank.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffLinesToChars = function (text1, text2) {
	    var lineArray, lineHash, chars1, chars2;
	    lineArray = []; // E.g. lineArray[4] === 'Hello\n'

	    lineHash = {}; // E.g. lineHash['Hello\n'] === 4
	    // '\x00' is a valid character, but various debuggers don't like it.
	    // So we'll insert a junk entry to avoid generating a null character.

	    lineArray[0] = "";
	    /**
	     * Split a text into an array of strings.  Reduce the texts to a string of
	     * hashes where each Unicode character represents one line.
	     * Modifies linearray and linehash through being a closure.
	     * @param {string} text String to encode.
	     * @return {string} Encoded string.
	     * @private
	     */

	    function diffLinesToCharsMunge(text) {
	      var chars, lineStart, lineEnd, lineArrayLength, line;
	      chars = ""; // Walk the text, pulling out a substring for each line.
	      // text.split('\n') would would temporarily double our memory footprint.
	      // Modifying text would create many large strings to garbage collect.

	      lineStart = 0;
	      lineEnd = -1; // Keeping our own length variable is faster than looking it up.

	      lineArrayLength = lineArray.length;

	      while (lineEnd < text.length - 1) {
	        lineEnd = text.indexOf("\n", lineStart);

	        if (lineEnd === -1) {
	          lineEnd = text.length - 1;
	        }

	        line = text.substring(lineStart, lineEnd + 1);
	        lineStart = lineEnd + 1;

	        if (hasOwn.call(lineHash, line)) {
	          chars += String.fromCharCode(lineHash[line]);
	        } else {
	          chars += String.fromCharCode(lineArrayLength);
	          lineHash[line] = lineArrayLength;
	          lineArray[lineArrayLength++] = line;
	        }
	      }

	      return chars;
	    }

	    chars1 = diffLinesToCharsMunge(text1);
	    chars2 = diffLinesToCharsMunge(text2);
	    return {
	      chars1: chars1,
	      chars2: chars2,
	      lineArray: lineArray
	    };
	  };
	  /**
	   * Rehydrate the text in a diff from a string of line hashes to real lines of
	   * text.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   * @param {!Array.<string>} lineArray Array of unique strings.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCharsToLines = function (diffs, lineArray) {
	    var x, chars, text, y;

	    for (x = 0; x < diffs.length; x++) {
	      chars = diffs[x][1];
	      text = [];

	      for (y = 0; y < chars.length; y++) {
	        text[y] = lineArray[chars.charCodeAt(y)];
	      }

	      diffs[x][1] = text.join("");
	    }
	  };
	  /**
	   * Reorder and merge like edit sections.  Merge equalities.
	   * Any edit section can move as long as it doesn't cross an equality.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupMerge = function (diffs) {
	    var pointer, countDelete, countInsert, textInsert, textDelete, commonlength, changes, diffPointer, position;
	    diffs.push([DIFF_EQUAL, ""]); // Add a dummy entry at the end.

	    pointer = 0;
	    countDelete = 0;
	    countInsert = 0;
	    textDelete = "";
	    textInsert = "";

	    while (pointer < diffs.length) {
	      switch (diffs[pointer][0]) {
	        case DIFF_INSERT:
	          countInsert++;
	          textInsert += diffs[pointer][1];
	          pointer++;
	          break;

	        case DIFF_DELETE:
	          countDelete++;
	          textDelete += diffs[pointer][1];
	          pointer++;
	          break;

	        case DIFF_EQUAL:
	          // Upon reaching an equality, check for prior redundancies.
	          if (countDelete + countInsert > 1) {
	            if (countDelete !== 0 && countInsert !== 0) {
	              // Factor out any common prefixes.
	              commonlength = this.diffCommonPrefix(textInsert, textDelete);

	              if (commonlength !== 0) {
	                if (pointer - countDelete - countInsert > 0 && diffs[pointer - countDelete - countInsert - 1][0] === DIFF_EQUAL) {
	                  diffs[pointer - countDelete - countInsert - 1][1] += textInsert.substring(0, commonlength);
	                } else {
	                  diffs.splice(0, 0, [DIFF_EQUAL, textInsert.substring(0, commonlength)]);
	                  pointer++;
	                }

	                textInsert = textInsert.substring(commonlength);
	                textDelete = textDelete.substring(commonlength);
	              } // Factor out any common suffixies.


	              commonlength = this.diffCommonSuffix(textInsert, textDelete);

	              if (commonlength !== 0) {
	                diffs[pointer][1] = textInsert.substring(textInsert.length - commonlength) + diffs[pointer][1];
	                textInsert = textInsert.substring(0, textInsert.length - commonlength);
	                textDelete = textDelete.substring(0, textDelete.length - commonlength);
	              }
	            } // Delete the offending records and add the merged ones.


	            if (countDelete === 0) {
	              diffs.splice(pointer - countInsert, countDelete + countInsert, [DIFF_INSERT, textInsert]);
	            } else if (countInsert === 0) {
	              diffs.splice(pointer - countDelete, countDelete + countInsert, [DIFF_DELETE, textDelete]);
	            } else {
	              diffs.splice(pointer - countDelete - countInsert, countDelete + countInsert, [DIFF_DELETE, textDelete], [DIFF_INSERT, textInsert]);
	            }

	            pointer = pointer - countDelete - countInsert + (countDelete ? 1 : 0) + (countInsert ? 1 : 0) + 1;
	          } else if (pointer !== 0 && diffs[pointer - 1][0] === DIFF_EQUAL) {
	            // Merge this equality with the previous one.
	            diffs[pointer - 1][1] += diffs[pointer][1];
	            diffs.splice(pointer, 1);
	          } else {
	            pointer++;
	          }

	          countInsert = 0;
	          countDelete = 0;
	          textDelete = "";
	          textInsert = "";
	          break;
	      }
	    }

	    if (diffs[diffs.length - 1][1] === "") {
	      diffs.pop(); // Remove the dummy entry at the end.
	    } // Second pass: look for single edits surrounded on both sides by equalities
	    // which can be shifted sideways to eliminate an equality.
	    // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC


	    changes = false;
	    pointer = 1; // Intentionally ignore the first and last element (don't need checking).

	    while (pointer < diffs.length - 1) {
	      if (diffs[pointer - 1][0] === DIFF_EQUAL && diffs[pointer + 1][0] === DIFF_EQUAL) {
	        diffPointer = diffs[pointer][1];
	        position = diffPointer.substring(diffPointer.length - diffs[pointer - 1][1].length); // This is a single edit surrounded by equalities.

	        if (position === diffs[pointer - 1][1]) {
	          // Shift the edit over the previous equality.
	          diffs[pointer][1] = diffs[pointer - 1][1] + diffs[pointer][1].substring(0, diffs[pointer][1].length - diffs[pointer - 1][1].length);
	          diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];
	          diffs.splice(pointer - 1, 1);
	          changes = true;
	        } else if (diffPointer.substring(0, diffs[pointer + 1][1].length) === diffs[pointer + 1][1]) {
	          // Shift the edit over the next equality.
	          diffs[pointer - 1][1] += diffs[pointer + 1][1];
	          diffs[pointer][1] = diffs[pointer][1].substring(diffs[pointer + 1][1].length) + diffs[pointer + 1][1];
	          diffs.splice(pointer + 1, 1);
	          changes = true;
	        }
	      }

	      pointer++;
	    } // If shifts were made, the diff needs reordering and another shift sweep.


	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    }
	  };

	  return function (o, n) {
	    var diff, output, text;
	    diff = new DiffMatchPatch();
	    output = diff.DiffMain(o, n);
	    diff.diffCleanupEfficiency(output);
	    text = diff.diffPrettyHtml(output);
	    return text;
	  };
	}();

}((function() { return this; }())));

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("timers").setImmediate)

},{"_process":5,"timers":7}],7:[function(require,module,exports){
(function (setImmediate,clearImmediate){(function (){
var nextTick = require('process/browser.js').nextTick;
var apply = Function.prototype.apply;
var slice = Array.prototype.slice;
var immediateIds = {};
var nextImmediateId = 0;

// DOM APIs, for completeness

exports.setTimeout = function() {
  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
};
exports.setInterval = function() {
  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
};
exports.clearTimeout =
exports.clearInterval = function(timeout) { timeout.close(); };

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}
Timeout.prototype.unref = Timeout.prototype.ref = function() {};
Timeout.prototype.close = function() {
  this._clearFn.call(window, this._id);
};

// Does not start the time, just sets up the members needed.
exports.enroll = function(item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function(item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function(item) {
  clearTimeout(item._idleTimeoutId);

  var msecs = item._idleTimeout;
  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout)
        item._onTimeout();
    }, msecs);
  }
};

// That's not how node.js implements it but the exposed api is the same.
exports.setImmediate = typeof setImmediate === "function" ? setImmediate : function(fn) {
  var id = nextImmediateId++;
  var args = arguments.length < 2 ? false : slice.call(arguments, 1);

  immediateIds[id] = true;

  nextTick(function onNextTick() {
    if (immediateIds[id]) {
      // fn.call() is faster so we optimize for the common use-case
      // @see http://jsperf.com/call-apply-segu
      if (args) {
        fn.apply(null, args);
      } else {
        fn.call(null);
      }
      // Prevent ids from leaking
      exports.clearImmediate(id);
    }
  });

  return id;
};

exports.clearImmediate = typeof clearImmediate === "function" ? clearImmediate : function(id) {
  delete immediateIds[id];
};
}).call(this)}).call(this,require("timers").setImmediate,require("timers").clearImmediate)

},{"process/browser.js":5,"timers":7}],8:[function(require,module,exports){
/*
    I18NDomain class
*/
"use strict";

var context = require( '../../context.js' );

var I18NDomain = function( stringToApply ) {
    
    var string = stringToApply;
    
    var putToAutoDefineHelper = function( scope, autoDefineHelper ){
        
        var newString = string;
        var conf = context.getConf();
        
        // Add the domains defined previously
        var previousValue = scope.get( conf.i18nDomainVarName );
        if ( previousValue ) {
            newString += conf.inDefineDelimiter + conf.i18nDomainVarName;
        }
        
        // Add brackets if not present
        if ( newString[ 0 ] !== '[' ){
            newString = '[' + newString + ']';
        }
        
        // Add i18nDomainVarName to the autoDefineHelper
        autoDefineHelper.put(
            conf.i18nDomainVarName,
            newString
        );
    };

    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: I18NDomain.id
    };
};

I18NDomain.id = 'i18n:domain';

I18NDomain.build = function( string ) {
    return string? new I18NDomain( string.trim() ): null;
};

module.exports = I18NDomain;

},{"../../context.js":27}],9:[function(require,module,exports){
/*
    I18nLanguage class
*/
"use strict";

var context = require( '../../context.js' );

var I18NLanguage = function( stringToApply ) {
    
    var string = stringToApply;
    
    var putToAutoDefineHelper = function( autoDefineHelper ){

        // Add i18nLanguageVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().i18nLanguageVarName,
            string
        );
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "I18NLanguage: " + string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: I18NLanguage.id
    };
};

I18NLanguage.id = 'i18n:language';

I18NLanguage.build = function( string ) {
    return string? new I18NLanguage( string.trim() ): null;
};

module.exports = I18NLanguage;

},{"../../context.js":27}],10:[function(require,module,exports){
/*
    METALDefineMacro class
*/
"use strict";

var METALDefineMacro = function( nameToApply ) {
    
    var name = nameToApply;
    
    var process = function( scope, node ){
        
        // Hide macro definitions
        node.style.display = 'none';

        return false;
    };

    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return "METALDefineMacro: " + name;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        toString: toString,
        type: METALDefineMacro.id
    };
};

METALDefineMacro.id = 'metal:define-macro';

METALDefineMacro.build = function( string ) {
    return new METALDefineMacro( string.trim() );
};

module.exports = METALDefineMacro;

},{}],11:[function(require,module,exports){
/*
    METALFillSlot class
*/
"use strict";

var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var METALFillSlot = function( _string, _expression, _useMacroNode ) {
    
    var string = _string;
    var expression = _expression;
    var useMacroNode = _useMacroNode;
    
    var process = function(){
        // Nothing to do
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater ){
        parserUpdater.updateNode( useMacroNode );
    };
    
    var toString = function(){
        return "METALFillSlot: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: METALFillSlot.id
    };
};

METALFillSlot.id = 'metal:fill-slot';

METALFillSlot.build = function( string, useMacroNode ) {
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new METALFillSlot( 
            string,
            expressionBuilder.build( string ),
            useMacroNode
    );
};

module.exports = METALFillSlot;

},{"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48}],12:[function(require,module,exports){
/*
    METALUseMacro class
*/
"use strict";

var context = require( '../../context.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var attributeIndex = require( '../attributeIndex.js' );
var attributeCache = require( '../../cache/attributeCache.js' );
var TALDefine = require( '../TAL/talDefine.js' );
var METALFillSlot = require( './metalFillSlot.js' );
var resolver = require( '../../resolver.js' );

var METALUseMacro = function( stringToApply, macroExpressionToApply, defineToApply ) {
    
    var string = stringToApply;
    var macroExpression = macroExpressionToApply;
    var define = defineToApply;
    
    var process = function( scope, node, autoDefineHelper, indexExpressions ){

        // Init some vars
        var macroKey = resolver.getMacroKey( macroExpression, scope );
        var tags = context.getTags();
        var newNode = resolver.getNode( macroKey, scope ); 
        
        // Hide use macro node
        node.style.display = 'none';

        // Remove style attribute to force showing the new node
        newNode.removeAttribute( 'style' );

        // Update define and autoDefine attributes of the new node
        updateNewNodeAttributes( macroKey, newNode, autoDefineHelper, tags, node, indexExpressions );
        
        // Fill slots
        fillSlots( scope, node, tags, newNode, indexExpressions );

        // Add the macro node
        node.parentNode.insertBefore( newNode, node.nextSibling );
        
        return newNode;
    };
    
    var updateNewNodeAttributes = function( macroKey, newNode, autoDefineHelper, tags, node, indexExpressions ){

        // Update the talDefine attribute
        TALDefine.updateAttribute( newNode, define );
        
        // Update the talAutoDefine attribute
        var macroData = resolver.getMacroData( macroKey );
        if ( macroData.url ){
            autoDefineHelper.put( 
                context.getConf().externalMacroUrlVarName, 
                "'" + macroData.url + "'"
            );
            autoDefineHelper.updateNode( newNode );
        }
        
        // Set related id attribute if needed
        if ( indexExpressions ){
            newNode.setAttribute( 
                tags.relatedId, 
                node.getAttribute( tags.id ) 
            );
        }
    };
    
    var fillSlots = function( scope, node, tags, newNode, indexExpressions ){
        
        var list = node.querySelectorAll( 
            "[" + resolver.filterSelector( tags.metalFillSlot ) + "]"
        );
        var element;
        var pos = 0;
        while ( element = list[ pos++ ] ) {
            var slotIdExpressionString = element.getAttribute( tags.metalFillSlot );
            var slotIdExpression = expressionBuilder.build( slotIdExpressionString );
            var slotId = slotIdExpression.evaluate( scope );

            // Index fill slot element
            if ( indexExpressions ){
                var metalFillSlot = attributeCache.getByAttributeClass( 
                    METALFillSlot, 
                    slotIdExpressionString, 
                    element,
                    indexExpressions,
                    scope,
                    function(){
                        return METALFillSlot.build( slotIdExpressionString, node );
                    }
                );
                attributeIndex.add( element, metalFillSlot, scope );   
            }

            // Do nothing if slotIdExpression evaluates to false
            if ( ! slotId ){
                return;
            }

            var slotContent = element.cloneNode( true );
            var currentNode = newNode.querySelector( 
                "[" + resolver.filterSelector( tags.metalDefineSlot ) + "='" + slotId + "']"
            );
            if ( ! currentNode ){
                throw 'Slot "' + slotId + '" in expression "' + slotIdExpressionString +'" not found!';
            }
            currentNode.parentNode.insertBefore( 
                slotContent, 
                currentNode.nextSibling
            );
            slotContent.removeAttribute( tags.metalFillSlot );
            slotContent.setAttribute( tags.id, context.nextExpressionCounter() ); // Set a new id attribute to avoid id conflicts
            currentNode.remove();
        }
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, macroExpression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node );
    };
    
    var toString = function(){
        return "METALUseMacro: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: METALUseMacro.id
    };
};

METALUseMacro.id = 'metal:use-macro';

METALUseMacro.build = function( string, stringDefine ) {
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new METALUseMacro( 
            string,
            expressionBuilder.build( string.trim() ),
            stringDefine? stringDefine.trim(): undefined
    );
};

module.exports = METALUseMacro;

},{"../../cache/attributeCache.js":24,"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../resolver.js":97,"../TAL/talDefine.js":18,"../attributeIndex.js":23,"./metalFillSlot.js":11}],13:[function(require,module,exports){
/* 
    contentHelper singleton class
*/
"use strict";

var context = require( '../../context.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var evaluateHelper = require( '../../expressions/evaluateHelper.js' );

module.exports = (function() {

    var formInputHasBody = {
        BUTTON: 1,
        LABEL: 1,
        LEGEND: 1,
        FIELDSET: 1,
        OPTION: 1
    };
    
    var build = function( tag, string, constructorFunction ) {

        // Process it
        var content = string.trim();

        // Check if is an HTML expression
        var structure = content.indexOf( context.getConf().htmlStructureExpressionPrefix + ' ' ) === 0;
        var expressionString = structure? 
            content.substr( 1 + context.getConf().htmlStructureExpressionPrefix.length ): 
            content;
        if ( ! expressionString ){
            throw tag + ' expression void.';
        }
        
        return constructorFunction(
            string,
            expressionBuilder.build( expressionString ),
            structure,
            expressionString
        );
    };
    
    var updateNode = function( node, structure, evaluated ){

        // Check default
        if ( evaluateHelper.isDefault( evaluated ) ){
            return true;
        }

        // Check nothing
        if ( evaluateHelper.isNothing( evaluated ) ){
            evaluated = "";
        }

        // Add it to node
        node.innerHTML = evaluated;
        if ( ! structure ) {
            node[ "form" in node && !formInputHasBody[ node.tagName ] ? "value": "innerText" ] = evaluated;
        }

        return true;
    };
    
    return {
        build: build,
        updateNode: updateNode
    };
})();

},{"../../context.js":27,"../../expressions/evaluateHelper.js":44,"../../expressions/expressionBuilder.js":46}],14:[function(require,module,exports){
/*
    TALAttributes class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var utils = require( '../../utils.js' );

var TALAttributes = function( stringToApply, attributeItemsToApply ) {
    
    var string = stringToApply;
    var attributeItems = attributeItemsToApply;
    
    var process = function( scope, node, attributeName ){
        
        for ( var i = 0; i < attributeItems.length; i++ ) {
            var attributeItem = attributeItems[ i ];
            var name = attributeItem.name;
            
            if ( ! attributeName || name === attributeName ){
                var value = attributeItem.expression.evaluate( scope );

                if ( name ){
                    processSimpleAttributeItem( node, name, value );
                } else {
                    processMapAttributeItem( node, value );
                }
            }
        }
    };

    var processMapAttributeItem = function( node, map ){
    
        // Do nothing if map is null
        if ( ! map ){
            return;
        }
        
        if ( ! utils.isPlainObject( map ) ){
            throw 'Invalid attribute value: "' + map + '". Object expected.';
        }
        
        for ( var name in map ){
            var value = map[ name ];
            processSimpleAttributeItem( node, name, value );
        }
    };
    
    var processSimpleAttributeItem = function( node, name, value ){
        
        // Boolean attributes
        if ( context.isBooleanAttribute( name ) ){
            if ( value ){
                node.setAttribute( name, '' );
            } else {
                node.removeAttribute( name );
            }
            return;
        }
        
        // If value is undefined don't parser the attribute
        if ( value == undefined ) {
            return;
        }
            
        // Alt attributes
        if ( context.isAltAttribute( name ) ) {
            switch ( name ) {
            case "innerHTML":
                throw node; // should use "qtext"
            case "style":
                node.style.cssText = value;
                break;
            /*
            case "text":
                node[ querySelectorAll ? name : innerText ] = value;
                break; // option.text unstable in IE
            */
            case "class":
                name = "className";
            default:
                node[ name ] = value;
            }
            return;
        } 

        // Regular attributes
        node.setAttribute( name, value );
    };

    var dependsOn = function( scope ){

        var result = [];
        var object = {};
        
        for ( var i = 0; i < attributeItems.length; i++ ) {
            var attributeItem = attributeItems[ i ];
            var dependsOnList = expressionsUtils.buildDependsOnList( undefined, scope, attributeItem.expression );
            if ( dependsOnList && dependsOnList.length > 0 ){
                object[ attributeItem.name ] = dependsOnList;
            }
        }
        
        if ( Object.keys( object ).length > 0 ){
            result.push( object );
        }
        
        return result;
    };
    
    var update = function( parserUpdater, node, scope, indexItem ){
        process( scope, node, indexItem.groupId );
    };
    
    var toString = function(){
        return "TALAttributes: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALAttributes.id
    };
};

TALAttributes.id = 'tal:attributes';

TALAttributes.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    var attributeItems = [];
    var expressionString = string.trim();
    var tokens = new ExpressionTokenizer( 
            expressionString, 
            context.getConf().attributeDelimiter, 
            true );

    while ( tokens.hasMoreTokens() ) {
        var attribute = tokens.nextToken().trim();
        var space = attribute.indexOf( context.getConf().inAttributeDelimiter );
        if ( space === -1 ) {
            attributeItems.push({
                name: undefined,
                expression: expressionBuilder.build( attribute )
            });
        }
        var name = attribute.substring( 0, space );
        var valueExpression = attribute.substring( space + 1 ).trim();

        attributeItems.push({
            name: name,
            expression: expressionBuilder.build( valueExpression )
        });
    }
    
    return new TALAttributes( string, attributeItems );
};

module.exports = TALAttributes;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47,"../../expressions/expressionsUtils.js":48,"../../utils.js":101}],15:[function(require,module,exports){
/*
    TALCondition class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var context = require( '../../context.js' );

var TALCondition = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var process = function( scope, node ){
        
        var result = evaluateHelper.evaluateBoolean( scope, expression );
        
        node.setAttribute( context.getTags().conditionResult, result );
        node.style.display = result ? '' : 'none';
        
        return result;
    };

    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node, true );
    };
    
    var updatableFromAction = function( parserUpdater, node ){
        
        var scope = parserUpdater.getNodeScope( node );
        var result = evaluateHelper.evaluateBoolean( scope, expression );
        var valueFromTag = 'true' === node.getAttribute( context.getTags().conditionResult );
        
        return result !== valueFromTag;
    };
    
    var toString = function(){
        return "TALCondition: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        updatableFromAction: updatableFromAction,
        toString: toString,
        type: TALCondition.id
    };
};

TALCondition.id = 'tal:condition';

TALCondition.build = function( string ) {
    
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new TALCondition( 
                string,
                expressionBuilder.build( string ) );
};

module.exports = TALCondition;

},{"../../context.js":27,"../../expressions/evaluateHelper.js":44,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48}],16:[function(require,module,exports){
/*
    TALContent class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var contentHelper = require( './contentHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALContent = function( stringToApply, expressionToApply, structureToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var structure = structureToApply;
    
    var process = function( scope, node ){
        
        return contentHelper.updateNode( 
            node, 
            structure, 
            evaluateHelper.evaluateToNotNull( scope, expression ) 
        );
    };

    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node, scope ){
        process( scope, node );
    };
    
    var toString = function(){
        return "TALContent: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALContent.id
    };
};

TALContent.id = 'tal:content';

TALContent.build = function( string ) {
    
    return contentHelper.build( 
        'TALContent',
        string,
        function( _string, _expression, _structure ){
            return new TALContent( _string, _expression, _structure );
        }
    );
};

module.exports = TALContent;

},{"../../expressions/evaluateHelper.js":44,"../../expressions/expressionsUtils.js":48,"./contentHelper.js":13}],17:[function(require,module,exports){
/*
    TALDeclare class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALDeclare = function( _string, _declareItems ) {
    
    var string = _string;
    var declareItems = _declareItems;
    
    var process = function( scope, autoDefineHelper ){

        putVariables( scope, autoDefineHelper );

        return processDeclareItems( scope );
    };
    
    var putVariables = function( scope, autoDefineHelper ) {
        
        // Add strictModeVarName to the autoDefineHelper if needed
        var strictModeVarName = context.getConf().strictModeVarName;
        if ( true !== scope.get( strictModeVarName ) ){
            autoDefineHelper.put( strictModeVarName, 'true' );
        }
        
        // Build declared and required
        var declaredVarsVarName = context.getConf().declaredVarsVarName;
        var declared = scope.get( declaredVarsVarName ) || [];
        for ( var i = 0; i < declareItems.length; i++ ) {
            var declareItem = declareItems[ i ];
            declared.push( declareItem.name );
        }
        
        // Add declaredVarsVarName to the autoDefineHelper
        autoDefineHelper.put( 
            declaredVarsVarName, 
            expressionsUtils.buildList( declared, true )
        );
    };
    
    var processDeclareItems = function( scope ) {
        
        var errorsArray = [];

        for ( var i = 0; i < declareItems.length; i++ ) {
            var declareItem = declareItems[ i ];
            var errors = checkDeclareItem(
                scope,
                declareItem.name,
                declareItem.type,
                declareItem.required,
                declareItem.defaultValueString,
                declareItem.defaultValueExpression
            );
            errorsArray = errorsArray.concat( errors );
        }

        processErrorsArray( errorsArray );

        return errorsArray.length === 0;
    };

    var checkDeclareItem = function( scope, name, type, required, defaultValueString, defaultValueExpression ) {
        
        var errorsArray = [];
        
        var value = scope.get( name );
        
        // Set default value if needed
        if ( value === undefined && defaultValueExpression !== undefined ){
            var setDefaultValueError = setDefaultValue( scope, name, type, defaultValueString, defaultValueExpression );
            if ( setDefaultValueError ){
                errorsArray.push( setDefaultValueError );
                return errorsArray;
            }
            value = scope.get( name );
        }
        
        // Check type
        var typeCheckError = checkType( name, type, value );
        if ( typeCheckError ){
            errorsArray.push( typeCheckError );
        }
        
        // Check required
        var requiredCheckError = checkRequired( name, required, value );
        if ( requiredCheckError ){
            errorsArray.push( requiredCheckError );
        }
        
        return errorsArray;
    };
    
    var checkType = function( name, expectedType, value ) {
        
        if ( ! expectedType ){
            return;
        }
        
        var realType = getTypeOf( value );
        return realType === expectedType.toLowerCase()? 
            false: 
            'Expected value type (' + expectedType.toLowerCase() + ') of ' + name + ' property does not match type (' + realType + '), value is "' + value + '".';
    };
    
    /*
        typeOf();                   // undefined
        typeOf(null);               // null
        typeOf(NaN);                // number
        typeOf(5);                  // number
        typeOf([]);                 // array
        typeOf('');                 // string
        typeOf(function () {});     // function
        typeOf(/a/)                 // regexp
        typeOf(new Date())          // date
        typeOf(new Error)           // error
        typeOf(Promise.resolve())   // promise
        typeOf(function *() {})     // generatorfunction
        typeOf(new WeakMap())       // weakmap
        typeOf(new Map())           // map
        typeOf({});                 // object
        typeOf(new MyConstructor()) // MyConstructor
    */
    var getTypeOf = function( value ){
        
        var temp = {}.toString.call( value ).split(' ')[ 1 ].slice( 0, -1 ).toLowerCase();
        return temp === 'object'? 
            value.constructor.name.toLowerCase(): 
            temp;
    };
    
    var checkRequired = function( name, required, value ) {
        
        return true === required && value === undefined? 
            'Required value must not be undefined: ' + name:
            false;
    };
    
    var setDefaultValue = function( scope, name, type, defaultValueString, defaultValueExpression ) {
        
        try {
            var defaultValue = defaultValueExpression.evaluate( scope );
            scope.set( name, defaultValue );
            return false;
            
        } catch ( e ) {
            return 'Error trying to evaluate default value of field ' + name + ', expression [' + defaultValueString + ']: ' + e;
        }
    };
    
    var processErrorsArray = function( errorsArray ) {

        if ( errorsArray.length === 0 ){
            return;
        }
        
        throw errorsArray;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALDeclare: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALDeclare.id
    };
};

TALDeclare.id = 'tal:declare';

TALDeclare.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );

    var declareItems = [];
    var omitTypes = [ 'undefined', 'null' ];
    
    var tokens = new ExpressionTokenizer( 
        string.trim(), 
        context.getConf().declareDelimiter, 
        true 
    );

    while ( tokens.hasMoreTokens() ) {
        
        var inPropTokens = new ExpressionTokenizer( 
            tokens.nextToken().trim(), 
            context.getConf().inDeclareDelimiter, 
            true 
        );
        
        var name = undefined;
        var type = undefined;
        var defaultValueString = undefined;
        var required = false;
        var state = 1;
        while ( inPropTokens.hasMoreTokens() ){
            var currentToken = inPropTokens.nextToken();
            if ( TALDeclare.tokenIsRequired( currentToken ) ){
                required = true;
                continue;
            }
            switch ( state ) {
                case 1:
                    name = currentToken;
                    break;
                case 2:
                    if ( -1 === omitTypes.indexOf( currentToken.toLowerCase() ) ){
                        type = currentToken;   
                    }
                    break;
                case 3:
                    defaultValueString = currentToken;
                    break;
                default:
                    throw 'Too many arguments in talDeclare item: ' + string.trim();
            }
            ++state;
        }
        
        // The name is the only required element
        if ( ! name ){
            continue;
        }
        
        declareItems.push({
            name: name,
            type: type,
            required: required,
            defaultValueString: defaultValueString,
            defaultValueExpression: defaultValueString == undefined? undefined: expressionBuilder.build( defaultValueString )
        });
    }

    return new TALDeclare( string, declareItems );
};

TALDeclare.tokenIsRequired = function( token ) {
    return "required" === token.toLowerCase();
};

module.exports = TALDeclare;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47,"../../expressions/expressionsUtils.js":48}],18:[function(require,module,exports){
/*
    TALDefine class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );

var TALDefine = function( stringToApply, defineItemsToApply ) {
    
    var string = stringToApply;
    var defineItems = defineItemsToApply;
    
    var process = function( scope, forceGlobal ){
        
        // Update scope
        for ( var i = 0; i < defineItems.length; i++ ) {
            var defineItem = defineItems[ i ];
            scope.set( 
                    defineItem.name, 
                    defineItem.nocall? defineItem.expression: defineItem.expression.evaluate( scope ), 
                    forceGlobal || defineItem.global,
                    defineItem.nocall,
                    defineItem.expression
            );
        }
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALDefine: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALDefine.id
    };
};

TALDefine.id = 'tal:define';

TALDefine.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );

    var defineItems = [];
    var expressionString = string.trim();
    var tokens = new ExpressionTokenizer( 
        expressionString, 
        context.getConf().defineDelimiter, 
        true );

    while ( tokens.hasMoreTokens() ) {
        var variable = tokens.nextToken().trim();
        var space = variable.indexOf( context.getConf().inDefineDelimiter );
        if ( space === -1 ) {
            throw 'Bad variable definition: ' + variable;
        }

        var nocall = false;
        var global = false;
        var currentToken = variable.substring( 0, space );
        var nextTokens = variable.substring( space + 1 ).trim();
        var tokenDone = false;
        do {
            var specialToken = false;
            if ( context.getConf().globalVariableExpressionPrefix === currentToken ){
                global = true;
                specialToken = true;
            } else if ( context.getConf().nocallVariableExpressionPrefix === currentToken ){
                nocall = true;  
                specialToken = true;
            } 
            
            if ( specialToken ){
                space = nextTokens.indexOf( context.getConf().inDefineDelimiter );
                currentToken = nextTokens.substring( 0, space );
                nextTokens = nextTokens.substring( space + 1 ).trim();
                
            } else {
                defineItems.push({
                    name: currentToken,
                    expression: expressionBuilder.build( nextTokens ),
                    global: global,
                    nocall: nocall
                });
                tokenDone = true;
            }

        } while( ! tokenDone && space !== -1 );
    }

    return new TALDefine( string, defineItems );
};


TALDefine.appendStrings = function() {
    
    var result = arguments[ 0 ];
    
    for ( var c = 1; c < arguments.length; ++c ){
        var string = arguments[ c ];
        if ( string ){
            result = result? result + context.getConf().defineDelimiter + string: string;
        }
    }
    
    return result;
};

TALDefine.updateAttribute = function( node, defineToAdd ){

    var tags = context.getTags();
    var nodeDefine = node.getAttribute( tags.talDefine );
    var fullDefine = TALDefine.appendStrings( defineToAdd, nodeDefine );

    if ( fullDefine ){
        node.setAttribute( tags.talDefine, fullDefine );
    }
};

module.exports = TALDefine;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47}],19:[function(require,module,exports){
/*
    TALOmitTag class
*/
"use strict";

var BooleanLiteral = require( '../../expressions/path/literals/booleanLiteral.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var context = require( '../../context.js' );

var TALOmitTag = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var process = function( scope, node, parserNodeRenderer ){
        
        var result = expression.evaluate( scope );
        if ( ! result ){
            return false;
        }
        
        // Process the contents
        parserNodeRenderer.defaultContent( node );
        
        // Move children from current node to its parent and then remove it
        var tags = context.getTags();
        var parentNode = node.parentNode;
        while ( node.firstChild ) {
            if ( node.firstChild.nodeType === 1 ){
                node.firstChild.setAttribute( tags.qdup, 1 );
            }
            parentNode.appendChild( node.firstChild );
        }
        parentNode.removeChild( node );

        return true;
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALOmitTag: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALOmitTag.id
    };
};

TALOmitTag.id = 'tal:omit-tag';

TALOmitTag.build = function( string ) {
    
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    var expressionString = string.trim();
    var expression = expressionString == ''?
            new BooleanLiteral( true ):
            expressionBuilder.build( expressionString );
    
    return new TALOmitTag( string, expression );
};

module.exports = TALOmitTag;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../expressions/path/literals/booleanLiteral.js":59}],20:[function(require,module,exports){
/*
    TALOnError class
*/
"use strict";

var context = require( '../../context.js' );
var contentHelper = require( './contentHelper.js' );

var TALOnError = function( stringToApply, structureToApply ) {
    
    var string = stringToApply;
    var structure = structureToApply;
    
    var putToAutoDefineHelper = function( autoDefineHelper ){

        // Add onErrorVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().onErrorVarName,
            string,
            true
        );
        
        // Add onErrorStructureVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().onErrorStructureVarName,
            structure,
            false
        );
    };

    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALOnError: " + string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALOnError.id
    };
};

TALOnError.id = 'tal:on-error';

TALOnError.build = function( string ) {

    return contentHelper.build( 
        'TALOnError',
        string,
        function( _string, _expression, _structure, _expressionString ){
            return new TALOnError( _expressionString, _structure );
        }
    );
};

module.exports = TALOnError;

},{"../../context.js":27,"./contentHelper.js":13}],21:[function(require,module,exports){
/*
    TALRepeat class
*/
"use strict";

var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var Loop = require( '../../parsers/loop.js' );

var TALRepeat = function( stringToApply, varNameToApply, expressionStringToApply ) {
    
    var string = stringToApply;
    var varName = varNameToApply;
    var expressionString = expressionStringToApply;
    var expression = expressionBuilder.build( expressionString );
    var loop;
    
    var process = function( scope ){
        loop = new Loop( varName, expressionString, scope );
        return loop;
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node );
    };
    
    var toString = function(){
        return "TALRepeat: " + string;
    };
    
    var getExpressionString = function(){
        return expressionString;
    };
    
    var getVarName = function(){
        return varName;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALRepeat.id,
        getExpressionString: getExpressionString,
        getVarName: getVarName
    };
};

TALRepeat.id = 'tal:repeat';

TALRepeat.build = function( string ) {
    
    var expressionString = string.trim();
    var space = expressionString.indexOf( ' ' );
    if ( space === -1 ) {
        throw 'Bad repeat expression: ' + expressionString;
    }
    var varName = expressionString.substring( 0, space );
    var loopExpression = expressionString.substring( space + 1 );
    
    return new TALRepeat( string, varName, loopExpression );
};

module.exports = TALRepeat;

},{"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../parsers/loop.js":88}],22:[function(require,module,exports){
/*
    TALReplace class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var contentHelper = require( './contentHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALReplace = function( stringToApply, expressionToApply, structureToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var structure = structureToApply;
    
    var process = function( scope, node ){
        
        // Evaluate
        var evaluated = evaluateHelper.evaluateToNotNull( scope, expression );
        
        // Check default
        if ( evaluateHelper.isDefault( evaluated ) ){
            return true;
        }

        // Check nothing
        if ( evaluateHelper.isNothing( evaluated ) ){
            evaluated = "";
        }
        
        if ( structure ){
            // Replace HTML
            node.outerHTML = evaluated;
            
        } else {
            // Replace original node by new text node
            var textNode = node.ownerDocument.createTextNode( evaluated );
            node.parentNode.replaceChild( textNode, node );
        }
        
        return true;
    };
    
    var dependsOn = function( scope ){
        //return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return 'TALReplace: ' + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALReplace.id
    };
};

TALReplace.id = 'tal:replace';

TALReplace.build = function( string ) {

    return contentHelper.build( 
        'TALReplace',
        string,
        function( _string, _expression, _structure ){
            return new TALReplace( _string, _expression, _structure );
        }
    );
};

module.exports = TALReplace;

},{"../../expressions/evaluateHelper.js":44,"../../expressions/expressionsUtils.js":48,"./contentHelper.js":13}],23:[function(require,module,exports){
/* 
    attributeIndex singleton class
*/
"use strict";

var utils = require( '../utils.js' );
var context = require( '../context.js' );

module.exports = (function() {
    
    var map;
    
    var reset = function(){
        map = {};
    };
    reset();
    
    var add = function( node, attributeInstance, scope ){
        
        addList(
            node,
            attributeInstance,
            attributeInstance.dependsOn( scope )
        );
    };
    
    var addList = function( node, attributeInstance, list, groupId ){
        
        for ( var i = 0; i < list.length; i++ ) {
            addAny( node, attributeInstance, list[ i ], groupId );
        }
    };
    var addObject = function( node, attributeInstance, item ){
        
        for ( var groupId in item ){
            addAny( node, attributeInstance, item[ groupId ], groupId );
        }
    };
    var addAny = function( node, attributeInstance, item, groupId ){
        
        if ( utils.isPlainObject( item ) ){
            addObject( node, attributeInstance, item );
        } else if ( Array.isArray( item ) ){
            addList( node, attributeInstance, item, groupId );
        } else {
            addVar( node, attributeInstance, item, groupId );
        }
    };
    /*
    var addVar = function( node, attributeInstance, varName, groupId  ){
        
        var list = map[ varName ];
        if ( ! list ){
            list = [];
            map[ varName ] = list;
        }

        list.push(
            {
                attributeInstance: attributeInstance,
                nodeId: node.getAttribute( context.getTags().id ),
                groupId: groupId
            }
        );
    };
    */
    var addVar = function( node, attributeInstance, varName, groupId  ){
        
        var list = map[ varName ];
        if ( ! list ){
            list = [];
            map[ varName ] = list;
        }
        
        var newItem = {
            attributeInstance: attributeInstance,
            nodeId: node.getAttribute( context.getTags().id ),
            groupId: groupId
        };
        
        //var index = list.findIndex( item => utils.deepEqual( item, newItem ) );
        var index = list.findIndex( 
            function( item ) { 
                return utils.deepEqual( item, newItem );
            }
        );
        if ( index === -1 ){
            list.push( newItem );
        } else {
            list[ index ] = newItem;
        }
    };
    
    var getVarsList = function( varName ){
        
        var items = map[ varName ];
        
        // Return an empty list if needed
        if ( items === undefined ){
            return [];
        }
        
        // Remove items with removed nodes
        cleanItems( items );
        
        // We must build another list to avoid sync errors
        var result = [];
        result = result.concat( items );
        return result;
    };
    
    //TODO findNodeById duplicated
    var findNodeById = function ( nodeId ) {
        
        return window.document.querySelector( 
            '[' + context.getTags().id + '="' + nodeId + '"]' 
        );
    };
    
    // Iterate through items and remove them when node does not exist in DOM
    var cleanItems = function( items ){
        
        var indexesToRemove = [];
        
        // Build list of items to remove
        for ( var i = 0; i < items.length; ++i ){
            var item = items[ i ];
            var node = findNodeById( item.nodeId );
            if ( ! node ){
                indexesToRemove.push( i );
            }
        }
        
        // Remove items
        for ( var j = indexesToRemove.length - 1; j >= 0 ; --j ){
            var indexToRemove = indexesToRemove[ j ];
            items.splice( indexToRemove, 1 );
        };
    };
    /*
    var removeVar = function( varName, nodeId ){
        
        var list = map[ varName ];

        var filtered = list.filter(
            function( value, index, arr ){
                return value.nodeId !== nodeId;
            }
        );

        map[ varName ] = filtered;
    };
    
    var removeVarFromNodes = function( varName, nodeIds ){
        
        var list = map[ varName ];

        var filtered = list.filter(
            function( value, index, arr ){
                return nodeIds.indexOf( value.nodeId ) === -1;
            }
        );

        if ( filtered.length === 0 ){
            delete map[ varName ];
        } else {
            map[ varName ] = filtered;
        }
        
    };
    
    var getAllNodeIds = function( target ){
        
        // Get the list
        var list = target.querySelectorAll( '[' + context.getTags().id + ']' );

        // Iterate the list
        var result = [];
        var nodeIdAttributeName = context.getTags().id;
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            result.push( 
                node.getAttribute( nodeIdAttributeName ) 
            );
        }
        
        return result;
    };
    
    var removeNode = function( node ){

        var nodeIds = getAllNodeIds( node );

        var nodeId = node.getAttribute( context.getTags().id );
        nodeIds.push( nodeId );
        
        for ( var varName in map ){
            removeVarFromNodes( varName, nodeIds );
        }
    };
    
    var removeMultipleNodes = function( nodeIds ){

        for ( var varName in map ){
            removeVarFromNodes( varName, nodeIds );
        }
    };
    */
    return {
        add: add,
        getVarsList: getVarsList,
        //removeVar: removeVar,
        //removeNode: removeNode,
        //removeMultipleNodes: removeMultipleNodes,
        reset: reset
    };
})();

},{"../context.js":27,"../utils.js":101}],24:[function(require,module,exports){
/*
    attributeCache singleton class
*/
"use strict";

var CacheHelper = require( './cacheHelper.js' );
var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );

module.exports = (function() {
    
    var map;
    
    var reset = function(){
        map = {};
    };
    reset();
    
    var get = function( attribute, string ) {
        
        var attributeMap = map[ attribute ];
        
        if ( ! attributeMap ){
            return null;
        }
         
        return attributeMap[ CacheHelper.hashCode( string ) ];
    };
    
    var put = function( attribute, string, value ){
        
        var attributeMap = map[ attribute ];
        
        if ( ! attributeMap ){
            attributeMap = {};
            map[ attribute ] = attributeMap;
        }
        
        attributeMap[ CacheHelper.hashCode( string ) ] = value;
    };
    
    var index = function( node, attribute, scope ){
        
        if ( node ){
            log.debug( 'Must index!' );
            attributeIndex.add( node, attribute, scope );
            
        } else {
            log.debug( 'Not indexed!' );
        }
        
        return attribute;
    };
    
    var getByDetails = function( attributeType, string, buildFunction, force, node, scope ) {
        
        log.debug( 
            'Request building of ZPT attribute "' + string + '", force "' + force + '"' );
        
        // Get from cache if possible
        if ( force || ! context.getConf().attributeCacheOn ){
            log.debug( 'Cache OFF!' );
            
        } else {
            log.debug( 'Cache ON!' );
            var fromCache = get( attributeType, string );
            if ( fromCache ){
                log.debug( 'Found in cache!' );
                //return fromCache;
                return index( node, fromCache, scope );
            } else {
                log.debug( 'NOT found in cache!' );
            }
        }
        
        // Force build and put into cache
        log.debug( 'Must build!' );
        var builded = buildFunction();
        put( attributeType, string, builded );
        //return builded;
        return index( node, builded, scope );
    };
    
    var getByAttributeClass = function( attributeInstance, string, node, indexExpressions, scope, constructor ) {
        
        return getByDetails( 
                attributeInstance.id, 
                string, 
                constructor || function(){
                    return attributeInstance.build( string );
                }, 
                false,
                indexExpressions? node: undefined,
                scope
        );
    };
    
    return {
        //getByDetails: getByDetails,
        getByAttributeClass: getByAttributeClass,
        reset: reset
    };
})();

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../logHelper.js":74,"./cacheHelper.js":25}],25:[function(require,module,exports){
/*
    cacheHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var hashCode = function( string ) {

        if ( Array.prototype.reduce ) {
            return string.split( "" ).reduce(
                function( a, b ){
                    a = ( ( a << 5 ) - a ) + b.charCodeAt( 0 );
                    return a&a
                },
                0 );
        }

        var hash = 0;
        if ( string.length === 0 ){
            return hash;
        }
        for ( var i = 0, len = string.length; i < len; i++ ) {
            var chr = string.charCodeAt( i );
            hash = ( ( hash << 5 ) - hash ) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        
        return hash;
    };
    
    return {
        hashCode: hashCode
    };
})();

},{}],26:[function(require,module,exports){
/*
    expressionCache singleton class
*/
module.exports = (function() {
    "use strict";
    
    var CacheHelper = require( './cacheHelper.js' );
    var context = require( '../context.js' );
    var log = require( '../logHelper.js' );
    
    var map = {};
    
    var get = function( string ) {
        return map[ CacheHelper.hashCode( string ) ];
    };
    
    var put = function( string, value ){
        map[ CacheHelper.hashCode( string ) ] = value;
    };
    
    var process = function( string, buildFunction, force ) {
        
        log.debug( 
            'Request building of expression "' + string + '", force "' + force + '"' );
        
        // Get from cache if possible
        if ( ! force && context.getConf().expressionCacheOn ){
            log.debug( 'Cache ON!' );
            var fromCache = get( string );
            if ( fromCache ){
                log.debug( 'Found in cache!' );
                return fromCache;
            } 
            log.debug( 'NOT found in cache!' );
            
        } else {
            log.debug( 'Cache OFF!' );
        }
        
        // Force build and put into cache
        log.debug( 'Must build!' );
        var builded = buildFunction();
        put( string, builded );
        return builded;
    };
    
    var clean = function( ) {
        map = {};
    };
    
    return {
        get: process,
        clean: clean
    };
})();

},{"../context.js":27,"../logHelper.js":74,"./cacheHelper.js":25}],27:[function(require,module,exports){
/* 
    context singleton class
*/

var log4javascript = require( 'log4javascript' );
var utils = require( './utils.js' );
var LoopItem = require( './parsers/loopItem.js' );
var CSSAnimationManager = require( './parsers/dictionaryActions/cssAnimationManager.js' );

module.exports = (function() {
    "use strict";
    
    /* Tags */
    var defaultTags = {
        talCondition:     "data-condition",
        talRepeat:        "data-repeat",
        talAttributes:    "data-attributes",
        talContent:       "data-content",
        talDefine:        "data-define",
        talAutoDefine:    "data-tauto-define",
        talOmitTag:       "data-omit-tag",
        talReplace:       "data-replace",
        talOnError:       "data-on-error",
        talDeclare:         "data-declare",
        metalDefineMacro: "data-define-macro",
        metalUseMacro:    "data-use-macro",
        metalDefineSlot:  "data-define-slot",
        metalFillSlot:    "data-fill-slot",
        metalMacro:       "data-mmacro",
        i18nDomain:       "data-domain",
        i18nLanguage:     "data-language",
        //scopeKey:         "data-scope-key",
        rootKey:          "data-root-key",
        qdup:             "data-qdup",
        id:               "data-id",
        relatedId:        "data-related-id",
        conditionResult:  "data-condition-result"
    };
    var originalTags = {
        talCondition:     "tal:condition",
        talRepeat:        "tal:repeat",
        talAttributes:    "tal:attributes",
        talContent:       "tal:content",
        talDefine:        "tal:define",
        talAutoDefine:    "tal:auto-define",
        talOmitTag:       "tal:omit-tag",
        talReplace:       "tal:replace",
        talOnError:       "tal:on-error",
        talDeclare:       "tal:declare",
        metalDefineMacro: "metal:define-macro",
        metalUseMacro:    "metal:use-macro",
        metalDefineSlot:  "metal:define-slot",
        metalFillSlot:    "metal:fill-slot",
        metalMacro:       "data-mmacro",
        i18nDomain:       "i18n:domain",
        i18nLanguage:     "i18n:language",
        //scopeKey:         "data-scope-key",
        rootKey:          "data-root-key",
        qdup:             "data-qdup",
        id:               "data-id",
        relatedId:        "data-related-id",
        conditionResult:  "data-condition-result"
    };
    var tags = defaultTags;
    var tal = '';
    
    var getTags = function (){
        return tags;
    };
    
    var setTags = function ( tagsToSet ){
        tags = tagsToSet;
        tal = '';
    };
    
    var getTal = function (){
        if ( tal === '' ){
            var c = 0;
            var notInclude = tags.qdup;
            for ( var property in tags ) {
                if ( notInclude === tags[ property ] ){
                    continue;
                }
                if ( c++ > 0){
                    tal += ",";
                }
                tal += "*[" + tags[ property ] + "]";
            }
        }
        
        return tal;
    };
    var useOriginalTags = function(){
        setTags( originalTags );
    };
    /* End Tags */
    
    /* Formatters */
    var formatters = {};
    formatters.lowerCase = function ( value ){
        return value.toLocaleLowerCase();
    };
    formatters.upperCase = function ( value ){
        return value.toLocaleUpperCase();
    };
    formatters.localeDate = function ( value ){
        return value.toLocaleDateString;
    };
    formatters.localeTime = function ( value ){
        return value.toLocaleTimeString;
    };
    formatters.localeString = function ( value, locale ){
        return locale? 
               value.toLocaleString( value, locale ): 
               value.toLocaleString( value );
    };
    formatters.fix = function ( number, fixTo ){
        return number.toFixed( fixTo );
    };
    
    var getFormatter = function ( id ){
        return formatters[ id ];
    };
    
    var registerFormatter = function ( id, formatter ){
        formatters[ id ] = formatter;
    };
    var unregisterFormatter = function ( id ){
        delete formatters[ id ];
    };
    /* End Formatters */
    
    /* Conf */
    var EXPRESSION_SUFFIX = ':';
    var PRIVATE_VARS_PREFIX = '_';
    var defaultConf = {
        pathDelimiter:          '|',
        pathSegmentDelimiter:   '/',
        expressionDelimiter:    ' ',
        intervalDelimiter:      ':',
        propertyDelimiter:      '/',
        defineDelimiter:        ';',
        inDefineDelimiter:      ' ',
        attributeDelimiter:     ';',
        inAttributeDelimiter:   ' ',
        domainDelimiter:        ' ',
        i18nOptionsDelimiter:   ';',
        inI18nOptionsDelimiter: ' ',
        argumentsDelimiter:     ',',
        macroDelimiter:         '@',
        declareDelimiter:         ';',
        inDeclareDelimiter:       ' ',
        
        i18nConfResourceId:      "/CONF/",
        
        htmlStructureExpressionPrefix:  "structure",
        globalVariableExpressionPrefix: "global",
        nocallVariableExpressionPrefix: "nocall",
        
        templateErrorVarName:    "error",
        onErrorVarName:          PRIVATE_VARS_PREFIX + "on-error",
        onErrorStructureVarName: PRIVATE_VARS_PREFIX + "on-error-structure",
        i18nDomainVarName:       PRIVATE_VARS_PREFIX + "i18nDomain",
        i18nLanguageVarName:     PRIVATE_VARS_PREFIX + "i18nLanguage",
        externalMacroUrlVarName: PRIVATE_VARS_PREFIX + "externalMacroUrl",
        strictModeVarName:       PRIVATE_VARS_PREFIX + "strictMode",
        declaredVarsVarName:     PRIVATE_VARS_PREFIX + "declaredVars",
        repeatVarName:           PRIVATE_VARS_PREFIX + "repeat",
        
        windowVarName:           "window",
        contextVarName:          "context",
        
        nothingVarName:          "nothing",
        defaultVarName:          "default",
        nothingVarValue:         "___nothing___",
        defaultVarValue:         "___default___",
        
        loggingOn:    false,
        loggingLevel: log4javascript.Level.ERROR,

        externalMacroPrefixURL: "",
        variableNameRE:         /^[A-Za-z0-9_/-]+$/,
        expressionCacheOn:      true,
        attributeCacheOn:       true,

        expressionSuffix:     EXPRESSION_SUFFIX,
        stringExpression:     "string" + EXPRESSION_SUFFIX,
        existsExpression:     "exists" + EXPRESSION_SUFFIX,
        notExpression:        "not" + EXPRESSION_SUFFIX,
        javaScriptExpression: "js" + EXPRESSION_SUFFIX,
        equalsExpression:     "eq" + EXPRESSION_SUFFIX,
        greaterExpression:    "gt" + EXPRESSION_SUFFIX,
        lowerExpression:      "lt" + EXPRESSION_SUFFIX,
        addExpression:        "+" + EXPRESSION_SUFFIX,
        subExpression:        "-" + EXPRESSION_SUFFIX,
        mulExpression:        "*" + EXPRESSION_SUFFIX,
        divExpression:        "/" + EXPRESSION_SUFFIX,
        modExpression:        "%" + EXPRESSION_SUFFIX,
        orExpression:         "or" + EXPRESSION_SUFFIX,
        andExpression:        "and" + EXPRESSION_SUFFIX,
        condExpression:       "cond" + EXPRESSION_SUFFIX,
        formatExpression:     "format" + EXPRESSION_SUFFIX,
        trExpression:         "tr" + EXPRESSION_SUFFIX,
        trNumberExpression:   "trNumber" + EXPRESSION_SUFFIX,
        trCurrencyExpression: "trCurrency" + EXPRESSION_SUFFIX,
        trDateTimeExpression: "trDate" + EXPRESSION_SUFFIX,
        inExpression:         "in" + EXPRESSION_SUFFIX,
        queryExpression:      "query" + EXPRESSION_SUFFIX,
        pathExpression:       "",
        
        firstIndexIdentifier: "_first_",
        lastIndexIdentifier:  "_last_"
    };
    var conf = defaultConf;
    
    var getConf = function (){
        return conf;
    };
    
    var setConf = function ( confToSet ){
        conf = confToSet;
    };
    /* End conf */
    
    /* Logger */
    var logger;
    var getDefaultLogger = function (){
        
        var defaultLogger = log4javascript.getDefaultLogger();
        
        defaultLogger.setLevel( getConf().loggingLevel );
        //defaultLogger.removeAllAppenders();
        //defaultLogger.addAppender( new log4javascript.BrowserConsoleAppender( true ) );
        
        return defaultLogger;
    };
    var getLogger = function (){
        
        if ( ! logger && getConf().loggingOn ){
            logger = getDefaultLogger();
        }
        
        return logger;
    };
    var setLogger = function ( loggerToSet ){
        logger = loggerToSet;
    };
    /* End Logger */
    
    /* 
        Boolean attributes:
        The presence of a boolean attribute on an element represents the true value, and the absence of the attribute represents the false value.
    */
    var booleanAttributes = {
        checked: 1,
        compact: 1,
        declare: 1,
        defer: 1,
        disabled: 1,
        ismap: 1,
        multiple: 1,
        nohref: 1,
        noresize: 1,
        noshade: 1,
        nowrap: 1,
        readonly: 1,
        selected: 1
    };
    
    var getBooleanAttributes = function (){
        return booleanAttributes;
    };
    var setBooleanAttributes = function ( booleanAttributesToSet ){
        booleanAttributes = booleanAttributesToSet;
    };
    var isBooleanAttribute = function ( attribute ){
        return booleanAttributes[ attribute ] === 1;
    };
    /* End Boolean attributes */
    
    /* 
        Alt attributes:
        Attributes which don't support setAttribute().
    */
    var altAttributes = {
        className: 1,
        class: 1,
        href: 1,
        htmlFor: 1,
        id: 1,
        innerHTML: 1,
        label: 1,
        style: 1,
        src: 1,
        text: 1,
        title: 1,
        value: 1
    };
    // All booleanAttributes are also altAttributes
    utils.extend( altAttributes, booleanAttributes );
    
    var getAltAttributes = function (){
        return altAttributes;
    };
    var setAltAttributes = function ( altAttributesToSet ){
        altAttributes = altAttributesToSet;
    };
    var isAltAttribute = function ( attribute ){
        return altAttributes[ attribute ] === 1;
    };
    /* End Alt attributes */
    
    /* Errors */
    var defaultErrorFunction = function( error ) {
        
        var msg = Array.isArray( error )?
            error.join( '\n' ):
            error;
        
        window.alert( msg );
        
        throw msg;
    };
    var errorFunction = defaultErrorFunction;
    var setErrorFunction = function( _errorFunction ){
        self.errorFunction = _errorFunction;
    };
    var asyncError = function( url, errorMessage, failCallback ){

        var msg = 'Error trying to get ' + url + ': ' + errorMessage;
        if ( failCallback ){
            failCallback( msg );
        } else {
            errorFunction( msg );
        }
    };
    /* End errors */
    
    /* Repeat */
    var repeat = function( index, length, offset ){
        return new LoopItem( index, length, offset );
    };
    /* End repeat*/
    
    /* Folder dictionaries */
    var folderDictionaries = [];
    var setFolderDictionaries = function( _folderDictionaries ){
        folderDictionaries = _folderDictionaries;
    };
    var getFolderDictionaries = function(){
        return folderDictionaries;
    };
    /* End folder dictionaries */
    
    /* Strict mode  */
    var strictMode = false;
    var setStrictMode = function( _strictMode ){
        strictMode = _strictMode;
    };
    var isStrictMode = function(){
        return strictMode;
    };
    /* End strict mode  */
    
    /* Expression counter */
    var expressionCounter = 0;
    var nextExpressionCounter = function(){
        return ++expressionCounter;
    };
    var setExpressionCounter = function( _expressionCounter ){
        expressionCounter = _expressionCounter;
    };
    /* End expression counter */
    
    /* Run counter */
    var runCounter = 0;
    var nextRunCounter = function(){
        return ++runCounter;
    };
    /* End run counter */
    
    /* Animation managers */
    var defaultAnimationManager = CSSAnimationManager;
    var animationManager = defaultAnimationManager;
    var getAnimationManager = function(){
        return animationManager;
    };
    var setAnimationManager = function( _animationManager ){
        animationManager = _animationManager;
    };
    /* End animation managers*/
    
    var self = {
        getTags: getTags,
        setTags: setTags,
        getTal: getTal,
        getFormatter: getFormatter,
        registerFormatter: registerFormatter,
        unregisterFormatter: unregisterFormatter,
        getConf: getConf,
        setConf: setConf,
        getLogger: getLogger,
        setLogger: setLogger,
        useOriginalTags: useOriginalTags,
        getBooleanAttributes: getBooleanAttributes,
        setBooleanAttributes: setBooleanAttributes,
        isBooleanAttribute: isBooleanAttribute,
        getAltAttributes: getAltAttributes,
        setAltAttributes: setAltAttributes,
        isAltAttribute: isAltAttribute,
        errorFunction: errorFunction,
        setErrorFunction: setErrorFunction,
        asyncError: asyncError,
        repeat: repeat,
        setFolderDictionaries: setFolderDictionaries,
        getFolderDictionaries: getFolderDictionaries,
        setStrictMode: setStrictMode,
        isStrictMode: isStrictMode,
        nextExpressionCounter: nextExpressionCounter,
        setExpressionCounter: setExpressionCounter,
        nextRunCounter: nextRunCounter,
        getAnimationManager: getAnimationManager,
        setAnimationManager: setAnimationManager
    };
    
    return self;
})();

},{"./parsers/dictionaryActions/cssAnimationManager.js":84,"./parsers/loopItem.js":89,"./utils.js":101,"log4javascript":3}],28:[function(require,module,exports){
/*
    AddExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var AddExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            AddExpression.mathOperation, 
            function( total, value ){
                return total + value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

AddExpression.removePrefix = true;
AddExpression.getPrefix = function() {
    return context.getConf().addExpression;
};
AddExpression.mathOperation = 'add';
AddExpression.getId = AddExpression.mathOperation;

AddExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            AddExpression.mathOperation 
    );

    return new AddExpression( string, expressionList );
};

module.exports = AddExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],29:[function(require,module,exports){
/* 
    arithmethicHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var evaluateHelper = require( '../evaluateHelper.js' );
    
    var build = function( string, tag ) {
        var expressionBuilder = require( '../expressionBuilder.js' );

        if ( string.length === 0 ) {
            throw tag + " expression void.";
        }
        
        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false 
        );

        return expressionBuilder.buildList( segments );
    };
    
    var evaluate = function( string, scope, expressionList, mathOperation, arithmethicFunction ) {
        
        // Evaluate segments
        var result = 0;
        var c = 0;
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( ! Array.isArray( evaluated ) ){ 
                // Process numeric value
                result = processInteger( 
                    c++, 
                    evaluated, 
                    result, 
                    arithmethicFunction, 
                    mathOperation, 
                    expression );
                
            } else {
                // Process array of numeric
                for ( var j = 0; j < evaluated.length; j++ ) {
                    result = processInteger( 
                        c++, 
                        evaluated[ j ], 
                        result, 
                        arithmethicFunction, 
                        mathOperation, 
                        expression );
                }
            }
        }
        
        if ( c < 2 ) {
            throw 'Error in expression "' + string + '". Only one element in evaluation of "' + mathOperation 
                + '" expression, please add at least one more.';
        }
        
        return result;
    };
    
    var processInteger = function( c, value, result, arithmethicFunction, mathOperation, expression ){
        
        if ( ! evaluateHelper.isNumber( value ) ) {
            throw "Error trying doing math operation, value '" + value 
                    + "' is not a valid number in expression '" + mathOperation + ' ' + expression + "'";
        }

        return c == 0? Number( value ): arithmethicFunction( result, Number( value ) );
    };
    
    return {
        build: build,
        evaluate: evaluate
    };
})();

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],30:[function(require,module,exports){
/*
    DivideExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var DivideExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            DivideExpression.mathOperation, 
            function( total, value ){
                return total / value;
            } 
        );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

DivideExpression.removePrefix = true;
DivideExpression.getPrefix = function() {
    return context.getConf().divExpression;
};
DivideExpression.mathOperation = 'divide';
DivideExpression.getId = DivideExpression.mathOperation;

DivideExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            DivideExpression.mathOperation 
    );

    return new DivideExpression( string, expressionList );
};

module.exports = DivideExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],31:[function(require,module,exports){
/*
    ModExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var ModExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            ModExpression.mathOperation, 
            function( total, value ){
                return total % value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ModExpression.removePrefix = true;
ModExpression.getPrefix = function() {
    return context.getConf().modExpression;
};
ModExpression.mathOperation = 'mod';
ModExpression.getId = ModExpression.mathOperation;

ModExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            ModExpression.mathOperation 
    );

    return new ModExpression( string, expressionList );
};

module.exports = ModExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],32:[function(require,module,exports){
/*
    MultiplyExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var MultiplyExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            MultiplyExpression.mathOperation, 
            function( total, value ){
                return total * value;
            } 
        );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

MultiplyExpression.removePrefix = true;
MultiplyExpression.getPrefix = function() {
    return context.getConf().mulExpression;
};
MultiplyExpression.mathOperation = 'multiply';
MultiplyExpression.getId = MultiplyExpression.mathOperation;

MultiplyExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            MultiplyExpression.mathOperation 
    );

    return new MultiplyExpression( string, expressionList );
};

module.exports = MultiplyExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],33:[function(require,module,exports){
/*
    SubstractExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var SubstractExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            SubstractExpression.mathOperation, 
            function( total, value ){
                return total - value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

SubstractExpression.removePrefix = true;
SubstractExpression.getPrefix = function() {
    return context.getConf().subExpression;
};
SubstractExpression.mathOperation = 'substract';
SubstractExpression.getId = SubstractExpression.mathOperation;

SubstractExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            SubstractExpression.mathOperation 
    );

    return new SubstractExpression( string, expressionList );
};

module.exports = SubstractExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],34:[function(require,module,exports){
/*
    AndExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var AndExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            if ( ! evaluateHelper.evaluateBoolean( scope, expression ) ){
                return false;
            }
        }

        return true;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

AndExpression.removePrefix = true;
AndExpression.getPrefix = function() {
    return context.getConf().andExpression;
};
AndExpression.getId = AndExpression.getPrefix;

AndExpression.build = function( string ) {
    var boolHelper = require( './boolHelper.js' );
    
    var expressionList = boolHelper.build( string, 'And' );

    return new AndExpression( string, expressionList );
};

module.exports = AndExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionsUtils.js":48,"./boolHelper.js":35}],35:[function(require,module,exports){
/* 
    boolHelper singleton class
*/
"use strict";

module.exports = (function() {    
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var build = function( s, tag ) {
        
        var string = s.trim();
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false );
        if ( segments.countTokens() === 1 ) {
            throw 'Syntax error in expression "' + string + '". Only one element in ' + tag + ' expression, please add at least one more.';
        }
        
        return expressionBuilder.buildList( segments );
    };
    
    return {
        build: build
    };
})();

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],36:[function(require,module,exports){
/*
    CondExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var evaluateHelper = require( '../evaluateHelper.js' );

var CondExpression = function( stringToApply, expression1ToApply, expression2ToApply, expression3ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    var expression3 = expression3ToApply;
    
    var evaluate = function( scope ){
        
        return evaluateHelper.evaluateBoolean( scope, expression1 )?
            expression2.evaluate( scope ):
            expression3.evaluate( scope );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2, expression3 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

CondExpression.removePrefix = true;
CondExpression.getPrefix = function() {
    return context.getConf().condExpression;
};
CondExpression.getId = CondExpression.getPrefix;

CondExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();

    if ( string.length === 0 ) {
        throw 'Cond expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    if ( segments.countTokens() !== 3 ) {
        throw 'Syntax error in cond expression "' + string + '". 3 element are needed.';
    }

    return new CondExpression( 
        string,
        expressionBuilder.build( segments.nextToken() ), 
        expressionBuilder.build( segments.nextToken() ), 
        expressionBuilder.build( segments.nextToken() ) 
    );
};

module.exports = CondExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],37:[function(require,module,exports){
/*
    NotExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var NotExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        return ! evaluateHelper.evaluateBoolean( scope, expression );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

NotExpression.removePrefix = true;
NotExpression.getPrefix = function() {
    return context.getConf().notExpression;
};
NotExpression.getId = NotExpression.getPrefix;

NotExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    
    return new NotExpression( string, expression );
};

module.exports = NotExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionsUtils.js":48}],38:[function(require,module,exports){
/*
    OrExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var OrExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            if ( evaluateHelper.evaluateBoolean( scope, expression ) ){
                return true;
            }
        }

        return false;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

OrExpression.removePrefix = true;
OrExpression.getPrefix = function() {
    return context.getConf().orExpression;
};
OrExpression.getId = OrExpression.getPrefix;

OrExpression.build = function( string ) {
    var boolHelper = require( './boolHelper.js' );
    
    var expressionList = boolHelper.build( string, 'Or' );

    return new OrExpression( string, expressionList );
};

module.exports = OrExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionsUtils.js":48,"./boolHelper.js":35}],39:[function(require,module,exports){
/* 
    comparisonHelper singleton class
*/
"use strict";

module.exports = (function() {
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var evaluateHelper = require( '../evaluateHelper.js' );
    
    var build = function( s, tag ) {
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        var string = s.trim();
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false );
        if ( segments.countTokens() !== 2 ) {
            throw 'Wrong number of elements in expression "' + string + '", ' + tag + ' expressions only support two.';
        }

        var expression1 = expressionBuilder.build( segments.nextToken() );
        var expression2 = expressionBuilder.build( segments.nextToken() );
        
        return {
            expression1: expression1,
            expression2: expression2
        };
    };
    
    var evaluate = function( scope, valueExpression1, valueExpression2 ) {
        
        return {
            number1: evaluateHelper.evaluateNumber( scope, valueExpression1 ),
            number2: evaluateHelper.evaluateNumber( scope, valueExpression2 )
        };
    };
    
    return {
        build: build,
        evaluate: evaluate
    };
})();

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],40:[function(require,module,exports){
/*
    EqualsExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var EqualsExpression = function( stringToApply, argsToApply ) {
    
    var string = stringToApply;
    var args = argsToApply;
    
    var evaluate = function( scope ){
        var arg0 = args[ 0 ];
        var result0 = arg0.evaluate( scope );
        
        for ( var i = 1; i < args.length; i++ ) {
            var arg = args[ i ];
            var result = arg.evaluate( scope );
            if ( result0 != result ){
                return false;
            }
        }
        
        return true;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, args );
    };
    
    var toString = function(){
        return string;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

EqualsExpression.removePrefix = true;
EqualsExpression.getPrefix = function() {
    return context.getConf().equalsExpression;
};
EqualsExpression.getId = EqualsExpression.getPrefix;

EqualsExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    if ( string.length === 0 ) {
        throw 'Equals expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    if ( segments.countTokens() === 1 ) {
        throw 'Only one element in equals expression "' + string + '", please add at least one more.';
    }

    return new EqualsExpression( 
        string,
        expressionBuilder.buildList( segments ) 
    );
};

module.exports = EqualsExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],41:[function(require,module,exports){
/*
    GreaterExpression class
*/
"use strict";

var context = require( '../../context.js' );
var comparisonHelper = require( './comparisonHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var GreaterExpression = function( stringToApply, expression1ToApply, expression2ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    
    var evaluate = function( scope ){
        var numbers = comparisonHelper.evaluate( scope, expression1, expression2 );
        return numbers.number1 > numbers.number2;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

GreaterExpression.removePrefix = true;
GreaterExpression.getPrefix = function() {
    return context.getConf().greaterExpression;
};
GreaterExpression.getId = GreaterExpression.getPrefix;

GreaterExpression.build = function( string ) {
    
    var data = comparisonHelper.build( string, 'greater' );

    return new GreaterExpression( string, data.expression1, data.expression2 );
};

module.exports = GreaterExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./comparisonHelper.js":39}],42:[function(require,module,exports){
/*
    InExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var InExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){
        var expression0 = expressionList[ 0 ];
        var evaluated0 = expression0.evaluate( scope );
        
        for ( var i = 1; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( Array.isArray( evaluated ) ){ 
                for ( var j = 0; j < evaluated.length; j++ ) {
                    if ( evaluated0 == evaluated[ j ] ){
                        return true;
                    }
                }
                continue;
            }
            
            if ( evaluated0 == evaluated ){
                return true;
            }
        }
        
        return false;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

InExpression.removePrefix = true;
InExpression.getPrefix = function() {
    return context.getConf().inExpression;
};
InExpression.getId = InExpression.getPrefix;

InExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    if ( string.length === 0 ) {
        throw 'In expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false 
    );
    if ( segments.countTokens() === 1 ) {
        throw 'Only one element in in expression "' + string + '", please add at least one more.';
    }

    return new InExpression( 
        string,
        expressionBuilder.buildList( segments ) 
    );
};

module.exports = InExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],43:[function(require,module,exports){
/*
    LowerExpression class
*/
"use strict";

var context = require( '../../context.js' );
var comparisonHelper = require( './comparisonHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var LowerExpression = function( stringToApply, expression1ToApply, expression2ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    
    var evaluate = function( scope ){
        var numbers = comparisonHelper.evaluate( scope, expression1, expression2 );
        return numbers.number1 < numbers.number2;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

LowerExpression.removePrefix = true;
LowerExpression.getPrefix = function() {
    return context.getConf().lowerExpression;
};
LowerExpression.getId = LowerExpression.getPrefix;

LowerExpression.build = function( string ) {
    
    var data = comparisonHelper.build( string, 'lower' );

    return new LowerExpression( string, data.expression1, data.expression2 );
};

module.exports = LowerExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./comparisonHelper.js":39}],44:[function(require,module,exports){
/* 
    evaluateHelper singleton class
*/
"use strict";

var context = require( '../context.js' );

module.exports = (function() {
    
    var evaluateToNotNull = function( scope, expression ) {
        var evaluated = expression.evaluate( scope );
        return evaluated == undefined? 'undefined': evaluated;
    };
    
    var evaluateBoolean = function( scope, expression ) {
        var evaluated = expression.evaluate( scope );
        
        if ( evaluated === undefined
            || evaluated == null
            || evaluated == 'false' 
            || evaluated == false 
            || evaluated == 0 ){
            return false;
        }
        
        return true;
    };
    
    var evaluateNumber = function( scope, expression, errorMessageToApply ) {
        var evaluated = expression.evaluate( scope );
        
        if ( ! isNumber( evaluated ) ){
            var errorMessage = 
                errorMessageToApply? 
                errorMessageToApply: 
                'Expression "' + expression + '" is not a valid number.';
            throw errorMessage;
        }
        
        return evaluated;
    };
    
    var isNumber = function( string ){
        return ! isNaN( parseFloat( string ) ) || ! isFinite( string );
    };
    /*
    var evaluateInteger = function( scope, expression, errorMessageToApply ) {
        var evaluated = expression.evaluate( scope );
        
        if ( ! isInteger( evaluated ) ){
            var errorMessage = 
                errorMessageToApply? 
                errorMessageToApply: 
                'Expression "' + expression + '" is not a valid integer.'
            throw errorMessage;
        }
        
        return evaluated;
    };*/
    /*
    var isInteger = function( string ){
        return ! isNaN( parseInt( string ) ) || ! isFinite( string );
    };*/
    
    var evaluateExpressionList = function ( list, scope ){
        
        var result = [];
        
        for ( var i = 0; i < list.length; i++ ) {
            var expression = list[ i ];
            result.push( expression.evaluate( scope ) );
        }
        
        return result;
    };
    
    var isDefault = function( value ){
        return value === context.getConf().defaultVarValue;
    };
    var isNothing = function( value ){
        return value === context.getConf().nothingVarValue;
    };
    
    return {
        evaluateToNotNull: evaluateToNotNull,
        evaluateBoolean: evaluateBoolean,
        evaluateNumber: evaluateNumber,
        //evaluateInteger: evaluateInteger,
        isNumber: isNumber,
        //isInteger: isInteger,
        evaluateExpressionList: evaluateExpressionList,
        isDefault: isDefault,
        isNothing: isNothing
    };
})();

},{"../context.js":27}],45:[function(require,module,exports){
/*
    ExistsExpression class
*/
"use strict";

var context = require( '../context.js' );
var expressionsUtils = require( './expressionsUtils.js' );

var ExistsExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        
        try {
            return undefined !== expression.evaluate( scope );
            
        } catch ( e ){
            return false;
        }
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ExistsExpression.removePrefix = true;
ExistsExpression.getPrefix = function() {
    return context.getConf().existsExpression;
};
ExistsExpression.getId = ExistsExpression.getPrefix;

ExistsExpression.build = function( string ) {
    var expressionBuilder = require( './expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    return new ExistsExpression( string, expression );
};

module.exports = ExistsExpression;

},{"../context.js":27,"./expressionBuilder.js":46,"./expressionsUtils.js":48}],46:[function(require,module,exports){
/* 
    expressionBuilder singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( '../context.js' );
    var ExpressionTokenizer = require( './expressionTokenizer.js' );
    var PathExpression = require( './path/pathExpression.js' );
    var expressionCache = require( '../cache/expressionCache.js' );
    /*var log = require( '../logHelper.js' );*/
    
    var expressionManagers = {};
    var withoutPrefixExpressionManagers = {};
    var DEFAULT_ID = PathExpression.getId();
    
    /* Register expression managers */
    var register = function( expressionsManager, id ) {
        expressionManagers[ id || expressionsManager.getPrefix() || expressionsManager.getId() ] = expressionsManager;
        
        if ( ! expressionsManager.removePrefix && expressionsManager.getPrefix() ){
            withoutPrefixExpressionManagers[ expressionsManager.getPrefix() ] = expressionsManager;
        }
    };
    
    var unregister = function( expressionsManager, id ) {
        delete expressionManagers[ id || expressionsManager.getPrefix() || expressionsManager.getId() ];
    };
    
    var registerGeneralPurpose = function(){
        register( require( './existsExpression.js' ) );
        register( require( './formatExpression.js' ) );
        register( require( './stringExpression.js' ) );
        register( require( './path/pathExpression.js' ) );
    };
    var registerComparison = function(){
        register( require( './comparison/equalsExpression.js' ) );
        register( require( './comparison/greaterExpression.js' ) );
        register( require( './comparison/lowerExpression.js' ) );
        register( require( './comparison/inExpression.js' ) );
    };
    var registerArithmetic = function(){
        register( require( './arithmethic/addExpression.js' ) );
        register( require( './arithmethic/substractExpression.js' ) );
        register( require( './arithmethic/multiplyExpression.js' ) );
        register( require( './arithmethic/divideExpression.js' ) );
        register( require( './arithmethic/modExpression.js' ) );
    };
    var registerLogical = function(){
        register( require( './bool/andExpression.js' ) );
        register( require( './bool/condExpression.js' ) );
        register( require( './bool/notExpression.js' ) );
        register( require( './bool/orExpression.js' ) );
    };
    var registerI18n = function(){
        register( require( './i18n/trCurrencyExpression.js' ) );
        register( require( './i18n/trDateTimeExpression.js' ) );
        register( require( './i18n/trNumberExpression.js' ) );
        register( require( './i18n/trStringExpression.js' ) );
    };
    var registerScripting = function(){
        register( require( './scripting/javascriptExpression.js' ) );
        register( require( './scripting/queryExpression.js' ) );
    };
    
    var registerAll = function(){
        registerGeneralPurpose();
        registerComparison();
        registerArithmetic();
        registerLogical();
        registerI18n();
        registerScripting();
    }();
    /* End Register expression managers */
    
    var build = function( string, force ) {
        return expressionCache.get(
                string, 
                function(){
                    return forceBuild( string );
                }, 
                force
        );
    };
    
    var forceBuild = function( string ) {
        var effectiveString = removeParenthesisIfAny( string.trim() );
        var index = effectiveString.indexOf( context.getConf().expressionSuffix );
        var id = undefined;
        var isDefault = false;
        
        // Is the default expression type? Is registered?
        if ( index !== -1 ){
            id = effectiveString.substring( 0, index )  + ':';
            
            // If the id is not resistered must be a path
            isDefault = ! expressionManagers.hasOwnProperty( id );
        } else {
            isDefault = true;
        }
        
        // Remove prefix and set id if it is default expression type
        var removePrefix = false;
        var expressionManager = undefined;
        if ( isDefault ){
            /*id = DEFAULT_ID;*/
            expressionManager = getWithoutPrefixExpressionManager( effectiveString );
        } else {
            removePrefix = true;
        }
        
        // Get the expression manager and build the expression
        expressionManager = expressionManager || expressionManagers[ id ];
        var finalString = undefined;
        if ( removePrefix && expressionManager.removePrefix ){
            finalString = effectiveString.substr( id.length );
        } else {
            finalString = effectiveString;
        }
        return expressionManager.build( finalString );
    };
    
    var getWithoutPrefixExpressionManager = function( string ){
        
        for ( var prefix in withoutPrefixExpressionManagers ) {
            if ( string.indexOf( prefix ) === 0 ) {
                return withoutPrefixExpressionManagers[ prefix ];
            }
        }
        
        return expressionManagers[ DEFAULT_ID ];
    };
    
    var buildList = function( segments ) {
        var list = [];
        
        while ( segments.hasMoreTokens() ) {
            list.push(
                build( 
                    segments.nextToken().trim()  ) );
        }

        return list;
    };
    
    var removePrefix = function( string, prefix ) {
        return string.substr( prefix.length );
    };
    
    var removePrefixAndBuild = function( string, prefix ) {
        return build(
                string.substr( prefix.length ));
    };
    
    var removeParenthesisIfAny = function( token ){
        var effectiveToken = token.trim();
        
        if ( effectiveToken == '' ){
            return effectiveToken;
        }
        
        if ( effectiveToken.charAt( 0 ) === '(' ){
            return removeParenthesisIfAny( 
                        effectiveToken.substring( 1, effectiveToken.lastIndexOf( ')' ) ).trim() );
        }
        
        return effectiveToken;
    };
    
    var endsWith = function( str, suffix ) {
        return str.indexOf( suffix, str.length - suffix.length ) !== -1;
    };
    
    var getArgumentsFromString = function( string ) {
        
        // Parse and evaluate arguments; then push them to an array
        var tokens = new ExpressionTokenizer( 
                string, 
                context.getConf().argumentsDelimiter, 
                true );
        var args = [];
        while ( tokens.hasMoreTokens() ) {
            var currentString = tokens.nextToken().trim();
            args.push( 
                    build( currentString ) );
        }
        
        return args;
    };
    
    return {
        register: register,
        unregister: unregister,
        registerAll: registerAll,
        build: build,
        buildList: buildList,
        removePrefix: removePrefix,
        removePrefixAndBuild: removePrefixAndBuild,
        removeParenthesisIfAny: removeParenthesisIfAny,
        endsWith: endsWith,
        getArgumentsFromString: getArgumentsFromString
    };
})();

},{"../cache/expressionCache.js":26,"../context.js":27,"./arithmethic/addExpression.js":28,"./arithmethic/divideExpression.js":30,"./arithmethic/modExpression.js":31,"./arithmethic/multiplyExpression.js":32,"./arithmethic/substractExpression.js":33,"./bool/andExpression.js":34,"./bool/condExpression.js":36,"./bool/notExpression.js":37,"./bool/orExpression.js":38,"./comparison/equalsExpression.js":40,"./comparison/greaterExpression.js":41,"./comparison/inExpression.js":42,"./comparison/lowerExpression.js":43,"./existsExpression.js":45,"./expressionTokenizer.js":47,"./formatExpression.js":49,"./i18n/trCurrencyExpression.js":50,"./i18n/trDateTimeExpression.js":51,"./i18n/trNumberExpression.js":53,"./i18n/trStringExpression.js":54,"./path/pathExpression.js":63,"./scripting/javascriptExpression.js":68,"./scripting/queryExpression.js":69,"./stringExpression.js":70}],47:[function(require,module,exports){
/* 
    Class ExpressionTokenizer 
*/
module.exports = function( exp, delimiter, escape ) {
    "use strict";
    
    var expressionBuilder = require( './expressionBuilder.js' );
    var removeParenthesisIfAny = expressionBuilder.removeParenthesisIfAny;
    
    var expression = exp.trim();

    var iterator;
    var currIndex = 0;
    var delimiterCount = 0;
    var delimiters = [];
    
    var makeIterator = function( array ){
        var nextIndex = 0;
        
        return {
            next: function(){
                return nextIndex < array.length ?
                   array [ nextIndex++ ] :
                   undefined;
            },
            hasNext: function(){
                return nextIndex < array.length;
            }
        };
    };
    
    var analyze = function(){
        var avoidRepeatedSeparators = delimiter === ' ';
        
        // Go ahead and find delimiters, if any, at construction time
        var parentLevel = 0;
        var inQuote = false;
        var previousCh = '';
        
        // Scan for delimiters
        var length = expression.length;
        for ( var i = 0; i < length; i++ ) {
            var ch = expression.charAt( i );
            
            if ( ch === delimiter ) {
                // If delimiter is not buried in parentheses or a quote
                if ( parentLevel === 0 && ! inQuote  ) {
                    
                    if ( avoidRepeatedSeparators && ( previousCh === delimiter || previousCh === '\n' ) ) {
                        continue;
                    }
                    
                    var nextCh = ( i + 1 < length ) ? expression.charAt( i + 1 ) : '';
                    
                    // And if delimiter is not escaped
                    if ( ! ( escape && nextCh === delimiter ) ) {
                        delimiterCount++;
                        delimiters.push( i );
                    } else {
                        // Somewhat inefficient way to pare the
                        // escaped delimiter down to a single
                        // character without breaking our stride
                        expression = expression.substring( 0, i + 1 ) + expression.substring( i + 2 );
                        length--;
                    }
                }
            // Increment parenthesis level
            } else if ( ch === '(' || ch === '[' ) {
                parentLevel++;
                
            // Decrement parenthesis level
            } else if ( ch === ')' || ch === ']' ) {
                parentLevel--;
                // If unmatched right parenthesis
                if ( parentLevel < 0 ) {
                    throw 'Syntax error. Unmatched right parenthesis: ' + expression;
                }
                
            // Start or end quote
            } else if ( ch === '\'' ) {
                inQuote = ! inQuote;
            }
            
            previousCh = ch;
        }
        
        // If unmatched left parenthesis
        if ( parentLevel > 0 ) {
            throw 'Syntax error: unmatched left parenthesis: ' + expression;
        }
        
        // If runaway quote
        if ( inQuote ) {
            throw 'Syntax error: runaway quotation: ' + expression;
        }
        
        iterator = makeIterator( delimiters );
    }();
    
    var hasMoreTokens = function( ) {
        return currIndex < expression.length;
    };
    
    var nextToken = function( ) {
        var token;
        
        if ( iterator.hasNext() ) {
            var next = iterator.next();
            var delim = parseInt( next );
            token = expression.substring( currIndex, delim ).trim();
            currIndex = delim + 1;
            delimiterCount--;
            
            return removeParenthesisIfAny( token );
        }
        
        token = expression.substring( currIndex ).trim();
        currIndex = expression.length;
        
        return removeParenthesisIfAny( token );
    };
        
    var countTokens = function( ) {
        if ( hasMoreTokens() ) {
            return delimiterCount + 1;
        }
        return 0;
    };
    
    var nextTokenIfAny = function( defaultValue ) {
        return hasMoreTokens()? nextToken(): defaultValue;
    };
    
    return {
        hasMoreTokens: hasMoreTokens,
        nextToken: nextToken,
        countTokens: countTokens,
        nextTokenIfAny: nextTokenIfAny
    };
};

},{"./expressionBuilder.js":46}],48:[function(require,module,exports){
/* 
    expressionsUtils singleton class
*/
"use strict";

var evaluateHelper = require( './evaluateHelper.js' );
var utils = require( '../utils.js' );
var DepsDataItem = require( '../parsers/depsDataItem.js' );

module.exports = (function() {
    
    var buildLiteral = function( value ) {
        return evaluateHelper.isNumber( value )? "" + value: "'" + value + "'";
    };
    
    var buildList = function( items, asStrings ) {
        
        var result = '[';
        var separator = asStrings? "'": "";
        
        for ( var i = 0; i < items.length; i++ ) {
            result += separator + items[ i ] + separator + " ";
        }
        
        result += ']';
        return result;
    };
    
    var buildDependsOnList = function(){
        
        var result = [];
        
        var depsDataItem = arguments[ 0 ];
        if ( ! depsDataItem ){
            depsDataItem = new DepsDataItem();
        }
        
        var scope = arguments[ 1 ];
        
        for ( var argCounter = 2; argCounter < arguments.length; argCounter++ ){
            var list = arguments[ argCounter ];
            result = result.concat( 
                getDependsOnFromList( depsDataItem, scope, list )
            );
        }
        
        return result;
    };
    
    var getDependsOnFromList = function( depsDataItem, scope, arg ){
        
        var result = [];
        
        if ( ! arg ){
            return result;
        }
        
        if ( ! Array.isArray( arg ) ){
            return getDependsOnFromNonList( depsDataItem, scope, arg );
        }
        
        var list = arg;
        for ( var i = 0; i < list.length; i++ ) {
            var item = list[ i ];
            result = result.concat( 
                Array.isArray( item )? getDependsOnFromList( scope, item ): getDependsOnFromNonList( depsDataItem, scope, item )
            );
        }

        return result;
    };
    
    var getDependsOnFromNonList = function( depsDataItem, scope, item ){
        
        return ! utils.isFunction( item.dependsOn ) || ( utils.isFunction( item.getVarName ) && depsDataItem === item.getVarName() )? 
            []: 
            item.dependsOn( depsDataItem, scope );
    };
    
    return {
        buildLiteral: buildLiteral,
        buildList: buildList,
        buildDependsOnList: buildDependsOnList
    };
})();

},{"../parsers/depsDataItem.js":77,"../utils.js":101,"./evaluateHelper.js":44}],49:[function(require,module,exports){
/*
    FormatExpression class
*/
"use strict";

var utils = require( '../utils.js' );
var context = require( '../context.js' );
var ExpressionTokenizer = require( './expressionTokenizer.js' );
var expressionsUtils = require( './expressionsUtils.js' );
var evaluateHelper = require( './evaluateHelper.js' );

var FormatExpression = function( stringToApply, formatterExpressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var formatterExpression = formatterExpressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        
        // Get formatter
        var formatter = evaluateFormatter( scope, formatterExpression );
        
        // Get arguments
        var args = evaluateHelper.evaluateExpressionList( argsExpressions, scope );
        
        return formatter.apply( formatter, args );
    };
    
    var evaluateFormatter = function( scope, expression ) {
        
        // Try to get a built-in formatter
        var formatter = context.getFormatter( expression );
        
        // Try to get a function with a name
        if ( ! isValidFormatter( formatter ) ){
            formatter = scope.get( expression );
        }
    
        // Try to get a function evaluating the expression
        if ( ! isValidFormatter( formatter ) ){
            try {
                var expressionBuilder = require( './expressionBuilder.js' );
                var formatterExpression = expressionBuilder.build( expression );
                var value = formatterExpression.evaluate( scope );
                
                return evaluateFormatter( scope, value );

            } catch( e ){
                // Nothing to do
            }
        }
        
        // Return the formatter only if it is valid
        if ( isValidFormatter( formatter ) ){
            return formatter;
        }
        
        throw 'No valid formatter found: ' + string;
    };
    
    var isValidFormatter = function( formatter ){
        return formatter && utils.isFunction( formatter );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, formatterExpression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

FormatExpression.removePrefix = true;
FormatExpression.getPrefix = function() {
    return context.getConf().formatExpression;
};
FormatExpression.getId = FormatExpression.getPrefix;

FormatExpression.build = function( s ) {
    var expressionBuilder = require( './expressionBuilder.js' );
    
    var string = s.trim();
    if ( string.length === 0 ) {
        throw 'Format expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    var numberOfTokens = segments.countTokens();
    if ( numberOfTokens === 1 ) {
        throw 'Only one element in format expression: "' + string + '". Please add at least one more.';
    }

    // Get formatter
    var formatter = segments.nextToken().trim();

    // Get arguments
    var argsExpressions = [];
    while ( segments.hasMoreTokens() ) {
        var argExpression = expressionBuilder.build( segments.nextToken() );
        argsExpressions.push( argExpression );
    }

    return new FormatExpression( string, formatter, argsExpressions );
};

module.exports = FormatExpression;

},{"../context.js":27,"../utils.js":101,"./evaluateHelper.js":44,"./expressionBuilder.js":46,"./expressionTokenizer.js":47,"./expressionsUtils.js":48}],50:[function(require,module,exports){
/*
    TrCurrencyExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrCurrencyExpression = function( stringToApply, expressionToApply, argsExpressionsToApply, subformatToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    var subformat = subformatToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'currency', 
                subformat );
        return evaluated;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrCurrencyExpression.removePrefix = true;
TrCurrencyExpression.getPrefix = function() {
    return context.getConf().trCurrencyExpression;
};
TrCurrencyExpression.getId = TrCurrencyExpression.getPrefix;

TrCurrencyExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrCurrencyExpression.getPrefix(), 
            2, 
            3, 
            true );

    return new TrCurrencyExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions, 
            trData.subformat );
};

module.exports = TrCurrencyExpression;

},{"../../context.js":27,"./trHelper.js":52}],51:[function(require,module,exports){
/*
    TrDateTimeExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrDateTimeExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'datetime', 
                null );
        return evaluated;
    };

    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrDateTimeExpression.removePrefix = true;
TrDateTimeExpression.getPrefix = function() {
    return context.getConf().trDateTimeExpression;
};
TrDateTimeExpression.getId = TrDateTimeExpression.getPrefix;

TrDateTimeExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrDateTimeExpression.getPrefix(), 
            1, 
            2, 
            false );

    return new TrDateTimeExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions );
};

module.exports = TrDateTimeExpression;

},{"../../context.js":27,"./trHelper.js":52}],52:[function(require,module,exports){
/* 
    trHelper singleton class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var i18nHelper = require( '../../i18n/i18nHelper.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var VariableExpression = require( '../path/variableExpression.js' );

module.exports = (function() {
    
    var build = function( string, tag, minElements, maxElements, useSubformat ) {
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string.trim(), 
                context.getConf().expressionDelimiter, 
                false );
        
        // Check number of tokens
        var count = segments.countTokens();
        if ( count < minElements ) {
            throw 'Too few elements in ' + tag + ' expression (minimum is ' + minElements 
                    + ', ' + count + ' present): ' + string.trim();
        }
        if ( count > maxElements ) {
            throw 'Too many elements in ' + tag + ' expression (maximum is ' + maxElements 
                    + ', ' + count + ' present):' + string.trim();
        }
        
        // Get tokens
        var subformat = useSubformat? 
                expressionBuilder.build( segments.nextToken() ): 
                undefined;
        var expression = expressionBuilder.build( 
                segments.nextToken().trim() );
        var argsSegment = segments.hasMoreTokens()? 
                segments.nextToken().trim(): 
                undefined;
        
        return {
            expression: expression,
            argsExpressions: buildI18nArgs( argsSegment ),
            subformat: subformat
        };
    };
    
    var buildI18nArgs = function( segment ){
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        var args = {};
        if ( ! segment ){
            return args;
        }
        var tokens = new ExpressionTokenizer( 
                segment, 
                context.getConf().i18nOptionsDelimiter, 
                true
        );
        while ( tokens.hasMoreTokens() ) {
            var token = tokens.nextToken().trim();
            var argsTokens = new ExpressionTokenizer( 
                    token, 
                    context.getConf().inI18nOptionsDelimiter, 
                    true 
            );
            if ( argsTokens.countTokens() !== 2 ) {
                throw '2 elements are needed in i18n expression.';
            }
            
            var argKey = argsTokens.nextToken().trim();
            var argExpression = expressionBuilder.build( 
                    argsTokens.nextToken().trim() );
            args[ argKey ] = argExpression;
        }
        return args;
    };
    
    var evaluateI18nArgs = function( scope, i18nArgs ){
        var values = {};
        
        for ( var argKey in i18nArgs ) {
            var argExpression = i18nArgs[ argKey ];
            var argValue = evaluateHelper.evaluateToNotNull( scope, argExpression );
            values[ argKey ] = argValue;
        }
        
        return values;
    };
    
    var evaluate = function( scope, valueExpression, argsExpressions, format, subformat ) {
        var argValues = evaluateI18nArgs( scope, argsExpressions );
        var subformatEvaluated = 
                subformat? 
                evaluateHelper.evaluateToNotNull( scope, subformat ): 
                undefined;
        var valueEvaluated = evaluateHelper.evaluateToNotNull( scope, valueExpression );
        var evaluated = translate( 
                scope, 
                valueEvaluated, 
                argValues, 
                format, 
                subformatEvaluated );
        
        return evaluated;
    };
    
    var translate = function( scope, id, i18nArgs, format, subformat ){
        
        var i18nList = scope.get( context.getConf().i18nDomainVarName );
        var language = scope.get( context.getConf().i18nLanguageVarName );
        return i18nHelper.tr( 
            i18nList, 
            id, 
            i18nArgs, 
            format, 
            subformat,
            language 
        );
    };
    
    var dependsOn = function( depsDataItem, scope, expression, argsExpressions ){
        
        return expressionsUtils.buildDependsOnList( 
            depsDataItem, 
            scope, 
            new VariableExpression( context.getConf().i18nDomainVarName ),
            new VariableExpression( context.getConf().i18nLanguageVarName ),
            expression, 
            argsExpressions
        );
    };
    
    return {
        build: build,
        evaluate: evaluate,
        dependsOn: dependsOn
    };
})();

},{"../../context.js":27,"../../i18n/i18nHelper.js":73,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"../path/variableExpression.js":67}],53:[function(require,module,exports){
/*
    TrNumberExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrNumberExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'number', 
                null 
        );
        return evaluated;
    };

    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrNumberExpression.removePrefix = true;
TrNumberExpression.getPrefix = function() {
    return context.getConf().trNumberExpression;
};
TrNumberExpression.getId = TrNumberExpression.getPrefix;

TrNumberExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrNumberExpression.getPrefix(), 
            1, 
            2, 
            false 
    );

    return new TrNumberExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions 
    );
};

module.exports = TrNumberExpression;

},{"../../context.js":27,"./trHelper.js":52}],54:[function(require,module,exports){
/*
    TrStringExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrStringExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'string', 
                null 
        );
        return evaluated;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrStringExpression.removePrefix = true;
TrStringExpression.getPrefix = function() {
    return context.getConf().trExpression;
};
TrStringExpression.getId = TrStringExpression.getPrefix;

TrStringExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrStringExpression.getPrefix(), 
            1, 
            2, 
            false 
    );

    return new TrStringExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions 
    );
};

module.exports = TrStringExpression;

},{"../../context.js":27,"./trHelper.js":52}],55:[function(require,module,exports){
/*
    ArrayExpression class
*/
"use strict";

var expressionsUtils = require( '../expressionsUtils.js' );

var ArrayExpression = function( arrayBaseToApply, indexesToApply ) {
    
    var arrayBase = arrayBaseToApply;
    var indexes = indexesToApply;
    
    var evaluate = function( scope ){
        
        // Evaluate and check array bases and indexes
        var evaluatedArrayBase = arrayBase.evaluate( scope );

        // Iterate indexes
        var result = evaluatedArrayBase;
        for ( var i = 0; i < indexes.length; i++ ) {
            
            // Get and evaluate index as integer
            var indexExpression = indexes[ i ];

            // Evaluate array access
            result = result[ indexExpression.evaluate( scope ) ];
        }
        
        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        // Build the arrayBaseDependsOn
        var arrayBaseDependsOn = expressionsUtils.buildDependsOnList( depsDataItem, scope, arrayBase );
        
        // This must be rare!
        if ( arrayBaseDependsOn.length === 0 ){
            return [];
        } else if ( arrayBaseDependsOn.length > 1 ){
            return expressionsUtils.buildDependsOnList( depsDataItem, scope, arrayBase, indexes );
        }
        
        // Join all together
        var dep = arrayBaseDependsOn[ 0 ];
        for ( var i = 0; i < indexes.length; ++i ){
            var indexExpression = indexes[ i ];
            var indexEvaluated = indexExpression.evaluate( scope );
            dep += '[' + indexEvaluated + ']';
        }
        
        return [ dep ];
    };
    
    var toString = function(){
        return arrayBase + '[' + indexes + ']';
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ArrayExpression.build = function( arrayBase, accessor ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var indexes = [];
    
    var done = false;
    while ( ! done ){

        // Array accessor must begin and end with brackets
        var close = accessor.indexOf( ']' );
        if ( accessor.charAt( 0 ) !== '[' || close === -1 ) {
            throw 'Bad array accessor: '  + accessor;
        }

        // Get index and add to indexes
        var index = expressionBuilder.build( 
                accessor.substring( 1, close ) 
        );
        indexes.push( index );

        // continue processing array access for multidimensional arrays
        close++;
        if ( accessor.length > close ) {
            accessor = accessor.substring( close );
        } else {
            done = true;
        }
    }
    
    return new ArrayExpression( arrayBase, indexes );
};

ArrayExpression.buildArrayData = function( token ) {
    
    var bracket = ArrayExpression.findArrayAccessor( token );
    
    if ( bracket <= 0 ) {
        return undefined;
    }
    
    return {
        arrayAccessor: token.substring( bracket ).trim(),
        token: token.substring( 0, bracket ).trim()
    };
};

ArrayExpression.findArrayAccessor = function( token ) {
    var SCANNING = 0;
    var IN_PAREN = 1;
    var IN_QUOTE = 2;

    var length = token.length;
    var state = SCANNING;
    var parenDepth = 0;
    for ( var i = 0; i < length; i++ ) {
        var ch = token.charAt( i );
        switch( state ) {
        case IN_PAREN:
            if ( ch === ')' ) {
                parenDepth--;
                if ( parenDepth === 0 ) {
                    state = SCANNING;
                }
            } else if ( ch === '(' ) {
                parenDepth++;
            }
            break;

        case IN_QUOTE:
            if ( ch === '\'' ) {
                state = SCANNING;
            }
            break;

        case SCANNING:
            if ( ch === '\'' ) {
                state = IN_QUOTE;
            } else if ( ch === '(' ) {
                parenDepth++;
                state = IN_PAREN;
            } else if ( ch === '[' ) {
                return i;
            }
        }
    }

    return -1;
};

module.exports = ArrayExpression;

},{"../expressionBuilder.js":46,"../expressionsUtils.js":48}],56:[function(require,module,exports){
/*
    FunctionExpression class
*/
"use strict";

var evaluateHelper = require( '../evaluateHelper.js' );

var FunctionExpression = function( stringToApply, nameToApply, argsToApply ) {
    
    var string = stringToApply;
    var name = nameToApply;
    var args = argsToApply;
    
    var evaluate = function( scope ){
        var evaluatedArgs = evaluateHelper.evaluateExpressionList( args, scope );
        var element = scope.get( name );
        return ! element? undefined: element.apply( element, evaluatedArgs );
    };

    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

FunctionExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var leftParent = string.indexOf( '(' );
    if ( leftParent === -1 ) {
        return undefined;
    }
    
    if ( ! expressionBuilder.endsWith( string, ')' ) ) {
        throw 'Syntax error. Bad function call: ' + string;
    }
    var functionName = string.substring( 0, leftParent ).trim();
    var argsString = string.substring( leftParent + 1, string.length - 1 );
    var args = expressionBuilder.getArgumentsFromString( argsString );

    return new FunctionExpression( string, functionName, args );
};

module.exports = FunctionExpression;

},{"../evaluateHelper.js":44,"../expressionBuilder.js":46}],57:[function(require,module,exports){
/*
    IndirectionExpression class
*/
"use strict";

var IndirectionExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope, parent ){
        return parent[ scope.get( name ) ];
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return '?' + name;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

IndirectionExpression.build = function( string ) {
    
    if ( string.charAt( 0 ) !== '?' ) {
        return undefined;
    }
    
    return new IndirectionExpression( string.substring( 1 ) );
};

module.exports = IndirectionExpression;

},{}],58:[function(require,module,exports){
/*
    ListExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var RangeExpression = require( './rangeExpression.js' );

var ListExpression = function( stringToApply, itemsToApply ) {
    
    var string = stringToApply;
    var items = itemsToApply;
    
    var evaluate = function( scope ){
        
        var result = [];
        
        for ( var i = 0; i < items.length; i++ ) {
            var expression = items[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( Array.isArray( evaluated ) ){ 
                result = result.concat( evaluated );
            } else {
                result.push( evaluated );
            }
        }

        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, items );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ListExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    if ( s.charAt( 0 ) !== '[' || s.charAt( s.length - 1 ) !==  ']' ) {
        return undefined;
    }
    
    var string = s.substring( 1, s.length - 1 );
    var items = [];
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            true );

    while ( segments.hasMoreTokens() ) {
        var segment = segments.nextToken().trim();
        var range = RangeExpression.build( segment );

        items.push(
            range?
            range:
            expressionBuilder.build( segment )
        );
    }

    return new ListExpression( string, items );
};

module.exports = ListExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./rangeExpression.js":66}],59:[function(require,module,exports){
/*
    BooleanLiteral class
*/
"use strict";

var BooleanLiteral = function( literalToApply ) {

    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var toString = function(){
        return "" + literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

BooleanLiteral.build = function( string ) {
    
    if ( 'true' === string ) {
        return new BooleanLiteral( true );
    }
    if ( 'false' === string ) {
        return new BooleanLiteral( false );
    }
    return undefined;
};

module.exports = BooleanLiteral;

},{}],60:[function(require,module,exports){
/*
    NumericLiteral class
*/
"use strict";

var NumericLiteral = function( literalToApply ) {
    
    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return literal;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

NumericLiteral.build = function( string ) {
    
    if ( isFinite( string ) ){
        var integerValue = parseInt( string );
        if ( integerValue == string ){
            return new NumericLiteral( integerValue );
        }

        var floatValue = parseFloat( string );
        if ( floatValue == string ){
            return new NumericLiteral( floatValue );
        }
    }

    return undefined;
};

module.exports = NumericLiteral;

},{}],61:[function(require,module,exports){
/*
    StringLiteral class
*/
"use strict";

var StringLiteral = function( literalToApply ) {

    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return literal;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

StringLiteral.build = function( string ) {
    
    if ( string.charAt( 0 ) === "'" && string.charAt( string.length - 1 ) ===  "'" ) {
        return new StringLiteral( 
            string.substring( 1, string.length - 1 ) );
    }

    return undefined;
};

module.exports = StringLiteral;

},{}],62:[function(require,module,exports){
/*
    MethodExpression class
*/
"use strict";

var evaluateHelper = require( '../evaluateHelper.js' );

var MethodExpression = function( stringToApply, nameToApply, argsToApply ) {
    
    var string = stringToApply;
    var name = nameToApply;
    var args = argsToApply;
    
    var evaluate = function( scope, parent ){
        var evaluatedArgs = evaluateHelper.evaluateExpressionList( args, scope );
        return parent[ name ].apply( parent, evaluatedArgs );
    };

    var dependsOn = function(){
        return undefined;
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

MethodExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var leftParent = string.indexOf( '(' );
    if ( leftParent === -1 ) {
        return undefined;
    }
    
    if ( ! expressionBuilder.endsWith( string, ')' ) ) {
        throw 'Syntax error. Bad method call: ' + string;
    }
    
    var methodName = string.substring( 0, leftParent ).trim();
    var argsString = string.substring( leftParent + 1, string.length - 1 );
    var args = expressionBuilder.getArgumentsFromString( argsString );
    
    return new MethodExpression( string, methodName, args );
};

module.exports = MethodExpression;

},{"../evaluateHelper.js":44,"../expressionBuilder.js":46}],63:[function(require,module,exports){
/*
    PathExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var StringLiteral = require( './literals/stringLiteral.js' );
var PathSegmentExpression = require( './pathSegmentExpression.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var PathExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        var exception = undefined;
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            try {
                var expression = expressionList[ i ];
                var result = expression.evaluate( scope );
                if ( result != null ){
                    return result;
                }
            } catch( e ) {
                exception = e;
            }
        }
        
        if ( exception ) {
            throw exception;
        }
        
        return null;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PathExpression.removePrefix = false;
PathExpression.getPrefix = function() {
    return context.getConf().pathExpression;
};
PathExpression.getId = function() { 
    return 'path';
};

PathExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    // Blank expression evaluates to blank string
    if ( string.length === 0 ) {
        return StringLiteral.build( '' );
    }
    
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().pathDelimiter, 
            false );

    // If there is only 1 must be a path segment
    if ( segments.countTokens() === 1 ) {
        return PathSegmentExpression.build( string );
    }

    // If there are more than 1 they can be any expression instance
    var expressionList = [];
    while ( segments.hasMoreTokens() ) {
        var nextToken = segments.nextToken();
        if ( ! nextToken ){
            throw 'Null token inside path expression: ' + string;
        }
        expressionList.push( 
            expressionBuilder.build( 
                nextToken
            ) 
        );
    }
    return new PathExpression( string, expressionList );
};

module.exports = PathExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./literals/stringLiteral.js":61,"./pathSegmentExpression.js":64}],64:[function(require,module,exports){
/*
    PathSegmentExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var ArrayExpression = require( './arrayExpression.js' );
var StringLiteral = require( './literals/stringLiteral.js' );
var NumericLiteral = require( './literals/numericLiteral.js' );
var BooleanLiteral = require( './literals/booleanLiteral.js' );
var ListExpression = require( './listExpression.js' );
var FunctionExpression = require( './functionExpression.js' );
var VariableExpression = require( './variableExpression.js' );
var IndirectionExpression = require( './indirectionExpression.js' );
var MethodExpression = require( './methodExpression.js' );
var PropertyExpression = require( './propertyExpression.js' );

var PathSegmentExpression = function( stringToApply, itemsToApply ) {
    
    var string = stringToApply;
    var items = itemsToApply;
    
    var evaluate = function( scope ){
        
        var token = items[ 0 ];
        var result = token.evaluate( scope );
        for ( var i = 1; i < items.length; i++ ) {
            // Only last element can be null
            if ( result == null ) {
                throw 'Error evaluating "' + string + '": "'  + token + '" is null';
            }
            token = items[ i ];
            result = token.evaluate( scope, result );
        }
        
        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        var firstSegmentDependsOn = expressionsUtils.buildDependsOnList( depsDataItem, scope, items[ 0 ] );
        if ( firstSegmentDependsOn.length === 0 ){
            return [];
        } else if ( firstSegmentDependsOn.length > 1 ){
            return firstSegmentDependsOn;
        }
        
        var temp = firstSegmentDependsOn[ 0 ];
        var result = [ temp ];
        for ( var i = 1; i < items.length; i++ ) {
            var token = items[ i ];
            var tokenDependsOn = token.dependsOn( temp );
            if ( ! tokenDependsOn ){
                break;
                //return temp;
            }
            
            temp += tokenDependsOn;
            result.push( temp );
        }
        
        return result;
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PathSegmentExpression.build = function( string ) {
    
    var items = [];
    
    // Blank expression evaluates to blank string
    if ( string.length === 0 ) {
        items.push( 
            StringLiteral.build( '' ) );
        return items;
    }

    // Build first token
    var path = new ExpressionTokenizer( 
            string, 
            context.getConf().pathSegmentDelimiter, 
            false );
    var token = path.nextToken().trim();
    items.push(
            PathSegmentExpression.buildFirstPathToken( token ) );

    // Traverse the path
    while ( path.hasMoreTokens() ) {
        token = path.nextToken().trim();
        items.push(
            PathSegmentExpression.buildNextPathToken( token ) );
    }
    
    return new PathSegmentExpression( string, items );
};

PathSegmentExpression.buildFirstPathToken = function( t ){

    // Separate identifier from any array accessors
    var arrayData = ArrayExpression.buildArrayData( t );
    var arrayAccessor = arrayData? arrayData.arrayAccessor: undefined;
    var token = arrayData? arrayData.token: t;

    // First token must come from dictionary or be a literal

    // First see if it's a string literal
    var result = StringLiteral.build( token );

    // If it's not, try to see if it's a number
    if ( result === undefined ) {
        result = NumericLiteral.build( token );

        // Maybe it's a boolean literal
        if ( result === undefined ) {
            result = BooleanLiteral.build( token );

            // A list?
            if ( result === undefined ){
                result = ListExpression.build( token );

                // A function call?
                if ( result === undefined ) {
                    result = FunctionExpression.build( token );

                    // Must be an object in scope
                    if ( result === undefined ) {
                        result = VariableExpression.build( token );
                        
                        // Not recognized expression
                        if ( result === undefined ) {
                            throw 'Unknown expression: ' + token;
                        }
                    }
                }
            }
        }
    }

    if ( arrayAccessor !== undefined ) {
        result = ArrayExpression.build( result, arrayAccessor );
    }

    return result;
};

PathSegmentExpression.buildNextPathToken = function( t ){
    
    // Separate identifier from any array accessors
    var arrayData = ArrayExpression.buildArrayData( t );
    var arrayAccessor = arrayData? arrayData.arrayAccessor: undefined;
    var token = arrayData? arrayData.token: t;

    // Test for indirection
    var result = IndirectionExpression.build( token );
    
    // A method call?
    if ( result === undefined ) {
        result = MethodExpression.build( token );

        // A property
        if ( result === undefined ) {
            result = PropertyExpression.build( token );
        }
    }

    if ( arrayAccessor !== undefined ) {
        result = ArrayExpression.build( result, arrayAccessor );
    }

    return result;
};

module.exports = PathSegmentExpression;

},{"../../context.js":27,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./arrayExpression.js":55,"./functionExpression.js":56,"./indirectionExpression.js":57,"./listExpression.js":58,"./literals/booleanLiteral.js":59,"./literals/numericLiteral.js":60,"./literals/stringLiteral.js":61,"./methodExpression.js":62,"./propertyExpression.js":65,"./variableExpression.js":67}],65:[function(require,module,exports){
/*
    PropertyExpression class
*/
"use strict";

var PropertyExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope, parent ){
        return parent[ name ];
    };
    
    var dependsOn = function( parent ){
        return '.' + name;
    };
    
    var toString = function(){
        return name;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PropertyExpression.build = function( string ) {
    return new PropertyExpression( string );
};

module.exports = PropertyExpression;

},{}],66:[function(require,module,exports){
/*
    RangeExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var NumericLiteral = require( './literals/numericLiteral.js' );

var RangeExpression = function( stringToApply, startExpressionToApply, endExpressionToApply, stepExpressionToApply ) {
    
    var string = stringToApply;
    var startExpression = startExpressionToApply;
    var endExpression = endExpressionToApply;
    var stepExpression = stepExpressionToApply;
    
    var evaluate = function( scope ){
        
        // Evaluate all expressions
        var start = evaluateHelper.evaluateNumber( scope, startExpression );
        var end = evaluateHelper.evaluateNumber( scope, endExpression );
        var step = evaluateHelper.evaluateNumber( scope, stepExpression );
        
        // The range is valid, evaluate it
        var result = [];
        var forward = step > 0; 
        
        var c = start;
        while( forward? c <= end: c >= end ){
            result.push( c );
            c += step;
        }
        
        return result;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, startExpression, endExpression, stepExpression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

RangeExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    if ( ! s ) {
        return undefined;
    }

    var string = s.trim();
    
    // If it contains spaces it is not a valid range
    if ( string.indexOf( ' ' ) !== -1 ) {
        return undefined;
    }
    
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().intervalDelimiter, 
            false );

    var numberOfTokens = segments.countTokens();
    if ( numberOfTokens !== 2 && numberOfTokens !== 3 ) {
        return undefined;
    }

    var RANGE_DEFAULT_START = 0;
    var RANGE_DEFAULT_STEP = 1;
    
    // Build start expression
    var start = segments.nextToken().trim();
    var startExpression = start == ''? 
            NumericLiteral.build( RANGE_DEFAULT_START ): 
            expressionBuilder.build( start );

    // Build end expression
    var endExpression = expressionBuilder.build( segments.nextToken() );

    // Build step expression
    var stepExpression = numberOfTokens === 3? 
            expressionBuilder.build( segments.nextToken() ):
            NumericLiteral.build( RANGE_DEFAULT_STEP );
    
    return new RangeExpression( string, startExpression, endExpression, stepExpression );
};

module.exports = RangeExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./literals/numericLiteral.js":60}],67:[function(require,module,exports){
/*
    VariableExpression class
*/
"use strict";

var context = require( '../../context.js' );

var VariableExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope ){
        
        if ( ! scope.isValidVariable( name ) ){
            throw 'Not declared variable found using strict mode:' + name;
        }
        
        return scope.get( name );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        if ( ! depsDataItem.mustAddVar( name ) ){
            return [];
        }
        
        var expression = scope.getVarExpression( name );
        if ( ! expression ){
            depsDataItem.add1NonExpressionVar( name );
            return [ name ];
        }
        
        depsDataItem.add1ExpressionVar( name );
        var result = expression.dependsOn( depsDataItem, scope );
        depsDataItem.addAllVars( result, scope );
        return result;
    };
    
    var getVarName = function(){
        return name;
    };
    
    var toString = function(){
        return name;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        getVarName: getVarName,
        toString: toString
    };
};

VariableExpression.build = function( string ) {
    
    return context.getConf().variableNameRE.test( string )?
        new VariableExpression( string ):
        undefined;
};

module.exports = VariableExpression;

},{"../../context.js":27}],68:[function(require,module,exports){
/*
    JavascriptExpression class
*/
"use strict";

var context = require( '../../context.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var StringExpression = require( '../stringExpression.js' );

var JavascriptExpression = function( expressionToApply ) {
    
    var stringExpression = expressionToApply;
    
    var evaluate = function( scope ){
        var evaluatedString = stringExpression.evaluate( scope );
        return eval( evaluatedString );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, stringExpression );
    };
    
    var toString = function(){
        return stringExpression;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

JavascriptExpression.removePrefix = true;

JavascriptExpression.getPrefix = function() {
    if ( JavascriptExpression.prefix === undefined ){
        JavascriptExpression.prefix = context.getConf().javaScriptExpression;
    }
    return JavascriptExpression.prefix;
};

JavascriptExpression.getId = JavascriptExpression.getPrefix;

JavascriptExpression.build = function( string ) {
    return new JavascriptExpression(
            StringExpression.build( string ) );
};

module.exports = JavascriptExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"../stringExpression.js":70}],69:[function(require,module,exports){
/*
    QueryExpression class
*/
"use strict";

var context = require( '../../context.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var QueryExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        
        try {
            var evaluated = expression.evaluate( scope );
            var elementList = window.document.querySelectorAll( evaluated );
            
            // elementList with length 1
            if ( elementList.length === 1 ){
                return elementList[ 0 ].innerText;
            }
            
            // elementList with length > 1
            var texts = [];
            for ( var i = 0; i < elementList.length; ++i ){
                texts.push( elementList[ i ].innerText );
            }
            return texts;
            
        } catch ( e ){
            return 'Query expression error in "' + string + '": ' + e;
        }
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

QueryExpression.removePrefix = true;
QueryExpression.getPrefix = function() {
    return context.getConf().queryExpression;
};
QueryExpression.getId = QueryExpression.getPrefix;

QueryExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    
    return new QueryExpression( string, expression );
};

module.exports = QueryExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionsUtils.js":48}],70:[function(require,module,exports){
/*
    StringExpression class
*/
"use strict";

var context = require( '../context.js' );
var StringLiteral = require( './path/literals/stringLiteral.js' );
var PathExpression = require( './path/pathExpression.js' );
var expressionsUtils = require( './expressionsUtils.js' );

var StringExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){
        
        var result = '';
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            result += expression.evaluate( scope );
        }
        
        return result;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

StringExpression.removePrefix = true;
StringExpression.getPrefix = function() {
    return context.getConf().stringExpression;
};
StringExpression.getId = StringExpression.getPrefix;

StringExpression.build = function( string ) {
    var STATE_SCANNING = 0;
    var STATE_AT_DOLLAR = 1;
    var STATE_IN_EXPRESSION = 2;
    var STATE_IN_BRACKETED_EXPRESSION = 3;

    var expressionList = [];
    var literal = '';
    var subexpression = '';
    var state = STATE_SCANNING;

    for ( var i = 0; i < string.length; i++ ) {
        var ch = string.charAt( i );

        switch ( state ) {
                
        // In the string part of the expression
        case STATE_SCANNING:
            // Found a dollar sign
            if ( ch === '$' ) {
                state = STATE_AT_DOLLAR;
                
            // Just keep appending to buffer
            } else {
                literal += ch;
            }
            break;

        // Next character after dollar sign
        case STATE_AT_DOLLAR:
            // An escaped dollar sign
            if ( ch === '$' ) {
                literal += '$';
                state = STATE_SCANNING;
                
            // Beginning of a bracketed expression
            } else if ( ch === '{' ) {
                // Reset subexpression and change state
                subexpression = '';
                state = STATE_IN_BRACKETED_EXPRESSION;

                // Add literal and reset it if needed
                if ( literal ){
                    expressionList.push( 
                            new StringLiteral( literal ) 
                    );
                    literal = '';
                }
                
            // Beginning of a non bracketed expression
            } else {
                subexpression += ch;
                state = STATE_IN_EXPRESSION;
                
                // Add literal and reset it if needed
                if ( literal ){
                    expressionList.push( 
                            new StringLiteral( literal )
                    );
                    literal = '';
                }
            }
            break;

        // In subexpression
        case STATE_IN_BRACKETED_EXPRESSION:
        case STATE_IN_EXPRESSION:
            // Check for end
            if ( ( state === STATE_IN_BRACKETED_EXPRESSION && ch === '}' )
                    || ( state === STATE_IN_EXPRESSION && ch == ' ' ) ) {
                expressionList.push( 
                        PathExpression.build( subexpression ) 
                );

                if ( state === STATE_IN_EXPRESSION ) {
                    literal += ch;
                }
                state = STATE_SCANNING;
                
            // Keep appending to subexpression
            } else {
                subexpression += ch;
            }
        }
    }

    // Ended in unclosed bracket
    if ( state === STATE_IN_BRACKETED_EXPRESSION ) {
        throw 'Unclosed left curly brace: ' + string;
        
    // Ended at expression
    } else if ( state == STATE_IN_EXPRESSION ) {
        expressionList.push( 
                PathExpression.build( subexpression ) 
        );
    }

    if ( literal ){
        expressionList.push( 
                new StringLiteral( literal ) 
        );
    }

    return new StringExpression( string, expressionList );
};

module.exports = StringExpression;

},{"../context.js":27,"./expressionsUtils.js":48,"./path/literals/stringLiteral.js":61,"./path/pathExpression.js":63}],71:[function(require,module,exports){
/* 
    I18n class 
    External dependencies: Intl (supported by recent browsers) and MessageFormat
*/
module.exports = function( languageId, res ) {
    "use strict";
    
    var MessageFormat = require( 'messageformat' );
    var context = require( '../context.js' );
    var utils = require( '../utils.js' );
    
    var resources = res;
    var mf = new MessageFormat( languageId );
    var cache = {};
    var numberFormatCache = {};
    var dateTimeFormatCache = {};
    /*var CONF_RESOURCE_ID = '/CONF/';*/
    var CONF_RESOURCE_ID = context.getConf().i18nConfResourceId;
    
    var getLanguage = function(){
        //return resources[ context.getConf().i18nConfResourceId ].language;
        return resources[ CONF_RESOURCE_ID ].language;
    };
    
    var getLocale = function(){
        //return resources[ context.getConf().i18nConfResourceId ].locale;
        return resources[ CONF_RESOURCE_ID ].locale;
    };
    
    var exists = function( id ) {
        return resources[ id ] !== undefined;
    };
    
    var tr = function( id, params, format, subformat ) {
        
        switch ( format ) {
        case 'string':
            return trString( id, params );
        case 'number':
            return trNumber( id, params );
        case 'currency':
            return trCurrency( id, params, subformat );
        case 'datetime':
            return trDateTime( id, params );
        } 
        
        throw 'I18n format type not supported: ' + format;
    };
    
    var trString = function( id, params ) {
        
        var mfunc = cache[ id ];
        
        if ( ! mfunc ){
            mfunc = mf.compile( resources[ id ] );
            cache[ id ] = mfunc;
        }
        
        return mfunc( params );
    };
    
    var getSource = function( params ){
        
        return params && utils.isFunction( params.toSource )?
            params.toSource():
            '';
    };
    
    var trNumber = function( value, params ) {
        
        var source = getSource( params );
        var numberFormat = numberFormatCache[ source ];
        
        if ( ! numberFormat ){
            numberFormat = new Intl.NumberFormat( getLocale(), params );
            numberFormatCache[ source ] = numberFormat;
        }
        
        return numberFormat.format( value );
    };
    
    var trCurrency = function( value, params, theCurrency ) {
        
        params.style = 'currency';
        params.currency = theCurrency;
        
        return trNumber( value, params );
    };
    
    var trDateTime = function( value, params ) {
        
        var source = getSource( params );
        var dateTimeFormat = dateTimeFormatCache[ source ];
        
        if ( ! dateTimeFormat ){
            dateTimeFormat = new Intl.DateTimeFormat( getLocale(), params );
            dateTimeFormatCache[ source ] = dateTimeFormat;
        }
        
        return dateTimeFormat.format( value );
    };
    
    return {
        getLanguage: getLanguage,
        getLocale: getLocale,
        exists: exists,
        tr: tr
    };
};

},{"../context.js":27,"../utils.js":101,"messageformat":4}],72:[function(require,module,exports){
/* 
    I18nBundle class 
*/
module.exports = function( ) {
    "use strict";
    
    var i18nList = {};
    var first = undefined;

    var add = function( i18n ){
        i18nList[ i18n.getLanguage() ] = i18n;
        if ( ! first ){
            first = i18n;
        }
    };
    
    var exists = function( id ){
        return first.exists( id );
    };
    
    var tr = function( id, params, format, subformat, language ) {
        
        if ( ! language ){
            throw 'Language not defined! Please, use data-iLanguage to define it before trying to translate anything!';
        }
        
        var i18n = i18nList[ language ];
        
        if ( ! i18n ){
            throw 'Language "' + language + '" not found in I18nBundle!';
        }
        
        return i18n.tr( id, params, format, subformat );
    };

    // Init!
    for ( var c = 0; c < arguments.length; c++ ) {
        add( arguments[ c ] );
    }
    
    return {
        add: add,
        exists: exists,
        tr: tr
    };
};

},{}],73:[function(require,module,exports){
/* 
    i18nHelper singleton class 
*/
var utils = require( '../utils.js' );
var I18n = require( './i18n.js' );
var context = require( '../context.js' );

module.exports = (function() {
    "use strict";
    
    var tr = function ( i18nList, id, params, format, subformat, language ){
        
        if ( ! i18nList ) {
            return 'No I18n instance defined!';
        }
            
        var length = i18nList.length;
        if ( ! length ){
            return 'Void I18n list!';
        }

        for ( var i = 0; i < length; i++ ) {
            var i18n = i18nList[ i ];
            if ( format !== 'string' || i18n.exists( id ) ){
                return i18n.tr( id, params, format, subformat, language );
            }
        }
        
        return 'I18n resource "' + id + '" not found!';
    };
    
    var loadAsync = function( remoteList, callback, failCallback ){
        
        loadAsyncItem( 
            {}, 
            callback, 
            failCallback,
            remoteList, 
            remoteList.length - 1 );
    };
    
    var loadAsyncItem = function( map, callback, failCallback, remoteList, currentIndex ){
        
        var url = remoteList[ currentIndex ];
        utils.getJSON( 
            {
                url: url,
                done: function( data ) {
                    map[ url ] = data;
                    if ( currentIndex > 0 ){
                        loadAsyncItem( 
                            map, 
                            callback, 
                            failCallback,
                            remoteList, 
                            --currentIndex );
                    } else {
                        callback( map );
                    }
                },
                fail: function( jqxhr, textStatus, error ) {
                    context.asyncError( url, error, failCallback );
                }
            }
        );
    };
    /*
    var loadAsyncItem = function( map, callback, failCallback, remoteList, currentIndex ){
        
        var url = remoteList[ currentIndex ];
        $.getJSON( url )
            .done(
                function( data ) {
                    map[ url ] = data;
                    if ( currentIndex > 0 ){
                        loadAsyncItem( 
                            map, 
                            callback, 
                            failCallback,
                            remoteList, 
                            --currentIndex );
                    } else {
                        callback( map );
                    }
                }
            )
            .fail(
                function( jqxhr, textStatus, error ) {
                    context.asyncError( url, error, failCallback );
                }
            );
    };
    */
    
    var loadAsyncAuto = function( dictionary, i18n, callback, failCallback ){
        
        // Return if it is nothing to do
        if ( ! i18n || ! i18n.files || ! Object.keys( i18n.files ).length ){
            callback();
            return;
        }
        
        // Build jsonFiles array
        var numberOfLanguages = Object.keys( i18n.files ).length;
        var jsonFiles = [];
        var urlPrefix = i18n.urlPrefix || '';
        for ( var lang in i18n.files ){
            var langFiles = i18n.files[ lang ];
            for ( var index in langFiles ){
                var file = langFiles[ index ];
                var url = urlPrefix + file;
                jsonFiles.push( url );
            }
        }
        
        // Use loadAsync method to load all jsonFiles; then register I18n instances and arrays
        loadAsync( 
            jsonFiles, 
            function( i18nMap ){
                
                for ( var lang in i18n.files ){
                    var langFiles = i18n.files[ lang ];
                    var i18nInstanceArray = [];
                    
                    // Register array vars
                    dictionary[ buildI18nInstanceArrayName( lang ) ] = i18nInstanceArray;
                    if ( numberOfLanguages === 1 ){
                        dictionary[ 'i18nArray' ] = i18nInstanceArray;
                    }
                    
                    for ( var index in langFiles ){
                        var file = langFiles[ index ];
                        var url = urlPrefix + file;
                        var i18nInstance = new I18n( lang, i18nMap[ url ] );
                        
                        // Register i18n instances
                        dictionary[ buildI18nInstanceName( file ) ] = i18nInstance;
                        i18nInstanceArray.unshift( i18nInstance ); // Add to the beginning of the array
                    }
                }
                
                callback();
            },
            failCallback 
        );
    };
    
    var buildI18nInstanceArrayName = function( lang ){
        return 'i18n' + lang.toUpperCase() + 'Array';
    };
    
    var buildI18nInstanceName = function( file ){
        
        var fileWithoutExtension = file.substr( 0, file.lastIndexOf( '.' ) );
        return 'i18n' + fileWithoutExtension.toUpperCase();
    };

    return {
        tr: tr,
        loadAsync: loadAsync,
        loadAsyncAuto: loadAsyncAuto
    };
})();

},{"../context.js":27,"../utils.js":101,"./i18n.js":71}],74:[function(require,module,exports){
/*
    logHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( './context.js' );
    
    var trace = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.trace.apply( logger, arguments );
    };
    
    var debug = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.debug.apply( logger, arguments );
    };
    
    var info = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.info.apply( logger, arguments );
    };
    
    var warn = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.warn.apply( logger, arguments );
    };
    
    var error = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.error.apply( logger, arguments );
    };
    
    var fatal = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.fatal.apply( logger, arguments );
    };
    
    /*
    var fatalAndThrow = function ( message ){
        
        fatal.apply( this, arguments );
        throw message;
    };*/
    
    return {
        trace: trace,
        debug: debug,
        info: info,
        warn: warn,
        error: error,
        fatal: fatal
        //fatalAndThrow: fatalAndThrow
    };
})();

},{"./context.js":27}],75:[function(require,module,exports){
/*
    Exported functions
*/
exports.run = function( options ){
    
    var parser = require( './parsers/parser.js' );
    return parser.run( options );
};

/* Declare exports */
exports.I18n = require( './i18n/i18n.js' );
exports.I18nBundle = require( './i18n/i18nBundle.js' );
exports.i18nHelper = require( './i18n/i18nHelper.js' );
exports.context = require( './context.js' );
exports.logHelper = require( './logHelper.js' );
exports.expressionBuilder = require( './expressions/expressionBuilder.js' );
exports.evaluateHelper = require( './expressions/evaluateHelper.js' );
exports.ExpressionTokenizer = require( './expressions/expressionTokenizer.js' );
exports.ReactiveDictionary = require( './scopes/reactiveDictionary.js' );
exports.version = require( './version.js' );

/* Support RequireJS module pattern */
if ( typeof define === 'function' && define.amd ) {
    define( 'zpt.run', exports.run );
    define( 'zpt.I18n', exports.I18n );
    define( 'zpt.I18nBundle', exports.I18nBundle );
    define( 'zpt.i18nHelper', exports.i18nHelper );
    define( 'zpt.context', exports.context );
    define( 'zpt.logHelper', exports.logHelper );
    define( 'zpt.expressionBuilder', exports.expressionBuilder );
    define( 'zpt.evaluateHelper', exports.evaluateHelper );
    define( 'zpt.ExpressionTokenizer', exports.ExpressionTokenizer );
    define( 'zpt.ReactiveDictionary', exports.ReactiveDictionary );
    define( 'zpt.version', exports.version );
}

},{"./context.js":27,"./expressions/evaluateHelper.js":44,"./expressions/expressionBuilder.js":46,"./expressions/expressionTokenizer.js":47,"./i18n/i18n.js":71,"./i18n/i18nBundle.js":72,"./i18n/i18nHelper.js":73,"./logHelper.js":74,"./parsers/parser.js":92,"./scopes/reactiveDictionary.js":98,"./version.js":102}],76:[function(require,module,exports){
/* 
    Class AutoDefineHelper 
*/
var context = require( '../context.js' );
var TALDefine = require( '../attributes/TAL/talDefine.js' );

module.exports = function ( node ) {
    "use strict";
    
    var defineDelimiter = context.getConf().defineDelimiter;
    var inDefineDelimiter = context.getConf().inDefineDelimiter;
    var nocallExpressionPrefix = context.getConf().nocallVariableExpressionPrefix;
    var talAutoDefine = context.getTags().talAutoDefine;

    var buffer = '';
    if ( node && node.getAttribute( talAutoDefine ) ){
        buffer = node.getAttribute( talAutoDefine );
    }
    
    var put = function( name, string, nocall ){
        
        if ( buffer !== '' ){
            buffer += defineDelimiter;
        }
        buffer += (nocall? nocallExpressionPrefix + inDefineDelimiter: '') + name + inDefineDelimiter + string;
    };

    var updateNode = function( node ){

        if ( buffer ){
            node.setAttribute( talAutoDefine, buffer );
            return buffer;
        }
    };
    
    return {
        put: put,
        updateNode: updateNode
    };
};

},{"../attributes/TAL/talDefine.js":18,"../context.js":27}],77:[function(require,module,exports){
/* 
    Class DepsDataItem 
*/
"use strict";

var DepsDataItem = function() {
    
    this.nonExpressionVars = {};
    this.expressionVars = {};
};

DepsDataItem.prototype.mustAddVar = function( varName ){
    return this.nonExpressionVars[ varName ] === undefined && this.expressionVars[ varName ] === undefined;
};

DepsDataItem.prototype.addAllVars = function( varNames, scope ){
    
    for ( var name in varNames ){
        this.add1Var( varNames[ name ], scope );
    }
};

DepsDataItem.prototype.add1ExpressionVar = function( varName ){
    this.expressionVars[ varName ] = true;
};

DepsDataItem.prototype.add1NonExpressionVar = function( varName ){
    this.nonExpressionVars[ varName ] = true;
};

DepsDataItem.prototype.add1Var = function( varName, scope ){

    var map = scope.isLocalVar( varName )? this.expressionVars: this.nonExpressionVars;
    map[ varName ] = true;

    return true;
};

module.exports = DepsDataItem;

},{}],78:[function(require,module,exports){
/* 
    Class AbstractAction
*/
"use strict";

var utils = require( '../../utils.js' );
var context = require( '../../context.js' );

var AbstractAction = function( object, dictionary ) {
    
    this.id = object.id;
    this.var = object.var;
    this.currentElement = object.currentElement;
    this.animation = object.animation;
    this.animationCallback = object.animationCallback;
    if ( object.search ){
        if ( this.id || this.var ){
            throw 'Error in action: you can not set a search and then and id: if you set a search ZPT-JS will set the id for you!';
        }
        this.initializeUsingSearch( object.search, dictionary );
    }
};

AbstractAction.prototype.initializeUsingSearch = function( search, dictionary ){

    this.id = '';
    this.var = dictionary;
    
    // Iterate search items and build id and var
    for ( var i = 0; i < search.length; ++i ){
        var item = search[ i ];
        
        // Replace item is it a search object, '_first_' or '_last_'
        if ( utils.isPlainObject( item ) ){
            item = this.search( this.var, item );
        } else if ( item === context.getConf().firstIndexIdentifier ){
            item = 0;
        } else if ( item === context.getConf().lastIndexIdentifier ){
            item = this.var.length - 1;
        }
        
        // Build the id
        if ( Number.isInteger( item ) ){
            this.id += '[' + item + ']';
        } else {
            var separator = i === 0? '': '.';
            this.id += separator + item;
        }
        
        // Build the var
        this.var = this.var[ item ];
    }
};

AbstractAction.prototype.search = function( list, expressionElement ){
    
    for ( var i = 0; i < list.length; ++i ){
        var record = list[ i ];
        if ( AbstractAction.elementMaches( record, expressionElement ) ){
            return i;
        }
    }
    
    throw 'No record found matching your criteria!';
};

AbstractAction.elementMaches = function( element, expressionElement ){
    
    if ( expressionElement == undefined ){
        throw 'Expression to match must not be null!';
    }

    if ( Array.isArray( expressionElement ) ){
        throw 'Expression ' + utils.genericToString( expressionElement ) + ' to match must not be an array!';
    }

    if ( utils.isPlainObject( expressionElement ) ){
        for ( var i in expressionElement ){
            if ( expressionElement[ i ] !== element[ i ] ){
                return false;
            }
        }
        return true;
    }

    // Must be numeric or string
    return element === expressionElement;
};

AbstractAction.prototype.getValue = function( dictionary ){
    return this.var === undefined?
        dictionary[ this.id ]:
        this.var;
};

AbstractAction.prototype.resolveThisNode = function( indexItem, parserUpdater ){
    
    //var attributeInstance = indexItem.attributeInstance;
    var node = parserUpdater.findNodeById( indexItem.nodeId );
    if ( ! node ){
        // Removed node!
        parserUpdater.addRemovedToStatistics();
        return false;
    }
    parserUpdater.addUpdatedToStatistics();
    
    // Return the node
    return node;
};

AbstractAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    throw 'Error: attributeInstanceIsRelated must be implemented!';
};

AbstractAction.prototype.updateDictionary = function(){
    throw 'Error: updateDictionary must be implemented!';
};

AbstractAction.prototype.updateHTML = function(){
    throw 'Error: updateHTML must be implemented!';
};

module.exports = AbstractAction;

},{"../../context.js":27,"../../utils.js":101}],79:[function(require,module,exports){
/* 
    Class AbstractArrayAction
*/
"use strict";

var AbstractAction = require( './abstractAction.js' );
var utils = require( '../../utils.js' );
var context = require( '../../context.js' );

var AbstractArrayAction = function( object, dictionary ) {
    AbstractAction.call( this, object, dictionary );
    
    this.index = object.index;
};

AbstractArrayAction.prototype = Object.create( AbstractAction.prototype );

AbstractArrayAction.getIndexNumericValue = function( index ){
    
    if ( index === undefined ){
        return undefined;   
    }
    
    if ( index === context.getConf().firstIndexIdentifier ){
        return 0;
    } else if ( index === context.getConf().lastIndexIdentifier ){
        return -1; // This means it is the last
    }
    return index;
};

AbstractArrayAction.prototype.getIndexNumericValue = function(){
    return AbstractArrayAction.getIndexNumericValue( this.index );
};

AbstractArrayAction.prototype.getIndexToUse = function( dictionary ){

    if ( this.index === undefined && this.currentElement === undefined ){
        throw 'index or currentElement must be defined in ' + this.id + ' array action!';
    }
    
    // Check if it uses the index
    var indexNumericValue = this.getIndexNumericValue();
    if ( indexNumericValue !== undefined ){
        return indexNumericValue;
    }

    // Must use currentElement
    var arrayValue = this.getValue( dictionary );
    
    for ( var i = 0; i < arrayValue.length; ++i ){
        var element = arrayValue[ i ];
        if ( AbstractAction.elementMaches( element, this.currentElement ) ){
            return i;
        }
    }
    
    throw 'currentElement ' + utils.genericToString( this.currentElement ) + ' not found in ' + this.id + ' array action!';
};

AbstractArrayAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    return AbstractArrayAction.staticAttributeInstanceIsRelated( attributeInstance );
};

AbstractArrayAction.staticAttributeInstanceIsRelated = function( attributeInstance ){
    return attributeInstance.type === 'tal:repeat';
};

AbstractArrayAction.prototype.updateDictionary = function(){
    throw 'Error: updateDictionary must be implemented!';
};

AbstractArrayAction.prototype.updateHTML = function(){
    throw 'Error: updateHTML must be implemented!';
};

AbstractArrayAction.prototype.resolveChildNode = function( indexItem, parserUpdater ){
    
    //var attributeInstance = indexItem.attributeInstance;
    var node = parserUpdater.findNodeById( indexItem.nodeId );
    if ( ! node ){
        // Removed node!
        parserUpdater.addRemovedToStatistics();
        return false;
    }
    parserUpdater.addUpdatedToStatistics();
    
    // Return the node
    return this.indexToUse === -1?
        null:
        this.getIndexOfLoop( node.parentNode, indexItem.nodeId, this.indexToUse );
};

AbstractArrayAction.prototype.getIndexOfLoop = function( parentNode, nodeId, indexInLoop ){
    
    var numberOfChildren = parentNode.childElementCount;
    for ( var i = 0; i < numberOfChildren; ++i ){
        var childNode = parentNode.children[ i ];
        var currentNodeId = childNode.getAttribute( context.getTags().id );
        if ( currentNodeId === nodeId ){
            return parentNode.children[ 1 + i + indexInLoop ];
        }
    }
    
    return null;
};

module.exports = AbstractArrayAction;

},{"../../context.js":27,"../../utils.js":101,"./abstractAction.js":78}],80:[function(require,module,exports){
/* 
    Class AbstractObjectAction
*/
"use strict";

var AbstractAction = require( './abstractAction.js' );

var AbstractObjectAction = function( object, dictionary ) {
    AbstractAction.call( this, object, dictionary );
    
    this.property = object.property;
    this.id += '.' + object.property;
};

AbstractObjectAction.prototype = Object.create( AbstractAction.prototype );

AbstractObjectAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    return true;
};

AbstractObjectAction.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the node
    var node = this.resolveThisNode( indexItem, parserUpdater );
    if ( ! node ){
        throw 'No node found to update';
    }
    
    // Update the selected node
    parserUpdater.updateNode( node );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, node );
    
    return true;
};

module.exports = AbstractObjectAction;

},{"./abstractAction.js":78}],81:[function(require,module,exports){
/* 
    Class ArrayCreate
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );
var context = require( '../../context.js' );
var ParserNodeRenderer = require( '../../parsers/parserNodeRenderer.js' );
var utils = require( '../../utils.js' );

var ArrayCreate = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ArrayCreate.prototype = Object.create( AbstractArrayAction.prototype );

ArrayCreate.prototype.updateDictionary = function( dictionary ){
    
    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    
    if ( this.indexToUse === -1 ){
        this.resolvedIndex = arrayValue.length;
        arrayValue.push( this.newElement );
    } else {
        this.resolvedIndex = this.indexToUse;
        arrayValue.splice( this.indexToUse, 0, this.newElement );
    }
};

ArrayCreate.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the nodeToUpdate
    var node = this.resolveThisNode( indexItem, parserUpdater );
    if ( ! node ){
        throw 'No node found to clone';
    }
    
    // Init some vars
    var tags = context.getTags();
    var parentNode = node.parentNode;
    
    // Clone and configure the node
    var tmpNode = ParserNodeRenderer.cloneAndConfigureNode( 
        node, 
        true, 
        tags, 
        node.getAttribute( tags.id ) 
    );
    ParserNodeRenderer.configureNodeForNewItem( 
        tmpNode, 
        tags, 
        parentNode, 
        indexItem, 
        this.resolvedIndex
    );
    
    // Insert it
    var sibling = this.indexToUse === -1?
        null:
        parentNode.children[ 1 + this.indexToUse ];
    parentNode.insertBefore( tmpNode, sibling );
    
    // Update the selected node
    parserUpdater.updateNode( tmpNode );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, tmpNode );
    
    return true;
};

ArrayCreate.buildMultiple = function( object, dictionary ){

    var actions = [];
    
    // Copy newElements to a new array
    var newElements = utils.copyArray( object.newElement );
    
    // Configure the object, create the first instance and add it to the list
    object.newElement = newElements[ 0 ];
    var firstActionInstance = new ArrayCreate( object, dictionary );
    actions.push( firstActionInstance );
    
    // Get the firstIndex and if the new elments must be the last
    var firstIndex = firstActionInstance.getIndexNumericValue();
    var isLast = -1 === firstIndex;
        
    // Build actions list
    for ( var i = 1; i < newElements.length; ++i ){
        var newElement = newElements[ i ];
        
        // Clone the object and configure the newElement and the index
        var newObject = utils.deepExtend( object );
        newObject.newElement = newElement;
        newObject.index = isLast?
            -1:
            firstIndex + i;
        
        // Instance the action instance and add it to the list
        var newActionInstance = new ArrayCreate( newObject, dictionary );
        actions.push( newActionInstance );
    }
    
    return actions;
};

module.exports = ArrayCreate;

},{"../../context.js":27,"../../parsers/parserNodeRenderer.js":93,"../../utils.js":101,"./abstractArrayAction.js":79}],82:[function(require,module,exports){
/* 
    Class ArrayDelete
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );
var utils = require( '../../utils.js' );
var attributeIndex = require( '../../attributes/attributeIndex.js' );
var nodeRemover = require( '../nodeRemover.js' );

var ArrayDelete = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
};

ArrayDelete.prototype = Object.create( AbstractArrayAction.prototype );

ArrayDelete.prototype.updateDictionary = function( dictionary ){

    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    arrayValue.splice( this.indexToUse, 1 );
};

ArrayDelete.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance, continueData ){
    
    // Must get the nodeToUpdate
    var nodeToDelete = this.resolveChildNode( indexItem, parserUpdater );
    if ( ! nodeToDelete ){
        throw 'No node found to be deleted at this index: ' + this.indexToUse;
    }
    
    // Run animation
    parserUpdater.runAnimation( 
        actionInstance, 
        nodeToDelete, 
        function(){
            
            // Remove the selected node from the index and from HTML
            //attributeIndex.removeNode( nodeToDelete ); 
            nodeRemover.removeNode( nodeToDelete );
            //TODO update next siblings?
            
            // Continue
            parserUpdater.continueUpdateHTML( continueData );
        } 
    );
    
    //return true;
    return false;
};

ArrayDelete.buildMultiple = function( object, dictionary ){

    var actions = [];
    var property = object.index? 'index': 'currentElement';

    // Copy indexes to a new array
    var allItems = utils.copyArray( object[ property ] );
    
    // Build actions list
    for ( var i = 0; i < allItems.length; ++i ){
        var item = allItems[ i ];
        
        // Clone the object and configure the index
        var newObject = utils.deepExtend( object );
        newObject[ property ] = item;
        
        // Instance the action instance and add it to the list
        var newActionInstance = new ArrayDelete( newObject, dictionary );
        newActionInstance.index = newActionInstance.getIndexToUse( dictionary );
        actions.push( newActionInstance );
    }
    
    // Sort actions
    actions.sort(
        function( a, b ){ return b.index - a.index; }
    );
    
    return actions;
};

module.exports = ArrayDelete;

},{"../../attributes/attributeIndex.js":23,"../../utils.js":101,"../nodeRemover.js":91,"./abstractArrayAction.js":79}],83:[function(require,module,exports){
/* 
    Class ArrayUpdate
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );

var ArrayUpdate = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ArrayUpdate.prototype = Object.create( AbstractArrayAction.prototype );

ArrayUpdate.prototype.updateDictionary = function( dictionary ){
    
    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    arrayValue[ this.indexToUse ] = this.newElement;
};

ArrayUpdate.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the nodeToUpdate
    var nodeToUpdate = this.resolveChildNode( indexItem, parserUpdater );
    if ( ! nodeToUpdate ){
        throw 'No node found to be updated at this index: ' + this.indexToUse;
    }
    
    // Update the selected node
    parserUpdater.updateNode( nodeToUpdate, true );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, nodeToUpdate );
    
    return true;
};

module.exports = ArrayUpdate;

},{"./abstractArrayAction.js":79}],84:[function(require,module,exports){
/* 
    Class CSSAnimationManager 
*/
"use strict";

module.exports = (function() {
    
    var animate = function( dictionaryAction, node, callback ) {
        
        // Run callback and return if there is no animation
        if ( ! dictionaryAction.animation ){
            if ( callback ){
                callback();
            };
            return;
        }
        
        // Set the animation
        node.style.animation = 'none';
        setTimeout(
            function() {
                // Set the animationend listener
                var animationendCallback = function( event ){
                    if ( callback ){
                        callback();
                    }
                };
                //node.removeEventListener( 'animationend', animationendCallback );
                node.addEventListener( 'animationend', animationendCallback );

                // Set the animation
                node.style.animation = dictionaryAction.animation;
            }, 
            10
        );
    };
    
    var reset = function( node ) {
        node.style.animation = 'none';
    };
    
    var self = {
        animate: animate,
        reset: reset
    };
    
    return self;
})();

},{}],85:[function(require,module,exports){
/* 
    Class dictionaryActionBuilder 
*/
"use strict";

var ArrayUpdate = require( './arrayUpdate.js' );
var ArrayDelete = require( './arrayDelete.js' );
var ArrayCreate = require( './arrayCreate.js' );
var ObjectUpdate = require( './objectUpdate.js' );
var ObjectDelete = require( './objectDelete.js' );

module.exports = (function() {
    
    var build = function( object, dictionary ) {
        
        switch ( object.action ) {
        case 'updateArray':
            return new ArrayUpdate( object, dictionary );
        case 'deleteArray':
            return Array.isArray( object.index ) || Array.isArray( object.currentElement )? 
                ArrayDelete.buildMultiple( object, dictionary ):
                new ArrayDelete( object, dictionary );
        case 'createArray':
            return Array.isArray( object.newElement )? 
                ArrayCreate.buildMultiple( object, dictionary ):
                new ArrayCreate( object, dictionary );
        case 'updateObject':
            return object.editedProperties || object.deletedProperties?
                ObjectUpdate.buildMultiple( object, dictionary ):
                new ObjectUpdate( object, dictionary );
        case 'deleteObject':
            return new ObjectDelete( object, dictionary );
        default:
            throw 'Unknown dictionary action: ' + object.action;
        }
    };
    
    var self = {
        build: build
    };
    
    return self;
})();

},{"./arrayCreate.js":81,"./arrayDelete.js":82,"./arrayUpdate.js":83,"./objectDelete.js":86,"./objectUpdate.js":87}],86:[function(require,module,exports){
/* 
    Class ObjectDelete
*/
"use strict";

var AbstractObjectAction = require( './abstractObjectAction.js' );

var ObjectDelete = function( object, dictionary ) {
    AbstractObjectAction.call( this, object, dictionary );
};

ObjectDelete.prototype = Object.create( AbstractObjectAction.prototype );

ObjectDelete.prototype.updateDictionary = function( dictionary ){
    
    var objectValue = this.getValue( dictionary );
    delete objectValue[ this.property ];
};

module.exports = ObjectDelete;

},{"./abstractObjectAction.js":80}],87:[function(require,module,exports){
/* 
    Class ObjectUpdate
*/
"use strict";

var AbstractObjectAction = require( './abstractObjectAction.js' );
var ObjectDelete = require( './objectDelete.js' );
var utils = require( '../../utils.js' );

var ObjectUpdate = function( object, dictionary ) {
    AbstractObjectAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ObjectUpdate.prototype = Object.create( AbstractObjectAction.prototype );

ObjectUpdate.prototype.updateDictionary = function( dictionary ){
    
    var objectValue = this.getValue( dictionary );
    objectValue[ this.property ] = this.newElement;
};

ObjectUpdate.buildMultiple = function( object, dictionary ){

    var actions = [];
    var clonedObject = utils.deepExtend( object );
    
    // Copy editedProperties and deletedProperties
    var editedProperties = clonedObject.editedProperties;
    var deletedProperties = clonedObject.deletedProperties;
    
    // Delete them
    delete clonedObject.editedProperties;
    delete clonedObject.deletedProperties;
        
    // Build actions list for editedProperties
    if ( editedProperties ){
        clonedObject.action = 'updateObject';
        for ( var editedPropertiesId in editedProperties ){
            var editedPropertiesValue = editedProperties[ editedPropertiesId ];

            // Clone the object and configure property and newElement
            var newObject = utils.deepExtend( clonedObject );
            newObject.property = editedPropertiesId;
            newObject.newElement = editedPropertiesValue;

            // Instance the action instance and add it to the list
            var newActionInstance = new ObjectUpdate( newObject, dictionary );
            actions.push( newActionInstance );
        }
    }
    
    // Build actions list for deletedProperties
    if ( deletedProperties ){
        clonedObject.action = 'deleteObject';
        for ( var i = 0; i < deletedProperties.length; ++i ){
            var deletedPropertiesItem = deletedProperties[ i ];

            // Clone the object and configure property
            newObject = utils.deepExtend( clonedObject );
            newObject.property = deletedPropertiesItem;

            // Instance the action instance and add it to the list
            newActionInstance = new ObjectDelete( newObject, dictionary );
            actions.push( newActionInstance );
        }
    }
    
    return actions;
};

module.exports = ObjectUpdate;

},{"../../utils.js":101,"./abstractObjectAction.js":80,"./objectDelete.js":86}],88:[function(require,module,exports){
/* 
    Class Loop 
*/
"use strict";

var AutoDefineHelper = require( './autoDefineHelper.js' );
var expressionBuilder = require( '../expressions/expressionBuilder.js' );
var context = require( '../context.js' );

var Loop = function ( _itemVariableName, _expressionString, scope ) {
    
    var itemVariableName = _itemVariableName;
    var expressionString = _expressionString;
    
    var expression = expressionBuilder.build( expressionString );
    var getExpression = function(){
        return expression;
    };
    
    var items = expression.evaluate( scope );
    var getItems = function(){
        return items;
    };
    
    var currentIndex = -1;
    var maxIndex = items? items.length - 1: -1;
    
    var offset = 0;
    var setOffset = function( _offset ){
        offset = _offset;
    };
    
    var repeat = function(){
        
        if ( currentIndex++ < maxIndex ) {
            
            return Loop.buildAutoDefineHelper( 
                itemVariableName, 
                currentIndex, 
                expressionString, 
                items.length, 
                offset 
            );
        }
        
        return null;
    };
    
    return {
        setOffset: setOffset,
        repeat:repeat,
        getItems: getItems,
        getExpression: getExpression
    };
};

Loop.buildAutoDefineHelper = function( itemVariableName, itemIndex, expressionString, numberOfItems, offset ){
    
    var autoDefineHelper = new AutoDefineHelper();

    // Declare item-index, item-all, item and item-repeat variables
    autoDefineHelper.put(
        itemVariableName + '-index',
        itemIndex
    );
    autoDefineHelper.put(
        itemVariableName + '-all',
        expressionString
    );
    autoDefineHelper.put(
        itemVariableName,
        itemVariableName + '-all' + '[' + itemVariableName + '-index' + ']'
    );
    autoDefineHelper.put(
        itemVariableName + '-repeat',
        "context/repeat(" 
            + itemVariableName + "-index" + ","
            + numberOfItems + ","
            + offset
            + ")"
    );

    return autoDefineHelper;
};

Loop.setAutoDefineAttribute = function( node, itemVariableName, itemIndex, expressionString, numberOfItems, offset ){
    
    // Set item-index, item-all, item and item-repeat attributes
    node.setAttribute( 
        context.getTags().talAutoDefine,
        itemVariableName + '-index ' + itemIndex + ';'
            + itemVariableName + '-all ' + expressionString + ';'
            + itemVariableName + ' ' + itemVariableName +'-all[' + itemVariableName + '-index];'
            + itemVariableName + '-repeat context/repeat(' + itemVariableName + '-index,' + numberOfItems + ',' + offset + ')'
    );
};

module.exports = Loop;

},{"../context.js":27,"../expressions/expressionBuilder.js":46,"./autoDefineHelper.js":76}],89:[function(require,module,exports){
/* 
    Class LoopItem
*/
"use strict";

var LoopItem = function ( _currentIndex, _itemsLength, _offset ) {
    
    this.currentIndex = _currentIndex;
    this.itemsLength = _itemsLength;
    this.offset = _offset;
};

LoopItem.prototype.index = function( ) {
    return this.offset + this.currentIndex;
};

LoopItem.prototype.number = function( ) {
    return this.index() + 1;
};

LoopItem.prototype.even = function( ) {
    return this.index() % 2 === 0;
};

LoopItem.prototype.odd = function ( ) {
    return this.index() % 2 === 1;
};

LoopItem.prototype.start = function ( ) {
    return this.index() === 0;
};

LoopItem.prototype.end = function ( ) {
    return this.currentIndex === this.itemsLength - 1;
};

LoopItem.prototype.length = function () {
    return this.offset + this.itemsLength;
};

LoopItem.prototype.letter = function () {
    return this.formatLetter( this.index(), 'a' );
};

LoopItem.prototype.Letter = function () {
    return this.formatLetter( this.index(), 'A' );
};

LoopItem.prototype.formatLetter = function ( ii, startChar ) {
    var i = ii;
    var buffer = '';
    var start = startChar.charCodeAt( 0 ); 
    var digit = i % 26;
    buffer += String.fromCharCode( start + digit );

    while( i > 25 ) {
        i /= 26;
        digit = (i - 1 ) % 26;
        buffer += String.fromCharCode( start + digit );
    }

    return buffer.split('').reverse().join('');
};

LoopItem.prototype.roman = function () {
    return this.formatRoman( this.index() + 1, 0 );
};

LoopItem.prototype.Roman = function () {
    return this.formatRoman( this.index() + 1, 1 );
};

LoopItem.prototype.formatRoman = function ( nn, capital ) {
    var n = nn;

    // Can't represent any number 4000 or greater
    if ( n >= 4000 ) {
        return 'Overflow formatting roman!';
    }

    var buf = '';
    for ( var decade = 0; n !== 0; decade++ ) {
        var digit = n % 10;
        if ( digit > 0 ) {
            digit--;
            buf += this.romanArray [ decade ][ digit ][ capital ];
        }
        n = (n / 10) >> 0;
    }

    return buf.split( '' ).reverse().join( '' );
};

LoopItem.prototype.romanArray = [
    /* One's place */
    [
        [ "i", "I" ],
        [ "ii", "II" ], 
        [ "iii", "III" ],
        [ "vi", "VI" ],
        [ "v", "V" ],
        [ "iv", "IV" ],
        [ "iiv", "IIV" ],
        [ "iiiv", "IIIV" ],
        [ "xi", "XI" ]
    ],

    /* 10's place */
    [
        [ "x", "X" ],
        [ "xx", "XX" ],
        [ "xxx", "XXX" ],
        [ "lx", "LX" ],
        [ "l", "L" ],
        [ "xl", "XL" ],
        [ "xxl", "XXL" ],
        [ "xxxl", "XXXL" ],
        [ "cx", "CX" ]
    ],

    /* 100's place */
    [
        [ "c", "C" ],
        [ "cc", "CC" ],
        [ "ccc", "CCC" ],
        [ "dc", "DC" ],
        [ "d", "D" ],
        [ "cd", "CD" ],
        [ "ccd", "CCD" ],
        [ "cccd", "CCCD" ],
        [ "mc", "MC" ]
    ],

    /* 1000's place */
    [
        [ "m", "M" ],
        [ "mm", "MM" ],
        [ "mmm", "MMM" ]
    ]
];

module.exports = LoopItem;

},{}],90:[function(require,module,exports){
/* 
    Class NodeAttributes 
*/
"use strict";

var context = require( '../context.js' );

var NodeAttributes = function( node, indexExpressions ) {
    
    var tags = context.getTags();
    
    // tal namespace
    this.talDefine = node.getAttribute( tags.talDefine );
    this.talCondition = node.getAttribute( tags.talCondition );
    this.talRepeat = node.getAttribute( tags.talRepeat );
    this.talContent = node.getAttribute( tags.talContent );
    this.talAttributes = node.getAttribute( tags.talAttributes );
    this.talOmitTag = node.getAttribute( tags.talOmitTag );
    this.talReplace = node.getAttribute( tags.talReplace );
    this.talOnError = node.getAttribute( tags.talOnError );
    this.talDeclare = node.getAttribute( tags.talDeclare );
    //this.talTag = undefined;
    
    // metal namespace
    this.metalDefineMacro = node.getAttribute( tags.metalDefineMacro );
    this.metalUseMacro = node.getAttribute( tags.metalUseMacro );
    this.metalDefineSlot = node.getAttribute( tags.metalDefineSlot );
    this.metalFillSlot = node.getAttribute( tags.metalFillSlot );
    
    // i18n namespace
    this.i18nDomain = node.getAttribute( tags.i18nDomain );
    this.i18nLanguage = node.getAttribute( tags.i18nLanguage );
    
    // For internal use
    this.qdup = node.getAttribute( tags.qdup );
    
    // Init this.id and set the node id if indexExpressions is true, some attribute is set and it is undefined
    if ( indexExpressions && this.isDynamicContentOn() ){
        this.id = node.getAttribute( tags.id );
        if ( ! this.id ){
            //this.id = utils.generateId( 6 );
            this.id = context.nextExpressionCounter();
            node.setAttribute( tags.id, this.id );
        }
    }
};

NodeAttributes.prototype.isDynamicContentOn = function() {
    
    return this.talDefine 
        || this.talCondition
        || this.talRepeat
        || this.talContent
        || this.talAttributes
        || this.talOmitTag 
        || this.talReplace
        || this.talOnError
        || this.talDeclare
        //|| this.talTag
        //|| this.metalDefineMacro 
        || this.metalUseMacro 
        //|| this.metalDefineSlot 
        || this.metalFillSlot 
        || this.i18nDomain
        || this.i18nLanguage;
        //|| this.qdup;
};

module.exports = NodeAttributes;

},{"../context.js":27}],91:[function(require,module,exports){
/* 
    Class NodeRemover 
*/
"use strict";

var context = require( '../context.js' );

module.exports = (function() {
    
    var tags = context.getTags();
    
    var removeGeneratedNodes = function( target ) {
        
        // Is multiroot?
        if ( Array.isArray( target ) ){ 
            // There are several roots
            
            var result = [];
            for ( var c = 0; c < target.length; c++ ) {
                result = result.concat( 
                    removeNodes( target[ c ] )
                );
            }
            return result;
        }
        
        // There is only one root
        return removeNodes( target );
    };
    
    var removeNodes = function( target ) {
        
        var result = [];
        
        result = result.concat( removeNodesByTag( target, tags.qdup ) );       // Remove all generated nodes (repeats)
        result = result.concat( removeNodesByTag( target, tags.metalMacro ) ); // Remove all generated nodes (macros)
        
        return result;
    };
    
    var removeNodesByTag = function( target, tag ){
        
        var list = target.querySelectorAll( "*[" + tag + "]" );
        return removeList( list );
    };
    
    var removeRelatedNodes = function( target ){
        
        var list = target.parentNode.querySelectorAll( 
            '[' + context.getTags().relatedId + '="' + target.getAttribute( context.getTags().id ) + '"]' 
        );
        return removeList( list );
    };
    
    var removeList = function( list ){

        var result = [];
        
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            // Add nodeId to result if needed
            var nodeId = getNodeId( node );
            if ( nodeId !== undefined ){
                result.push( nodeId );
            }
            
            // Add the nodeIds of its children
            addNodeIdsToList( node, result );
            
            // Remove node
            node.parentNode.removeChild( node );
        }
        
        return result;
    };
    
    var addNodeIdsToList = function( target, result ){
        
        // Get the nodes with data-id
        var nodeIdAttributeName = context.getTags().id;
        var list = target.querySelectorAll( '[' + nodeIdAttributeName + ']' );
        
        // Iterate the list
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            result.push( 
                node.getAttribute( nodeIdAttributeName ) 
            );
        }
    };
    
    var getNodeId = function( node ){
        
        var nodeIdAttributeName = context.getTags().id;
        
        return node.hasAttribute( nodeIdAttributeName )?
            node.getAttribute( nodeIdAttributeName ):
            undefined;
    };
    
    var removeNode = function( node ){
        var nodeId = getNodeId( node );
        var parentNode = node.parentNode;
        if ( parentNode ){
            parentNode.removeChild( node );
        }
        return nodeId;
    };
    
    var removeMultipleNodes = function( node, mustRemoveGeneratedNodes ){
        
        var result = removeRelatedNodes( node );
        
        if ( mustRemoveGeneratedNodes ){
            result = result.concat(
                removeGeneratedNodes( node )
            );
        }
        
        return result;
    };
    
    var self = {
        removeGeneratedNodes: removeGeneratedNodes,
        //removeRelatedNodes: removeRelatedNodes,
        removeNode: removeNode,
        removeMultipleNodes: removeMultipleNodes
    };
    
    return self;
})();

},{"../context.js":27}],92:[function(require,module,exports){
/* 
    Class Parser 
*/
"use strict";

var context = require( '../context.js' );
var ParserRenderer = require( './parserRenderer.js' );
var ParserUpdater = require( './parserUpdater.js' );
var ParserPreloader = require( './parserPreloader.js' );
var ReactiveDictionary = require( '../scopes/reactiveDictionary.js' );

module.exports = (function() {
    
    var parserOptions = {
        command: undefined, // preload, fullRender or partialRender
        root: undefined,
        dictionary: {},
        indexExpressions: true
        //notRemoveGeneratedTags,
        //target,
        //declaredRemotePageUrls,
        //i18n,
        //callback,
        //failCallback,
    };
    
    var updateParserOptions = function( options ){
        
        parserOptions.command = options.command || 'fullRender';
        parserOptions.root = options.root === undefined? parserOptions.root: options.root;
        parserOptions.dictionary = ( options.dictionary instanceof ReactiveDictionary?
            options.dictionary._getNonReactiveDictionary(): 
            options.dictionary )
            || parserOptions.dictionary;
        //parserOptions.dictionary = options.dictionary || parserOptions.dictionary;
        parserOptions.indexExpressions = options.indexExpressions === undefined? parserOptions.indexExpressions: options.indexExpressions;
    };
    
    var run = function( _options ){
        
        var options = _options || {};
        
        // Init parser options
        updateParserOptions( options );
    
        var command = options.command || 'fullRender';
        switch ( command ) {
            case 'preload':
                return processPreload(
                    options.callback,
                    options.failCallback,
                    options.declaredRemotePageUrls || [],
                    options.i18n,
                    options.notRemoveGeneratedTags,
                    options.maxFolderDictionaries
                );
            case 'fullRender':
            case 'partialRender':
                return processRender(
                    command === 'partialRender'? options.target: parserOptions.root,
                    options.dictionaryExtension,
                    options.notRemoveGeneratedTags,
                    parserOptions.indexExpressions && command === 'fullRender',
                    options.goToURLHash === undefined? context.nextRunCounter() === 1: false
                );
            case 'update':
                return processUpdate( 
                    options.dictionaryChanges,
                    options.dictionaryActions
                );
            default:
                throw 'Unknown command: ' + command;
        }
    };
    
    var processPreload = function( callback, failCallback, declaredRemotePageUrls, i18n, notRemoveGeneratedTags, maxFolderDictionaries ){
        
        var parserPreloader = new ParserPreloader( 
            parserOptions, 
            callback, 
            failCallback, 
            declaredRemotePageUrls, 
            i18n, 
            notRemoveGeneratedTags, 
            maxFolderDictionaries
        );

        parserPreloader.run();

        return parserPreloader;
    };
    
    var processRender = function( target, dictionaryExtension, notRemoveGeneratedTags, resetIndex, goToURLHash ){
        
        var parserRenderer = new ParserRenderer( 
            parserOptions, 
            target, 
            dictionaryExtension, 
            notRemoveGeneratedTags, 
            resetIndex,
            goToURLHash
        );

        parserRenderer.run();
        
        return parserRenderer;
    };
    
    var processUpdate = function( dictionaryChanges, dictionaryActions ) {
        
        var parserUpdater = new ParserUpdater( 
            dictionaryChanges,
            dictionaryActions,
            parserOptions
        );

        parserUpdater.run();
        
        return parserUpdater;
    };
    
    var getOptions = function(){
        return parserOptions;
    };
    
    var self = {
        run: run,
        getOptions: getOptions
    };
    
    return self;
})();

},{"../context.js":27,"../scopes/reactiveDictionary.js":98,"./parserPreloader.js":94,"./parserRenderer.js":95,"./parserUpdater.js":96}],93:[function(require,module,exports){
(function (process){(function (){
/* 
    Class ParserNodeRenderer
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var NodeAttributes = require( './nodeAttributes.js' );
var attributeCache = require( '../cache/attributeCache.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var AutoDefineHelper = require( './autoDefineHelper.js' );
var evaluateHelper = require( '../expressions/evaluateHelper.js' );
var Loop = require( './loop.js' );

var I18NDomain = require( '../attributes/I18N/i18nDomain.js' );
var I18NLanguage = require( '../attributes/I18N/i18nLanguage.js' );
var METALDefineMacro = require( '../attributes/METAL/metalDefineMacro.js' );
var METALUseMacro = require( '../attributes/METAL/metalUseMacro.js' );
var TALAttributes = require( '../attributes/TAL/talAttributes.js' );
var TALCondition = require( '../attributes/TAL/talCondition.js' );
var TALContent = require( '../attributes/TAL/talContent.js' );
var TALDefine = require( '../attributes/TAL/talDefine.js' );
var TALOmitTag = require( '../attributes/TAL/talOmitTag.js' );
var TALOnError = require( '../attributes/TAL/talOnError.js' );
var TALRepeat = require( '../attributes/TAL/talRepeat.js' );
var TALReplace = require( '../attributes/TAL/talReplace.js' );
var TALDeclare = require( '../attributes/TAL/talDeclare.js' );
var contentHelper = require( '../attributes/TAL/contentHelper.js' );

var ParserNodeRenderer = function( _target, _scope, _indexExpressions ) {
    
    var target = _target; 
    var scope = _scope;
    var indexExpressions = _indexExpressions;
    
    var tags = context.getTags();
    
    var run = function(){
        process( target );
    };
    
    var process = function( node ) {

        try {
            // Get the attributes from the node
            var attributes = new NodeAttributes( node, indexExpressions );
            
            scope.startElement();

            // Process instructions
            attributes.talRepeat != null ? 
                processLoop( node, attributes ):
                processElement( node, attributes );

            scope.endElement();

        } catch ( e ) {
            
            // Try to treat error
            if ( ! treatError( node, e ) ) {
                throw e;
            }
        }
    };
    
    var processLoopNextSibling = function( node ){

        var counter = -1;
        var nextSibling = node;
        do {
            ++counter;
            nextSibling = nextSibling.nextElementSibling;
            if ( ! nextSibling ){
                return {
                    nextSibling: null,
                    counter: counter
                };
            }
        } while ( nextSibling.hasAttribute( tags.qdup ) );

        return {
            nextSibling: nextSibling,
            counter: counter
        };
    };
    
    var processLoop = function( node, attributes ) {
        
        // Process repeat
        //var talRepeat = TALRepeat.build( attributes.talRepeat );
        var talRepeat = attributeCache.getByAttributeClass( 
            TALRepeat, 
            attributes.talRepeat, 
            node,
            indexExpressions,
            scope
        );
        var loop = talRepeat.process( scope, node );

        // Check default
        if ( evaluateHelper.isDefault( loop.getItems() ) ){
            processElement( node, attributes );
            return true;
        }
        
        // Configure the node to clone it later
        node.removeAttribute( tags.talRepeat );
        node.removeAttribute( 'style' );
        node.setAttribute( tags.qdup, 1 );
        var nodeId = node.getAttribute( 'id' );
        node.removeAttribute( 'id' );
        var nodeDataId = node.getAttribute( tags.id );
        node.removeAttribute( tags.id );
        
        var nextSiblingData = processLoopNextSibling( node );
        var nextSibling = nextSiblingData.nextSibling;
        loop.setOffset( nextSiblingData.counter );
        //log.warn( 'loop counter: ' + nextSiblingData.counter );
        
        var autoDefineHelper;
        while ( autoDefineHelper = loop.repeat() ) {
            
            scope.startElement();
            
            // Clone and configure the node
            var tmpNode = ParserNodeRenderer.cloneAndConfigureNode( node, indexExpressions, tags, nodeDataId );

            // Insert it
            var parentNode = node.parentNode;
            parentNode.insertBefore( tmpNode, nextSibling );
            
            // Process it
            if ( ! processElement( tmpNode, attributes, autoDefineHelper ) ) {
                scope.endElement();
                return false;
            }
            
            scope.endElement();
        }

        // Configure repeat node (the original) to enable future reevaluation
        node.style.display = 'none';
        node.setAttribute( tags.talRepeat, attributes.talRepeat );
        if ( nodeId !== '' && nodeId != null ){
            node.setAttribute( 'id', nodeId );
        }
        if ( nodeDataId !== '' && nodeDataId != null ){
            node.setAttribute( tags.id, nodeDataId );
        }
        node.removeAttribute( tags.qdup );
        
        return true;
    };

    var treatError = function( node, exception ) {

        try {
            // Set the error variable
            var templateError = {
                type: exception.name,
                value: exception.message,
                traceback: exception.stack
            };
            scope.set( 
                context.getConf().templateErrorVarName, 
                templateError 
            );
            
            // Exit if there is no on-error expression defined
            var content = scope.get( context.getConf().onErrorVarName );
            if ( content == null ) {
                log.fatal( exception );
                scope.endElement();
                return false;
            }
            
            log.error( exception );
            scope.endElement();
            
            contentHelper.updateNode( 
                node, 
                scope.get( context.getConf().onErrorStructureVarName ), 
                content 
            );
            
            return content;
            
        } catch ( e ) {
            log.fatal( e );
            scope.endElement();
            throw e;
        }
    };
    
    var processElement = function( node, attributes, _autoDefineHelper ) {

        // If it is defined a metalFillSlot or a metalDefineMacro do nothing
        if ( attributes.metalFillSlot || ! processMETALDefineMacro(
            node, 
            attributes.metalDefineMacro 
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }
        
        var autoDefineHelper = _autoDefineHelper || new AutoDefineHelper( node );
        
        if ( ! processDeclare( 
            node,
            attributes.talDeclare,
            autoDefineHelper
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }
        
        processOnError( 
            node,
            attributes.talOnError,
            autoDefineHelper
        );
        
        processI18nLanguage( 
            node,
            attributes.i18nLanguage,
            autoDefineHelper
        );
        
        processI18nDomain(
            node,
            attributes.i18nDomain, 
            autoDefineHelper
        );
        
        processAutoDefine( 
            node, 
            autoDefineHelper
        );
        
        ParserNodeRenderer.processDefine( 
            node,
            attributes.talDefine,  
            false,
            scope,
            indexExpressions
        );
        
        if ( ! processCondition(
                node, 
                attributes.talCondition 
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }

        var omittedTag = processOmitTag(
                node, 
                attributes.talOmitTag 
        );

        var replaced = processReplace(
                node, 
                attributes.talReplace 
        );

        if ( ! omittedTag && ! replaced ) {
            
            processAttributes(
                    node, 
                    attributes.talAttributes 
            );

            if ( ! processContent(
                    node, 
                    attributes.talContent ) ) {

                defaultContent( node );
            }
        }

        processMETALUseMacro(
                node, 
                attributes.metalUseMacro, 
                attributes.talDefine,
                autoDefineHelper
        );
        
        return true;
    };

    var defaultContent = function( node ) {

        var childNodes = node.childNodes;
        if ( ! childNodes ) {
            return;
        }

        for ( var i = 0; i < childNodes.length; i++ ) {
            var currentChildNode = childNodes[ i ];

            // Check if node is ELEMENT_NODE and not parsed yet
            if ( currentChildNode && currentChildNode.nodeType === 1
                    && ! currentChildNode.getAttribute( tags.qdup ) ) {
                process( currentChildNode );
            }
        }
    };
    
    var processOnError = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var talOnError = attributeCache.getByAttributeClass( 
            TALOnError, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talOnError.putToAutoDefineHelper( autoDefineHelper );
    };
    
    var processAutoDefine = function( node, autoDefineHelper ) {
        
        var string = autoDefineHelper.updateNode( node );
        if ( ! string ) {
            return;
        }
        
        var talDefine = attributeCache.getByAttributeClass( 
            TALDefine, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talDefine.process( scope, false );
    };

    var processI18nDomain = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var i18nDomain = attributeCache.getByAttributeClass( 
            I18NDomain, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return i18nDomain.putToAutoDefineHelper( scope, autoDefineHelper );
    };
    
    var processI18nLanguage = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var i18nLanguage = attributeCache.getByAttributeClass( 
            I18NLanguage, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return i18nLanguage.putToAutoDefineHelper( autoDefineHelper );
    };
    
    var processDeclare = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return true;
        }

        var talDeclare = attributeCache.getByAttributeClass( 
            TALDeclare, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talDeclare.process( scope, autoDefineHelper );
    };
    
    var processMETALDefineMacro = function( node, string ) {

        if ( ! string ) {
            return true;
        }

        // No sense to cache macro definitions!
        var metalDefineMacro = METALDefineMacro.build( string );
        return metalDefineMacro.process( scope, node );
    };

    var processMETALUseMacro = function( node, string, stringDefine, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }
        
        // No sense to cache macro uses!
        var metalUseMacro = METALUseMacro.build( string, stringDefine, scope );
        var newNode = metalUseMacro.process( scope, node, autoDefineHelper, indexExpressions );
        newNode.setAttribute( tags.qdup, 1 );
        
        // Index node
        if ( indexExpressions ){
            attributeIndex.add( node, metalUseMacro, scope );
        }
    
        // Process new node
        return process( newNode );
    };

    var processCondition = function( node, string ) {

        if ( ! string ) {
            return true;
        }

        var talCondition = attributeCache.getByAttributeClass( 
            TALCondition, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talCondition.process( scope, node );
    };
    
    var processReplace = function( node, string ) {
        
        if ( ! string ){
            return false;
        }
        
        var talReplace = attributeCache.getByAttributeClass( 
            TALReplace, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talReplace.process( scope, node );
    };

    var processOmitTag = function( node, string ) {

        if ( string == null ) {
            return false;
        }

        var talOmitTag = attributeCache.getByAttributeClass( 
            TALOmitTag, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talOmitTag.process( scope, node, self );
    };
    
    var processContent = function( node, string ) {
        
        if ( ! string ){
            return false;
        }

        var talContent = attributeCache.getByAttributeClass( 
            TALContent, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talContent.process( scope, node );
    };
  
    var processAttributes = function( node, string ) {

        if ( ! string ) {
            return;
        }

        var talAttributes = attributeCache.getByAttributeClass( 
            TALAttributes, 
            string, 
            node,
            indexExpressions,
            scope 
        );
        return talAttributes.process( scope, node );
    };
    
    var self = {
        run: run,
        defaultContent: defaultContent
    };
    
    return self;
};

ParserNodeRenderer.processDefine = function( node, string, forceGlobal, scope, indexExpressions ) {

    if ( ! string ) {
        return;
    }

    var talDefine = attributeCache.getByAttributeClass( 
        TALDefine, 
        string, 
        node,
        indexExpressions,
        scope
    );
    return talDefine.process( scope, forceGlobal );
};

ParserNodeRenderer.cloneAndConfigureNode = function( node, indexExpressions, tags, nodeDataId ) {
    
    // Clone node
    var tmpNode = node.cloneNode( true );
    if ( 'form' in tmpNode ) {
        tmpNode.checked = false;
    }

    // Set id and related id if needed
    if ( indexExpressions ){
        tmpNode.setAttribute( tags.id, context.nextExpressionCounter() );
        tmpNode.setAttribute( tags.relatedId, nodeDataId );
    }
    
    return tmpNode;
};

ParserNodeRenderer.configureNodeForNewItem = function( tmpNode, tags, parentNode, indexItem, indexToUse ) {
    
    // Remove attributes
    tmpNode.removeAttribute( tags.talRepeat );
    tmpNode.removeAttribute( 'style' );
    tmpNode.setAttribute( tags.qdup, 1 );
    
    // Configure loop attributes
    Loop.setAutoDefineAttribute( 
        tmpNode, 
        indexItem.attributeInstance.getVarName(), 
        indexToUse,
        indexItem.attributeInstance.getExpressionString(), 
        parentNode.childElementCount, 
        0
    );
};

module.exports = ParserNodeRenderer;

}).call(this)}).call(this,require('_process'))

},{"../attributes/I18N/i18nDomain.js":8,"../attributes/I18N/i18nLanguage.js":9,"../attributes/METAL/metalDefineMacro.js":10,"../attributes/METAL/metalUseMacro.js":12,"../attributes/TAL/contentHelper.js":13,"../attributes/TAL/talAttributes.js":14,"../attributes/TAL/talCondition.js":15,"../attributes/TAL/talContent.js":16,"../attributes/TAL/talDeclare.js":17,"../attributes/TAL/talDefine.js":18,"../attributes/TAL/talOmitTag.js":19,"../attributes/TAL/talOnError.js":20,"../attributes/TAL/talRepeat.js":21,"../attributes/TAL/talReplace.js":22,"../attributes/attributeIndex.js":23,"../cache/attributeCache.js":24,"../context.js":27,"../expressions/evaluateHelper.js":44,"../logHelper.js":74,"./autoDefineHelper.js":76,"./loop.js":88,"./nodeAttributes.js":90,"_process":5}],94:[function(require,module,exports){
/* 
    Class ParserPreloader
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var nodeRemover = require( './nodeRemover.js' );
var Scope = require( '../scopes/scope.js' );
var i18nHelper = require( '../i18n/i18nHelper.js' );
var resolver = require( '../resolver.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );

var ParserPreloader = function( _parserOptions, _callback, _failCallback, _declaredRemotePageUrls, _i18n, _notRemoveGeneratedTags, _maxFolderDictionaries ) {
    
    var parserOptions = _parserOptions;
    var callback = _callback;
    var failCallback = _failCallback;
    var declaredRemotePageUrls = _declaredRemotePageUrls;
    var i18n = _i18n;
    var notRemoveGeneratedTags = _notRemoveGeneratedTags;
    var maxFolderDictionaries = _maxFolderDictionaries;
    
    var run = function(){

        try {
            if ( ! notRemoveGeneratedTags ){
                nodeRemover.removeGeneratedNodes( parserOptions.root );
                /*
                attributeIndex.removeMultipleNodes(
                    nodeRemover.removeGeneratedNodes( parserOptions.root )
                );
                */
            }

            var scope = new Scope( 
                parserOptions.dictionary, 
                parserOptions.dictionaryExtension, 
                true 
            );

            scope.loadFolderDictionariesAsync( 
                maxFolderDictionaries, 
                window.location,
                function(){
                    context.setFolderDictionaries( scope.folderDictionaries );

                    i18nHelper.loadAsyncAuto( 
                        parserOptions.dictionary,
                        i18n,
                        function(){
                            resolver.loadRemotePages( 
                                scope,
                                declaredRemotePageUrls,
                                callback,
                                failCallback
                            );
                        },
                        failCallback
                    );
                } 
            );

        } catch( e ){
            log.fatal( 'Exiting init method of ZPT with errors: ' + e );
            throw e;
        }
    };

    
    var self = {
        run: run
    };
    
    return self;
};

module.exports = ParserPreloader;

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../i18n/i18nHelper.js":73,"../logHelper.js":74,"../resolver.js":97,"../scopes/scope.js":99,"./nodeRemover.js":91}],95:[function(require,module,exports){
(function (process){(function (){
/* 
    Class ParserRenderer
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeCache = require( '../cache/attributeCache.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var nodeRemover = require( './nodeRemover.js' );
var scopeBuilder = require( '../scopes/scopeBuilder.js' );
var ParserNodeRenderer = require( './parserNodeRenderer.js' );

var ParserRenderer = function( _parserOptions, _target, _dictionaryExtension, _notRemoveGeneratedTags, _resetIndex, _goToURLHash ) {
    
    var parserOptions = _parserOptions;
    var target = _target;
    var dictionaryExtension = _dictionaryExtension;
    var notRemoveGeneratedTags = _notRemoveGeneratedTags;
    var resetIndex = _resetIndex;
    var goToURLHash = _goToURLHash;
    
    var run = function(){
        process();
    };
    
    var process = function(){

        try {
            if ( ! target ){
                throw 'Unable to process null root or target!';
            }

            if ( ! notRemoveGeneratedTags ){
                nodeRemover.removeGeneratedNodes( target );
                /*
                attributeIndex.removeMultipleNodes(
                    nodeRemover.removeGeneratedNodes( target )
                );
                */
            }

            if ( resetIndex ){
                attributeIndex.reset();
                attributeCache.reset();
            }

            processAllTargetElements();
            
            if ( goToURLHash ){
                processGoToURLHash();
            }

        } catch( e ){
            log.fatal( 'Exiting run method of ZPT with errors: ' + e );
            context.errorFunction( e );
            //throw e;
        }
    };

    var processAllTargetElements = function() {

        // Is multiroot?
        if ( Array.isArray( target ) ){ 
            // There are several roots
            for ( var c = 0; c < target.length; c++ ) {
                process1Target( target[ c ] );
            }
        } else {
            // There is only one root
            process1Target( target );
        }
    };

    var process1Target = function( currentTarget ) {

        var parserNodeRenderer = new ParserNodeRenderer( 
            currentTarget, 
            scopeBuilder.build( 
                parserOptions, 
                currentTarget, 
                dictionaryExtension,
                parserOptions.command === 'partialRender'
            ),
            parserOptions.indexExpressions
        );

        parserNodeRenderer.run();
    };
    
    var processGoToURLHash = function(){
        
        var id = decodeURI( window.location.hash ).substr( 1 );
        if ( ! id ){
            return;
        }
        
        var element = window.document.getElementById( id );
        if ( ! element ){
            log.warn( 'Unable to go to URL hash. Element with id "' + id + '" not found!' );
            return;
        }

        // Go to hash
        window.location.href = '#' + id;
    };
    
    var self = {
        run: run
    };
    
    return self;
};

module.exports = ParserRenderer;

}).call(this)}).call(this,require('_process'))

},{"../attributes/attributeIndex.js":23,"../cache/attributeCache.js":24,"../context.js":27,"../logHelper.js":74,"../scopes/scopeBuilder.js":100,"./nodeRemover.js":91,"./parserNodeRenderer.js":93,"_process":5}],96:[function(require,module,exports){
/* 
    Class ParserUpdater
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var scopeBuilder = require( '../scopes/scopeBuilder.js' );
var ParserNodeRenderer = require( './parserNodeRenderer.js' );
var nodeRemover = require( './nodeRemover.js' );
var utils = require( '../utils.js' );
var dictionaryActionBuilder = require( './dictionaryActions/dictionaryActionBuilder.js' );
var AbstractArrayAction = require( './dictionaryActions/abstractArrayAction.js' );

var ParserUpdater = function( _dictionaryChanges, _dictionaryActions, _parserOptions ) {
    
    var dictionaryChanges = _dictionaryChanges;
    var dictionaryActions = _dictionaryActions;
    var parserOptions = _parserOptions;
    
    var scopeMap = {};
    var nodeAttributes, 
        statistics;
    var dictionaryActionsInstances;
    
    var initializeDictionaryActionsInstances = function(){
        
        dictionaryActionsInstances = [];
        
        if ( ! dictionaryActions ){
            return;
        }
        
        for ( var i = 0; i < dictionaryActions.length; ++i ){
            var action = dictionaryActions[ i ];
            var newActionInstance = dictionaryActionBuilder.build( action, parserOptions.dictionary );
            if ( Array.isArray( newActionInstance ) ){
                dictionaryActionsInstances = dictionaryActionsInstances.concat( newActionInstance );
            } else {
                dictionaryActionsInstances.push( newActionInstance );
            }
        }
    };
    initializeDictionaryActionsInstances();
    
    var getStatistics = function(){
        return statistics;
    };

    var updateDictionaryForDictionaryChanges = function(){
        
        if ( dictionaryChanges ){
            utils.extend( parserOptions.dictionary, dictionaryChanges );
        }
    };
    
    var addUpdatedToStatistics = function(){
        ++statistics.totalUpdates;
    };
    
    var addRemovedToStatistics = function(){
        ++statistics.removedNodeUpdates;
    };
    
    var run = function(){
        
        try {
            // Check the index was built
            if ( ! parserOptions.indexExpressions ){
                throw 'Unable to update, no index built! Set indexExpressions to true!';
            }
            
            // Init some vars
            nodeAttributes = {};
            statistics = {
                totalUpdates: 0,
                removedNodeUpdates: 0
            };

            // Do all required HTML updates
            updateHTML();
            
        } catch( e ){
            log.fatal( 'Exiting run method of update command of ZPT with errors: ' + e );
            context.errorFunction( e );
        }
    };

    var updateHTML = function(){

        if ( updateHTMLFromActions( 0 ) ){
            updateHTMLFromVarChange();
        }
    };
    
    var updateHTMLFromActions = function( initial ){

        for ( var i = initial; i < dictionaryActionsInstances.length; ++i ){
            var actionInstance = dictionaryActionsInstances[ i ];
            
            // Update dictionary using action
            actionInstance.updateDictionary( parserOptions.dictionary );
            
            // Get the list of changes related to varName
            var list = attributeIndex.getVarsList( actionInstance.id );
            if ( ! list ){
                continue;
            }
            
            // Iterate list and update HTML if required
            if ( ! updateHTMLFromVarsList( actionInstance, i, 0, list ) ){
                return false;
            }
            /*
            for ( var j = 0; j < list.length; j++ ) {
                var indexItem = list[ j ];
                if ( ! actionInstance.attributeInstanceIsRelated( indexItem.attributeInstance ) ){
                    if ( ! utils.isFunction( indexItem.attributeInstance.updatableFromAction ) 
                            || indexItem.attributeInstance.updatableFromAction( self, findNodeById( indexItem.nodeId ) ) ){
                        buildDataFromVarChangeExcluding( actionInstance.id );
                    }
                    continue;
                }
                
                if ( ! actionInstance.updateHTML( 
                    indexItem, 
                    self, 
                    actionInstance, 
                    { 
                        actionInstance: actionInstance,
                        i: i, 
                        list: list,
                        initialJ: j 
                    }
                ) ){
                    return false;
                }
            }
            */
        }
        
        return true;
    };
    
    var updateHTMLFromVarsList = function( actionInstance, i, initialJ, list ){
        
        // Iterate list and update HTML if required
        for ( var j = initialJ; j < list.length; j++ ) {
            var indexItem = list[ j ];
            if ( ! actionInstance.attributeInstanceIsRelated( indexItem.attributeInstance ) ){
                if ( ! utils.isFunction( indexItem.attributeInstance.updatableFromAction ) 
                        || indexItem.attributeInstance.updatableFromAction( self, findNodeById( indexItem.nodeId ) ) ){
                    buildDataFromVarChangeExcluding( actionInstance.id );
                }
                continue;
            }

            if ( ! actionInstance.updateHTML( 
                indexItem, 
                self, 
                actionInstance, 
                { 
                    actionInstance: actionInstance,
                    i: i, 
                    initialJ: j,
                    list: list
                }
            ) ){
                return false;
            }
        }
        
        return true;
    };
    
    var continueUpdateHTML = function( continueData ){

        updateHTMLFromVarsList(
            continueData.actionInstance, 
            continueData.i, 
            continueData.initialJ + 1, 
            continueData.list
        );
        
        if ( updateHTMLFromActions( continueData.i + 1 ) ){
            updateHTMLFromVarChange();
        }
    };
    
    var runAnimation = function( actionInstance, node, callback ){
        
        // Build combinedCallback combining callback and actionInstance.animationCallback
        var combinedCallback = function(){
                if ( callback ){
                    callback();
                } else {
                    context.getAnimationManager().reset( node );
                }
                if ( actionInstance.animationCallback ){
                    actionInstance.animationCallback();
                }
            };
        
        // Get animation manager to run animation
        context.getAnimationManager().animate( actionInstance, node, combinedCallback );
    };
    /*
    var runAnimation = function( actionInstance, node, callback ){
        
        // Build combinedCallback combining callback and actionInstance.animationCallback
        var combinedCallback = ! callback && ! actionInstance.animationCallback? 
            undefined:
            function(){
                if ( callback ){
                    callback();
                }
                if ( actionInstance.animationCallback ){
                    actionInstance.animationCallback();
                }
            };
        
        // Get animation manager to run animation
        context.getAnimationManager().animate( actionInstance, node, combinedCallback );
    };
    */
    
    var updateHTMLFromVarChange = function(){
        
        // Update dictionary
        updateDictionaryForDictionaryChanges();
        
        // Build data
        for ( var varName in dictionaryChanges ){
            buildDataFromVarChange( varName );
        }
        
        // Update attributes
        for ( var i in nodeAttributes ) {
            var currentNodeAttributeList = nodeAttributes[ i ];
            for ( var j in currentNodeAttributeList ){
                updateAttribute( currentNodeAttributeList[ j ] );   
            }
        }
    };
    
    var buildDataFromVarChange = function( varName ){
        
        // Get the list of changes related to varName
        var list = attributeIndex.getVarsList( varName );
        buildDataFromList( varName, list );
    };
    
    var buildDataFromVarChangeExcluding = function( varName ){
        
        // Get the list of changes related to varName
        var list = attributeIndex.getVarsList( varName );
        
        var filtered = list.filter(
            function( indexItem, index, arr ){
                return ! AbstractArrayAction.staticAttributeInstanceIsRelated(
                    indexItem.attributeInstance
                );
            }
        );
        
        buildDataFromList( varName, filtered );
    };
    
    var buildDataFromList = function( varName, list ){
        
        if ( ! list ){
            return;
        }
        
        // Build data about all changes
        var length = list.length;
        for ( var i = 0; i < length; i++ ) {
            addNewNodeAttribute( varName, list[ i ] );
            /*
            if ( ! addNewNodeAttribute( varName, list[ i ] ) ){
                attributeIndex.removeVar( varName, list[ i ].nodeId );
            }
            */
        }
    };
    
    var findNodeById = function ( nodeId ) {
        
        return window.document.querySelector( 
            '[' + context.getTags().id + '="' + nodeId + '"]' 
        );
    };

    var addNewNodeAttribute = function( varName, indexItem ){

        var attributeInstance = indexItem.attributeInstance;
        var node = findNodeById( indexItem.nodeId );
        if ( ! node ){
            // Removed node!
            ++statistics.removedNodeUpdates;
            return false;
        }

        // Add data to nodeData
        var thisNodeData = nodeAttributes[ indexItem.nodeId ];
        if ( ! thisNodeData ){
            thisNodeData = {};
            nodeAttributes[ indexItem.nodeId ] = thisNodeData;
        }
        var elementId = indexItem.groupId? 
            attributeInstance.type + '/' + indexItem.groupId: 
            attributeInstance.type;
        thisNodeData[ elementId ] = indexItem;

        return true;
    };
    
    var updateAttribute = function( indexItem ){
        
        var attributeInstance = indexItem.attributeInstance;
        var node = findNodeById( indexItem.nodeId );
        if ( ! node ){
            // Removed node!
            ++statistics.removedNodeUpdates;
            return false;
        }
        
        ++statistics.totalUpdates;
        
        var scope = getNodeScope( node, indexItem.nodeId );
        
        attributeInstance.update( self, node, scope, indexItem );
        
        return true;
    };

    var getNodeScope = function( node, nodeId ){
        
        if ( ! nodeId ){
            nodeId = node.getAttribute( context.getTags().id );
        }
        
        var thisScope = scopeMap[ nodeId ];
        
        if ( ! thisScope ){
            thisScope = scopeBuilder.build( 
                parserOptions, 
                node, 
                undefined,
                true
            );
            scopeMap[ nodeId ] = thisScope;
        }

        return thisScope;
    };
    
    var updateNode = function( node, mustRemoveGeneratedNodes ){
        
        // Remove related to node nodes
        nodeRemover.removeMultipleNodes( node, mustRemoveGeneratedNodes );
        /*
        attributeIndex.removeMultipleNodes(
            nodeRemover.removeMultipleNodes( node, mustRemoveGeneratedNodes )
        );
        */
        
        // Instance and invoke parserNodeRenderer to update node
        var parserNodeRenderer = new ParserNodeRenderer( 
            node, 
            scopeBuilder.build( 
                parserOptions, 
                node, 
                undefined,
                true
            ),
            true
        );
        parserNodeRenderer.run();
    };
    /*
    var deleteNode = function( node ){
        node.parentNode.removeChild( node );
    };
    */
    var self = {
        run: run,
        updateNode: updateNode,
        //deleteNode: deleteNode,
        findNodeById: findNodeById,
        getNodeScope: getNodeScope,
        getStatistics: getStatistics,
        addUpdatedToStatistics: addUpdatedToStatistics,
        addRemovedToStatistics: addRemovedToStatistics,
        runAnimation: runAnimation,
        continueUpdateHTML: continueUpdateHTML
    };
    
    return self;
};

module.exports = ParserUpdater;

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../logHelper.js":74,"../scopes/scopeBuilder.js":100,"../utils.js":101,"./dictionaryActions/abstractArrayAction.js":79,"./dictionaryActions/dictionaryActionBuilder.js":85,"./nodeRemover.js":91,"./parserNodeRenderer.js":93}],97:[function(require,module,exports){
/* 
    resolver singleton class
*/
var utils = require( './utils.js' );
var context = require( './context.js' );
var expressionBuilder = require( './expressions/expressionBuilder.js' );

module.exports = (function( ) {
    "use strict";
    
    var macros = {};
    var remotePages = {};
    
    var getNode = function( macroKey, scope ) {
        
        var node = macros[ macroKey ];
        
        if ( ! node ){
            node = loadNode( macroKey, scope );
        }
        
        return node? node.cloneNode( true ): undefined;
    };
    /*
    var isRemote = function( macroKey ){
        return -1 != macroKey.indexOf( context.getConf().macroDelimiter );
    };*/
    
    var getMacroDataUsingExpression = function ( macroKeyExpression, scope ){
        
        var macroKey = macroKeyExpression.evaluate( scope );
        
        if ( ! macroKey ){
            return {
                macroId: null,
                url: null
            };
        }
        
        return getMacroData( macroKey, scope );
    };
    
    var getMacroDataUsingExpressionString = function ( macroKeyExpressionString, scope ){
        
        var macroKeyExpression = expressionBuilder.build( macroKeyExpressionString );
        return getMacroDataUsingExpression( macroKeyExpression, scope );
    };
    
    var getMacroData = function ( macroKey, scope ){

        var index = macroKey.indexOf( context.getConf().macroDelimiter );
        
        return index === -1?
            {
                macroId: macroKey,
                url: null
            }:
            {
                macroId: macroKey.substring( 0, index ),
                url: buildURL ( macroKey.substring( 1 + index ) )
            };
    };
    
    var builDefineMacroSelector = function( macroId ){
        return "[" + filterSelector( context.getTags().metalDefineMacro ) + "='" + macroId + "']";
    };
    
    var loadNode = function( macroKey, scope ){

        var macroData = getMacroData( macroKey, scope );

        if ( macroData.url ){
            // Node is in another page
            return loadRemoteNode( macroKey, macroData );
        }
        
        // No url set
        var urlInScope = scope.get( context.getConf().externalMacroUrlVarName );
        if ( urlInScope ){
            // Try to find node in another page but using a previously defined url
            macroData.url = urlInScope;
            var remoteNode = loadRemoteNode( macroKey, macroData );
            if ( remoteNode ){
                // Node is found in another page
                return remoteNode;
            }
        }
        
        // Node is in this page
        var macroId = macroData.macroId;
        var selector = builDefineMacroSelector( macroId );
        var node = window.document.querySelector( selector );

        if ( ! node ){
            throw "Node using selector '" + selector + "' is null!";
        }

        return configureNode( 
            node.cloneNode( true ), 
            macroId,
            macroKey );
        
    };
    var loadRemoteNode = function( macroKey, macroData ){
        
        var element = remotePages[ macroData.url ];
        
        if ( ! element ){
            throw 'Macros in URL ' + macroData.url + ' not preloaded!';
        }
        
        var selector = builDefineMacroSelector( macroData.macroId );
        var node = element.querySelector( selector );
        
        if ( ! node ){
            return undefined;
        }
        
        return configureNode( 
                    node.cloneNode( true ), 
                    macroData.macroId,
                    macroKey );
    };
    
    var buildRemotePageUrlList = function( scope, declaredRemotePageUrls ){
        
        var remotePageUrls = declaredRemotePageUrls.slice();
        
        var list = document.querySelectorAll( 
            "[" + filterSelector( context.getTags().metalUseMacro ) + "]"
        );
        var currentMacroUse;
        var pos = 0;
        while ( currentMacroUse = list[ pos++ ] ) {
            var macroKeyExpressionString = currentMacroUse.getAttribute( context.getTags().metalUseMacro );
            
            try {
                var macroData = getMacroDataUsingExpressionString( macroKeyExpressionString, scope );

                var url = macroData.url;
                if ( url && remotePageUrls.indexOf( url ) === -1 ){
                    remotePageUrls.push( url );
                }
            } catch ( exception ){
                // Macrodata could not be resolved, do nothing
            }
        }
                                                              
        return remotePageUrls;
    };
    
    // Add preffix if the URL is not absolute
    var buildURL = function( URL ){
        return URL.startsWith( '/' )? URL: context.getConf().externalMacroPrefixURL + URL;
    };
    
    var loadRemotePages = function( scope, declaredRemotePageUrls, callback, failCallback ){

        var remotePageUrls = buildRemotePageUrlList( scope, declaredRemotePageUrls );
        var pending = remotePageUrls.length;
        remotePages = {};
        
        if ( ! pending ){
            if ( callback && utils.isFunction( callback ) ){
                callback();   
            }
            return;
        }
        
        for ( var c = 0; c < remotePageUrls.length; c++ ) {
            var currentPageUrl = buildURL( remotePageUrls[ c ] );
            
            /* jshint loopfunc: true */
            utils.ajax(
                {
                    url: currentPageUrl,
                    //dataType: 'html',
                    done: function( html ) {
                        var element = document.createElement( 'div' );
                        element.innerHTML = html;
                        remotePages[ this.url ] = element;
                        if ( --pending == 0 && callback && utils.isFunction( callback ) ){
                            callback();
                        }
                    },
                    fail: function( jqXHR, textStatus, error ) {
                        context.asyncError( currentPageUrl, error, failCallback );
                    }
                }
            );
            /*
            $.ajax({
                url: currentPageUrl,
                dataType: 'html'
            }).done( function( html ) {
                var element = $( '<div></div>' );
                element.html( html );
                remotePages[ this.url ] = element;
                if ( --pending == 0 && callback && utils.isFunction( callback ) ){
                    callback();
                }
            }).fail( function( jqXHR, textStatus, error ) {
                context.asyncError( currentPageUrl, error, failCallback );
            });
            */
        }
    };
                  
    var configureNode = function( node, macroId, macroKey ){
        node.removeAttribute( context.getTags().metalDefineMacro );
        node.setAttribute( context.getTags().metalMacro, macroId );
        
        macros[ macroKey ] = node;
        
        return node;
    };
    
    var getMacroKey = function( macroKeyExpression, scope ){
        
        var macroData = getMacroDataUsingExpression( macroKeyExpression, scope );
        
        return macroData.url? macroData.macroId + context.getConf().macroDelimiter + macroData.url: macroData.macroId;
    };
    
    // Must filter to replace : by \\:
    var filterSelector = function( selector ){
        return selector.replace( /:/gi, '\\:' );
    };
    
    return {
        getNode: getNode,
        //isRemote: isRemote,
        loadRemotePages: loadRemotePages,
        getMacroData: getMacroData,
        getMacroKey: getMacroKey,
        filterSelector: filterSelector
    };
})();

},{"./context.js":27,"./expressions/expressionBuilder.js":46,"./utils.js":101}],98:[function(require,module,exports){
/* 
    ReactiveDictionary class 
*/
"use strict";

var zpt = require( '../main.js' );

var ReactiveDictionary = function( _nonReactiveDictionary, _initialAutoCommit ) {
    
    // Init some vars
    var self = this;
    this._privateScope = {
        nonReactiveDictionary: _nonReactiveDictionary,
        autoCommit: true,
        dictionaryChanges: {},
        dictionaryActions: [],
        commit: function(){
            zpt.run({
                command: 'update',
                dictionaryChanges: self._privateScope.dictionaryChanges,
                dictionaryActions: self._privateScope.dictionaryActions
            });
            self._privateScope.dictionaryChanges = {};
            self._privateScope.dictionaryActions = [];
        }
    };

    // Define some methods
    this._getNonReactiveDictionary = function(){
        return this._privateScope.nonReactiveDictionary;
    };
    
    this._isAutoCommit = function(){
        return this._privateScope.autoCommit;
    };
    
    this._setAutoCommit = function( _autoCommit ){
        this._privateScope.autoCommit = _autoCommit;
    };
    
    this._commit = function(){
        this._privateScope.commit();
    };

    this._addActions = function( dictionaryActions ){
        
        // Record this actions to commit it later
        self._privateScope.dictionaryActions = self._privateScope.dictionaryActions.concat( dictionaryActions );
        
        // Commit the change only if autoCommit is on
        if ( self._isAutoCommit() ){
            self._privateScope.commit();
        }
    };
    
    this._addVariable = function( key, value ){
        
        // Set the value in nonReactiveDictionary
        self._privateScope.nonReactiveDictionary[ key ] = value;
        
        // Define getter and setter
        this._defineProperty( 
            this._privateScope.nonReactiveDictionary, 
            key 
        );
    };

    this._defineProperty = function( dictionary, key ){

        // Define property to set getter and setter
        Object.defineProperty(
            self, 
            key, 
            {
                enumerable: true,
                configurable: true,
                get: function () { 
                    return dictionary[ key ];
                },
                set: function ( value ) {
                    // Record this change to commit it later
                    self._privateScope.dictionaryChanges[ key ] = value;

                    // Commit the change only if autoCommit is on
                    if ( self._isAutoCommit() ){
                        self._privateScope.commit();
                    }
                }
            }
        );
    };
    
    // Initialize
    this._initialize = function( dictionary ){
        
        // Initialize autoCommit
        if ( _initialAutoCommit !== undefined ){
            this._setAutoCommit( _initialAutoCommit );
        }
        
        // Iterate properties in dictionary to define setters and getters
        var keys = Object.keys( dictionary );
        for ( var i = 0; i < keys.length; i++ ){
            var key = keys[ i ];
            var property = Object.getOwnPropertyDescriptor( dictionary, key );
            if ( property && property.configurable === false ) {
                continue;
            }
            
            // Define getter and setter
            (function( key ) {
                self._defineProperty( dictionary, key );
            })( key );
        }
    };
    this._initialize( this._privateScope.nonReactiveDictionary );
};

module.exports = ReactiveDictionary;

},{"../main.js":75}],99:[function(require,module,exports){
/* 
    Class Scope 
*/
"use strict";

var context = require( '../context.js' );
var utils = require( '../utils.js' );
var loadjs = require( 'loadjs' );

var Scope = function( _dictionary, _dictionaryExtension, addCommonVars, _folderDictionaries ) {
    
    this.dictionary = _dictionary || {};
    this.dictionaryExtension = _dictionaryExtension || {};
    this.vars = {};
    this.changesStack = [];
    this.nocallVars = {};
    this.folderDictionaries = _folderDictionaries || [];
    this.globalVarsExpressions = {};
    
    if ( addCommonVars ){
        this.setCommonVars();
    }
    this.setMandatoryVars();
};

Scope.prototype.setMandatoryVars = function(){

    // Register nothing var
    this.setVar( 
        context.getConf().nothingVarName, 
        context.getConf().nothingVarValue 
    );
    
    // Register default var
    this.setVar( 
        context.getConf().defaultVarName, 
        context.getConf().defaultVarValue 
    );
};

Scope.prototype.setCommonVars = function(){
    
    // Register window object if it exists
    if ( window ){
        this.setVar( 
            context.getConf().windowVarName, 
            window 
        );
    }

    // Register context
    this.setVar( 
        context.getConf().contextVarName, 
        context 
    );
};

Scope.prototype.startElement = function(){
    
    var vars = {
        varsToUnset: [],
        varsToSet: {},
        expressions: {},
        impliedDeclaredVars: []
    };

    this.changesStack.push( vars );

    return vars;
};

Scope.prototype.currentVars = function(){
    return this.changesStack[ this.changesStack.length - 1 ];
};

Scope.prototype.setVar = function( name, value ) {
    this.vars[ name ] = value;
};

Scope.prototype.getWithoutEvaluating = function( name ) {
    
    var value;
    
    value = this.vars[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    value = this.dictionaryExtension[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    value = this.dictionary[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    for ( var i = 0; i < this.folderDictionaries.length; ++i ){
        value = this.folderDictionaries[ i ][ name ];
        if ( value !== undefined ){
            return value;
        }
    }
    
    return undefined;
};

Scope.prototype.get = function( name ) {

    var value = this.getWithoutEvaluating( name );
    
    if ( ! this.nocallVars[ name ] ){
        return value;
    }
    
    return value && utils.isFunction( value.evaluate )?
        value.evaluate( this ): 
        'Error evaluating property "' + name + '": ' + value;
};

Scope.prototype.unset = function( name ) {
    delete this.vars[ name ];
};

Scope.prototype.endElement = function ( ) {

    var vars = this.changesStack.pop(); 

    var varsToUnset = vars.varsToUnset;
    var varsToSet = vars.varsToSet; 

    for ( var i = 0; i < varsToUnset.length; ++i ){
        this.unset( varsToUnset[ i ] );
    }

    for ( var name in varsToSet ){
        var value = varsToSet[ name ];
        this.setVar( name, value );
    }
};

Scope.prototype.set = function ( name, value, isGlobal, nocall, _expression ) {
    
    var expression = _expression === undefined? null: _expression;
    
    if ( ! isGlobal ){

        // Local vars
        var vars = this.currentVars();
        var currentValue = this.getWithoutEvaluating( name );

        if ( currentValue != null ){
            vars.varsToSet[ name ] = currentValue;
            
        } else {
            vars.varsToUnset.push( name );
        }
        
        vars.expressions[ name ] = expression;
        
        if ( this.isStrictMode() ){
            vars.impliedDeclaredVars.push( name );
        }
        
    } else {
        
        // Global vars
        this.globalVarsExpressions[ name ] = expression; 
    }
    
    // Common to global and local vars
    this.setVar( name, value );
    
    // Add to nocallVars if needed
    if ( nocall ){
        this.nocallVars[ name ] = true;
    }
};

Scope.prototype.loadFolderDictionariesAsync = function ( maxFolderDictionaries, location, callback ) {
    
    if ( ! maxFolderDictionaries ) {
        callback();
        return;
    }
    
    var urlList = this.buildUrlListOfFolderDictionaries( maxFolderDictionaries, location );
    this.loadFolderDictionary(
        maxFolderDictionaries,
        callback,
        urlList, 
        0
    );
};

Scope.prototype.loadFolderDictionary = function ( maxFolderDictionaries, callback, urlList, i ) {
    
    var instance = this;
    
    var loadjsCallback = function( url, success ){
        
        // Treat js file only if load is sucessfull
        if ( success && window.folderDictionary ){
            instance.folderDictionaries.push( window.folderDictionary );
        }
            
        // Run callback and return if the urlList is over
        if ( i === urlList.length){
            callback();
            return;
        }

        // Continue, the urlList is not over
        instance.loadFolderDictionary(
            maxFolderDictionaries, 
            callback,
            urlList, 
            i
        );
    };
    
    var url = urlList[ i++ ];
    loadjs(
        url, 
        {
            success: function() { 
                loadjsCallback( url, true );
            },
            error: function() { 
                loadjsCallback( url, false );
            }
        }
    );
};

Scope.prototype.buildUrlListOfFolderDictionaries = function ( maxFolderDictionaries, location ) {
    
    var result = [];
    
    var c = 0;
    var path = location.pathname;
    var lastIndex = path.lastIndexOf( '/' );
    while ( lastIndex !== -1 && ++c <= maxFolderDictionaries ){
        var parent = path.substr( 0, lastIndex );
        result.push( 
            location.origin + parent + '/' + 'folderDictionary.js' 
        );
        lastIndex = parent.lastIndexOf( '/' );
    }
    
    return result;
};

Scope.prototype.isStrictMode = function(){
    return context.isStrictMode() || this.get( context.getConf().strictModeVarName );
};

Scope.prototype.isValidVariable = function( name ){
    
    // If strict mode is off all variable are valid
    if ( ! this.isStrictMode() ){
        return true;
    }
    
    // If the variable is declared return true
    var declared = this.get( context.getConf().declaredVarsVarName );
    var isDeclared = declared && declared.indexOf? 
        declared.indexOf( name ) !== -1: 
        false;
    if ( isDeclared ){
        return true;
    }
    
    // Check if the variable is implicitly declared
    for ( var i = this.changesStack.length - 1; i >= 0; --i ){
        var vars = this.changesStack[ i ];
        var isImplied = vars.impliedDeclaredVars.indexOf( name ) !== -1;
        if ( isImplied ){
            return true;
        }
    }
    
    return false;
};

Scope.prototype.getVarExpression = function ( name ) {
    
    var expression = this.getExpressionFromLocal( name );
    return expression !== undefined? expression: this.globalVarsExpressions[ name ];
};

Scope.prototype.getExpressionFromLocal = function ( name ) {

    for ( var i = this.changesStack.length - 1; i >= 0; --i ){
        var vars = this.changesStack[ i ];
        var expression = vars.expressions[ name ];
        if ( expression !== undefined ){
            return expression;
        }
    }
    
    return undefined;
};

Scope.prototype.isLocalVar = function ( name ) {
    return this.vars[ name ] !== undefined;
};

module.exports = Scope;

},{"../context.js":27,"../utils.js":101,"loadjs":2}],100:[function(require,module,exports){
/* 
    scopeBuilder singleton class
*/
"use strict";

var context = require( '../context.js' );
var Scope = require( './scope.js' );
var utils = require( '../utils.js' );
var ParserNodeRenderer = require( '../parsers/parserNodeRenderer.js' );

module.exports = (function() {
    
    var keyLength = 6;
    
    var build = function( parserOptions, target, dictionaryExtension, mustUpdate ) {

        var scope = new Scope( 
            parserOptions.dictionary, 
            dictionaryExtension, 
            true,
            context.getFolderDictionaries()
        );
        
        if ( mustUpdate ){
            update( parserOptions, target, scope );
        }
        
        return scope;
    };
    
    var update = function( parserOptions, target, scope ) {
        
        // Get root key
        var rootMap = markAllRoots( parserOptions );
        var rootKeyTag = getRootKeyTag();
        var root = getRoot( parserOptions, target, rootMap );
        var rootKey =  root.getAttribute( rootKeyTag );
        
        var talDefineTag = context.getTags().talDefine;
        var talAutoDefineTag = context.getTags().talAutoDefine;
        
        var node = target.parentNode;
        var c = 0;
        var itemsList = [];
        
        do {
            // Add talDefine
            var talDefine = node.getAttribute( talDefineTag );
            if ( talDefine ){
                itemsList.push( talDefine );
            }
            
            // Add talAutoDefine
            var talAutoDefine = node.getAttribute( talAutoDefineTag );
            if ( talAutoDefine ){
                itemsList.push( talAutoDefine );
            }
            
            var nodeKey = node.getAttribute( rootKeyTag );
            if ( nodeKey && nodeKey === rootKey ){
                return processListOfDefines( 
                    scope, 
                    itemsList, 
                    node,
                    parserOptions.indexExpressions
                );
            }
            
            node = node.parentNode;
            
        } while ( node.nodeType !== 9 && ++c < 100 );
        
        throw 'Error trying to update scope: root not found!';
    };
    
    var processListOfDefines = function( scope, itemsList, node, indexExpressions ){
        
        for ( var c = itemsList.length - 1; c >= 0; c-- ) {
            var talDefine = itemsList[ c ];
            ParserNodeRenderer.processDefine(
                node, 
                talDefine, 
                true,
                scope,
                indexExpressions
            );
        }
    };
    
    var getRoot = function( parserOptions, target, rootMap ){
        
        if ( ! Array.isArray( parserOptions.root ) ){ 
            return parserOptions.root;
        }
        
        var rootKeyTag = getRootKeyTag();
        var node = target;
        var c = 0;
        do {
            var rootKey =  node.getAttribute( rootKeyTag );
            if ( rootKey ){
                return rootMap[ rootKey ];
            }

            node = node.parentNode;

        } while ( node.nodeType !== 9 && ++c < 100 );
        
        throw 'Error trying to get root: not found!';
    };
    
    var markAllRoots = function( parserOptions ){

        var rootMap = {};
        var root = parserOptions.root;

        // Is multiroot?
        if ( Array.isArray( root ) ){ 
            // There are several roots
            for ( var c = 0; c < root.length; c++ ) {
                markAsRoot( root[ c ], rootMap );
            }
        } else {
            // There is only one root
            markAsRoot( root, rootMap );
        }

        return rootMap;
    };
    
    var markAsRoot = function( node, rootMap ){
        
        // Build the key
        var key = buildKey();

        // Put a copy of scope into the cache
        rootMap[ key ] = node;

        // Save the key as an attribute of the node
        node.setAttribute( getRootKeyTag(), key );
    };
    
    var buildKey = function(){
        return utils.generateId( keyLength );
    };
    
    var getRootKeyTag = function(){
        return context.getTags().rootKey;
    };
    
    return {
        build: build
    };
})();

},{"../context.js":27,"../parsers/parserNodeRenderer.js":93,"../utils.js":101,"./scope.js":99}],101:[function(require,module,exports){
/*
    utils singleton class
*/
module.exports = (function() {
    "use strict";
    
    var generateId = function ( len, _charSet ) {
        
        var charSet = _charSet || 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        var result = '';
        for ( var i = 0; i < len; i++ ) {
            var pos = Math.floor( Math.random() * charSet.length );
            result += charSet.substring( pos, pos + 1 );
        }
        return result;
    };
    
    //var isArray = Array.isArray;
    
    var isFunction = function isFunction( obj ) {

        // Support: Chrome <=57, Firefox <=52
        // In some browsers, typeof returns "function" for HTML <object> elements
        // (i.e., `typeof document.createElement( "object" ) === "function"`).
        // We don't want to classify *any* DOM node as a function.
        return typeof obj === "function" && typeof obj.nodeType !== "number";
    };
    
    var isPlainObject = function( obj ) {
        var proto, Ctor;

        // Detect obvious negatives
        // Use toString instead of jQuery.type to catch host objects
        if ( !obj || Object.prototype.toString.call( obj ) !== "[object Object]" ) {
            return false;
        }

        proto = getProto( obj );

        // Objects with no prototype (e.g., `Object.create( null )`) are plain
        if ( !proto ) {
            return true;
        }

        // Objects with prototype are plain iff they were constructed by a global Object function
        Ctor = hasOwn.call( proto, "constructor" ) && proto.constructor;
        return typeof Ctor === "function" && fnToString.call( Ctor ) === ObjectFunctionString;
    };
    var getProto = Object.getPrototypeOf;
    var class2type = {};
    var hasOwn = class2type.hasOwnProperty;
    var fnToString = hasOwn.toString;
    var ObjectFunctionString = fnToString.call( Object );
    
    var deepExtend = function( out ) {
        out = out || {};

        for ( var i = 1; i < arguments.length; i++ ) {
            var obj = arguments[ i ];

            if ( ! obj ){
                continue;
            }
            
            for ( var key in obj ) {
                if ( obj.hasOwnProperty( key ) ) {
                    if ( typeof obj[ key ] === 'object' ){
                        out[ key ] = deepExtend( out[ key ], obj[ key ] );
                    } else {
                        out[ key ] = obj[ key ];
                    }
                }
            }
        }

        return out;
    };
    
    var extend = function(out) {
        out = out || {};

        for ( var i = 1; i < arguments.length; i++ ) {
            if ( ! arguments[ i ] ){
                continue;
            }

            for ( var key in arguments[ i ] ) {
                if ( arguments[ i ].hasOwnProperty( key ) ){
                    out[ key ] = arguments[ i ][ key ];
                }
            }
        }

        return out;
    };
    
    var ajax = function( conf ){
        
        // Check conf object
        if ( ! conf ){
            throw 'Error trying to process ajax: no arguments!';
        }
        if ( ! conf.url ){
            throw 'Error trying to process ajax: no URL defined!';
        }
        if ( ! conf.done ){
            throw 'Error trying to process ajax: no done callback defined!';
        }
        
        // Do it!
        var oReq = new window.XMLHttpRequest();
        oReq.addEventListener( 
            'load',
            function(){
                if ( this.status >= 200 && this.status < 400 ) {
                    // Success!
                    conf.done( 
                        conf.parseJSON?
                        JSON.parse( oReq.responseText ):
                        oReq.responseText
                    );
                } else {
                    // We reached our target server, but it returned an error
                    conf.fail( undefined, undefined, this.statusText );
                }
            }
        );
        if ( conf.fail ){
            oReq.addEventListener( 'error', conf.fail );
        }
        oReq.open( 'GET', conf.url );
        oReq.send();
    };
    
    var getJSON = function( conf ){
        
        conf.parseJSON = true;
        ajax( conf );
    };
    
    /*
    var getJSON = function( conf ){
        
        // Check conf object
        if ( ! conf ){
            throw 'Error trying to getJSON: no arguments!';
        }
        if ( ! conf.url ){
            throw 'Error trying to getJSON: no URL defined!';
        }
        if ( ! conf.done ){
            throw 'Error trying to getJSON: no done callback defined!';
        }
        
        // Do it!
        var oReq = new window.XMLHttpRequest();
        oReq.addEventListener( 
            'load',
            function(){
                if ( this.status >= 200 && this.status < 400 ) {
                    // Success!
                    conf.done( 
                        JSON.parse( 
                            oReq.responseText 
                        ) 
                    );
                } else {
                    // We reached our target server, but it returned an error
                    conf.fail( undefined, undefined, this.statusText );
                }
            }
        );
        if ( conf.fail ){
            oReq.addEventListener( 'error', conf.fail );
        }
        oReq.open( 'GET', conf.url );
        oReq.send();
    };
    */
    /*
    var getNodeId = function ( node ){
        return node.getAttribute( context.getTags().id );
    };
    */
    var deepEqual = function( x, y ) {
        return (x && y && typeof x === 'object' && typeof y === 'object') ?
            (Object.keys(x).length === Object.keys(y).length) && Object.keys(x).reduce(function(isEqual, key) {return isEqual && deepEqual(x[key], y[key]);}, true):
            (x === y);
    };
    
    var copyArray = function( arrayToCopy ){
        
        var result = [];
        
        for ( var i = 0; i < arrayToCopy.length; ++i ){
            result.push( arrayToCopy[ i ] );
        }
        
        return result;
    };
    
    var genericToString = function( element ){
    
        if ( element == undefined ){
            return 'undefined';
        }
        
        if ( Array.isArray( element ) ){
            var result = 'Array[ ';
            for ( var i = 0; i < element.length; ++i ){
                var separator = i === 0? '': ', ';
                result += separator + genericToString( element[ i ] );
            }
            result += ' ]';
            return result;
        }
        
        if ( isPlainObject( element ) ){
            return JSON.stringify( element );
        }
        
        // Must be numeric or string
        return element;
    };
    
    return {
        generateId: generateId,
        //isArray: isArray,
        isFunction: isFunction,
        isPlainObject: isPlainObject,
        deepExtend: deepExtend,
        extend: extend,
        getJSON: getJSON,
        ajax: ajax,
        deepEqual: deepEqual,
        copyArray: copyArray,
        genericToString: genericToString
        //getNodeId: getNodeId
    };
})();

},{}],102:[function(require,module,exports){
// generated by genversion
module.exports = '0.40.3'

},{}],103:[function(require,module,exports){
/*! zzdom - v0.2.0 - 2020-11-12 13:32:51 */
/**
 * A namespace.
 * @const
 */
var zzDOM = {};

/*
    zz function
    
    zz( '#', 'id' );
    zz( '.', 'className' );
    zz( 't', 'tagName' );
    zz( 'tn', 'namespace', 'tagName' );
    zz( 'n', 'name' );
    zz( 's', 'string selector' );
    zz( document.getElementById( 'id' ) ); // Element
    zz( document.getElementsByClassName( 'className' ) ); // HTMLCollection
    zz( document.getElementsByName( 'name' ) ); // NodeList
    zz( 'table.className tr td' ); // String selector
    zz( '<div>New div</div>' ); // HTML code in string
*/
/**
 * @param {string|Element|HTMLCollection|NodeList} x
 * @param {string=} s1
 * @param {string=} s2 
 */
zzDOM.zz = function( x, s1, s2 ){
    
    // Redefine x if a selector id is found
    if ( s1 ){
        switch ( x ){
        case '#':
            x = document.getElementById( s1 );
            break;
        case '.':
            x = document.getElementsByClassName( s1 );
            break;
        case 't':
            x = document.getElementsByTagName( s1 );
            break;
        case 'tn':
            x = document.getElementsByTagNameNS( s1, s2 || '' );
            break;
        case 'n':
            x = document.getElementsByName( s1 );
            break;
        case 's':
            x = document.querySelector( s1 );
            break;
        default:
            throw 'Unsupported selector id found running zz function: ' + x;
        }
    }
    
    // Is it an Element?
    if ( x instanceof Element ){
        return new zzDOM.SS( x );
    }
    
    // Is it an HTMLCollection or a NodeList?
    if ( x instanceof HTMLCollection || x instanceof NodeList ){
        return zzDOM._build( x );
    }
    
    if ( typeof x === 'string' ){
        x = x.trim();
        return zzDOM._build(
            x.charAt( 0 ) === '<'? // Is it HTML code?
                zzDOM._htmlToElement( x ):
                document.querySelectorAll( x ) // Must be a standard selector
        );
    }
    
    throw 'Unsupported selector type found running zz function.';
};

// Build args array with toInsert as first position and then the arguments of this function
zzDOM._args = function( previousArgs, toInsert ){
    var result = Array.prototype.slice.call( previousArgs );
    result.push( toInsert );
    return result;
};

zzDOM._build = function ( x ) {
    if ( x instanceof Element ){
        return new zzDOM.SS( x );
    }
    if ( x instanceof HTMLCollection || x instanceof NodeList ){
        x = Array.prototype.slice.call( x );
    }
    return x.length === 1? new zzDOM.SS( x[ 0 ] ): new zzDOM.MM( x );
};

zzDOM._getError = function ( method ) {
    return 'Method "' + method + '" not ready for that type!';
};

zzDOM._htmlToElement = function ( html ) {
    var template = document.createElement( 'template' );
    template.innerHTML = html.trim();
    return template.content.childElementCount === 1?
        template.content.firstChild:
        template.content.childNodes;
};

// Register zz function
var zz;
(function() { 
    zz = zzDOM.zz; 
})();

zzDOM._events = {};

zzDOM._addEventListener = function( ss, eventName, listener, useCapture ){
    var el = ss.el;
    var elId = ss._getElId();
    var thisEvents = zzDOM._events[ elId ];
    if ( ! thisEvents ){
        thisEvents = {};
        zzDOM._events[ elId ] = thisEvents;
    }
    var thisListeners = thisEvents[ eventName ];
    if ( ! thisListeners ){
        thisListeners = [];
        thisEvents[ eventName ] = thisListeners;
    }
    thisListeners.push( listener );
    
    // addEventListener
    el.addEventListener( eventName, listener, useCapture );
};

//TODO must remove all listeners when an element is removed
zzDOM._removeEventListener = function( ss, eventName, listener, useCapture ){
    var el = ss.el;
    var elId = ss._getElId();
    var thisEvents = zzDOM._events[ elId ];
    if ( ! thisEvents ){
        return;
    }
    
    if ( ! eventName ){ 
        // Must remove all events
        for ( var currentEventName in thisEvents ){
            var currentListeners = thisEvents[ currentEventName ];
            zzDOM._removeListeners( el, currentListeners, null, useCapture, currentEventName );
        }
        return;
    }
    
    // Must remove listeners of only one event
    var thisListeners = thisEvents[ eventName ];
    zzDOM._removeListeners( el, thisListeners, listener, useCapture, eventName );
};

//TODO test all the listeners are removed
zzDOM._removeListeners = function( el, thisListeners, listener, useCapture, eventName ){
    if ( ! thisListeners ){
        return;
    }
    for ( var i = 0; i < thisListeners.length; ++i ){
        var currentListener = thisListeners[ i ];
        if ( ! listener || currentListener === listener ){
            thisListeners.splice( i, 1 ); // Delete listener at i position
            el.removeEventListener( eventName, currentListener, useCapture );
            if ( listener ){
                return;
            }
        }
    } 
};
/* End of events */

zzDOM._dd = {};

zzDOM._getDefaultDisplay = function( el ) {
    var nodeName = el.nodeName;
    var display = zzDOM._dd[ nodeName ];

    if ( display ) {
        return display;
    }

    var doc = el.ownerDocument;
    var temp = doc.body.appendChild( doc.createElement( nodeName ) );
    display = getComputedStyle( temp )[ 'display' ];

    temp.parentNode.removeChild( temp );

    if ( display === 'none' ) {
        display = 'block';
    }
    zzDOM._dd[ nodeName ] = display;

    return display;
};
/* End of visible */

/* It depends on forms plugin! */
// Serialize a ss instance, a mm instance or an object into a query string
zzDOM._paramItem = function( r, key, value ) {
    r.push( 
        encodeURIComponent( key ) + '=' + encodeURIComponent( value == null? '': value )
    );
};
/** @nocollapse */
zzDOM.param = function( x ) {
	
    if ( x == null ) {
        return '';
    }

    var r = [];
    
    if ( x instanceof zzDOM.SS ){
        zzDOM._paramItem( r, x.attr( 'name' ), x.val() );
    } else if ( x instanceof zzDOM.MM ){
        for ( var c = 0; c < x.list.length; ++c ){
            var ss = x.list[ c ];
            zzDOM._paramItem( r, ss.attr( 'name' ), ss.val() );
        }
    } else if ( typeof x === 'object' ){  
        for ( var i in x ) {
            zzDOM._paramItem( r, i, x[ i ] );
        }
    } else {
        throw zzDOM._getError( 'param' );
    }

    return r.join( '&' );
};
/* end of utils */

/** @constructor */
zzDOM.SS = function ( _el ) {
    this.el = _el;
    this.nodes = [ _el ];
    
    // Array like
    this.length = 1;
    this[ 0 ] = _el;
};

/* Methods NOT included in jquery */
zzDOM.SS.prototype._gcs = function ( self, property ) {
    var x = getComputedStyle( self.el, null )[ property ].replace( 'px', '' );
    return isNaN( x )? x: parseFloat( x );
};

zzDOM.SS.prototype._getElId = function(){
    var elId = this.el.getAttribute( 'data-elId' );
    if ( ! elId ){
        // Generate a random string with 4 chars
        elId = Math.floor( ( 1 + Math.random() ) * 0x10000 )
            .toString( 16 )
            .substring( 1 );
        this.el.setAttribute( 'data-elId', elId );
    }
    return elId;
};

zzDOM.SS.prototype._insertHelper = function ( position, x ) {
    if ( x instanceof Element ){
        this.el.insertAdjacentElement( position, x );
    } else if ( x instanceof zzDOM.SS ){
        this.el.insertAdjacentElement( position, x.el );
    } else if ( typeof x === 'string' ) {
        this.el.insertAdjacentHTML( position, x );
    } else {
        throw 'Insert operation not ready for that type!';
    }
    return this;
};

zzDOM.SS.prototype._iterate = function( value, fn ){
    if ( Array.isArray( value ) ){
        for ( var i = 0; i < value.length; ++i ){
            fn( this, value[ i ] );
        }
    } else {
        fn( this, value );   
    }
    return this;
};

zzDOM.SS.prototype._outer = function ( property, linked1, linked2, withMargin ) {
    if ( this.el[ 'offset' + property ] ) {
        return zzDOM.SS._outerCalc( this, property, linked1, linked2, withMargin );
    }
    
    var self = this;
    return this._swap( 
        this.el, 
        function(){
            return zzDOM.SS._outerCalc( self, property, linked1, linked2, withMargin );
        } 
    );
};

zzDOM.SS._outerCalc = function ( ss, property, linked1, linked2, withMargin ) {
    var value = ss._gcs( ss, property.toLowerCase() );
    var padding = ss._gcs( ss, 'padding' + linked1 ) + ss._gcs( ss, 'padding' + linked2 );
    var border = ss._gcs( ss, 'border' + linked1 + 'Width' ) + ss._gcs( ss, 'border' + linked2 + 'Width' );
    
    var total = value + padding + border;
    
    // No margin
    if ( ! withMargin ){
        return total;
    }
    
    var margin = ss._gcs( ss, 'margin' + linked1 ) + ss._gcs( ss, 'margin' + linked2 );
    return total + margin;
};

zzDOM.SS.prototype._setCssUsingKeyValue = function ( key, value ) {
    if ( typeof value === 'function' ) {
        value = value.call( this.el, this._i === undefined? 0: this._i, this );
    }
    this.el.style[ key ] = 
        typeof value === 'string' && ! /^-?\d+\.?\d*$/.test( value )? // if it is a string and is not a float number
            value: 
            value + 'px';
};

zzDOM.SS.prototype._setCssUsingObject = function ( object ) {
    for ( var key in object ) {
        this._setCssUsingKeyValue( key, object[ key ] );
    }
};

/**
 * @param {string} property
 * @param {string|Function=} value
 */
zzDOM.SS.prototype._styleProperty = function ( property, value ) {
    // get
    if ( value === undefined ){
        var self = this;
        value = this._gcs( this, property );
        return parseFloat( 
            value !== 'auto'? 
                value: 
                this._swap( 
                    this.el, 
                    function(){
                        return self._gcs( self, property );
                    } 
                )
        );
    }

    // set
    this._setCssUsingKeyValue( property, value );
    return this;
};

zzDOM.SS.prototype._swap = function( _el, callback ) {
    var old = {};
    var options = {
        display: 'block',
        position: 'absolute',
        visibility: 'hidden'
    };

    // Remember the old values and insert the new ones
    for ( var name in options ) {
        old[ name ] = _el.style[ name ];
        _el.style[ name ] = options[ name ];
    }

    var val = callback.call( _el );

    // Revert the old values
    for ( name in options ) {
        _el.style[ name ] = old[ name ];
    }

    return val;
};

/* Methods included in jquery */
zzDOM.SS.prototype.addClass = function ( name ) {
    return this._iterate(
        name,
        function( self, v ){
            self.el.classList.add( v ); 
        }
    );
};

zzDOM.SS.prototype.after = function ( x ) {
    return this._insertHelper( 'afterend', x );
};

zzDOM.SS.prototype.append = function ( x ) {
    if ( x instanceof Element ){
        this.el.appendChild( x );
    } else if ( x instanceof zzDOM.SS ){
        this.el.appendChild( x.el );
    } else if ( typeof x === 'string' ) {
        this.el.insertAdjacentHTML( 'beforeend', x );
    } else {
        throw zzDOM._getError( 'append' );
    }
    return this;
};

zzDOM.SS.prototype.appendTo = function ( x ) {
    // Do nothing and return this if it is null
    if ( x == null ){
        return this;    
    }
    
    // Is it a Element?
    if ( x instanceof Element ){
        x.appendChild( this.el );
        return this;
    }
    
    // Is it a string?
    if ( typeof x === 'string' ){
        x = zzDOM._build(
            document.querySelectorAll( x )
        );
    }
    
    // Is it a zzDOM.SS?
    if ( x instanceof zzDOM.SS ) {
        x.el.appendChild( this.el );
        return this;
    }
    
    // Is it a zzDOM.MM?
    if ( x instanceof zzDOM.MM ) {
        for ( var i = 0; i < x.nodes.length; ++i ){
            x.nodes[ i ].appendChild( this.el.cloneNode( true ) );
        }
        return this;
    } 
    
    throw zzDOM._getError( 'is' );
};

//TODO add support of function type in value
/**
 * @param {string|Object} x
 * @param {string=} value
 */
zzDOM.SS.prototype.attr = function ( x, value ) {
    // set using object
    if ( typeof x === 'object' ){
        for ( var key in x ) {
            this.attr( key, x[ key ] );
        }
        return this;
    }
    
    // get
    if ( value === undefined ){
        return this.el.getAttribute( x );
    }
    
    // remove attr
    if ( value === null ){
        return this.removeAttr( x );    
    }
    
    // set
    this.el.setAttribute( x, value );
    return this;
};

zzDOM.SS.prototype.before = function ( x ) {
    return this._insertHelper( 'beforebegin', x );
};

zzDOM.SS.prototype.children = function ( selector ) {
    return zzDOM._build( 
        selector?
            Array.prototype.filter.call(
                this.el.children, 
                function( child ){
                    return child.matches( selector );
                }
            ):
            this.el.children 
    );
};

zzDOM.SS.prototype.clone = function (  ) {
    return new zzDOM.SS( this.el.cloneNode( true ) );
};

//TODO add support of function type in value
/**
 * @param {string|Object} x1
 * @param {string|number=} x2
 */
zzDOM.SS.prototype.css = function ( x1, x2 ) {
    var number = arguments.length;
    
    if ( number === 1 ){
        if ( ! x1 ){
            throw 'Null value not allowed in css method!';
        }
        
        // get
        if ( typeof x1 === 'string' ) {
            return getComputedStyle( this.el )[ x1 ];
        }
        
        // set using object
        if ( typeof x1 === 'object' ){
            this._setCssUsingObject( x1 );
            return this;
        }
        
        throw 'Wrong type or argument in css method!';
    }
    
    // set using key value pair
    if ( number === 2 ){
        this._setCssUsingKeyValue( x1, x2 );
        return this;
    }
    
    throw 'Wrong number of arguments in css method!';
};

zzDOM.SS.prototype.each = function ( eachFn ) {
    eachFn.call( this.el, 0, this, this.nodes );
    return this;
};

zzDOM.SS.prototype.empty = function (  ) {
    while( this.el.firstChild ){
        this.el.removeChild( this.el.firstChild );
    }
    return this;
};

zzDOM.SS.prototype.filter = function ( x ) {
    if ( typeof x === 'string' ){ // Is a string selector
        return zzDOM._build( 
            this.el.matches( x )? [ this.el ]: []
        );
    }
    
    if ( typeof x === 'function' ){ // Is a function
        return zzDOM._build(
            x.call( this.el, this._i === undefined? 0: this._i, this )? [ this.el ]: []
        );
    }  
    
    throw zzDOM._getError( 'filter' );
};

zzDOM.SS.prototype.find = function ( selector ) {
    return zzDOM._build( 
        this.el.querySelectorAll( selector )
    );
};

zzDOM.SS.prototype.hasClass = function ( name ) {
    return this.el.classList.contains( name );
};

zzDOM.SS.prototype.height = function ( value ) {
    return this._styleProperty( 'height', value );
};

//TODO add support of function type in value
zzDOM.SS.prototype.html = function ( value ) {
    // get
    if ( value === undefined ){
        return this.el.innerHTML;
    }

    // set
    this.el.innerHTML = value;
    return this;
};

zzDOM.SS.prototype.index = function () {
    if ( ! this.el ){
        return -1;
    }
    
    var i = 0;
    var currentEl = this.el;
    do {
        i++;
    } while ( currentEl = currentEl.previousElementSibling );
    
    return i;
};

zzDOM.SS.prototype.is = function ( x ) {
    if ( x == null ){
        return false;    
    }
    
    if ( x instanceof Element ){
        return this.el === x;
    }
    
    if ( x instanceof zzDOM.SS ) {
        return this.el === x.el;
    } 

    if ( x instanceof zzDOM.MM ) {
        for ( var i = 0; i < x.nodes.length; ++i ){
            if ( this.el === x.nodes[ i ] ){
                return true;
            }
        }
        return false;
    } 

    if ( typeof x === 'string' ){
        return this.el.matches( x );
    }
    
    return false;
};

zzDOM.SS.prototype.next = function () {
    return new zzDOM.SS( this.el.nextElementSibling );
};

zzDOM.SS.prototype.offset = function ( c ) {
    
    // set top and left using css
    if ( c ){
        this._styleProperty( 'top', c.top );
        this._styleProperty( 'left', c.left );
        return this;
    }
    
    // get
    var rect = this.el.getBoundingClientRect();
    return {
        top: rect.top + document.body.scrollTop,
        left: rect.left + document.body.scrollLeft
    };
};

zzDOM.SS.prototype.offsetParent = function () {
    var offsetParent = this.el.offsetParent;
    return offsetParent? new zzDOM.SS( offsetParent ): this;
};

/**
 * @param {boolean=} withMargin
 */
zzDOM.SS.prototype.outerHeight = function ( withMargin ) {
    return this._outer( 'Height', 'Top', 'Bottom', withMargin );
};

/**
 * @param {boolean=} withMargin
 */
zzDOM.SS.prototype.outerWidth = function ( withMargin ) {
    return this._outer( 'Width', 'Left', 'Right', withMargin );
};

zzDOM.SS.prototype.parent = function () {
    return new zzDOM.SS( this.el.parentNode );
};

zzDOM.SS.prototype.position = function ( relativeToViewport ) {
    return relativeToViewport?
        this.el.getBoundingClientRect():
        { 
            left: this.el.offsetLeft, 
            top: this.el.offsetTop
        };
};

zzDOM.SS.prototype.prepend = function ( x ) {
    if ( x instanceof Element ){
        this.el.insertBefore( x, this.el.firstChild );
    } else if ( x instanceof zzDOM.SS ){
        this.el.insertBefore( x.el, this.el.firstChild );
    } else if ( typeof x === 'string' ){
        this.el.insertAdjacentHTML( 'afterbegin', x );
    } else {
        throw zzDOM._getError( 'prepend' );
    }
    return this;
};

zzDOM.SS.prototype.prev = function () {
    return new zzDOM.SS( this.el.previousElementSibling );
};

zzDOM.SS.prototype.remove = function () {
    this.el.parentNode.removeChild( this.el );
    return this;
};

zzDOM.SS.prototype.removeAttr = function ( name ) {
    this.el.removeAttribute( name );
    return this;
};

zzDOM.SS.prototype.removeClass = function ( name ) {
    if ( ! name ){
        this.el.className = '';
        return this;
    }
    
    return this._iterate(
        name,
        function( self, v ){
            self.el.classList.remove( v );
        }
    );
};

zzDOM.SS.prototype.replaceWith = function ( value ) {
    this.el.outerHTML = value;
    return this;
};

zzDOM.SS.prototype.siblings = function ( selector ) {
    var self = this;
    var nodes = Array.prototype.filter.call( 
        this.el.parentNode.children, 
        selector?
            function( child ){
                return child !== self.el && child.matches( selector );
            }:
            function( child ){
                return child !== self.el;
            }
    );
    return zzDOM._build( nodes );
};

//TODO add support of function type in value
zzDOM.SS.prototype.text = function ( value ) {
    // get
    if ( value === undefined ){
        return this.el.textContent;
    }

    // set
    this.el.textContent = value;
    return this;
};

zzDOM.SS.prototype.toggleClass = function ( name, state ) {
    return this._iterate(
        name,
        state === undefined?
            function( self, v ){
                self.el.classList.toggle( v );
            }:
            function( self, v ){
                self.el.classList.toggle( v, state );
            }
    );
};

zzDOM.SS.prototype.width = function ( value ) {
    return this._styleProperty( 'width', value );
};

zzDOM.SS.prototype.off = function ( eventName, listener, useCapture ) {
    zzDOM._removeEventListener( this, eventName, listener, useCapture );
    return this;
};

zzDOM.SS.prototype.on = function ( eventName, listener, data, useCapture ) {
    zzDOM._addEventListener( 
        this, 
        eventName, 
        data? 
            function( e ){
                e.data = data;
                return listener.call( e.currentTarget, e );
            }:
            listener, 
        useCapture 
    );
    return this;
};

zzDOM.SS.prototype.trigger = function ( eventName ) {
    var event = document.createEvent( 'HTMLEvents' );
    event.initEvent( eventName, true, false );
    this.el.dispatchEvent( event );
    return this;
};
/* End of events */

zzDOM.SS.prototype.hide = function () {
    if ( this.isVisible() ){
        this.attr( 
            'data-display', 
            getComputedStyle( this.el, null )[ 'display' ]
        );
        this.el.style.display = 'none';
    }
    return this;
};

zzDOM.SS.prototype.isVisible = function () {
    return !! this.el.offsetParent;
    //return getComputedStyle( this.el, null ).getPropertyValue( 'display' ) !== 'none';
};

zzDOM.SS.prototype.show = function () {
    if ( ! this.isVisible() ){
        var display = this.attr( 'data-display' );
        this.el.style.display = display? display: zzDOM._getDefaultDisplay( this.el );
    }
    return this;
};

zzDOM.SS.prototype.toggle = function ( state ) {
    var value = state !== undefined? ! state: this.isVisible();
    return value? this.hide(): this.show();
};
/* End of visible */

zzDOM.SS.prototype.checked = function ( check ) {
    if ( this.el.nodeName !== 'INPUT' || ( this.el.type !== 'checkbox' && this.el.type !== 'radio') ) {
        throw zzDOM._getError( 'checked' );
    }
    
    // get
    if ( check === undefined ){
        return !! this.el.checked;
    }
    
    // set
    this.el.checked = check;
    return this;
};

/**
 * @param {Array<?>|String=} value
 */
zzDOM.SS.prototype.val = function ( value ) {
    // get
    if ( value === undefined ){
        switch ( this.el.nodeName ) {
        case 'INPUT':
        case 'TEXTAREA':
        case 'BUTTON':
            return this.el.value;
        case 'SELECT':
            var values = [];
            for ( var i = 0; i < this.el.length; ++i ) {
                if ( this.el[ i ].selected ) {
                    values.push( this.el[ i ].value );
                }
            }
            return values.length > 1? values: values[ 0 ];
        default:
            throw zzDOM._getError( 'val' );
        }
    }
    
    // set
    switch ( this.el.nodeName ) {
    case 'INPUT':
    case 'TEXTAREA':
    case 'BUTTON':
        this.el.value = value;
        break;
    case 'SELECT':
        if ( typeof value === 'string' || typeof value === 'number' ) {
            value = [ value ];
        }
        for ( i = 0; i < this.el.length; ++i ) {
            for ( var j = 0; j < value.length; ++j ) {
                this.el[ i ].selected = '';
                if ( this.el[ i ].value === value[ j ] ) {
                    this.el[ i ].selected = 'selected';
                    break;
                }
            }
        }
        break;
    default:
        throw zzDOM._getError( 'val' );
    }
    
    return this;
};
/* End of forms */

zzDOM.SS.prototype.getXCenter = function() {
    return ( document.documentElement.clientWidth - this.outerWidth() ) / 2;
};

zzDOM.SS.prototype.getYCenter = function() {
    return ( document.documentElement.clientHeight - this.outerHeight() ) / 2;
};

zzDOM.SS.prototype.getCenter = function() {
    return {
        left: this.getXCenter(),
        top: this.getYCenter()
    };
};

zzDOM.SS.prototype.center = function() {
    this.offset( 
        this.getCenter() 
    );
    return this;
};

zzDOM.SS.prototype.centerX = function() {
    this.css( 'left', this.getXCenter() );
    return this;
};

zzDOM.SS.prototype.centerY = function() {
    this.css( 'top', this.getYCenter() );
    return this;
};
/* End of center */

/** @constructor */
zzDOM.MM = function ( _nodes ) {    
    this.list = [];
    this.nodes = _nodes;
    this.length = _nodes.length;
    
    // Init nodes
    for ( var i = 0; i < this.length; i++ ) {
        var el = this.nodes[ i ];
        this[ i ] = el; // for array like
        var ss = new zzDOM.SS( el );
        this.list.push( ss );
        ss._i = i; // for index in functions
    }
};

/*
Unify the definition of a function of zzDOM.SS.prototype and a definition of zzDOM.MM.prototype. Example:

    zzDOM.add( 
        zzDOM.SS.prototype.myCustomFunction = function(){
            ...
            return this;
        },
        zzDOM.MM.constructors.concat
    );
);
*/
/**
 * @param {Function} ssPrototype
 * @param {Function=} constructor
 */
zzDOM.add = function( ssPrototype, constructor ){
    for ( var id in zzDOM.SS.prototype ){
        var current = zzDOM.SS.prototype[ id ];
        if ( ssPrototype === current ){
            var closure = function(){
                var functionId = id;
                return constructor? constructor( functionId ): zzDOM.MM.constructors.default( functionId );
            };
            zzDOM.MM.prototype[ id ] = closure();
            return;
        }
    }
    
    throw 'Error registering zzDOM.MM: zzDOM.SS not found.';
};

zzDOM.MM.constructors = {};
zzDOM.MM.constructors.booleanOr = function( functionId ){
    return function(){
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var x = ss[ functionId ].apply( ss, arguments );
            if ( x ){
                return true;
            }
        }
        return false;
    };
};
zzDOM.MM.constructors.concat = function( functionId ){
    return function(){
        var newNodes = [];
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var x = ss[ functionId ].apply( ss, arguments );
            newNodes = newNodes.concat( x.nodes );
        }
        return zzDOM._build( newNodes );
    };
};
zzDOM.MM.constructors.default = function( functionId ){
    return function(){
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var r = ss[ functionId ].apply( ss, arguments );
            if ( i === 0 && ! ( r instanceof zzDOM.SS ) ){
                return r;
            }
        }
        return this;
    };
};

// Init prototype functions from zzDOM.SS
zzDOM.MM.init = function(){
    // Concat functions
    var concatF = [
        'children',
        'clone',
        'filter',
        'find',
        'next',
        'offsetParent',
        'parent',
        'prev',
        'siblings'
    ];
    // Boolean functions
    var booleanOrF = [
        'hasClass',
        'is'
    ];
    for ( var id in zzDOM.SS.prototype ){
        var closure = function(){
            var functionId = id;
            
            if ( concatF.indexOf( functionId ) !== -1 ){
                return zzDOM.MM.constructors.concat( functionId );
            }
            if ( booleanOrF.indexOf( functionId ) !== -1 ){
                return zzDOM.MM.constructors.booleanOr( functionId );
            }
            return zzDOM.MM.constructors.default( functionId );
        };
        zzDOM.MM.prototype[ id ] = closure();
    }
}();

/* Methods included in jquery */
zzDOM.MM.prototype.each = function ( eachFn ) {
    var self = this;
    Array.prototype.forEach.call( 
        this.list, 
        function( currentValue, index ){
            eachFn.call( currentValue.el, index, currentValue, self.nodes );
        }
    );
    return this;
};

// Register zzDOM if we are using Node
if ( typeof module === 'object' && module.exports ) {
    module.exports = zzDOM;
}

},{}],104:[function(require,module,exports){
var zzDOM = require('./build/zzDOM-closures-full.js');
module.exports = zzDOM.zz;

},{"./build/zzDOM-closures-full.js":103}],105:[function(require,module,exports){
var Qunit = require( 'qunit' );
var zz = require( 'zzdom' );
var zpt = require( 'zpt' );
var blueRouter = require( '../../build/blueRouter.js' );

// Init router
const initRouter = () => {
    // Initialize pages
    const pages = {};

    // Load js of pages
    const dictionary = {};
    pages[ 'renderWithoutWaiting' ] = require( './pages/renderWithoutWaiting.js' )( dictionary );
    pages[ 'renderWaitingForServer' ] = require( './pages/renderWaitingForServer.js' )( dictionary );

    // Initialize options: no animations
    let initializeZPT = true;
    let options = {
        eventsByPage: pages,
        animationIn: false,
        routes: require( './routesInlineForRender.js' )
    };

    // Add renderFunction
    options.renderFunction = ( page ) => {
        if ( initializeZPT ){
            zpt.run({
                'root': document.body,
                'dictionary': dictionary
            });
            initializeZPT = false;
        } else {
            zpt.run({
                'command': 'partialRender',
                'target': page[ 'el' ]
            });
        }
    };

    // Create new router instance
    return new blueRouter.router( options );
};

// Init router
const router = initRouter();

// Unit tests
require( './render.js' )();


},{"../../build/blueRouter.js":1,"./pages/renderWaitingForServer.js":106,"./pages/renderWithoutWaiting.js":107,"./render.js":108,"./routesInlineForRender.js":109,"qunit":6,"zpt":75,"zzdom":104}],106:[function(require,module,exports){
/* renderWithoutWaiting page */
module.exports = function ( dictionary ) {
    
    var zpt = require( 'zpt' );

    const page = {};

    page[ 'preInit' ] = function( event ){

        dictionary[ 'successMessageFromServer' ] = 'Loading...';
    };

    page[ 'init' ] = function( event ){

        setTimeout(
            function(){
                dictionary[ 'successMessageFromServer' ] = 'It works!';
                zpt.run({
                    'command': 'partialRender',
                    'target': document.getElementById( 'renderWaitingForServer_message' )
                });
            },
            300
        );
    };

    return page;
};

},{"zpt":75}],107:[function(require,module,exports){
/* renderWithoutWaiting page */

module.exports = function ( dictionary ) {

    const page = {};

    page[ 'preInit' ] = function( event ){
        //alert( 'EVENT_PRE_INIT' );

        dictionary[ 'successMessage' ] = 'It works!';
    };

    return page;
};

},{}],108:[function(require,module,exports){
// Tests for events

var zz = require( 'zzdom' );
var utils = require( './utils.js' );
var Qunit = require( 'qunit' );

// Unit tests
module.exports = function () {

    // Non waiting render test
    QUnit.test( "Non waiting render test", async function( assert ) {
        
        // Get a reference to finish the qunit test later
        var done = assert.async();

        // Go to page renderWithoutWaiting
        zz('#home_renderWithoutWaitingLink').el.click();
        await utils.waitShort();
        assert.equal( zz('#renderWithoutWaiting_p').text().trim() , "This is Page render without waiting" );

        // Check that render is ok
        assert.equal( zz('#renderWithoutWaiting_message').text().trim() , "It works!" );

        // Go to home page
        zz('#renderWithoutWaiting_homeLink').el.click();
        await utils.waitShort();

        // Finish qunit test
        done();
    });

    // Waiting for server render test
    QUnit.test( "Waiting for server render test", async function( assert ) {
        
        // Get a reference to finish the qunit test later
        var done = assert.async();

        // Go to page renderWithoutWaiting
        zz('#home_renderWaitingForServerLink').el.click();
        await utils.waitShort();
        assert.equal( zz('#renderWaitingForServer_p').text().trim() , "This is Page render waiting for server" );
        await utils.waitShort();
        
        // Check that render is ok
        assert.equal( zz('#renderWaitingForServer_message').text().trim() , "It works!" );

        // Go to home page
        zz('#renderWaitingForServer_homeLink').el.click();
        await utils.waitShort();

        // Finish qunit test
        done();
    });

};

},{"./utils.js":110,"qunit":6,"zzdom":104}],109:[function(require,module,exports){
// Routes for inline content for render tests

const routes = [
    // Home page
    {
        id: '[home]',
        content: `
<h1>Blue router test</h1>

<div class="page-content">
<h3>Home page</h3>
<p>
    This is Home page
</p>

<ul id="home_links">
    <li>
        <a href="!renderWithoutWaiting" id="home_renderWithoutWaitingLink">Page render without waiting</a>. Go to page render without waiting.
    </li>
    <li>
        <a href="!renderWaitingForServer" id="home_renderWaitingForServerLink">Page render waiting for server</a>. Go to page render waiting for server.
    </li>
</ul>
</div>
`
    },
    // page render without waiting
    {
        id: 'renderWithoutWaiting',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="renderWithoutWaiting_homeLink">Home</a>
</div>

<div class="page-content">
<h3>Page render</h3>
<p id="renderWithoutWaiting_p">
    This is Page render without waiting
</p>

<h2 id="renderWithoutWaiting_message" data-content="successMessage">
    Not working!
</h2>
</div>
`
    },
    // page render waiting for server
    {
        id: 'renderWaitingForServer',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="renderWaitingForServer_homeLink">Home</a>
</div>

<div class="page-content">
<h3>Page render</h3>
<p id="renderWaitingForServer_p">
    This is Page render waiting for server
</p>

<h2 id="renderWaitingForServer_message" data-content="successMessageFromServer">
    Not working!
</h2>
</div>
`
    },
    // Default route (404 page)
    {
        id: '[404]',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="e404_homeLink">Home</a>
</div>

<div class="page-content">
<h3>404 page</h3>
<p>
    Sorry
</p>
<p id="e404_p">
    Requested content not found.
</p>
</div>
`
    }
];

module.exports = routes;



},{}],110:[function(require,module,exports){
const utils = {};

utils.waitShort = function() {
    return utils.wait( 1000 );
};

utils.wait = function( timeout ) {
    return new Promise( resolve => {
        setTimeout( resolve, timeout );
    });
};

module.exports = utils;


},{}]},{},[105])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9ibHVlUm91dGVyLmpzIiwibm9kZV9tb2R1bGVzL2xvYWRqcy9kaXN0L2xvYWRqcy51bWQuanMiLCJub2RlX21vZHVsZXMvbG9nNGphdmFzY3JpcHQvbG9nNGphdmFzY3JpcHQuanMiLCJub2RlX21vZHVsZXMvbWVzc2FnZWZvcm1hdC9tZXNzYWdlZm9ybWF0LmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy9xdW5pdC9xdW5pdC9xdW5pdC5qcyIsIm5vZGVfbW9kdWxlcy90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9JMThOL2kxOG5Eb21haW4uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL0kxOE4vaTE4bkxhbmd1YWdlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbERlZmluZU1hY3JvLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbEZpbGxTbG90LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbFVzZU1hY3JvLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvY29udGVudEhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbEF0dHJpYnV0ZXMuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxDb25kaXRpb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxDb250ZW50LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsRGVjbGFyZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbERlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbE9taXRUYWcuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxPbkVycm9yLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsUmVwZWF0LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsUmVwbGFjZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9jYWNoZS9hdHRyaWJ1dGVDYWNoZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2NhY2hlL2NhY2hlSGVscGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvY2FjaGUvZXhwcmVzc2lvbkNhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvY29udGV4dC5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2FyaXRobWV0aGljL2FkZEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9hcml0aG1ldGhpYy9hcml0aG1ldGhpY0hlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2FyaXRobWV0aGljL2RpdmlkZUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9hcml0aG1ldGhpYy9tb2RFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvYXJpdGhtZXRoaWMvbXVsdGlwbHlFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvYXJpdGhtZXRoaWMvc3Vic3RyYWN0RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvYW5kRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvYm9vbEhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvY29uZEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9ib29sL25vdEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9ib29sL29yRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vY29tcGFyaXNvbkhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vZXF1YWxzRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vZ3JlYXRlckV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9jb21wYXJpc29uL2luRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vbG93ZXJFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9leGlzdHNFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9leHByZXNzaW9uVG9rZW5pemVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXhwcmVzc2lvbnNVdGlscy5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Zvcm1hdEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9pMThuL3RyQ3VycmVuY3lFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvaTE4bi90ckRhdGVUaW1lRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2kxOG4vdHJIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9pMThuL3RyTnVtYmVyRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2kxOG4vdHJTdHJpbmdFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9hcnJheUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL2Z1bmN0aW9uRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvaW5kaXJlY3Rpb25FeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9saXN0RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvbGl0ZXJhbHMvYm9vbGVhbkxpdGVyYWwuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL2xpdGVyYWxzL251bWVyaWNMaXRlcmFsLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9saXRlcmFscy9zdHJpbmdMaXRlcmFsLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9tZXRob2RFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9wYXRoRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvcGF0aFNlZ21lbnRFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9wcm9wZXJ0eUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL3JhbmdlRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvdmFyaWFibGVFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvc2NyaXB0aW5nL2phdmFzY3JpcHRFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvc2NyaXB0aW5nL3F1ZXJ5RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3N0cmluZ0V4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG4uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG5CdW5kbGUuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG5IZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9sb2dIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9tYWluLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9hdXRvRGVmaW5lSGVscGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kZXBzRGF0YUl0ZW0uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL2Fic3RyYWN0QWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hYnN0cmFjdEFycmF5QWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hYnN0cmFjdE9iamVjdEFjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvYXJyYXlDcmVhdGUuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL2FycmF5RGVsZXRlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hcnJheVVwZGF0ZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvY3NzQW5pbWF0aW9uTWFuYWdlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvZGljdGlvbmFyeUFjdGlvbkJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL29iamVjdERlbGV0ZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvb2JqZWN0VXBkYXRlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9sb29wLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9sb29wSXRlbS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvbm9kZUF0dHJpYnV0ZXMuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL25vZGVSZW1vdmVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9wYXJzZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL3BhcnNlck5vZGVSZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvcGFyc2VyUHJlbG9hZGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9wYXJzZXJSZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvcGFyc2VyVXBkYXRlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Jlc29sdmVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvc2NvcGVzL3JlYWN0aXZlRGljdGlvbmFyeS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Njb3Blcy9zY29wZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Njb3Blcy9zY29wZUJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3ZlcnNpb24uanMiLCJub2RlX21vZHVsZXMvenpkb20vYnVpbGQvenpET00tY2xvc3VyZXMtZnVsbC5qcyIsIm5vZGVfbW9kdWxlcy96emRvbS9pbmRleC5qcyIsInRlc3QvanMvb3V0VHJhbnNpdGlvblJlbmRlci5qcyIsInRlc3QvanMvcGFnZXMvcmVuZGVyV2FpdGluZ0ZvclNlcnZlci5qcyIsInRlc3QvanMvcGFnZXMvcmVuZGVyV2l0aG91dFdhaXRpbmcuanMiLCJ0ZXN0L2pzL3JlbmRlci5qcyIsInRlc3QvanMvcm91dGVzSW5saW5lRm9yUmVuZGVyLmpzIiwidGVzdC9qcy91dGlscy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0bUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFVQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMVFBO0FBQ0E7O0FDREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7OztBQ3RvT0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUMzRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BLQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xRQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9FQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMU5BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzYUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDL0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzTUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcEhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeExBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzdHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25LQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BCQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3JJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ2hqQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQzlFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDbkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDblpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOU9BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN0VEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaFBBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFpQ0E7QUFDQTtBQUNBOztBQ0ZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNUJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNkQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyohIGJsdWVyb3V0ZXIgLSB2MC4xLjAgLSAyMDI1LTAxLTE2IDEzOjMxOjI4ICovXG4vKipcbiAqIEEgbmFtZXNwYWNlLlxuICogQGNvbnN0XG4gKi9cbmNvbnN0IGJsdWVSb3V0ZXIgPSB7fTtcblxuXG4vKiogQGNvbnN0cnVjdG9yICovXG5ibHVlUm91dGVyLnJvdXRlciA9IGZ1bmN0aW9uICggdXNlck9wdGlvbnMgKSB7XG5cbiAgICAvLyBJbml0IG9wdGlvbnNcbiAgICB0aGlzLm9wdGlvbnMgPSB7fTtcbiAgICBibHVlUm91dGVyLnV0aWxzLmV4dGVuZCggdGhpcy5vcHRpb25zLCBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLCB1c2VyT3B0aW9ucyApO1xuICAgIHRoaXMuY2hlY2tPcHRpb25zKCk7XG5cbiAgICAvLyBQcmVsb2FkIHBhZ2VzIGlmIG5lZWRlZFxuICAgIGlmICggdGhpcy5vcHRpb25zLnByZWxvYWRQYWdlc09uTG9hZCApe1xuICAgICAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgICAgIGJsdWVSb3V0ZXIuaHRtbEZldGNoZXIubG9hZEFsbFVybHMoXG4gICAgICAgICAgICB0aGlzLFxuICAgICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgICAgIHNlbGYuaW5pdCgpO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRG8gbm90IHByZWxvYWQgcGFnZXMsIHJ1biBpbml0XG4gICAgdGhpcy5pbml0KCk7XG59O1xuXG4vKiBNZXRob2RzICovXG5cbi8qKiBAc3VwcHJlc3Mge21pc3NpbmdQcm9wZXJ0aWVzfSAqL1xuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmluaXQgPSBmdW5jdGlvbigpIHtcblxuICAgIC8vIEluaXQgc29tZSBvdGhlciB2YXJzXG4gICAgdGhpcy5yb3V0ZXNNYXAgPSB0aGlzLmNyZWF0ZVJvdXRlc01hcCgpO1xuICAgIHRoaXMuc3RhY2sgPSBbXTtcblxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnNcbiAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzRm9yV2luZG93KCk7XG5cbiAgICAvLyBOYXZpZ2F0ZSB0byB3aW5kb3cubG9jYXRpb24uaHJlZiBvciBob21lXG4gICAgdGhpcy5uYXZpZ2F0ZVVybChcbiAgICAgICAgdGhpcy5vcHRpb25zLnVwZGF0ZU9uTG9hZD8gd2luZG93LmxvY2F0aW9uLmhyZWY6ICcnLFxuICAgICAgICB0aGlzLm9wdGlvbnMuYW5pbWF0ZVRyYW5zaXRpb25zT25Mb2FkXG4gICAgKTtcbn07XG5cbi8vIENoZWNrIHRoYXQgbWFuZGF0b3J5IHVzZXIgZGVmaW5lZCBwcm9wZXJ0aWVzIGFyZSBkZWZpbmVkXG4vKiogQHN1cHByZXNzIHttaXNzaW5nUHJvcGVydGllc30gKi9cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5jaGVja09wdGlvbnMgPSBmdW5jdGlvbigpIHtcblxuICAgIGxldCBlcnJvcnMgPSAwO1xuICAgIGxldCBlcnJvck1lc3NhZ2VzID0gJyc7XG5cbiAgICBpZiAoICEgdGhpcy5vcHRpb25zLnJvdXRlcyApe1xuICAgICAgICArK2Vycm9ycztcbiAgICAgICAgZXJyb3JNZXNzYWdlcyArPSAncm91dGVzIG11c3QgYmUgZGVmaW5lZC4gJztcbiAgICB9XG5cbiAgICBpZiAoICEgdGhpcy5vcHRpb25zLmV2ZW50c0J5UGFnZSApe1xuICAgICAgICArK2Vycm9ycztcbiAgICAgICAgZXJyb3JNZXNzYWdlcyArPSAnZXZlbnRzQnlQYWdlIG11c3QgYmUgZGVmaW5lZC4gJztcbiAgICB9XG5cbiAgICBpZiAoIGVycm9ycyApe1xuICAgICAgICB0aGlzLmFsZXJ0RXJyb3IoICdVbmFibGUgdG8gaW5pdGFsaXplIEJsdWUgcm91dGVyLiAnICsgZXJyb3JzICsgJyBlcnJvcnMgZm91bmQ6ICcgKyBlcnJvck1lc3NhZ2VzICk7XG4gICAgfVxufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmFsZXJ0RXJyb3IgPSBmdW5jdGlvbiggbWVzc2FnZSApe1xuICAgIGFsZXJ0KCBtZXNzYWdlICk7XG4gICAgdGhyb3cgbWVzc2FnZTtcbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyc0ZvcldpbmRvdyA9IGZ1bmN0aW9uKCkge1xuICAgIC8qXG4gICAgd2luZG93Lm9ubG9hZCA9ICgpID0+IHtcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVVybCggdGhpcy5vcHRpb25zLnVwZGF0ZU9uTG9hZD8gd2luZG93LmxvY2F0aW9uLmhyZWY6ICcnLCB0cnVlICk7XG4gICAgfVxuICAgICovXG4gICAgd2luZG93Lm9ucG9wc3RhdGUgPSAoIGUgKSA9PiB7XG4gICAgICAgIHRoaXMubmF2aWdhdGVVcmwoIHdpbmRvdy5sb2NhdGlvbi5ocmVmLCB0cnVlICk7XG4gICAgICAgIC8vdGhpcy5uYXZpZ2F0ZVVybCggZS5zdGF0ZVsgJ3BhZ2UnIF0sIHRydWUgKTtcbiAgICB9O1xufTtcblxuLyoqIEBzdXBwcmVzcyB7bWlzc2luZ1Byb3BlcnRpZXN9ICovXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuYWRkRXZlbnRMaXN0ZW5lcnNGb3JMaW5rcyA9IGZ1bmN0aW9uKCBwYWdlSWQgKSB7XG4gICAgXG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuXG4gICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVycyBmb3IgYSBlbGVtZW50c1xuICAgIGJsdWVSb3V0ZXIudXRpbHMuYWRkRXZlbnRMaXN0ZW5lck9uTGlzdChcbiAgICAgICAgLy9kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ2EnICksXG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBwYWdlSWQgKS5nZXRFbGVtZW50c0J5VGFnTmFtZSggJ2EnICksXG4gICAgICAgICdjbGljaycsIFxuICAgICAgICAoZSkgPT4ge1xuICAgICAgICAgICAgY29uc3QgaHJlZiA9IGUudGFyZ2V0LmdldEF0dHJpYnV0ZSggJ2hyZWYnICk7XG5cbiAgICAgICAgICAgIC8vIEZvbGxvdyB0aGUgbGluayBpZiBpdCBpcyBleHRlcm5hbCAoaWYgaXQgaXMgbWFya2VkIGFzIGV4dGVybmFsIGluIHRoZSBjbGFzcyBsaXN0KVxuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGlmICggZS50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zICggc2VsZi5vcHRpb25zLmV4dGVybmFsQ2xhc3MgKSApe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICovXG4gICAgICAgICAgICAvLyBGb2xsb3cgdGhlIGxpbmsgaWYgaXQgaXMgZXh0ZXJuYWwgKGlmIGl0IGRvZXMgbm90IHN0YXJ0IGJ5ICEpXG4gICAgICAgICAgICBpZiAoICEgaHJlZi5zdGFydHNXaXRoKCBzZWxmLm9wdGlvbnMuUEFHRV9QUkVGSVggKSApe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgaGlzdG9yeS5wdXNoU3RhdGUoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAncGFnZSc6IGhyZWZcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICdwYWdlICcgKyBocmVmLFxuICAgICAgICAgICAgICAgICcjJyArIGhyZWZcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBzZWxmLm5hdmlnYXRlVXJsKCBocmVmLCB0cnVlICk7XG4gICAgICAgIH1cbiAgICApO1xufTtcblxuLy8gQ3JlYXRlIGEgbWFwIHdpdGggdGhlIGRhdGEgaW4gcm91dGVzLCB1c2luZyB0aGUgcGF0aCBhcyB0aGUga2V5XG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuY3JlYXRlUm91dGVzTWFwID0gZnVuY3Rpb24oKSB7XG5cbiAgICBjb25zdCByb3V0ZXJNYXAgPSB7fTtcbiAgICBjb25zdCByb3V0ZXMgPSB0aGlzLm9wdGlvbnMucm91dGVzIHx8IFtdO1xuXG4gICAgcm91dGVzLm1hcCggcm91dGVJdGVtID0+IHtcbiAgICAgICAgcm91dGVyTWFwWyByb3V0ZUl0ZW0uaWQgXSA9IHJvdXRlSXRlbTtcbiAgICB9KTtcblxuICAgIHJldHVybiByb3V0ZXJNYXA7XG59O1xuXG4vKiogQHN1cHByZXNzIHttaXNzaW5nUHJvcGVydGllc30gKi9cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5nZXRSb3V0ZUl0ZW0gPSBmdW5jdGlvbiggcGFnZUlkICkge1xuXG4gICAgLy8gTG9vayBmb3IgdGhlIHJvdXRlXG4gICAgbGV0IHJvdXRlSXRlbSA9IHRoaXMucm91dGVzTWFwWyBwYWdlSWQgXTtcbiAgICBpZiAoIHJvdXRlSXRlbSApe1xuICAgICAgICByZXR1cm4gcm91dGVJdGVtO1xuICAgIH1cblxuICAgIC8vIE5vIHJvdXRlIGZvdW5kLCA0MDQgZXJyb3JcbiAgICByb3V0ZUl0ZW0gPSB0aGlzLnJvdXRlc01hcFsgdGhpcy5vcHRpb25zLlBBR0VfSURfNDA0X0VSUk9SIF07XG4gICAgaWYgKCByb3V0ZUl0ZW0gKXtcbiAgICAgICAgcmV0dXJuIHJvdXRlSXRlbTtcbiAgICB9XG5cbiAgICAvLyBObyA0MDQgcGFnZSwgYnVpbGQgYSA0MDQgcm91dGVcbiAgICByZXR1cm4ge1xuICAgICAgICBpZDogdGhpcy5vcHRpb25zLlBBR0VfSURfNDA0X0VSUk9SLFxuICAgICAgICBjb250ZW50OiAnPGgzPjQwNCAtIFBhZ2Ugbm90IGZvdW5kOiAnICsgcGFnZUlkICsgJzwvaDM+J1xuICAgIH07XG4gICAgLy90aGlzLmFsZXJ0RXJyb3IoICdObyByb3V0ZSBmb3VuZCB3aXRoIGlkICcgKyBwYWdlSWQgKyAnIGFuZCBubyA0MDQgcGFnZSBmb3VuZC4nICk7XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUubmF2aWdhdGVVcmwgPSBmdW5jdGlvbiggdXJsLCBtdXN0QW5pbWF0ZUJ5Q29kZSApIHtcbiAgICAvL2FsZXJ0KCAnbmF2aWdhdGVVcmxcXG51cmw6ICcgKyB1cmwgKTtcblxuICAgIC8vIENyZWF0ZSBhbiB1cmwgb2JqZWN0IHRvIG1ha2UgaXQgZWFzeSBldmVyeXRoaW5nXG4gICAgbGV0IHVybE9iamVjdCA9IGJsdWVSb3V0ZXIudXRpbHMuYW5hbGl6ZVVybCggdXJsLCB0aGlzLm9wdGlvbnMgKTtcblxuICAgIC8vIFVwZGF0ZSBzdGFjayBhbmQgZ2V0IGN1cnJlbnRQYWdlSWRcbiAgICBsZXQgY3VycmVudFBhZ2VJZCA9IHRoaXMudXBkYXRlU3RhY2soIHVybE9iamVjdC5wYWdlICk7XG5cbiAgICAvLyBFeGl0IGlmIHRyeWluZyB0byBuYXZpZ2F0ZSB0byBjdXJyZW50IHBhZ2VcbiAgICBpZiAoIGN1cnJlbnRQYWdlSWQgPT0gdXJsT2JqZWN0LnBhZ2UgKXtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgY29udGVudFxuICAgIGxldCBjb250ZW50ID0gdGhpcy5nZXRDb250ZW50Rm9yUGFnZSggdXJsT2JqZWN0LnBhZ2UgKTtcbiAgICBcbiAgICAvLyBJZiBjb250ZW50IGlzIGEgUHJvbWlzZSB3YWl0IGFuZCByZXNvbHZlIGl0XG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIGlmICggY29udGVudCBpbnN0YW5jZW9mIFByb21pc2UgKXtcbiAgICAgICAgY29udGVudC50aGVuKCBmdW5jdGlvbiggdGV4dCApe1xuICAgICAgICAgICAgLy8gVXBkYXRlIGNvbnRlbnQgb2Ygcm91dGVcbiAgICAgICAgICAgIGxldCByb3V0ZUl0ZW0gPSBzZWxmLmdldFJvdXRlSXRlbSggdXJsT2JqZWN0LnBhZ2UgKTtcbiAgICAgICAgICAgIHJvdXRlSXRlbS5jb250ZW50ID0gdGV4dDtcblxuICAgICAgICAgICAgLy8gUnVuIGRvUGFnZVRyYW5zaXRpb25cbiAgICAgICAgICAgIHNlbGYuZG9QYWdlVHJhbnNpdGlvbiggdGV4dCwgdXJsT2JqZWN0LnBhZ2UsIGN1cnJlbnRQYWdlSWQsIHVybE9iamVjdCwgbXVzdEFuaW1hdGVCeUNvZGUgKTtcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBjb250ZW50IGlzIE5PVCBhIFByb21pc2U6IHVwZGF0ZSBjdXJyZW50IHBhZ2VcbiAgICB0aGlzLmRvUGFnZVRyYW5zaXRpb24oIGNvbnRlbnQsIHVybE9iamVjdC5wYWdlLCBjdXJyZW50UGFnZUlkLCB1cmxPYmplY3QsIG11c3RBbmltYXRlQnlDb2RlICk7XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUudXBkYXRlU3RhY2sgPSBmdW5jdGlvbiggcGFnZUlkICkge1xuICAgIFxuICAgIC8vIElmIHRoZSBwZW51bHRpbWF0ZSBlbGVtZW50IGlzIHRoZSBwYWdlSWQgdGhlbiB3ZSBhcmUgZ29pbmcgYmFja3dhcmRzOyBvdGhlcndpc2Ugd2UgYXJlIGdvaW5nIGZvcndhcmRcbiAgICBsZXQgaXNCYWNrd2FyZCA9IHRoaXMuc3RhY2tbIHRoaXMuc3RhY2subGVuZ3RoIC0gMiBdID09IHBhZ2VJZDtcblxuICAgIGlmICggaXNCYWNrd2FyZCApe1xuICAgICAgICAvLyBJcyBiYWNrd2FyZFxuICAgICAgICByZXR1cm4gdGhpcy5zdGFjay5wb3AoKTtcbiAgICB9XG5cbiAgICAvLyBJcyBmb3J3YXJkXG4gICAgdmFyIGN1cnJlbnRQYWdlSWQgPSB0aGlzLnN0YWNrWyB0aGlzLnN0YWNrLmxlbmd0aCAtIDEgXTtcbiAgICB0aGlzLnN0YWNrLnB1c2goIHBhZ2VJZCApO1xuICAgIHJldHVybiBjdXJyZW50UGFnZUlkO1xufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmdldENvbnRlbnRGb3JQYWdlID0gZnVuY3Rpb24oIHBhZ2VJZCApIHtcblxuICAgIC8vIEdldCB0aGUgcm91dGVJdGVtIGZyb20gdGhlIHJvdXRlc01hcFxuICAgIGxldCByb3V0ZUl0ZW0gPSB0aGlzLmdldFJvdXRlSXRlbSggcGFnZUlkICk7XG5cbiAgICAvLyBHZXQgdGhlIGNvbnRlbnQgb2YgdGhhdCByb3V0ZVxuICAgIHJldHVybiB0aGlzLmdldENvbnRlbnRGb3JSb3V0ZSggcm91dGVJdGVtICk7XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuZ2V0Q29udGVudEZvclJvdXRlID0gZnVuY3Rpb24oIHJvdXRlSXRlbSApIHtcbiAgICBcbiAgICAvLyBDaGVjayBrZWVwQWxpdmVcbiAgICBpZiAoIHJvdXRlSXRlbS5rZWVwQWxpdmUgKXtcbiAgICAgICAgbGV0IGFsaXZlUGFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCByb3V0ZUl0ZW0uaWQgKTtcbiAgICAgICAgaWYgKCBhbGl2ZVBhZ2UgKXtcbiAgICAgICAgICAgIHJldHVybiBhbGl2ZVBhZ2U7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBDaGVjayBjb250ZW50XG4gICAgbGV0IGNvbnRlbnQgPSByb3V0ZUl0ZW0uY29udGVudDtcbiAgICBpZiAoIGNvbnRlbnQgKXtcbiAgICAgICAgcmV0dXJuIGNvbnRlbnQ7XG4gICAgfVxuXG4gICAgLy8gQ2hlY2sgdXJsXG4gICAgbGV0IHVybCA9IHJvdXRlSXRlbS51cmw7XG4gICAgaWYgKCB1cmwgKXtcbiAgICAgICAgcmV0dXJuIGJsdWVSb3V0ZXIuaHRtbEZldGNoZXIubG9hZFVybCggdXJsICk7XG4gICAgfVxuXG4gICAgcmV0dXJuICc8ZGl2IGlkPVwiZXJyb3JcIj5ObyBjb250ZW50IGZvdW5kIGZvciByb3V0ZSBmcm9tIHBhdGggJyArIHJvdXRlSXRlbS5pZCArICc8L2Rpdj4nO1xufTtcblxuLyoqIEBzdXBwcmVzcyB7bWlzc2luZ1Byb3BlcnRpZXN9ICovXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuZG9QYWdlVHJhbnNpdGlvbiA9IGZ1bmN0aW9uKCBjb250ZW50LCBuZXh0UGFnZUlkLCBjdXJyZW50UGFnZUlkLCB1cmxPYmplY3QsIG11c3RBbmltYXRlQnlDb2RlICkge1xuXG4gICAgLy8gR2V0IG11c3RBbmltYXRlT3V0IGFuZCBtdXN0QW5pbWF0ZUluXG4gICAgY29uc3QgbXVzdEFuaW1hdGVPdXQgPSBtdXN0QW5pbWF0ZUJ5Q29kZSAmJiAhIXRoaXMub3B0aW9ucy5hbmltYXRpb25PdXQ7XG4gICAgY29uc3QgbXVzdEFuaW1hdGVJbiA9IG11c3RBbmltYXRlQnlDb2RlICYmICEhdGhpcy5vcHRpb25zLmFuaW1hdGlvbkluO1xuXG4gICAgLy8gR2V0IHRoZSBpbml0RXZlbnRcbiAgICBjb25zdCBpbml0RXZlbnQgPSBjb250ZW50IGluc3RhbmNlb2YgSFRNTEVsZW1lbnQ/IGJsdWVSb3V0ZXIuZGVmYXVsdE9wdGlvbnMuRVZFTlRfUkVJTklUOiBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLkVWRU5UX0lOSVQ7XG5cbiAgICAvLyBSdW4gZXZlbnRzXG4gICAgdGhpcy5ydW5FdmVudCggYmx1ZVJvdXRlci5kZWZhdWx0T3B0aW9ucy5FVkVOVF9CRUZPUkVfT1VULCBjdXJyZW50UGFnZUlkLCB7fSApO1xuXG4gICAgLy8gR2V0IHRoZSBjdXJyZW50UGFnZSBhbmQgYWRkIG5leHQgcGFnZVxuICAgIGxldCBjdXJyZW50UGFnZSA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoICdjdXJyZW50UGFnZScgKVswXTtcbiAgICBsZXQgbmV3UGFnZSA9IHRoaXMuYWRkTmV4dFBhZ2UoIGN1cnJlbnRQYWdlLCBjb250ZW50LCBuZXh0UGFnZUlkICk7XG5cbiAgICAvLyBSZW5kZXIgbmV4dCBwYWdlXG4gICAgdGhpcy5ydW5SZW5kZXJSZWxhdGVkKCBpbml0RXZlbnQsIG5leHRQYWdlSWQsIHVybE9iamVjdCApO1xuXG4gICAgLy8gRGVmaW5lIGN1cnJlbnRQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIgYW5kIG5ld1BhZ2VBbmltYXRpb25lbmRMaXN0ZW5lclxuICAgIGxldCBzZWxmID0gdGhpcztcbiAgICBsZXQgY3VycmVudFBhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgY3VycmVudFBhZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2FuaW1hdGlvbmVuZCcsIGN1cnJlbnRQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBoaWRkZW4gY2xhc3MsIGFkZCBhbmltYXRpb25JbiBjbGFzc1xuICAgICAgICBuZXdQYWdlLmNsYXNzTGlzdC5yZW1vdmUoICdoaWRkZW4nICk7XG4gICAgICAgIGlmICggbXVzdEFuaW1hdGVJbiApe1xuICAgICAgICAgICAgbmV3UGFnZS5jbGFzc0xpc3QuYWRkKCB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uSW4gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJldGlyZSBjdXJyZW50IHBhZ2U6IHNhdmUgaXQgYXMgYW4gYWxpdmUgcGFnZSBvciByZW1vdmUgaXRcbiAgICAgICAgdGhpcy5yZXRpcmVDdXJyZW50UGFnZSggY3VycmVudFBhZ2VJZCwgY3VycmVudFBhZ2UgKTtcbiAgICAgICAgc2VsZi5ydW5FdmVudCggYmx1ZVJvdXRlci5kZWZhdWx0T3B0aW9ucy5FVkVOVF9BRlRFUl9PVVQsIGN1cnJlbnRQYWdlSWQsIHt9ICk7XG5cbiAgICAgICAgLy8gIFJ1biBuZXdQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIgaWYgbGlzdGVuZXIgb2YgYW1pbWF0aW9uZW5kIG9uIG5ld1BhZ2Ugd2FzIG5vdCBhZGRlZFxuICAgICAgICBpZiAoICEgbXVzdEFuaW1hdGVJbiApIHtcbiAgICAgICAgICAgIG5ld1BhZ2VBbmltYXRpb25lbmRMaXN0ZW5lcigpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGxldCBuZXdQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIgPSAoKSA9PiB7XG4gICAgICAgIG5ld1BhZ2UucmVtb3ZlRXZlbnRMaXN0ZW5lciggJ2FuaW1hdGlvbmVuZCcsIG5ld1BhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciApO1xuXG4gICAgICAgIC8vIFJlbW92ZSBuZXh0UGFnZSBjbGFzcywgYWRkIGN1cnJlbnRQYWdlIGNsYXNzLCByZW1vdmUgYW5pbWF0aW9uSW4gY2xhc3NcbiAgICAgICAgbmV3UGFnZS5jbGFzc0xpc3QucmVtb3ZlKCAnbmV4dFBhZ2UnICk7XG4gICAgICAgIG5ld1BhZ2UuY2xhc3NMaXN0LmFkZCggJ2N1cnJlbnRQYWdlJyApO1xuICAgICAgICBpZiAoIG11c3RBbmltYXRlSW4gKXtcbiAgICAgICAgICAgIG5ld1BhZ2UuY2xhc3NMaXN0LnJlbW92ZSggdGhpcy5vcHRpb25zLmFuaW1hdGlvbkluICk7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBSdW4gRVZFTlRfSU5JVCBvciBFVkVOVF9SRUlOSVRcbiAgICAgICAgc2VsZi5ydW5FdmVudCggaW5pdEV2ZW50LCBuZXh0UGFnZUlkLCB1cmxPYmplY3QgKTtcblxuICAgICAgICAvLyBSdW4gRVZFTlRfTU9VTlRFRFxuICAgICAgICBzZWxmLnJ1bkV2ZW50KCBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLkVWRU5UX01PVU5URUQsIG5leHRQYWdlSWQsIHVybE9iamVjdCApO1xuICAgIH07XG5cbiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzXG4gICAgaWYgKCBtdXN0QW5pbWF0ZU91dCApe1xuICAgICAgICBjdXJyZW50UGFnZS5hZGRFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgY3VycmVudFBhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciApO1xuICAgIH1cbiAgICBpZiAoIG11c3RBbmltYXRlSW4gKXtcbiAgICAgICAgbmV3UGFnZS5hZGRFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgbmV3UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyICk7XG4gICAgfVxuXG4gICAgLy8gQW5pbWF0ZSFcbiAgICBpZiAoIG11c3RBbmltYXRlT3V0ICl7XG4gICAgICAgIGN1cnJlbnRQYWdlLmNsYXNzTGlzdC5hZGQoIHRoaXMub3B0aW9ucy5hbmltYXRpb25PdXQgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBjdXJyZW50UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyKCk7XG4gICAgfVxufTtcblxuLyoqIEBzdXBwcmVzcyB7bWlzc2luZ1Byb3BlcnRpZXN9ICovXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUucnVuUmVuZGVyUmVsYXRlZCA9IGZ1bmN0aW9uKCBpbml0RXZlbnQsIG5leHRQYWdlSWQsIHVybE9iamVjdCApe1xuXG4gICAgLy8gUnVuIHByZUV2ZW50IChFVkVOVF9QUkVfSU5JVCBvciBFVkVOVF9QUkVfUkVJTklUKVxuICAgIGNvbnN0IHByZUV2ZW50ID0gaW5pdEV2ZW50ID09PSAgdGhpcy5vcHRpb25zLkVWRU5UX0lOSVQ/XG4gICAgICAgIHRoaXMub3B0aW9ucy5FVkVOVF9QUkVfSU5JVDpcbiAgICAgICAgdGhpcy5vcHRpb25zLkVWRU5UX1BSRV9SRUlOSVRcblxuICAgIHRoaXMucnVuRXZlbnQoIHByZUV2ZW50LCBuZXh0UGFnZUlkLCB1cmxPYmplY3QgKTtcblxuICAgIC8vIFJ1biByZW5kZXIgaWYgbmVlZGVkXG4gICAgY29uc3Qgcm91dGVJdGVtID0gdGhpcy5nZXRSb3V0ZUl0ZW0oIG5leHRQYWdlSWQgKTtcbiAgICBjb25zdCByZW5kZXJPcHRpb24gPSBpbml0RXZlbnQgPT09ICB0aGlzLm9wdGlvbnMuRVZFTlRfSU5JVD9cbiAgICAgICAgdGhpcy5vcHRpb25zLlJVTl9SRU5ERVJfQkVGT1JFX0VWRU5UX0lOSVQ6XG4gICAgICAgIHRoaXMub3B0aW9ucy5SVU5fUkVOREVSX0JFRk9SRV9FVkVOVF9SRUlOSVQ7XG4gICAgY29uc3Qgcm91dGVQcm9wZXJ0eSA9IGluaXRFdmVudCA9PT0gIHRoaXMub3B0aW9ucy5FVkVOVF9JTklUP1xuICAgICAgICAncnVuUmVuZGVyQmVmb3JlSW5pdCc6XG4gICAgICAgICdydW5SZW5kZXJCZWZvcmVSZWluaXQnO1xuICAgIGNvbnN0IG11c3RSdW5SZW5kZXIgPSByb3V0ZUl0ZW1bIHJvdXRlUHJvcGVydHkgXSA9PT0gdW5kZWZpbmVkP1xuICAgICAgICByZW5kZXJPcHRpb246XG4gICAgICAgIHJvdXRlSXRlbVsgcm91dGVQcm9wZXJ0eSBdO1xuXG4gICAgaWYgKCBtdXN0UnVuUmVuZGVyICYmIHRoaXMub3B0aW9ucy5yZW5kZXJGdW5jdGlvbiAmJiBibHVlUm91dGVyLnV0aWxzLmlzRnVuY3Rpb24oIHRoaXMub3B0aW9ucy5yZW5kZXJGdW5jdGlvbiApICl7XG4gICAgICAgIHRoaXMub3B0aW9ucy5yZW5kZXJGdW5jdGlvbihcbiAgICAgICAgICAgIHRoaXMuYnVpbGRQYWdlSW5zdGFuY2UoIG5leHRQYWdlSWQgKVxuICAgICAgICApO1xuICAgIH1cbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5idWlsZFBhZ2VJbnN0YW5jZSA9IGZ1bmN0aW9uKCBwYWdlSWQgKXtcblxuICAgIHJldHVybiB7XG4gICAgICAgICAnaWQnOiBwYWdlSWQsXG4gICAgICAgICAnZWwnOiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggcGFnZUlkIClcbiAgICB9O1xufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmFkZE5leHRQYWdlID0gZnVuY3Rpb24oIGN1cnJlbnRQYWdlLCBjb250ZW50LCBuZXh0UGFnZUlkICl7XG5cbiAgICBpZiAoIGNvbnRlbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudCApe1xuICAgICAgICAvLyBjb250ZW50IGlzIEhUTUxFbGVtZW50XG4gICAgICAgIGN1cnJlbnRQYWdlLmluc2VydEFkamFjZW50RWxlbWVudChcbiAgICAgICAgICAgICdhZnRlcmVuZCcsXG4gICAgICAgICAgICBjb250ZW50XG4gICAgICAgICk7XG4gICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LmFkZCggJ25leHRQYWdlJyApO1xuICAgICAgICBjb250ZW50LmNsYXNzTGlzdC5hZGQoICdoaWRkZW4nICk7XG4gICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LnJlbW92ZSggJ2FsaXZlJyApO1xuXG4gICAgfSBlbHNlIHtcbiAgICAgICAgLy8gY29udGVudCBtdXN0IGJlIHRleHRcbiAgICAgICAgY3VycmVudFBhZ2UuaW5zZXJ0QWRqYWNlbnRIVE1MKFxuICAgICAgICAgICAgJ2FmdGVyZW5kJyxcbiAgICAgICAgICAgICc8ZGl2IGNsYXNzPVwibmV4dFBhZ2UgaGlkZGVuIHBhZ2VcIiBpZD1cIicgKyBuZXh0UGFnZUlkICsgJ1wiPidcbiAgICAgICAgICAgICsgY29udGVudFxuICAgICAgICAgICAgKyAnPC9kaXY+J1xuICAgICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggbmV4dFBhZ2VJZCApO1xufTtcblxuLy8gUmV0aXJlIGN1cnJlbnQgcGFnZTogc2F2ZSBpdCBhcyBhbiBhbGl2ZSBwYWdlIG9yIHJlbW92ZSBpdFxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLnJldGlyZUN1cnJlbnRQYWdlID0gZnVuY3Rpb24oIGN1cnJlbnRQYWdlSWQsIGN1cnJlbnRQYWdlICl7XG5cbiAgICBsZXQgY3VycmVudFJvdXRlID0gdGhpcy5nZXRSb3V0ZUl0ZW0oIGN1cnJlbnRQYWdlSWQgKTtcblxuICAgIC8vIElmIG11c3Qga2VlcCBhbGl2ZSBjdXJyZW50IHBhZ2UsIHNldCBwYWdlIGFuZCBhbGl2ZSBhcyBjbGFzc2VzIHJlbW92aW5nIHRoZSByZXN0XG4gICAgaWYgKCBjdXJyZW50Um91dGUgJiYgY3VycmVudFJvdXRlLmtlZXBBbGl2ZSl7XG4gICAgICAgIGN1cnJlbnRQYWdlLnJlbW92ZUF0dHJpYnV0ZSggJ2NsYXNzJyApO1xuICAgICAgICBjdXJyZW50UGFnZS5jbGFzc0xpc3QuYWRkKCAncGFnZScgKTtcbiAgICAgICAgY3VycmVudFBhZ2UuY2xhc3NMaXN0LmFkZCggJ2FsaXZlJyApO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gRG8gbm90IGtlZXAgYWxpdmUgY3VycmVudCBwYWdlLCBzbyByZW1vdmUgaXRcbiAgICBjdXJyZW50UGFnZS5yZW1vdmUoKTtcbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5ydW5FdmVudCA9IGZ1bmN0aW9uKCBldmVudElkLCBwYWdlSWQsIHVybE9iamVjdCApIHtcblxuICAgIGlmICggZXZlbnRJZCA9PSBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLkVWRU5UX0lOSVQgKXtcbiAgICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyc0ZvckxpbmtzKCBwYWdlSWQgKTtcbiAgICB9XG5cbiAgICAvLyBHZXQgdGhlIHBhZ2Ugb2JqZWN0IGZyb20gb3B0aW9uc1xuICAgIC8qKiBAc3VwcHJlc3Mge21pc3NpbmdQcm9wZXJ0aWVzfSAqL1xuICAgIGxldCBwYWdlID0gdGhpcy5vcHRpb25zLmV2ZW50c0J5UGFnZVsgcGFnZUlkIF07XG5cbiAgICAvLyBJZiBhIHBhZ2UgaXMgZm91bmQsIHJ1biB0aGUgZXZlbnQgaGFuZGxlclxuICAgIGlmICggcGFnZSApe1xuICAgICAgICBsZXQgZXZlbnQgPSB7XG4gICAgICAgICAgICBwYXJhbXM6IHVybE9iamVjdC5wYXJhbXMgfHwge31cbiAgICAgICAgfTtcbiAgICAgICAgaWYgKCBwYWdlWyBldmVudElkIF0gJiYgYmx1ZVJvdXRlci51dGlscy5pc0Z1bmN0aW9uKCBwYWdlWyBldmVudElkIF0gKSApe1xuICAgICAgICAgICAgcGFnZVsgZXZlbnRJZCBdKCBldmVudCApO1xuICAgICAgICB9XG4gICAgfVxufTtcblxuXG4vLyBEZWZhdWx0IG9wdGlvbnNcblxuYmx1ZVJvdXRlci5kZWZhdWx0T3B0aW9ucyA9IHtcbiAgICB1cGRhdGVPbkxvYWQ6IHRydWUsXG4gICAgcHJlbG9hZFBhZ2VzT25Mb2FkOiBmYWxzZSxcblxuICAgIC8vIEFuaW1hdGlvbnNcbiAgICBhbmltYXRpb25PdXQ6ICdzbGlkZS1vdXQtdG9wJyxcbiAgICAvL2FuaW1hdGlvbk91dDogZmFsc2UsXG4gICAgYW5pbWF0aW9uSW46ICdzY2FsZS1pbi1jZW50ZXInLFxuICAgIC8vYW5pbWF0aW9uSW46IGZhbHNlLFxuICAgIGFuaW1hdGVUcmFuc2l0aW9uc09uTG9hZDogZmFsc2UsXG4gICAgXG4gICAgLy8gTWlzY1xuICAgIFBBR0VfUFJFRklYOiAnIScsXG5cbiAgICAvLyBTcGVjaWFsIHBhZ2VzIGlkc1xuICAgIFBBR0VfSURfSE9NRTogJ1tob21lXScsXG4gICAgUEFHRV9JRF80MDRfRVJST1I6ICdbNDA0XScsXG5cbiAgICAvLyBFdmVudHNcbiAgICBFVkVOVF9QUkVfSU5JVDogJ3ByZUluaXQnLFxuICAgIEVWRU5UX0lOSVQ6ICdpbml0JyxcbiAgICBFVkVOVF9QUkVfUkVJTklUOiAncHJlUmVpbml0JyxcbiAgICBFVkVOVF9SRUlOSVQ6ICdyZWluaXQnLFxuICAgIEVWRU5UX01PVU5URUQ6ICdtb3VudGVkJyxcbiAgICBFVkVOVF9CRUZPUkVfT1VUOiAnYmVmb3JlT3V0JyxcbiAgICBFVkVOVF9BRlRFUl9PVVQ6ICdhZnRlck91dCcsXG5cbiAgICBSVU5fUkVOREVSX0JFRk9SRV9FVkVOVF9JTklUOiB0cnVlLFxuICAgIFJVTl9SRU5ERVJfQkVGT1JFX0VWRU5UX1JFSU5JVDogZmFsc2VcblxufTtcblxuXG5ibHVlUm91dGVyLmh0bWxGZXRjaGVyID0ge307XG5cbmJsdWVSb3V0ZXIuaHRtbEZldGNoZXIubG9hZEFsbFVybHMgPSBmdW5jdGlvbiggcm91dGVyLCBjYWxsYmFjayApe1xuXG4gICAgLy8gR2V0IHRoZSByb3V0ZXMgdG8gdXNlXG4gICAgY29uc3Qgcm91dGVzID0gcm91dGVyLm9wdGlvbnMucm91dGVzIHx8IFtdO1xuXG4gICAgLy8gSW5pdCB0aGUgbnVtYmVyIG90IHVybHMgdG8gZ2V0XG4gICAgbGV0IHBlbmRpbmcgPSAwO1xuXG4gICAgLy8gSXRlcmF0ZSB1cmxSb3V0ZXMgYW5kIGxvYWQgZWFjaCByb3V0ZUl0ZW0gaWYgbmVlZGVkXG4gICAgcm91dGVzLm1hcCggcm91dGVJdGVtID0+IHtcbiAgICAgICAgbGV0IHVybCA9IHJvdXRlSXRlbS51cmw7XG4gICAgICAgIGlmICggdXJsICl7XG4gICAgICAgICAgICArK3BlbmRpbmc7XG4gICAgICAgICAgICBibHVlUm91dGVyLmh0bWxGZXRjaGVyLmxvYWRVcmwoIHVybCApLnRoZW4oXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oIHRleHQgKXtcbiAgICAgICAgICAgICAgICAgICAgLy8gVXBkYXRlIGNvbnRlbnQgb2Ygcm91dGVcbiAgICAgICAgICAgICAgICAgICAgcm91dGVJdGVtLmNvbnRlbnQgPSB0ZXh0O1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIFJ1biBjYWxsYmFjayB3aGVuIGFsbCBmaWxlcyBoYXZlIGJlZW4gbG9hZGVkXG4gICAgICAgICAgICAgICAgICAgIGlmICggLS1wZW5kaW5nID09IDAgJiYgY2FsbGJhY2sgJiYgYmx1ZVJvdXRlci51dGlscy5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH0pO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gdXJsXG4gKiBcbiAqL1xuYmx1ZVJvdXRlci5odG1sRmV0Y2hlci5sb2FkVXJsID0gYXN5bmMgZnVuY3Rpb24oIHVybCApe1xuXG4gICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCBmZXRjaCggdXJsICk7XG5cbiAgICBpZiAoICEgcmVzcG9uc2Uub2sgKSB7XG4gICAgICAgIGNvbnN0IG1lc3NhZ2UgPSBgRXJyb3IgZmV0Y2hpbmcgJHt1cmx9IGhhcyBvY2N1cmVkOiAke3Jlc3BvbnNlLnN0YXR1c31gO1xuICAgICAgICBhbGVydCAoIG1lc3NhZ2UgKTtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCBtZXNzYWdlICk7XG4gICAgfVxuICBcbiAgICBjb25zdCB0ZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xuICAgIHJldHVybiB0ZXh0O1xufTtcblxuYmx1ZVJvdXRlci51dGlscyA9IHt9O1xuXG4vKlxuICAgIEJ1aWxkcyBhbiBvYmplY3Qgd2l0aCBkYXRhIGFib3V0IHRoZSB1cmwuIEFuIGV4YW1wbGU6XG5cbiAgICB1cmwgOiBodHRwOi8vMTI3LjAuMC4xOjkwMDAvc2FtcGxlcy9zYW1wbGUuaHRtbCMhYWJvdXQ/cGFyYW0xPWEmcGFyYW0yPWJcIlxuXG4gICAgcHJlcGFnZTogaHR0cDovLzEyNy4wLjAuMTo5MDAwL3NhbXBsZXMvc2FtcGxlLmh0bWxcbiAgICBwYWdlOiBhYm91dFxuICAgIHBhcmFtczoge1xuICAgICAgICBwYXJhbTE6IGFcbiAgICAgICAgcGFyYW0yOiBiXG4gICAgfVxuKi9cbmJsdWVSb3V0ZXIudXRpbHMuYW5hbGl6ZVVybCA9IGZ1bmN0aW9uKCB1cmwsIG9wdGlvbnMgKSB7XG4gICAgXG4gICAgbGV0IHJlc3VsdCA9IHt9O1xuXG4gICAgLy8gRXh0cmFjdCB0aGUgcGFydHMgYmVmb3JlIGFuZCBhZnRlciBQQUdFX1BSRUZJWFxuICAgIGxldCB1cmxQYXJ0cyA9IHVybC5zcGxpdCggb3B0aW9ucy5QQUdFX1BSRUZJWCApO1xuICAgIHJlc3VsdC5wcmVwYWdlID0gdXJsUGFydHNbIDAgXTtcbiAgICBsZXQgcG9zdFBhdGggPSB1cmxQYXJ0c1sgMSBdIHx8ICcnO1xuXG4gICAgLy8gUmVtb3ZlICMgaWYgcHJlc2VudFxuICAgIGlmICggcmVzdWx0LnByZXBhZ2UuZW5kc1dpdGgoICcjJyApICl7XG4gICAgICAgIHJlc3VsdC5wcmVwYWdlID0gcmVzdWx0LnByZXBhZ2Uuc2xpY2UoIDAsIC0xICk7XG4gICAgfVxuXG4gICAgLy8gRXh0cmFjdCB0aGUgcGFydHMgYmVmb3JlIGFuZCBhZnRlciA/XG4gICAgbGV0IHBhdGhQYXJ0cyA9IHBvc3RQYXRoLnNwbGl0KCAnPycgKTtcbiAgICByZXN1bHQucGFnZSA9IHBhdGhQYXJ0c1sgMCBdO1xuXG4gICAgLy8gRml4IGhvbWUgcGFnZVxuICAgIGlmICggcmVzdWx0LnBhZ2UgPT0gJycpIHtcbiAgICAgICAgcmVzdWx0LnBhZ2UgPSBvcHRpb25zLlBBR0VfSURfSE9NRTtcbiAgICB9XG5cbiAgICBsZXQgcGFyYW1zU3RyaW5nID0gcGF0aFBhcnRzWyAxIF0gfHwgJyc7XG5cbiAgICAvLyBBZGQgcGFyYW1zXG4gICAgcmVzdWx0LnBhcmFtcyA9IHt9O1xuICAgIGlmICggcGFyYW1zU3RyaW5nID09ICcnICl7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGxldCB2YXJzID0gcGFyYW1zU3RyaW5nLnNwbGl0KCAnJicgKTtcbiAgICBmb3IgKCBsZXQgaSA9IDA7IGkgPCB2YXJzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICBsZXQgcGFpciA9IHZhcnNbIGkgXS5zcGxpdCggJz0nICk7XG4gICAgICAgIGxldCBwYXJhbU5hbWUgPSBwYWlyWyAwIF07XG4gICAgICAgIGxldCBwYXJhbVZhbHVlID0gcGFpclsgMSBdO1xuICAgICAgICByZXN1bHQucGFyYW1zWyBwYXJhbU5hbWUgXSA9IHBhcmFtVmFsdWU7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbmJsdWVSb3V0ZXIudXRpbHMuYWRkRXZlbnRMaXN0ZW5lck9uTGlzdCA9IGZ1bmN0aW9uKCBsaXN0LCBldmVudCwgZm4gKSB7XG5cbiAgICBmb3IgKCBsZXQgaSA9IDAsIGxlbiA9IGxpc3QubGVuZ3RoOyBpIDwgbGVuOyBpKysgKSB7XG4gICAgICAgIGxpc3RbIGkgXS5hZGRFdmVudExpc3RlbmVyKCBldmVudCwgZm4sIGZhbHNlICk7XG4gICAgfVxufTtcblxuYmx1ZVJvdXRlci51dGlscy5leHRlbmQgPSBmdW5jdGlvbiggb3V0LCBmcm9tMSwgZnJvbTIgKSB7XG4gICAgb3V0ID0gb3V0IHx8IHt9O1xuXG4gICAgZm9yICggdmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICBpZiAoICEgYXJndW1lbnRzWyBpIF0gKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICggdmFyIGtleSBpbiBhcmd1bWVudHNbIGkgXSApIHtcbiAgICAgICAgICAgIGlmICggYXJndW1lbnRzWyBpIF0uaGFzT3duUHJvcGVydHkoIGtleSApICl7XG4gICAgICAgICAgICAgICAgb3V0WyBrZXkgXSA9IGFyZ3VtZW50c1sgaSBdWyBrZXkgXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiBvdXQ7XG59O1xuXG4vKiBmb3JtYXRTdHJpbmcgKi9cbi8vIEV4YW1wbGU6IGl0aWxzLmZvcm1hdFN0cmluZyggJ3swfSBpcyBkZWFkLCBidXQgezF9IGlzIGFsaXZlIScsICdBU1AnLCAnQVNQLk5FVCcgKVxuLyoqXG4gKiBUYWtlcyAxIG9yIG1vcmUgc3RyaW5ncyBhbmQgZG8gc29tZXRoaW5nIGNvb2wgd2l0aCB0aGVtLlxuICogQHBhcmFtIHsuLi5zdHJpbmd8bnVtYmVyfSBmb3JtYXRcbiAqL1xuYmx1ZVJvdXRlci51dGlscy5mb3JtYXRTdHJpbmcgPSBmdW5jdGlvbiggZm9ybWF0ICkge1xuICAgIFxuICAgIHZhciBhcmdzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoIGFyZ3VtZW50cywgMSApO1xuICAgIHJldHVybiBmb3JtYXQucmVwbGFjZSgveyhcXGQrKX0vZywgZnVuY3Rpb24gKCBtYXRjaCwgbnVtYmVyICkge1xuICAgICAgICByZXR1cm4gdHlwZW9mIGFyZ3NbIG51bWJlciBdICE9ICd1bmRlZmluZWQnPyBhcmdzWyBudW1iZXIgXSA6IG1hdGNoO1xuICAgIH0pO1xufTtcblxuYmx1ZVJvdXRlci51dGlscy5pc0Z1bmN0aW9uID0gZnVuY3Rpb24gaXNGdW5jdGlvbiggb2JqICkge1xuXG4gICAgLy8gU3VwcG9ydDogQ2hyb21lIDw9NTcsIEZpcmVmb3ggPD01MlxuICAgIC8vIEluIHNvbWUgYnJvd3NlcnMsIHR5cGVvZiByZXR1cm5zIFwiZnVuY3Rpb25cIiBmb3IgSFRNTCA8b2JqZWN0PiBlbGVtZW50c1xuICAgIC8vIChpLmUuLCBgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwib2JqZWN0XCIgKSA9PT0gXCJmdW5jdGlvblwiYCkuXG4gICAgLy8gV2UgZG9uJ3Qgd2FudCB0byBjbGFzc2lmeSAqYW55KiBET00gbm9kZSBhcyBhIGZ1bmN0aW9uLlxuICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIG9iai5ub2RlVHlwZSAhPT0gXCJudW1iZXJcIjtcbn07XG4vKiBlbmQgb2YgdXRpbHMgKi9cblxuLy8gUmVnaXN0ZXIgYmx1ZVJvdXRlciBpZiB3ZSBhcmUgdXNpbmcgTm9kZVxuaWYgKCB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGJsdWVSb3V0ZXI7XG59XG4iLCIoZnVuY3Rpb24ocm9vdCwgZmFjdG9yeSkge1xuICBpZiAodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKSB7XG4gICAgZGVmaW5lKFtdLCBmYWN0b3J5KTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcbiAgfSBlbHNlIHtcbiAgICByb290LmxvYWRqcyA9IGZhY3RvcnkoKTtcbiAgfVxufSh0aGlzLCBmdW5jdGlvbigpIHtcbi8qKlxuICogR2xvYmFsIGRlcGVuZGVuY2llcy5cbiAqIEBnbG9iYWwge09iamVjdH0gZG9jdW1lbnQgLSBET01cbiAqL1xuXG52YXIgZGV2bnVsbCA9IGZ1bmN0aW9uKCkge30sXG4gICAgYnVuZGxlSWRDYWNoZSA9IHt9LFxuICAgIGJ1bmRsZVJlc3VsdENhY2hlID0ge30sXG4gICAgYnVuZGxlQ2FsbGJhY2tRdWV1ZSA9IHt9O1xuXG5cbi8qKlxuICogU3Vic2NyaWJlIHRvIGJ1bmRsZSBsb2FkIGV2ZW50LlxuICogQHBhcmFtIHtzdHJpbmdbXX0gYnVuZGxlSWRzIC0gQnVuZGxlIGlkc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBzdWJzY3JpYmUoYnVuZGxlSWRzLCBjYWxsYmFja0ZuKSB7XG4gIC8vIGxpc3RpZnlcbiAgYnVuZGxlSWRzID0gYnVuZGxlSWRzLnB1c2ggPyBidW5kbGVJZHMgOiBbYnVuZGxlSWRzXTtcblxuICB2YXIgZGVwc05vdEZvdW5kID0gW10sXG4gICAgICBpID0gYnVuZGxlSWRzLmxlbmd0aCxcbiAgICAgIG51bVdhaXRpbmcgPSBpLFxuICAgICAgZm4sXG4gICAgICBidW5kbGVJZCxcbiAgICAgIHIsXG4gICAgICBxO1xuXG4gIC8vIGRlZmluZSBjYWxsYmFjayBmdW5jdGlvblxuICBmbiA9IGZ1bmN0aW9uIChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCkge1xuICAgIGlmIChwYXRoc05vdEZvdW5kLmxlbmd0aCkgZGVwc05vdEZvdW5kLnB1c2goYnVuZGxlSWQpO1xuXG4gICAgbnVtV2FpdGluZy0tO1xuICAgIGlmICghbnVtV2FpdGluZykgY2FsbGJhY2tGbihkZXBzTm90Rm91bmQpO1xuICB9O1xuXG4gIC8vIHJlZ2lzdGVyIGNhbGxiYWNrXG4gIHdoaWxlIChpLS0pIHtcbiAgICBidW5kbGVJZCA9IGJ1bmRsZUlkc1tpXTtcblxuICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2sgaWYgaW4gcmVzdWx0IGNhY2hlXG4gICAgciA9IGJ1bmRsZVJlc3VsdENhY2hlW2J1bmRsZUlkXTtcbiAgICBpZiAocikge1xuICAgICAgZm4oYnVuZGxlSWQsIHIpO1xuICAgICAgY29udGludWU7XG4gICAgfVxuXG4gICAgLy8gYWRkIHRvIGNhbGxiYWNrIHF1ZXVlXG4gICAgcSA9IGJ1bmRsZUNhbGxiYWNrUXVldWVbYnVuZGxlSWRdID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF0gfHwgW107XG4gICAgcS5wdXNoKGZuKTtcbiAgfVxufVxuXG5cbi8qKlxuICogUHVibGlzaCBidW5kbGUgbG9hZCBldmVudC5cbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIEJ1bmRsZSBpZFxuICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHNOb3RGb3VuZCAtIExpc3Qgb2YgZmlsZXMgbm90IGZvdW5kXG4gKi9cbmZ1bmN0aW9uIHB1Ymxpc2goYnVuZGxlSWQsIHBhdGhzTm90Rm91bmQpIHtcbiAgLy8gZXhpdCBpZiBpZCBpc24ndCBkZWZpbmVkXG4gIGlmICghYnVuZGxlSWQpIHJldHVybjtcblxuICB2YXIgcSA9IGJ1bmRsZUNhbGxiYWNrUXVldWVbYnVuZGxlSWRdO1xuXG4gIC8vIGNhY2hlIHJlc3VsdFxuICBidW5kbGVSZXN1bHRDYWNoZVtidW5kbGVJZF0gPSBwYXRoc05vdEZvdW5kO1xuXG4gIC8vIGV4aXQgaWYgcXVldWUgaXMgZW1wdHlcbiAgaWYgKCFxKSByZXR1cm47XG5cbiAgLy8gZW1wdHkgY2FsbGJhY2sgcXVldWVcbiAgd2hpbGUgKHEubGVuZ3RoKSB7XG4gICAgcVswXShidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCk7XG4gICAgcS5zcGxpY2UoMCwgMSk7XG4gIH1cbn1cblxuXG4vKipcbiAqIEV4ZWN1dGUgY2FsbGJhY2tzLlxuICogQHBhcmFtIHtPYmplY3Qgb3IgRnVuY3Rpb259IGFyZ3MgLSBUaGUgY2FsbGJhY2sgYXJnc1xuICogQHBhcmFtIHtzdHJpbmdbXX0gZGVwc05vdEZvdW5kIC0gTGlzdCBvZiBkZXBlbmRlbmNpZXMgbm90IGZvdW5kXG4gKi9cbmZ1bmN0aW9uIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgZGVwc05vdEZvdW5kKSB7XG4gIC8vIGFjY2VwdCBmdW5jdGlvbiBhcyBhcmd1bWVudFxuICBpZiAoYXJncy5jYWxsKSBhcmdzID0ge3N1Y2Nlc3M6IGFyZ3N9O1xuXG4gIC8vIHN1Y2Nlc3MgYW5kIGVycm9yIGNhbGxiYWNrc1xuICBpZiAoZGVwc05vdEZvdW5kLmxlbmd0aCkgKGFyZ3MuZXJyb3IgfHwgZGV2bnVsbCkoZGVwc05vdEZvdW5kKTtcbiAgZWxzZSAoYXJncy5zdWNjZXNzIHx8IGRldm51bGwpKGFyZ3MpO1xufVxuXG5cbi8qKlxuICogTG9hZCBpbmRpdmlkdWFsIGZpbGUuXG4gKiBAcGFyYW0ge3N0cmluZ30gcGF0aCAtIFRoZSBmaWxlIHBhdGhcbiAqIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrRm4gLSBUaGUgY2FsbGJhY2sgZnVuY3Rpb25cbiAqL1xuZnVuY3Rpb24gbG9hZEZpbGUocGF0aCwgY2FsbGJhY2tGbiwgYXJncywgbnVtVHJpZXMpIHtcbiAgdmFyIGRvYyA9IGRvY3VtZW50LFxuICAgICAgYXN5bmMgPSBhcmdzLmFzeW5jLFxuICAgICAgbWF4VHJpZXMgPSAoYXJncy5udW1SZXRyaWVzIHx8IDApICsgMSxcbiAgICAgIGJlZm9yZUNhbGxiYWNrRm4gPSBhcmdzLmJlZm9yZSB8fCBkZXZudWxsLFxuICAgICAgcGF0aG5hbWUgPSBwYXRoLnJlcGxhY2UoL1tcXD98I10uKiQvLCAnJyksXG4gICAgICBwYXRoU3RyaXBwZWQgPSBwYXRoLnJlcGxhY2UoL14oY3NzfGltZ3xtb2R1bGV8bm9tb2R1bGUpIS8sICcnKSxcbiAgICAgIGlzTGVnYWN5SUVDc3MsXG4gICAgICBoYXNNb2R1bGVTdXBwb3J0LFxuICAgICAgZTtcblxuICBudW1UcmllcyA9IG51bVRyaWVzIHx8IDA7XG5cbiAgaWYgKC8oXmNzcyF8XFwuY3NzJCkvLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgLy8gY3NzXG4gICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdsaW5rJyk7XG4gICAgZS5yZWwgPSAnc3R5bGVzaGVldCc7XG4gICAgZS5ocmVmID0gcGF0aFN0cmlwcGVkO1xuXG4gICAgLy8gdGFnIElFOStcbiAgICBpc0xlZ2FjeUlFQ3NzID0gJ2hpZGVGb2N1cycgaW4gZTtcblxuICAgIC8vIHVzZSBwcmVsb2FkIGluIElFIEVkZ2UgKHRvIGRldGVjdCBsb2FkIGVycm9ycylcbiAgICBpZiAoaXNMZWdhY3lJRUNzcyAmJiBlLnJlbExpc3QpIHtcbiAgICAgIGlzTGVnYWN5SUVDc3MgPSAwO1xuICAgICAgZS5yZWwgPSAncHJlbG9hZCc7XG4gICAgICBlLmFzID0gJ3N0eWxlJztcbiAgICB9XG4gIH0gZWxzZSBpZiAoLyheaW1nIXxcXC4ocG5nfGdpZnxqcGd8c3ZnfHdlYnApJCkvLnRlc3QocGF0aG5hbWUpKSB7XG4gICAgLy8gaW1hZ2VcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2ltZycpO1xuICAgIGUuc3JjID0gcGF0aFN0cmlwcGVkOyAgICBcbiAgfSBlbHNlIHtcbiAgICAvLyBqYXZhc2NyaXB0XG4gICAgZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdzY3JpcHQnKTtcbiAgICBlLnNyYyA9IHBhdGhTdHJpcHBlZDtcbiAgICBlLmFzeW5jID0gYXN5bmMgPT09IHVuZGVmaW5lZCA/IHRydWUgOiBhc3luYztcblxuICAgIC8vIGhhbmRsZSBlcyBtb2R1bGVzXG4gICAgLy8gbW9kZXJuIGJyb3dzZXJzOlxuICAgIC8vICAgbW9kdWxlOiBhZGQgdG8gZG9tIHdpdGggdHlwZT1cIm1vZHVsZVwiXG4gICAgLy8gICBub21vZHVsZTogY2FsbCBzdWNjZXNzKCkgY2FsbGJhY2sgd2l0aG91dCBhZGRpbmcgdG8gZG9tXG4gICAgLy8gbGVnYWN5IGJyb3dzZXJzOlxuICAgIC8vICAgbW9kdWxlOiBjYWxsIHN1Y2Nlc3MoKSBjYWxsYmFjayB3aXRob3V0IGFkZGluZyB0byBkb21cbiAgICAvLyAgIG5vbW9kdWxlOiBhZGQgdG8gZG9tIHdpdGggZGVmYXVsdCB0eXBlIChcInRleHQvamF2YXNjcmlwdFwiKVxuICAgIGhhc01vZHVsZVN1cHBvcnQgPSAnbm9Nb2R1bGUnIGluIGU7XG4gICAgaWYgKC9ebW9kdWxlIS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAgIGlmICghaGFzTW9kdWxlU3VwcG9ydCkgcmV0dXJuIGNhbGxiYWNrRm4ocGF0aCwgJ2wnKTtcbiAgICAgIGUudHlwZSA9IFwibW9kdWxlXCI7XG4gICAgfSBlbHNlIGlmICgvXm5vbW9kdWxlIS8udGVzdChwYXRobmFtZSkgJiYgaGFzTW9kdWxlU3VwcG9ydCkgcmV0dXJuIGNhbGxiYWNrRm4ocGF0aCwgJ2wnKTtcbiAgfVxuXG4gIGUub25sb2FkID0gZS5vbmVycm9yID0gZS5vbmJlZm9yZWxvYWQgPSBmdW5jdGlvbiAoZXYpIHtcbiAgICB2YXIgcmVzdWx0ID0gZXYudHlwZVswXTtcblxuICAgIC8vIHRyZWF0IGVtcHR5IHN0eWxlc2hlZXRzIGFzIGZhaWx1cmVzIHRvIGdldCBhcm91bmQgbGFjayBvZiBvbmVycm9yXG4gICAgLy8gc3VwcG9ydCBpbiBJRTktMTFcbiAgICBpZiAoaXNMZWdhY3lJRUNzcykge1xuICAgICAgdHJ5IHtcbiAgICAgICAgaWYgKCFlLnNoZWV0LmNzc1RleHQubGVuZ3RoKSByZXN1bHQgPSAnZSc7XG4gICAgICB9IGNhdGNoICh4KSB7XG4gICAgICAgIC8vIHNoZWV0cyBvYmplY3RzIGNyZWF0ZWQgZnJvbSBsb2FkIGVycm9ycyBkb24ndCBhbGxvdyBhY2Nlc3MgdG9cbiAgICAgICAgLy8gYGNzc1RleHRgICh1bmxlc3MgZXJyb3IgaXMgQ29kZToxOCBTZWN1cml0eUVycm9yKVxuICAgICAgICBpZiAoeC5jb2RlICE9IDE4KSByZXN1bHQgPSAnZSc7XG4gICAgICB9XG4gICAgfVxuXG4gICAgLy8gaGFuZGxlIHJldHJpZXMgaW4gY2FzZSBvZiBsb2FkIGZhaWx1cmVcbiAgICBpZiAocmVzdWx0ID09ICdlJykge1xuICAgICAgLy8gaW5jcmVtZW50IGNvdW50ZXJcbiAgICAgIG51bVRyaWVzICs9IDE7XG5cbiAgICAgIC8vIGV4aXQgZnVuY3Rpb24gYW5kIHRyeSBhZ2FpblxuICAgICAgaWYgKG51bVRyaWVzIDwgbWF4VHJpZXMpIHtcbiAgICAgICAgcmV0dXJuIGxvYWRGaWxlKHBhdGgsIGNhbGxiYWNrRm4sIGFyZ3MsIG51bVRyaWVzKTtcbiAgICAgIH1cbiAgICB9IGVsc2UgaWYgKGUucmVsID09ICdwcmVsb2FkJyAmJiBlLmFzID09ICdzdHlsZScpIHtcbiAgICAgIC8vIGFjdGl2YXRlIHByZWxvYWRlZCBzdHlsZXNoZWV0c1xuICAgICAgcmV0dXJuIGUucmVsID0gJ3N0eWxlc2hlZXQnOyAvLyBqc2hpbnQgaWdub3JlOmxpbmVcbiAgICB9XG4gICAgXG4gICAgLy8gZXhlY3V0ZSBjYWxsYmFja1xuICAgIGNhbGxiYWNrRm4ocGF0aCwgcmVzdWx0LCBldi5kZWZhdWx0UHJldmVudGVkKTtcbiAgfTtcblxuICAvLyBhZGQgdG8gZG9jdW1lbnQgKHVubGVzcyBjYWxsYmFjayByZXR1cm5zIGBmYWxzZWApXG4gIGlmIChiZWZvcmVDYWxsYmFja0ZuKHBhdGgsIGUpICE9PSBmYWxzZSkgZG9jLmhlYWQuYXBwZW5kQ2hpbGQoZSk7XG59XG5cblxuLyoqXG4gKiBMb2FkIG11bHRpcGxlIGZpbGVzLlxuICogQHBhcmFtIHtzdHJpbmdbXX0gcGF0aHMgLSBUaGUgZmlsZSBwYXRoc1xuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBsb2FkRmlsZXMocGF0aHMsIGNhbGxiYWNrRm4sIGFyZ3MpIHtcbiAgLy8gbGlzdGlmeSBwYXRoc1xuICBwYXRocyA9IHBhdGhzLnB1c2ggPyBwYXRocyA6IFtwYXRoc107XG5cbiAgdmFyIG51bVdhaXRpbmcgPSBwYXRocy5sZW5ndGgsXG4gICAgICB4ID0gbnVtV2FpdGluZyxcbiAgICAgIHBhdGhzTm90Rm91bmQgPSBbXSxcbiAgICAgIGZuLFxuICAgICAgaTtcblxuICAvLyBkZWZpbmUgY2FsbGJhY2sgZnVuY3Rpb25cbiAgZm4gPSBmdW5jdGlvbihwYXRoLCByZXN1bHQsIGRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAvLyBoYW5kbGUgZXJyb3JcbiAgICBpZiAocmVzdWx0ID09ICdlJykgcGF0aHNOb3RGb3VuZC5wdXNoKHBhdGgpO1xuXG4gICAgLy8gaGFuZGxlIGJlZm9yZWxvYWQgZXZlbnQuIElmIGRlZmF1bHRQcmV2ZW50ZWQgdGhlbiB0aGF0IG1lYW5zIHRoZSBsb2FkXG4gICAgLy8gd2lsbCBiZSBibG9ja2VkIChleC4gR2hvc3RlcnkvQUJQIG9uIFNhZmFyaSlcbiAgICBpZiAocmVzdWx0ID09ICdiJykge1xuICAgICAgaWYgKGRlZmF1bHRQcmV2ZW50ZWQpIHBhdGhzTm90Rm91bmQucHVzaChwYXRoKTtcbiAgICAgIGVsc2UgcmV0dXJuO1xuICAgIH1cblxuICAgIG51bVdhaXRpbmctLTtcbiAgICBpZiAoIW51bVdhaXRpbmcpIGNhbGxiYWNrRm4ocGF0aHNOb3RGb3VuZCk7XG4gIH07XG5cbiAgLy8gbG9hZCBzY3JpcHRzXG4gIGZvciAoaT0wOyBpIDwgeDsgaSsrKSBsb2FkRmlsZShwYXRoc1tpXSwgZm4sIGFyZ3MpO1xufVxuXG5cbi8qKlxuICogSW5pdGlhdGUgc2NyaXB0IGxvYWQgYW5kIHJlZ2lzdGVyIGJ1bmRsZS5cbiAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IHBhdGhzIC0gVGhlIGZpbGUgcGF0aHNcbiAqIEBwYXJhbSB7KHN0cmluZ3xGdW5jdGlvbnxPYmplY3QpfSBbYXJnMV0gLSBUaGUgKDEpIGJ1bmRsZUlkIG9yICgyKSBzdWNjZXNzXG4gKiAgIGNhbGxiYWNrIG9yICgzKSBvYmplY3QgbGl0ZXJhbCB3aXRoIHN1Y2Nlc3MvZXJyb3IgYXJndW1lbnRzLCBudW1SZXRyaWVzLFxuICogICBldGMuXG4gKiBAcGFyYW0geyhGdW5jdGlvbnxPYmplY3QpfSBbYXJnMl0gLSBUaGUgKDEpIHN1Y2Nlc3MgY2FsbGJhY2sgb3IgKDIpIG9iamVjdFxuICogICBsaXRlcmFsIHdpdGggc3VjY2Vzcy9lcnJvciBhcmd1bWVudHMsIG51bVJldHJpZXMsIGV0Yy5cbiAqL1xuZnVuY3Rpb24gbG9hZGpzKHBhdGhzLCBhcmcxLCBhcmcyKSB7XG4gIHZhciBidW5kbGVJZCxcbiAgICAgIGFyZ3M7XG5cbiAgLy8gYnVuZGxlSWQgKGlmIHN0cmluZylcbiAgaWYgKGFyZzEgJiYgYXJnMS50cmltKSBidW5kbGVJZCA9IGFyZzE7XG5cbiAgLy8gYXJncyAoZGVmYXVsdCBpcyB7fSlcbiAgYXJncyA9IChidW5kbGVJZCA/IGFyZzIgOiBhcmcxKSB8fCB7fTtcblxuICAvLyB0aHJvdyBlcnJvciBpZiBidW5kbGUgaXMgYWxyZWFkeSBkZWZpbmVkXG4gIGlmIChidW5kbGVJZCkge1xuICAgIGlmIChidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlKSB7XG4gICAgICB0aHJvdyBcIkxvYWRKU1wiO1xuICAgIH0gZWxzZSB7XG4gICAgICBidW5kbGVJZENhY2hlW2J1bmRsZUlkXSA9IHRydWU7XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gbG9hZEZuKHJlc29sdmUsIHJlamVjdCkge1xuICAgIGxvYWRGaWxlcyhwYXRocywgZnVuY3Rpb24gKHBhdGhzTm90Rm91bmQpIHtcbiAgICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tzXG4gICAgICBleGVjdXRlQ2FsbGJhY2tzKGFyZ3MsIHBhdGhzTm90Rm91bmQpO1xuICAgICAgXG4gICAgICAvLyByZXNvbHZlIFByb21pc2VcbiAgICAgIGlmIChyZXNvbHZlKSB7XG4gICAgICAgIGV4ZWN1dGVDYWxsYmFja3Moe3N1Y2Nlc3M6IHJlc29sdmUsIGVycm9yOiByZWplY3R9LCBwYXRoc05vdEZvdW5kKTtcbiAgICAgIH1cblxuICAgICAgLy8gcHVibGlzaCBidW5kbGUgbG9hZCBldmVudFxuICAgICAgcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCk7XG4gICAgfSwgYXJncyk7XG4gIH1cbiAgXG4gIGlmIChhcmdzLnJldHVyblByb21pc2UpIHJldHVybiBuZXcgUHJvbWlzZShsb2FkRm4pO1xuICBlbHNlIGxvYWRGbigpO1xufVxuXG5cbi8qKlxuICogRXhlY3V0ZSBjYWxsYmFja3Mgd2hlbiBkZXBlbmRlbmNpZXMgaGF2ZSBiZWVuIHNhdGlzZmllZC5cbiAqIEBwYXJhbSB7KHN0cmluZ3xzdHJpbmdbXSl9IGRlcHMgLSBMaXN0IG9mIGJ1bmRsZSBpZHNcbiAqIEBwYXJhbSB7T2JqZWN0fSBhcmdzIC0gc3VjY2Vzcy9lcnJvciBhcmd1bWVudHNcbiAqL1xubG9hZGpzLnJlYWR5ID0gZnVuY3Rpb24gcmVhZHkoZGVwcywgYXJncykge1xuICAvLyBzdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnRcbiAgc3Vic2NyaWJlKGRlcHMsIGZ1bmN0aW9uIChkZXBzTm90Rm91bmQpIHtcbiAgICAvLyBleGVjdXRlIGNhbGxiYWNrc1xuICAgIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgZGVwc05vdEZvdW5kKTtcbiAgfSk7XG5cbiAgcmV0dXJuIGxvYWRqcztcbn07XG5cblxuLyoqXG4gKiBNYW51YWxseSBzYXRpc2Z5IGJ1bmRsZSBkZXBlbmRlbmNpZXMuXG4gKiBAcGFyYW0ge3N0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkXG4gKi9cbmxvYWRqcy5kb25lID0gZnVuY3Rpb24gZG9uZShidW5kbGVJZCkge1xuICBwdWJsaXNoKGJ1bmRsZUlkLCBbXSk7XG59O1xuXG5cbi8qKlxuICogUmVzZXQgbG9hZGpzIGRlcGVuZGVuY2llcyBzdGF0dXNlc1xuICovXG5sb2FkanMucmVzZXQgPSBmdW5jdGlvbiByZXNldCgpIHtcbiAgYnVuZGxlSWRDYWNoZSA9IHt9O1xuICBidW5kbGVSZXN1bHRDYWNoZSA9IHt9O1xuICBidW5kbGVDYWxsYmFja1F1ZXVlID0ge307XG59O1xuXG5cbi8qKlxuICogRGV0ZXJtaW5lIGlmIGJ1bmRsZSBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWRcbiAqIEBwYXJhbSBTdHJpbmd9IGJ1bmRsZUlkIC0gVGhlIGJ1bmRsZSBpZFxuICovXG5sb2FkanMuaXNEZWZpbmVkID0gZnVuY3Rpb24gaXNEZWZpbmVkKGJ1bmRsZUlkKSB7XG4gIHJldHVybiBidW5kbGVJZCBpbiBidW5kbGVJZENhY2hlO1xufTtcblxuXG4vLyBleHBvcnRcbnJldHVybiBsb2FkanM7XG5cbn0pKTtcbiIsIi8qKlxyXG4gKiBDb3B5cmlnaHQgMjAxNSBUaW0gRG93bi5cclxuICpcclxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcclxuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxyXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcclxuICpcclxuICogICAgICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcclxuICpcclxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLCBzb2Z0d2FyZVxyXG4gKiBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXHJcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxyXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXHJcbiAqIGxpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxyXG4gKi9cclxuXHJcblxyXG4oZnVuY3Rpb24oZmFjdG9yeSxyb290KXtpZih0eXBlb2YgZGVmaW5lPT1cImZ1bmN0aW9uXCImJmRlZmluZS5hbWQpe2RlZmluZShmYWN0b3J5KTt9ZWxzZSBpZih0eXBlb2YgbW9kdWxlIT1cInVuZGVmaW5lZFwiJiZ0eXBlb2YgZXhwb3J0cz09XCJvYmplY3RcIil7bW9kdWxlLmV4cG9ydHM9ZmFjdG9yeSgpO31lbHNle3Jvb3QubG9nNGphdmFzY3JpcHQ9ZmFjdG9yeSgpO319KShmdW5jdGlvbigpe2lmKCFBcnJheS5wcm90b3R5cGUucHVzaCl7QXJyYXkucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MCxsZW49YXJndW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXNbdGhpcy5sZW5ndGhdPWFyZ3VtZW50c1tpXTt9XHJcbnJldHVybiB0aGlzLmxlbmd0aDt9O31cclxuaWYoIUFycmF5LnByb3RvdHlwZS5zaGlmdCl7QXJyYXkucHJvdG90eXBlLnNoaWZ0PWZ1bmN0aW9uKCl7aWYodGhpcy5sZW5ndGg+MCl7dmFyIGZpcnN0SXRlbT10aGlzWzBdO2Zvcih2YXIgaT0wLGxlbj10aGlzLmxlbmd0aC0xO2k8bGVuO2krKyl7dGhpc1tpXT10aGlzW2krMV07fVxyXG50aGlzLmxlbmd0aD10aGlzLmxlbmd0aC0xO3JldHVybiBmaXJzdEl0ZW07fX07fVxyXG5pZighQXJyYXkucHJvdG90eXBlLnNwbGljZSl7QXJyYXkucHJvdG90eXBlLnNwbGljZT1mdW5jdGlvbihzdGFydEluZGV4LGRlbGV0ZUNvdW50KXt2YXIgaXRlbXNBZnRlckRlbGV0ZWQ9dGhpcy5zbGljZShzdGFydEluZGV4K2RlbGV0ZUNvdW50KTt2YXIgaXRlbXNEZWxldGVkPXRoaXMuc2xpY2Uoc3RhcnRJbmRleCxzdGFydEluZGV4K2RlbGV0ZUNvdW50KTt0aGlzLmxlbmd0aD1zdGFydEluZGV4O3ZhciBhcmd1bWVudHNBcnJheT1bXTtmb3IodmFyIGk9MCxsZW49YXJndW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe2FyZ3VtZW50c0FycmF5W2ldPWFyZ3VtZW50c1tpXTt9XHJcbnZhciBpdGVtc1RvQXBwZW5kPShhcmd1bWVudHNBcnJheS5sZW5ndGg+Mik/aXRlbXNBZnRlckRlbGV0ZWQ9YXJndW1lbnRzQXJyYXkuc2xpY2UoMikuY29uY2F0KGl0ZW1zQWZ0ZXJEZWxldGVkKTppdGVtc0FmdGVyRGVsZXRlZDtmb3IoaT0wLGxlbj1pdGVtc1RvQXBwZW5kLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHVzaChpdGVtc1RvQXBwZW5kW2ldKTt9XHJcbnJldHVybiBpdGVtc0RlbGV0ZWQ7fTt9XHJcbmZ1bmN0aW9uIGlzVW5kZWZpbmVkKG9iail7cmV0dXJuIHR5cGVvZiBvYmo9PVwidW5kZWZpbmVkXCI7fVxyXG5mdW5jdGlvbiBFdmVudFN1cHBvcnQoKXt9XHJcbkV2ZW50U3VwcG9ydC5wcm90b3R5cGU9e2V2ZW50VHlwZXM6W10sZXZlbnRMaXN0ZW5lcnM6e30sc2V0RXZlbnRUeXBlczpmdW5jdGlvbihldmVudFR5cGVzUGFyYW0pe2lmKGV2ZW50VHlwZXNQYXJhbSBpbnN0YW5jZW9mIEFycmF5KXt0aGlzLmV2ZW50VHlwZXM9ZXZlbnRUeXBlc1BhcmFtO3RoaXMuZXZlbnRMaXN0ZW5lcnM9e307Zm9yKHZhciBpPTAsbGVuPXRoaXMuZXZlbnRUeXBlcy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmV2ZW50TGlzdGVuZXJzW3RoaXMuZXZlbnRUeXBlc1tpXV09W107fX1lbHNle2hhbmRsZUVycm9yKFwibG9nNGphdmFzY3JpcHQuRXZlbnRTdXBwb3J0IFtcIit0aGlzK1wiXTogc2V0RXZlbnRUeXBlczogZXZlbnRUeXBlcyBwYXJhbWV0ZXIgbXVzdCBiZSBhbiBBcnJheVwiKTt9fSxhZGRFdmVudExpc3RlbmVyOmZ1bmN0aW9uKGV2ZW50VHlwZSxsaXN0ZW5lcil7aWYodHlwZW9mIGxpc3RlbmVyPT1cImZ1bmN0aW9uXCIpe2lmKCFhcnJheV9jb250YWlucyh0aGlzLmV2ZW50VHlwZXMsZXZlbnRUeXBlKSl7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiBhZGRFdmVudExpc3RlbmVyOiBubyBldmVudCBjYWxsZWQgJ1wiK2V2ZW50VHlwZStcIidcIik7fVxyXG50aGlzLmV2ZW50TGlzdGVuZXJzW2V2ZW50VHlwZV0ucHVzaChsaXN0ZW5lcik7fWVsc2V7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiBhZGRFdmVudExpc3RlbmVyOiBsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb25cIik7fX0scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihldmVudFR5cGUsbGlzdGVuZXIpe2lmKHR5cGVvZiBsaXN0ZW5lcj09XCJmdW5jdGlvblwiKXtpZighYXJyYXlfY29udGFpbnModGhpcy5ldmVudFR5cGVzLGV2ZW50VHlwZSkpe2hhbmRsZUVycm9yKFwibG9nNGphdmFzY3JpcHQuRXZlbnRTdXBwb3J0IFtcIit0aGlzK1wiXTogcmVtb3ZlRXZlbnRMaXN0ZW5lcjogbm8gZXZlbnQgY2FsbGVkICdcIitldmVudFR5cGUrXCInXCIpO31cclxuYXJyYXlfcmVtb3ZlKHRoaXMuZXZlbnRMaXN0ZW5lcnNbZXZlbnRUeXBlXSxsaXN0ZW5lcik7fWVsc2V7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiByZW1vdmVFdmVudExpc3RlbmVyOiBsaXN0ZW5lciBtdXN0IGJlIGEgZnVuY3Rpb25cIik7fX0sZGlzcGF0Y2hFdmVudDpmdW5jdGlvbihldmVudFR5cGUsZXZlbnRBcmdzKXtpZihhcnJheV9jb250YWlucyh0aGlzLmV2ZW50VHlwZXMsZXZlbnRUeXBlKSl7dmFyIGxpc3RlbmVycz10aGlzLmV2ZW50TGlzdGVuZXJzW2V2ZW50VHlwZV07Zm9yKHZhciBpPTAsbGVuPWxpc3RlbmVycy5sZW5ndGg7aTxsZW47aSsrKXtsaXN0ZW5lcnNbaV0odGhpcyxldmVudFR5cGUsZXZlbnRBcmdzKTt9fWVsc2V7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiBkaXNwYXRjaEV2ZW50OiBubyBldmVudCBjYWxsZWQgJ1wiK2V2ZW50VHlwZStcIidcIik7fX19O3ZhciBhcHBsaWNhdGlvblN0YXJ0RGF0ZT1uZXcgRGF0ZSgpO3ZhciB1bmlxdWVJZD1cImxvZzRqYXZhc2NyaXB0X1wiK2FwcGxpY2F0aW9uU3RhcnREYXRlLmdldFRpbWUoKStcIl9cIitcclxuTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpKjEwMDAwMDAwMCk7dmFyIGVtcHR5RnVuY3Rpb249ZnVuY3Rpb24oKXt9O3ZhciBuZXdMaW5lPVwiXFxyXFxuXCI7dmFyIHBhZ2VMb2FkZWQ9ZmFsc2U7ZnVuY3Rpb24gTG9nNEphdmFTY3JpcHQoKXt9XHJcbkxvZzRKYXZhU2NyaXB0LnByb3RvdHlwZT1uZXcgRXZlbnRTdXBwb3J0KCk7dmFyIGxvZzRqYXZhc2NyaXB0PW5ldyBMb2c0SmF2YVNjcmlwdCgpO2xvZzRqYXZhc2NyaXB0LnZlcnNpb249XCIxLjQuMTNcIjtsb2c0amF2YXNjcmlwdC5lZGl0aW9uPVwibG9nNGphdmFzY3JpcHRcIjtmdW5jdGlvbiB0b1N0cihvYmope2lmKG9iaiYmb2JqLnRvU3RyaW5nKXtyZXR1cm4gb2JqLnRvU3RyaW5nKCk7fWVsc2V7cmV0dXJuIFN0cmluZyhvYmopO319XHJcbmZ1bmN0aW9uIGdldEV4Y2VwdGlvbk1lc3NhZ2UoZXgpe2lmKGV4Lm1lc3NhZ2Upe3JldHVybiBleC5tZXNzYWdlO31lbHNlIGlmKGV4LmRlc2NyaXB0aW9uKXtyZXR1cm4gZXguZGVzY3JpcHRpb247fWVsc2V7cmV0dXJuIHRvU3RyKGV4KTt9fVxyXG5mdW5jdGlvbiBnZXRVcmxGaWxlTmFtZSh1cmwpe3ZhciBsYXN0U2xhc2hJbmRleD1NYXRoLm1heCh1cmwubGFzdEluZGV4T2YoXCIvXCIpLHVybC5sYXN0SW5kZXhPZihcIlxcXFxcIikpO3JldHVybiB1cmwuc3Vic3RyKGxhc3RTbGFzaEluZGV4KzEpO31cclxuZnVuY3Rpb24gZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4KXtpZihleCl7dmFyIGV4U3RyPVwiRXhjZXB0aW9uOiBcIitnZXRFeGNlcHRpb25NZXNzYWdlKGV4KTt0cnl7aWYoZXgubGluZU51bWJlcil7ZXhTdHIrPVwiIG9uIGxpbmUgbnVtYmVyIFwiK2V4LmxpbmVOdW1iZXI7fVxyXG5pZihleC5maWxlTmFtZSl7ZXhTdHIrPVwiIGluIGZpbGUgXCIrZ2V0VXJsRmlsZU5hbWUoZXguZmlsZU5hbWUpO319Y2F0Y2gobG9jYWxFeCl7bG9nTG9nLndhcm4oXCJVbmFibGUgdG8gb2J0YWluIGZpbGUgYW5kIGxpbmUgaW5mb3JtYXRpb24gZm9yIGVycm9yXCIpO31cclxuaWYoc2hvd1N0YWNrVHJhY2VzJiZleC5zdGFjayl7ZXhTdHIrPW5ld0xpbmUrXCJTdGFjayB0cmFjZTpcIituZXdMaW5lK2V4LnN0YWNrO31cclxucmV0dXJuIGV4U3RyO31cclxucmV0dXJuIG51bGw7fVxyXG5mdW5jdGlvbiBib29sKG9iail7cmV0dXJuIEJvb2xlYW4ob2JqKTt9XHJcbmZ1bmN0aW9uIHRyaW0oc3RyKXtyZXR1cm4gc3RyLnJlcGxhY2UoL15cXHMrLyxcIlwiKS5yZXBsYWNlKC9cXHMrJC8sXCJcIik7fVxyXG5mdW5jdGlvbiBzcGxpdEludG9MaW5lcyh0ZXh0KXt2YXIgdGV4dDI9dGV4dC5yZXBsYWNlKC9cXHJcXG4vZyxcIlxcblwiKS5yZXBsYWNlKC9cXHIvZyxcIlxcblwiKTtyZXR1cm4gdGV4dDIuc3BsaXQoXCJcXG5cIik7fVxyXG52YXIgdXJsRW5jb2RlPSh0eXBlb2Ygd2luZG93LmVuY29kZVVSSUNvbXBvbmVudCE9XCJ1bmRlZmluZWRcIik/ZnVuY3Rpb24oc3RyKXtyZXR1cm4gZW5jb2RlVVJJQ29tcG9uZW50KHN0cik7fTpmdW5jdGlvbihzdHIpe3JldHVybiBlc2NhcGUoc3RyKS5yZXBsYWNlKC9cXCsvZyxcIiUyQlwiKS5yZXBsYWNlKC9cIi9nLFwiJTIyXCIpLnJlcGxhY2UoLycvZyxcIiUyN1wiKS5yZXBsYWNlKC9cXC8vZyxcIiUyRlwiKS5yZXBsYWNlKC89L2csXCIlM0RcIik7fTtmdW5jdGlvbiBhcnJheV9yZW1vdmUoYXJyLHZhbCl7dmFyIGluZGV4PS0xO2Zvcih2YXIgaT0wLGxlbj1hcnIubGVuZ3RoO2k8bGVuO2krKyl7aWYoYXJyW2ldPT09dmFsKXtpbmRleD1pO2JyZWFrO319XHJcbmlmKGluZGV4Pj0wKXthcnIuc3BsaWNlKGluZGV4LDEpO3JldHVybiB0cnVlO31lbHNle3JldHVybiBmYWxzZTt9fVxyXG5mdW5jdGlvbiBhcnJheV9jb250YWlucyhhcnIsdmFsKXtmb3IodmFyIGk9MCxsZW49YXJyLmxlbmd0aDtpPGxlbjtpKyspe2lmKGFycltpXT09dmFsKXtyZXR1cm4gdHJ1ZTt9fVxyXG5yZXR1cm4gZmFsc2U7fVxyXG5mdW5jdGlvbiBleHRyYWN0Qm9vbGVhbkZyb21QYXJhbShwYXJhbSxkZWZhdWx0VmFsdWUpe2lmKGlzVW5kZWZpbmVkKHBhcmFtKSl7cmV0dXJuIGRlZmF1bHRWYWx1ZTt9ZWxzZXtyZXR1cm4gYm9vbChwYXJhbSk7fX1cclxuZnVuY3Rpb24gZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShwYXJhbSxkZWZhdWx0VmFsdWUpe2lmKGlzVW5kZWZpbmVkKHBhcmFtKSl7cmV0dXJuIGRlZmF1bHRWYWx1ZTt9ZWxzZXtyZXR1cm4gU3RyaW5nKHBhcmFtKTt9fVxyXG5mdW5jdGlvbiBleHRyYWN0SW50RnJvbVBhcmFtKHBhcmFtLGRlZmF1bHRWYWx1ZSl7aWYoaXNVbmRlZmluZWQocGFyYW0pKXtyZXR1cm4gZGVmYXVsdFZhbHVlO31lbHNle3RyeXt2YXIgdmFsdWU9cGFyc2VJbnQocGFyYW0sMTApO3JldHVybiBpc05hTih2YWx1ZSk/ZGVmYXVsdFZhbHVlOnZhbHVlO31jYXRjaChleCl7bG9nTG9nLndhcm4oXCJJbnZhbGlkIGludCBwYXJhbSBcIitwYXJhbSxleCk7cmV0dXJuIGRlZmF1bHRWYWx1ZTt9fX1cclxuZnVuY3Rpb24gZXh0cmFjdEZ1bmN0aW9uRnJvbVBhcmFtKHBhcmFtLGRlZmF1bHRWYWx1ZSl7aWYodHlwZW9mIHBhcmFtPT1cImZ1bmN0aW9uXCIpe3JldHVybiBwYXJhbTt9ZWxzZXtyZXR1cm4gZGVmYXVsdFZhbHVlO319XHJcbmZ1bmN0aW9uIGlzRXJyb3IoZXJyKXtyZXR1cm4oZXJyIGluc3RhbmNlb2YgRXJyb3IpO31cclxuaWYoIUZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseSl7RnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5PWZ1bmN0aW9uKG9iaixhcmdzKXt2YXIgbWV0aG9kTmFtZT1cIl9fYXBwbHlfX1wiO2lmKHR5cGVvZiBvYmpbbWV0aG9kTmFtZV0hPVwidW5kZWZpbmVkXCIpe21ldGhvZE5hbWUrPVN0cmluZyhNYXRoLnJhbmRvbSgpKS5zdWJzdHIoMik7fVxyXG5vYmpbbWV0aG9kTmFtZV09dGhpczt2YXIgYXJnc1N0cmluZ3M9W107Zm9yKHZhciBpPTAsbGVuPWFyZ3MubGVuZ3RoO2k8bGVuO2krKyl7YXJnc1N0cmluZ3NbaV09XCJhcmdzW1wiK2krXCJdXCI7fVxyXG52YXIgc2NyaXB0PVwib2JqLlwiK21ldGhvZE5hbWUrXCIoXCIrYXJnc1N0cmluZ3Muam9pbihcIixcIikrXCIpXCI7dmFyIHJldHVyblZhbHVlPWV2YWwoc2NyaXB0KTtkZWxldGUgb2JqW21ldGhvZE5hbWVdO3JldHVybiByZXR1cm5WYWx1ZTt9O31cclxuaWYoIUZ1bmN0aW9uLnByb3RvdHlwZS5jYWxsKXtGdW5jdGlvbi5wcm90b3R5cGUuY2FsbD1mdW5jdGlvbihvYmope3ZhciBhcmdzPVtdO2Zvcih2YXIgaT0xLGxlbj1hcmd1bWVudHMubGVuZ3RoO2k8bGVuO2krKyl7YXJnc1tpLTFdPWFyZ3VtZW50c1tpXTt9XHJcbnJldHVybiB0aGlzLmFwcGx5KG9iaixhcmdzKTt9O31cclxudmFyIGxvZ0xvZz17cXVpZXRNb2RlOmZhbHNlLGRlYnVnTWVzc2FnZXM6W10sc2V0UXVpZXRNb2RlOmZ1bmN0aW9uKHF1aWV0TW9kZSl7dGhpcy5xdWlldE1vZGU9Ym9vbChxdWlldE1vZGUpO30sbnVtYmVyT2ZFcnJvcnM6MCxhbGVydEFsbEVycm9yczpmYWxzZSxzZXRBbGVydEFsbEVycm9yczpmdW5jdGlvbihhbGVydEFsbEVycm9ycyl7dGhpcy5hbGVydEFsbEVycm9ycz1hbGVydEFsbEVycm9yczt9LGRlYnVnOmZ1bmN0aW9uKG1lc3NhZ2Upe3RoaXMuZGVidWdNZXNzYWdlcy5wdXNoKG1lc3NhZ2UpO30sZGlzcGxheURlYnVnOmZ1bmN0aW9uKCl7YWxlcnQodGhpcy5kZWJ1Z01lc3NhZ2VzLmpvaW4obmV3TGluZSkpO30sd2FybjpmdW5jdGlvbihtZXNzYWdlLGV4Y2VwdGlvbil7fSxlcnJvcjpmdW5jdGlvbihtZXNzYWdlLGV4Y2VwdGlvbil7aWYoKyt0aGlzLm51bWJlck9mRXJyb3JzPT0xfHx0aGlzLmFsZXJ0QWxsRXJyb3JzKXtpZighdGhpcy5xdWlldE1vZGUpe3ZhciBhbGVydE1lc3NhZ2U9XCJsb2c0amF2YXNjcmlwdCBlcnJvcjogXCIrbWVzc2FnZTtpZihleGNlcHRpb24pe2FsZXJ0TWVzc2FnZSs9bmV3TGluZStuZXdMaW5lK1wiT3JpZ2luYWwgZXJyb3I6IFwiK2dldEV4Y2VwdGlvblN0cmluZ1JlcChleGNlcHRpb24pO31cclxuYWxlcnQoYWxlcnRNZXNzYWdlKTt9fX19O2xvZzRqYXZhc2NyaXB0LmxvZ0xvZz1sb2dMb2c7bG9nNGphdmFzY3JpcHQuc2V0RXZlbnRUeXBlcyhbXCJsb2FkXCIsXCJlcnJvclwiXSk7ZnVuY3Rpb24gaGFuZGxlRXJyb3IobWVzc2FnZSxleGNlcHRpb24pe2xvZ0xvZy5lcnJvcihtZXNzYWdlLGV4Y2VwdGlvbik7bG9nNGphdmFzY3JpcHQuZGlzcGF0Y2hFdmVudChcImVycm9yXCIse1wibWVzc2FnZVwiOm1lc3NhZ2UsXCJleGNlcHRpb25cIjpleGNlcHRpb259KTt9XHJcbmxvZzRqYXZhc2NyaXB0LmhhbmRsZUVycm9yPWhhbmRsZUVycm9yO3ZhciBlbmFibGVkPSEoKHR5cGVvZiBsb2c0amF2YXNjcmlwdF9kaXNhYmxlZCE9XCJ1bmRlZmluZWRcIikmJmxvZzRqYXZhc2NyaXB0X2Rpc2FibGVkKTtsb2c0amF2YXNjcmlwdC5zZXRFbmFibGVkPWZ1bmN0aW9uKGVuYWJsZSl7ZW5hYmxlZD1ib29sKGVuYWJsZSk7fTtsb2c0amF2YXNjcmlwdC5pc0VuYWJsZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gZW5hYmxlZDt9O3ZhciB1c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM9dHJ1ZTtsb2c0amF2YXNjcmlwdC5zZXRUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM9ZnVuY3Rpb24odGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKXt1c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM9Ym9vbCh0aW1lU3RhbXBzSW5NaWxsaXNlY29uZHMpO307bG9nNGphdmFzY3JpcHQuaXNUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM9ZnVuY3Rpb24oKXtyZXR1cm4gdXNlVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzO307bG9nNGphdmFzY3JpcHQuZXZhbEluU2NvcGU9ZnVuY3Rpb24oZXhwcil7cmV0dXJuIGV2YWwoZXhwcik7fTt2YXIgc2hvd1N0YWNrVHJhY2VzPWZhbHNlO2xvZzRqYXZhc2NyaXB0LnNldFNob3dTdGFja1RyYWNlcz1mdW5jdGlvbihzaG93KXtzaG93U3RhY2tUcmFjZXM9Ym9vbChzaG93KTt9O3ZhciBMZXZlbD1mdW5jdGlvbihsZXZlbCxuYW1lKXt0aGlzLmxldmVsPWxldmVsO3RoaXMubmFtZT1uYW1lO307TGV2ZWwucHJvdG90eXBlPXt0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLm5hbWU7fSxlcXVhbHM6ZnVuY3Rpb24obGV2ZWwpe3JldHVybiB0aGlzLmxldmVsPT1sZXZlbC5sZXZlbDt9LGlzR3JlYXRlck9yRXF1YWw6ZnVuY3Rpb24obGV2ZWwpe3JldHVybiB0aGlzLmxldmVsPj1sZXZlbC5sZXZlbDt9fTtMZXZlbC5BTEw9bmV3IExldmVsKE51bWJlci5NSU5fVkFMVUUsXCJBTExcIik7TGV2ZWwuVFJBQ0U9bmV3IExldmVsKDEwMDAwLFwiVFJBQ0VcIik7TGV2ZWwuREVCVUc9bmV3IExldmVsKDIwMDAwLFwiREVCVUdcIik7TGV2ZWwuSU5GTz1uZXcgTGV2ZWwoMzAwMDAsXCJJTkZPXCIpO0xldmVsLldBUk49bmV3IExldmVsKDQwMDAwLFwiV0FSTlwiKTtMZXZlbC5FUlJPUj1uZXcgTGV2ZWwoNTAwMDAsXCJFUlJPUlwiKTtMZXZlbC5GQVRBTD1uZXcgTGV2ZWwoNjAwMDAsXCJGQVRBTFwiKTtMZXZlbC5PRkY9bmV3IExldmVsKE51bWJlci5NQVhfVkFMVUUsXCJPRkZcIik7bG9nNGphdmFzY3JpcHQuTGV2ZWw9TGV2ZWw7ZnVuY3Rpb24gVGltZXIobmFtZSxsZXZlbCl7dGhpcy5uYW1lPW5hbWU7dGhpcy5sZXZlbD1pc1VuZGVmaW5lZChsZXZlbCk/TGV2ZWwuSU5GTzpsZXZlbDt0aGlzLnN0YXJ0PW5ldyBEYXRlKCk7fVxyXG5UaW1lci5wcm90b3R5cGUuZ2V0RWxhcHNlZFRpbWU9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCktdGhpcy5zdGFydC5nZXRUaW1lKCk7fTt2YXIgYW5vbnltb3VzTG9nZ2VyTmFtZT1cIlthbm9ueW1vdXNdXCI7dmFyIGRlZmF1bHRMb2dnZXJOYW1lPVwiW2RlZmF1bHRdXCI7dmFyIG51bGxMb2dnZXJOYW1lPVwiW251bGxdXCI7dmFyIHJvb3RMb2dnZXJOYW1lPVwicm9vdFwiO2Z1bmN0aW9uIExvZ2dlcihuYW1lKXt0aGlzLm5hbWU9bmFtZTt0aGlzLnBhcmVudD1udWxsO3RoaXMuY2hpbGRyZW49W107dmFyIGFwcGVuZGVycz1bXTt2YXIgbG9nZ2VyTGV2ZWw9bnVsbDt2YXIgaXNSb290PSh0aGlzLm5hbWU9PT1yb290TG9nZ2VyTmFtZSk7dmFyIGlzTnVsbD0odGhpcy5uYW1lPT09bnVsbExvZ2dlck5hbWUpO3ZhciBhcHBlbmRlckNhY2hlPW51bGw7dmFyIGFwcGVuZGVyQ2FjaGVJbnZhbGlkYXRlZD1mYWxzZTt0aGlzLmFkZENoaWxkPWZ1bmN0aW9uKGNoaWxkTG9nZ2VyKXt0aGlzLmNoaWxkcmVuLnB1c2goY2hpbGRMb2dnZXIpO2NoaWxkTG9nZ2VyLnBhcmVudD10aGlzO2NoaWxkTG9nZ2VyLmludmFsaWRhdGVBcHBlbmRlckNhY2hlKCk7fTt2YXIgYWRkaXRpdmU9dHJ1ZTt0aGlzLmdldEFkZGl0aXZpdHk9ZnVuY3Rpb24oKXtyZXR1cm4gYWRkaXRpdmU7fTt0aGlzLnNldEFkZGl0aXZpdHk9ZnVuY3Rpb24oYWRkaXRpdml0eSl7dmFyIHZhbHVlQ2hhbmdlZD0oYWRkaXRpdmUhPWFkZGl0aXZpdHkpO2FkZGl0aXZlPWFkZGl0aXZpdHk7aWYodmFsdWVDaGFuZ2VkKXt0aGlzLmludmFsaWRhdGVBcHBlbmRlckNhY2hlKCk7fX07dGhpcy5hZGRBcHBlbmRlcj1mdW5jdGlvbihhcHBlbmRlcil7aWYoaXNOdWxsKXtoYW5kbGVFcnJvcihcIkxvZ2dlci5hZGRBcHBlbmRlcjogeW91IG1heSBub3QgYWRkIGFuIGFwcGVuZGVyIHRvIHRoZSBudWxsIGxvZ2dlclwiKTt9ZWxzZXtpZihhcHBlbmRlciBpbnN0YW5jZW9mIGxvZzRqYXZhc2NyaXB0LkFwcGVuZGVyKXtpZighYXJyYXlfY29udGFpbnMoYXBwZW5kZXJzLGFwcGVuZGVyKSl7YXBwZW5kZXJzLnB1c2goYXBwZW5kZXIpO2FwcGVuZGVyLnNldEFkZGVkVG9Mb2dnZXIodGhpcyk7dGhpcy5pbnZhbGlkYXRlQXBwZW5kZXJDYWNoZSgpO319ZWxzZXtoYW5kbGVFcnJvcihcIkxvZ2dlci5hZGRBcHBlbmRlcjogYXBwZW5kZXIgc3VwcGxpZWQgKCdcIitcclxudG9TdHIoYXBwZW5kZXIpK1wiJykgaXMgbm90IGEgc3ViY2xhc3Mgb2YgQXBwZW5kZXJcIik7fX19O3RoaXMucmVtb3ZlQXBwZW5kZXI9ZnVuY3Rpb24oYXBwZW5kZXIpe2FycmF5X3JlbW92ZShhcHBlbmRlcnMsYXBwZW5kZXIpO2FwcGVuZGVyLnNldFJlbW92ZWRGcm9tTG9nZ2VyKHRoaXMpO3RoaXMuaW52YWxpZGF0ZUFwcGVuZGVyQ2FjaGUoKTt9O3RoaXMucmVtb3ZlQWxsQXBwZW5kZXJzPWZ1bmN0aW9uKCl7dmFyIGFwcGVuZGVyQ291bnQ9YXBwZW5kZXJzLmxlbmd0aDtpZihhcHBlbmRlckNvdW50PjApe2Zvcih2YXIgaT0wO2k8YXBwZW5kZXJDb3VudDtpKyspe2FwcGVuZGVyc1tpXS5zZXRSZW1vdmVkRnJvbUxvZ2dlcih0aGlzKTt9XHJcbmFwcGVuZGVycy5sZW5ndGg9MDt0aGlzLmludmFsaWRhdGVBcHBlbmRlckNhY2hlKCk7fX07dGhpcy5nZXRFZmZlY3RpdmVBcHBlbmRlcnM9ZnVuY3Rpb24oKXtpZihhcHBlbmRlckNhY2hlPT09bnVsbHx8YXBwZW5kZXJDYWNoZUludmFsaWRhdGVkKXt2YXIgcGFyZW50RWZmZWN0aXZlQXBwZW5kZXJzPShpc1Jvb3R8fCF0aGlzLmdldEFkZGl0aXZpdHkoKSk/W106dGhpcy5wYXJlbnQuZ2V0RWZmZWN0aXZlQXBwZW5kZXJzKCk7YXBwZW5kZXJDYWNoZT1wYXJlbnRFZmZlY3RpdmVBcHBlbmRlcnMuY29uY2F0KGFwcGVuZGVycyk7YXBwZW5kZXJDYWNoZUludmFsaWRhdGVkPWZhbHNlO31cclxucmV0dXJuIGFwcGVuZGVyQ2FjaGU7fTt0aGlzLmludmFsaWRhdGVBcHBlbmRlckNhY2hlPWZ1bmN0aW9uKCl7YXBwZW5kZXJDYWNoZUludmFsaWRhdGVkPXRydWU7Zm9yKHZhciBpPTAsbGVuPXRoaXMuY2hpbGRyZW4ubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5jaGlsZHJlbltpXS5pbnZhbGlkYXRlQXBwZW5kZXJDYWNoZSgpO319O3RoaXMubG9nPWZ1bmN0aW9uKGxldmVsLHBhcmFtcyl7aWYoZW5hYmxlZCYmbGV2ZWwuaXNHcmVhdGVyT3JFcXVhbCh0aGlzLmdldEVmZmVjdGl2ZUxldmVsKCkpKXt2YXIgZXhjZXB0aW9uO3ZhciBmaW5hbFBhcmFtSW5kZXg9cGFyYW1zLmxlbmd0aC0xO3ZhciBsYXN0UGFyYW09cGFyYW1zW2ZpbmFsUGFyYW1JbmRleF07aWYocGFyYW1zLmxlbmd0aD4xJiZpc0Vycm9yKGxhc3RQYXJhbSkpe2V4Y2VwdGlvbj1sYXN0UGFyYW07ZmluYWxQYXJhbUluZGV4LS07fVxyXG52YXIgbWVzc2FnZXM9W107Zm9yKHZhciBpPTA7aTw9ZmluYWxQYXJhbUluZGV4O2krKyl7bWVzc2FnZXNbaV09cGFyYW1zW2ldO31cclxudmFyIGxvZ2dpbmdFdmVudD1uZXcgTG9nZ2luZ0V2ZW50KHRoaXMsbmV3IERhdGUoKSxsZXZlbCxtZXNzYWdlcyxleGNlcHRpb24pO3RoaXMuY2FsbEFwcGVuZGVycyhsb2dnaW5nRXZlbnQpO319O3RoaXMuY2FsbEFwcGVuZGVycz1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciBlZmZlY3RpdmVBcHBlbmRlcnM9dGhpcy5nZXRFZmZlY3RpdmVBcHBlbmRlcnMoKTtmb3IodmFyIGk9MCxsZW49ZWZmZWN0aXZlQXBwZW5kZXJzLmxlbmd0aDtpPGxlbjtpKyspe2VmZmVjdGl2ZUFwcGVuZGVyc1tpXS5kb0FwcGVuZChsb2dnaW5nRXZlbnQpO319O3RoaXMuc2V0TGV2ZWw9ZnVuY3Rpb24obGV2ZWwpe2lmKGlzUm9vdCYmbGV2ZWw9PT1udWxsKXtoYW5kbGVFcnJvcihcIkxvZ2dlci5zZXRMZXZlbDogeW91IGNhbm5vdCBzZXQgdGhlIGxldmVsIG9mIHRoZSByb290IGxvZ2dlciB0byBudWxsXCIpO31lbHNlIGlmKGxldmVsIGluc3RhbmNlb2YgTGV2ZWwpe2xvZ2dlckxldmVsPWxldmVsO31lbHNle2hhbmRsZUVycm9yKFwiTG9nZ2VyLnNldExldmVsOiBsZXZlbCBzdXBwbGllZCB0byBsb2dnZXIgXCIrXHJcbnRoaXMubmFtZStcIiBpcyBub3QgYW4gaW5zdGFuY2Ugb2YgbG9nNGphdmFzY3JpcHQuTGV2ZWxcIik7fX07dGhpcy5nZXRMZXZlbD1mdW5jdGlvbigpe3JldHVybiBsb2dnZXJMZXZlbDt9O3RoaXMuZ2V0RWZmZWN0aXZlTGV2ZWw9ZnVuY3Rpb24oKXtmb3IodmFyIGxvZ2dlcj10aGlzO2xvZ2dlciE9PW51bGw7bG9nZ2VyPWxvZ2dlci5wYXJlbnQpe3ZhciBsZXZlbD1sb2dnZXIuZ2V0TGV2ZWwoKTtpZihsZXZlbCE9PW51bGwpe3JldHVybiBsZXZlbDt9fX07dGhpcy5ncm91cD1mdW5jdGlvbihuYW1lLGluaXRpYWxseUV4cGFuZGVkKXtpZihlbmFibGVkKXt2YXIgZWZmZWN0aXZlQXBwZW5kZXJzPXRoaXMuZ2V0RWZmZWN0aXZlQXBwZW5kZXJzKCk7Zm9yKHZhciBpPTAsbGVuPWVmZmVjdGl2ZUFwcGVuZGVycy5sZW5ndGg7aTxsZW47aSsrKXtlZmZlY3RpdmVBcHBlbmRlcnNbaV0uZ3JvdXAobmFtZSxpbml0aWFsbHlFeHBhbmRlZCk7fX19O3RoaXMuZ3JvdXBFbmQ9ZnVuY3Rpb24oKXtpZihlbmFibGVkKXt2YXIgZWZmZWN0aXZlQXBwZW5kZXJzPXRoaXMuZ2V0RWZmZWN0aXZlQXBwZW5kZXJzKCk7Zm9yKHZhciBpPTAsbGVuPWVmZmVjdGl2ZUFwcGVuZGVycy5sZW5ndGg7aTxsZW47aSsrKXtlZmZlY3RpdmVBcHBlbmRlcnNbaV0uZ3JvdXBFbmQoKTt9fX07dmFyIHRpbWVycz17fTt0aGlzLnRpbWU9ZnVuY3Rpb24obmFtZSxsZXZlbCl7aWYoZW5hYmxlZCl7aWYoaXNVbmRlZmluZWQobmFtZSkpe2hhbmRsZUVycm9yKFwiTG9nZ2VyLnRpbWU6IGEgbmFtZSBmb3IgdGhlIHRpbWVyIG11c3QgYmUgc3VwcGxpZWRcIik7fWVsc2UgaWYobGV2ZWwmJiEobGV2ZWwgaW5zdGFuY2VvZiBMZXZlbCkpe2hhbmRsZUVycm9yKFwiTG9nZ2VyLnRpbWU6IGxldmVsIHN1cHBsaWVkIHRvIHRpbWVyIFwiK1xyXG5uYW1lK1wiIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBsb2c0amF2YXNjcmlwdC5MZXZlbFwiKTt9ZWxzZXt0aW1lcnNbbmFtZV09bmV3IFRpbWVyKG5hbWUsbGV2ZWwpO319fTt0aGlzLnRpbWVFbmQ9ZnVuY3Rpb24obmFtZSl7aWYoZW5hYmxlZCl7aWYoaXNVbmRlZmluZWQobmFtZSkpe2hhbmRsZUVycm9yKFwiTG9nZ2VyLnRpbWVFbmQ6IGEgbmFtZSBmb3IgdGhlIHRpbWVyIG11c3QgYmUgc3VwcGxpZWRcIik7fWVsc2UgaWYodGltZXJzW25hbWVdKXt2YXIgdGltZXI9dGltZXJzW25hbWVdO3ZhciBtaWxsaXNlY29uZHM9dGltZXIuZ2V0RWxhcHNlZFRpbWUoKTt0aGlzLmxvZyh0aW1lci5sZXZlbCxbXCJUaW1lciBcIit0b1N0cihuYW1lKStcIiBjb21wbGV0ZWQgaW4gXCIrbWlsbGlzZWNvbmRzK1wibXNcIl0pO2RlbGV0ZSB0aW1lcnNbbmFtZV07fWVsc2V7bG9nTG9nLndhcm4oXCJMb2dnZXIudGltZUVuZDogbm8gdGltZXIgZm91bmQgd2l0aCBuYW1lIFwiK25hbWUpO319fTt0aGlzLmFzc2VydD1mdW5jdGlvbihleHByKXtpZihlbmFibGVkJiYhZXhwcil7dmFyIGFyZ3M9W107Zm9yKHZhciBpPTEsbGVuPWFyZ3VtZW50cy5sZW5ndGg7aTxsZW47aSsrKXthcmdzLnB1c2goYXJndW1lbnRzW2ldKTt9XHJcbmFyZ3M9KGFyZ3MubGVuZ3RoPjApP2FyZ3M6W1wiQXNzZXJ0aW9uIEZhaWx1cmVcIl07YXJncy5wdXNoKG5ld0xpbmUpO2FyZ3MucHVzaChleHByKTt0aGlzLmxvZyhMZXZlbC5FUlJPUixhcmdzKTt9fTt0aGlzLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJMb2dnZXJbXCIrdGhpcy5uYW1lK1wiXVwiO307fVxyXG5Mb2dnZXIucHJvdG90eXBlPXt0cmFjZTpmdW5jdGlvbigpe3RoaXMubG9nKExldmVsLlRSQUNFLGFyZ3VtZW50cyk7fSxkZWJ1ZzpmdW5jdGlvbigpe3RoaXMubG9nKExldmVsLkRFQlVHLGFyZ3VtZW50cyk7fSxpbmZvOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuSU5GTyxhcmd1bWVudHMpO30sd2FybjpmdW5jdGlvbigpe3RoaXMubG9nKExldmVsLldBUk4sYXJndW1lbnRzKTt9LGVycm9yOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuRVJST1IsYXJndW1lbnRzKTt9LGZhdGFsOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuRkFUQUwsYXJndW1lbnRzKTt9LGlzRW5hYmxlZEZvcjpmdW5jdGlvbihsZXZlbCl7cmV0dXJuIGxldmVsLmlzR3JlYXRlck9yRXF1YWwodGhpcy5nZXRFZmZlY3RpdmVMZXZlbCgpKTt9LGlzVHJhY2VFbmFibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbmFibGVkRm9yKExldmVsLlRSQUNFKTt9LGlzRGVidWdFbmFibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbmFibGVkRm9yKExldmVsLkRFQlVHKTt9LGlzSW5mb0VuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuSU5GTyk7fSxpc1dhcm5FbmFibGVkOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuaXNFbmFibGVkRm9yKExldmVsLldBUk4pO30saXNFcnJvckVuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuRVJST1IpO30saXNGYXRhbEVuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuRkFUQUwpO319O0xvZ2dlci5wcm90b3R5cGUudHJhY2UuaXNFbnRyeVBvaW50PXRydWU7TG9nZ2VyLnByb3RvdHlwZS5kZWJ1Zy5pc0VudHJ5UG9pbnQ9dHJ1ZTtMb2dnZXIucHJvdG90eXBlLmluZm8uaXNFbnRyeVBvaW50PXRydWU7TG9nZ2VyLnByb3RvdHlwZS53YXJuLmlzRW50cnlQb2ludD10cnVlO0xvZ2dlci5wcm90b3R5cGUuZXJyb3IuaXNFbnRyeVBvaW50PXRydWU7TG9nZ2VyLnByb3RvdHlwZS5mYXRhbC5pc0VudHJ5UG9pbnQ9dHJ1ZTt2YXIgbG9nZ2Vycz17fTt2YXIgbG9nZ2VyTmFtZXM9W107dmFyIFJPT1RfTE9HR0VSX0RFRkFVTFRfTEVWRUw9TGV2ZWwuREVCVUc7dmFyIHJvb3RMb2dnZXI9bmV3IExvZ2dlcihyb290TG9nZ2VyTmFtZSk7cm9vdExvZ2dlci5zZXRMZXZlbChST09UX0xPR0dFUl9ERUZBVUxUX0xFVkVMKTtsb2c0amF2YXNjcmlwdC5nZXRSb290TG9nZ2VyPWZ1bmN0aW9uKCl7cmV0dXJuIHJvb3RMb2dnZXI7fTtsb2c0amF2YXNjcmlwdC5nZXRMb2dnZXI9ZnVuY3Rpb24obG9nZ2VyTmFtZSl7aWYodHlwZW9mIGxvZ2dlck5hbWUhPVwic3RyaW5nXCIpe2xvZ2dlck5hbWU9YW5vbnltb3VzTG9nZ2VyTmFtZTtsb2dMb2cud2FybihcImxvZzRqYXZhc2NyaXB0LmdldExvZ2dlcjogbm9uLXN0cmluZyBsb2dnZXIgbmFtZSBcIitcclxudG9TdHIobG9nZ2VyTmFtZSkrXCIgc3VwcGxpZWQsIHJldHVybmluZyBhbm9ueW1vdXMgbG9nZ2VyXCIpO31cclxuaWYobG9nZ2VyTmFtZT09cm9vdExvZ2dlck5hbWUpe2hhbmRsZUVycm9yKFwibG9nNGphdmFzY3JpcHQuZ2V0TG9nZ2VyOiByb290IGxvZ2dlciBtYXkgbm90IGJlIG9idGFpbmVkIGJ5IG5hbWVcIik7fVxyXG5pZighbG9nZ2Vyc1tsb2dnZXJOYW1lXSl7dmFyIGxvZ2dlcj1uZXcgTG9nZ2VyKGxvZ2dlck5hbWUpO2xvZ2dlcnNbbG9nZ2VyTmFtZV09bG9nZ2VyO2xvZ2dlck5hbWVzLnB1c2gobG9nZ2VyTmFtZSk7dmFyIGxhc3REb3RJbmRleD1sb2dnZXJOYW1lLmxhc3RJbmRleE9mKFwiLlwiKTt2YXIgcGFyZW50TG9nZ2VyO2lmKGxhc3REb3RJbmRleD4tMSl7dmFyIHBhcmVudExvZ2dlck5hbWU9bG9nZ2VyTmFtZS5zdWJzdHJpbmcoMCxsYXN0RG90SW5kZXgpO3BhcmVudExvZ2dlcj1sb2c0amF2YXNjcmlwdC5nZXRMb2dnZXIocGFyZW50TG9nZ2VyTmFtZSk7fWVsc2V7cGFyZW50TG9nZ2VyPXJvb3RMb2dnZXI7fVxyXG5wYXJlbnRMb2dnZXIuYWRkQ2hpbGQobG9nZ2VyKTt9XHJcbnJldHVybiBsb2dnZXJzW2xvZ2dlck5hbWVdO307dmFyIGRlZmF1bHRMb2dnZXI9bnVsbDtsb2c0amF2YXNjcmlwdC5nZXREZWZhdWx0TG9nZ2VyPWZ1bmN0aW9uKCl7aWYoIWRlZmF1bHRMb2dnZXIpe2RlZmF1bHRMb2dnZXI9Y3JlYXRlRGVmYXVsdExvZ2dlcigpO31cclxucmV0dXJuIGRlZmF1bHRMb2dnZXI7fTt2YXIgbnVsbExvZ2dlcj1udWxsO2xvZzRqYXZhc2NyaXB0LmdldE51bGxMb2dnZXI9ZnVuY3Rpb24oKXtpZighbnVsbExvZ2dlcil7bnVsbExvZ2dlcj1uZXcgTG9nZ2VyKG51bGxMb2dnZXJOYW1lKTtudWxsTG9nZ2VyLnNldExldmVsKExldmVsLk9GRik7fVxyXG5yZXR1cm4gbnVsbExvZ2dlcjt9O2xvZzRqYXZhc2NyaXB0LnJlc2V0Q29uZmlndXJhdGlvbj1mdW5jdGlvbigpe3Jvb3RMb2dnZXIuc2V0TGV2ZWwoUk9PVF9MT0dHRVJfREVGQVVMVF9MRVZFTCk7bG9nZ2Vycz17fTt9O3ZhciBMb2dnaW5nRXZlbnQ9ZnVuY3Rpb24obG9nZ2VyLHRpbWVTdGFtcCxsZXZlbCxtZXNzYWdlcyxleGNlcHRpb24pe3RoaXMubG9nZ2VyPWxvZ2dlcjt0aGlzLnRpbWVTdGFtcD10aW1lU3RhbXA7dGhpcy50aW1lU3RhbXBJbk1pbGxpc2Vjb25kcz10aW1lU3RhbXAuZ2V0VGltZSgpO3RoaXMudGltZVN0YW1wSW5TZWNvbmRzPU1hdGguZmxvb3IodGhpcy50aW1lU3RhbXBJbk1pbGxpc2Vjb25kcy8xMDAwKTt0aGlzLm1pbGxpc2Vjb25kcz10aGlzLnRpbWVTdGFtcC5nZXRNaWxsaXNlY29uZHMoKTt0aGlzLmxldmVsPWxldmVsO3RoaXMubWVzc2FnZXM9bWVzc2FnZXM7dGhpcy5leGNlcHRpb249ZXhjZXB0aW9uO307TG9nZ2luZ0V2ZW50LnByb3RvdHlwZT17Z2V0VGhyb3dhYmxlU3RyUmVwOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZXhjZXB0aW9uP2dldEV4Y2VwdGlvblN0cmluZ1JlcCh0aGlzLmV4Y2VwdGlvbik6XCJcIjt9LGdldENvbWJpbmVkTWVzc2FnZXM6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5tZXNzYWdlcy5sZW5ndGg9PTEpP3RoaXMubWVzc2FnZXNbMF06dGhpcy5tZXNzYWdlcy5qb2luKG5ld0xpbmUpO30sdG9TdHJpbmc6ZnVuY3Rpb24oKXtyZXR1cm5cIkxvZ2dpbmdFdmVudFtcIit0aGlzLmxldmVsK1wiXVwiO319O2xvZzRqYXZhc2NyaXB0LkxvZ2dpbmdFdmVudD1Mb2dnaW5nRXZlbnQ7dmFyIExheW91dD1mdW5jdGlvbigpe307TGF5b3V0LnByb3RvdHlwZT17ZGVmYXVsdHM6e2xvZ2dlcktleTpcImxvZ2dlclwiLHRpbWVTdGFtcEtleTpcInRpbWVzdGFtcFwiLG1pbGxpc2Vjb25kc0tleTpcIm1pbGxpc2Vjb25kc1wiLGxldmVsS2V5OlwibGV2ZWxcIixtZXNzYWdlS2V5OlwibWVzc2FnZVwiLGV4Y2VwdGlvbktleTpcImV4Y2VwdGlvblwiLHVybEtleTpcInVybFwifSxsb2dnZXJLZXk6XCJsb2dnZXJcIix0aW1lU3RhbXBLZXk6XCJ0aW1lc3RhbXBcIixtaWxsaXNlY29uZHNLZXk6XCJtaWxsaXNlY29uZHNcIixsZXZlbEtleTpcImxldmVsXCIsbWVzc2FnZUtleTpcIm1lc3NhZ2VcIixleGNlcHRpb25LZXk6XCJleGNlcHRpb25cIix1cmxLZXk6XCJ1cmxcIixiYXRjaEhlYWRlcjpcIlwiLGJhdGNoRm9vdGVyOlwiXCIsYmF0Y2hTZXBhcmF0b3I6XCJcIixyZXR1cm5zUG9zdERhdGE6ZmFsc2Usb3ZlcnJpZGVUaW1lU3RhbXBzU2V0dGluZzpmYWxzZSx1c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM6bnVsbCxmb3JtYXQ6ZnVuY3Rpb24oKXtoYW5kbGVFcnJvcihcIkxheW91dC5mb3JtYXQ6IGxheW91dCBzdXBwbGllZCBoYXMgbm8gZm9ybWF0KCkgbWV0aG9kXCIpO30saWdub3Jlc1Rocm93YWJsZTpmdW5jdGlvbigpe2hhbmRsZUVycm9yKFwiTGF5b3V0Lmlnbm9yZXNUaHJvd2FibGU6IGxheW91dCBzdXBwbGllZCBoYXMgbm8gaWdub3Jlc1Rocm93YWJsZSgpIG1ldGhvZFwiKTt9LGdldENvbnRlbnRUeXBlOmZ1bmN0aW9uKCl7cmV0dXJuXCJ0ZXh0L3BsYWluXCI7fSxhbGxvd0JhdGNoaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fSxzZXRUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM6ZnVuY3Rpb24odGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKXt0aGlzLm92ZXJyaWRlVGltZVN0YW1wc1NldHRpbmc9dHJ1ZTt0aGlzLnVzZVRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcz1ib29sKHRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcyk7fSxpc1RpbWVTdGFtcHNJbk1pbGxpc2Vjb25kczpmdW5jdGlvbigpe3JldHVybiB0aGlzLm92ZXJyaWRlVGltZVN0YW1wc1NldHRpbmc/dGhpcy51c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM6dXNlVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzO30sZ2V0VGltZVN0YW1wVmFsdWU6ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtyZXR1cm4gdGhpcy5pc1RpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcygpP2xvZ2dpbmdFdmVudC50aW1lU3RhbXBJbk1pbGxpc2Vjb25kczpsb2dnaW5nRXZlbnQudGltZVN0YW1wSW5TZWNvbmRzO30sZ2V0RGF0YVZhbHVlczpmdW5jdGlvbihsb2dnaW5nRXZlbnQsY29tYmluZU1lc3NhZ2VzKXt2YXIgZGF0YVZhbHVlcz1bW3RoaXMubG9nZ2VyS2V5LGxvZ2dpbmdFdmVudC5sb2dnZXIubmFtZV0sW3RoaXMudGltZVN0YW1wS2V5LHRoaXMuZ2V0VGltZVN0YW1wVmFsdWUobG9nZ2luZ0V2ZW50KV0sW3RoaXMubGV2ZWxLZXksbG9nZ2luZ0V2ZW50LmxldmVsLm5hbWVdLFt0aGlzLnVybEtleSx3aW5kb3cubG9jYXRpb24uaHJlZl0sW3RoaXMubWVzc2FnZUtleSxjb21iaW5lTWVzc2FnZXM/bG9nZ2luZ0V2ZW50LmdldENvbWJpbmVkTWVzc2FnZXMoKTpsb2dnaW5nRXZlbnQubWVzc2FnZXNdXTtpZighdGhpcy5pc1RpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcygpKXtkYXRhVmFsdWVzLnB1c2goW3RoaXMubWlsbGlzZWNvbmRzS2V5LGxvZ2dpbmdFdmVudC5taWxsaXNlY29uZHNdKTt9XHJcbmlmKGxvZ2dpbmdFdmVudC5leGNlcHRpb24pe2RhdGFWYWx1ZXMucHVzaChbdGhpcy5leGNlcHRpb25LZXksZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGxvZ2dpbmdFdmVudC5leGNlcHRpb24pXSk7fVxyXG5pZih0aGlzLmhhc0N1c3RvbUZpZWxkcygpKXtmb3IodmFyIGk9MCxsZW49dGhpcy5jdXN0b21GaWVsZHMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIHZhbD10aGlzLmN1c3RvbUZpZWxkc1tpXS52YWx1ZTtpZih0eXBlb2YgdmFsPT09XCJmdW5jdGlvblwiKXt2YWw9dmFsKHRoaXMsbG9nZ2luZ0V2ZW50KTt9XHJcbmRhdGFWYWx1ZXMucHVzaChbdGhpcy5jdXN0b21GaWVsZHNbaV0ubmFtZSx2YWxdKTt9fVxyXG5yZXR1cm4gZGF0YVZhbHVlczt9LHNldEtleXM6ZnVuY3Rpb24obG9nZ2VyS2V5LHRpbWVTdGFtcEtleSxsZXZlbEtleSxtZXNzYWdlS2V5LGV4Y2VwdGlvbktleSx1cmxLZXksbWlsbGlzZWNvbmRzS2V5KXt0aGlzLmxvZ2dlcktleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKGxvZ2dlcktleSx0aGlzLmRlZmF1bHRzLmxvZ2dlcktleSk7dGhpcy50aW1lU3RhbXBLZXk9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbSh0aW1lU3RhbXBLZXksdGhpcy5kZWZhdWx0cy50aW1lU3RhbXBLZXkpO3RoaXMubGV2ZWxLZXk9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShsZXZlbEtleSx0aGlzLmRlZmF1bHRzLmxldmVsS2V5KTt0aGlzLm1lc3NhZ2VLZXk9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShtZXNzYWdlS2V5LHRoaXMuZGVmYXVsdHMubWVzc2FnZUtleSk7dGhpcy5leGNlcHRpb25LZXk9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShleGNlcHRpb25LZXksdGhpcy5kZWZhdWx0cy5leGNlcHRpb25LZXkpO3RoaXMudXJsS2V5PWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0odXJsS2V5LHRoaXMuZGVmYXVsdHMudXJsS2V5KTt0aGlzLm1pbGxpc2Vjb25kc0tleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKG1pbGxpc2Vjb25kc0tleSx0aGlzLmRlZmF1bHRzLm1pbGxpc2Vjb25kc0tleSk7fSxzZXRDdXN0b21GaWVsZDpmdW5jdGlvbihuYW1lLHZhbHVlKXt2YXIgZmllbGRVcGRhdGVkPWZhbHNlO2Zvcih2YXIgaT0wLGxlbj10aGlzLmN1c3RvbUZpZWxkcy5sZW5ndGg7aTxsZW47aSsrKXtpZih0aGlzLmN1c3RvbUZpZWxkc1tpXS5uYW1lPT09bmFtZSl7dGhpcy5jdXN0b21GaWVsZHNbaV0udmFsdWU9dmFsdWU7ZmllbGRVcGRhdGVkPXRydWU7fX1cclxuaWYoIWZpZWxkVXBkYXRlZCl7dGhpcy5jdXN0b21GaWVsZHMucHVzaCh7XCJuYW1lXCI6bmFtZSxcInZhbHVlXCI6dmFsdWV9KTt9fSxoYXNDdXN0b21GaWVsZHM6ZnVuY3Rpb24oKXtyZXR1cm4odGhpcy5jdXN0b21GaWVsZHMubGVuZ3RoPjApO30sZm9ybWF0V2l0aEV4Y2VwdGlvbjpmdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciBmb3JtYXR0ZWQ9dGhpcy5mb3JtYXQobG9nZ2luZ0V2ZW50KTtpZihsb2dnaW5nRXZlbnQuZXhjZXB0aW9uJiZ0aGlzLmlnbm9yZXNUaHJvd2FibGUoKSl7Zm9ybWF0dGVkKz1sb2dnaW5nRXZlbnQuZ2V0VGhyb3dhYmxlU3RyUmVwKCk7fVxyXG5yZXR1cm4gZm9ybWF0dGVkO30sdG9TdHJpbmc6ZnVuY3Rpb24oKXtoYW5kbGVFcnJvcihcIkxheW91dC50b1N0cmluZzogYWxsIGxheW91dHMgbXVzdCBvdmVycmlkZSB0aGlzIG1ldGhvZFwiKTt9fTtsb2c0amF2YXNjcmlwdC5MYXlvdXQ9TGF5b3V0O3ZhciBBcHBlbmRlcj1mdW5jdGlvbigpe307QXBwZW5kZXIucHJvdG90eXBlPW5ldyBFdmVudFN1cHBvcnQoKTtBcHBlbmRlci5wcm90b3R5cGUubGF5b3V0PW5ldyBQYXR0ZXJuTGF5b3V0KCk7QXBwZW5kZXIucHJvdG90eXBlLnRocmVzaG9sZD1MZXZlbC5BTEw7QXBwZW5kZXIucHJvdG90eXBlLmxvZ2dlcnM9W107QXBwZW5kZXIucHJvdG90eXBlLmRvQXBwZW5kPWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7aWYoZW5hYmxlZCYmbG9nZ2luZ0V2ZW50LmxldmVsLmxldmVsPj10aGlzLnRocmVzaG9sZC5sZXZlbCl7dGhpcy5hcHBlbmQobG9nZ2luZ0V2ZW50KTt9fTtBcHBlbmRlci5wcm90b3R5cGUuYXBwZW5kPWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7fTtBcHBlbmRlci5wcm90b3R5cGUuc2V0TGF5b3V0PWZ1bmN0aW9uKGxheW91dCl7aWYobGF5b3V0IGluc3RhbmNlb2YgTGF5b3V0KXt0aGlzLmxheW91dD1sYXlvdXQ7fWVsc2V7aGFuZGxlRXJyb3IoXCJBcHBlbmRlci5zZXRMYXlvdXQ6IGxheW91dCBzdXBwbGllZCB0byBcIitcclxudGhpcy50b1N0cmluZygpK1wiIGlzIG5vdCBhIHN1YmNsYXNzIG9mIExheW91dFwiKTt9fTtBcHBlbmRlci5wcm90b3R5cGUuZ2V0TGF5b3V0PWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubGF5b3V0O307QXBwZW5kZXIucHJvdG90eXBlLnNldFRocmVzaG9sZD1mdW5jdGlvbih0aHJlc2hvbGQpe2lmKHRocmVzaG9sZCBpbnN0YW5jZW9mIExldmVsKXt0aGlzLnRocmVzaG9sZD10aHJlc2hvbGQ7fWVsc2V7aGFuZGxlRXJyb3IoXCJBcHBlbmRlci5zZXRUaHJlc2hvbGQ6IHRocmVzaG9sZCBzdXBwbGllZCB0byBcIitcclxudGhpcy50b1N0cmluZygpK1wiIGlzIG5vdCBhIHN1YmNsYXNzIG9mIExldmVsXCIpO319O0FwcGVuZGVyLnByb3RvdHlwZS5nZXRUaHJlc2hvbGQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy50aHJlc2hvbGQ7fTtBcHBlbmRlci5wcm90b3R5cGUuc2V0QWRkZWRUb0xvZ2dlcj1mdW5jdGlvbihsb2dnZXIpe3RoaXMubG9nZ2Vycy5wdXNoKGxvZ2dlcik7fTtBcHBlbmRlci5wcm90b3R5cGUuc2V0UmVtb3ZlZEZyb21Mb2dnZXI9ZnVuY3Rpb24obG9nZ2VyKXthcnJheV9yZW1vdmUodGhpcy5sb2dnZXJzLGxvZ2dlcik7fTtBcHBlbmRlci5wcm90b3R5cGUuZ3JvdXA9ZW1wdHlGdW5jdGlvbjtBcHBlbmRlci5wcm90b3R5cGUuZ3JvdXBFbmQ9ZW1wdHlGdW5jdGlvbjtBcHBlbmRlci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtoYW5kbGVFcnJvcihcIkFwcGVuZGVyLnRvU3RyaW5nOiBhbGwgYXBwZW5kZXJzIG11c3Qgb3ZlcnJpZGUgdGhpcyBtZXRob2RcIik7fTtsb2c0amF2YXNjcmlwdC5BcHBlbmRlcj1BcHBlbmRlcjtmdW5jdGlvbiBTaW1wbGVMYXlvdXQoKXt0aGlzLmN1c3RvbUZpZWxkcz1bXTt9XHJcblNpbXBsZUxheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO1NpbXBsZUxheW91dC5wcm90b3R5cGUuZm9ybWF0PWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7cmV0dXJuIGxvZ2dpbmdFdmVudC5sZXZlbC5uYW1lK1wiIC0gXCIrbG9nZ2luZ0V2ZW50LmdldENvbWJpbmVkTWVzc2FnZXMoKTt9O1NpbXBsZUxheW91dC5wcm90b3R5cGUuaWdub3Jlc1Rocm93YWJsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307U2ltcGxlTGF5b3V0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiU2ltcGxlTGF5b3V0XCI7fTtsb2c0amF2YXNjcmlwdC5TaW1wbGVMYXlvdXQ9U2ltcGxlTGF5b3V0O2Z1bmN0aW9uIE51bGxMYXlvdXQoKXt0aGlzLmN1c3RvbUZpZWxkcz1bXTt9XHJcbk51bGxMYXlvdXQucHJvdG90eXBlPW5ldyBMYXlvdXQoKTtOdWxsTGF5b3V0LnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtyZXR1cm4gbG9nZ2luZ0V2ZW50Lm1lc3NhZ2VzO307TnVsbExheW91dC5wcm90b3R5cGUuaWdub3Jlc1Rocm93YWJsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307TnVsbExheW91dC5wcm90b3R5cGUuZm9ybWF0V2l0aEV4Y2VwdGlvbj1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciBtZXNzYWdlcz1sb2dnaW5nRXZlbnQubWVzc2FnZXMsZXg9bG9nZ2luZ0V2ZW50LmV4Y2VwdGlvbjtyZXR1cm4gZXg/bWVzc2FnZXMuY29uY2F0KFtleF0pOm1lc3NhZ2VzO307TnVsbExheW91dC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIk51bGxMYXlvdXRcIjt9O2xvZzRqYXZhc2NyaXB0Lk51bGxMYXlvdXQ9TnVsbExheW91dDtmdW5jdGlvbiBYbWxMYXlvdXQoY29tYmluZU1lc3NhZ2VzKXt0aGlzLmNvbWJpbmVNZXNzYWdlcz1leHRyYWN0Qm9vbGVhbkZyb21QYXJhbShjb21iaW5lTWVzc2FnZXMsdHJ1ZSk7dGhpcy5jdXN0b21GaWVsZHM9W107fVxyXG5YbWxMYXlvdXQucHJvdG90eXBlPW5ldyBMYXlvdXQoKTtYbWxMYXlvdXQucHJvdG90eXBlLmlzQ29tYmluZWRNZXNzYWdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbWJpbmVNZXNzYWdlczt9O1htbExheW91dC5wcm90b3R5cGUuZ2V0Q29udGVudFR5cGU9ZnVuY3Rpb24oKXtyZXR1cm5cInRleHQveG1sXCI7fTtYbWxMYXlvdXQucHJvdG90eXBlLmVzY2FwZUNkYXRhPWZ1bmN0aW9uKHN0cil7cmV0dXJuIHN0ci5yZXBsYWNlKC9cXF1cXF0+LyxcIl1dPl1dJmd0OzwhW0NEQVRBW1wiKTt9O1htbExheW91dC5wcm90b3R5cGUuZm9ybWF0PWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIGxheW91dD10aGlzO3ZhciBpLGxlbjtmdW5jdGlvbiBmb3JtYXRNZXNzYWdlKG1lc3NhZ2Upe21lc3NhZ2U9KHR5cGVvZiBtZXNzYWdlPT09XCJzdHJpbmdcIik/bWVzc2FnZTp0b1N0cihtZXNzYWdlKTtyZXR1cm5cIjxsb2c0amF2YXNjcmlwdDptZXNzYWdlPjwhW0NEQVRBW1wiK1xyXG5sYXlvdXQuZXNjYXBlQ2RhdGEobWVzc2FnZSkrXCJdXT48L2xvZzRqYXZhc2NyaXB0Om1lc3NhZ2U+XCI7fVxyXG52YXIgc3RyPVwiPGxvZzRqYXZhc2NyaXB0OmV2ZW50IGxvZ2dlcj1cXFwiXCIrbG9nZ2luZ0V2ZW50LmxvZ2dlci5uYW1lK1wiXFxcIiB0aW1lc3RhbXA9XFxcIlwiK3RoaXMuZ2V0VGltZVN0YW1wVmFsdWUobG9nZ2luZ0V2ZW50KStcIlxcXCJcIjtpZighdGhpcy5pc1RpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcygpKXtzdHIrPVwiIG1pbGxpc2Vjb25kcz1cXFwiXCIrbG9nZ2luZ0V2ZW50Lm1pbGxpc2Vjb25kcytcIlxcXCJcIjt9XHJcbnN0cis9XCIgbGV2ZWw9XFxcIlwiK2xvZ2dpbmdFdmVudC5sZXZlbC5uYW1lK1wiXFxcIj5cIituZXdMaW5lO2lmKHRoaXMuY29tYmluZU1lc3NhZ2VzKXtzdHIrPWZvcm1hdE1lc3NhZ2UobG9nZ2luZ0V2ZW50LmdldENvbWJpbmVkTWVzc2FnZXMoKSk7fWVsc2V7c3RyKz1cIjxsb2c0amF2YXNjcmlwdDptZXNzYWdlcz5cIituZXdMaW5lO2ZvcihpPTAsbGVuPWxvZ2dpbmdFdmVudC5tZXNzYWdlcy5sZW5ndGg7aTxsZW47aSsrKXtzdHIrPWZvcm1hdE1lc3NhZ2UobG9nZ2luZ0V2ZW50Lm1lc3NhZ2VzW2ldKStuZXdMaW5lO31cclxuc3RyKz1cIjwvbG9nNGphdmFzY3JpcHQ6bWVzc2FnZXM+XCIrbmV3TGluZTt9XHJcbmlmKHRoaXMuaGFzQ3VzdG9tRmllbGRzKCkpe2ZvcihpPTAsbGVuPXRoaXMuY3VzdG9tRmllbGRzLmxlbmd0aDtpPGxlbjtpKyspe3N0cis9XCI8bG9nNGphdmFzY3JpcHQ6Y3VzdG9tZmllbGQgbmFtZT1cXFwiXCIrXHJcbnRoaXMuY3VzdG9tRmllbGRzW2ldLm5hbWUrXCJcXFwiPjwhW0NEQVRBW1wiK1xyXG50aGlzLmN1c3RvbUZpZWxkc1tpXS52YWx1ZS50b1N0cmluZygpK1wiXV0+PC9sb2c0amF2YXNjcmlwdDpjdXN0b21maWVsZD5cIituZXdMaW5lO319XHJcbmlmKGxvZ2dpbmdFdmVudC5leGNlcHRpb24pe3N0cis9XCI8bG9nNGphdmFzY3JpcHQ6ZXhjZXB0aW9uPjwhW0NEQVRBW1wiK1xyXG5nZXRFeGNlcHRpb25TdHJpbmdSZXAobG9nZ2luZ0V2ZW50LmV4Y2VwdGlvbikrXCJdXT48L2xvZzRqYXZhc2NyaXB0OmV4Y2VwdGlvbj5cIituZXdMaW5lO31cclxuc3RyKz1cIjwvbG9nNGphdmFzY3JpcHQ6ZXZlbnQ+XCIrbmV3TGluZStuZXdMaW5lO3JldHVybiBzdHI7fTtYbWxMYXlvdXQucHJvdG90eXBlLmlnbm9yZXNUaHJvd2FibGU9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtYbWxMYXlvdXQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJYbWxMYXlvdXRcIjt9O2xvZzRqYXZhc2NyaXB0LlhtbExheW91dD1YbWxMYXlvdXQ7ZnVuY3Rpb24gZXNjYXBlTmV3TGluZXMoc3RyKXtyZXR1cm4gc3RyLnJlcGxhY2UoL1xcclxcbnxcXHJ8XFxuL2csXCJcXFxcclxcXFxuXCIpO31cclxuZnVuY3Rpb24gSnNvbkxheW91dChyZWFkYWJsZSxjb21iaW5lTWVzc2FnZXMpe3RoaXMucmVhZGFibGU9ZXh0cmFjdEJvb2xlYW5Gcm9tUGFyYW0ocmVhZGFibGUsZmFsc2UpO3RoaXMuY29tYmluZU1lc3NhZ2VzPWV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKGNvbWJpbmVNZXNzYWdlcyx0cnVlKTt0aGlzLmJhdGNoSGVhZGVyPXRoaXMucmVhZGFibGU/XCJbXCIrbmV3TGluZTpcIltcIjt0aGlzLmJhdGNoRm9vdGVyPXRoaXMucmVhZGFibGU/XCJdXCIrbmV3TGluZTpcIl1cIjt0aGlzLmJhdGNoU2VwYXJhdG9yPXRoaXMucmVhZGFibGU/XCIsXCIrbmV3TGluZTpcIixcIjt0aGlzLnNldEtleXMoKTt0aGlzLmNvbG9uPXRoaXMucmVhZGFibGU/XCI6IFwiOlwiOlwiO3RoaXMudGFiPXRoaXMucmVhZGFibGU/XCJcXHRcIjpcIlwiO3RoaXMubGluZUJyZWFrPXRoaXMucmVhZGFibGU/bmV3TGluZTpcIlwiO3RoaXMuY3VzdG9tRmllbGRzPVtdO31cclxuSnNvbkxheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO0pzb25MYXlvdXQucHJvdG90eXBlLmlzUmVhZGFibGU9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5yZWFkYWJsZTt9O0pzb25MYXlvdXQucHJvdG90eXBlLmlzQ29tYmluZWRNZXNzYWdlcz1mdW5jdGlvbigpe3JldHVybiB0aGlzLmNvbWJpbmVNZXNzYWdlczt9O0pzb25MYXlvdXQucHJvdG90eXBlLmZvcm1hdD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciBsYXlvdXQ9dGhpczt2YXIgZGF0YVZhbHVlcz10aGlzLmdldERhdGFWYWx1ZXMobG9nZ2luZ0V2ZW50LHRoaXMuY29tYmluZU1lc3NhZ2VzKTt2YXIgc3RyPVwie1wiK3RoaXMubGluZUJyZWFrO3ZhciBpLGxlbjtmdW5jdGlvbiBmb3JtYXRWYWx1ZSh2YWwscHJlZml4LGV4cGFuZCl7dmFyIGZvcm1hdHRlZFZhbHVlO3ZhciB2YWxUeXBlPXR5cGVvZiB2YWw7aWYodmFsIGluc3RhbmNlb2YgRGF0ZSl7Zm9ybWF0dGVkVmFsdWU9U3RyaW5nKHZhbC5nZXRUaW1lKCkpO31lbHNlIGlmKGV4cGFuZCYmKHZhbCBpbnN0YW5jZW9mIEFycmF5KSl7Zm9ybWF0dGVkVmFsdWU9XCJbXCIrbGF5b3V0LmxpbmVCcmVhaztmb3IodmFyIGk9MCxsZW49dmFsLmxlbmd0aDtpPGxlbjtpKyspe3ZhciBjaGlsZFByZWZpeD1wcmVmaXgrbGF5b3V0LnRhYjtmb3JtYXR0ZWRWYWx1ZSs9Y2hpbGRQcmVmaXgrZm9ybWF0VmFsdWUodmFsW2ldLGNoaWxkUHJlZml4LGZhbHNlKTtpZihpPHZhbC5sZW5ndGgtMSl7Zm9ybWF0dGVkVmFsdWUrPVwiLFwiO31cclxuZm9ybWF0dGVkVmFsdWUrPWxheW91dC5saW5lQnJlYWs7fVxyXG5mb3JtYXR0ZWRWYWx1ZSs9cHJlZml4K1wiXVwiO31lbHNlIGlmKHZhbFR5cGUhPT1cIm51bWJlclwiJiZ2YWxUeXBlIT09XCJib29sZWFuXCIpe2Zvcm1hdHRlZFZhbHVlPVwiXFxcIlwiK2VzY2FwZU5ld0xpbmVzKHRvU3RyKHZhbCkucmVwbGFjZSgvXFxcIi9nLFwiXFxcXFxcXCJcIikpK1wiXFxcIlwiO31lbHNle2Zvcm1hdHRlZFZhbHVlPXZhbDt9XHJcbnJldHVybiBmb3JtYXR0ZWRWYWx1ZTt9XHJcbmZvcihpPTAsbGVuPWRhdGFWYWx1ZXMubGVuZ3RoLTE7aTw9bGVuO2krKyl7c3RyKz10aGlzLnRhYitcIlxcXCJcIitkYXRhVmFsdWVzW2ldWzBdK1wiXFxcIlwiK3RoaXMuY29sb24rZm9ybWF0VmFsdWUoZGF0YVZhbHVlc1tpXVsxXSx0aGlzLnRhYix0cnVlKTtpZihpPGxlbil7c3RyKz1cIixcIjt9XHJcbnN0cis9dGhpcy5saW5lQnJlYWs7fVxyXG5zdHIrPVwifVwiK3RoaXMubGluZUJyZWFrO3JldHVybiBzdHI7fTtKc29uTGF5b3V0LnByb3RvdHlwZS5pZ25vcmVzVGhyb3dhYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307SnNvbkxheW91dC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkpzb25MYXlvdXRcIjt9O0pzb25MYXlvdXQucHJvdG90eXBlLmdldENvbnRlbnRUeXBlPWZ1bmN0aW9uKCl7cmV0dXJuXCJhcHBsaWNhdGlvbi9qc29uXCI7fTtsb2c0amF2YXNjcmlwdC5Kc29uTGF5b3V0PUpzb25MYXlvdXQ7ZnVuY3Rpb24gSHR0cFBvc3REYXRhTGF5b3V0KCl7dGhpcy5zZXRLZXlzKCk7dGhpcy5jdXN0b21GaWVsZHM9W107dGhpcy5yZXR1cm5zUG9zdERhdGE9dHJ1ZTt9XHJcbkh0dHBQb3N0RGF0YUxheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO0h0dHBQb3N0RGF0YUxheW91dC5wcm90b3R5cGUuYWxsb3dCYXRjaGluZz1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O0h0dHBQb3N0RGF0YUxheW91dC5wcm90b3R5cGUuZm9ybWF0PWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIGRhdGFWYWx1ZXM9dGhpcy5nZXREYXRhVmFsdWVzKGxvZ2dpbmdFdmVudCk7dmFyIHF1ZXJ5Qml0cz1bXTtmb3IodmFyIGk9MCxsZW49ZGF0YVZhbHVlcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgdmFsPShkYXRhVmFsdWVzW2ldWzFdaW5zdGFuY2VvZiBEYXRlKT9TdHJpbmcoZGF0YVZhbHVlc1tpXVsxXS5nZXRUaW1lKCkpOmRhdGFWYWx1ZXNbaV1bMV07cXVlcnlCaXRzLnB1c2godXJsRW5jb2RlKGRhdGFWYWx1ZXNbaV1bMF0pK1wiPVwiK3VybEVuY29kZSh2YWwpKTt9XHJcbnJldHVybiBxdWVyeUJpdHMuam9pbihcIiZcIik7fTtIdHRwUG9zdERhdGFMYXlvdXQucHJvdG90eXBlLmlnbm9yZXNUaHJvd2FibGU9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtyZXR1cm4gZmFsc2U7fTtIdHRwUG9zdERhdGFMYXlvdXQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJIdHRwUG9zdERhdGFMYXlvdXRcIjt9O2xvZzRqYXZhc2NyaXB0Lkh0dHBQb3N0RGF0YUxheW91dD1IdHRwUG9zdERhdGFMYXlvdXQ7ZnVuY3Rpb24gZm9ybWF0T2JqZWN0RXhwYW5zaW9uKG9iaixkZXB0aCxpbmRlbnRhdGlvbil7dmFyIG9iamVjdHNFeHBhbmRlZD1bXTtmdW5jdGlvbiBkb0Zvcm1hdChvYmosZGVwdGgsaW5kZW50YXRpb24pe3ZhciBpLGxlbixjaGlsZERlcHRoLGNoaWxkSW5kZW50YXRpb24sY2hpbGRMaW5lcyxleHBhbnNpb24sY2hpbGRFeHBhbnNpb247aWYoIWluZGVudGF0aW9uKXtpbmRlbnRhdGlvbj1cIlwiO31cclxuZnVuY3Rpb24gZm9ybWF0U3RyaW5nKHRleHQpe3ZhciBsaW5lcz1zcGxpdEludG9MaW5lcyh0ZXh0KTtmb3IodmFyIGo9MSxqTGVuPWxpbmVzLmxlbmd0aDtqPGpMZW47aisrKXtsaW5lc1tqXT1pbmRlbnRhdGlvbitsaW5lc1tqXTt9XHJcbnJldHVybiBsaW5lcy5qb2luKG5ld0xpbmUpO31cclxuaWYob2JqPT09bnVsbCl7cmV0dXJuXCJudWxsXCI7fWVsc2UgaWYodHlwZW9mIG9iaj09XCJ1bmRlZmluZWRcIil7cmV0dXJuXCJ1bmRlZmluZWRcIjt9ZWxzZSBpZih0eXBlb2Ygb2JqPT1cInN0cmluZ1wiKXtyZXR1cm4gZm9ybWF0U3RyaW5nKG9iaik7fWVsc2UgaWYodHlwZW9mIG9iaj09XCJvYmplY3RcIiYmYXJyYXlfY29udGFpbnMob2JqZWN0c0V4cGFuZGVkLG9iaikpe3RyeXtleHBhbnNpb249dG9TdHIob2JqKTt9Y2F0Y2goZXgpe2V4cGFuc2lvbj1cIkVycm9yIGZvcm1hdHRpbmcgcHJvcGVydHkuIERldGFpbHM6IFwiK2dldEV4Y2VwdGlvblN0cmluZ1JlcChleCk7fVxyXG5yZXR1cm4gZXhwYW5zaW9uK1wiIFthbHJlYWR5IGV4cGFuZGVkXVwiO31lbHNlIGlmKChvYmogaW5zdGFuY2VvZiBBcnJheSkmJmRlcHRoPjApe29iamVjdHNFeHBhbmRlZC5wdXNoKG9iaik7ZXhwYW5zaW9uPVwiW1wiK25ld0xpbmU7Y2hpbGREZXB0aD1kZXB0aC0xO2NoaWxkSW5kZW50YXRpb249aW5kZW50YXRpb24rXCIgIFwiO2NoaWxkTGluZXM9W107Zm9yKGk9MCxsZW49b2JqLmxlbmd0aDtpPGxlbjtpKyspe3RyeXtjaGlsZEV4cGFuc2lvbj1kb0Zvcm1hdChvYmpbaV0sY2hpbGREZXB0aCxjaGlsZEluZGVudGF0aW9uKTtjaGlsZExpbmVzLnB1c2goY2hpbGRJbmRlbnRhdGlvbitjaGlsZEV4cGFuc2lvbik7fWNhdGNoKGV4KXtjaGlsZExpbmVzLnB1c2goY2hpbGRJbmRlbnRhdGlvbitcIkVycm9yIGZvcm1hdHRpbmcgYXJyYXkgbWVtYmVyLiBEZXRhaWxzOiBcIitcclxuZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4KStcIlwiKTt9fVxyXG5leHBhbnNpb24rPWNoaWxkTGluZXMuam9pbihcIixcIituZXdMaW5lKStuZXdMaW5lK2luZGVudGF0aW9uK1wiXVwiO3JldHVybiBleHBhbnNpb247fWVsc2UgaWYoT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG9iaik9PVwiW29iamVjdCBEYXRlXVwiKXtyZXR1cm4gb2JqLnRvU3RyaW5nKCk7fWVsc2UgaWYodHlwZW9mIG9iaj09XCJvYmplY3RcIiYmZGVwdGg+MCl7b2JqZWN0c0V4cGFuZGVkLnB1c2gob2JqKTtleHBhbnNpb249XCJ7XCIrbmV3TGluZTtjaGlsZERlcHRoPWRlcHRoLTE7Y2hpbGRJbmRlbnRhdGlvbj1pbmRlbnRhdGlvbitcIiAgXCI7Y2hpbGRMaW5lcz1bXTtmb3IoaSBpbiBvYmope3RyeXtjaGlsZEV4cGFuc2lvbj1kb0Zvcm1hdChvYmpbaV0sY2hpbGREZXB0aCxjaGlsZEluZGVudGF0aW9uKTtjaGlsZExpbmVzLnB1c2goY2hpbGRJbmRlbnRhdGlvbitpK1wiOiBcIitjaGlsZEV4cGFuc2lvbik7fWNhdGNoKGV4KXtjaGlsZExpbmVzLnB1c2goY2hpbGRJbmRlbnRhdGlvbitpK1wiOiBFcnJvciBmb3JtYXR0aW5nIHByb3BlcnR5LiBEZXRhaWxzOiBcIitcclxuZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4KSk7fX1cclxuZXhwYW5zaW9uKz1jaGlsZExpbmVzLmpvaW4oXCIsXCIrbmV3TGluZSkrbmV3TGluZStpbmRlbnRhdGlvbitcIn1cIjtyZXR1cm4gZXhwYW5zaW9uO31lbHNle3JldHVybiBmb3JtYXRTdHJpbmcodG9TdHIob2JqKSk7fX1cclxucmV0dXJuIGRvRm9ybWF0KG9iaixkZXB0aCxpbmRlbnRhdGlvbik7fVxyXG52YXIgU2ltcGxlRGF0ZUZvcm1hdDsoZnVuY3Rpb24oKXt2YXIgcmVnZXg9LygnW14nXSonKXwoRyt8eSt8TSt8dyt8Vyt8RCt8ZCt8Rit8RSt8YSt8SCt8ayt8Syt8aCt8bSt8cyt8Uyt8WispfChbYS16QS1aXSspfChbXmEtekEtWiddKykvO3ZhciBtb250aE5hbWVzPVtcIkphbnVhcnlcIixcIkZlYnJ1YXJ5XCIsXCJNYXJjaFwiLFwiQXByaWxcIixcIk1heVwiLFwiSnVuZVwiLFwiSnVseVwiLFwiQXVndXN0XCIsXCJTZXB0ZW1iZXJcIixcIk9jdG9iZXJcIixcIk5vdmVtYmVyXCIsXCJEZWNlbWJlclwiXTt2YXIgZGF5TmFtZXM9W1wiU3VuZGF5XCIsXCJNb25kYXlcIixcIlR1ZXNkYXlcIixcIldlZG5lc2RheVwiLFwiVGh1cnNkYXlcIixcIkZyaWRheVwiLFwiU2F0dXJkYXlcIl07dmFyIFRFWFQyPTAsVEVYVDM9MSxOVU1CRVI9MixZRUFSPTMsTU9OVEg9NCxUSU1FWk9ORT01O3ZhciB0eXBlcz17RzpURVhUMix5OllFQVIsTTpNT05USCx3Ok5VTUJFUixXOk5VTUJFUixEOk5VTUJFUixkOk5VTUJFUixGOk5VTUJFUixFOlRFWFQzLGE6VEVYVDIsSDpOVU1CRVIsazpOVU1CRVIsSzpOVU1CRVIsaDpOVU1CRVIsbTpOVU1CRVIsczpOVU1CRVIsUzpOVU1CRVIsWjpUSU1FWk9ORX07dmFyIE9ORV9EQVk9MjQqNjAqNjAqMTAwMDt2YXIgT05FX1dFRUs9NypPTkVfREFZO3ZhciBERUZBVUxUX01JTklNQUxfREFZU19JTl9GSVJTVF9XRUVLPTE7dmFyIG5ld0RhdGVBdE1pZG5pZ2h0PWZ1bmN0aW9uKHllYXIsbW9udGgsZGF5KXt2YXIgZD1uZXcgRGF0ZSh5ZWFyLG1vbnRoLGRheSwwLDAsMCk7ZC5zZXRNaWxsaXNlY29uZHMoMCk7cmV0dXJuIGQ7fTtEYXRlLnByb3RvdHlwZS5nZXREaWZmZXJlbmNlPWZ1bmN0aW9uKGRhdGUpe3JldHVybiB0aGlzLmdldFRpbWUoKS1kYXRlLmdldFRpbWUoKTt9O0RhdGUucHJvdG90eXBlLmlzQmVmb3JlPWZ1bmN0aW9uKGQpe3JldHVybiB0aGlzLmdldFRpbWUoKTxkLmdldFRpbWUoKTt9O0RhdGUucHJvdG90eXBlLmdldFVUQ1RpbWU9ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5VVEModGhpcy5nZXRGdWxsWWVhcigpLHRoaXMuZ2V0TW9udGgoKSx0aGlzLmdldERhdGUoKSx0aGlzLmdldEhvdXJzKCksdGhpcy5nZXRNaW51dGVzKCksdGhpcy5nZXRTZWNvbmRzKCksdGhpcy5nZXRNaWxsaXNlY29uZHMoKSk7fTtEYXRlLnByb3RvdHlwZS5nZXRUaW1lU2luY2U9ZnVuY3Rpb24oZCl7cmV0dXJuIHRoaXMuZ2V0VVRDVGltZSgpLWQuZ2V0VVRDVGltZSgpO307RGF0ZS5wcm90b3R5cGUuZ2V0UHJldmlvdXNTdW5kYXk9ZnVuY3Rpb24oKXt2YXIgbWlkZGF5PW5ldyBEYXRlKHRoaXMuZ2V0RnVsbFllYXIoKSx0aGlzLmdldE1vbnRoKCksdGhpcy5nZXREYXRlKCksMTIsMCwwKTt2YXIgcHJldmlvdXNTdW5kYXk9bmV3IERhdGUobWlkZGF5LmdldFRpbWUoKS10aGlzLmdldERheSgpKk9ORV9EQVkpO3JldHVybiBuZXdEYXRlQXRNaWRuaWdodChwcmV2aW91c1N1bmRheS5nZXRGdWxsWWVhcigpLHByZXZpb3VzU3VuZGF5LmdldE1vbnRoKCkscHJldmlvdXNTdW5kYXkuZ2V0RGF0ZSgpKTt9O0RhdGUucHJvdG90eXBlLmdldFdlZWtJblllYXI9ZnVuY3Rpb24obWluaW1hbERheXNJbkZpcnN0V2Vlayl7aWYoaXNVbmRlZmluZWQodGhpcy5taW5pbWFsRGF5c0luRmlyc3RXZWVrKSl7bWluaW1hbERheXNJbkZpcnN0V2Vlaz1ERUZBVUxUX01JTklNQUxfREFZU19JTl9GSVJTVF9XRUVLO31cclxudmFyIHByZXZpb3VzU3VuZGF5PXRoaXMuZ2V0UHJldmlvdXNTdW5kYXkoKTt2YXIgc3RhcnRPZlllYXI9bmV3RGF0ZUF0TWlkbmlnaHQodGhpcy5nZXRGdWxsWWVhcigpLDAsMSk7dmFyIG51bWJlck9mU3VuZGF5cz1wcmV2aW91c1N1bmRheS5pc0JlZm9yZShzdGFydE9mWWVhcik/MDoxK01hdGguZmxvb3IocHJldmlvdXNTdW5kYXkuZ2V0VGltZVNpbmNlKHN0YXJ0T2ZZZWFyKS9PTkVfV0VFSyk7dmFyIG51bWJlck9mRGF5c0luRmlyc3RXZWVrPTctc3RhcnRPZlllYXIuZ2V0RGF5KCk7dmFyIHdlZWtJblllYXI9bnVtYmVyT2ZTdW5kYXlzO2lmKG51bWJlck9mRGF5c0luRmlyc3RXZWVrPG1pbmltYWxEYXlzSW5GaXJzdFdlZWspe3dlZWtJblllYXItLTt9XHJcbnJldHVybiB3ZWVrSW5ZZWFyO307RGF0ZS5wcm90b3R5cGUuZ2V0V2Vla0luTW9udGg9ZnVuY3Rpb24obWluaW1hbERheXNJbkZpcnN0V2Vlayl7aWYoaXNVbmRlZmluZWQodGhpcy5taW5pbWFsRGF5c0luRmlyc3RXZWVrKSl7bWluaW1hbERheXNJbkZpcnN0V2Vlaz1ERUZBVUxUX01JTklNQUxfREFZU19JTl9GSVJTVF9XRUVLO31cclxudmFyIHByZXZpb3VzU3VuZGF5PXRoaXMuZ2V0UHJldmlvdXNTdW5kYXkoKTt2YXIgc3RhcnRPZk1vbnRoPW5ld0RhdGVBdE1pZG5pZ2h0KHRoaXMuZ2V0RnVsbFllYXIoKSx0aGlzLmdldE1vbnRoKCksMSk7dmFyIG51bWJlck9mU3VuZGF5cz1wcmV2aW91c1N1bmRheS5pc0JlZm9yZShzdGFydE9mTW9udGgpPzA6MStNYXRoLmZsb29yKHByZXZpb3VzU3VuZGF5LmdldFRpbWVTaW5jZShzdGFydE9mTW9udGgpL09ORV9XRUVLKTt2YXIgbnVtYmVyT2ZEYXlzSW5GaXJzdFdlZWs9Ny1zdGFydE9mTW9udGguZ2V0RGF5KCk7dmFyIHdlZWtJbk1vbnRoPW51bWJlck9mU3VuZGF5cztpZihudW1iZXJPZkRheXNJbkZpcnN0V2Vlaz49bWluaW1hbERheXNJbkZpcnN0V2Vlayl7d2Vla0luTW9udGgrKzt9XHJcbnJldHVybiB3ZWVrSW5Nb250aDt9O0RhdGUucHJvdG90eXBlLmdldERheUluWWVhcj1mdW5jdGlvbigpe3ZhciBzdGFydE9mWWVhcj1uZXdEYXRlQXRNaWRuaWdodCh0aGlzLmdldEZ1bGxZZWFyKCksMCwxKTtyZXR1cm4gMStNYXRoLmZsb29yKHRoaXMuZ2V0VGltZVNpbmNlKHN0YXJ0T2ZZZWFyKS9PTkVfREFZKTt9O1NpbXBsZURhdGVGb3JtYXQ9ZnVuY3Rpb24oZm9ybWF0U3RyaW5nKXt0aGlzLmZvcm1hdFN0cmluZz1mb3JtYXRTdHJpbmc7fTtTaW1wbGVEYXRlRm9ybWF0LnByb3RvdHlwZS5zZXRNaW5pbWFsRGF5c0luRmlyc3RXZWVrPWZ1bmN0aW9uKGRheXMpe3RoaXMubWluaW1hbERheXNJbkZpcnN0V2Vlaz1kYXlzO307U2ltcGxlRGF0ZUZvcm1hdC5wcm90b3R5cGUuZ2V0TWluaW1hbERheXNJbkZpcnN0V2Vlaz1mdW5jdGlvbigpe3JldHVybiBpc1VuZGVmaW5lZCh0aGlzLm1pbmltYWxEYXlzSW5GaXJzdFdlZWspP0RFRkFVTFRfTUlOSU1BTF9EQVlTX0lOX0ZJUlNUX1dFRUs6dGhpcy5taW5pbWFsRGF5c0luRmlyc3RXZWVrO307dmFyIHBhZFdpdGhaZXJvZXM9ZnVuY3Rpb24oc3RyLGxlbil7d2hpbGUoc3RyLmxlbmd0aDxsZW4pe3N0cj1cIjBcIitzdHI7fVxyXG5yZXR1cm4gc3RyO307dmFyIGZvcm1hdFRleHQ9ZnVuY3Rpb24oZGF0YSxudW1iZXJPZkxldHRlcnMsbWluTGVuZ3RoKXtyZXR1cm4obnVtYmVyT2ZMZXR0ZXJzPj00KT9kYXRhOmRhdGEuc3Vic3RyKDAsTWF0aC5tYXgobWluTGVuZ3RoLG51bWJlck9mTGV0dGVycykpO307dmFyIGZvcm1hdE51bWJlcj1mdW5jdGlvbihkYXRhLG51bWJlck9mTGV0dGVycyl7dmFyIGRhdGFTdHJpbmc9XCJcIitkYXRhO3JldHVybiBwYWRXaXRoWmVyb2VzKGRhdGFTdHJpbmcsbnVtYmVyT2ZMZXR0ZXJzKTt9O1NpbXBsZURhdGVGb3JtYXQucHJvdG90eXBlLmZvcm1hdD1mdW5jdGlvbihkYXRlKXt2YXIgZm9ybWF0dGVkU3RyaW5nPVwiXCI7dmFyIHJlc3VsdDt2YXIgc2VhcmNoU3RyaW5nPXRoaXMuZm9ybWF0U3RyaW5nO3doaWxlKChyZXN1bHQ9cmVnZXguZXhlYyhzZWFyY2hTdHJpbmcpKSl7dmFyIHF1b3RlZFN0cmluZz1yZXN1bHRbMV07dmFyIHBhdHRlcm5MZXR0ZXJzPXJlc3VsdFsyXTt2YXIgb3RoZXJMZXR0ZXJzPXJlc3VsdFszXTt2YXIgb3RoZXJDaGFyYWN0ZXJzPXJlc3VsdFs0XTtpZihxdW90ZWRTdHJpbmcpe2lmKHF1b3RlZFN0cmluZz09XCInJ1wiKXtmb3JtYXR0ZWRTdHJpbmcrPVwiJ1wiO31lbHNle2Zvcm1hdHRlZFN0cmluZys9cXVvdGVkU3RyaW5nLnN1YnN0cmluZygxLHF1b3RlZFN0cmluZy5sZW5ndGgtMSk7fX1lbHNlIGlmKG90aGVyTGV0dGVycyl7fWVsc2UgaWYob3RoZXJDaGFyYWN0ZXJzKXtmb3JtYXR0ZWRTdHJpbmcrPW90aGVyQ2hhcmFjdGVyczt9ZWxzZSBpZihwYXR0ZXJuTGV0dGVycyl7dmFyIHBhdHRlcm5MZXR0ZXI9cGF0dGVybkxldHRlcnMuY2hhckF0KDApO3ZhciBudW1iZXJPZkxldHRlcnM9cGF0dGVybkxldHRlcnMubGVuZ3RoO3ZhciByYXdEYXRhPVwiXCI7c3dpdGNoKHBhdHRlcm5MZXR0ZXIpe2Nhc2VcIkdcIjpyYXdEYXRhPVwiQURcIjticmVhaztjYXNlXCJ5XCI6cmF3RGF0YT1kYXRlLmdldEZ1bGxZZWFyKCk7YnJlYWs7Y2FzZVwiTVwiOnJhd0RhdGE9ZGF0ZS5nZXRNb250aCgpO2JyZWFrO2Nhc2VcIndcIjpyYXdEYXRhPWRhdGUuZ2V0V2Vla0luWWVhcih0aGlzLmdldE1pbmltYWxEYXlzSW5GaXJzdFdlZWsoKSk7YnJlYWs7Y2FzZVwiV1wiOnJhd0RhdGE9ZGF0ZS5nZXRXZWVrSW5Nb250aCh0aGlzLmdldE1pbmltYWxEYXlzSW5GaXJzdFdlZWsoKSk7YnJlYWs7Y2FzZVwiRFwiOnJhd0RhdGE9ZGF0ZS5nZXREYXlJblllYXIoKTticmVhaztjYXNlXCJkXCI6cmF3RGF0YT1kYXRlLmdldERhdGUoKTticmVhaztjYXNlXCJGXCI6cmF3RGF0YT0xK01hdGguZmxvb3IoKGRhdGUuZ2V0RGF0ZSgpLTEpLzcpO2JyZWFrO2Nhc2VcIkVcIjpyYXdEYXRhPWRheU5hbWVzW2RhdGUuZ2V0RGF5KCldO2JyZWFrO2Nhc2VcImFcIjpyYXdEYXRhPShkYXRlLmdldEhvdXJzKCk+PTEyKT9cIlBNXCI6XCJBTVwiO2JyZWFrO2Nhc2VcIkhcIjpyYXdEYXRhPWRhdGUuZ2V0SG91cnMoKTticmVhaztjYXNlXCJrXCI6cmF3RGF0YT1kYXRlLmdldEhvdXJzKCl8fDI0O2JyZWFrO2Nhc2VcIktcIjpyYXdEYXRhPWRhdGUuZ2V0SG91cnMoKSUxMjticmVhaztjYXNlXCJoXCI6cmF3RGF0YT0oZGF0ZS5nZXRIb3VycygpJTEyKXx8MTI7YnJlYWs7Y2FzZVwibVwiOnJhd0RhdGE9ZGF0ZS5nZXRNaW51dGVzKCk7YnJlYWs7Y2FzZVwic1wiOnJhd0RhdGE9ZGF0ZS5nZXRTZWNvbmRzKCk7YnJlYWs7Y2FzZVwiU1wiOnJhd0RhdGE9ZGF0ZS5nZXRNaWxsaXNlY29uZHMoKTticmVhaztjYXNlXCJaXCI6cmF3RGF0YT1kYXRlLmdldFRpbWV6b25lT2Zmc2V0KCk7YnJlYWs7fVxyXG5zd2l0Y2godHlwZXNbcGF0dGVybkxldHRlcl0pe2Nhc2UgVEVYVDI6Zm9ybWF0dGVkU3RyaW5nKz1mb3JtYXRUZXh0KHJhd0RhdGEsbnVtYmVyT2ZMZXR0ZXJzLDIpO2JyZWFrO2Nhc2UgVEVYVDM6Zm9ybWF0dGVkU3RyaW5nKz1mb3JtYXRUZXh0KHJhd0RhdGEsbnVtYmVyT2ZMZXR0ZXJzLDMpO2JyZWFrO2Nhc2UgTlVNQkVSOmZvcm1hdHRlZFN0cmluZys9Zm9ybWF0TnVtYmVyKHJhd0RhdGEsbnVtYmVyT2ZMZXR0ZXJzKTticmVhaztjYXNlIFlFQVI6aWYobnVtYmVyT2ZMZXR0ZXJzPD0zKXt2YXIgZGF0YVN0cmluZz1cIlwiK3Jhd0RhdGE7Zm9ybWF0dGVkU3RyaW5nKz1kYXRhU3RyaW5nLnN1YnN0cigyLDIpO31lbHNle2Zvcm1hdHRlZFN0cmluZys9Zm9ybWF0TnVtYmVyKHJhd0RhdGEsbnVtYmVyT2ZMZXR0ZXJzKTt9XHJcbmJyZWFrO2Nhc2UgTU9OVEg6aWYobnVtYmVyT2ZMZXR0ZXJzPj0zKXtmb3JtYXR0ZWRTdHJpbmcrPWZvcm1hdFRleHQobW9udGhOYW1lc1tyYXdEYXRhXSxudW1iZXJPZkxldHRlcnMsbnVtYmVyT2ZMZXR0ZXJzKTt9ZWxzZXtmb3JtYXR0ZWRTdHJpbmcrPWZvcm1hdE51bWJlcihyYXdEYXRhKzEsbnVtYmVyT2ZMZXR0ZXJzKTt9XHJcbmJyZWFrO2Nhc2UgVElNRVpPTkU6dmFyIGlzUG9zaXRpdmU9KHJhd0RhdGE+MCk7dmFyIHByZWZpeD1pc1Bvc2l0aXZlP1wiLVwiOlwiK1wiO3ZhciBhYnNEYXRhPU1hdGguYWJzKHJhd0RhdGEpO3ZhciBob3Vycz1cIlwiK01hdGguZmxvb3IoYWJzRGF0YS82MCk7aG91cnM9cGFkV2l0aFplcm9lcyhob3VycywyKTt2YXIgbWludXRlcz1cIlwiKyhhYnNEYXRhJTYwKTttaW51dGVzPXBhZFdpdGhaZXJvZXMobWludXRlcywyKTtmb3JtYXR0ZWRTdHJpbmcrPXByZWZpeCtob3VycyttaW51dGVzO2JyZWFrO319XHJcbnNlYXJjaFN0cmluZz1zZWFyY2hTdHJpbmcuc3Vic3RyKHJlc3VsdC5pbmRleCtyZXN1bHRbMF0ubGVuZ3RoKTt9XHJcbnJldHVybiBmb3JtYXR0ZWRTdHJpbmc7fTt9KSgpO2xvZzRqYXZhc2NyaXB0LlNpbXBsZURhdGVGb3JtYXQ9U2ltcGxlRGF0ZUZvcm1hdDtmdW5jdGlvbiBQYXR0ZXJuTGF5b3V0KHBhdHRlcm4pe2lmKHBhdHRlcm4pe3RoaXMucGF0dGVybj1wYXR0ZXJuO31lbHNle3RoaXMucGF0dGVybj1QYXR0ZXJuTGF5b3V0LkRFRkFVTFRfQ09OVkVSU0lPTl9QQVRURVJOO31cclxudGhpcy5jdXN0b21GaWVsZHM9W107fVxyXG5QYXR0ZXJuTGF5b3V0LlRUQ0NfQ09OVkVSU0lPTl9QQVRURVJOPVwiJXIgJXAgJWMgLSAlbSVuXCI7UGF0dGVybkxheW91dC5ERUZBVUxUX0NPTlZFUlNJT05fUEFUVEVSTj1cIiVtJW5cIjtQYXR0ZXJuTGF5b3V0LklTTzg2MDFfREFURUZPUk1BVD1cInl5eXktTU0tZGQgSEg6bW06c3MsU1NTXCI7UGF0dGVybkxheW91dC5EQVRFVElNRV9EQVRFRk9STUFUPVwiZGQgTU1NIHl5eXkgSEg6bW06c3MsU1NTXCI7UGF0dGVybkxheW91dC5BQlNPTFVURVRJTUVfREFURUZPUk1BVD1cIkhIOm1tOnNzLFNTU1wiO1BhdHRlcm5MYXlvdXQucHJvdG90eXBlPW5ldyBMYXlvdXQoKTtQYXR0ZXJuTGF5b3V0LnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXt2YXIgcmVnZXg9LyUoLT9bMC05XSspPyhcXC4/WzAtOV0rKT8oW2FjZGZtTW5wciVdKShcXHsoW15cXH1dKylcXH0pP3woW14lXSspLzt2YXIgZm9ybWF0dGVkU3RyaW5nPVwiXCI7dmFyIHJlc3VsdDt2YXIgc2VhcmNoU3RyaW5nPXRoaXMucGF0dGVybjt3aGlsZSgocmVzdWx0PXJlZ2V4LmV4ZWMoc2VhcmNoU3RyaW5nKSkpe3ZhciBtYXRjaGVkU3RyaW5nPXJlc3VsdFswXTt2YXIgcGFkZGluZz1yZXN1bHRbMV07dmFyIHRydW5jYXRpb249cmVzdWx0WzJdO3ZhciBjb252ZXJzaW9uQ2hhcmFjdGVyPXJlc3VsdFszXTt2YXIgc3BlY2lmaWVyPXJlc3VsdFs1XTt2YXIgdGV4dD1yZXN1bHRbNl07aWYodGV4dCl7Zm9ybWF0dGVkU3RyaW5nKz1cIlwiK3RleHQ7fWVsc2V7dmFyIHJlcGxhY2VtZW50PVwiXCI7c3dpdGNoKGNvbnZlcnNpb25DaGFyYWN0ZXIpe2Nhc2VcImFcIjpjYXNlXCJtXCI6dmFyIGRlcHRoPTA7aWYoc3BlY2lmaWVyKXtkZXB0aD1wYXJzZUludChzcGVjaWZpZXIsMTApO2lmKGlzTmFOKGRlcHRoKSl7aGFuZGxlRXJyb3IoXCJQYXR0ZXJuTGF5b3V0LmZvcm1hdDogaW52YWxpZCBzcGVjaWZpZXIgJ1wiK1xyXG5zcGVjaWZpZXIrXCInIGZvciBjb252ZXJzaW9uIGNoYXJhY3RlciAnXCIrY29udmVyc2lvbkNoYXJhY3RlcitcIicgLSBzaG91bGQgYmUgYSBudW1iZXJcIik7ZGVwdGg9MDt9fVxyXG52YXIgbWVzc2FnZXM9KGNvbnZlcnNpb25DaGFyYWN0ZXI9PT1cImFcIik/bG9nZ2luZ0V2ZW50Lm1lc3NhZ2VzWzBdOmxvZ2dpbmdFdmVudC5tZXNzYWdlcztmb3IodmFyIGk9MCxsZW49bWVzc2FnZXMubGVuZ3RoO2k8bGVuO2krKyl7aWYoaT4wJiYocmVwbGFjZW1lbnQuY2hhckF0KHJlcGxhY2VtZW50Lmxlbmd0aC0xKSE9PVwiIFwiKSl7cmVwbGFjZW1lbnQrPVwiIFwiO31cclxuaWYoZGVwdGg9PT0wKXtyZXBsYWNlbWVudCs9bWVzc2FnZXNbaV07fWVsc2V7cmVwbGFjZW1lbnQrPWZvcm1hdE9iamVjdEV4cGFuc2lvbihtZXNzYWdlc1tpXSxkZXB0aCk7fX1cclxuYnJlYWs7Y2FzZVwiY1wiOnZhciBsb2dnZXJOYW1lPWxvZ2dpbmdFdmVudC5sb2dnZXIubmFtZTtpZihzcGVjaWZpZXIpe3ZhciBwcmVjaXNpb249cGFyc2VJbnQoc3BlY2lmaWVyLDEwKTt2YXIgbG9nZ2VyTmFtZUJpdHM9bG9nZ2luZ0V2ZW50LmxvZ2dlci5uYW1lLnNwbGl0KFwiLlwiKTtpZihwcmVjaXNpb24+PWxvZ2dlck5hbWVCaXRzLmxlbmd0aCl7cmVwbGFjZW1lbnQ9bG9nZ2VyTmFtZTt9ZWxzZXtyZXBsYWNlbWVudD1sb2dnZXJOYW1lQml0cy5zbGljZShsb2dnZXJOYW1lQml0cy5sZW5ndGgtcHJlY2lzaW9uKS5qb2luKFwiLlwiKTt9fWVsc2V7cmVwbGFjZW1lbnQ9bG9nZ2VyTmFtZTt9XHJcbmJyZWFrO2Nhc2VcImRcIjp2YXIgZGF0ZUZvcm1hdD1QYXR0ZXJuTGF5b3V0LklTTzg2MDFfREFURUZPUk1BVDtpZihzcGVjaWZpZXIpe2RhdGVGb3JtYXQ9c3BlY2lmaWVyO2lmKGRhdGVGb3JtYXQ9PVwiSVNPODYwMVwiKXtkYXRlRm9ybWF0PVBhdHRlcm5MYXlvdXQuSVNPODYwMV9EQVRFRk9STUFUO31lbHNlIGlmKGRhdGVGb3JtYXQ9PVwiQUJTT0xVVEVcIil7ZGF0ZUZvcm1hdD1QYXR0ZXJuTGF5b3V0LkFCU09MVVRFVElNRV9EQVRFRk9STUFUO31lbHNlIGlmKGRhdGVGb3JtYXQ9PVwiREFURVwiKXtkYXRlRm9ybWF0PVBhdHRlcm5MYXlvdXQuREFURVRJTUVfREFURUZPUk1BVDt9fVxyXG5yZXBsYWNlbWVudD0obmV3IFNpbXBsZURhdGVGb3JtYXQoZGF0ZUZvcm1hdCkpLmZvcm1hdChsb2dnaW5nRXZlbnQudGltZVN0YW1wKTticmVhaztjYXNlXCJmXCI6aWYodGhpcy5oYXNDdXN0b21GaWVsZHMoKSl7dmFyIGZpZWxkSW5kZXg9MDtpZihzcGVjaWZpZXIpe2ZpZWxkSW5kZXg9cGFyc2VJbnQoc3BlY2lmaWVyLDEwKTtpZihpc05hTihmaWVsZEluZGV4KSl7aGFuZGxlRXJyb3IoXCJQYXR0ZXJuTGF5b3V0LmZvcm1hdDogaW52YWxpZCBzcGVjaWZpZXIgJ1wiK1xyXG5zcGVjaWZpZXIrXCInIGZvciBjb252ZXJzaW9uIGNoYXJhY3RlciAnZicgLSBzaG91bGQgYmUgYSBudW1iZXJcIik7fWVsc2UgaWYoZmllbGRJbmRleD09PTApe2hhbmRsZUVycm9yKFwiUGF0dGVybkxheW91dC5mb3JtYXQ6IGludmFsaWQgc3BlY2lmaWVyICdcIitcclxuc3BlY2lmaWVyK1wiJyBmb3IgY29udmVyc2lvbiBjaGFyYWN0ZXIgJ2YnIC0gbXVzdCBiZSBncmVhdGVyIHRoYW4gemVyb1wiKTt9ZWxzZSBpZihmaWVsZEluZGV4PnRoaXMuY3VzdG9tRmllbGRzLmxlbmd0aCl7aGFuZGxlRXJyb3IoXCJQYXR0ZXJuTGF5b3V0LmZvcm1hdDogaW52YWxpZCBzcGVjaWZpZXIgJ1wiK1xyXG5zcGVjaWZpZXIrXCInIGZvciBjb252ZXJzaW9uIGNoYXJhY3RlciAnZicgLSB0aGVyZSBhcmVuJ3QgdGhhdCBtYW55IGN1c3RvbSBmaWVsZHNcIik7fWVsc2V7ZmllbGRJbmRleD1maWVsZEluZGV4LTE7fX1cclxudmFyIHZhbD10aGlzLmN1c3RvbUZpZWxkc1tmaWVsZEluZGV4XS52YWx1ZTtpZih0eXBlb2YgdmFsPT1cImZ1bmN0aW9uXCIpe3ZhbD12YWwodGhpcyxsb2dnaW5nRXZlbnQpO31cclxucmVwbGFjZW1lbnQ9dmFsO31cclxuYnJlYWs7Y2FzZVwiblwiOnJlcGxhY2VtZW50PW5ld0xpbmU7YnJlYWs7Y2FzZVwicFwiOnJlcGxhY2VtZW50PWxvZ2dpbmdFdmVudC5sZXZlbC5uYW1lO2JyZWFrO2Nhc2VcInJcIjpyZXBsYWNlbWVudD1cIlwiK2xvZ2dpbmdFdmVudC50aW1lU3RhbXAuZ2V0RGlmZmVyZW5jZShhcHBsaWNhdGlvblN0YXJ0RGF0ZSk7YnJlYWs7Y2FzZVwiJVwiOnJlcGxhY2VtZW50PVwiJVwiO2JyZWFrO2RlZmF1bHQ6cmVwbGFjZW1lbnQ9bWF0Y2hlZFN0cmluZzticmVhazt9XHJcbnZhciBsO2lmKHRydW5jYXRpb24pe2w9cGFyc2VJbnQodHJ1bmNhdGlvbi5zdWJzdHIoMSksMTApO3ZhciBzdHJMZW49cmVwbGFjZW1lbnQubGVuZ3RoO2lmKGw8c3RyTGVuKXtyZXBsYWNlbWVudD1yZXBsYWNlbWVudC5zdWJzdHJpbmcoc3RyTGVuLWwsc3RyTGVuKTt9fVxyXG5pZihwYWRkaW5nKXtpZihwYWRkaW5nLmNoYXJBdCgwKT09XCItXCIpe2w9cGFyc2VJbnQocGFkZGluZy5zdWJzdHIoMSksMTApO3doaWxlKHJlcGxhY2VtZW50Lmxlbmd0aDxsKXtyZXBsYWNlbWVudCs9XCIgXCI7fX1lbHNle2w9cGFyc2VJbnQocGFkZGluZywxMCk7d2hpbGUocmVwbGFjZW1lbnQubGVuZ3RoPGwpe3JlcGxhY2VtZW50PVwiIFwiK3JlcGxhY2VtZW50O319fVxyXG5mb3JtYXR0ZWRTdHJpbmcrPXJlcGxhY2VtZW50O31cclxuc2VhcmNoU3RyaW5nPXNlYXJjaFN0cmluZy5zdWJzdHIocmVzdWx0LmluZGV4K3Jlc3VsdFswXS5sZW5ndGgpO31cclxucmV0dXJuIGZvcm1hdHRlZFN0cmluZzt9O1BhdHRlcm5MYXlvdXQucHJvdG90eXBlLmlnbm9yZXNUaHJvd2FibGU9ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9O1BhdHRlcm5MYXlvdXQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJQYXR0ZXJuTGF5b3V0XCI7fTtsb2c0amF2YXNjcmlwdC5QYXR0ZXJuTGF5b3V0PVBhdHRlcm5MYXlvdXQ7ZnVuY3Rpb24gQWxlcnRBcHBlbmRlcigpe31cclxuQWxlcnRBcHBlbmRlci5wcm90b3R5cGU9bmV3IEFwcGVuZGVyKCk7QWxlcnRBcHBlbmRlci5wcm90b3R5cGUubGF5b3V0PW5ldyBTaW1wbGVMYXlvdXQoKTtBbGVydEFwcGVuZGVyLnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXthbGVydCh0aGlzLmdldExheW91dCgpLmZvcm1hdFdpdGhFeGNlcHRpb24obG9nZ2luZ0V2ZW50KSk7fTtBbGVydEFwcGVuZGVyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiQWxlcnRBcHBlbmRlclwiO307bG9nNGphdmFzY3JpcHQuQWxlcnRBcHBlbmRlcj1BbGVydEFwcGVuZGVyO2Z1bmN0aW9uIEJyb3dzZXJDb25zb2xlQXBwZW5kZXIoKXt9XHJcbkJyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlPW5ldyBsb2c0amF2YXNjcmlwdC5BcHBlbmRlcigpO0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmxheW91dD1uZXcgTnVsbExheW91dCgpO0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLnRocmVzaG9sZD1MZXZlbC5ERUJVRztCcm93c2VyQ29uc29sZUFwcGVuZGVyLnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXt2YXIgYXBwZW5kZXI9dGhpczt2YXIgZ2V0Rm9ybWF0dGVkTWVzc2FnZT1mdW5jdGlvbihjb25jYXRlbmF0ZSl7dmFyIGZvcm1hdHRlZE1lc3NhZ2U9YXBwZW5kZXIuZ2V0TGF5b3V0KCkuZm9ybWF0V2l0aEV4Y2VwdGlvbihsb2dnaW5nRXZlbnQpO3JldHVybih0eXBlb2YgZm9ybWF0dGVkTWVzc2FnZT09XCJzdHJpbmdcIik/KGNvbmNhdGVuYXRlP2Zvcm1hdHRlZE1lc3NhZ2U6W2Zvcm1hdHRlZE1lc3NhZ2VdKTooY29uY2F0ZW5hdGU/Zm9ybWF0dGVkTWVzc2FnZS5qb2luKFwiIFwiKTpmb3JtYXR0ZWRNZXNzYWdlKTt9O3ZhciBjb25zb2xlPXdpbmRvdy5jb25zb2xlO2lmKGNvbnNvbGUmJmNvbnNvbGUubG9nKXt2YXIgY29uc29sZU1ldGhvZE5hbWU7aWYoY29uc29sZS5kZWJ1ZyYmTGV2ZWwuREVCVUcuaXNHcmVhdGVyT3JFcXVhbChsb2dnaW5nRXZlbnQubGV2ZWwpKXtjb25zb2xlTWV0aG9kTmFtZT1cImRlYnVnXCI7fWVsc2UgaWYoY29uc29sZS5pbmZvJiZMZXZlbC5JTkZPLmVxdWFscyhsb2dnaW5nRXZlbnQubGV2ZWwpKXtjb25zb2xlTWV0aG9kTmFtZT1cImluZm9cIjt9ZWxzZSBpZihjb25zb2xlLndhcm4mJkxldmVsLldBUk4uZXF1YWxzKGxvZ2dpbmdFdmVudC5sZXZlbCkpe2NvbnNvbGVNZXRob2ROYW1lPVwid2FyblwiO31lbHNlIGlmKGNvbnNvbGUuZXJyb3ImJmxvZ2dpbmdFdmVudC5sZXZlbC5pc0dyZWF0ZXJPckVxdWFsKExldmVsLkVSUk9SKSl7Y29uc29sZU1ldGhvZE5hbWU9XCJlcnJvclwiO31lbHNle2NvbnNvbGVNZXRob2ROYW1lPVwibG9nXCI7fVxyXG5pZih0eXBlb2YgY29uc29sZVtjb25zb2xlTWV0aG9kTmFtZV0uYXBwbHk9PVwiZnVuY3Rpb25cIil7Y29uc29sZVtjb25zb2xlTWV0aG9kTmFtZV0uYXBwbHkoY29uc29sZSxnZXRGb3JtYXR0ZWRNZXNzYWdlKGZhbHNlKSk7fWVsc2V7Y29uc29sZVtjb25zb2xlTWV0aG9kTmFtZV0oZ2V0Rm9ybWF0dGVkTWVzc2FnZSh0cnVlKSk7fX1lbHNlIGlmKCh0eXBlb2Ygb3BlcmEhPVwidW5kZWZpbmVkXCIpJiZvcGVyYS5wb3N0RXJyb3Ipe29wZXJhLnBvc3RFcnJvcihnZXRGb3JtYXR0ZWRNZXNzYWdlKHRydWUpKTt9fTtCcm93c2VyQ29uc29sZUFwcGVuZGVyLnByb3RvdHlwZS5ncm91cD1mdW5jdGlvbihuYW1lKXtpZih3aW5kb3cuY29uc29sZSYmd2luZG93LmNvbnNvbGUuZ3JvdXApe3dpbmRvdy5jb25zb2xlLmdyb3VwKG5hbWUpO319O0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmdyb3VwRW5kPWZ1bmN0aW9uKCl7aWYod2luZG93LmNvbnNvbGUmJndpbmRvdy5jb25zb2xlLmdyb3VwRW5kKXt3aW5kb3cuY29uc29sZS5ncm91cEVuZCgpO319O0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJCcm93c2VyQ29uc29sZUFwcGVuZGVyXCI7fTtsb2c0amF2YXNjcmlwdC5Ccm93c2VyQ29uc29sZUFwcGVuZGVyPUJyb3dzZXJDb25zb2xlQXBwZW5kZXI7dmFyIHhockZhY3Rvcnk9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7fTt2YXIgeG1sSHR0cEZhY3Rvcmllcz1beGhyRmFjdG9yeSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1zeG1sMi5YTUxIVFRQXCIpO30sZnVuY3Rpb24oKXtyZXR1cm4gbmV3IEFjdGl2ZVhPYmplY3QoXCJNaWNyb3NvZnQuWE1MSFRUUFwiKTt9XTt2YXIgd2l0aENyZWRlbnRpYWxzU3VwcG9ydGVkPWZhbHNlO3ZhciBnZXRYbWxIdHRwPWZ1bmN0aW9uKGVycm9ySGFuZGxlcil7dmFyIHhtbEh0dHA9bnVsbCxmYWN0b3J5O2Zvcih2YXIgaT0wLGxlbj14bWxIdHRwRmFjdG9yaWVzLmxlbmd0aDtpPGxlbjtpKyspe2ZhY3Rvcnk9eG1sSHR0cEZhY3Rvcmllc1tpXTt0cnl7eG1sSHR0cD1mYWN0b3J5KCk7d2l0aENyZWRlbnRpYWxzU3VwcG9ydGVkPShmYWN0b3J5PT14aHJGYWN0b3J5JiYoXCJ3aXRoQ3JlZGVudGlhbHNcImluIHhtbEh0dHApKTtnZXRYbWxIdHRwPWZhY3Rvcnk7cmV0dXJuIHhtbEh0dHA7fWNhdGNoKGUpe319XHJcbmlmKGVycm9ySGFuZGxlcil7ZXJyb3JIYW5kbGVyKCk7fWVsc2V7aGFuZGxlRXJyb3IoXCJnZXRYbWxIdHRwOiB1bmFibGUgdG8gb2J0YWluIFhNTEh0dHBSZXF1ZXN0IG9iamVjdFwiKTt9fTtmdW5jdGlvbiBpc0h0dHBSZXF1ZXN0U3VjY2Vzc2Z1bCh4bWxIdHRwKXtyZXR1cm4gaXNVbmRlZmluZWQoeG1sSHR0cC5zdGF0dXMpfHx4bWxIdHRwLnN0YXR1cz09PTB8fCh4bWxIdHRwLnN0YXR1cz49MjAwJiZ4bWxIdHRwLnN0YXR1czwzMDApfHx4bWxIdHRwLnN0YXR1cz09MTIyMzt9XHJcbmZ1bmN0aW9uIEFqYXhBcHBlbmRlcih1cmwsd2l0aENyZWRlbnRpYWxzKXt2YXIgYXBwZW5kZXI9dGhpczt2YXIgaXNTdXBwb3J0ZWQ9dHJ1ZTtpZighdXJsKXtoYW5kbGVFcnJvcihcIkFqYXhBcHBlbmRlcjogVVJMIG11c3QgYmUgc3BlY2lmaWVkIGluIGNvbnN0cnVjdG9yXCIpO2lzU3VwcG9ydGVkPWZhbHNlO31cclxudmFyIHRpbWVkPXRoaXMuZGVmYXVsdHMudGltZWQ7dmFyIHdhaXRGb3JSZXNwb25zZT10aGlzLmRlZmF1bHRzLndhaXRGb3JSZXNwb25zZTt2YXIgYmF0Y2hTaXplPXRoaXMuZGVmYXVsdHMuYmF0Y2hTaXplO3ZhciB0aW1lckludGVydmFsPXRoaXMuZGVmYXVsdHMudGltZXJJbnRlcnZhbDt2YXIgcmVxdWVzdFN1Y2Nlc3NDYWxsYmFjaz10aGlzLmRlZmF1bHRzLnJlcXVlc3RTdWNjZXNzQ2FsbGJhY2s7dmFyIGZhaWxDYWxsYmFjaz10aGlzLmRlZmF1bHRzLmZhaWxDYWxsYmFjazt2YXIgcG9zdFZhck5hbWU9dGhpcy5kZWZhdWx0cy5wb3N0VmFyTmFtZTt2YXIgc2VuZEFsbE9uVW5sb2FkPXRoaXMuZGVmYXVsdHMuc2VuZEFsbE9uVW5sb2FkO3ZhciBjb250ZW50VHlwZT10aGlzLmRlZmF1bHRzLmNvbnRlbnRUeXBlO3ZhciBzZXNzaW9uSWQ9bnVsbDt2YXIgcXVldWVkTG9nZ2luZ0V2ZW50cz1bXTt2YXIgcXVldWVkUmVxdWVzdHM9W107dmFyIGhlYWRlcnM9W107dmFyIHNlbmRpbmc9ZmFsc2U7dmFyIGluaXRpYWxpemVkPWZhbHNlO2Z1bmN0aW9uIGNoZWNrQ2FuQ29uZmlndXJlKGNvbmZpZ09wdGlvbk5hbWUpe2lmKGluaXRpYWxpemVkKXtoYW5kbGVFcnJvcihcIkFqYXhBcHBlbmRlcjogY29uZmlndXJhdGlvbiBvcHRpb24gJ1wiK1xyXG5jb25maWdPcHRpb25OYW1lK1wiJyBtYXkgbm90IGJlIHNldCBhZnRlciB0aGUgYXBwZW5kZXIgaGFzIGJlZW4gaW5pdGlhbGl6ZWRcIik7cmV0dXJuIGZhbHNlO31cclxucmV0dXJuIHRydWU7fVxyXG50aGlzLmdldFNlc3Npb25JZD1mdW5jdGlvbigpe3JldHVybiBzZXNzaW9uSWQ7fTt0aGlzLnNldFNlc3Npb25JZD1mdW5jdGlvbihzZXNzaW9uSWRQYXJhbSl7c2Vzc2lvbklkPWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0oc2Vzc2lvbklkUGFyYW0sbnVsbCk7dGhpcy5sYXlvdXQuc2V0Q3VzdG9tRmllbGQoXCJzZXNzaW9uaWRcIixzZXNzaW9uSWQpO307dGhpcy5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0UGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwibGF5b3V0XCIpKXt0aGlzLmxheW91dD1sYXlvdXRQYXJhbTtpZihzZXNzaW9uSWQhPT1udWxsKXt0aGlzLnNldFNlc3Npb25JZChzZXNzaW9uSWQpO319fTt0aGlzLmlzVGltZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGltZWQ7fTt0aGlzLnNldFRpbWVkPWZ1bmN0aW9uKHRpbWVkUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwidGltZWRcIikpe3RpbWVkPWJvb2wodGltZWRQYXJhbSk7fX07dGhpcy5nZXRUaW1lckludGVydmFsPWZ1bmN0aW9uKCl7cmV0dXJuIHRpbWVySW50ZXJ2YWw7fTt0aGlzLnNldFRpbWVySW50ZXJ2YWw9ZnVuY3Rpb24odGltZXJJbnRlcnZhbFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcInRpbWVySW50ZXJ2YWxcIikpe3RpbWVySW50ZXJ2YWw9ZXh0cmFjdEludEZyb21QYXJhbSh0aW1lckludGVydmFsUGFyYW0sdGltZXJJbnRlcnZhbCk7fX07dGhpcy5pc1dhaXRGb3JSZXNwb25zZT1mdW5jdGlvbigpe3JldHVybiB3YWl0Rm9yUmVzcG9uc2U7fTt0aGlzLnNldFdhaXRGb3JSZXNwb25zZT1mdW5jdGlvbih3YWl0Rm9yUmVzcG9uc2VQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJ3YWl0Rm9yUmVzcG9uc2VcIikpe3dhaXRGb3JSZXNwb25zZT1ib29sKHdhaXRGb3JSZXNwb25zZVBhcmFtKTt9fTt0aGlzLmdldEJhdGNoU2l6ZT1mdW5jdGlvbigpe3JldHVybiBiYXRjaFNpemU7fTt0aGlzLnNldEJhdGNoU2l6ZT1mdW5jdGlvbihiYXRjaFNpemVQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJiYXRjaFNpemVcIikpe2JhdGNoU2l6ZT1leHRyYWN0SW50RnJvbVBhcmFtKGJhdGNoU2l6ZVBhcmFtLGJhdGNoU2l6ZSk7fX07dGhpcy5pc1NlbmRBbGxPblVubG9hZD1mdW5jdGlvbigpe3JldHVybiBzZW5kQWxsT25VbmxvYWQ7fTt0aGlzLnNldFNlbmRBbGxPblVubG9hZD1mdW5jdGlvbihzZW5kQWxsT25VbmxvYWRQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJzZW5kQWxsT25VbmxvYWRcIikpe3NlbmRBbGxPblVubG9hZD1leHRyYWN0Qm9vbGVhbkZyb21QYXJhbShzZW5kQWxsT25VbmxvYWRQYXJhbSxzZW5kQWxsT25VbmxvYWQpO319O3RoaXMuc2V0UmVxdWVzdFN1Y2Nlc3NDYWxsYmFjaz1mdW5jdGlvbihyZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrUGFyYW0pe3JlcXVlc3RTdWNjZXNzQ2FsbGJhY2s9ZXh0cmFjdEZ1bmN0aW9uRnJvbVBhcmFtKHJlcXVlc3RTdWNjZXNzQ2FsbGJhY2tQYXJhbSxyZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrKTt9O3RoaXMuc2V0RmFpbENhbGxiYWNrPWZ1bmN0aW9uKGZhaWxDYWxsYmFja1BhcmFtKXtmYWlsQ2FsbGJhY2s9ZXh0cmFjdEZ1bmN0aW9uRnJvbVBhcmFtKGZhaWxDYWxsYmFja1BhcmFtLGZhaWxDYWxsYmFjayk7fTt0aGlzLmdldFBvc3RWYXJOYW1lPWZ1bmN0aW9uKCl7cmV0dXJuIHBvc3RWYXJOYW1lO307dGhpcy5zZXRQb3N0VmFyTmFtZT1mdW5jdGlvbihwb3N0VmFyTmFtZVBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcInBvc3RWYXJOYW1lXCIpKXtwb3N0VmFyTmFtZT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKHBvc3RWYXJOYW1lUGFyYW0scG9zdFZhck5hbWUpO319O3RoaXMuZ2V0SGVhZGVycz1mdW5jdGlvbigpe3JldHVybiBoZWFkZXJzO307dGhpcy5hZGRIZWFkZXI9ZnVuY3Rpb24obmFtZSx2YWx1ZSl7aWYobmFtZS50b0xvd2VyQ2FzZSgpPT1cImNvbnRlbnQtdHlwZVwiKXtjb250ZW50VHlwZT12YWx1ZTt9ZWxzZXtoZWFkZXJzLnB1c2goe25hbWU6bmFtZSx2YWx1ZTp2YWx1ZX0pO319O2Z1bmN0aW9uIHNlbmRBbGwoKXtpZihpc1N1cHBvcnRlZCYmZW5hYmxlZCl7c2VuZGluZz10cnVlO3ZhciBjdXJyZW50UmVxdWVzdEJhdGNoO2lmKHdhaXRGb3JSZXNwb25zZSl7aWYocXVldWVkUmVxdWVzdHMubGVuZ3RoPjApe2N1cnJlbnRSZXF1ZXN0QmF0Y2g9cXVldWVkUmVxdWVzdHMuc2hpZnQoKTtzZW5kUmVxdWVzdChwcmVwYXJlUG9zdERhdGEoY3VycmVudFJlcXVlc3RCYXRjaCksc2VuZEFsbCk7fWVsc2V7c2VuZGluZz1mYWxzZTtpZih0aW1lZCl7c2NoZWR1bGVTZW5kaW5nKCk7fX19ZWxzZXt3aGlsZSgoY3VycmVudFJlcXVlc3RCYXRjaD1xdWV1ZWRSZXF1ZXN0cy5zaGlmdCgpKSl7c2VuZFJlcXVlc3QocHJlcGFyZVBvc3REYXRhKGN1cnJlbnRSZXF1ZXN0QmF0Y2gpKTt9XHJcbnNlbmRpbmc9ZmFsc2U7aWYodGltZWQpe3NjaGVkdWxlU2VuZGluZygpO319fX1cclxudGhpcy5zZW5kQWxsPXNlbmRBbGw7ZnVuY3Rpb24gc2VuZEFsbFJlbWFpbmluZygpe3ZhciBzZW5kaW5nQW55dGhpbmc9ZmFsc2U7aWYoaXNTdXBwb3J0ZWQmJmVuYWJsZWQpe3ZhciBhY3R1YWxCYXRjaFNpemU9YXBwZW5kZXIuZ2V0TGF5b3V0KCkuYWxsb3dCYXRjaGluZygpP2JhdGNoU2l6ZToxO3ZhciBjdXJyZW50TG9nZ2luZ0V2ZW50O3ZhciBiYXRjaGVkTG9nZ2luZ0V2ZW50cz1bXTt3aGlsZSgoY3VycmVudExvZ2dpbmdFdmVudD1xdWV1ZWRMb2dnaW5nRXZlbnRzLnNoaWZ0KCkpKXtiYXRjaGVkTG9nZ2luZ0V2ZW50cy5wdXNoKGN1cnJlbnRMb2dnaW5nRXZlbnQpO2lmKHF1ZXVlZExvZ2dpbmdFdmVudHMubGVuZ3RoPj1hY3R1YWxCYXRjaFNpemUpe3F1ZXVlZFJlcXVlc3RzLnB1c2goYmF0Y2hlZExvZ2dpbmdFdmVudHMpO2JhdGNoZWRMb2dnaW5nRXZlbnRzPVtdO319XHJcbmlmKGJhdGNoZWRMb2dnaW5nRXZlbnRzLmxlbmd0aD4wKXtxdWV1ZWRSZXF1ZXN0cy5wdXNoKGJhdGNoZWRMb2dnaW5nRXZlbnRzKTt9XHJcbnNlbmRpbmdBbnl0aGluZz0ocXVldWVkUmVxdWVzdHMubGVuZ3RoPjApO3dhaXRGb3JSZXNwb25zZT1mYWxzZTt0aW1lZD1mYWxzZTtzZW5kQWxsKCk7fVxyXG5yZXR1cm4gc2VuZGluZ0FueXRoaW5nO31cclxudGhpcy5zZW5kQWxsUmVtYWluaW5nPXNlbmRBbGxSZW1haW5pbmc7ZnVuY3Rpb24gcHJlcGFyZVBvc3REYXRhKGJhdGNoZWRMb2dnaW5nRXZlbnRzKXt2YXIgZm9ybWF0dGVkTWVzc2FnZXM9W107dmFyIGN1cnJlbnRMb2dnaW5nRXZlbnQ7dmFyIHBvc3REYXRhPVwiXCI7d2hpbGUoKGN1cnJlbnRMb2dnaW5nRXZlbnQ9YmF0Y2hlZExvZ2dpbmdFdmVudHMuc2hpZnQoKSkpe2Zvcm1hdHRlZE1lc3NhZ2VzLnB1c2goYXBwZW5kZXIuZ2V0TGF5b3V0KCkuZm9ybWF0V2l0aEV4Y2VwdGlvbihjdXJyZW50TG9nZ2luZ0V2ZW50KSk7fVxyXG5pZihiYXRjaGVkTG9nZ2luZ0V2ZW50cy5sZW5ndGg9PTEpe3Bvc3REYXRhPWZvcm1hdHRlZE1lc3NhZ2VzLmpvaW4oXCJcIik7fWVsc2V7cG9zdERhdGE9YXBwZW5kZXIuZ2V0TGF5b3V0KCkuYmF0Y2hIZWFkZXIrXHJcbmZvcm1hdHRlZE1lc3NhZ2VzLmpvaW4oYXBwZW5kZXIuZ2V0TGF5b3V0KCkuYmF0Y2hTZXBhcmF0b3IpK1xyXG5hcHBlbmRlci5nZXRMYXlvdXQoKS5iYXRjaEZvb3Rlcjt9XHJcbmlmKGNvbnRlbnRUeXBlPT1hcHBlbmRlci5kZWZhdWx0cy5jb250ZW50VHlwZSl7cG9zdERhdGE9YXBwZW5kZXIuZ2V0TGF5b3V0KCkucmV0dXJuc1Bvc3REYXRhP3Bvc3REYXRhOnVybEVuY29kZShwb3N0VmFyTmFtZSkrXCI9XCIrdXJsRW5jb2RlKHBvc3REYXRhKTtpZihwb3N0RGF0YS5sZW5ndGg+MCl7cG9zdERhdGErPVwiJlwiO31cclxucG9zdERhdGErPVwibGF5b3V0PVwiK3VybEVuY29kZShhcHBlbmRlci5nZXRMYXlvdXQoKS50b1N0cmluZygpKTt9XHJcbnJldHVybiBwb3N0RGF0YTt9XHJcbmZ1bmN0aW9uIHNjaGVkdWxlU2VuZGluZygpe3dpbmRvdy5zZXRUaW1lb3V0KHNlbmRBbGwsdGltZXJJbnRlcnZhbCk7fVxyXG5mdW5jdGlvbiB4bWxIdHRwRXJyb3JIYW5kbGVyKCl7dmFyIG1zZz1cIkFqYXhBcHBlbmRlcjogY291bGQgbm90IGNyZWF0ZSBYTUxIdHRwUmVxdWVzdCBvYmplY3QuIEFqYXhBcHBlbmRlciBkaXNhYmxlZFwiO2hhbmRsZUVycm9yKG1zZyk7aXNTdXBwb3J0ZWQ9ZmFsc2U7aWYoZmFpbENhbGxiYWNrKXtmYWlsQ2FsbGJhY2sobXNnKTt9fVxyXG5mdW5jdGlvbiBzZW5kUmVxdWVzdChwb3N0RGF0YSxzdWNjZXNzQ2FsbGJhY2spe3RyeXt2YXIgeG1sSHR0cD1nZXRYbWxIdHRwKHhtbEh0dHBFcnJvckhhbmRsZXIpO2lmKGlzU3VwcG9ydGVkKXt4bWxIdHRwLm9ucmVhZHlzdGF0ZWNoYW5nZT1mdW5jdGlvbigpe2lmKHhtbEh0dHAucmVhZHlTdGF0ZT09NCl7aWYoaXNIdHRwUmVxdWVzdFN1Y2Nlc3NmdWwoeG1sSHR0cCkpe2lmKHJlcXVlc3RTdWNjZXNzQ2FsbGJhY2spe3JlcXVlc3RTdWNjZXNzQ2FsbGJhY2soeG1sSHR0cCk7fVxyXG5pZihzdWNjZXNzQ2FsbGJhY2spe3N1Y2Nlc3NDYWxsYmFjayh4bWxIdHRwKTt9fWVsc2V7dmFyIG1zZz1cIkFqYXhBcHBlbmRlci5hcHBlbmQ6IFhNTEh0dHBSZXF1ZXN0IHJlcXVlc3QgdG8gVVJMIFwiK1xyXG51cmwrXCIgcmV0dXJuZWQgc3RhdHVzIGNvZGUgXCIreG1sSHR0cC5zdGF0dXM7aGFuZGxlRXJyb3IobXNnKTtpZihmYWlsQ2FsbGJhY2spe2ZhaWxDYWxsYmFjayhtc2cpO319XHJcbnhtbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWVtcHR5RnVuY3Rpb247eG1sSHR0cD1udWxsO319O3htbEh0dHAub3BlbihcIlBPU1RcIix1cmwsdHJ1ZSk7aWYod2l0aENyZWRlbnRpYWxzJiZ3aXRoQ3JlZGVudGlhbHNTdXBwb3J0ZWQpe3htbEh0dHAud2l0aENyZWRlbnRpYWxzPXRydWU7fVxyXG50cnl7Zm9yKHZhciBpPTAsaGVhZGVyO2hlYWRlcj1oZWFkZXJzW2krK107KXt4bWxIdHRwLnNldFJlcXVlc3RIZWFkZXIoaGVhZGVyLm5hbWUsaGVhZGVyLnZhbHVlKTt9XHJcbnhtbEh0dHAuc2V0UmVxdWVzdEhlYWRlcihcIkNvbnRlbnQtVHlwZVwiLGNvbnRlbnRUeXBlKTt9Y2F0Y2goaGVhZGVyRXgpe3ZhciBtc2c9XCJBamF4QXBwZW5kZXIuYXBwZW5kOiB5b3VyIGJyb3dzZXIncyBYTUxIdHRwUmVxdWVzdCBpbXBsZW1lbnRhdGlvblwiK1wiIGRvZXMgbm90IHN1cHBvcnQgc2V0UmVxdWVzdEhlYWRlciwgdGhlcmVmb3JlIGNhbm5vdCBwb3N0IGRhdGEuIEFqYXhBcHBlbmRlciBkaXNhYmxlZFwiO2hhbmRsZUVycm9yKG1zZyk7aXNTdXBwb3J0ZWQ9ZmFsc2U7aWYoZmFpbENhbGxiYWNrKXtmYWlsQ2FsbGJhY2sobXNnKTt9XHJcbnJldHVybjt9XHJcbnhtbEh0dHAuc2VuZChwb3N0RGF0YSk7fX1jYXRjaChleCl7dmFyIGVyck1zZz1cIkFqYXhBcHBlbmRlci5hcHBlbmQ6IGVycm9yIHNlbmRpbmcgbG9nIG1lc3NhZ2UgdG8gXCIrdXJsO2hhbmRsZUVycm9yKGVyck1zZyxleCk7aXNTdXBwb3J0ZWQ9ZmFsc2U7aWYoZmFpbENhbGxiYWNrKXtmYWlsQ2FsbGJhY2soZXJyTXNnK1wiLiBEZXRhaWxzOiBcIitnZXRFeGNlcHRpb25TdHJpbmdSZXAoZXgpKTt9fX1cclxudGhpcy5hcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtpZihpc1N1cHBvcnRlZCl7aWYoIWluaXRpYWxpemVkKXtpbml0KCk7fVxyXG5xdWV1ZWRMb2dnaW5nRXZlbnRzLnB1c2gobG9nZ2luZ0V2ZW50KTt2YXIgYWN0dWFsQmF0Y2hTaXplPXRoaXMuZ2V0TGF5b3V0KCkuYWxsb3dCYXRjaGluZygpP2JhdGNoU2l6ZToxO2lmKHF1ZXVlZExvZ2dpbmdFdmVudHMubGVuZ3RoPj1hY3R1YWxCYXRjaFNpemUpe3ZhciBjdXJyZW50TG9nZ2luZ0V2ZW50O3ZhciBiYXRjaGVkTG9nZ2luZ0V2ZW50cz1bXTt3aGlsZSgoY3VycmVudExvZ2dpbmdFdmVudD1xdWV1ZWRMb2dnaW5nRXZlbnRzLnNoaWZ0KCkpKXtiYXRjaGVkTG9nZ2luZ0V2ZW50cy5wdXNoKGN1cnJlbnRMb2dnaW5nRXZlbnQpO31cclxucXVldWVkUmVxdWVzdHMucHVzaChiYXRjaGVkTG9nZ2luZ0V2ZW50cyk7aWYoIXRpbWVkJiYoIXdhaXRGb3JSZXNwb25zZXx8KHdhaXRGb3JSZXNwb25zZSYmIXNlbmRpbmcpKSl7c2VuZEFsbCgpO319fX07ZnVuY3Rpb24gaW5pdCgpe2luaXRpYWxpemVkPXRydWU7aWYoc2VuZEFsbE9uVW5sb2FkKXt2YXIgb2xkQmVmb3JlVW5sb2FkPXdpbmRvdy5vbmJlZm9yZXVubG9hZDt3aW5kb3cub25iZWZvcmV1bmxvYWQ9ZnVuY3Rpb24oKXtpZihvbGRCZWZvcmVVbmxvYWQpe29sZEJlZm9yZVVubG9hZCgpO31cclxuc2VuZEFsbFJlbWFpbmluZygpO307fVxyXG5pZih0aW1lZCl7c2NoZWR1bGVTZW5kaW5nKCk7fX19XHJcbkFqYXhBcHBlbmRlci5wcm90b3R5cGU9bmV3IEFwcGVuZGVyKCk7QWpheEFwcGVuZGVyLnByb3RvdHlwZS5kZWZhdWx0cz17d2FpdEZvclJlc3BvbnNlOmZhbHNlLHRpbWVkOmZhbHNlLHRpbWVySW50ZXJ2YWw6MTAwMCxiYXRjaFNpemU6MSxzZW5kQWxsT25VbmxvYWQ6ZmFsc2UscmVxdWVzdFN1Y2Nlc3NDYWxsYmFjazpudWxsLGZhaWxDYWxsYmFjazpudWxsLHBvc3RWYXJOYW1lOlwiZGF0YVwiLGNvbnRlbnRUeXBlOlwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJ9O0FqYXhBcHBlbmRlci5wcm90b3R5cGUubGF5b3V0PW5ldyBIdHRwUG9zdERhdGFMYXlvdXQoKTtBamF4QXBwZW5kZXIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJBamF4QXBwZW5kZXJcIjt9O2xvZzRqYXZhc2NyaXB0LkFqYXhBcHBlbmRlcj1BamF4QXBwZW5kZXI7ZnVuY3Rpb24gc2V0Q29va2llKG5hbWUsdmFsdWUsZGF5cyxwYXRoKXt2YXIgZXhwaXJlcztwYXRoPXBhdGg/XCI7IHBhdGg9XCIrcGF0aDpcIlwiO2lmKGRheXMpe3ZhciBkYXRlPW5ldyBEYXRlKCk7ZGF0ZS5zZXRUaW1lKGRhdGUuZ2V0VGltZSgpKyhkYXlzKjI0KjYwKjYwKjEwMDApKTtleHBpcmVzPVwiOyBleHBpcmVzPVwiK2RhdGUudG9HTVRTdHJpbmcoKTt9ZWxzZXtleHBpcmVzPVwiXCI7fVxyXG5kb2N1bWVudC5jb29raWU9ZXNjYXBlKG5hbWUpK1wiPVwiK2VzY2FwZSh2YWx1ZSkrZXhwaXJlcytwYXRoO31cclxuZnVuY3Rpb24gZ2V0Q29va2llKG5hbWUpe3ZhciBuYW1lRXF1YWxzPWVzY2FwZShuYW1lKStcIj1cIjt2YXIgY2E9ZG9jdW1lbnQuY29va2llLnNwbGl0KFwiO1wiKTtmb3IodmFyIGk9MCxsZW49Y2EubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGM9Y2FbaV07d2hpbGUoYy5jaGFyQXQoMCk9PT1cIiBcIil7Yz1jLnN1YnN0cmluZygxLGMubGVuZ3RoKTt9XHJcbmlmKGMuaW5kZXhPZihuYW1lRXF1YWxzKT09PTApe3JldHVybiB1bmVzY2FwZShjLnN1YnN0cmluZyhuYW1lRXF1YWxzLmxlbmd0aCxjLmxlbmd0aCkpO319XHJcbnJldHVybiBudWxsO31cclxuZnVuY3Rpb24gZ2V0QmFzZVVybCgpe3ZhciBzY3JpcHRzPWRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKFwic2NyaXB0XCIpO2Zvcih2YXIgaT0wLGxlbj1zY3JpcHRzLmxlbmd0aDtpPGxlbjsrK2kpe2lmKHNjcmlwdHNbaV0uc3JjLmluZGV4T2YoXCJsb2c0amF2YXNjcmlwdFwiKSE9LTEpe3ZhciBsYXN0U2xhc2g9c2NyaXB0c1tpXS5zcmMubGFzdEluZGV4T2YoXCIvXCIpO3JldHVybihsYXN0U2xhc2g9PS0xKT9cIlwiOnNjcmlwdHNbaV0uc3JjLnN1YnN0cigwLGxhc3RTbGFzaCsxKTt9fVxyXG5yZXR1cm4gbnVsbDt9XHJcbmZ1bmN0aW9uIGlzTG9hZGVkKHdpbil7dHJ5e3JldHVybiBib29sKHdpbi5sb2FkZWQpO31jYXRjaChleCl7cmV0dXJuIGZhbHNlO319XHJcbnZhciBDb25zb2xlQXBwZW5kZXI7KGZ1bmN0aW9uKCl7dmFyIGdldENvbnNvbGVIdG1sTGluZXM9ZnVuY3Rpb24oKXtyZXR1cm5bJzwhRE9DVFlQRSBodG1sIFBVQkxJQyBcIi0vL1czQy8vRFREIFhIVE1MIDEuMCBTdHJpY3QvL0VOXCIgXCJodHRwOi8vd3d3LnczLm9yZy9UUi94aHRtbDEvRFREL3hodG1sMS1zdHJpY3QuZHRkXCI+JywnPGh0bWwgeG1sbnM9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIgbGFuZz1cImVuXCIgeG1sOmxhbmc9XCJlblwiPicsJzxoZWFkPicsJzx0aXRsZT5sb2c0amF2YXNjcmlwdDwvdGl0bGU+JywnPG1ldGEgaHR0cC1lcXVpdj1cIkNvbnRlbnQtVHlwZVwiIGNvbnRlbnQ9XCJ0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLThcIiAvPicsJzwhLS0gTWFrZSBJRTggYmVoYXZlIGxpa2UgSUU3LCBoYXZpbmcgZ29uZSB0byBhbGwgdGhlIHRyb3VibGUgb2YgbWFraW5nIElFIHdvcmsgLS0+JywnPG1ldGEgaHR0cC1lcXVpdj1cIlgtVUEtQ29tcGF0aWJsZVwiIGNvbnRlbnQ9XCJJRT03XCIgLz4nLCc8c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj52YXIgaXNJZSA9IGZhbHNlLCBpc0llUHJlNyA9IGZhbHNlOzwvc2NyaXB0PicsJzwhLS1baWYgSUVdPjxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPmlzSWUgPSB0cnVlPC9zY3JpcHQ+PCFbZW5kaWZdLS0+JywnPCEtLVtpZiBsdCBJRSA3XT48c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj5pc0llUHJlNyA9IHRydWU8L3NjcmlwdD48IVtlbmRpZl0tLT4nLCc8c2NyaXB0IHR5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIj4nLCcvLzwhW0NEQVRBWycsJ3ZhciBsb2dnaW5nRW5hYmxlZD10cnVlO3ZhciBsb2dRdWV1ZWRFdmVudHNUaW1lcj1udWxsO3ZhciBsb2dFbnRyaWVzPVtdO3ZhciBsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycz1bXTt2YXIgbG9nSXRlbXM9W107dmFyIHJlbmRlckRlbGF5PTEwMDt2YXIgdW5yZW5kZXJlZExvZ0l0ZW1zRXhpc3Q9ZmFsc2U7dmFyIHJvb3RHcm91cCxjdXJyZW50R3JvdXA9bnVsbDt2YXIgbG9hZGVkPWZhbHNlO3ZhciBjdXJyZW50TG9nSXRlbT1udWxsO3ZhciBsb2dNYWluQ29udGFpbmVyO2Z1bmN0aW9uIGNvcHlQcm9wZXJ0aWVzKG9iaixwcm9wcyl7Zm9yKHZhciBpIGluIHByb3BzKXtvYmpbaV09cHJvcHNbaV07fX0nLCdmdW5jdGlvbiBMb2dJdGVtKCl7fScsJ0xvZ0l0ZW0ucHJvdG90eXBlPXttYWluQ29udGFpbmVyOm51bGwsd3JhcHBlZENvbnRhaW5lcjpudWxsLHVud3JhcHBlZENvbnRhaW5lcjpudWxsLGdyb3VwOm51bGwsYXBwZW5kVG9Mb2c6ZnVuY3Rpb24oKXtmb3IodmFyIGk9MCxsZW49dGhpcy5lbGVtZW50Q29udGFpbmVycy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmVsZW1lbnRDb250YWluZXJzW2ldLmFwcGVuZFRvTG9nKCk7fScsJ3RoaXMuZ3JvdXAudXBkYXRlKCk7fSxkb1JlbW92ZTpmdW5jdGlvbihkb1VwZGF0ZSxyZW1vdmVGcm9tR3JvdXApe2lmKHRoaXMucmVuZGVyZWQpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0ucmVtb3ZlKCk7fScsJ3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1udWxsO3RoaXMud3JhcHBlZEVsZW1lbnRDb250YWluZXI9bnVsbDt0aGlzLm1haW5FbGVtZW50Q29udGFpbmVyPW51bGw7fScsJ2lmKHRoaXMuZ3JvdXAmJnJlbW92ZUZyb21Hcm91cCl7dGhpcy5ncm91cC5yZW1vdmVDaGlsZCh0aGlzLGRvVXBkYXRlKTt9JywnaWYodGhpcz09PWN1cnJlbnRMb2dJdGVtKXtjdXJyZW50TG9nSXRlbT1udWxsO319LHJlbW92ZTpmdW5jdGlvbihkb1VwZGF0ZSxyZW1vdmVGcm9tR3JvdXApe3RoaXMuZG9SZW1vdmUoZG9VcGRhdGUscmVtb3ZlRnJvbUdyb3VwKTt9LHJlbmRlcjpmdW5jdGlvbigpe30sYWNjZXB0OmZ1bmN0aW9uKHZpc2l0b3Ipe3Zpc2l0b3IudmlzaXQodGhpcyk7fSxnZXRVbndyYXBwZWREb21Db250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cC51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyLmNvbnRlbnREaXY7fSxnZXRXcmFwcGVkRG9tQ29udGFpbmVyOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZ3JvdXAud3JhcHBlZEVsZW1lbnRDb250YWluZXIuY29udGVudERpdjt9LGdldE1haW5Eb21Db250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cC5tYWluRWxlbWVudENvbnRhaW5lci5jb250ZW50RGl2O319O0xvZ0l0ZW0uc2VyaWFsaXplZEl0ZW1LZXlzPXtMT0dfRU5UUlk6MCxHUk9VUF9TVEFSVDoxLEdST1VQX0VORDoyfTtmdW5jdGlvbiBMb2dJdGVtQ29udGFpbmVyRWxlbWVudCgpe30nLCdMb2dJdGVtQ29udGFpbmVyRWxlbWVudC5wcm90b3R5cGU9e2FwcGVuZFRvTG9nOmZ1bmN0aW9uKCl7dmFyIGluc2VydEJlZm9yZUZpcnN0PShuZXdlc3RBdFRvcCYmdGhpcy5jb250YWluZXJEb21Ob2RlLmhhc0NoaWxkTm9kZXMoKSk7aWYoaW5zZXJ0QmVmb3JlRmlyc3Qpe3RoaXMuY29udGFpbmVyRG9tTm9kZS5pbnNlcnRCZWZvcmUodGhpcy5tYWluRGl2LHRoaXMuY29udGFpbmVyRG9tTm9kZS5maXJzdENoaWxkKTt9ZWxzZXt0aGlzLmNvbnRhaW5lckRvbU5vZGUuYXBwZW5kQ2hpbGQodGhpcy5tYWluRGl2KTt9fX07ZnVuY3Rpb24gU2VwYXJhdG9yRWxlbWVudENvbnRhaW5lcihjb250YWluZXJEb21Ob2RlKXt0aGlzLmNvbnRhaW5lckRvbU5vZGU9Y29udGFpbmVyRG9tTm9kZTt0aGlzLm1haW5EaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0aGlzLm1haW5EaXYuY2xhc3NOYW1lPVwic2VwYXJhdG9yXCI7dGhpcy5tYWluRGl2LmlubmVySFRNTD1cIiZuYnNwO1wiO30nLCdTZXBhcmF0b3JFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZT1uZXcgTG9nSXRlbUNvbnRhaW5lckVsZW1lbnQoKTtTZXBhcmF0b3JFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aGlzLm1haW5EaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm1haW5EaXYpO3RoaXMubWFpbkRpdj1udWxsO307ZnVuY3Rpb24gU2VwYXJhdG9yKCl7dGhpcy5yZW5kZXJlZD1mYWxzZTt9JywnU2VwYXJhdG9yLnByb3RvdHlwZT1uZXcgTG9nSXRlbSgpO2NvcHlQcm9wZXJ0aWVzKFNlcGFyYXRvci5wcm90b3R5cGUse3JlbmRlcjpmdW5jdGlvbigpe3ZhciBjb250YWluZXJEb21Ob2RlPXRoaXMuZ3JvdXAuY29udGVudERpdjtpZihpc0llKXt0aGlzLnVud3JhcHBlZEVsZW1lbnRDb250YWluZXI9bmV3IFNlcGFyYXRvckVsZW1lbnRDb250YWluZXIodGhpcy5nZXRVbndyYXBwZWREb21Db250YWluZXIoKSk7dGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1uZXcgU2VwYXJhdG9yRWxlbWVudENvbnRhaW5lcih0aGlzLmdldFdyYXBwZWREb21Db250YWluZXIoKSk7dGhpcy5lbGVtZW50Q29udGFpbmVycz1bdGhpcy51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyLHRoaXMud3JhcHBlZEVsZW1lbnRDb250YWluZXJdO31lbHNle3RoaXMubWFpbkVsZW1lbnRDb250YWluZXI9bmV3IFNlcGFyYXRvckVsZW1lbnRDb250YWluZXIodGhpcy5nZXRNYWluRG9tQ29udGFpbmVyKCkpO3RoaXMuZWxlbWVudENvbnRhaW5lcnM9W3RoaXMubWFpbkVsZW1lbnRDb250YWluZXJdO30nLCd0aGlzLmNvbnRlbnQ9dGhpcy5mb3JtYXR0ZWRNZXNzYWdlO3RoaXMucmVuZGVyZWQ9dHJ1ZTt9fSk7ZnVuY3Rpb24gR3JvdXBFbGVtZW50Q29udGFpbmVyKGdyb3VwLGNvbnRhaW5lckRvbU5vZGUsaXNSb290LGlzV3JhcHBlZCl7dGhpcy5ncm91cD1ncm91cDt0aGlzLmNvbnRhaW5lckRvbU5vZGU9Y29udGFpbmVyRG9tTm9kZTt0aGlzLmlzUm9vdD1pc1Jvb3Q7dGhpcy5pc1dyYXBwZWQ9aXNXcmFwcGVkO3RoaXMuZXhwYW5kYWJsZT1mYWxzZTtpZih0aGlzLmlzUm9vdCl7aWYoaXNJZSl7dGhpcy5jb250ZW50RGl2PWxvZ01haW5Db250YWluZXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7dGhpcy5jb250ZW50RGl2LmlkPXRoaXMuaXNXcmFwcGVkP1wibG9nX3dyYXBwZWRcIjpcImxvZ191bndyYXBwZWRcIjt9ZWxzZXt0aGlzLmNvbnRlbnREaXY9bG9nTWFpbkNvbnRhaW5lcjt9fWVsc2V7dmFyIGdyb3VwRWxlbWVudENvbnRhaW5lcj10aGlzO3RoaXMubWFpbkRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubWFpbkRpdi5jbGFzc05hbWU9XCJncm91cFwiO3RoaXMuaGVhZGluZ0Rpdj10aGlzLm1haW5EaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSk7dGhpcy5oZWFkaW5nRGl2LmNsYXNzTmFtZT1cImdyb3VwaGVhZGluZ1wiO3RoaXMuZXhwYW5kZXI9dGhpcy5oZWFkaW5nRGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpKTt0aGlzLmV4cGFuZGVyLmNsYXNzTmFtZT1cImV4cGFuZGVyIHVuc2VsZWN0YWJsZSBncmV5ZWRvdXRcIjt0aGlzLmV4cGFuZGVyLnVuc2VsZWN0YWJsZT10cnVlO3ZhciBleHBhbmRlclRleHQ9dGhpcy5ncm91cC5leHBhbmRlZD9cIi1cIjpcIitcIjt0aGlzLmV4cGFuZGVyVGV4dE5vZGU9dGhpcy5leHBhbmRlci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShleHBhbmRlclRleHQpKTt0aGlzLmhlYWRpbmdEaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCIgXCIrdGhpcy5ncm91cC5uYW1lKSk7dGhpcy5jb250ZW50RGl2PXRoaXMubWFpbkRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTt2YXIgY29udGVudENzc0NsYXNzPXRoaXMuZ3JvdXAuZXhwYW5kZWQ/XCJleHBhbmRlZFwiOlwiY29sbGFwc2VkXCI7dGhpcy5jb250ZW50RGl2LmNsYXNzTmFtZT1cImdyb3VwY29udGVudCBcIitjb250ZW50Q3NzQ2xhc3M7dGhpcy5leHBhbmRlci5vbmNsaWNrPWZ1bmN0aW9uKCl7aWYoZ3JvdXBFbGVtZW50Q29udGFpbmVyLmdyb3VwLmV4cGFuZGFibGUpe2dyb3VwRWxlbWVudENvbnRhaW5lci5ncm91cC50b2dnbGVFeHBhbmRlZCgpO319O319JywnR3JvdXBFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZT1uZXcgTG9nSXRlbUNvbnRhaW5lckVsZW1lbnQoKTtjb3B5UHJvcGVydGllcyhHcm91cEVsZW1lbnRDb250YWluZXIucHJvdG90eXBlLHt0b2dnbGVFeHBhbmRlZDpmdW5jdGlvbigpe2lmKCF0aGlzLmlzUm9vdCl7dmFyIG9sZENzc0NsYXNzLG5ld0Nzc0NsYXNzLGV4cGFuZGVyVGV4dDtpZih0aGlzLmdyb3VwLmV4cGFuZGVkKXtuZXdDc3NDbGFzcz1cImV4cGFuZGVkXCI7b2xkQ3NzQ2xhc3M9XCJjb2xsYXBzZWRcIjtleHBhbmRlclRleHQ9XCItXCI7fWVsc2V7bmV3Q3NzQ2xhc3M9XCJjb2xsYXBzZWRcIjtvbGRDc3NDbGFzcz1cImV4cGFuZGVkXCI7ZXhwYW5kZXJUZXh0PVwiK1wiO30nLCdyZXBsYWNlQ2xhc3ModGhpcy5jb250ZW50RGl2LG5ld0Nzc0NsYXNzLG9sZENzc0NsYXNzKTt0aGlzLmV4cGFuZGVyVGV4dE5vZGUubm9kZVZhbHVlPWV4cGFuZGVyVGV4dDt9fSxyZW1vdmU6ZnVuY3Rpb24oKXtpZighdGhpcy5pc1Jvb3Qpe3RoaXMuaGVhZGluZ0Rpdj1udWxsO3RoaXMuZXhwYW5kZXIub25jbGljaz1udWxsO3RoaXMuZXhwYW5kZXI9bnVsbDt0aGlzLmV4cGFuZGVyVGV4dE5vZGU9bnVsbDt0aGlzLmNvbnRlbnREaXY9bnVsbDt0aGlzLmNvbnRhaW5lckRvbU5vZGU9bnVsbDt0aGlzLm1haW5EaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm1haW5EaXYpO3RoaXMubWFpbkRpdj1udWxsO319LHJldmVyc2VDaGlsZHJlbjpmdW5jdGlvbigpe3ZhciBub2RlPW51bGw7dmFyIGNoaWxkRG9tTm9kZXM9W107d2hpbGUoKG5vZGU9dGhpcy5jb250ZW50RGl2LmZpcnN0Q2hpbGQpKXt0aGlzLmNvbnRlbnREaXYucmVtb3ZlQ2hpbGQobm9kZSk7Y2hpbGREb21Ob2Rlcy5wdXNoKG5vZGUpO30nLCd3aGlsZSgobm9kZT1jaGlsZERvbU5vZGVzLnBvcCgpKSl7dGhpcy5jb250ZW50RGl2LmFwcGVuZENoaWxkKG5vZGUpO319LHVwZGF0ZTpmdW5jdGlvbigpe2lmKCF0aGlzLmlzUm9vdCl7aWYodGhpcy5ncm91cC5leHBhbmRhYmxlKXtyZW1vdmVDbGFzcyh0aGlzLmV4cGFuZGVyLFwiZ3JleWVkb3V0XCIpO31lbHNle2FkZENsYXNzKHRoaXMuZXhwYW5kZXIsXCJncmV5ZWRvdXRcIik7fX19LGNsZWFyOmZ1bmN0aW9uKCl7aWYodGhpcy5pc1Jvb3Qpe3RoaXMuY29udGVudERpdi5pbm5lckhUTUw9XCJcIjt9fX0pO2Z1bmN0aW9uIEdyb3VwKG5hbWUsaXNSb290LGluaXRpYWxseUV4cGFuZGVkKXt0aGlzLm5hbWU9bmFtZTt0aGlzLmdyb3VwPW51bGw7dGhpcy5pc1Jvb3Q9aXNSb290O3RoaXMuaW5pdGlhbGx5RXhwYW5kZWQ9aW5pdGlhbGx5RXhwYW5kZWQ7dGhpcy5lbGVtZW50Q29udGFpbmVycz1bXTt0aGlzLmNoaWxkcmVuPVtdO3RoaXMuZXhwYW5kZWQ9aW5pdGlhbGx5RXhwYW5kZWQ7dGhpcy5yZW5kZXJlZD1mYWxzZTt0aGlzLmV4cGFuZGFibGU9ZmFsc2U7fScsJ0dyb3VwLnByb3RvdHlwZT1uZXcgTG9nSXRlbSgpO2NvcHlQcm9wZXJ0aWVzKEdyb3VwLnByb3RvdHlwZSx7YWRkQ2hpbGQ6ZnVuY3Rpb24obG9nSXRlbSl7dGhpcy5jaGlsZHJlbi5wdXNoKGxvZ0l0ZW0pO2xvZ0l0ZW0uZ3JvdXA9dGhpczt9LHJlbmRlcjpmdW5jdGlvbigpe2lmKGlzSWUpe3ZhciB1bndyYXBwZWREb21Db250YWluZXIsd3JhcHBlZERvbUNvbnRhaW5lcjtpZih0aGlzLmlzUm9vdCl7dW53cmFwcGVkRG9tQ29udGFpbmVyPWxvZ01haW5Db250YWluZXI7d3JhcHBlZERvbUNvbnRhaW5lcj1sb2dNYWluQ29udGFpbmVyO31lbHNle3Vud3JhcHBlZERvbUNvbnRhaW5lcj10aGlzLmdldFVud3JhcHBlZERvbUNvbnRhaW5lcigpO3dyYXBwZWREb21Db250YWluZXI9dGhpcy5nZXRXcmFwcGVkRG9tQ29udGFpbmVyKCk7fScsJ3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1uZXcgR3JvdXBFbGVtZW50Q29udGFpbmVyKHRoaXMsdW53cmFwcGVkRG9tQ29udGFpbmVyLHRoaXMuaXNSb290LGZhbHNlKTt0aGlzLndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW5ldyBHcm91cEVsZW1lbnRDb250YWluZXIodGhpcyx3cmFwcGVkRG9tQ29udGFpbmVyLHRoaXMuaXNSb290LHRydWUpO3RoaXMuZWxlbWVudENvbnRhaW5lcnM9W3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcix0aGlzLndyYXBwZWRFbGVtZW50Q29udGFpbmVyXTt9ZWxzZXt2YXIgbWFpbkRvbUNvbnRhaW5lcj10aGlzLmlzUm9vdD9sb2dNYWluQ29udGFpbmVyOnRoaXMuZ2V0TWFpbkRvbUNvbnRhaW5lcigpO3RoaXMubWFpbkVsZW1lbnRDb250YWluZXI9bmV3IEdyb3VwRWxlbWVudENvbnRhaW5lcih0aGlzLG1haW5Eb21Db250YWluZXIsdGhpcy5pc1Jvb3QsZmFsc2UpO3RoaXMuZWxlbWVudENvbnRhaW5lcnM9W3RoaXMubWFpbkVsZW1lbnRDb250YWluZXJdO30nLCd0aGlzLnJlbmRlcmVkPXRydWU7fSx0b2dnbGVFeHBhbmRlZDpmdW5jdGlvbigpe3RoaXMuZXhwYW5kZWQ9IXRoaXMuZXhwYW5kZWQ7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS50b2dnbGVFeHBhbmRlZCgpO319LGV4cGFuZDpmdW5jdGlvbigpe2lmKCF0aGlzLmV4cGFuZGVkKXt0aGlzLnRvZ2dsZUV4cGFuZGVkKCk7fX0sYWNjZXB0OmZ1bmN0aW9uKHZpc2l0b3Ipe3Zpc2l0b3IudmlzaXRHcm91cCh0aGlzKTt9LHJldmVyc2VDaGlsZHJlbjpmdW5jdGlvbigpe2lmKHRoaXMucmVuZGVyZWQpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0ucmV2ZXJzZUNoaWxkcmVuKCk7fX19LHVwZGF0ZTpmdW5jdGlvbigpe3ZhciBwcmV2aW91c2x5RXhwYW5kYWJsZT10aGlzLmV4cGFuZGFibGU7dGhpcy5leHBhbmRhYmxlPSh0aGlzLmNoaWxkcmVuLmxlbmd0aCE9PTApO2lmKHRoaXMuZXhwYW5kYWJsZSE9PXByZXZpb3VzbHlFeHBhbmRhYmxlKXtmb3IodmFyIGk9MCxsZW49dGhpcy5lbGVtZW50Q29udGFpbmVycy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmVsZW1lbnRDb250YWluZXJzW2ldLnVwZGF0ZSgpO319fSxmbGF0dGVuOmZ1bmN0aW9uKCl7dmFyIHZpc2l0b3I9bmV3IEdyb3VwRmxhdHRlbmVyKCk7dGhpcy5hY2NlcHQodmlzaXRvcik7cmV0dXJuIHZpc2l0b3IubG9nRW50cmllc0FuZFNlcGFyYXRvcnM7fSxyZW1vdmVDaGlsZDpmdW5jdGlvbihjaGlsZCxkb1VwZGF0ZSl7YXJyYXlfcmVtb3ZlKHRoaXMuY2hpbGRyZW4sY2hpbGQpO2NoaWxkLmdyb3VwPW51bGw7aWYoZG9VcGRhdGUpe3RoaXMudXBkYXRlKCk7fX0scmVtb3ZlOmZ1bmN0aW9uKGRvVXBkYXRlLHJlbW92ZUZyb21Hcm91cCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuY2hpbGRyZW4ubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5jaGlsZHJlbltpXS5yZW1vdmUoZmFsc2UsZmFsc2UpO30nLCd0aGlzLmNoaWxkcmVuPVtdO3RoaXMudXBkYXRlKCk7aWYodGhpcz09PWN1cnJlbnRHcm91cCl7Y3VycmVudEdyb3VwPXRoaXMuZ3JvdXA7fScsJ3RoaXMuZG9SZW1vdmUoZG9VcGRhdGUscmVtb3ZlRnJvbUdyb3VwKTt9LHNlcmlhbGl6ZTpmdW5jdGlvbihpdGVtcyl7aXRlbXMucHVzaChbTG9nSXRlbS5zZXJpYWxpemVkSXRlbUtleXMuR1JPVVBfU1RBUlQsdGhpcy5uYW1lXSk7Zm9yKHZhciBpPTAsbGVuPXRoaXMuY2hpbGRyZW4ubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5jaGlsZHJlbltpXS5zZXJpYWxpemUoaXRlbXMpO30nLCdpZih0aGlzIT09Y3VycmVudEdyb3VwKXtpdGVtcy5wdXNoKFtMb2dJdGVtLnNlcmlhbGl6ZWRJdGVtS2V5cy5HUk9VUF9FTkRdKTt9fSxjbGVhcjpmdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0uY2xlYXIoKTt9fX0pO2Z1bmN0aW9uIExvZ0VudHJ5RWxlbWVudENvbnRhaW5lcigpe30nLCdMb2dFbnRyeUVsZW1lbnRDb250YWluZXIucHJvdG90eXBlPW5ldyBMb2dJdGVtQ29udGFpbmVyRWxlbWVudCgpO2NvcHlQcm9wZXJ0aWVzKExvZ0VudHJ5RWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUse3JlbW92ZTpmdW5jdGlvbigpe3RoaXMuZG9SZW1vdmUoKTt9LGRvUmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy5tYWluRGl2LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodGhpcy5tYWluRGl2KTt0aGlzLm1haW5EaXY9bnVsbDt0aGlzLmNvbnRlbnRFbGVtZW50PW51bGw7dGhpcy5jb250YWluZXJEb21Ob2RlPW51bGw7fSxzZXRDb250ZW50OmZ1bmN0aW9uKGNvbnRlbnQsd3JhcHBlZENvbnRlbnQpe2lmKGNvbnRlbnQ9PT10aGlzLmZvcm1hdHRlZE1lc3NhZ2Upe3RoaXMuY29udGVudEVsZW1lbnQuaW5uZXJIVE1MPVwiXCI7dGhpcy5jb250ZW50RWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmZvcm1hdHRlZE1lc3NhZ2UpKTt9ZWxzZXt0aGlzLmNvbnRlbnRFbGVtZW50LmlubmVySFRNTD1jb250ZW50O319LHNldFNlYXJjaE1hdGNoOmZ1bmN0aW9uKGlzTWF0Y2gpe3ZhciBvbGRDc3NDbGFzcz1pc01hdGNoP1wic2VhcmNobm9ubWF0Y2hcIjpcInNlYXJjaG1hdGNoXCI7dmFyIG5ld0Nzc0NsYXNzPWlzTWF0Y2g/XCJzZWFyY2htYXRjaFwiOlwic2VhcmNobm9ubWF0Y2hcIjtyZXBsYWNlQ2xhc3ModGhpcy5tYWluRGl2LG5ld0Nzc0NsYXNzLG9sZENzc0NsYXNzKTt9LGNsZWFyU2VhcmNoOmZ1bmN0aW9uKCl7cmVtb3ZlQ2xhc3ModGhpcy5tYWluRGl2LFwic2VhcmNobWF0Y2hcIik7cmVtb3ZlQ2xhc3ModGhpcy5tYWluRGl2LFwic2VhcmNobm9ubWF0Y2hcIik7fX0pO2Z1bmN0aW9uIExvZ0VudHJ5V3JhcHBlZEVsZW1lbnRDb250YWluZXIobG9nRW50cnksY29udGFpbmVyRG9tTm9kZSl7dGhpcy5sb2dFbnRyeT1sb2dFbnRyeTt0aGlzLmNvbnRhaW5lckRvbU5vZGU9Y29udGFpbmVyRG9tTm9kZTt0aGlzLm1haW5EaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0aGlzLm1haW5EaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5sb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlKSk7dGhpcy5tYWluRGl2LmNsYXNzTmFtZT1cImxvZ2VudHJ5IHdyYXBwZWQgXCIrdGhpcy5sb2dFbnRyeS5sZXZlbDt0aGlzLmNvbnRlbnRFbGVtZW50PXRoaXMubWFpbkRpdjt9JywnTG9nRW50cnlXcmFwcGVkRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGU9bmV3IExvZ0VudHJ5RWxlbWVudENvbnRhaW5lcigpO0xvZ0VudHJ5V3JhcHBlZEVsZW1lbnRDb250YWluZXIucHJvdG90eXBlLnNldENvbnRlbnQ9ZnVuY3Rpb24oY29udGVudCx3cmFwcGVkQ29udGVudCl7aWYoY29udGVudD09PXRoaXMuZm9ybWF0dGVkTWVzc2FnZSl7dGhpcy5jb250ZW50RWxlbWVudC5pbm5lckhUTUw9XCJcIjt0aGlzLmNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuZm9ybWF0dGVkTWVzc2FnZSkpO31lbHNle3RoaXMuY29udGVudEVsZW1lbnQuaW5uZXJIVE1MPXdyYXBwZWRDb250ZW50O319O2Z1bmN0aW9uIExvZ0VudHJ5VW53cmFwcGVkRWxlbWVudENvbnRhaW5lcihsb2dFbnRyeSxjb250YWluZXJEb21Ob2RlKXt0aGlzLmxvZ0VudHJ5PWxvZ0VudHJ5O3RoaXMuY29udGFpbmVyRG9tTm9kZT1jb250YWluZXJEb21Ob2RlO3RoaXMubWFpbkRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubWFpbkRpdi5jbGFzc05hbWU9XCJsb2dlbnRyeSB1bndyYXBwZWQgXCIrdGhpcy5sb2dFbnRyeS5sZXZlbDt0aGlzLnByZT10aGlzLm1haW5EaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInByZVwiKSk7dGhpcy5wcmUuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5sb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlKSk7dGhpcy5wcmUuY2xhc3NOYW1lPVwidW53cmFwcGVkXCI7dGhpcy5jb250ZW50RWxlbWVudD10aGlzLnByZTt9JywnTG9nRW50cnlVbndyYXBwZWRFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZT1uZXcgTG9nRW50cnlFbGVtZW50Q29udGFpbmVyKCk7TG9nRW50cnlVbndyYXBwZWRFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXt0aGlzLmRvUmVtb3ZlKCk7dGhpcy5wcmU9bnVsbDt9O2Z1bmN0aW9uIExvZ0VudHJ5TWFpbkVsZW1lbnRDb250YWluZXIobG9nRW50cnksY29udGFpbmVyRG9tTm9kZSl7dGhpcy5sb2dFbnRyeT1sb2dFbnRyeTt0aGlzLmNvbnRhaW5lckRvbU5vZGU9Y29udGFpbmVyRG9tTm9kZTt0aGlzLm1haW5EaXY9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTt0aGlzLm1haW5EaXYuY2xhc3NOYW1lPVwibG9nZW50cnkgbm9uaWVsb2dlbnRyeSBcIit0aGlzLmxvZ0VudHJ5LmxldmVsO3RoaXMuY29udGVudEVsZW1lbnQ9dGhpcy5tYWluRGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpKTt0aGlzLmNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMubG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZSkpO30nLCdMb2dFbnRyeU1haW5FbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZT1uZXcgTG9nRW50cnlFbGVtZW50Q29udGFpbmVyKCk7ZnVuY3Rpb24gTG9nRW50cnkobGV2ZWwsZm9ybWF0dGVkTWVzc2FnZSl7dGhpcy5sZXZlbD1sZXZlbDt0aGlzLmZvcm1hdHRlZE1lc3NhZ2U9Zm9ybWF0dGVkTWVzc2FnZTt0aGlzLnJlbmRlcmVkPWZhbHNlO30nLCdMb2dFbnRyeS5wcm90b3R5cGU9bmV3IExvZ0l0ZW0oKTtjb3B5UHJvcGVydGllcyhMb2dFbnRyeS5wcm90b3R5cGUse3JlbmRlcjpmdW5jdGlvbigpe3ZhciBsb2dFbnRyeT10aGlzO3ZhciBjb250YWluZXJEb21Ob2RlPXRoaXMuZ3JvdXAuY29udGVudERpdjtpZihpc0llKXt0aGlzLmZvcm1hdHRlZE1lc3NhZ2U9dGhpcy5mb3JtYXR0ZWRNZXNzYWdlLnJlcGxhY2UoL1xcXFxyXFxcXG4vZyxcIlxcXFxyXCIpO3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1uZXcgTG9nRW50cnlVbndyYXBwZWRFbGVtZW50Q29udGFpbmVyKHRoaXMsdGhpcy5nZXRVbndyYXBwZWREb21Db250YWluZXIoKSk7dGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1uZXcgTG9nRW50cnlXcmFwcGVkRWxlbWVudENvbnRhaW5lcih0aGlzLHRoaXMuZ2V0V3JhcHBlZERvbUNvbnRhaW5lcigpKTt0aGlzLmVsZW1lbnRDb250YWluZXJzPVt0aGlzLnVud3JhcHBlZEVsZW1lbnRDb250YWluZXIsdGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lcl07fWVsc2V7dGhpcy5tYWluRWxlbWVudENvbnRhaW5lcj1uZXcgTG9nRW50cnlNYWluRWxlbWVudENvbnRhaW5lcih0aGlzLHRoaXMuZ2V0TWFpbkRvbUNvbnRhaW5lcigpKTt0aGlzLmVsZW1lbnRDb250YWluZXJzPVt0aGlzLm1haW5FbGVtZW50Q29udGFpbmVyXTt9JywndGhpcy5jb250ZW50PXRoaXMuZm9ybWF0dGVkTWVzc2FnZTt0aGlzLnJlbmRlcmVkPXRydWU7fSxzZXRDb250ZW50OmZ1bmN0aW9uKGNvbnRlbnQsd3JhcHBlZENvbnRlbnQpe2lmKGNvbnRlbnQhPXRoaXMuY29udGVudCl7aWYoaXNJZSYmKGNvbnRlbnQhPT10aGlzLmZvcm1hdHRlZE1lc3NhZ2UpKXtjb250ZW50PWNvbnRlbnQucmVwbGFjZSgvXFxcXHJcXFxcbi9nLFwiXFxcXHJcIik7fScsJ2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0uc2V0Q29udGVudChjb250ZW50LHdyYXBwZWRDb250ZW50KTt9JywndGhpcy5jb250ZW50PWNvbnRlbnQ7fX0sZ2V0U2VhcmNoTWF0Y2hlczpmdW5jdGlvbigpe3ZhciBtYXRjaGVzPVtdO3ZhciBpLGxlbjtpZihpc0llKXt2YXIgdW53cmFwcGVkRWxzPWdldEVsZW1lbnRzQnlDbGFzcyh0aGlzLnVud3JhcHBlZEVsZW1lbnRDb250YWluZXIubWFpbkRpdixcInNlYXJjaHRlcm1cIixcInNwYW5cIik7dmFyIHdyYXBwZWRFbHM9Z2V0RWxlbWVudHNCeUNsYXNzKHRoaXMud3JhcHBlZEVsZW1lbnRDb250YWluZXIubWFpbkRpdixcInNlYXJjaHRlcm1cIixcInNwYW5cIik7Zm9yKGk9MCxsZW49dW53cmFwcGVkRWxzLmxlbmd0aDtpPGxlbjtpKyspe21hdGNoZXNbaV09bmV3IE1hdGNoKHRoaXMubGV2ZWwsbnVsbCx1bndyYXBwZWRFbHNbaV0sd3JhcHBlZEVsc1tpXSk7fX1lbHNle3ZhciBlbHM9Z2V0RWxlbWVudHNCeUNsYXNzKHRoaXMubWFpbkVsZW1lbnRDb250YWluZXIubWFpbkRpdixcInNlYXJjaHRlcm1cIixcInNwYW5cIik7Zm9yKGk9MCxsZW49ZWxzLmxlbmd0aDtpPGxlbjtpKyspe21hdGNoZXNbaV09bmV3IE1hdGNoKHRoaXMubGV2ZWwsZWxzW2ldKTt9fScsJ3JldHVybiBtYXRjaGVzO30sc2V0U2VhcmNoTWF0Y2g6ZnVuY3Rpb24oaXNNYXRjaCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5zZXRTZWFyY2hNYXRjaChpc01hdGNoKTt9fSxjbGVhclNlYXJjaDpmdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0uY2xlYXJTZWFyY2goKTt9fSxhY2NlcHQ6ZnVuY3Rpb24odmlzaXRvcil7dmlzaXRvci52aXNpdExvZ0VudHJ5KHRoaXMpO30sc2VyaWFsaXplOmZ1bmN0aW9uKGl0ZW1zKXtpdGVtcy5wdXNoKFtMb2dJdGVtLnNlcmlhbGl6ZWRJdGVtS2V5cy5MT0dfRU5UUlksdGhpcy5sZXZlbCx0aGlzLmZvcm1hdHRlZE1lc3NhZ2VdKTt9fSk7ZnVuY3Rpb24gTG9nSXRlbVZpc2l0b3IoKXt9JywnTG9nSXRlbVZpc2l0b3IucHJvdG90eXBlPXt2aXNpdDpmdW5jdGlvbihsb2dJdGVtKXt9LHZpc2l0UGFyZW50OmZ1bmN0aW9uKGxvZ0l0ZW0pe2lmKGxvZ0l0ZW0uZ3JvdXApe2xvZ0l0ZW0uZ3JvdXAuYWNjZXB0KHRoaXMpO319LHZpc2l0Q2hpbGRyZW46ZnVuY3Rpb24obG9nSXRlbSl7Zm9yKHZhciBpPTAsbGVuPWxvZ0l0ZW0uY2hpbGRyZW4ubGVuZ3RoO2k8bGVuO2krKyl7bG9nSXRlbS5jaGlsZHJlbltpXS5hY2NlcHQodGhpcyk7fX0sdmlzaXRMb2dFbnRyeTpmdW5jdGlvbihsb2dFbnRyeSl7dGhpcy52aXNpdChsb2dFbnRyeSk7fSx2aXNpdFNlcGFyYXRvcjpmdW5jdGlvbihzZXBhcmF0b3Ipe3RoaXMudmlzaXQoc2VwYXJhdG9yKTt9LHZpc2l0R3JvdXA6ZnVuY3Rpb24oZ3JvdXApe3RoaXMudmlzaXQoZ3JvdXApO319O2Z1bmN0aW9uIEdyb3VwRmxhdHRlbmVyKCl7dGhpcy5sb2dFbnRyaWVzQW5kU2VwYXJhdG9ycz1bXTt9JywnR3JvdXBGbGF0dGVuZXIucHJvdG90eXBlPW5ldyBMb2dJdGVtVmlzaXRvcigpO0dyb3VwRmxhdHRlbmVyLnByb3RvdHlwZS52aXNpdEdyb3VwPWZ1bmN0aW9uKGdyb3VwKXt0aGlzLnZpc2l0Q2hpbGRyZW4oZ3JvdXApO307R3JvdXBGbGF0dGVuZXIucHJvdG90eXBlLnZpc2l0TG9nRW50cnk9ZnVuY3Rpb24obG9nRW50cnkpe3RoaXMubG9nRW50cmllc0FuZFNlcGFyYXRvcnMucHVzaChsb2dFbnRyeSk7fTtHcm91cEZsYXR0ZW5lci5wcm90b3R5cGUudmlzaXRTZXBhcmF0b3I9ZnVuY3Rpb24oc2VwYXJhdG9yKXt0aGlzLmxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzLnB1c2goc2VwYXJhdG9yKTt9O3dpbmRvdy5vbmxvYWQ9ZnVuY3Rpb24oKXtpZihsb2NhdGlvbi5zZWFyY2gpe3ZhciBxdWVyeUJpdHM9dW5lc2NhcGUobG9jYXRpb24uc2VhcmNoKS5zdWJzdHIoMSkuc3BsaXQoXCImXCIpLG5hbWVWYWx1ZUJpdHM7Zm9yKHZhciBpPTAsbGVuPXF1ZXJ5Qml0cy5sZW5ndGg7aTxsZW47aSsrKXtuYW1lVmFsdWVCaXRzPXF1ZXJ5Qml0c1tpXS5zcGxpdChcIj1cIik7aWYobmFtZVZhbHVlQml0c1swXT09XCJsb2c0amF2YXNjcmlwdF9kb21haW5cIil7ZG9jdW1lbnQuZG9tYWluPW5hbWVWYWx1ZUJpdHNbMV07YnJlYWs7fX19JywnbG9nTWFpbkNvbnRhaW5lcj0kKFwibG9nXCIpO2lmKGlzSWVQcmU3KXthZGRDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwib2xkSWVcIik7fScsJ3Jvb3RHcm91cD1uZXcgR3JvdXAoXCJyb290XCIsdHJ1ZSk7cm9vdEdyb3VwLnJlbmRlcigpO2N1cnJlbnRHcm91cD1yb290R3JvdXA7c2V0Q29tbWFuZElucHV0V2lkdGgoKTtzZXRMb2dDb250YWluZXJIZWlnaHQoKTt0b2dnbGVMb2dnaW5nRW5hYmxlZCgpO3RvZ2dsZVNlYXJjaEVuYWJsZWQoKTt0b2dnbGVTZWFyY2hGaWx0ZXIoKTt0b2dnbGVTZWFyY2hIaWdobGlnaHQoKTthcHBseUZpbHRlcnMoKTtjaGVja0FsbExldmVscygpO3RvZ2dsZVdyYXAoKTt0b2dnbGVOZXdlc3RBdFRvcCgpO3RvZ2dsZVNjcm9sbFRvTGF0ZXN0KCk7cmVuZGVyUXVldWVkTG9nSXRlbXMoKTtsb2FkZWQ9dHJ1ZTskKFwiY29tbWFuZFwiKS52YWx1ZT1cIlwiOyQoXCJjb21tYW5kXCIpLmF1dG9jb21wbGV0ZT1cIm9mZlwiOyQoXCJjb21tYW5kXCIpLm9ua2V5ZG93bj1mdW5jdGlvbihldnQpe2V2dD1nZXRFdmVudChldnQpO2lmKGV2dC5rZXlDb2RlPT0xMHx8ZXZ0LmtleUNvZGU9PTEzKXtldmFsQ29tbWFuZExpbmUoKTtzdG9wUHJvcGFnYXRpb24oZXZ0KTt9ZWxzZSBpZihldnQua2V5Q29kZT09Mjcpe3RoaXMudmFsdWU9XCJcIjt0aGlzLmZvY3VzKCk7fWVsc2UgaWYoZXZ0LmtleUNvZGU9PTM4JiZjb21tYW5kSGlzdG9yeS5sZW5ndGg+MCl7Y3VycmVudENvbW1hbmRJbmRleD1NYXRoLm1heCgwLGN1cnJlbnRDb21tYW5kSW5kZXgtMSk7dGhpcy52YWx1ZT1jb21tYW5kSGlzdG9yeVtjdXJyZW50Q29tbWFuZEluZGV4XTttb3ZlQ2FyZXRUb0VuZCh0aGlzKTt9ZWxzZSBpZihldnQua2V5Q29kZT09NDAmJmNvbW1hbmRIaXN0b3J5Lmxlbmd0aD4wKXtjdXJyZW50Q29tbWFuZEluZGV4PU1hdGgubWluKGNvbW1hbmRIaXN0b3J5Lmxlbmd0aC0xLGN1cnJlbnRDb21tYW5kSW5kZXgrMSk7dGhpcy52YWx1ZT1jb21tYW5kSGlzdG9yeVtjdXJyZW50Q29tbWFuZEluZGV4XTttb3ZlQ2FyZXRUb0VuZCh0aGlzKTt9fTskKFwiY29tbWFuZFwiKS5vbmtleXByZXNzPWZ1bmN0aW9uKGV2dCl7ZXZ0PWdldEV2ZW50KGV2dCk7aWYoZXZ0LmtleUNvZGU9PTM4JiZjb21tYW5kSGlzdG9yeS5sZW5ndGg+MCYmZXZ0LnByZXZlbnREZWZhdWx0KXtldnQucHJldmVudERlZmF1bHQoKTt9fTskKFwiY29tbWFuZFwiKS5vbmtleXVwPWZ1bmN0aW9uKGV2dCl7ZXZ0PWdldEV2ZW50KGV2dCk7aWYoZXZ0LmtleUNvZGU9PTI3JiZldnQucHJldmVudERlZmF1bHQpe2V2dC5wcmV2ZW50RGVmYXVsdCgpO3RoaXMuZm9jdXMoKTt9fTtkb2N1bWVudC5vbmtleWRvd249ZnVuY3Rpb24ga2V5RXZlbnRIYW5kbGVyKGV2dCl7ZXZ0PWdldEV2ZW50KGV2dCk7c3dpdGNoKGV2dC5rZXlDb2RlKXtjYXNlIDY5OmlmKGV2dC5zaGlmdEtleSYmKGV2dC5jdHJsS2V5fHxldnQubWV0YUtleSkpe2V2YWxMYXN0Q29tbWFuZCgpO2NhbmNlbEtleUV2ZW50KGV2dCk7cmV0dXJuIGZhbHNlO30nLCdicmVhaztjYXNlIDc1OmlmKGV2dC5zaGlmdEtleSYmKGV2dC5jdHJsS2V5fHxldnQubWV0YUtleSkpe2ZvY3VzU2VhcmNoKCk7Y2FuY2VsS2V5RXZlbnQoZXZ0KTtyZXR1cm4gZmFsc2U7fScsJ2JyZWFrO2Nhc2UgNDA6Y2FzZSA3NjppZihldnQuc2hpZnRLZXkmJihldnQuY3RybEtleXx8ZXZ0Lm1ldGFLZXkpKXtmb2N1c0NvbW1hbmRMaW5lKCk7Y2FuY2VsS2V5RXZlbnQoZXZ0KTtyZXR1cm4gZmFsc2U7fScsJ2JyZWFrO319O3NldFRpbWVvdXQoc2V0TG9nQ29udGFpbmVySGVpZ2h0LDIwKTtzZXRTaG93Q29tbWFuZExpbmUoc2hvd0NvbW1hbmRMaW5lKTtkb1NlYXJjaCgpO307d2luZG93Lm9udW5sb2FkPWZ1bmN0aW9uKCl7aWYobWFpbldpbmRvd0V4aXN0cygpKXthcHBlbmRlci51bmxvYWQoKTt9JywnYXBwZW5kZXI9bnVsbDt9O2Z1bmN0aW9uIHRvZ2dsZUxvZ2dpbmdFbmFibGVkKCl7c2V0TG9nZ2luZ0VuYWJsZWQoJChcImVuYWJsZUxvZ2dpbmdcIikuY2hlY2tlZCk7fScsJ2Z1bmN0aW9uIHNldExvZ2dpbmdFbmFibGVkKGVuYWJsZSl7bG9nZ2luZ0VuYWJsZWQ9ZW5hYmxlO30nLCd2YXIgYXBwZW5kZXI9bnVsbDtmdW5jdGlvbiBzZXRBcHBlbmRlcihhcHBlbmRlclBhcmFtKXthcHBlbmRlcj1hcHBlbmRlclBhcmFtO30nLCdmdW5jdGlvbiBzZXRTaG93Q2xvc2VCdXR0b24oc2hvd0Nsb3NlQnV0dG9uKXskKFwiY2xvc2VCdXR0b25cIikuc3R5bGUuZGlzcGxheT1zaG93Q2xvc2VCdXR0b24/XCJpbmxpbmVcIjpcIm5vbmVcIjt9JywnZnVuY3Rpb24gc2V0U2hvd0hpZGVCdXR0b24oc2hvd0hpZGVCdXR0b24peyQoXCJoaWRlQnV0dG9uXCIpLnN0eWxlLmRpc3BsYXk9c2hvd0hpZGVCdXR0b24/XCJpbmxpbmVcIjpcIm5vbmVcIjt9JywndmFyIG5ld2VzdEF0VG9wPWZhbHNlO2Z1bmN0aW9uIExvZ0l0ZW1Db250ZW50UmV2ZXJzZXIoKXt9JywnTG9nSXRlbUNvbnRlbnRSZXZlcnNlci5wcm90b3R5cGU9bmV3IExvZ0l0ZW1WaXNpdG9yKCk7TG9nSXRlbUNvbnRlbnRSZXZlcnNlci5wcm90b3R5cGUudmlzaXRHcm91cD1mdW5jdGlvbihncm91cCl7Z3JvdXAucmV2ZXJzZUNoaWxkcmVuKCk7dGhpcy52aXNpdENoaWxkcmVuKGdyb3VwKTt9O2Z1bmN0aW9uIHNldE5ld2VzdEF0VG9wKGlzTmV3ZXN0QXRUb3Ape3ZhciBvbGROZXdlc3RBdFRvcD1uZXdlc3RBdFRvcDt2YXIgaSxpTGVuLGosakxlbjtuZXdlc3RBdFRvcD1Cb29sZWFuKGlzTmV3ZXN0QXRUb3ApO2lmKG9sZE5ld2VzdEF0VG9wIT1uZXdlc3RBdFRvcCl7dmFyIHZpc2l0b3I9bmV3IExvZ0l0ZW1Db250ZW50UmV2ZXJzZXIoKTtyb290R3JvdXAuYWNjZXB0KHZpc2l0b3IpO2lmKGN1cnJlbnRTZWFyY2gpe3ZhciBjdXJyZW50TWF0Y2g9Y3VycmVudFNlYXJjaC5tYXRjaGVzW2N1cnJlbnRNYXRjaEluZGV4XTt2YXIgbWF0Y2hJbmRleD0wO3ZhciBtYXRjaGVzPVtdO3ZhciBhY3RPbkxvZ0VudHJ5PWZ1bmN0aW9uKGxvZ0VudHJ5KXt2YXIgbG9nRW50cnlNYXRjaGVzPWxvZ0VudHJ5LmdldFNlYXJjaE1hdGNoZXMoKTtmb3Ioaj0wLGpMZW49bG9nRW50cnlNYXRjaGVzLmxlbmd0aDtqPGpMZW47aisrKXttYXRjaGVzW21hdGNoSW5kZXhdPWxvZ0VudHJ5TWF0Y2hlc1tqXTtpZihjdXJyZW50TWF0Y2gmJmxvZ0VudHJ5TWF0Y2hlc1tqXS5lcXVhbHMoY3VycmVudE1hdGNoKSl7Y3VycmVudE1hdGNoSW5kZXg9bWF0Y2hJbmRleDt9JywnbWF0Y2hJbmRleCsrO319O2lmKG5ld2VzdEF0VG9wKXtmb3IoaT1sb2dFbnRyaWVzLmxlbmd0aC0xO2k+PTA7aS0tKXthY3RPbkxvZ0VudHJ5KGxvZ0VudHJpZXNbaV0pO319ZWxzZXtmb3IoaT0wLGlMZW49bG9nRW50cmllcy5sZW5ndGg7aTxpTGVuO2krKyl7YWN0T25Mb2dFbnRyeShsb2dFbnRyaWVzW2ldKTt9fScsJ2N1cnJlbnRTZWFyY2gubWF0Y2hlcz1tYXRjaGVzO2lmKGN1cnJlbnRNYXRjaCl7Y3VycmVudE1hdGNoLnNldEN1cnJlbnQoKTt9fWVsc2UgaWYoc2Nyb2xsVG9MYXRlc3Qpe2RvU2Nyb2xsVG9MYXRlc3QoKTt9fScsJyQoXCJuZXdlc3RBdFRvcFwiKS5jaGVja2VkPWlzTmV3ZXN0QXRUb3A7fScsJ2Z1bmN0aW9uIHRvZ2dsZU5ld2VzdEF0VG9wKCl7dmFyIGlzTmV3ZXN0QXRUb3A9JChcIm5ld2VzdEF0VG9wXCIpLmNoZWNrZWQ7c2V0TmV3ZXN0QXRUb3AoaXNOZXdlc3RBdFRvcCk7fScsJ3ZhciBzY3JvbGxUb0xhdGVzdD10cnVlO2Z1bmN0aW9uIHNldFNjcm9sbFRvTGF0ZXN0KGlzU2Nyb2xsVG9MYXRlc3Qpe3Njcm9sbFRvTGF0ZXN0PWlzU2Nyb2xsVG9MYXRlc3Q7aWYoc2Nyb2xsVG9MYXRlc3Qpe2RvU2Nyb2xsVG9MYXRlc3QoKTt9JywnJChcInNjcm9sbFRvTGF0ZXN0XCIpLmNoZWNrZWQ9aXNTY3JvbGxUb0xhdGVzdDt9JywnZnVuY3Rpb24gdG9nZ2xlU2Nyb2xsVG9MYXRlc3QoKXt2YXIgaXNTY3JvbGxUb0xhdGVzdD0kKFwic2Nyb2xsVG9MYXRlc3RcIikuY2hlY2tlZDtzZXRTY3JvbGxUb0xhdGVzdChpc1Njcm9sbFRvTGF0ZXN0KTt9JywnZnVuY3Rpb24gZG9TY3JvbGxUb0xhdGVzdCgpe3ZhciBsPWxvZ01haW5Db250YWluZXI7aWYodHlwZW9mIGwuc2Nyb2xsVG9wIT1cInVuZGVmaW5lZFwiKXtpZihuZXdlc3RBdFRvcCl7bC5zY3JvbGxUb3A9MDt9ZWxzZXt2YXIgbGF0ZXN0TG9nRW50cnk9bC5sYXN0Q2hpbGQ7aWYobGF0ZXN0TG9nRW50cnkpe2wuc2Nyb2xsVG9wPWwuc2Nyb2xsSGVpZ2h0O319fX0nLCd2YXIgY2xvc2VJZk9wZW5lckNsb3Nlcz10cnVlO2Z1bmN0aW9uIHNldENsb3NlSWZPcGVuZXJDbG9zZXMoaXNDbG9zZUlmT3BlbmVyQ2xvc2VzKXtjbG9zZUlmT3BlbmVyQ2xvc2VzPWlzQ2xvc2VJZk9wZW5lckNsb3Nlczt9JywndmFyIG1heE1lc3NhZ2VzPW51bGw7ZnVuY3Rpb24gc2V0TWF4TWVzc2FnZXMobWF4KXttYXhNZXNzYWdlcz1tYXg7cHJ1bmVMb2dFbnRyaWVzKCk7fScsJ3ZhciBzaG93Q29tbWFuZExpbmU9ZmFsc2U7ZnVuY3Rpb24gc2V0U2hvd0NvbW1hbmRMaW5lKGlzU2hvd0NvbW1hbmRMaW5lKXtzaG93Q29tbWFuZExpbmU9aXNTaG93Q29tbWFuZExpbmU7aWYobG9hZGVkKXskKFwiY29tbWFuZExpbmVcIikuc3R5bGUuZGlzcGxheT1zaG93Q29tbWFuZExpbmU/XCJibG9ja1wiOlwibm9uZVwiO3NldENvbW1hbmRJbnB1dFdpZHRoKCk7c2V0TG9nQ29udGFpbmVySGVpZ2h0KCk7fX0nLCdmdW5jdGlvbiBmb2N1c0NvbW1hbmRMaW5lKCl7aWYobG9hZGVkKXskKFwiY29tbWFuZFwiKS5mb2N1cygpO319JywnZnVuY3Rpb24gZm9jdXNTZWFyY2goKXtpZihsb2FkZWQpeyQoXCJzZWFyY2hCb3hcIikuZm9jdXMoKTt9fScsJ2Z1bmN0aW9uIGdldExvZ0l0ZW1zKCl7dmFyIGl0ZW1zPVtdO2Zvcih2YXIgaT0wLGxlbj1sb2dJdGVtcy5sZW5ndGg7aTxsZW47aSsrKXtsb2dJdGVtc1tpXS5zZXJpYWxpemUoaXRlbXMpO30nLCdyZXR1cm4gaXRlbXM7fScsJ2Z1bmN0aW9uIHNldExvZ0l0ZW1zKGl0ZW1zKXt2YXIgbG9nZ2luZ1JlYWxseUVuYWJsZWQ9bG9nZ2luZ0VuYWJsZWQ7bG9nZ2luZ0VuYWJsZWQ9dHJ1ZTtmb3IodmFyIGk9MCxsZW49aXRlbXMubGVuZ3RoO2k8bGVuO2krKyl7c3dpdGNoKGl0ZW1zW2ldWzBdKXtjYXNlIExvZ0l0ZW0uc2VyaWFsaXplZEl0ZW1LZXlzLkxPR19FTlRSWTpsb2coaXRlbXNbaV1bMV0saXRlbXNbaV1bMl0pO2JyZWFrO2Nhc2UgTG9nSXRlbS5zZXJpYWxpemVkSXRlbUtleXMuR1JPVVBfU1RBUlQ6Z3JvdXAoaXRlbXNbaV1bMV0pO2JyZWFrO2Nhc2UgTG9nSXRlbS5zZXJpYWxpemVkSXRlbUtleXMuR1JPVVBfRU5EOmdyb3VwRW5kKCk7YnJlYWs7fX0nLCdsb2dnaW5nRW5hYmxlZD1sb2dnaW5nUmVhbGx5RW5hYmxlZDt9JywnZnVuY3Rpb24gbG9nKGxvZ0xldmVsLGZvcm1hdHRlZE1lc3NhZ2Upe2lmKGxvZ2dpbmdFbmFibGVkKXt2YXIgbG9nRW50cnk9bmV3IExvZ0VudHJ5KGxvZ0xldmVsLGZvcm1hdHRlZE1lc3NhZ2UpO2xvZ0VudHJpZXMucHVzaChsb2dFbnRyeSk7bG9nRW50cmllc0FuZFNlcGFyYXRvcnMucHVzaChsb2dFbnRyeSk7bG9nSXRlbXMucHVzaChsb2dFbnRyeSk7Y3VycmVudEdyb3VwLmFkZENoaWxkKGxvZ0VudHJ5KTtpZihsb2FkZWQpe2lmKGxvZ1F1ZXVlZEV2ZW50c1RpbWVyIT09bnVsbCl7Y2xlYXJUaW1lb3V0KGxvZ1F1ZXVlZEV2ZW50c1RpbWVyKTt9JywnbG9nUXVldWVkRXZlbnRzVGltZXI9c2V0VGltZW91dChyZW5kZXJRdWV1ZWRMb2dJdGVtcyxyZW5kZXJEZWxheSk7dW5yZW5kZXJlZExvZ0l0ZW1zRXhpc3Q9dHJ1ZTt9fX0nLCdmdW5jdGlvbiByZW5kZXJRdWV1ZWRMb2dJdGVtcygpe2xvZ1F1ZXVlZEV2ZW50c1RpbWVyPW51bGw7dmFyIHBydW5lZD1wcnVuZUxvZ0VudHJpZXMoKTt2YXIgaW5pdGlhbGx5SGFzTWF0Y2hlcz1jdXJyZW50U2VhcmNoP2N1cnJlbnRTZWFyY2guaGFzTWF0Y2hlcygpOmZhbHNlO2Zvcih2YXIgaT0wLGxlbj1sb2dJdGVtcy5sZW5ndGg7aTxsZW47aSsrKXtpZighbG9nSXRlbXNbaV0ucmVuZGVyZWQpe2xvZ0l0ZW1zW2ldLnJlbmRlcigpO2xvZ0l0ZW1zW2ldLmFwcGVuZFRvTG9nKCk7aWYoY3VycmVudFNlYXJjaCYmKGxvZ0l0ZW1zW2ldaW5zdGFuY2VvZiBMb2dFbnRyeSkpe2N1cnJlbnRTZWFyY2guYXBwbHlUbyhsb2dJdGVtc1tpXSk7fX19JywnaWYoY3VycmVudFNlYXJjaCl7aWYocHJ1bmVkKXtpZihjdXJyZW50U2VhcmNoLmhhc1Zpc2libGVNYXRjaGVzKCkpe2lmKGN1cnJlbnRNYXRjaEluZGV4PT09bnVsbCl7c2V0Q3VycmVudE1hdGNoSW5kZXgoMCk7fScsJ2Rpc3BsYXlNYXRjaGVzKCk7fWVsc2V7ZGlzcGxheU5vTWF0Y2hlcygpO319ZWxzZSBpZighaW5pdGlhbGx5SGFzTWF0Y2hlcyYmY3VycmVudFNlYXJjaC5oYXNWaXNpYmxlTWF0Y2hlcygpKXtzZXRDdXJyZW50TWF0Y2hJbmRleCgwKTtkaXNwbGF5TWF0Y2hlcygpO319JywnaWYoc2Nyb2xsVG9MYXRlc3Qpe2RvU2Nyb2xsVG9MYXRlc3QoKTt9JywndW5yZW5kZXJlZExvZ0l0ZW1zRXhpc3Q9ZmFsc2U7fScsJ2Z1bmN0aW9uIHBydW5lTG9nRW50cmllcygpe2lmKChtYXhNZXNzYWdlcyE9PW51bGwpJiYobG9nRW50cmllc0FuZFNlcGFyYXRvcnMubGVuZ3RoPm1heE1lc3NhZ2VzKSl7dmFyIG51bWJlclRvRGVsZXRlPWxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzLmxlbmd0aC1tYXhNZXNzYWdlczt2YXIgcHJ1bmVkTG9nRW50cmllcz1sb2dFbnRyaWVzQW5kU2VwYXJhdG9ycy5zbGljZSgwLG51bWJlclRvRGVsZXRlKTtpZihjdXJyZW50U2VhcmNoKXtjdXJyZW50U2VhcmNoLnJlbW92ZU1hdGNoZXMocHJ1bmVkTG9nRW50cmllcyk7fScsJ3ZhciBncm91cDtmb3IodmFyIGk9MDtpPG51bWJlclRvRGVsZXRlO2krKyl7Z3JvdXA9bG9nRW50cmllc0FuZFNlcGFyYXRvcnNbaV0uZ3JvdXA7YXJyYXlfcmVtb3ZlKGxvZ0l0ZW1zLGxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzW2ldKTthcnJheV9yZW1vdmUobG9nRW50cmllcyxsb2dFbnRyaWVzQW5kU2VwYXJhdG9yc1tpXSk7bG9nRW50cmllc0FuZFNlcGFyYXRvcnNbaV0ucmVtb3ZlKHRydWUsdHJ1ZSk7aWYoZ3JvdXAuY2hpbGRyZW4ubGVuZ3RoPT09MCYmZ3JvdXAhPT1jdXJyZW50R3JvdXAmJmdyb3VwIT09cm9vdEdyb3VwKXthcnJheV9yZW1vdmUobG9nSXRlbXMsZ3JvdXApO2dyb3VwLnJlbW92ZSh0cnVlLHRydWUpO319JywnbG9nRW50cmllc0FuZFNlcGFyYXRvcnM9YXJyYXlfcmVtb3ZlRnJvbVN0YXJ0KGxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzLG51bWJlclRvRGVsZXRlKTtyZXR1cm4gdHJ1ZTt9JywncmV0dXJuIGZhbHNlO30nLCdmdW5jdGlvbiBncm91cChuYW1lLHN0YXJ0RXhwYW5kZWQpe2lmKGxvZ2dpbmdFbmFibGVkKXtpbml0aWFsbHlFeHBhbmRlZD0odHlwZW9mIHN0YXJ0RXhwYW5kZWQ9PT1cInVuZGVmaW5lZFwiKT90cnVlOkJvb2xlYW4oc3RhcnRFeHBhbmRlZCk7dmFyIG5ld0dyb3VwPW5ldyBHcm91cChuYW1lLGZhbHNlLGluaXRpYWxseUV4cGFuZGVkKTtjdXJyZW50R3JvdXAuYWRkQ2hpbGQobmV3R3JvdXApO2N1cnJlbnRHcm91cD1uZXdHcm91cDtsb2dJdGVtcy5wdXNoKG5ld0dyb3VwKTtpZihsb2FkZWQpe2lmKGxvZ1F1ZXVlZEV2ZW50c1RpbWVyIT09bnVsbCl7Y2xlYXJUaW1lb3V0KGxvZ1F1ZXVlZEV2ZW50c1RpbWVyKTt9JywnbG9nUXVldWVkRXZlbnRzVGltZXI9c2V0VGltZW91dChyZW5kZXJRdWV1ZWRMb2dJdGVtcyxyZW5kZXJEZWxheSk7dW5yZW5kZXJlZExvZ0l0ZW1zRXhpc3Q9dHJ1ZTt9fX0nLCdmdW5jdGlvbiBncm91cEVuZCgpe2N1cnJlbnRHcm91cD0oY3VycmVudEdyb3VwPT09cm9vdEdyb3VwKT9yb290R3JvdXA6Y3VycmVudEdyb3VwLmdyb3VwO30nLCdmdW5jdGlvbiBtYWluUGFnZVJlbG9hZGVkKCl7Y3VycmVudEdyb3VwPXJvb3RHcm91cDt2YXIgc2VwYXJhdG9yPW5ldyBTZXBhcmF0b3IoKTtsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycy5wdXNoKHNlcGFyYXRvcik7bG9nSXRlbXMucHVzaChzZXBhcmF0b3IpO2N1cnJlbnRHcm91cC5hZGRDaGlsZChzZXBhcmF0b3IpO30nLCdmdW5jdGlvbiBjbG9zZVdpbmRvdygpe2lmKGFwcGVuZGVyJiZtYWluV2luZG93RXhpc3RzKCkpe2FwcGVuZGVyLmNsb3NlKHRydWUpO31lbHNle3dpbmRvdy5jbG9zZSgpO319JywnZnVuY3Rpb24gaGlkZSgpe2lmKGFwcGVuZGVyJiZtYWluV2luZG93RXhpc3RzKCkpe2FwcGVuZGVyLmhpZGUoKTt9fScsJ3ZhciBtYWluV2luZG93PXdpbmRvdzt2YXIgd2luZG93SWQ9XCJsb2c0amF2YXNjcmlwdENvbnNvbGVXaW5kb3dfXCIrbmV3IERhdGUoKS5nZXRUaW1lKCkrXCJfXCIrKFwiXCIrTWF0aC5yYW5kb20oKSkuc3Vic3RyKDIpO2Z1bmN0aW9uIHNldE1haW5XaW5kb3cod2luKXttYWluV2luZG93PXdpbjttYWluV2luZG93W3dpbmRvd0lkXT13aW5kb3c7aWYob3BlbmVyJiZjbG9zZUlmT3BlbmVyQ2xvc2VzKXtwb2xsT3BlbmVyKCk7fX0nLCdmdW5jdGlvbiBwb2xsT3BlbmVyKCl7aWYoY2xvc2VJZk9wZW5lckNsb3Nlcyl7aWYobWFpbldpbmRvd0V4aXN0cygpKXtzZXRUaW1lb3V0KHBvbGxPcGVuZXIsNTAwKTt9ZWxzZXtjbG9zZVdpbmRvdygpO319fScsJ2Z1bmN0aW9uIG1haW5XaW5kb3dFeGlzdHMoKXt0cnl7cmV0dXJuKG1haW5XaW5kb3cmJiFtYWluV2luZG93LmNsb3NlZCYmbWFpbldpbmRvd1t3aW5kb3dJZF09PXdpbmRvdyk7fWNhdGNoKGV4KXt9JywncmV0dXJuIGZhbHNlO30nLCd2YXIgbG9nTGV2ZWxzPVtcIlRSQUNFXCIsXCJERUJVR1wiLFwiSU5GT1wiLFwiV0FSTlwiLFwiRVJST1JcIixcIkZBVEFMXCJdO2Z1bmN0aW9uIGdldENoZWNrQm94KGxvZ0xldmVsKXtyZXR1cm4gJChcInN3aXRjaF9cIitsb2dMZXZlbCk7fScsJ2Z1bmN0aW9uIGdldEllV3JhcHBlZExvZ0NvbnRhaW5lcigpe3JldHVybiAkKFwibG9nX3dyYXBwZWRcIik7fScsJ2Z1bmN0aW9uIGdldEllVW53cmFwcGVkTG9nQ29udGFpbmVyKCl7cmV0dXJuICQoXCJsb2dfdW53cmFwcGVkXCIpO30nLCdmdW5jdGlvbiBhcHBseUZpbHRlcnMoKXtmb3IodmFyIGk9MDtpPGxvZ0xldmVscy5sZW5ndGg7aSsrKXtpZihnZXRDaGVja0JveChsb2dMZXZlbHNbaV0pLmNoZWNrZWQpe2FkZENsYXNzKGxvZ01haW5Db250YWluZXIsbG9nTGV2ZWxzW2ldKTt9ZWxzZXtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLGxvZ0xldmVsc1tpXSk7fX0nLCd1cGRhdGVTZWFyY2hGcm9tRmlsdGVycygpO30nLCdmdW5jdGlvbiB0b2dnbGVBbGxMZXZlbHMoKXt2YXIgdHVybk9uPSQoXCJzd2l0Y2hfQUxMXCIpLmNoZWNrZWQ7Zm9yKHZhciBpPTA7aTxsb2dMZXZlbHMubGVuZ3RoO2krKyl7Z2V0Q2hlY2tCb3gobG9nTGV2ZWxzW2ldKS5jaGVja2VkPXR1cm5PbjtpZih0dXJuT24pe2FkZENsYXNzKGxvZ01haW5Db250YWluZXIsbG9nTGV2ZWxzW2ldKTt9ZWxzZXtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLGxvZ0xldmVsc1tpXSk7fX19JywnZnVuY3Rpb24gY2hlY2tBbGxMZXZlbHMoKXtmb3IodmFyIGk9MDtpPGxvZ0xldmVscy5sZW5ndGg7aSsrKXtpZighZ2V0Q2hlY2tCb3gobG9nTGV2ZWxzW2ldKS5jaGVja2VkKXtnZXRDaGVja0JveChcIkFMTFwiKS5jaGVja2VkPWZhbHNlO3JldHVybjt9fScsJ2dldENoZWNrQm94KFwiQUxMXCIpLmNoZWNrZWQ9dHJ1ZTt9JywnZnVuY3Rpb24gY2xlYXJMb2coKXtyb290R3JvdXAuY2xlYXIoKTtjdXJyZW50R3JvdXA9cm9vdEdyb3VwO2xvZ0VudHJpZXM9W107bG9nSXRlbXM9W107bG9nRW50cmllc0FuZFNlcGFyYXRvcnM9W107ZG9TZWFyY2goKTt9JywnZnVuY3Rpb24gdG9nZ2xlV3JhcCgpe3ZhciBlbmFibGU9JChcIndyYXBcIikuY2hlY2tlZDtpZihlbmFibGUpe2FkZENsYXNzKGxvZ01haW5Db250YWluZXIsXCJ3cmFwXCIpO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJ3cmFwXCIpO30nLCdyZWZyZXNoQ3VycmVudE1hdGNoKCk7fScsJ3ZhciBzZWFyY2hUaW1lcj1udWxsO2Z1bmN0aW9uIHNjaGVkdWxlU2VhcmNoKCl7dHJ5e2NsZWFyVGltZW91dChzZWFyY2hUaW1lcik7fWNhdGNoKGV4KXt9Jywnc2VhcmNoVGltZXI9c2V0VGltZW91dChkb1NlYXJjaCw1MDApO30nLCdmdW5jdGlvbiBTZWFyY2goc2VhcmNoVGVybSxpc1JlZ2V4LHNlYXJjaFJlZ2V4LGlzQ2FzZVNlbnNpdGl2ZSl7dGhpcy5zZWFyY2hUZXJtPXNlYXJjaFRlcm07dGhpcy5pc1JlZ2V4PWlzUmVnZXg7dGhpcy5zZWFyY2hSZWdleD1zZWFyY2hSZWdleDt0aGlzLmlzQ2FzZVNlbnNpdGl2ZT1pc0Nhc2VTZW5zaXRpdmU7dGhpcy5tYXRjaGVzPVtdO30nLCdTZWFyY2gucHJvdG90eXBlPXtoYXNNYXRjaGVzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubWF0Y2hlcy5sZW5ndGg+MDt9LGhhc1Zpc2libGVNYXRjaGVzOmZ1bmN0aW9uKCl7aWYodGhpcy5oYXNNYXRjaGVzKCkpe2Zvcih2YXIgaT0wO2k8dGhpcy5tYXRjaGVzLmxlbmd0aDtpKyspe2lmKHRoaXMubWF0Y2hlc1tpXS5pc1Zpc2libGUoKSl7cmV0dXJuIHRydWU7fX19JywncmV0dXJuIGZhbHNlO30sbWF0Y2g6ZnVuY3Rpb24obG9nRW50cnkpe3ZhciBlbnRyeVRleHQ9U3RyaW5nKGxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2UpO3ZhciBtYXRjaGVzU2VhcmNoPWZhbHNlO2lmKHRoaXMuaXNSZWdleCl7bWF0Y2hlc1NlYXJjaD10aGlzLnNlYXJjaFJlZ2V4LnRlc3QoZW50cnlUZXh0KTt9ZWxzZSBpZih0aGlzLmlzQ2FzZVNlbnNpdGl2ZSl7bWF0Y2hlc1NlYXJjaD0oZW50cnlUZXh0LmluZGV4T2YodGhpcy5zZWFyY2hUZXJtKT4tMSk7fWVsc2V7bWF0Y2hlc1NlYXJjaD0oZW50cnlUZXh0LnRvTG93ZXJDYXNlKCkuaW5kZXhPZih0aGlzLnNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKSk+LTEpO30nLCdyZXR1cm4gbWF0Y2hlc1NlYXJjaDt9LGdldE5leHRWaXNpYmxlTWF0Y2hJbmRleDpmdW5jdGlvbigpe2Zvcih2YXIgaT1jdXJyZW50TWF0Y2hJbmRleCsxO2k8dGhpcy5tYXRjaGVzLmxlbmd0aDtpKyspe2lmKHRoaXMubWF0Y2hlc1tpXS5pc1Zpc2libGUoKSl7cmV0dXJuIGk7fX0nLCdmb3IoaT0wO2k8PWN1cnJlbnRNYXRjaEluZGV4O2krKyl7aWYodGhpcy5tYXRjaGVzW2ldLmlzVmlzaWJsZSgpKXtyZXR1cm4gaTt9fScsJ3JldHVybi0xO30sZ2V0UHJldmlvdXNWaXNpYmxlTWF0Y2hJbmRleDpmdW5jdGlvbigpe2Zvcih2YXIgaT1jdXJyZW50TWF0Y2hJbmRleC0xO2k+PTA7aS0tKXtpZih0aGlzLm1hdGNoZXNbaV0uaXNWaXNpYmxlKCkpe3JldHVybiBpO319JywnZm9yKHZhciBpPXRoaXMubWF0Y2hlcy5sZW5ndGgtMTtpPj1jdXJyZW50TWF0Y2hJbmRleDtpLS0pe2lmKHRoaXMubWF0Y2hlc1tpXS5pc1Zpc2libGUoKSl7cmV0dXJuIGk7fX0nLCdyZXR1cm4tMTt9LGFwcGx5VG86ZnVuY3Rpb24obG9nRW50cnkpe3ZhciBkb2VzTWF0Y2g9dGhpcy5tYXRjaChsb2dFbnRyeSk7aWYoZG9lc01hdGNoKXtsb2dFbnRyeS5ncm91cC5leHBhbmQoKTtsb2dFbnRyeS5zZXRTZWFyY2hNYXRjaCh0cnVlKTt2YXIgbG9nRW50cnlDb250ZW50O3ZhciB3cmFwcGVkTG9nRW50cnlDb250ZW50O3ZhciBzZWFyY2hUZXJtUmVwbGFjZW1lbnRTdGFydFRhZz1cIjxzcGFuIGNsYXNzPVxcXFxcXFwic2VhcmNodGVybVxcXFxcXFwiPlwiO3ZhciBzZWFyY2hUZXJtUmVwbGFjZW1lbnRFbmRUYWc9XCI8XCIrXCIvc3Bhbj5cIjt2YXIgcHJlVGFnTmFtZT1pc0llP1wicHJlXCI6XCJzcGFuXCI7dmFyIHByZVN0YXJ0VGFnPVwiPFwiK3ByZVRhZ05hbWUrXCIgY2xhc3M9XFxcXFxcXCJwcmVcXFxcXFxcIj5cIjt2YXIgcHJlRW5kVGFnPVwiPFwiK1wiL1wiK3ByZVRhZ05hbWUrXCI+XCI7dmFyIHN0YXJ0SW5kZXg9MDt2YXIgc2VhcmNoSW5kZXgsbWF0Y2hlZFRleHQsdGV4dEJlZm9yZU1hdGNoO2lmKHRoaXMuaXNSZWdleCl7dmFyIGZsYWdzPXRoaXMuaXNDYXNlU2Vuc2l0aXZlP1wiZ1wiOlwiZ2lcIjt2YXIgY2FwdHVyaW5nUmVnZXg9bmV3IFJlZ0V4cChcIihcIit0aGlzLnNlYXJjaFJlZ2V4LnNvdXJjZStcIilcIixmbGFncyk7dmFyIHJuZD0oXCJcIitNYXRoLnJhbmRvbSgpKS5zdWJzdHIoMik7dmFyIHN0YXJ0VG9rZW49XCIlJXNcIitybmQrXCIlJVwiO3ZhciBlbmRUb2tlbj1cIiUlZVwiK3JuZCtcIiUlXCI7bG9nRW50cnlDb250ZW50PWxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2UucmVwbGFjZShjYXB0dXJpbmdSZWdleCxzdGFydFRva2VuK1wiJDFcIitlbmRUb2tlbik7bG9nRW50cnlDb250ZW50PWVzY2FwZUh0bWwobG9nRW50cnlDb250ZW50KTt2YXIgcmVzdWx0O3ZhciBzZWFyY2hTdHJpbmc9bG9nRW50cnlDb250ZW50O2xvZ0VudHJ5Q29udGVudD1cIlwiO3dyYXBwZWRMb2dFbnRyeUNvbnRlbnQ9XCJcIjt3aGlsZSgoc2VhcmNoSW5kZXg9c2VhcmNoU3RyaW5nLmluZGV4T2Yoc3RhcnRUb2tlbixzdGFydEluZGV4KSk+LTEpe3ZhciBlbmRUb2tlbkluZGV4PXNlYXJjaFN0cmluZy5pbmRleE9mKGVuZFRva2VuLHNlYXJjaEluZGV4KTttYXRjaGVkVGV4dD1zZWFyY2hTdHJpbmcuc3Vic3RyaW5nKHNlYXJjaEluZGV4K3N0YXJ0VG9rZW4ubGVuZ3RoLGVuZFRva2VuSW5kZXgpO3RleHRCZWZvcmVNYXRjaD1zZWFyY2hTdHJpbmcuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsc2VhcmNoSW5kZXgpO2xvZ0VudHJ5Q29udGVudCs9cHJlU3RhcnRUYWcrdGV4dEJlZm9yZU1hdGNoK3ByZUVuZFRhZztsb2dFbnRyeUNvbnRlbnQrPXNlYXJjaFRlcm1SZXBsYWNlbWVudFN0YXJ0VGFnK3ByZVN0YXJ0VGFnK21hdGNoZWRUZXh0KycsJ3ByZUVuZFRhZytzZWFyY2hUZXJtUmVwbGFjZW1lbnRFbmRUYWc7aWYoaXNJZSl7d3JhcHBlZExvZ0VudHJ5Q29udGVudCs9dGV4dEJlZm9yZU1hdGNoK3NlYXJjaFRlcm1SZXBsYWNlbWVudFN0YXJ0VGFnKycsJ21hdGNoZWRUZXh0K3NlYXJjaFRlcm1SZXBsYWNlbWVudEVuZFRhZzt9Jywnc3RhcnRJbmRleD1lbmRUb2tlbkluZGV4K2VuZFRva2VuLmxlbmd0aDt9JywnbG9nRW50cnlDb250ZW50Kz1wcmVTdGFydFRhZytzZWFyY2hTdHJpbmcuc3Vic3RyKHN0YXJ0SW5kZXgpK3ByZUVuZFRhZztpZihpc0llKXt3cmFwcGVkTG9nRW50cnlDb250ZW50Kz1zZWFyY2hTdHJpbmcuc3Vic3RyKHN0YXJ0SW5kZXgpO319ZWxzZXtsb2dFbnRyeUNvbnRlbnQ9XCJcIjt3cmFwcGVkTG9nRW50cnlDb250ZW50PVwiXCI7dmFyIHNlYXJjaFRlcm1SZXBsYWNlbWVudExlbmd0aD1zZWFyY2hUZXJtUmVwbGFjZW1lbnRTdGFydFRhZy5sZW5ndGgrJywndGhpcy5zZWFyY2hUZXJtLmxlbmd0aCtzZWFyY2hUZXJtUmVwbGFjZW1lbnRFbmRUYWcubGVuZ3RoO3ZhciBzZWFyY2hUZXJtTGVuZ3RoPXRoaXMuc2VhcmNoVGVybS5sZW5ndGg7dmFyIHNlYXJjaFRlcm1Mb3dlckNhc2U9dGhpcy5zZWFyY2hUZXJtLnRvTG93ZXJDYXNlKCk7dmFyIGxvZ1RleHRMb3dlckNhc2U9bG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZS50b0xvd2VyQ2FzZSgpO3doaWxlKChzZWFyY2hJbmRleD1sb2dUZXh0TG93ZXJDYXNlLmluZGV4T2Yoc2VhcmNoVGVybUxvd2VyQ2FzZSxzdGFydEluZGV4KSk+LTEpe21hdGNoZWRUZXh0PWVzY2FwZUh0bWwobG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZS5zdWJzdHIoc2VhcmNoSW5kZXgsdGhpcy5zZWFyY2hUZXJtLmxlbmd0aCkpO3RleHRCZWZvcmVNYXRjaD1lc2NhcGVIdG1sKGxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2Uuc3Vic3RyaW5nKHN0YXJ0SW5kZXgsc2VhcmNoSW5kZXgpKTt2YXIgc2VhcmNoVGVybVJlcGxhY2VtZW50PXNlYXJjaFRlcm1SZXBsYWNlbWVudFN0YXJ0VGFnKycsJ3ByZVN0YXJ0VGFnK21hdGNoZWRUZXh0K3ByZUVuZFRhZytzZWFyY2hUZXJtUmVwbGFjZW1lbnRFbmRUYWc7bG9nRW50cnlDb250ZW50Kz1wcmVTdGFydFRhZyt0ZXh0QmVmb3JlTWF0Y2grcHJlRW5kVGFnK3NlYXJjaFRlcm1SZXBsYWNlbWVudDtpZihpc0llKXt3cmFwcGVkTG9nRW50cnlDb250ZW50Kz10ZXh0QmVmb3JlTWF0Y2grc2VhcmNoVGVybVJlcGxhY2VtZW50U3RhcnRUYWcrJywnbWF0Y2hlZFRleHQrc2VhcmNoVGVybVJlcGxhY2VtZW50RW5kVGFnO30nLCdzdGFydEluZGV4PXNlYXJjaEluZGV4K3NlYXJjaFRlcm1MZW5ndGg7fScsJ3ZhciB0ZXh0QWZ0ZXJMYXN0TWF0Y2g9ZXNjYXBlSHRtbChsb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlLnN1YnN0cihzdGFydEluZGV4KSk7bG9nRW50cnlDb250ZW50Kz1wcmVTdGFydFRhZyt0ZXh0QWZ0ZXJMYXN0TWF0Y2grcHJlRW5kVGFnO2lmKGlzSWUpe3dyYXBwZWRMb2dFbnRyeUNvbnRlbnQrPXRleHRBZnRlckxhc3RNYXRjaDt9fScsJ2xvZ0VudHJ5LnNldENvbnRlbnQobG9nRW50cnlDb250ZW50LHdyYXBwZWRMb2dFbnRyeUNvbnRlbnQpO3ZhciBsb2dFbnRyeU1hdGNoZXM9bG9nRW50cnkuZ2V0U2VhcmNoTWF0Y2hlcygpO3RoaXMubWF0Y2hlcz10aGlzLm1hdGNoZXMuY29uY2F0KGxvZ0VudHJ5TWF0Y2hlcyk7fWVsc2V7bG9nRW50cnkuc2V0U2VhcmNoTWF0Y2goZmFsc2UpO2xvZ0VudHJ5LnNldENvbnRlbnQobG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZSxsb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlKTt9JywncmV0dXJuIGRvZXNNYXRjaDt9LHJlbW92ZU1hdGNoZXM6ZnVuY3Rpb24obG9nRW50cmllcyl7dmFyIG1hdGNoZXNUb1JlbW92ZUNvdW50PTA7dmFyIGN1cnJlbnRNYXRjaFJlbW92ZWQ9ZmFsc2U7dmFyIG1hdGNoZXNUb1JlbW92ZT1bXTt2YXIgaSxpTGVuLGosakxlbjtmb3IoaT0wLGlMZW49dGhpcy5tYXRjaGVzLmxlbmd0aDtpPGlMZW47aSsrKXtmb3Ioaj0wLGpMZW49bG9nRW50cmllcy5sZW5ndGg7ajxqTGVuO2orKyl7aWYodGhpcy5tYXRjaGVzW2ldLmJlbG9uZ3NUbyhsb2dFbnRyaWVzW2pdKSl7bWF0Y2hlc1RvUmVtb3ZlLnB1c2godGhpcy5tYXRjaGVzW2ldKTtpZihpPT09Y3VycmVudE1hdGNoSW5kZXgpe2N1cnJlbnRNYXRjaFJlbW92ZWQ9dHJ1ZTt9fX19JywndmFyIG5ld01hdGNoPWN1cnJlbnRNYXRjaFJlbW92ZWQ/bnVsbDp0aGlzLm1hdGNoZXNbY3VycmVudE1hdGNoSW5kZXhdO2lmKGN1cnJlbnRNYXRjaFJlbW92ZWQpe2ZvcihpPWN1cnJlbnRNYXRjaEluZGV4LGlMZW49dGhpcy5tYXRjaGVzLmxlbmd0aDtpPGlMZW47aSsrKXtpZih0aGlzLm1hdGNoZXNbaV0uaXNWaXNpYmxlKCkmJiFhcnJheV9jb250YWlucyhtYXRjaGVzVG9SZW1vdmUsdGhpcy5tYXRjaGVzW2ldKSl7bmV3TWF0Y2g9dGhpcy5tYXRjaGVzW2ldO2JyZWFrO319fScsJ2ZvcihpPTAsaUxlbj1tYXRjaGVzVG9SZW1vdmUubGVuZ3RoO2k8aUxlbjtpKyspe2FycmF5X3JlbW92ZSh0aGlzLm1hdGNoZXMsbWF0Y2hlc1RvUmVtb3ZlW2ldKTttYXRjaGVzVG9SZW1vdmVbaV0ucmVtb3ZlKCk7fScsJ2lmKHRoaXMuaGFzVmlzaWJsZU1hdGNoZXMoKSl7aWYobmV3TWF0Y2g9PT1udWxsKXtzZXRDdXJyZW50TWF0Y2hJbmRleCgwKTt9ZWxzZXt2YXIgbmV3TWF0Y2hJbmRleD0wO2ZvcihpPTAsaUxlbj10aGlzLm1hdGNoZXMubGVuZ3RoO2k8aUxlbjtpKyspe2lmKG5ld01hdGNoPT09dGhpcy5tYXRjaGVzW2ldKXtuZXdNYXRjaEluZGV4PWk7YnJlYWs7fX0nLCdzZXRDdXJyZW50TWF0Y2hJbmRleChuZXdNYXRjaEluZGV4KTt9fWVsc2V7Y3VycmVudE1hdGNoSW5kZXg9bnVsbDtkaXNwbGF5Tm9NYXRjaGVzKCk7fX19O2Z1bmN0aW9uIGdldFBhZ2VPZmZzZXRUb3AoZWwsY29udGFpbmVyKXt2YXIgY3VycmVudEVsPWVsO3ZhciB5PTA7d2hpbGUoY3VycmVudEVsJiZjdXJyZW50RWwhPWNvbnRhaW5lcil7eSs9Y3VycmVudEVsLm9mZnNldFRvcDtjdXJyZW50RWw9Y3VycmVudEVsLm9mZnNldFBhcmVudDt9JywncmV0dXJuIHk7fScsJ2Z1bmN0aW9uIHNjcm9sbEludG9WaWV3KGVsKXt2YXIgbG9nQ29udGFpbmVyPWxvZ01haW5Db250YWluZXI7aWYoISQoXCJ3cmFwXCIpLmNoZWNrZWQpe3ZhciBsb2dDb250YWluZXJMZWZ0PWxvZ0NvbnRhaW5lci5zY3JvbGxMZWZ0O3ZhciBsb2dDb250YWluZXJSaWdodD1sb2dDb250YWluZXJMZWZ0K2xvZ0NvbnRhaW5lci5vZmZzZXRXaWR0aDt2YXIgZWxMZWZ0PWVsLm9mZnNldExlZnQ7dmFyIGVsUmlnaHQ9ZWxMZWZ0K2VsLm9mZnNldFdpZHRoO2lmKGVsTGVmdDxsb2dDb250YWluZXJMZWZ0fHxlbFJpZ2h0PmxvZ0NvbnRhaW5lclJpZ2h0KXtsb2dDb250YWluZXIuc2Nyb2xsTGVmdD1lbExlZnQtKGxvZ0NvbnRhaW5lci5vZmZzZXRXaWR0aC1lbC5vZmZzZXRXaWR0aCkvMjt9fScsJ3ZhciBsb2dDb250YWluZXJUb3A9bG9nQ29udGFpbmVyLnNjcm9sbFRvcDt2YXIgbG9nQ29udGFpbmVyQm90dG9tPWxvZ0NvbnRhaW5lclRvcCtsb2dDb250YWluZXIub2Zmc2V0SGVpZ2h0O3ZhciBlbFRvcD1nZXRQYWdlT2Zmc2V0VG9wKGVsKS1nZXRUb29sQmFyc0hlaWdodCgpO3ZhciBlbEJvdHRvbT1lbFRvcCtlbC5vZmZzZXRIZWlnaHQ7aWYoZWxUb3A8bG9nQ29udGFpbmVyVG9wfHxlbEJvdHRvbT5sb2dDb250YWluZXJCb3R0b20pe2xvZ0NvbnRhaW5lci5zY3JvbGxUb3A9ZWxUb3AtKGxvZ0NvbnRhaW5lci5vZmZzZXRIZWlnaHQtZWwub2Zmc2V0SGVpZ2h0KS8yO319JywnZnVuY3Rpb24gTWF0Y2gobG9nRW50cnlMZXZlbCxzcGFuSW5NYWluRGl2LHNwYW5JblVud3JhcHBlZFByZSxzcGFuSW5XcmFwcGVkRGl2KXt0aGlzLmxvZ0VudHJ5TGV2ZWw9bG9nRW50cnlMZXZlbDt0aGlzLnNwYW5Jbk1haW5EaXY9c3BhbkluTWFpbkRpdjtpZihpc0llKXt0aGlzLnNwYW5JblVud3JhcHBlZFByZT1zcGFuSW5VbndyYXBwZWRQcmU7dGhpcy5zcGFuSW5XcmFwcGVkRGl2PXNwYW5JbldyYXBwZWREaXY7fScsJ3RoaXMubWFpblNwYW49aXNJZT9zcGFuSW5VbndyYXBwZWRQcmU6c3BhbkluTWFpbkRpdjt9JywnTWF0Y2gucHJvdG90eXBlPXtlcXVhbHM6ZnVuY3Rpb24obWF0Y2gpe3JldHVybiB0aGlzLm1haW5TcGFuPT09bWF0Y2gubWFpblNwYW47fSxzZXRDdXJyZW50OmZ1bmN0aW9uKCl7aWYoaXNJZSl7YWRkQ2xhc3ModGhpcy5zcGFuSW5VbndyYXBwZWRQcmUsXCJjdXJyZW50bWF0Y2hcIik7YWRkQ2xhc3ModGhpcy5zcGFuSW5XcmFwcGVkRGl2LFwiY3VycmVudG1hdGNoXCIpO3ZhciBlbGVtZW50VG9TY3JvbGw9JChcIndyYXBcIikuY2hlY2tlZD90aGlzLnNwYW5JbldyYXBwZWREaXY6dGhpcy5zcGFuSW5VbndyYXBwZWRQcmU7c2Nyb2xsSW50b1ZpZXcoZWxlbWVudFRvU2Nyb2xsKTt9ZWxzZXthZGRDbGFzcyh0aGlzLnNwYW5Jbk1haW5EaXYsXCJjdXJyZW50bWF0Y2hcIik7c2Nyb2xsSW50b1ZpZXcodGhpcy5zcGFuSW5NYWluRGl2KTt9fSxiZWxvbmdzVG86ZnVuY3Rpb24obG9nRW50cnkpe2lmKGlzSWUpe3JldHVybiBpc0Rlc2NlbmRhbnQodGhpcy5zcGFuSW5VbndyYXBwZWRQcmUsbG9nRW50cnkudW53cmFwcGVkUHJlKTt9ZWxzZXtyZXR1cm4gaXNEZXNjZW5kYW50KHRoaXMuc3BhbkluTWFpbkRpdixsb2dFbnRyeS5tYWluRGl2KTt9fSxzZXROb3RDdXJyZW50OmZ1bmN0aW9uKCl7aWYoaXNJZSl7cmVtb3ZlQ2xhc3ModGhpcy5zcGFuSW5VbndyYXBwZWRQcmUsXCJjdXJyZW50bWF0Y2hcIik7cmVtb3ZlQ2xhc3ModGhpcy5zcGFuSW5XcmFwcGVkRGl2LFwiY3VycmVudG1hdGNoXCIpO31lbHNle3JlbW92ZUNsYXNzKHRoaXMuc3BhbkluTWFpbkRpdixcImN1cnJlbnRtYXRjaFwiKTt9fSxpc09ycGhhbjpmdW5jdGlvbigpe3JldHVybiBpc09ycGhhbih0aGlzLm1haW5TcGFuKTt9LGlzVmlzaWJsZTpmdW5jdGlvbigpe3JldHVybiBnZXRDaGVja0JveCh0aGlzLmxvZ0VudHJ5TGV2ZWwpLmNoZWNrZWQ7fSxyZW1vdmU6ZnVuY3Rpb24oKXtpZihpc0llKXt0aGlzLnNwYW5JblVud3JhcHBlZFByZT1udWxsO3RoaXMuc3BhbkluV3JhcHBlZERpdj1udWxsO31lbHNle3RoaXMuc3BhbkluTWFpbkRpdj1udWxsO319fTt2YXIgY3VycmVudFNlYXJjaD1udWxsO3ZhciBjdXJyZW50TWF0Y2hJbmRleD1udWxsO2Z1bmN0aW9uIGRvU2VhcmNoKCl7dmFyIHNlYXJjaEJveD0kKFwic2VhcmNoQm94XCIpO3ZhciBzZWFyY2hUZXJtPXNlYXJjaEJveC52YWx1ZTt2YXIgaXNSZWdleD0kKFwic2VhcmNoUmVnZXhcIikuY2hlY2tlZDt2YXIgaXNDYXNlU2Vuc2l0aXZlPSQoXCJzZWFyY2hDYXNlU2Vuc2l0aXZlXCIpLmNoZWNrZWQ7dmFyIGk7aWYoc2VhcmNoVGVybT09PVwiXCIpeyQoXCJzZWFyY2hSZXNldFwiKS5kaXNhYmxlZD10cnVlOyQoXCJzZWFyY2hOYXZcIikuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjtyZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LFwic2VhcmNoaW5nXCIpO3JlbW92ZUNsYXNzKHNlYXJjaEJveCxcImhhc21hdGNoZXNcIik7cmVtb3ZlQ2xhc3Moc2VhcmNoQm94LFwibm9tYXRjaGVzXCIpO2ZvcihpPTA7aTxsb2dFbnRyaWVzLmxlbmd0aDtpKyspe2xvZ0VudHJpZXNbaV0uY2xlYXJTZWFyY2goKTtsb2dFbnRyaWVzW2ldLnNldENvbnRlbnQobG9nRW50cmllc1tpXS5mb3JtYXR0ZWRNZXNzYWdlLGxvZ0VudHJpZXNbaV0uZm9ybWF0dGVkTWVzc2FnZSk7fScsJ2N1cnJlbnRTZWFyY2g9bnVsbDtzZXRMb2dDb250YWluZXJIZWlnaHQoKTt9ZWxzZXskKFwic2VhcmNoUmVzZXRcIikuZGlzYWJsZWQ9ZmFsc2U7JChcInNlYXJjaE5hdlwiKS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIjt2YXIgc2VhcmNoUmVnZXg7dmFyIHJlZ2V4VmFsaWQ7aWYoaXNSZWdleCl7dHJ5e3NlYXJjaFJlZ2V4PWlzQ2FzZVNlbnNpdGl2ZT9uZXcgUmVnRXhwKHNlYXJjaFRlcm0sXCJnXCIpOm5ldyBSZWdFeHAoc2VhcmNoVGVybSxcImdpXCIpO3JlZ2V4VmFsaWQ9dHJ1ZTtyZXBsYWNlQ2xhc3Moc2VhcmNoQm94LFwidmFsaWRyZWdleFwiLFwiaW52YWxpZHJlZ2V4XCIpO3NlYXJjaEJveC50aXRsZT1cIlZhbGlkIHJlZ2V4XCI7fWNhdGNoKGV4KXtyZWdleFZhbGlkPWZhbHNlO3JlcGxhY2VDbGFzcyhzZWFyY2hCb3gsXCJpbnZhbGlkcmVnZXhcIixcInZhbGlkcmVnZXhcIik7c2VhcmNoQm94LnRpdGxlPVwiSW52YWxpZCByZWdleDogXCIrKGV4Lm1lc3NhZ2U/ZXgubWVzc2FnZTooZXguZGVzY3JpcHRpb24/ZXguZGVzY3JpcHRpb246XCJ1bmtub3duIGVycm9yXCIpKTtyZXR1cm47fX1lbHNle3NlYXJjaEJveC50aXRsZT1cIlwiO3JlbW92ZUNsYXNzKHNlYXJjaEJveCxcInZhbGlkcmVnZXhcIik7cmVtb3ZlQ2xhc3Moc2VhcmNoQm94LFwiaW52YWxpZHJlZ2V4XCIpO30nLCdhZGRDbGFzcyhkb2N1bWVudC5ib2R5LFwic2VhcmNoaW5nXCIpO2N1cnJlbnRTZWFyY2g9bmV3IFNlYXJjaChzZWFyY2hUZXJtLGlzUmVnZXgsc2VhcmNoUmVnZXgsaXNDYXNlU2Vuc2l0aXZlKTtmb3IoaT0wO2k8bG9nRW50cmllcy5sZW5ndGg7aSsrKXtjdXJyZW50U2VhcmNoLmFwcGx5VG8obG9nRW50cmllc1tpXSk7fScsJ3NldExvZ0NvbnRhaW5lckhlaWdodCgpO2lmKGN1cnJlbnRTZWFyY2guaGFzVmlzaWJsZU1hdGNoZXMoKSl7c2V0Q3VycmVudE1hdGNoSW5kZXgoMCk7ZGlzcGxheU1hdGNoZXMoKTt9ZWxzZXtkaXNwbGF5Tm9NYXRjaGVzKCk7fX19JywnZnVuY3Rpb24gdXBkYXRlU2VhcmNoRnJvbUZpbHRlcnMoKXtpZihjdXJyZW50U2VhcmNoKXtpZihjdXJyZW50U2VhcmNoLmhhc01hdGNoZXMoKSl7aWYoY3VycmVudE1hdGNoSW5kZXg9PT1udWxsKXtjdXJyZW50TWF0Y2hJbmRleD0wO30nLCd2YXIgY3VycmVudE1hdGNoPWN1cnJlbnRTZWFyY2gubWF0Y2hlc1tjdXJyZW50TWF0Y2hJbmRleF07aWYoY3VycmVudE1hdGNoLmlzVmlzaWJsZSgpKXtkaXNwbGF5TWF0Y2hlcygpO3NldEN1cnJlbnRNYXRjaEluZGV4KGN1cnJlbnRNYXRjaEluZGV4KTt9ZWxzZXtjdXJyZW50TWF0Y2guc2V0Tm90Q3VycmVudCgpO3ZhciBuZXh0VmlzaWJsZU1hdGNoSW5kZXg9Y3VycmVudFNlYXJjaC5nZXROZXh0VmlzaWJsZU1hdGNoSW5kZXgoKTtpZihuZXh0VmlzaWJsZU1hdGNoSW5kZXg+LTEpe3NldEN1cnJlbnRNYXRjaEluZGV4KG5leHRWaXNpYmxlTWF0Y2hJbmRleCk7ZGlzcGxheU1hdGNoZXMoKTt9ZWxzZXtkaXNwbGF5Tm9NYXRjaGVzKCk7fX19ZWxzZXtkaXNwbGF5Tm9NYXRjaGVzKCk7fX19JywnZnVuY3Rpb24gcmVmcmVzaEN1cnJlbnRNYXRjaCgpe2lmKGN1cnJlbnRTZWFyY2gmJmN1cnJlbnRTZWFyY2guaGFzVmlzaWJsZU1hdGNoZXMoKSl7c2V0Q3VycmVudE1hdGNoSW5kZXgoY3VycmVudE1hdGNoSW5kZXgpO319JywnZnVuY3Rpb24gZGlzcGxheU1hdGNoZXMoKXtyZXBsYWNlQ2xhc3MoJChcInNlYXJjaEJveFwiKSxcImhhc21hdGNoZXNcIixcIm5vbWF0Y2hlc1wiKTskKFwic2VhcmNoQm94XCIpLnRpdGxlPVwiXCIrY3VycmVudFNlYXJjaC5tYXRjaGVzLmxlbmd0aCtcIiBtYXRjaGVzIGZvdW5kXCI7JChcInNlYXJjaE5hdlwiKS5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIjtzZXRMb2dDb250YWluZXJIZWlnaHQoKTt9JywnZnVuY3Rpb24gZGlzcGxheU5vTWF0Y2hlcygpe3JlcGxhY2VDbGFzcygkKFwic2VhcmNoQm94XCIpLFwibm9tYXRjaGVzXCIsXCJoYXNtYXRjaGVzXCIpOyQoXCJzZWFyY2hCb3hcIikudGl0bGU9XCJObyBtYXRjaGVzIGZvdW5kXCI7JChcInNlYXJjaE5hdlwiKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3NldExvZ0NvbnRhaW5lckhlaWdodCgpO30nLCdmdW5jdGlvbiB0b2dnbGVTZWFyY2hFbmFibGVkKGVuYWJsZSl7ZW5hYmxlPSh0eXBlb2YgZW5hYmxlPT1cInVuZGVmaW5lZFwiKT8hJChcInNlYXJjaERpc2FibGVcIikuY2hlY2tlZDplbmFibGU7JChcInNlYXJjaEJveFwiKS5kaXNhYmxlZD0hZW5hYmxlOyQoXCJzZWFyY2hSZXNldFwiKS5kaXNhYmxlZD0hZW5hYmxlOyQoXCJzZWFyY2hSZWdleFwiKS5kaXNhYmxlZD0hZW5hYmxlOyQoXCJzZWFyY2hOZXh0XCIpLmRpc2FibGVkPSFlbmFibGU7JChcInNlYXJjaFByZXZpb3VzXCIpLmRpc2FibGVkPSFlbmFibGU7JChcInNlYXJjaENhc2VTZW5zaXRpdmVcIikuZGlzYWJsZWQ9IWVuYWJsZTskKFwic2VhcmNoTmF2XCIpLnN0eWxlLmRpc3BsYXk9KGVuYWJsZSYmKCQoXCJzZWFyY2hCb3hcIikudmFsdWUhPT1cIlwiKSYmY3VycmVudFNlYXJjaCYmY3VycmVudFNlYXJjaC5oYXNWaXNpYmxlTWF0Y2hlcygpKT9cImJsb2NrXCI6XCJub25lXCI7aWYoZW5hYmxlKXtyZW1vdmVDbGFzcygkKFwic2VhcmNoXCIpLFwiZ3JleWVkb3V0XCIpO2FkZENsYXNzKGRvY3VtZW50LmJvZHksXCJzZWFyY2hpbmdcIik7aWYoJChcInNlYXJjaEhpZ2hsaWdodFwiKS5jaGVja2VkKXthZGRDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoaGlnaGxpZ2h0XCIpO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hoaWdobGlnaHRcIik7fScsJ2lmKCQoXCJzZWFyY2hGaWx0ZXJcIikuY2hlY2tlZCl7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGZpbHRlclwiKTt9ZWxzZXtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoZmlsdGVyXCIpO30nLCckKFwic2VhcmNoRGlzYWJsZVwiKS5jaGVja2VkPSFlbmFibGU7fWVsc2V7YWRkQ2xhc3MoJChcInNlYXJjaFwiKSxcImdyZXllZG91dFwiKTtyZW1vdmVDbGFzcyhkb2N1bWVudC5ib2R5LFwic2VhcmNoaW5nXCIpO3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hoaWdobGlnaHRcIik7cmVtb3ZlQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGZpbHRlclwiKTt9Jywnc2V0TG9nQ29udGFpbmVySGVpZ2h0KCk7fScsJ2Z1bmN0aW9uIHRvZ2dsZVNlYXJjaEZpbHRlcigpe3ZhciBlbmFibGU9JChcInNlYXJjaEZpbHRlclwiKS5jaGVja2VkO2lmKGVuYWJsZSl7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGZpbHRlclwiKTt9ZWxzZXtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoZmlsdGVyXCIpO30nLCdyZWZyZXNoQ3VycmVudE1hdGNoKCk7fScsJ2Z1bmN0aW9uIHRvZ2dsZVNlYXJjaEhpZ2hsaWdodCgpe3ZhciBlbmFibGU9JChcInNlYXJjaEhpZ2hsaWdodFwiKS5jaGVja2VkO2lmKGVuYWJsZSl7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGhpZ2hsaWdodFwiKTt9ZWxzZXtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoaGlnaGxpZ2h0XCIpO319JywnZnVuY3Rpb24gY2xlYXJTZWFyY2goKXskKFwic2VhcmNoQm94XCIpLnZhbHVlPVwiXCI7ZG9TZWFyY2goKTt9JywnZnVuY3Rpb24gc2VhcmNoTmV4dCgpe2lmKGN1cnJlbnRTZWFyY2ghPT1udWxsJiZjdXJyZW50TWF0Y2hJbmRleCE9PW51bGwpe2N1cnJlbnRTZWFyY2gubWF0Y2hlc1tjdXJyZW50TWF0Y2hJbmRleF0uc2V0Tm90Q3VycmVudCgpO3ZhciBuZXh0TWF0Y2hJbmRleD1jdXJyZW50U2VhcmNoLmdldE5leHRWaXNpYmxlTWF0Y2hJbmRleCgpO2lmKG5leHRNYXRjaEluZGV4PmN1cnJlbnRNYXRjaEluZGV4fHxjb25maXJtKFwiUmVhY2hlZCB0aGUgZW5kIG9mIHRoZSBwYWdlLiBTdGFydCBmcm9tIHRoZSB0b3A/XCIpKXtzZXRDdXJyZW50TWF0Y2hJbmRleChuZXh0TWF0Y2hJbmRleCk7fX19JywnZnVuY3Rpb24gc2VhcmNoUHJldmlvdXMoKXtpZihjdXJyZW50U2VhcmNoIT09bnVsbCYmY3VycmVudE1hdGNoSW5kZXghPT1udWxsKXtjdXJyZW50U2VhcmNoLm1hdGNoZXNbY3VycmVudE1hdGNoSW5kZXhdLnNldE5vdEN1cnJlbnQoKTt2YXIgcHJldmlvdXNNYXRjaEluZGV4PWN1cnJlbnRTZWFyY2guZ2V0UHJldmlvdXNWaXNpYmxlTWF0Y2hJbmRleCgpO2lmKHByZXZpb3VzTWF0Y2hJbmRleDxjdXJyZW50TWF0Y2hJbmRleHx8Y29uZmlybShcIlJlYWNoZWQgdGhlIHN0YXJ0IG9mIHRoZSBwYWdlLiBDb250aW51ZSBmcm9tIHRoZSBib3R0b20/XCIpKXtzZXRDdXJyZW50TWF0Y2hJbmRleChwcmV2aW91c01hdGNoSW5kZXgpO319fScsJ2Z1bmN0aW9uIHNldEN1cnJlbnRNYXRjaEluZGV4KGluZGV4KXtjdXJyZW50TWF0Y2hJbmRleD1pbmRleDtjdXJyZW50U2VhcmNoLm1hdGNoZXNbY3VycmVudE1hdGNoSW5kZXhdLnNldEN1cnJlbnQoKTt9JywnZnVuY3Rpb24gYWRkQ2xhc3MoZWwsY3NzQ2xhc3Mpe2lmKCFoYXNDbGFzcyhlbCxjc3NDbGFzcykpe2lmKGVsLmNsYXNzTmFtZSl7ZWwuY2xhc3NOYW1lKz1cIiBcIitjc3NDbGFzczt9ZWxzZXtlbC5jbGFzc05hbWU9Y3NzQ2xhc3M7fX19JywnZnVuY3Rpb24gaGFzQ2xhc3MoZWwsY3NzQ2xhc3Mpe2lmKGVsLmNsYXNzTmFtZSl7dmFyIGNsYXNzTmFtZXM9ZWwuY2xhc3NOYW1lLnNwbGl0KFwiIFwiKTtyZXR1cm4gYXJyYXlfY29udGFpbnMoY2xhc3NOYW1lcyxjc3NDbGFzcyk7fScsJ3JldHVybiBmYWxzZTt9JywnZnVuY3Rpb24gcmVtb3ZlQ2xhc3MoZWwsY3NzQ2xhc3Mpe2lmKGhhc0NsYXNzKGVsLGNzc0NsYXNzKSl7dmFyIGV4aXN0aW5nQ2xhc3Nlcz1lbC5jbGFzc05hbWUuc3BsaXQoXCIgXCIpO3ZhciBuZXdDbGFzc2VzPVtdO2Zvcih2YXIgaT0wLGxlbj1leGlzdGluZ0NsYXNzZXMubGVuZ3RoO2k8bGVuO2krKyl7aWYoZXhpc3RpbmdDbGFzc2VzW2ldIT1jc3NDbGFzcyl7bmV3Q2xhc3Nlc1tuZXdDbGFzc2VzLmxlbmd0aF09ZXhpc3RpbmdDbGFzc2VzW2ldO319JywnZWwuY2xhc3NOYW1lPW5ld0NsYXNzZXMuam9pbihcIiBcIik7fX0nLCdmdW5jdGlvbiByZXBsYWNlQ2xhc3MoZWwsbmV3Q3NzQ2xhc3Msb2xkQ3NzQ2xhc3Mpe3JlbW92ZUNsYXNzKGVsLG9sZENzc0NsYXNzKTthZGRDbGFzcyhlbCxuZXdDc3NDbGFzcyk7fScsJ2Z1bmN0aW9uIGdldEVsZW1lbnRzQnlDbGFzcyhlbCxjc3NDbGFzcyx0YWdOYW1lKXt2YXIgZWxlbWVudHM9ZWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUodGFnTmFtZSk7dmFyIG1hdGNoZXM9W107Zm9yKHZhciBpPTAsbGVuPWVsZW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe2lmKGhhc0NsYXNzKGVsZW1lbnRzW2ldLGNzc0NsYXNzKSl7bWF0Y2hlcy5wdXNoKGVsZW1lbnRzW2ldKTt9fScsJ3JldHVybiBtYXRjaGVzO30nLCdmdW5jdGlvbiAkKGlkKXtyZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoaWQpO30nLCdmdW5jdGlvbiBpc0Rlc2NlbmRhbnQobm9kZSxhbmNlc3Rvck5vZGUpe3doaWxlKG5vZGUhPW51bGwpe2lmKG5vZGU9PT1hbmNlc3Rvck5vZGUpe3JldHVybiB0cnVlO30nLCdub2RlPW5vZGUucGFyZW50Tm9kZTt9JywncmV0dXJuIGZhbHNlO30nLCdmdW5jdGlvbiBpc09ycGhhbihub2RlKXt2YXIgY3VycmVudE5vZGU9bm9kZTt3aGlsZShjdXJyZW50Tm9kZSl7aWYoY3VycmVudE5vZGU9PWRvY3VtZW50LmJvZHkpe3JldHVybiBmYWxzZTt9JywnY3VycmVudE5vZGU9Y3VycmVudE5vZGUucGFyZW50Tm9kZTt9JywncmV0dXJuIHRydWU7fScsJ2Z1bmN0aW9uIGVzY2FwZUh0bWwoc3RyKXtyZXR1cm4gc3RyLnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoL1s8XS9nLFwiJmx0O1wiKS5yZXBsYWNlKC8+L2csXCImZ3Q7XCIpO30nLCdmdW5jdGlvbiBnZXRXaW5kb3dXaWR0aCgpe2lmKHdpbmRvdy5pbm5lcldpZHRoKXtyZXR1cm4gd2luZG93LmlubmVyV2lkdGg7fWVsc2UgaWYoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGgpe3JldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGg7fWVsc2UgaWYoZG9jdW1lbnQuYm9keSl7cmV0dXJuIGRvY3VtZW50LmJvZHkuY2xpZW50V2lkdGg7fScsJ3JldHVybiAwO30nLCdmdW5jdGlvbiBnZXRXaW5kb3dIZWlnaHQoKXtpZih3aW5kb3cuaW5uZXJIZWlnaHQpe3JldHVybiB3aW5kb3cuaW5uZXJIZWlnaHQ7fWVsc2UgaWYoZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50JiZkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0KXtyZXR1cm4gZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodDt9ZWxzZSBpZihkb2N1bWVudC5ib2R5KXtyZXR1cm4gZG9jdW1lbnQuYm9keS5jbGllbnRIZWlnaHQ7fScsJ3JldHVybiAwO30nLCdmdW5jdGlvbiBnZXRUb29sQmFyc0hlaWdodCgpe3JldHVybiAkKFwic3dpdGNoZXNcIikub2Zmc2V0SGVpZ2h0O30nLCdmdW5jdGlvbiBnZXRDaHJvbWVIZWlnaHQoKXt2YXIgaGVpZ2h0PWdldFRvb2xCYXJzSGVpZ2h0KCk7aWYoc2hvd0NvbW1hbmRMaW5lKXtoZWlnaHQrPSQoXCJjb21tYW5kTGluZVwiKS5vZmZzZXRIZWlnaHQ7fScsJ3JldHVybiBoZWlnaHQ7fScsJ2Z1bmN0aW9uIHNldExvZ0NvbnRhaW5lckhlaWdodCgpe2lmKGxvZ01haW5Db250YWluZXIpe3ZhciB3aW5kb3dIZWlnaHQ9Z2V0V2luZG93SGVpZ2h0KCk7JChcImJvZHlcIikuc3R5bGUuaGVpZ2h0PWdldFdpbmRvd0hlaWdodCgpK1wicHhcIjtsb2dNYWluQ29udGFpbmVyLnN0eWxlLmhlaWdodD1cIlwiKycsJ01hdGgubWF4KDAsd2luZG93SGVpZ2h0LWdldENocm9tZUhlaWdodCgpKStcInB4XCI7fX0nLCdmdW5jdGlvbiBzZXRDb21tYW5kSW5wdXRXaWR0aCgpe2lmKHNob3dDb21tYW5kTGluZSl7JChcImNvbW1hbmRcIikuc3R5bGUud2lkdGg9XCJcIitNYXRoLm1heCgwLCQoXCJjb21tYW5kTGluZUNvbnRhaW5lclwiKS5vZmZzZXRXaWR0aC0nLCcoJChcImV2YWx1YXRlQnV0dG9uXCIpLm9mZnNldFdpZHRoKzEzKSkrXCJweFwiO319Jywnd2luZG93Lm9ucmVzaXplPWZ1bmN0aW9uKCl7c2V0Q29tbWFuZElucHV0V2lkdGgoKTtzZXRMb2dDb250YWluZXJIZWlnaHQoKTt9O2lmKCFBcnJheS5wcm90b3R5cGUucHVzaCl7QXJyYXkucHJvdG90eXBlLnB1c2g9ZnVuY3Rpb24oKXtmb3IodmFyIGk9MCxsZW49YXJndW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXNbdGhpcy5sZW5ndGhdPWFyZ3VtZW50c1tpXTt9JywncmV0dXJuIHRoaXMubGVuZ3RoO307fScsJ2lmKCFBcnJheS5wcm90b3R5cGUucG9wKXtBcnJheS5wcm90b3R5cGUucG9wPWZ1bmN0aW9uKCl7aWYodGhpcy5sZW5ndGg+MCl7dmFyIHZhbD10aGlzW3RoaXMubGVuZ3RoLTFdO3RoaXMubGVuZ3RoPXRoaXMubGVuZ3RoLTE7cmV0dXJuIHZhbDt9fTt9JywnaWYoIUFycmF5LnByb3RvdHlwZS5zaGlmdCl7QXJyYXkucHJvdG90eXBlLnNoaWZ0PWZ1bmN0aW9uKCl7aWYodGhpcy5sZW5ndGg+MCl7dmFyIGZpcnN0SXRlbT10aGlzWzBdO2Zvcih2YXIgaT0wLGxlbj10aGlzLmxlbmd0aC0xO2k8bGVuO2krKyl7dGhpc1tpXT10aGlzW2krMV07fScsJ3RoaXMubGVuZ3RoPXRoaXMubGVuZ3RoLTE7cmV0dXJuIGZpcnN0SXRlbTt9fTt9JywnaWYoIUFycmF5LnByb3RvdHlwZS5zcGxpY2Upe0FycmF5LnByb3RvdHlwZS5zcGxpY2U9ZnVuY3Rpb24oc3RhcnRJbmRleCxkZWxldGVDb3VudCl7dmFyIGl0ZW1zQWZ0ZXJEZWxldGVkPXRoaXMuc2xpY2Uoc3RhcnRJbmRleCtkZWxldGVDb3VudCk7dmFyIGl0ZW1zRGVsZXRlZD10aGlzLnNsaWNlKHN0YXJ0SW5kZXgsc3RhcnRJbmRleCtkZWxldGVDb3VudCk7dGhpcy5sZW5ndGg9c3RhcnRJbmRleDt2YXIgYXJndW1lbnRzQXJyYXk9W107Zm9yKHZhciBpPTAsbGVuPWFyZ3VtZW50cy5sZW5ndGg7aTxsZW47aSsrKXthcmd1bWVudHNBcnJheVtpXT1hcmd1bWVudHNbaV07fScsJ3ZhciBpdGVtc1RvQXBwZW5kPShhcmd1bWVudHNBcnJheS5sZW5ndGg+Mik/aXRlbXNBZnRlckRlbGV0ZWQ9YXJndW1lbnRzQXJyYXkuc2xpY2UoMikuY29uY2F0KGl0ZW1zQWZ0ZXJEZWxldGVkKTppdGVtc0FmdGVyRGVsZXRlZDtmb3IoaT0wLGxlbj1pdGVtc1RvQXBwZW5kLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMucHVzaChpdGVtc1RvQXBwZW5kW2ldKTt9JywncmV0dXJuIGl0ZW1zRGVsZXRlZDt9O30nLCdmdW5jdGlvbiBhcnJheV9yZW1vdmUoYXJyLHZhbCl7dmFyIGluZGV4PS0xO2Zvcih2YXIgaT0wLGxlbj1hcnIubGVuZ3RoO2k8bGVuO2krKyl7aWYoYXJyW2ldPT09dmFsKXtpbmRleD1pO2JyZWFrO319JywnaWYoaW5kZXg+PTApe2Fyci5zcGxpY2UoaW5kZXgsMSk7cmV0dXJuIGluZGV4O31lbHNle3JldHVybiBmYWxzZTt9fScsJ2Z1bmN0aW9uIGFycmF5X3JlbW92ZUZyb21TdGFydChhcnJheSxudW1iZXJUb1JlbW92ZSl7aWYoQXJyYXkucHJvdG90eXBlLnNwbGljZSl7YXJyYXkuc3BsaWNlKDAsbnVtYmVyVG9SZW1vdmUpO31lbHNle2Zvcih2YXIgaT1udW1iZXJUb1JlbW92ZSxsZW49YXJyYXkubGVuZ3RoO2k8bGVuO2krKyl7YXJyYXlbaS1udW1iZXJUb1JlbW92ZV09YXJyYXlbaV07fScsJ2FycmF5Lmxlbmd0aD1hcnJheS5sZW5ndGgtbnVtYmVyVG9SZW1vdmU7fScsJ3JldHVybiBhcnJheTt9JywnZnVuY3Rpb24gYXJyYXlfY29udGFpbnMoYXJyLHZhbCl7Zm9yKHZhciBpPTAsbGVuPWFyci5sZW5ndGg7aTxsZW47aSsrKXtpZihhcnJbaV09PXZhbCl7cmV0dXJuIHRydWU7fX0nLCdyZXR1cm4gZmFsc2U7fScsJ2Z1bmN0aW9uIGdldEVycm9yTWVzc2FnZShleCl7aWYoZXgubWVzc2FnZSl7cmV0dXJuIGV4Lm1lc3NhZ2U7fWVsc2UgaWYoZXguZGVzY3JpcHRpb24pe3JldHVybiBleC5kZXNjcmlwdGlvbjt9JywncmV0dXJuXCJcIitleDt9JywnZnVuY3Rpb24gbW92ZUNhcmV0VG9FbmQoaW5wdXQpe2lmKGlucHV0LnNldFNlbGVjdGlvblJhbmdlKXtpbnB1dC5mb2N1cygpO3ZhciBsZW5ndGg9aW5wdXQudmFsdWUubGVuZ3RoO2lucHV0LnNldFNlbGVjdGlvblJhbmdlKGxlbmd0aCxsZW5ndGgpO31lbHNlIGlmKGlucHV0LmNyZWF0ZVRleHRSYW5nZSl7dmFyIHJhbmdlPWlucHV0LmNyZWF0ZVRleHRSYW5nZSgpO3JhbmdlLmNvbGxhcHNlKGZhbHNlKTtyYW5nZS5zZWxlY3QoKTt9JywnaW5wdXQuZm9jdXMoKTt9JywnZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uKGV2dCl7aWYoZXZ0LnN0b3BQcm9wYWdhdGlvbil7ZXZ0LnN0b3BQcm9wYWdhdGlvbigpO31lbHNlIGlmKHR5cGVvZiBldnQuY2FuY2VsQnViYmxlIT1cInVuZGVmaW5lZFwiKXtldnQuY2FuY2VsQnViYmxlPXRydWU7fX0nLCdmdW5jdGlvbiBnZXRFdmVudChldnQpe3JldHVybiBldnQ/ZXZ0OmV2ZW50O30nLCdmdW5jdGlvbiBnZXRUYXJnZXQoZXZ0KXtyZXR1cm4gZXZ0LnRhcmdldD9ldnQudGFyZ2V0OmV2dC5zcmNFbGVtZW50O30nLCdmdW5jdGlvbiBnZXRSZWxhdGVkVGFyZ2V0KGV2dCl7aWYoZXZ0LnJlbGF0ZWRUYXJnZXQpe3JldHVybiBldnQucmVsYXRlZFRhcmdldDt9ZWxzZSBpZihldnQuc3JjRWxlbWVudCl7c3dpdGNoKGV2dC50eXBlKXtjYXNlXCJtb3VzZW92ZXJcIjpyZXR1cm4gZXZ0LmZyb21FbGVtZW50O2Nhc2VcIm1vdXNlb3V0XCI6cmV0dXJuIGV2dC50b0VsZW1lbnQ7ZGVmYXVsdDpyZXR1cm4gZXZ0LnNyY0VsZW1lbnQ7fX19JywnZnVuY3Rpb24gY2FuY2VsS2V5RXZlbnQoZXZ0KXtldnQucmV0dXJuVmFsdWU9ZmFsc2U7c3RvcFByb3BhZ2F0aW9uKGV2dCk7fScsJ2Z1bmN0aW9uIGV2YWxDb21tYW5kTGluZSgpe3ZhciBleHByPSQoXCJjb21tYW5kXCIpLnZhbHVlO2V2YWxDb21tYW5kKGV4cHIpOyQoXCJjb21tYW5kXCIpLnZhbHVlPVwiXCI7fScsJ2Z1bmN0aW9uIGV2YWxMYXN0Q29tbWFuZCgpe2lmKGxhc3RDb21tYW5kIT1udWxsKXtldmFsQ29tbWFuZChsYXN0Q29tbWFuZCk7fX0nLCd2YXIgbGFzdENvbW1hbmQ9bnVsbDt2YXIgY29tbWFuZEhpc3Rvcnk9W107dmFyIGN1cnJlbnRDb21tYW5kSW5kZXg9MDtmdW5jdGlvbiBldmFsQ29tbWFuZChleHByKXtpZihhcHBlbmRlcil7YXBwZW5kZXIuZXZhbENvbW1hbmRBbmRBcHBlbmQoZXhwcik7fWVsc2V7dmFyIHByZWZpeD1cIj4+PiBcIitleHByK1wiXFxcXHJcXFxcblwiO3RyeXtsb2coXCJJTkZPXCIscHJlZml4K2V2YWwoZXhwcikpO31jYXRjaChleCl7bG9nKFwiRVJST1JcIixwcmVmaXgrXCJFcnJvcjogXCIrZ2V0RXJyb3JNZXNzYWdlKGV4KSk7fX0nLCdpZihleHByIT1jb21tYW5kSGlzdG9yeVtjb21tYW5kSGlzdG9yeS5sZW5ndGgtMV0pe2NvbW1hbmRIaXN0b3J5LnB1c2goZXhwcik7aWYoYXBwZW5kZXIpe2FwcGVuZGVyLnN0b3JlQ29tbWFuZEhpc3RvcnkoY29tbWFuZEhpc3RvcnkpO319JywnY3VycmVudENvbW1hbmRJbmRleD0oZXhwcj09Y29tbWFuZEhpc3RvcnlbY3VycmVudENvbW1hbmRJbmRleF0pP2N1cnJlbnRDb21tYW5kSW5kZXgrMTpjb21tYW5kSGlzdG9yeS5sZW5ndGg7bGFzdENvbW1hbmQ9ZXhwcjt9JywnLy9dXT4nLCc8L3NjcmlwdD4nLCc8c3R5bGUgdHlwZT1cInRleHQvY3NzXCI+JywnYm9keXtiYWNrZ3JvdW5kLWNvbG9yOndoaXRlO2NvbG9yOmJsYWNrO3BhZGRpbmc6MDttYXJnaW46MDtmb250LWZhbWlseTp0YWhvbWEsdmVyZGFuYSxhcmlhbCxoZWx2ZXRpY2Esc2Fucy1zZXJpZjtvdmVyZmxvdzpoaWRkZW59ZGl2I3N3aXRjaGVzQ29udGFpbmVyIGlucHV0e21hcmdpbi1ib3R0b206MH1kaXYudG9vbGJhcntib3JkZXItdG9wOnNvbGlkICNmZmZmZmYgMXB4O2JvcmRlci1ib3R0b206c29saWQgI2FjYTg5OSAxcHg7YmFja2dyb3VuZC1jb2xvcjojZjFlZmU3O3BhZGRpbmc6M3B4IDVweDtmb250LXNpemU6NjguNzUlfWRpdi50b29sYmFyLGRpdiNzZWFyY2ggaW5wdXR7Zm9udC1mYW1pbHk6dGFob21hLHZlcmRhbmEsYXJpYWwsaGVsdmV0aWNhLHNhbnMtc2VyaWZ9ZGl2LnRvb2xiYXIgaW5wdXQuYnV0dG9ue3BhZGRpbmc6MCA1cHg7Zm9udC1zaXplOjEwMCV9ZGl2LnRvb2xiYXIgaW5wdXQuaGlkZGVue2Rpc3BsYXk6bm9uZX1kaXYjc3dpdGNoZXMgaW5wdXQjY2xlYXJCdXR0b257bWFyZ2luLWxlZnQ6MjBweH1kaXYjbGV2ZWxzIGxhYmVse2ZvbnQtd2VpZ2h0OmJvbGR9ZGl2I2xldmVscyBsYWJlbCxkaXYjb3B0aW9ucyBsYWJlbHttYXJnaW4tcmlnaHQ6NXB4fWRpdiNsZXZlbHMgbGFiZWwjd3JhcExhYmVse2ZvbnQtd2VpZ2h0Om5vcm1hbH1kaXYjc2VhcmNoIGxhYmVse21hcmdpbi1yaWdodDoxMHB4fWRpdiNzZWFyY2ggbGFiZWwuc2VhcmNoYm94bGFiZWx7bWFyZ2luLXJpZ2h0OjB9ZGl2I3NlYXJjaCBpbnB1dHtmb250LXNpemU6MTAwJX1kaXYjc2VhcmNoIGlucHV0LnZhbGlkcmVnZXh7Y29sb3I6Z3JlZW59ZGl2I3NlYXJjaCBpbnB1dC5pbnZhbGlkcmVnZXh7Y29sb3I6cmVkfWRpdiNzZWFyY2ggaW5wdXQubm9tYXRjaGVze2NvbG9yOndoaXRlO2JhY2tncm91bmQtY29sb3I6I2ZmNjY2Nn1kaXYjc2VhcmNoIGlucHV0Lm5vbWF0Y2hlc3tjb2xvcjp3aGl0ZTtiYWNrZ3JvdW5kLWNvbG9yOiNmZjY2NjZ9ZGl2I3NlYXJjaE5hdntkaXNwbGF5Om5vbmV9ZGl2I2NvbW1hbmRMaW5le2Rpc3BsYXk6bm9uZX1kaXYjY29tbWFuZExpbmUgaW5wdXQjY29tbWFuZHtmb250LXNpemU6MTAwJTtmb250LWZhbWlseTpDb3VyaWVyIE5ldyxDb3VyaWVyfWRpdiNjb21tYW5kTGluZSBpbnB1dCNldmFsdWF0ZUJ1dHRvbnt9Ki5ncmV5ZWRvdXR7Y29sb3I6Z3JheSAhaW1wb3J0YW50O2JvcmRlci1jb2xvcjpncmF5ICFpbXBvcnRhbnR9Ki5ncmV5ZWRvdXQgKi5hbHdheXNlbmFibGVke2NvbG9yOmJsYWNrfSoudW5zZWxlY3RhYmxley1raHRtbC11c2VyLXNlbGVjdDpub25lOy1tb3otdXNlci1zZWxlY3Q6bm9uZTt1c2VyLXNlbGVjdDpub25lfWRpdiNsb2d7Zm9udC1mYW1pbHk6Q291cmllciBOZXcsQ291cmllcjtmb250LXNpemU6NzUlO3dpZHRoOjEwMCU7b3ZlcmZsb3c6YXV0bztjbGVhcjpib3RoO3Bvc2l0aW9uOnJlbGF0aXZlfWRpdi5ncm91cHtib3JkZXItY29sb3I6I2NjY2NjYztib3JkZXItc3R5bGU6c29saWQ7Ym9yZGVyLXdpZHRoOjFweCAwIDFweCAxcHg7b3ZlcmZsb3c6dmlzaWJsZX1kaXYub2xkSWUgZGl2Lmdyb3VwLGRpdi5vbGRJZSBkaXYuZ3JvdXAgKixkaXYub2xkSWUgKi5sb2dlbnRyeXtoZWlnaHQ6MSV9ZGl2Lmdyb3VwIGRpdi5ncm91cGhlYWRpbmcgc3Bhbi5leHBhbmRlcntib3JkZXI6c29saWQgYmxhY2sgMXB4O2ZvbnQtZmFtaWx5OkNvdXJpZXIgTmV3LENvdXJpZXI7Zm9udC1zaXplOjAuODMzZW07YmFja2dyb3VuZC1jb2xvcjojZWVlZWVlO3Bvc2l0aW9uOnJlbGF0aXZlO3RvcDotMXB4O2NvbG9yOmJsYWNrO3BhZGRpbmc6MCAycHg7Y3Vyc29yOnBvaW50ZXI7Y3Vyc29yOmhhbmQ7aGVpZ2h0OjElfWRpdi5ncm91cCBkaXYuZ3JvdXBjb250ZW50e21hcmdpbi1sZWZ0OjEwcHg7cGFkZGluZy1ib3R0b206MnB4O292ZXJmbG93OnZpc2libGV9ZGl2Lmdyb3VwIGRpdi5leHBhbmRlZHtkaXNwbGF5OmJsb2NrfWRpdi5ncm91cCBkaXYuY29sbGFwc2Vke2Rpc3BsYXk6bm9uZX0qLmxvZ2VudHJ5e292ZXJmbG93OnZpc2libGU7ZGlzcGxheTpub25lO3doaXRlLXNwYWNlOnByZX1zcGFuLnByZXt3aGl0ZS1zcGFjZTpwcmV9cHJlLnVud3JhcHBlZHtkaXNwbGF5OmlubGluZSAhaW1wb3J0YW50fXByZS51bndyYXBwZWQgcHJlLnByZSxkaXYud3JhcHBlZCBwcmUucHJle2Rpc3BsYXk6aW5saW5lfWRpdi53cmFwcGVkIHByZS5wcmV7d2hpdGUtc3BhY2U6bm9ybWFsfWRpdi53cmFwcGVke2Rpc3BsYXk6bm9uZX1ib2R5LnNlYXJjaGluZyAqLmxvZ2VudHJ5IHNwYW4uY3VycmVudG1hdGNoe2NvbG9yOndoaXRlICFpbXBvcnRhbnQ7YmFja2dyb3VuZC1jb2xvcjpncmVlbiAhaW1wb3J0YW50fWJvZHkuc2VhcmNoaW5nIGRpdi5zZWFyY2hoaWdobGlnaHQgKi5sb2dlbnRyeSBzcGFuLnNlYXJjaHRlcm17Y29sb3I6YmxhY2s7YmFja2dyb3VuZC1jb2xvcjp5ZWxsb3d9ZGl2LndyYXAgKi5sb2dlbnRyeXt3aGl0ZS1zcGFjZTpub3JtYWwgIWltcG9ydGFudDtib3JkZXItd2lkdGg6MCAwIDFweCAwO2JvcmRlci1jb2xvcjojZGRkZGRkO2JvcmRlci1zdHlsZTpkb3R0ZWR9ZGl2LndyYXAgI2xvZ193cmFwcGVkLCNsb2dfdW53cmFwcGVke2Rpc3BsYXk6YmxvY2t9ZGl2LndyYXAgI2xvZ191bndyYXBwZWQsI2xvZ193cmFwcGVke2Rpc3BsYXk6bm9uZX1kaXYud3JhcCAqLmxvZ2VudHJ5IHNwYW4ucHJle292ZXJmbG93OnZpc2libGU7d2hpdGUtc3BhY2U6bm9ybWFsfWRpdi53cmFwICoubG9nZW50cnkgcHJlLnVud3JhcHBlZHtkaXNwbGF5Om5vbmV9ZGl2LndyYXAgKi5sb2dlbnRyeSBzcGFuLndyYXBwZWR7ZGlzcGxheTppbmxpbmV9ZGl2LnNlYXJjaGZpbHRlciAqLnNlYXJjaG5vbm1hdGNoe2Rpc3BsYXk6bm9uZSAhaW1wb3J0YW50fWRpdiNsb2cgKi5UUkFDRSxsYWJlbCNsYWJlbF9UUkFDRXtjb2xvcjojNjY2NjY2fWRpdiNsb2cgKi5ERUJVRyxsYWJlbCNsYWJlbF9ERUJVR3tjb2xvcjpncmVlbn1kaXYjbG9nICouSU5GTyxsYWJlbCNsYWJlbF9JTkZPe2NvbG9yOiMwMDAwOTl9ZGl2I2xvZyAqLldBUk4sbGFiZWwjbGFiZWxfV0FSTntjb2xvcjojOTk5OTAwfWRpdiNsb2cgKi5FUlJPUixsYWJlbCNsYWJlbF9FUlJPUntjb2xvcjpyZWR9ZGl2I2xvZyAqLkZBVEFMLGxhYmVsI2xhYmVsX0ZBVEFMe2NvbG9yOiM2NjAwNjZ9ZGl2LlRSQUNFI2xvZyAqLlRSQUNFLGRpdi5ERUJVRyNsb2cgKi5ERUJVRyxkaXYuSU5GTyNsb2cgKi5JTkZPLGRpdi5XQVJOI2xvZyAqLldBUk4sZGl2LkVSUk9SI2xvZyAqLkVSUk9SLGRpdi5GQVRBTCNsb2cgKi5GQVRBTHtkaXNwbGF5OmJsb2NrfWRpdiNsb2cgZGl2LnNlcGFyYXRvcntiYWNrZ3JvdW5kLWNvbG9yOiNjY2NjY2M7bWFyZ2luOjVweCAwO2xpbmUtaGVpZ2h0OjFweH0nLCc8L3N0eWxlPicsJzwvaGVhZD4nLCc8Ym9keSBpZD1cImJvZHlcIj4nLCc8ZGl2IGlkPVwic3dpdGNoZXNDb250YWluZXJcIj4nLCc8ZGl2IGlkPVwic3dpdGNoZXNcIj4nLCc8ZGl2IGlkPVwibGV2ZWxzXCIgY2xhc3M9XCJ0b29sYmFyXCI+JywnRmlsdGVyczonLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzd2l0Y2hfVFJBQ0VcIiBvbmNsaWNrPVwiYXBwbHlGaWx0ZXJzKCk7IGNoZWNrQWxsTGV2ZWxzKClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiU2hvdy9oaWRlIHRyYWNlIG1lc3NhZ2VzXCIgLz48bGFiZWwgZm9yPVwic3dpdGNoX1RSQUNFXCIgaWQ9XCJsYWJlbF9UUkFDRVwiPnRyYWNlPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzd2l0Y2hfREVCVUdcIiBvbmNsaWNrPVwiYXBwbHlGaWx0ZXJzKCk7IGNoZWNrQWxsTGV2ZWxzKClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiU2hvdy9oaWRlIGRlYnVnIG1lc3NhZ2VzXCIgLz48bGFiZWwgZm9yPVwic3dpdGNoX0RFQlVHXCIgaWQ9XCJsYWJlbF9ERUJVR1wiPmRlYnVnPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzd2l0Y2hfSU5GT1wiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgaW5mbyBtZXNzYWdlc1wiIC8+PGxhYmVsIGZvcj1cInN3aXRjaF9JTkZPXCIgaWQ9XCJsYWJlbF9JTkZPXCI+aW5mbzwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic3dpdGNoX1dBUk5cIiBvbmNsaWNrPVwiYXBwbHlGaWx0ZXJzKCk7IGNoZWNrQWxsTGV2ZWxzKClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiU2hvdy9oaWRlIHdhcm4gbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfV0FSTlwiIGlkPVwibGFiZWxfV0FSTlwiPndhcm48L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9FUlJPUlwiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgZXJyb3IgbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfRVJST1JcIiBpZD1cImxhYmVsX0VSUk9SXCI+ZXJyb3I8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9GQVRBTFwiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgZmF0YWwgbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfRkFUQUxcIiBpZD1cImxhYmVsX0ZBVEFMXCI+ZmF0YWw8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9BTExcIiBvbmNsaWNrPVwidG9nZ2xlQWxsTGV2ZWxzKCk7IGFwcGx5RmlsdGVycygpXCIgY2hlY2tlZD1cImNoZWNrZWRcIiB0aXRsZT1cIlNob3cvaGlkZSBhbGwgbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfQUxMXCIgaWQ9XCJsYWJlbF9BTExcIj5hbGw8L2xhYmVsPicsJzwvZGl2PicsJzxkaXYgaWQ9XCJzZWFyY2hcIiBjbGFzcz1cInRvb2xiYXJcIj4nLCc8bGFiZWwgZm9yPVwic2VhcmNoQm94XCIgY2xhc3M9XCJzZWFyY2hib3hsYWJlbFwiPlNlYXJjaDo8L2xhYmVsPiA8aW5wdXQgdHlwZT1cInRleHRcIiBpZD1cInNlYXJjaEJveFwiIG9uY2xpY2s9XCJ0b2dnbGVTZWFyY2hFbmFibGVkKHRydWUpXCIgb25rZXl1cD1cInNjaGVkdWxlU2VhcmNoKClcIiBzaXplPVwiMjBcIiAvPicsJzxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJzZWFyY2hSZXNldFwiIGRpc2FibGVkPVwiZGlzYWJsZWRcIiB2YWx1ZT1cIlJlc2V0XCIgb25jbGljaz1cImNsZWFyU2VhcmNoKClcIiBjbGFzcz1cImJ1dHRvblwiIHRpdGxlPVwiUmVzZXQgdGhlIHNlYXJjaFwiIC8+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic2VhcmNoUmVnZXhcIiBvbmNsaWNrPVwiZG9TZWFyY2goKVwiIHRpdGxlPVwiSWYgY2hlY2tlZCwgc2VhcmNoIGlzIHRyZWF0ZWQgYXMgYSByZWd1bGFyIGV4cHJlc3Npb25cIiAvPjxsYWJlbCBmb3I9XCJzZWFyY2hSZWdleFwiPlJlZ2V4PC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzZWFyY2hDYXNlU2Vuc2l0aXZlXCIgb25jbGljaz1cImRvU2VhcmNoKClcIiB0aXRsZT1cIklmIGNoZWNrZWQsIHNlYXJjaCBpcyBjYXNlIHNlbnNpdGl2ZVwiIC8+PGxhYmVsIGZvcj1cInNlYXJjaENhc2VTZW5zaXRpdmVcIj5NYXRjaCBjYXNlPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzZWFyY2hEaXNhYmxlXCIgb25jbGljaz1cInRvZ2dsZVNlYXJjaEVuYWJsZWQoKVwiIHRpdGxlPVwiRW5hYmxlL2Rpc2FibGUgc2VhcmNoXCIgLz48bGFiZWwgZm9yPVwic2VhcmNoRGlzYWJsZVwiIGNsYXNzPVwiYWx3YXlzZW5hYmxlZFwiPkRpc2FibGU8L2xhYmVsPicsJzxkaXYgaWQ9XCJzZWFyY2hOYXZcIj4nLCc8aW5wdXQgdHlwZT1cImJ1dHRvblwiIGlkPVwic2VhcmNoTmV4dFwiIGRpc2FibGVkPVwiZGlzYWJsZWRcIiB2YWx1ZT1cIk5leHRcIiBvbmNsaWNrPVwic2VhcmNoTmV4dCgpXCIgY2xhc3M9XCJidXR0b25cIiB0aXRsZT1cIkdvIHRvIHRoZSBuZXh0IG1hdGNoaW5nIGxvZyBlbnRyeVwiIC8+JywnPGlucHV0IHR5cGU9XCJidXR0b25cIiBpZD1cInNlYXJjaFByZXZpb3VzXCIgZGlzYWJsZWQ9XCJkaXNhYmxlZFwiIHZhbHVlPVwiUHJldmlvdXNcIiBvbmNsaWNrPVwic2VhcmNoUHJldmlvdXMoKVwiIGNsYXNzPVwiYnV0dG9uXCIgdGl0bGU9XCJHbyB0byB0aGUgcHJldmlvdXMgbWF0Y2hpbmcgbG9nIGVudHJ5XCIgLz4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzZWFyY2hGaWx0ZXJcIiBvbmNsaWNrPVwidG9nZ2xlU2VhcmNoRmlsdGVyKClcIiB0aXRsZT1cIklmIGNoZWNrZWQsIG5vbi1tYXRjaGluZyBsb2cgZW50cmllcyBhcmUgZmlsdGVyZWQgb3V0XCIgLz48bGFiZWwgZm9yPVwic2VhcmNoRmlsdGVyXCI+RmlsdGVyPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzZWFyY2hIaWdobGlnaHRcIiBvbmNsaWNrPVwidG9nZ2xlU2VhcmNoSGlnaGxpZ2h0KClcIiB0aXRsZT1cIkhpZ2hsaWdodCBtYXRjaGVkIHNlYXJjaCB0ZXJtc1wiIC8+PGxhYmVsIGZvcj1cInNlYXJjaEhpZ2hsaWdodFwiIGNsYXNzPVwiYWx3YXlzZW5hYmxlZFwiPkhpZ2hsaWdodCBhbGw8L2xhYmVsPicsJzwvZGl2PicsJzwvZGl2PicsJzxkaXYgaWQ9XCJvcHRpb25zXCIgY2xhc3M9XCJ0b29sYmFyXCI+JywnT3B0aW9uczonLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJlbmFibGVMb2dnaW5nXCIgb25jbGljaz1cInRvZ2dsZUxvZ2dpbmdFbmFibGVkKClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiRW5hYmxlL2Rpc2FibGUgbG9nZ2luZ1wiIC8+PGxhYmVsIGZvcj1cImVuYWJsZUxvZ2dpbmdcIiBpZD1cImVuYWJsZUxvZ2dpbmdMYWJlbFwiPkxvZzwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwid3JhcFwiIG9uY2xpY2s9XCJ0b2dnbGVXcmFwKClcIiB0aXRsZT1cIkVuYWJsZSAvIGRpc2FibGUgd29yZCB3cmFwXCIgLz48bGFiZWwgZm9yPVwid3JhcFwiIGlkPVwid3JhcExhYmVsXCI+V3JhcDwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwibmV3ZXN0QXRUb3BcIiBvbmNsaWNrPVwidG9nZ2xlTmV3ZXN0QXRUb3AoKVwiIHRpdGxlPVwiSWYgY2hlY2tlZCwgY2F1c2VzIG5ld2VzdCBtZXNzYWdlcyB0byBhcHBlYXIgYXQgdGhlIHRvcFwiIC8+PGxhYmVsIGZvcj1cIm5ld2VzdEF0VG9wXCIgaWQ9XCJuZXdlc3RBdFRvcExhYmVsXCI+TmV3ZXN0IGF0IHRoZSB0b3A8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInNjcm9sbFRvTGF0ZXN0XCIgb25jbGljaz1cInRvZ2dsZVNjcm9sbFRvTGF0ZXN0KClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiSWYgY2hlY2tlZCwgd2luZG93IGF1dG9tYXRpY2FsbHkgc2Nyb2xscyB0byBhIG5ldyBtZXNzYWdlIHdoZW4gaXQgaXMgYWRkZWRcIiAvPjxsYWJlbCBmb3I9XCJzY3JvbGxUb0xhdGVzdFwiIGlkPVwic2Nyb2xsVG9MYXRlc3RMYWJlbFwiPlNjcm9sbCB0byBsYXRlc3Q8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJjbGVhckJ1dHRvblwiIHZhbHVlPVwiQ2xlYXJcIiBvbmNsaWNrPVwiY2xlYXJMb2coKVwiIGNsYXNzPVwiYnV0dG9uXCIgdGl0bGU9XCJDbGVhciBhbGwgbG9nIG1lc3NhZ2VzXCIgIC8+JywnPGlucHV0IHR5cGU9XCJidXR0b25cIiBpZD1cImhpZGVCdXR0b25cIiB2YWx1ZT1cIkhpZGVcIiBvbmNsaWNrPVwiaGlkZSgpXCIgY2xhc3M9XCJoaWRkZW4gYnV0dG9uXCIgdGl0bGU9XCJIaWRlIHRoZSBjb25zb2xlXCIgLz4nLCc8aW5wdXQgdHlwZT1cImJ1dHRvblwiIGlkPVwiY2xvc2VCdXR0b25cIiB2YWx1ZT1cIkNsb3NlXCIgb25jbGljaz1cImNsb3NlV2luZG93KClcIiBjbGFzcz1cImhpZGRlbiBidXR0b25cIiB0aXRsZT1cIkNsb3NlIHRoZSB3aW5kb3dcIiAvPicsJzwvZGl2PicsJzwvZGl2PicsJzwvZGl2PicsJzxkaXYgaWQ9XCJsb2dcIiBjbGFzcz1cIlRSQUNFIERFQlVHIElORk8gV0FSTiBFUlJPUiBGQVRBTFwiPjwvZGl2PicsJzxkaXYgaWQ9XCJjb21tYW5kTGluZVwiIGNsYXNzPVwidG9vbGJhclwiPicsJzxkaXYgaWQ9XCJjb21tYW5kTGluZUNvbnRhaW5lclwiPicsJzxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwiY29tbWFuZFwiIHRpdGxlPVwiRW50ZXIgYSBKYXZhU2NyaXB0IGNvbW1hbmQgaGVyZSBhbmQgaGl0IHJldHVybiBvciBwcmVzcyBcXCdFdmFsdWF0ZVxcJ1wiIC8+JywnPGlucHV0IHR5cGU9XCJidXR0b25cIiBpZD1cImV2YWx1YXRlQnV0dG9uXCIgdmFsdWU9XCJFdmFsdWF0ZVwiIGNsYXNzPVwiYnV0dG9uXCIgdGl0bGU9XCJFdmFsdWF0ZSB0aGUgY29tbWFuZFwiIG9uY2xpY2s9XCJldmFsQ29tbWFuZExpbmUoKVwiIC8+JywnPC9kaXY+JywnPC9kaXY+JywnPC9ib2R5PicsJzwvaHRtbD4nLCcnXTt9O3ZhciBkZWZhdWx0Q29tbWFuZExpbmVGdW5jdGlvbnM9W107Q29uc29sZUFwcGVuZGVyPWZ1bmN0aW9uKCl7fTt2YXIgY29uc29sZUFwcGVuZGVySWRDb3VudGVyPTE7Q29uc29sZUFwcGVuZGVyLnByb3RvdHlwZT1uZXcgQXBwZW5kZXIoKTtDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmNyZWF0ZT1mdW5jdGlvbihpblBhZ2UsY29udGFpbmVyLGxhenlJbml0LGluaXRpYWxseU1pbmltaXplZCx1c2VEb2N1bWVudFdyaXRlLHdpZHRoLGhlaWdodCxmb2N1c0NvbnNvbGVXaW5kb3cpe3ZhciBhcHBlbmRlcj10aGlzO3ZhciBpbml0aWFsaXplZD1mYWxzZTt2YXIgY29uc29sZVdpbmRvd0NyZWF0ZWQ9ZmFsc2U7dmFyIGNvbnNvbGVXaW5kb3dMb2FkZWQ9ZmFsc2U7dmFyIGNvbnNvbGVDbG9zZWQ9ZmFsc2U7dmFyIHF1ZXVlZExvZ2dpbmdFdmVudHM9W107dmFyIGlzU3VwcG9ydGVkPXRydWU7dmFyIGNvbnNvbGVBcHBlbmRlcklkPWNvbnNvbGVBcHBlbmRlcklkQ291bnRlcisrO2luaXRpYWxseU1pbmltaXplZD1leHRyYWN0Qm9vbGVhbkZyb21QYXJhbShpbml0aWFsbHlNaW5pbWl6ZWQsdGhpcy5kZWZhdWx0cy5pbml0aWFsbHlNaW5pbWl6ZWQpO2xhenlJbml0PWV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKGxhenlJbml0LHRoaXMuZGVmYXVsdHMubGF6eUluaXQpO3VzZURvY3VtZW50V3JpdGU9ZXh0cmFjdEJvb2xlYW5Gcm9tUGFyYW0odXNlRG9jdW1lbnRXcml0ZSx0aGlzLmRlZmF1bHRzLnVzZURvY3VtZW50V3JpdGUpO3ZhciBuZXdlc3RNZXNzYWdlQXRUb3A9dGhpcy5kZWZhdWx0cy5uZXdlc3RNZXNzYWdlQXRUb3A7dmFyIHNjcm9sbFRvTGF0ZXN0TWVzc2FnZT10aGlzLmRlZmF1bHRzLnNjcm9sbFRvTGF0ZXN0TWVzc2FnZTt3aWR0aD13aWR0aD93aWR0aDp0aGlzLmRlZmF1bHRzLndpZHRoO2hlaWdodD1oZWlnaHQ/aGVpZ2h0OnRoaXMuZGVmYXVsdHMuaGVpZ2h0O3ZhciBtYXhNZXNzYWdlcz10aGlzLmRlZmF1bHRzLm1heE1lc3NhZ2VzO3ZhciBzaG93Q29tbWFuZExpbmU9dGhpcy5kZWZhdWx0cy5zaG93Q29tbWFuZExpbmU7dmFyIGNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg9dGhpcy5kZWZhdWx0cy5jb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoO3ZhciBzaG93SGlkZUJ1dHRvbj10aGlzLmRlZmF1bHRzLnNob3dIaWRlQnV0dG9uO3ZhciBzaG93Q2xvc2VCdXR0b249dGhpcy5kZWZhdWx0cy5zaG93Q2xvc2VCdXR0b247dGhpcy5zZXRMYXlvdXQodGhpcy5kZWZhdWx0cy5sYXlvdXQpO3ZhciBpbml0LGNyZWF0ZVdpbmRvdyxzYWZlVG9BcHBlbmQsZ2V0Q29uc29sZVdpbmRvdyxvcGVuO3ZhciBhcHBlbmRlck5hbWU9aW5QYWdlP1wiSW5QYWdlQXBwZW5kZXJcIjpcIlBvcFVwQXBwZW5kZXJcIjt2YXIgY2hlY2tDYW5Db25maWd1cmU9ZnVuY3Rpb24oY29uZmlnT3B0aW9uTmFtZSl7aWYoY29uc29sZVdpbmRvd0NyZWF0ZWQpe2hhbmRsZUVycm9yKGFwcGVuZGVyTmFtZStcIjogY29uZmlndXJhdGlvbiBvcHRpb24gJ1wiK2NvbmZpZ09wdGlvbk5hbWUrXCInIG1heSBub3QgYmUgc2V0IGFmdGVyIHRoZSBhcHBlbmRlciBoYXMgYmVlbiBpbml0aWFsaXplZFwiKTtyZXR1cm4gZmFsc2U7fVxyXG5yZXR1cm4gdHJ1ZTt9O3ZhciBjb25zb2xlV2luZG93RXhpc3RzPWZ1bmN0aW9uKCl7cmV0dXJuKGNvbnNvbGVXaW5kb3dMb2FkZWQmJmlzU3VwcG9ydGVkJiYhY29uc29sZUNsb3NlZCk7fTt0aGlzLmlzTmV3ZXN0TWVzc2FnZUF0VG9wPWZ1bmN0aW9uKCl7cmV0dXJuIG5ld2VzdE1lc3NhZ2VBdFRvcDt9O3RoaXMuc2V0TmV3ZXN0TWVzc2FnZUF0VG9wPWZ1bmN0aW9uKG5ld2VzdE1lc3NhZ2VBdFRvcFBhcmFtKXtuZXdlc3RNZXNzYWdlQXRUb3A9Ym9vbChuZXdlc3RNZXNzYWdlQXRUb3BQYXJhbSk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0TmV3ZXN0QXRUb3AobmV3ZXN0TWVzc2FnZUF0VG9wKTt9fTt0aGlzLmlzU2Nyb2xsVG9MYXRlc3RNZXNzYWdlPWZ1bmN0aW9uKCl7cmV0dXJuIHNjcm9sbFRvTGF0ZXN0TWVzc2FnZTt9O3RoaXMuc2V0U2Nyb2xsVG9MYXRlc3RNZXNzYWdlPWZ1bmN0aW9uKHNjcm9sbFRvTGF0ZXN0TWVzc2FnZVBhcmFtKXtzY3JvbGxUb0xhdGVzdE1lc3NhZ2U9Ym9vbChzY3JvbGxUb0xhdGVzdE1lc3NhZ2VQYXJhbSk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0U2Nyb2xsVG9MYXRlc3Qoc2Nyb2xsVG9MYXRlc3RNZXNzYWdlKTt9fTt0aGlzLmdldFdpZHRoPWZ1bmN0aW9uKCl7cmV0dXJuIHdpZHRoO307dGhpcy5zZXRXaWR0aD1mdW5jdGlvbih3aWR0aFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcIndpZHRoXCIpKXt3aWR0aD1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKHdpZHRoUGFyYW0sd2lkdGgpO319O3RoaXMuZ2V0SGVpZ2h0PWZ1bmN0aW9uKCl7cmV0dXJuIGhlaWdodDt9O3RoaXMuc2V0SGVpZ2h0PWZ1bmN0aW9uKGhlaWdodFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcImhlaWdodFwiKSl7aGVpZ2h0PWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0oaGVpZ2h0UGFyYW0saGVpZ2h0KTt9fTt0aGlzLmdldE1heE1lc3NhZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIG1heE1lc3NhZ2VzO307dGhpcy5zZXRNYXhNZXNzYWdlcz1mdW5jdGlvbihtYXhNZXNzYWdlc1BhcmFtKXttYXhNZXNzYWdlcz1leHRyYWN0SW50RnJvbVBhcmFtKG1heE1lc3NhZ2VzUGFyYW0sbWF4TWVzc2FnZXMpO2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7Z2V0Q29uc29sZVdpbmRvdygpLnNldE1heE1lc3NhZ2VzKG1heE1lc3NhZ2VzKTt9fTt0aGlzLmlzU2hvd0NvbW1hbmRMaW5lPWZ1bmN0aW9uKCl7cmV0dXJuIHNob3dDb21tYW5kTGluZTt9O3RoaXMuc2V0U2hvd0NvbW1hbmRMaW5lPWZ1bmN0aW9uKHNob3dDb21tYW5kTGluZVBhcmFtKXtzaG93Q29tbWFuZExpbmU9Ym9vbChzaG93Q29tbWFuZExpbmVQYXJhbSk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0U2hvd0NvbW1hbmRMaW5lKHNob3dDb21tYW5kTGluZSk7fX07dGhpcy5pc1Nob3dIaWRlQnV0dG9uPWZ1bmN0aW9uKCl7cmV0dXJuIHNob3dIaWRlQnV0dG9uO307dGhpcy5zZXRTaG93SGlkZUJ1dHRvbj1mdW5jdGlvbihzaG93SGlkZUJ1dHRvblBhcmFtKXtzaG93SGlkZUJ1dHRvbj1ib29sKHNob3dIaWRlQnV0dG9uUGFyYW0pO2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7Z2V0Q29uc29sZVdpbmRvdygpLnNldFNob3dIaWRlQnV0dG9uKHNob3dIaWRlQnV0dG9uKTt9fTt0aGlzLmlzU2hvd0Nsb3NlQnV0dG9uPWZ1bmN0aW9uKCl7cmV0dXJuIHNob3dDbG9zZUJ1dHRvbjt9O3RoaXMuc2V0U2hvd0Nsb3NlQnV0dG9uPWZ1bmN0aW9uKHNob3dDbG9zZUJ1dHRvblBhcmFtKXtzaG93Q2xvc2VCdXR0b249Ym9vbChzaG93Q2xvc2VCdXR0b25QYXJhbSk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0U2hvd0Nsb3NlQnV0dG9uKHNob3dDbG9zZUJ1dHRvbik7fX07dGhpcy5nZXRDb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoPWZ1bmN0aW9uKCl7cmV0dXJuIGNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg7fTt0aGlzLnNldENvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg9ZnVuY3Rpb24oY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aFBhcmFtKXtjb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoPWV4dHJhY3RJbnRGcm9tUGFyYW0oY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aFBhcmFtLGNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGgpO307dmFyIG1pbmltaXplZD1pbml0aWFsbHlNaW5pbWl6ZWQ7dGhpcy5pc0luaXRpYWxseU1pbmltaXplZD1mdW5jdGlvbigpe3JldHVybiBpbml0aWFsbHlNaW5pbWl6ZWQ7fTt0aGlzLnNldEluaXRpYWxseU1pbmltaXplZD1mdW5jdGlvbihpbml0aWFsbHlNaW5pbWl6ZWRQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJpbml0aWFsbHlNaW5pbWl6ZWRcIikpe2luaXRpYWxseU1pbmltaXplZD1ib29sKGluaXRpYWxseU1pbmltaXplZFBhcmFtKTttaW5pbWl6ZWQ9aW5pdGlhbGx5TWluaW1pemVkO319O3RoaXMuaXNVc2VEb2N1bWVudFdyaXRlPWZ1bmN0aW9uKCl7cmV0dXJuIHVzZURvY3VtZW50V3JpdGU7fTt0aGlzLnNldFVzZURvY3VtZW50V3JpdGU9ZnVuY3Rpb24odXNlRG9jdW1lbnRXcml0ZVBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcInVzZURvY3VtZW50V3JpdGVcIikpe3VzZURvY3VtZW50V3JpdGU9Ym9vbCh1c2VEb2N1bWVudFdyaXRlUGFyYW0pO319O2Z1bmN0aW9uIFF1ZXVlZExvZ2dpbmdFdmVudChsb2dnaW5nRXZlbnQsZm9ybWF0dGVkTWVzc2FnZSl7dGhpcy5sb2dnaW5nRXZlbnQ9bG9nZ2luZ0V2ZW50O3RoaXMubGV2ZWxOYW1lPWxvZ2dpbmdFdmVudC5sZXZlbC5uYW1lO3RoaXMuZm9ybWF0dGVkTWVzc2FnZT1mb3JtYXR0ZWRNZXNzYWdlO31cclxuUXVldWVkTG9nZ2luZ0V2ZW50LnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24oKXtnZXRDb25zb2xlV2luZG93KCkubG9nKHRoaXMubGV2ZWxOYW1lLHRoaXMuZm9ybWF0dGVkTWVzc2FnZSk7fTtmdW5jdGlvbiBRdWV1ZWRHcm91cChuYW1lLGluaXRpYWxseUV4cGFuZGVkKXt0aGlzLm5hbWU9bmFtZTt0aGlzLmluaXRpYWxseUV4cGFuZGVkPWluaXRpYWxseUV4cGFuZGVkO31cclxuUXVldWVkR3JvdXAucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbigpe2dldENvbnNvbGVXaW5kb3coKS5ncm91cCh0aGlzLm5hbWUsdGhpcy5pbml0aWFsbHlFeHBhbmRlZCk7fTtmdW5jdGlvbiBRdWV1ZWRHcm91cEVuZCgpe31cclxuUXVldWVkR3JvdXBFbmQucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbigpe2dldENvbnNvbGVXaW5kb3coKS5ncm91cEVuZCgpO307dmFyIGNoZWNrQW5kQXBwZW5kPWZ1bmN0aW9uKCl7c2FmZVRvQXBwZW5kKCk7aWYoIWluaXRpYWxpemVkKXtpbml0KCk7fWVsc2UgaWYoY29uc29sZUNsb3NlZCYmcmVvcGVuV2hlbkNsb3NlZCl7Y3JlYXRlV2luZG93KCk7fVxyXG5pZihzYWZlVG9BcHBlbmQoKSl7YXBwZW5kUXVldWVkTG9nZ2luZ0V2ZW50cygpO319O3RoaXMuYXBwZW5kPWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7aWYoaXNTdXBwb3J0ZWQpe3ZhciBmb3JtYXR0ZWRNZXNzYWdlPWFwcGVuZGVyLmdldExheW91dCgpLmZvcm1hdFdpdGhFeGNlcHRpb24obG9nZ2luZ0V2ZW50KTtxdWV1ZWRMb2dnaW5nRXZlbnRzLnB1c2gobmV3IFF1ZXVlZExvZ2dpbmdFdmVudChsb2dnaW5nRXZlbnQsZm9ybWF0dGVkTWVzc2FnZSkpO2NoZWNrQW5kQXBwZW5kKCk7fX07dGhpcy5ncm91cD1mdW5jdGlvbihuYW1lLGluaXRpYWxseUV4cGFuZGVkKXtpZihpc1N1cHBvcnRlZCl7cXVldWVkTG9nZ2luZ0V2ZW50cy5wdXNoKG5ldyBRdWV1ZWRHcm91cChuYW1lLGluaXRpYWxseUV4cGFuZGVkKSk7Y2hlY2tBbmRBcHBlbmQoKTt9fTt0aGlzLmdyb3VwRW5kPWZ1bmN0aW9uKCl7aWYoaXNTdXBwb3J0ZWQpe3F1ZXVlZExvZ2dpbmdFdmVudHMucHVzaChuZXcgUXVldWVkR3JvdXBFbmQoKSk7Y2hlY2tBbmRBcHBlbmQoKTt9fTt2YXIgYXBwZW5kUXVldWVkTG9nZ2luZ0V2ZW50cz1mdW5jdGlvbigpe3doaWxlKHF1ZXVlZExvZ2dpbmdFdmVudHMubGVuZ3RoPjApe3F1ZXVlZExvZ2dpbmdFdmVudHMuc2hpZnQoKS5hcHBlbmQoKTt9XHJcbmlmKGZvY3VzQ29uc29sZVdpbmRvdyl7Z2V0Q29uc29sZVdpbmRvdygpLmZvY3VzKCk7fX07dGhpcy5zZXRBZGRlZFRvTG9nZ2VyPWZ1bmN0aW9uKGxvZ2dlcil7dGhpcy5sb2dnZXJzLnB1c2gobG9nZ2VyKTtpZihlbmFibGVkJiYhbGF6eUluaXQpe2luaXQoKTt9fTt0aGlzLmNsZWFyPWZ1bmN0aW9uKCl7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuY2xlYXJMb2coKTt9XHJcbnF1ZXVlZExvZ2dpbmdFdmVudHMubGVuZ3RoPTA7fTt0aGlzLmZvY3VzPWZ1bmN0aW9uKCl7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuZm9jdXMoKTt9fTt0aGlzLmZvY3VzQ29tbWFuZExpbmU9ZnVuY3Rpb24oKXtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5mb2N1c0NvbW1hbmRMaW5lKCk7fX07dGhpcy5mb2N1c1NlYXJjaD1mdW5jdGlvbigpe2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7Z2V0Q29uc29sZVdpbmRvdygpLmZvY3VzU2VhcmNoKCk7fX07dmFyIGNvbW1hbmRXaW5kb3c9d2luZG93O3RoaXMuZ2V0Q29tbWFuZFdpbmRvdz1mdW5jdGlvbigpe3JldHVybiBjb21tYW5kV2luZG93O307dGhpcy5zZXRDb21tYW5kV2luZG93PWZ1bmN0aW9uKGNvbW1hbmRXaW5kb3dQYXJhbSl7Y29tbWFuZFdpbmRvdz1jb21tYW5kV2luZG93UGFyYW07fTt0aGlzLmV4ZWN1dGVMYXN0Q29tbWFuZD1mdW5jdGlvbigpe2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7Z2V0Q29uc29sZVdpbmRvdygpLmV2YWxMYXN0Q29tbWFuZCgpO319O3ZhciBjb21tYW5kTGF5b3V0PW5ldyBQYXR0ZXJuTGF5b3V0KFwiJW1cIik7dGhpcy5nZXRDb21tYW5kTGF5b3V0PWZ1bmN0aW9uKCl7cmV0dXJuIGNvbW1hbmRMYXlvdXQ7fTt0aGlzLnNldENvbW1hbmRMYXlvdXQ9ZnVuY3Rpb24oY29tbWFuZExheW91dFBhcmFtKXtjb21tYW5kTGF5b3V0PWNvbW1hbmRMYXlvdXRQYXJhbTt9O3RoaXMuZXZhbENvbW1hbmRBbmRBcHBlbmQ9ZnVuY3Rpb24oZXhwcil7dmFyIGNvbW1hbmRSZXR1cm5WYWx1ZT17YXBwZW5kUmVzdWx0OnRydWUsaXNFcnJvcjpmYWxzZX07dmFyIGNvbW1hbmRPdXRwdXQ9XCJcIjt0cnl7dmFyIHJlc3VsdCxpO2lmKCFjb21tYW5kV2luZG93LmV2YWwmJmNvbW1hbmRXaW5kb3cuZXhlY1NjcmlwdCl7Y29tbWFuZFdpbmRvdy5leGVjU2NyaXB0KFwibnVsbFwiKTt9XHJcbnZhciBjb21tYW5kTGluZUZ1bmN0aW9uc0hhc2g9e307Zm9yKGk9MCxsZW49Y29tbWFuZExpbmVGdW5jdGlvbnMubGVuZ3RoO2k8bGVuO2krKyl7Y29tbWFuZExpbmVGdW5jdGlvbnNIYXNoW2NvbW1hbmRMaW5lRnVuY3Rpb25zW2ldWzBdXT1jb21tYW5kTGluZUZ1bmN0aW9uc1tpXVsxXTt9XHJcbnZhciBvYmplY3RzVG9SZXN0b3JlPVtdO3ZhciBhZGRPYmplY3RUb1Jlc3RvcmU9ZnVuY3Rpb24obmFtZSl7b2JqZWN0c1RvUmVzdG9yZS5wdXNoKFtuYW1lLGNvbW1hbmRXaW5kb3dbbmFtZV1dKTt9O2FkZE9iamVjdFRvUmVzdG9yZShcImFwcGVuZGVyXCIpO2NvbW1hbmRXaW5kb3cuYXBwZW5kZXI9YXBwZW5kZXI7YWRkT2JqZWN0VG9SZXN0b3JlKFwiY29tbWFuZFJldHVyblZhbHVlXCIpO2NvbW1hbmRXaW5kb3cuY29tbWFuZFJldHVyblZhbHVlPWNvbW1hbmRSZXR1cm5WYWx1ZTthZGRPYmplY3RUb1Jlc3RvcmUoXCJjb21tYW5kTGluZUZ1bmN0aW9uc0hhc2hcIik7Y29tbWFuZFdpbmRvdy5jb21tYW5kTGluZUZ1bmN0aW9uc0hhc2g9Y29tbWFuZExpbmVGdW5jdGlvbnNIYXNoO3ZhciBhZGRGdW5jdGlvblRvV2luZG93PWZ1bmN0aW9uKG5hbWUpe2FkZE9iamVjdFRvUmVzdG9yZShuYW1lKTtjb21tYW5kV2luZG93W25hbWVdPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tbWFuZExpbmVGdW5jdGlvbnNIYXNoW25hbWVdKGFwcGVuZGVyLGFyZ3VtZW50cyxjb21tYW5kUmV0dXJuVmFsdWUpO307fTtmb3IoaT0wLGxlbj1jb21tYW5kTGluZUZ1bmN0aW9ucy5sZW5ndGg7aTxsZW47aSsrKXthZGRGdW5jdGlvblRvV2luZG93KGNvbW1hbmRMaW5lRnVuY3Rpb25zW2ldWzBdKTt9XHJcbmlmKGNvbW1hbmRXaW5kb3c9PT13aW5kb3cmJmNvbW1hbmRXaW5kb3cuZXhlY1NjcmlwdCl7YWRkT2JqZWN0VG9SZXN0b3JlKFwiZXZhbEV4cHJcIik7YWRkT2JqZWN0VG9SZXN0b3JlKFwicmVzdWx0XCIpO3dpbmRvdy5ldmFsRXhwcj1leHByO2NvbW1hbmRXaW5kb3cuZXhlY1NjcmlwdChcIndpbmRvdy5yZXN1bHQ9ZXZhbCh3aW5kb3cuZXZhbEV4cHIpO1wiKTtyZXN1bHQ9d2luZG93LnJlc3VsdDt9ZWxzZXtyZXN1bHQ9Y29tbWFuZFdpbmRvdy5ldmFsKGV4cHIpO31cclxuY29tbWFuZE91dHB1dD1pc1VuZGVmaW5lZChyZXN1bHQpP3Jlc3VsdDpmb3JtYXRPYmplY3RFeHBhbnNpb24ocmVzdWx0LGNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGgpO2ZvcihpPTAsbGVuPW9iamVjdHNUb1Jlc3RvcmUubGVuZ3RoO2k8bGVuO2krKyl7Y29tbWFuZFdpbmRvd1tvYmplY3RzVG9SZXN0b3JlW2ldWzBdXT1vYmplY3RzVG9SZXN0b3JlW2ldWzFdO319Y2F0Y2goZXgpe2NvbW1hbmRPdXRwdXQ9XCJFcnJvciBldmFsdWF0aW5nIGNvbW1hbmQ6IFwiK2dldEV4Y2VwdGlvblN0cmluZ1JlcChleCk7Y29tbWFuZFJldHVyblZhbHVlLmlzRXJyb3I9dHJ1ZTt9XHJcbmlmKGNvbW1hbmRSZXR1cm5WYWx1ZS5hcHBlbmRSZXN1bHQpe3ZhciBtZXNzYWdlPVwiPj4+IFwiK2V4cHI7aWYoIWlzVW5kZWZpbmVkKGNvbW1hbmRPdXRwdXQpKXttZXNzYWdlKz1uZXdMaW5lK2NvbW1hbmRPdXRwdXQ7fVxyXG52YXIgbGV2ZWw9Y29tbWFuZFJldHVyblZhbHVlLmlzRXJyb3I/TGV2ZWwuRVJST1I6TGV2ZWwuSU5GTzt2YXIgbG9nZ2luZ0V2ZW50PW5ldyBMb2dnaW5nRXZlbnQobnVsbCxuZXcgRGF0ZSgpLGxldmVsLFttZXNzYWdlXSxudWxsKTt2YXIgbWFpbkxheW91dD10aGlzLmdldExheW91dCgpO3RoaXMuc2V0TGF5b3V0KGNvbW1hbmRMYXlvdXQpO3RoaXMuYXBwZW5kKGxvZ2dpbmdFdmVudCk7dGhpcy5zZXRMYXlvdXQobWFpbkxheW91dCk7fX07dmFyIGNvbW1hbmRMaW5lRnVuY3Rpb25zPWRlZmF1bHRDb21tYW5kTGluZUZ1bmN0aW9ucy5jb25jYXQoW10pO3RoaXMuYWRkQ29tbWFuZExpbmVGdW5jdGlvbj1mdW5jdGlvbihmdW5jdGlvbk5hbWUsY29tbWFuZExpbmVGdW5jdGlvbil7Y29tbWFuZExpbmVGdW5jdGlvbnMucHVzaChbZnVuY3Rpb25OYW1lLGNvbW1hbmRMaW5lRnVuY3Rpb25dKTt9O3ZhciBjb21tYW5kSGlzdG9yeUNvb2tpZU5hbWU9XCJsb2c0amF2YXNjcmlwdENvbW1hbmRIaXN0b3J5XCI7dGhpcy5zdG9yZUNvbW1hbmRIaXN0b3J5PWZ1bmN0aW9uKGNvbW1hbmRIaXN0b3J5KXtzZXRDb29raWUoY29tbWFuZEhpc3RvcnlDb29raWVOYW1lLGNvbW1hbmRIaXN0b3J5LmpvaW4oXCIsXCIpKTt9O3ZhciB3cml0ZUh0bWw9ZnVuY3Rpb24oZG9jKXt2YXIgbGluZXM9Z2V0Q29uc29sZUh0bWxMaW5lcygpO2RvYy5vcGVuKCk7Zm9yKHZhciBpPTAsbGVuPWxpbmVzLmxlbmd0aDtpPGxlbjtpKyspe2RvYy53cml0ZWxuKGxpbmVzW2ldKTt9XHJcbmRvYy5jbG9zZSgpO307dGhpcy5zZXRFdmVudFR5cGVzKFtcImxvYWRcIixcInVubG9hZFwiXSk7dmFyIGNvbnNvbGVXaW5kb3dMb2FkSGFuZGxlcj1mdW5jdGlvbigpe3ZhciB3aW49Z2V0Q29uc29sZVdpbmRvdygpO3dpbi5zZXRBcHBlbmRlcihhcHBlbmRlcik7d2luLnNldE5ld2VzdEF0VG9wKG5ld2VzdE1lc3NhZ2VBdFRvcCk7d2luLnNldFNjcm9sbFRvTGF0ZXN0KHNjcm9sbFRvTGF0ZXN0TWVzc2FnZSk7d2luLnNldE1heE1lc3NhZ2VzKG1heE1lc3NhZ2VzKTt3aW4uc2V0U2hvd0NvbW1hbmRMaW5lKHNob3dDb21tYW5kTGluZSk7d2luLnNldFNob3dIaWRlQnV0dG9uKHNob3dIaWRlQnV0dG9uKTt3aW4uc2V0U2hvd0Nsb3NlQnV0dG9uKHNob3dDbG9zZUJ1dHRvbik7d2luLnNldE1haW5XaW5kb3cod2luZG93KTt2YXIgc3RvcmVkVmFsdWU9Z2V0Q29va2llKGNvbW1hbmRIaXN0b3J5Q29va2llTmFtZSk7aWYoc3RvcmVkVmFsdWUpe3dpbi5jb21tYW5kSGlzdG9yeT1zdG9yZWRWYWx1ZS5zcGxpdChcIixcIik7d2luLmN1cnJlbnRDb21tYW5kSW5kZXg9d2luLmNvbW1hbmRIaXN0b3J5Lmxlbmd0aDt9XHJcbmFwcGVuZGVyLmRpc3BhdGNoRXZlbnQoXCJsb2FkXCIse1wid2luXCI6d2lufSk7fTt0aGlzLnVubG9hZD1mdW5jdGlvbigpe2xvZ0xvZy5kZWJ1ZyhcInVubG9hZCBcIit0aGlzK1wiLCBjYWxsZXI6IFwiK3RoaXMudW5sb2FkLmNhbGxlcik7aWYoIWNvbnNvbGVDbG9zZWQpe2xvZ0xvZy5kZWJ1ZyhcInJlYWxseSBkb2luZyB1bmxvYWQgXCIrdGhpcyk7Y29uc29sZUNsb3NlZD10cnVlO2NvbnNvbGVXaW5kb3dMb2FkZWQ9ZmFsc2U7Y29uc29sZVdpbmRvd0NyZWF0ZWQ9ZmFsc2U7YXBwZW5kZXIuZGlzcGF0Y2hFdmVudChcInVubG9hZFwiLHt9KTt9fTt2YXIgcG9sbENvbnNvbGVXaW5kb3c9ZnVuY3Rpb24od2luZG93VGVzdCxpbnRlcnZhbCxzdWNjZXNzQ2FsbGJhY2ssZXJyb3JNZXNzYWdlKXtmdW5jdGlvbiBkb1BvbGwoKXt0cnl7aWYoY29uc29sZUNsb3NlZCl7Y2xlYXJJbnRlcnZhbChwb2xsKTt9XHJcbmlmKHdpbmRvd1Rlc3QoZ2V0Q29uc29sZVdpbmRvdygpKSl7Y2xlYXJJbnRlcnZhbChwb2xsKTtzdWNjZXNzQ2FsbGJhY2soKTt9fWNhdGNoKGV4KXtjbGVhckludGVydmFsKHBvbGwpO2lzU3VwcG9ydGVkPWZhbHNlO2hhbmRsZUVycm9yKGVycm9yTWVzc2FnZSxleCk7fX1cclxudmFyIHBvbGw9c2V0SW50ZXJ2YWwoZG9Qb2xsLGludGVydmFsKTt9O3ZhciBnZXRDb25zb2xlVXJsPWZ1bmN0aW9uKCl7dmFyIGRvY3VtZW50RG9tYWluU2V0PShkb2N1bWVudC5kb21haW4hPWxvY2F0aW9uLmhvc3RuYW1lKTtyZXR1cm4gdXNlRG9jdW1lbnRXcml0ZT9cIlwiOmdldEJhc2VVcmwoKStcImNvbnNvbGUuaHRtbFwiK1xyXG4oZG9jdW1lbnREb21haW5TZXQ/XCI/bG9nNGphdmFzY3JpcHRfZG9tYWluPVwiK2VzY2FwZShkb2N1bWVudC5kb21haW4pOlwiXCIpO307aWYoaW5QYWdlKXt2YXIgY29udGFpbmVyRWxlbWVudD1udWxsO3ZhciBjc3NQcm9wZXJ0aWVzPVtdO3RoaXMuYWRkQ3NzUHJvcGVydHk9ZnVuY3Rpb24obmFtZSx2YWx1ZSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJjc3NQcm9wZXJ0aWVzXCIpKXtjc3NQcm9wZXJ0aWVzLnB1c2goW25hbWUsdmFsdWVdKTt9fTt2YXIgd2luZG93Q3JlYXRpb25TdGFydGVkPWZhbHNlO3ZhciBpZnJhbWVDb250YWluZXJEaXY7dmFyIGlmcmFtZUlkPXVuaXF1ZUlkK1wiX0luUGFnZUFwcGVuZGVyX1wiK2NvbnNvbGVBcHBlbmRlcklkO3RoaXMuaGlkZT1mdW5jdGlvbigpe2lmKGluaXRpYWxpemVkJiZjb25zb2xlV2luZG93Q3JlYXRlZCl7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuJChcImNvbW1hbmRcIikuYmx1cigpO31cclxuaWZyYW1lQ29udGFpbmVyRGl2LnN0eWxlLmRpc3BsYXk9XCJub25lXCI7bWluaW1pemVkPXRydWU7fX07dGhpcy5zaG93PWZ1bmN0aW9uKCl7aWYoaW5pdGlhbGl6ZWQpe2lmKGNvbnNvbGVXaW5kb3dDcmVhdGVkKXtpZnJhbWVDb250YWluZXJEaXYuc3R5bGUuZGlzcGxheT1cImJsb2NrXCI7dGhpcy5zZXRTaG93Q29tbWFuZExpbmUoc2hvd0NvbW1hbmRMaW5lKTttaW5pbWl6ZWQ9ZmFsc2U7fWVsc2UgaWYoIXdpbmRvd0NyZWF0aW9uU3RhcnRlZCl7Y3JlYXRlV2luZG93KHRydWUpO319fTt0aGlzLmlzVmlzaWJsZT1mdW5jdGlvbigpe3JldHVybiFtaW5pbWl6ZWQmJiFjb25zb2xlQ2xvc2VkO307dGhpcy5jbG9zZT1mdW5jdGlvbihmcm9tQnV0dG9uKXtpZighY29uc29sZUNsb3NlZCYmKCFmcm9tQnV0dG9ufHxjb25maXJtKFwiVGhpcyB3aWxsIHBlcm1hbmVudGx5IHJlbW92ZSB0aGUgY29uc29sZSBmcm9tIHRoZSBwYWdlLiBObyBtb3JlIG1lc3NhZ2VzIHdpbGwgYmUgbG9nZ2VkLiBEbyB5b3Ugd2lzaCB0byBjb250aW51ZT9cIikpKXtpZnJhbWVDb250YWluZXJEaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChpZnJhbWVDb250YWluZXJEaXYpO3RoaXMudW5sb2FkKCk7fX07b3Blbj1mdW5jdGlvbigpe3ZhciBpbml0RXJyb3JNZXNzYWdlPVwiSW5QYWdlQXBwZW5kZXIub3BlbjogdW5hYmxlIHRvIGNyZWF0ZSBjb25zb2xlIGlmcmFtZVwiO2Z1bmN0aW9uIGZpbmFsSW5pdCgpe3RyeXtpZighaW5pdGlhbGx5TWluaW1pemVkKXthcHBlbmRlci5zaG93KCk7fVxyXG5jb25zb2xlV2luZG93TG9hZEhhbmRsZXIoKTtjb25zb2xlV2luZG93TG9hZGVkPXRydWU7YXBwZW5kUXVldWVkTG9nZ2luZ0V2ZW50cygpO31jYXRjaChleCl7aXNTdXBwb3J0ZWQ9ZmFsc2U7aGFuZGxlRXJyb3IoaW5pdEVycm9yTWVzc2FnZSxleCk7fX1cclxuZnVuY3Rpb24gd3JpdGVUb0RvY3VtZW50KCl7dHJ5e3ZhciB3aW5kb3dUZXN0PWZ1bmN0aW9uKHdpbil7cmV0dXJuIGlzTG9hZGVkKHdpbik7fTtpZih1c2VEb2N1bWVudFdyaXRlKXt3cml0ZUh0bWwoZ2V0Q29uc29sZVdpbmRvdygpLmRvY3VtZW50KTt9XHJcbmlmKHdpbmRvd1Rlc3QoZ2V0Q29uc29sZVdpbmRvdygpKSl7ZmluYWxJbml0KCk7fWVsc2V7cG9sbENvbnNvbGVXaW5kb3cod2luZG93VGVzdCwxMDAsZmluYWxJbml0LGluaXRFcnJvck1lc3NhZ2UpO319Y2F0Y2goZXgpe2lzU3VwcG9ydGVkPWZhbHNlO2hhbmRsZUVycm9yKGluaXRFcnJvck1lc3NhZ2UsZXgpO319XHJcbm1pbmltaXplZD1mYWxzZTtpZnJhbWVDb250YWluZXJEaXY9Y29udGFpbmVyRWxlbWVudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTtpZnJhbWVDb250YWluZXJEaXYuc3R5bGUud2lkdGg9d2lkdGg7aWZyYW1lQ29udGFpbmVyRGl2LnN0eWxlLmhlaWdodD1oZWlnaHQ7aWZyYW1lQ29udGFpbmVyRGl2LnN0eWxlLmJvcmRlcj1cInNvbGlkIGdyYXkgMXB4XCI7Zm9yKHZhciBpPTAsbGVuPWNzc1Byb3BlcnRpZXMubGVuZ3RoO2k8bGVuO2krKyl7aWZyYW1lQ29udGFpbmVyRGl2LnN0eWxlW2Nzc1Byb3BlcnRpZXNbaV1bMF1dPWNzc1Byb3BlcnRpZXNbaV1bMV07fVxyXG52YXIgaWZyYW1lU3JjPXVzZURvY3VtZW50V3JpdGU/XCJcIjpcIiBzcmM9J1wiK2dldENvbnNvbGVVcmwoKStcIidcIjtpZnJhbWVDb250YWluZXJEaXYuaW5uZXJIVE1MPVwiPGlmcmFtZSBpZD0nXCIraWZyYW1lSWQrXCInIG5hbWU9J1wiK2lmcmFtZUlkK1wiJyB3aWR0aD0nMTAwJScgaGVpZ2h0PScxMDAlJyBmcmFtZWJvcmRlcj0nMCdcIitpZnJhbWVTcmMrXCIgc2Nyb2xsaW5nPSdubyc+PC9pZnJhbWU+XCI7Y29uc29sZUNsb3NlZD1mYWxzZTt2YXIgaWZyYW1lRG9jdW1lbnRFeGlzdHNUZXN0PWZ1bmN0aW9uKHdpbil7dHJ5e3JldHVybiBib29sKHdpbikmJmJvb2wod2luLmRvY3VtZW50KTt9Y2F0Y2goZXgpe3JldHVybiBmYWxzZTt9fTtpZihpZnJhbWVEb2N1bWVudEV4aXN0c1Rlc3QoZ2V0Q29uc29sZVdpbmRvdygpKSl7d3JpdGVUb0RvY3VtZW50KCk7fWVsc2V7cG9sbENvbnNvbGVXaW5kb3coaWZyYW1lRG9jdW1lbnRFeGlzdHNUZXN0LDEwMCx3cml0ZVRvRG9jdW1lbnQsaW5pdEVycm9yTWVzc2FnZSk7fVxyXG5jb25zb2xlV2luZG93Q3JlYXRlZD10cnVlO307Y3JlYXRlV2luZG93PWZ1bmN0aW9uKHNob3cpe2lmKHNob3d8fCFpbml0aWFsbHlNaW5pbWl6ZWQpe3ZhciBwYWdlTG9hZEhhbmRsZXI9ZnVuY3Rpb24oKXtpZighY29udGFpbmVyKXtjb250YWluZXJFbGVtZW50PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7Y29udGFpbmVyRWxlbWVudC5zdHlsZS5wb3NpdGlvbj1cImZpeGVkXCI7Y29udGFpbmVyRWxlbWVudC5zdHlsZS5sZWZ0PVwiMFwiO2NvbnRhaW5lckVsZW1lbnQuc3R5bGUucmlnaHQ9XCIwXCI7Y29udGFpbmVyRWxlbWVudC5zdHlsZS5ib3R0b209XCIwXCI7ZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChjb250YWluZXJFbGVtZW50KTthcHBlbmRlci5hZGRDc3NQcm9wZXJ0eShcImJvcmRlcldpZHRoXCIsXCIxcHggMCAwIDBcIik7YXBwZW5kZXIuYWRkQ3NzUHJvcGVydHkoXCJ6SW5kZXhcIiwxMDAwMDAwKTtvcGVuKCk7fWVsc2V7dHJ5e3ZhciBlbD1kb2N1bWVudC5nZXRFbGVtZW50QnlJZChjb250YWluZXIpO2lmKGVsLm5vZGVUeXBlPT0xKXtjb250YWluZXJFbGVtZW50PWVsO31cclxub3BlbigpO31jYXRjaChleCl7aGFuZGxlRXJyb3IoXCJJblBhZ2VBcHBlbmRlci5pbml0OiBpbnZhbGlkIGNvbnRhaW5lciBlbGVtZW50ICdcIitjb250YWluZXIrXCInIHN1cHBsaWVkXCIsZXgpO319fTtpZihwYWdlTG9hZGVkJiZjb250YWluZXImJmNvbnRhaW5lci5hcHBlbmRDaGlsZCl7Y29udGFpbmVyRWxlbWVudD1jb250YWluZXI7b3BlbigpO31lbHNlIGlmKHBhZ2VMb2FkZWQpe3BhZ2VMb2FkSGFuZGxlcigpO31lbHNle2xvZzRqYXZhc2NyaXB0LmFkZEV2ZW50TGlzdGVuZXIoXCJsb2FkXCIscGFnZUxvYWRIYW5kbGVyKTt9XHJcbndpbmRvd0NyZWF0aW9uU3RhcnRlZD10cnVlO319O2luaXQ9ZnVuY3Rpb24oKXtjcmVhdGVXaW5kb3coKTtpbml0aWFsaXplZD10cnVlO307Z2V0Q29uc29sZVdpbmRvdz1mdW5jdGlvbigpe3ZhciBpZnJhbWU9d2luZG93LmZyYW1lc1tpZnJhbWVJZF07aWYoaWZyYW1lKXtyZXR1cm4gaWZyYW1lO319O3NhZmVUb0FwcGVuZD1mdW5jdGlvbigpe2lmKGlzU3VwcG9ydGVkJiYhY29uc29sZUNsb3NlZCl7aWYoY29uc29sZVdpbmRvd0NyZWF0ZWQmJiFjb25zb2xlV2luZG93TG9hZGVkJiZnZXRDb25zb2xlV2luZG93KCkmJmlzTG9hZGVkKGdldENvbnNvbGVXaW5kb3coKSkpe2NvbnNvbGVXaW5kb3dMb2FkZWQ9dHJ1ZTt9XHJcbnJldHVybiBjb25zb2xlV2luZG93TG9hZGVkO31cclxucmV0dXJuIGZhbHNlO307fWVsc2V7dmFyIHVzZU9sZFBvcFVwPWFwcGVuZGVyLmRlZmF1bHRzLnVzZU9sZFBvcFVwO3ZhciBjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZz1hcHBlbmRlci5kZWZhdWx0cy5jb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZzt2YXIgcmVvcGVuV2hlbkNsb3NlZD10aGlzLmRlZmF1bHRzLnJlb3BlbldoZW5DbG9zZWQ7dGhpcy5pc1VzZU9sZFBvcFVwPWZ1bmN0aW9uKCl7cmV0dXJuIHVzZU9sZFBvcFVwO307dGhpcy5zZXRVc2VPbGRQb3BVcD1mdW5jdGlvbih1c2VPbGRQb3BVcFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcInVzZU9sZFBvcFVwXCIpKXt1c2VPbGRQb3BVcD1ib29sKHVzZU9sZFBvcFVwUGFyYW0pO319O3RoaXMuaXNDb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZz1mdW5jdGlvbigpe3JldHVybiBjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZzt9O3RoaXMuc2V0Q29tcGxhaW5BYm91dFBvcFVwQmxvY2tpbmc9ZnVuY3Rpb24oY29tcGxhaW5BYm91dFBvcFVwQmxvY2tpbmdQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZ1wiKSl7Y29tcGxhaW5BYm91dFBvcFVwQmxvY2tpbmc9Ym9vbChjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZ1BhcmFtKTt9fTt0aGlzLmlzRm9jdXNQb3BVcD1mdW5jdGlvbigpe3JldHVybiBmb2N1c0NvbnNvbGVXaW5kb3c7fTt0aGlzLnNldEZvY3VzUG9wVXA9ZnVuY3Rpb24oZm9jdXNQb3BVcFBhcmFtKXtmb2N1c0NvbnNvbGVXaW5kb3c9Ym9vbChmb2N1c1BvcFVwUGFyYW0pO307dGhpcy5pc1Jlb3BlbldoZW5DbG9zZWQ9ZnVuY3Rpb24oKXtyZXR1cm4gcmVvcGVuV2hlbkNsb3NlZDt9O3RoaXMuc2V0UmVvcGVuV2hlbkNsb3NlZD1mdW5jdGlvbihyZW9wZW5XaGVuQ2xvc2VkUGFyYW0pe3Jlb3BlbldoZW5DbG9zZWQ9Ym9vbChyZW9wZW5XaGVuQ2xvc2VkUGFyYW0pO307dGhpcy5jbG9zZT1mdW5jdGlvbigpe2xvZ0xvZy5kZWJ1ZyhcImNsb3NlIFwiK3RoaXMpO3RyeXtwb3BVcC5jbG9zZSgpO3RoaXMudW5sb2FkKCk7fWNhdGNoKGV4KXt9fTt0aGlzLmhpZGU9ZnVuY3Rpb24oKXtsb2dMb2cuZGVidWcoXCJoaWRlIFwiK3RoaXMpO2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7dGhpcy5jbG9zZSgpO319O3RoaXMuc2hvdz1mdW5jdGlvbigpe2xvZ0xvZy5kZWJ1ZyhcInNob3cgXCIrdGhpcyk7aWYoIWNvbnNvbGVXaW5kb3dDcmVhdGVkKXtvcGVuKCk7fX07dGhpcy5pc1Zpc2libGU9ZnVuY3Rpb24oKXtyZXR1cm4gc2FmZVRvQXBwZW5kKCk7fTt2YXIgcG9wVXA7b3Blbj1mdW5jdGlvbigpe3ZhciB3aW5kb3dQcm9wZXJ0aWVzPVwid2lkdGg9XCIrd2lkdGgrXCIsaGVpZ2h0PVwiK2hlaWdodCtcIixzdGF0dXMscmVzaXphYmxlXCI7dmFyIGZyYW1lSW5mbz1cIlwiO3RyeXt2YXIgZnJhbWVFbD13aW5kb3cuZnJhbWVFbGVtZW50O2lmKGZyYW1lRWwpe2ZyYW1lSW5mbz1cIl9cIitmcmFtZUVsLnRhZ05hbWUrXCJfXCIrKGZyYW1lRWwubmFtZXx8ZnJhbWVFbC5pZHx8XCJcIik7fX1jYXRjaChlKXtmcmFtZUluZm89XCJfaW5hY2Nlc3NpYmxlUGFyZW50RnJhbWVcIjt9XHJcbnZhciB3aW5kb3dOYW1lPVwiUG9wVXBfXCIrbG9jYXRpb24uaG9zdC5yZXBsYWNlKC9bXmEtejAtOV0vZ2ksXCJfXCIpK1wiX1wiK2NvbnNvbGVBcHBlbmRlcklkK2ZyYW1lSW5mbztpZighdXNlT2xkUG9wVXB8fCF1c2VEb2N1bWVudFdyaXRlKXt3aW5kb3dOYW1lPXdpbmRvd05hbWUrXCJfXCIrdW5pcXVlSWQ7fVxyXG52YXIgY2hlY2tQb3BVcENsb3NlZD1mdW5jdGlvbih3aW4pe2lmKGNvbnNvbGVDbG9zZWQpe3JldHVybiB0cnVlO31lbHNle3RyeXtyZXR1cm4gYm9vbCh3aW4pJiZ3aW4uY2xvc2VkO31jYXRjaChleCl7fX1cclxucmV0dXJuIGZhbHNlO307dmFyIHBvcFVwQ2xvc2VkQ2FsbGJhY2s9ZnVuY3Rpb24oKXtpZighY29uc29sZUNsb3NlZCl7YXBwZW5kZXIudW5sb2FkKCk7fX07ZnVuY3Rpb24gZmluYWxJbml0KCl7Z2V0Q29uc29sZVdpbmRvdygpLnNldENsb3NlSWZPcGVuZXJDbG9zZXMoIXVzZU9sZFBvcFVwfHwhdXNlRG9jdW1lbnRXcml0ZSk7Y29uc29sZVdpbmRvd0xvYWRIYW5kbGVyKCk7Y29uc29sZVdpbmRvd0xvYWRlZD10cnVlO2FwcGVuZFF1ZXVlZExvZ2dpbmdFdmVudHMoKTtwb2xsQ29uc29sZVdpbmRvdyhjaGVja1BvcFVwQ2xvc2VkLDUwMCxwb3BVcENsb3NlZENhbGxiYWNrLFwiUG9wVXBBcHBlbmRlci5jaGVja1BvcFVwQ2xvc2VkOiBlcnJvciBjaGVja2luZyBwb3AtdXAgd2luZG93XCIpO31cclxudHJ5e3BvcFVwPXdpbmRvdy5vcGVuKGdldENvbnNvbGVVcmwoKSx3aW5kb3dOYW1lLHdpbmRvd1Byb3BlcnRpZXMpO2NvbnNvbGVDbG9zZWQ9ZmFsc2U7Y29uc29sZVdpbmRvd0NyZWF0ZWQ9dHJ1ZTtpZihwb3BVcCYmcG9wVXAuZG9jdW1lbnQpe2lmKHVzZURvY3VtZW50V3JpdGUmJnVzZU9sZFBvcFVwJiZpc0xvYWRlZChwb3BVcCkpe3BvcFVwLm1haW5QYWdlUmVsb2FkZWQoKTtmaW5hbEluaXQoKTt9ZWxzZXtpZih1c2VEb2N1bWVudFdyaXRlKXt3cml0ZUh0bWwocG9wVXAuZG9jdW1lbnQpO31cclxudmFyIHBvcFVwTG9hZGVkVGVzdD1mdW5jdGlvbih3aW4pe3JldHVybiBib29sKHdpbikmJmlzTG9hZGVkKHdpbik7fTtpZihpc0xvYWRlZChwb3BVcCkpe2ZpbmFsSW5pdCgpO31lbHNle3BvbGxDb25zb2xlV2luZG93KHBvcFVwTG9hZGVkVGVzdCwxMDAsZmluYWxJbml0LFwiUG9wVXBBcHBlbmRlci5pbml0OiB1bmFibGUgdG8gY3JlYXRlIGNvbnNvbGUgd2luZG93XCIpO319fWVsc2V7aXNTdXBwb3J0ZWQ9ZmFsc2U7bG9nTG9nLndhcm4oXCJQb3BVcEFwcGVuZGVyLmluaXQ6IHBvcC11cHMgYmxvY2tlZCwgcGxlYXNlIHVuYmxvY2sgdG8gdXNlIFBvcFVwQXBwZW5kZXJcIik7aWYoY29tcGxhaW5BYm91dFBvcFVwQmxvY2tpbmcpe2hhbmRsZUVycm9yKFwibG9nNGphdmFzY3JpcHQ6IHBvcC11cCB3aW5kb3dzIGFwcGVhciB0byBiZSBibG9ja2VkLiBQbGVhc2UgdW5ibG9jayB0aGVtIHRvIHVzZSBwb3AtdXAgbG9nZ2luZy5cIik7fX19Y2F0Y2goZXgpe2hhbmRsZUVycm9yKFwiUG9wVXBBcHBlbmRlci5pbml0OiBlcnJvciBjcmVhdGluZyBwb3AtdXBcIixleCk7fX07Y3JlYXRlV2luZG93PWZ1bmN0aW9uKCl7aWYoIWluaXRpYWxseU1pbmltaXplZCl7b3BlbigpO319O2luaXQ9ZnVuY3Rpb24oKXtjcmVhdGVXaW5kb3coKTtpbml0aWFsaXplZD10cnVlO307Z2V0Q29uc29sZVdpbmRvdz1mdW5jdGlvbigpe3JldHVybiBwb3BVcDt9O3NhZmVUb0FwcGVuZD1mdW5jdGlvbigpe2lmKGlzU3VwcG9ydGVkJiYhaXNVbmRlZmluZWQocG9wVXApJiYhY29uc29sZUNsb3NlZCl7aWYocG9wVXAuY2xvc2VkfHwoY29uc29sZVdpbmRvd0xvYWRlZCYmaXNVbmRlZmluZWQocG9wVXAuY2xvc2VkKSkpe2FwcGVuZGVyLnVubG9hZCgpO2xvZ0xvZy5kZWJ1ZyhcIlBvcFVwQXBwZW5kZXI6IHBvcC11cCBjbG9zZWRcIik7cmV0dXJuIGZhbHNlO31cclxuaWYoIWNvbnNvbGVXaW5kb3dMb2FkZWQmJmlzTG9hZGVkKHBvcFVwKSl7Y29uc29sZVdpbmRvd0xvYWRlZD10cnVlO319XHJcbnJldHVybiBpc1N1cHBvcnRlZCYmY29uc29sZVdpbmRvd0xvYWRlZCYmIWNvbnNvbGVDbG9zZWQ7fTt9XHJcbnRoaXMuZ2V0Q29uc29sZVdpbmRvdz1nZXRDb25zb2xlV2luZG93O307Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb249ZnVuY3Rpb24oZnVuY3Rpb25OYW1lLGNvbW1hbmRMaW5lRnVuY3Rpb24pe2RlZmF1bHRDb21tYW5kTGluZUZ1bmN0aW9ucy5wdXNoKFtmdW5jdGlvbk5hbWUsY29tbWFuZExpbmVGdW5jdGlvbl0pO307ZnVuY3Rpb24gUG9wVXBBcHBlbmRlcihsYXp5SW5pdCxpbml0aWFsbHlNaW5pbWl6ZWQsdXNlRG9jdW1lbnRXcml0ZSx3aWR0aCxoZWlnaHQpe3RoaXMuY3JlYXRlKGZhbHNlLG51bGwsbGF6eUluaXQsaW5pdGlhbGx5TWluaW1pemVkLHVzZURvY3VtZW50V3JpdGUsd2lkdGgsaGVpZ2h0LHRoaXMuZGVmYXVsdHMuZm9jdXNQb3BVcCk7fVxyXG5Qb3BVcEFwcGVuZGVyLnByb3RvdHlwZT1uZXcgQ29uc29sZUFwcGVuZGVyKCk7UG9wVXBBcHBlbmRlci5wcm90b3R5cGUuZGVmYXVsdHM9e2xheW91dDpuZXcgUGF0dGVybkxheW91dChcIiVke0hIOm1tOnNzfSAlLTVwIC0gJW17MX0lblwiKSxpbml0aWFsbHlNaW5pbWl6ZWQ6ZmFsc2UsZm9jdXNQb3BVcDpmYWxzZSxsYXp5SW5pdDp0cnVlLHVzZU9sZFBvcFVwOnRydWUsY29tcGxhaW5BYm91dFBvcFVwQmxvY2tpbmc6dHJ1ZSxuZXdlc3RNZXNzYWdlQXRUb3A6ZmFsc2Usc2Nyb2xsVG9MYXRlc3RNZXNzYWdlOnRydWUsd2lkdGg6XCI2MDBcIixoZWlnaHQ6XCI0MDBcIixyZW9wZW5XaGVuQ2xvc2VkOmZhbHNlLG1heE1lc3NhZ2VzOm51bGwsc2hvd0NvbW1hbmRMaW5lOnRydWUsY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aDoxLHNob3dIaWRlQnV0dG9uOmZhbHNlLHNob3dDbG9zZUJ1dHRvbjp0cnVlLHVzZURvY3VtZW50V3JpdGU6dHJ1ZX07UG9wVXBBcHBlbmRlci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlBvcFVwQXBwZW5kZXJcIjt9O2xvZzRqYXZhc2NyaXB0LlBvcFVwQXBwZW5kZXI9UG9wVXBBcHBlbmRlcjtmdW5jdGlvbiBJblBhZ2VBcHBlbmRlcihjb250YWluZXIsbGF6eUluaXQsaW5pdGlhbGx5TWluaW1pemVkLHVzZURvY3VtZW50V3JpdGUsd2lkdGgsaGVpZ2h0KXt0aGlzLmNyZWF0ZSh0cnVlLGNvbnRhaW5lcixsYXp5SW5pdCxpbml0aWFsbHlNaW5pbWl6ZWQsdXNlRG9jdW1lbnRXcml0ZSx3aWR0aCxoZWlnaHQsZmFsc2UpO31cclxuSW5QYWdlQXBwZW5kZXIucHJvdG90eXBlPW5ldyBDb25zb2xlQXBwZW5kZXIoKTtJblBhZ2VBcHBlbmRlci5wcm90b3R5cGUuZGVmYXVsdHM9e2xheW91dDpuZXcgUGF0dGVybkxheW91dChcIiVke0hIOm1tOnNzfSAlLTVwIC0gJW17MX0lblwiKSxpbml0aWFsbHlNaW5pbWl6ZWQ6ZmFsc2UsbGF6eUluaXQ6dHJ1ZSxuZXdlc3RNZXNzYWdlQXRUb3A6ZmFsc2Usc2Nyb2xsVG9MYXRlc3RNZXNzYWdlOnRydWUsd2lkdGg6XCIxMDAlXCIsaGVpZ2h0OlwiMjIwcHhcIixtYXhNZXNzYWdlczpudWxsLHNob3dDb21tYW5kTGluZTp0cnVlLGNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg6MSxzaG93SGlkZUJ1dHRvbjpmYWxzZSxzaG93Q2xvc2VCdXR0b246ZmFsc2Usc2hvd0xvZ0VudHJ5RGVsZXRlQnV0dG9uczp0cnVlLHVzZURvY3VtZW50V3JpdGU6dHJ1ZX07SW5QYWdlQXBwZW5kZXIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJJblBhZ2VBcHBlbmRlclwiO307bG9nNGphdmFzY3JpcHQuSW5QYWdlQXBwZW5kZXI9SW5QYWdlQXBwZW5kZXI7bG9nNGphdmFzY3JpcHQuSW5saW5lQXBwZW5kZXI9SW5QYWdlQXBwZW5kZXI7fSkoKTtmdW5jdGlvbiBwYWRXaXRoU3BhY2VzKHN0cixsZW4pe2lmKHN0ci5sZW5ndGg8bGVuKXt2YXIgc3BhY2VzPVtdO3ZhciBudW1iZXJPZlNwYWNlcz1NYXRoLm1heCgwLGxlbi1zdHIubGVuZ3RoKTtmb3IodmFyIGk9MDtpPG51bWJlck9mU3BhY2VzO2krKyl7c3BhY2VzW2ldPVwiIFwiO31cclxuc3RyKz1zcGFjZXMuam9pbihcIlwiKTt9XHJcbnJldHVybiBzdHI7fVxyXG4oZnVuY3Rpb24oKXtmdW5jdGlvbiBkaXIob2JqKXt2YXIgbWF4TGVuPTA7Zm9yKHZhciBwIGluIG9iail7bWF4TGVuPU1hdGgubWF4KHRvU3RyKHApLmxlbmd0aCxtYXhMZW4pO31cclxudmFyIHByb3BMaXN0PVtdO2ZvcihwIGluIG9iail7dmFyIHByb3BOYW1lU3RyPVwiICBcIitwYWRXaXRoU3BhY2VzKHRvU3RyKHApLG1heExlbisyKTt2YXIgcHJvcFZhbDt0cnl7cHJvcFZhbD1zcGxpdEludG9MaW5lcyh0b1N0cihvYmpbcF0pKS5qb2luKHBhZFdpdGhTcGFjZXMobmV3TGluZSxtYXhMZW4rNikpO31jYXRjaChleCl7cHJvcFZhbD1cIltFcnJvciBvYnRhaW5pbmcgcHJvcGVydHkuIERldGFpbHM6IFwiK2dldEV4Y2VwdGlvbk1lc3NhZ2UoZXgpK1wiXVwiO31cclxucHJvcExpc3QucHVzaChwcm9wTmFtZVN0citwcm9wVmFsKTt9XHJcbnJldHVybiBwcm9wTGlzdC5qb2luKG5ld0xpbmUpO31cclxudmFyIG5vZGVUeXBlcz17RUxFTUVOVF9OT0RFOjEsQVRUUklCVVRFX05PREU6MixURVhUX05PREU6MyxDREFUQV9TRUNUSU9OX05PREU6NCxFTlRJVFlfUkVGRVJFTkNFX05PREU6NSxFTlRJVFlfTk9ERTo2LFBST0NFU1NJTkdfSU5TVFJVQ1RJT05fTk9ERTo3LENPTU1FTlRfTk9ERTo4LERPQ1VNRU5UX05PREU6OSxET0NVTUVOVF9UWVBFX05PREU6MTAsRE9DVU1FTlRfRlJBR01FTlRfTk9ERToxMSxOT1RBVElPTl9OT0RFOjEyfTt2YXIgcHJlRm9ybWF0dGVkRWxlbWVudHM9W1wic2NyaXB0XCIsXCJwcmVcIl07dmFyIGVtcHR5RWxlbWVudHM9W1wiYnJcIixcImltZ1wiLFwiaHJcIixcInBhcmFtXCIsXCJsaW5rXCIsXCJhcmVhXCIsXCJpbnB1dFwiLFwiY29sXCIsXCJiYXNlXCIsXCJtZXRhXCJdO3ZhciBpbmRlbnRhdGlvblVuaXQ9XCIgIFwiO2Z1bmN0aW9uIGdldFhodG1sKHJvb3ROb2RlLGluY2x1ZGVSb290Tm9kZSxpbmRlbnRhdGlvbixzdGFydE5ld0xpbmUscHJlZm9ybWF0dGVkKXtpbmNsdWRlUm9vdE5vZGU9KHR5cGVvZiBpbmNsdWRlUm9vdE5vZGU9PVwidW5kZWZpbmVkXCIpP3RydWU6ISFpbmNsdWRlUm9vdE5vZGU7aWYodHlwZW9mIGluZGVudGF0aW9uIT1cInN0cmluZ1wiKXtpbmRlbnRhdGlvbj1cIlwiO31cclxuc3RhcnROZXdMaW5lPSEhc3RhcnROZXdMaW5lO3ByZWZvcm1hdHRlZD0hIXByZWZvcm1hdHRlZDt2YXIgeGh0bWw7ZnVuY3Rpb24gaXNXaGl0ZXNwYWNlKG5vZGUpe3JldHVybigobm9kZS5ub2RlVHlwZT09bm9kZVR5cGVzLlRFWFRfTk9ERSkmJi9eWyBcXHRcXHJcXG5dKiQvLnRlc3Qobm9kZS5ub2RlVmFsdWUpKTt9XHJcbmZ1bmN0aW9uIGZpeEF0dHJpYnV0ZVZhbHVlKGF0dHJWYWx1ZSl7cmV0dXJuIGF0dHJWYWx1ZS50b1N0cmluZygpLnJlcGxhY2UoLyYvZyxcIiZhbXA7XCIpLnJlcGxhY2UoLzwvZyxcIiZsdDtcIikucmVwbGFjZSgvXCIvZyxcIiZxdW90O1wiKTt9XHJcbmZ1bmN0aW9uIGdldFN0eWxlQXR0cmlidXRlVmFsdWUoZWwpe3ZhciBzdHlsZVBhaXJzPWVsLnN0eWxlLmNzc1RleHQuc3BsaXQoXCI7XCIpO3ZhciBzdHlsZVZhbHVlPVwiXCI7Zm9yKHZhciBqPTAsbGVuPXN0eWxlUGFpcnMubGVuZ3RoO2o8bGVuO2orKyl7dmFyIG5hbWVWYWx1ZUJpdHM9c3R5bGVQYWlyc1tqXS5zcGxpdChcIjpcIik7dmFyIHByb3BzPVtdO2lmKCEvXlxccyokLy50ZXN0KG5hbWVWYWx1ZUJpdHNbMF0pKXtwcm9wcy5wdXNoKHRyaW0obmFtZVZhbHVlQml0c1swXSkudG9Mb3dlckNhc2UoKStcIjpcIit0cmltKG5hbWVWYWx1ZUJpdHNbMV0pKTt9XHJcbnN0eWxlVmFsdWU9cHJvcHMuam9pbihcIjtcIik7fVxyXG5yZXR1cm4gc3R5bGVWYWx1ZTt9XHJcbmZ1bmN0aW9uIGdldE5hbWVzcGFjZShlbCl7aWYoZWwucHJlZml4KXtyZXR1cm4gZWwucHJlZml4O31lbHNlIGlmKGVsLm91dGVySFRNTCl7dmFyIHJlZ2V4PW5ldyBSZWdFeHAoXCI8KFteOl0rKTpcIitlbC50YWdOYW1lK1wiW14+XSo+XCIsXCJpXCIpO2lmKHJlZ2V4LnRlc3QoZWwub3V0ZXJIVE1MKSl7cmV0dXJuIFJlZ0V4cC4kMS50b0xvd2VyQ2FzZSgpO319XHJcbnJldHVyblwiXCI7fVxyXG52YXIgbHQ9XCI8XCI7dmFyIGd0PVwiPlwiO3ZhciBpLGxlbjtpZihpbmNsdWRlUm9vdE5vZGUmJnJvb3ROb2RlLm5vZGVUeXBlIT1ub2RlVHlwZXMuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSl7c3dpdGNoKHJvb3ROb2RlLm5vZGVUeXBlKXtjYXNlIG5vZGVUeXBlcy5FTEVNRU5UX05PREU6dmFyIHRhZ05hbWU9cm9vdE5vZGUudGFnTmFtZS50b0xvd2VyQ2FzZSgpO3hodG1sPXN0YXJ0TmV3TGluZT9uZXdMaW5lK2luZGVudGF0aW9uOlwiXCI7eGh0bWwrPWx0O3ZhciBwcmVmaXg9Z2V0TmFtZXNwYWNlKHJvb3ROb2RlKTt2YXIgaGFzUHJlZml4PSEhcHJlZml4O2lmKGhhc1ByZWZpeCl7eGh0bWwrPXByZWZpeCtcIjpcIjt9XHJcbnhodG1sKz10YWdOYW1lO2ZvcihpPTAsbGVuPXJvb3ROb2RlLmF0dHJpYnV0ZXMubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGN1cnJlbnRBdHRyPXJvb3ROb2RlLmF0dHJpYnV0ZXNbaV07aWYoIWN1cnJlbnRBdHRyLnNwZWNpZmllZHx8Y3VycmVudEF0dHIubm9kZVZhbHVlPT09bnVsbHx8Y3VycmVudEF0dHIubm9kZU5hbWUudG9Mb3dlckNhc2UoKT09PVwic3R5bGVcInx8dHlwZW9mIGN1cnJlbnRBdHRyLm5vZGVWYWx1ZSE9PVwic3RyaW5nXCJ8fGN1cnJlbnRBdHRyLm5vZGVOYW1lLmluZGV4T2YoXCJfbW96XCIpPT09MCl7Y29udGludWU7fVxyXG54aHRtbCs9XCIgXCIrY3VycmVudEF0dHIubm9kZU5hbWUudG9Mb3dlckNhc2UoKStcIj1cXFwiXCI7eGh0bWwrPWZpeEF0dHJpYnV0ZVZhbHVlKGN1cnJlbnRBdHRyLm5vZGVWYWx1ZSk7eGh0bWwrPVwiXFxcIlwiO31cclxuaWYocm9vdE5vZGUuc3R5bGUuY3NzVGV4dCl7dmFyIHN0eWxlVmFsdWU9Z2V0U3R5bGVBdHRyaWJ1dGVWYWx1ZShyb290Tm9kZSk7aWYoc3R5bGVWYWx1ZSE9PVwiXCIpe3hodG1sKz1cIiBzdHlsZT1cXFwiXCIrZ2V0U3R5bGVBdHRyaWJ1dGVWYWx1ZShyb290Tm9kZSkrXCJcXFwiXCI7fX1cclxuaWYoYXJyYXlfY29udGFpbnMoZW1wdHlFbGVtZW50cyx0YWdOYW1lKXx8KGhhc1ByZWZpeCYmIXJvb3ROb2RlLmhhc0NoaWxkTm9kZXMoKSkpe3hodG1sKz1cIi9cIitndDt9ZWxzZXt4aHRtbCs9Z3Q7dmFyIGNoaWxkU3RhcnROZXdMaW5lPSEocm9vdE5vZGUuY2hpbGROb2Rlcy5sZW5ndGg9PT0xJiZyb290Tm9kZS5jaGlsZE5vZGVzWzBdLm5vZGVUeXBlPT09bm9kZVR5cGVzLlRFWFRfTk9ERSk7dmFyIGNoaWxkUHJlZm9ybWF0dGVkPWFycmF5X2NvbnRhaW5zKHByZUZvcm1hdHRlZEVsZW1lbnRzLHRhZ05hbWUpO2ZvcihpPTAsbGVuPXJvb3ROb2RlLmNoaWxkTm9kZXMubGVuZ3RoO2k8bGVuO2krKyl7eGh0bWwrPWdldFhodG1sKHJvb3ROb2RlLmNoaWxkTm9kZXNbaV0sdHJ1ZSxpbmRlbnRhdGlvbitpbmRlbnRhdGlvblVuaXQsY2hpbGRTdGFydE5ld0xpbmUsY2hpbGRQcmVmb3JtYXR0ZWQpO31cclxudmFyIGVuZFRhZz1sdCtcIi9cIit0YWdOYW1lK2d0O3hodG1sKz1jaGlsZFN0YXJ0TmV3TGluZT9uZXdMaW5lK2luZGVudGF0aW9uK2VuZFRhZzplbmRUYWc7fVxyXG5yZXR1cm4geGh0bWw7Y2FzZSBub2RlVHlwZXMuVEVYVF9OT0RFOmlmKGlzV2hpdGVzcGFjZShyb290Tm9kZSkpe3hodG1sPVwiXCI7fWVsc2V7aWYocHJlZm9ybWF0dGVkKXt4aHRtbD1yb290Tm9kZS5ub2RlVmFsdWU7fWVsc2V7dmFyIGxpbmVzPXNwbGl0SW50b0xpbmVzKHRyaW0ocm9vdE5vZGUubm9kZVZhbHVlKSk7dmFyIHRyaW1tZWRMaW5lcz1bXTtmb3IoaT0wLGxlbj1saW5lcy5sZW5ndGg7aTxsZW47aSsrKXt0cmltbWVkTGluZXNbaV09dHJpbShsaW5lc1tpXSk7fVxyXG54aHRtbD10cmltbWVkTGluZXMuam9pbihuZXdMaW5lK2luZGVudGF0aW9uKTt9XHJcbmlmKHN0YXJ0TmV3TGluZSl7eGh0bWw9bmV3TGluZStpbmRlbnRhdGlvbit4aHRtbDt9fVxyXG5yZXR1cm4geGh0bWw7Y2FzZSBub2RlVHlwZXMuQ0RBVEFfU0VDVElPTl9OT0RFOnJldHVyblwiPCFbQ0RBXCIrXCJUQVtcIityb290Tm9kZS5ub2RlVmFsdWUrXCJdXCIrXCJdPlwiK25ld0xpbmU7Y2FzZSBub2RlVHlwZXMuRE9DVU1FTlRfTk9ERTp4aHRtbD1cIlwiO2ZvcihpPTAsbGVuPXJvb3ROb2RlLmNoaWxkTm9kZXMubGVuZ3RoO2k8bGVuO2krKyl7eGh0bWwrPWdldFhodG1sKHJvb3ROb2RlLmNoaWxkTm9kZXNbaV0sdHJ1ZSxpbmRlbnRhdGlvbik7fVxyXG5yZXR1cm4geGh0bWw7ZGVmYXVsdDpyZXR1cm5cIlwiO319ZWxzZXt4aHRtbD1cIlwiO2ZvcihpPTAsbGVuPXJvb3ROb2RlLmNoaWxkTm9kZXMubGVuZ3RoO2k8bGVuO2krKyl7eGh0bWwrPWdldFhodG1sKHJvb3ROb2RlLmNoaWxkTm9kZXNbaV0sdHJ1ZSxpbmRlbnRhdGlvbitpbmRlbnRhdGlvblVuaXQpO31cclxucmV0dXJuIHhodG1sO319XHJcbmZ1bmN0aW9uIGNyZWF0ZUNvbW1hbmRMaW5lRnVuY3Rpb25zKCl7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCIkXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7cmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGFyZ3NbMF0pO30pO0NvbnNvbGVBcHBlbmRlci5hZGRHbG9iYWxDb21tYW5kTGluZUZ1bmN0aW9uKFwiZGlyXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7dmFyIGxpbmVzPVtdO2Zvcih2YXIgaT0wLGxlbj1hcmdzLmxlbmd0aDtpPGxlbjtpKyspe2xpbmVzW2ldPWRpcihhcmdzW2ldKTt9XHJcbnJldHVybiBsaW5lcy5qb2luKG5ld0xpbmUrbmV3TGluZSk7fSk7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCJkaXJ4bWxcIixmdW5jdGlvbihhcHBlbmRlcixhcmdzLHJldHVyblZhbHVlKXt2YXIgbGluZXM9W107Zm9yKHZhciBpPTAsbGVuPWFyZ3MubGVuZ3RoO2k8bGVuO2krKyl7bGluZXNbaV09Z2V0WGh0bWwoYXJnc1tpXSk7fVxyXG5yZXR1cm4gbGluZXMuam9pbihuZXdMaW5lK25ld0xpbmUpO30pO0NvbnNvbGVBcHBlbmRlci5hZGRHbG9iYWxDb21tYW5kTGluZUZ1bmN0aW9uKFwiY2RcIixmdW5jdGlvbihhcHBlbmRlcixhcmdzLHJldHVyblZhbHVlKXt2YXIgd2luLG1lc3NhZ2U7aWYoYXJncy5sZW5ndGg9PT0wfHxhcmdzWzBdPT09XCJcIil7d2luPXdpbmRvdzttZXNzYWdlPVwiQ29tbWFuZCBsaW5lIHNldCB0byBydW4gaW4gbWFpbiB3aW5kb3dcIjt9ZWxzZXtpZihhcmdzWzBdLndpbmRvdz09YXJnc1swXSl7d2luPWFyZ3NbMF07bWVzc2FnZT1cIkNvbW1hbmQgbGluZSBzZXQgdG8gcnVuIGluIGZyYW1lICdcIithcmdzWzBdLm5hbWUrXCInXCI7fWVsc2V7d2luPXdpbmRvdy5mcmFtZXNbYXJnc1swXV07aWYod2luKXttZXNzYWdlPVwiQ29tbWFuZCBsaW5lIHNldCB0byBydW4gaW4gZnJhbWUgJ1wiK2FyZ3NbMF0rXCInXCI7fWVsc2V7cmV0dXJuVmFsdWUuaXNFcnJvcj10cnVlO21lc3NhZ2U9XCJGcmFtZSAnXCIrYXJnc1swXStcIicgZG9lcyBub3QgZXhpc3RcIjt3aW49YXBwZW5kZXIuZ2V0Q29tbWFuZFdpbmRvdygpO319fVxyXG5hcHBlbmRlci5zZXRDb21tYW5kV2luZG93KHdpbik7cmV0dXJuIG1lc3NhZ2U7fSk7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCJjbGVhclwiLGZ1bmN0aW9uKGFwcGVuZGVyLGFyZ3MscmV0dXJuVmFsdWUpe3JldHVyblZhbHVlLmFwcGVuZFJlc3VsdD1mYWxzZTthcHBlbmRlci5jbGVhcigpO30pO0NvbnNvbGVBcHBlbmRlci5hZGRHbG9iYWxDb21tYW5kTGluZUZ1bmN0aW9uKFwia2V5c1wiLGZ1bmN0aW9uKGFwcGVuZGVyLGFyZ3MscmV0dXJuVmFsdWUpe3ZhciBrZXlzPVtdO2Zvcih2YXIgayBpbiBhcmdzWzBdKXtrZXlzLnB1c2goayk7fVxyXG5yZXR1cm4ga2V5czt9KTtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbihcInZhbHVlc1wiLGZ1bmN0aW9uKGFwcGVuZGVyLGFyZ3MscmV0dXJuVmFsdWUpe3ZhciB2YWx1ZXM9W107Zm9yKHZhciBrIGluIGFyZ3NbMF0pe3RyeXt2YWx1ZXMucHVzaChhcmdzWzBdW2tdKTt9Y2F0Y2goZXgpe2xvZ0xvZy53YXJuKFwidmFsdWVzKCk6IFVuYWJsZSB0byBvYnRhaW4gdmFsdWUgZm9yIGtleSBcIitrK1wiLiBEZXRhaWxzOiBcIitnZXRFeGNlcHRpb25NZXNzYWdlKGV4KSk7fX1cclxucmV0dXJuIHZhbHVlczt9KTtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbihcImV4cGFuc2lvbkRlcHRoXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7dmFyIGV4cGFuc2lvbkRlcHRoPXBhcnNlSW50KGFyZ3NbMF0sMTApO2lmKGlzTmFOKGV4cGFuc2lvbkRlcHRoKXx8ZXhwYW5zaW9uRGVwdGg8MCl7cmV0dXJuVmFsdWUuaXNFcnJvcj10cnVlO3JldHVyblwiXCIrYXJnc1swXStcIiBpcyBub3QgYSB2YWxpZCBleHBhbnNpb24gZGVwdGhcIjt9ZWxzZXthcHBlbmRlci5zZXRDb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoKGV4cGFuc2lvbkRlcHRoKTtyZXR1cm5cIk9iamVjdCBleHBhbnNpb24gZGVwdGggc2V0IHRvIFwiK2V4cGFuc2lvbkRlcHRoO319KTt9XHJcbmZ1bmN0aW9uIGluaXQoKXtjcmVhdGVDb21tYW5kTGluZUZ1bmN0aW9ucygpO31cclxuaW5pdCgpO30pKCk7ZnVuY3Rpb24gY3JlYXRlRGVmYXVsdExvZ2dlcigpe3ZhciBsb2dnZXI9bG9nNGphdmFzY3JpcHQuZ2V0TG9nZ2VyKGRlZmF1bHRMb2dnZXJOYW1lKTt2YXIgYT1uZXcgbG9nNGphdmFzY3JpcHQuUG9wVXBBcHBlbmRlcigpO2xvZ2dlci5hZGRBcHBlbmRlcihhKTtyZXR1cm4gbG9nZ2VyO31cclxubG9nNGphdmFzY3JpcHQuc2V0RG9jdW1lbnRSZWFkeT1mdW5jdGlvbigpe3BhZ2VMb2FkZWQ9dHJ1ZTtsb2c0amF2YXNjcmlwdC5kaXNwYXRjaEV2ZW50KFwibG9hZFwiLHt9KTt9O2lmKHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKXt3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixsb2c0amF2YXNjcmlwdC5zZXREb2N1bWVudFJlYWR5LGZhbHNlKTt9ZWxzZSBpZih3aW5kb3cuYXR0YWNoRXZlbnQpe3dpbmRvdy5hdHRhY2hFdmVudChcIm9ubG9hZFwiLGxvZzRqYXZhc2NyaXB0LnNldERvY3VtZW50UmVhZHkpO31lbHNle3ZhciBvbGRPbmxvYWQ9d2luZG93Lm9ubG9hZDtpZih0eXBlb2Ygd2luZG93Lm9ubG9hZCE9XCJmdW5jdGlvblwiKXt3aW5kb3cub25sb2FkPWxvZzRqYXZhc2NyaXB0LnNldERvY3VtZW50UmVhZHk7fWVsc2V7d2luZG93Lm9ubG9hZD1mdW5jdGlvbihldnQpe2lmKG9sZE9ubG9hZCl7b2xkT25sb2FkKGV2dCk7fVxyXG5sb2c0amF2YXNjcmlwdC5zZXREb2N1bWVudFJlYWR5KCk7fTt9fVxyXG5yZXR1cm4gbG9nNGphdmFzY3JpcHQ7fSx0aGlzKTtcclxuIiwiIWZ1bmN0aW9uKHQscil7XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHMmJlwib2JqZWN0XCI9PXR5cGVvZiBtb2R1bGU/bW9kdWxlLmV4cG9ydHM9cigpOlwiZnVuY3Rpb25cIj09dHlwZW9mIGRlZmluZSYmZGVmaW5lLmFtZD9kZWZpbmUoW10scik6XCJvYmplY3RcIj09dHlwZW9mIGV4cG9ydHM/ZXhwb3J0cy5NZXNzYWdlRm9ybWF0PXIoKTp0Lk1lc3NhZ2VGb3JtYXQ9cigpfSh0aGlzLGZ1bmN0aW9uKCl7cmV0dXJuIGZ1bmN0aW9uKHQpe3ZhciByPXt9O2Z1bmN0aW9uIGUobil7aWYocltuXSlyZXR1cm4gcltuXS5leHBvcnRzO3ZhciBvPXJbbl09e2k6bixsOiExLGV4cG9ydHM6e319O3JldHVybiB0W25dLmNhbGwoby5leHBvcnRzLG8sby5leHBvcnRzLGUpLG8ubD0hMCxvLmV4cG9ydHN9cmV0dXJuIGUubT10LGUuYz1yLGUuZD1mdW5jdGlvbih0LHIsbil7ZS5vKHQscil8fE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LHIse2VudW1lcmFibGU6ITAsZ2V0Om59KX0sZS5yPWZ1bmN0aW9uKHQpe1widW5kZWZpbmVkXCIhPXR5cGVvZiBTeW1ib2wmJlN5bWJvbC50b1N0cmluZ1RhZyYmT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsU3ltYm9sLnRvU3RyaW5nVGFnLHt2YWx1ZTpcIk1vZHVsZVwifSksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsXCJfX2VzTW9kdWxlXCIse3ZhbHVlOiEwfSl9LGUudD1mdW5jdGlvbih0LHIpe2lmKDEmciYmKHQ9ZSh0KSksOCZyKXJldHVybiB0O2lmKDQmciYmXCJvYmplY3RcIj09dHlwZW9mIHQmJnQmJnQuX19lc01vZHVsZSlyZXR1cm4gdDt2YXIgbj1PYmplY3QuY3JlYXRlKG51bGwpO2lmKGUucihuKSxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcImRlZmF1bHRcIix7ZW51bWVyYWJsZTohMCx2YWx1ZTp0fSksMiZyJiZcInN0cmluZ1wiIT10eXBlb2YgdClmb3IodmFyIG8gaW4gdCllLmQobixvLGZ1bmN0aW9uKHIpe3JldHVybiB0W3JdfS5iaW5kKG51bGwsbykpO3JldHVybiBufSxlLm49ZnVuY3Rpb24odCl7dmFyIHI9dCYmdC5fX2VzTW9kdWxlP2Z1bmN0aW9uKCl7cmV0dXJuIHQuZGVmYXVsdH06ZnVuY3Rpb24oKXtyZXR1cm4gdH07cmV0dXJuIGUuZChyLFwiYVwiLHIpLHJ9LGUubz1mdW5jdGlvbih0LHIpe3JldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodCxyKX0sZS5wPVwiXCIsZShlLnM9OCl9KFtmdW5jdGlvbih0LHIsZSl7dmFyIG4sbzt2b2lkIDA9PT0obz1cImZ1bmN0aW9uXCI9PXR5cGVvZihuPXthZjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxhazpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSxhbTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxhcjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQsbz1uJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6MD09dD9cInplcm9cIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOm8+PTMmJm88PTEwP1wiZmV3XCI6bz49MTEmJm88PTk5P1wibWFueVwiOlwib3RoZXJcIn0sYXJzOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dCxvPW4mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjowPT10P1wiemVyb1wiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6bz49MyYmbzw9MTA/XCJmZXdcIjpvPj0xMSYmbzw9OTk/XCJtYW55XCI6XCJvdGhlclwifSxhczpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXR8fDU9PXR8fDc9PXR8fDg9PXR8fDk9PXR8fDEwPT10P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjo2PT10P1wibWFueVwiOlwib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxhc2E6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sYXN0OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxhejpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89bi5zbGljZSgtMSksaT1uLnNsaWNlKC0yKSx1PW4uc2xpY2UoLTMpO3JldHVybiByPzE9PW98fDI9PW98fDU9PW98fDc9PW98fDg9PW98fDIwPT1pfHw1MD09aXx8NzA9PWl8fDgwPT1pP1wib25lXCI6Mz09b3x8ND09b3x8MTAwPT11fHwyMDA9PXV8fDMwMD09dXx8NDAwPT11fHw1MDA9PXV8fDYwMD09dXx8NzAwPT11fHw4MDA9PXV8fDkwMD09dT9cImZld1wiOjA9PW58fDY9PW98fDQwPT1pfHw2MD09aXx8OTA9PWk/XCJtYW55XCI6XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJlOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dCxvPW4mJmVbMF0uc2xpY2UoLTEpLGk9biYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/MiE9byYmMyE9b3x8MTI9PWl8fDEzPT1pP1wib3RoZXJcIjpcImZld1wiOjE9PW8mJjExIT1pP1wib25lXCI6bz49MiYmbzw9NCYmKGk8MTJ8fGk+MTQpP1wiZmV3XCI6biYmMD09b3x8bz49NSYmbzw9OXx8aT49MTEmJmk8PTE0P1wibWFueVwiOlwib3RoZXJcIn0sYmVtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJlejpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxiZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxiaDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSxibTpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sYm46ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10fHw1PT10fHw3PT10fHw4PT10fHw5PT10fHwxMD09dD9cIm9uZVwiOjI9PXR8fDM9PXQ/XCJ0d29cIjo0PT10P1wiZmV3XCI6Nj09dD9cIm1hbnlcIjpcIm90aGVyXCI6dD49MCYmdDw9MT9cIm9uZVwiOlwib3RoZXJcIn0sYm86ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGJyOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dCxvPW4mJmVbMF0uc2xpY2UoLTEpLGk9biYmZVswXS5zbGljZSgtMiksdT1uJiZlWzBdLnNsaWNlKC02KTtyZXR1cm4gcj9cIm90aGVyXCI6MT09byYmMTEhPWkmJjcxIT1pJiY5MSE9aT9cIm9uZVwiOjI9PW8mJjEyIT1pJiY3MiE9aSYmOTIhPWk/XCJ0d29cIjooMz09b3x8ND09b3x8OT09bykmJihpPDEwfHxpPjE5KSYmKGk8NzB8fGk+NzkpJiYoaTw5MHx8aT45OSk/XCJmZXdcIjowIT10JiZuJiYwPT11P1wibWFueVwiOlwib3RoZXJcIn0sYnJ4OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJzOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiLGk9IWVbMV0sdT1uLnNsaWNlKC0xKSxhPW4uc2xpY2UoLTIpLGM9by5zbGljZSgtMSksaD1vLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMT09dSYmMTEhPWF8fDE9PWMmJjExIT1oP1wib25lXCI6aSYmdT49MiYmdTw9NCYmKGE8MTJ8fGE+MTQpfHxjPj0yJiZjPD00JiYoaDwxMnx8aD4xNCk/XCJmZXdcIjpcIm90aGVyXCJ9LGNhOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByPzE9PXR8fDM9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6ND09dD9cImZld1wiOlwib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxjZTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxjZ2c6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sY2hyOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGNrYjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxjczpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm8/XCJvbmVcIjpuPj0yJiZuPD00JiZvP1wiZmV3XCI6bz9cIm90aGVyXCI6XCJtYW55XCJ9LGN5OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/MD09dHx8Nz09dHx8OD09dHx8OT09dD9cInplcm9cIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOjM9PXR8fDQ9PXQ/XCJmZXdcIjo1PT10fHw2PT10P1wibWFueVwiOlwib3RoZXJcIjowPT10P1wiemVyb1wiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6Mz09dD9cImZld1wiOjY9PXQ/XCJtYW55XCI6XCJvdGhlclwifSxkYTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89TnVtYmVyKGVbMF0pPT10O3JldHVybiByP1wib3RoZXJcIjoxIT10JiYob3x8MCE9biYmMSE9bik/XCJvdGhlclwiOlwib25lXCJ9LGRlOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxkc2I6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTIpLGE9by5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOmkmJjE9PXV8fDE9PWE/XCJvbmVcIjppJiYyPT11fHwyPT1hP1widHdvXCI6aSYmKDM9PXV8fDQ9PXUpfHwzPT1hfHw0PT1hP1wiZmV3XCI6XCJvdGhlclwifSxkdjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxkejpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sZWU6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZWw6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZW46ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV0sbz1OdW1iZXIoZVswXSk9PXQsaT1vJiZlWzBdLnNsaWNlKC0xKSx1PW8mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByPzE9PWkmJjExIT11P1wib25lXCI6Mj09aSYmMTIhPXU/XCJ0d29cIjozPT1pJiYxMyE9dT9cImZld1wiOlwib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxlbzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxlczpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxldDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sZXU6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZmE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6dD49MCYmdDw9MT9cIm9uZVwiOlwib3RoZXJcIn0sZmY6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6dD49MCYmdDwyP1wib25lXCI6XCJvdGhlclwifSxmaTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sZmlsOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiLGk9IWVbMV0sdT1uLnNsaWNlKC0xKSxhPW8uc2xpY2UoLTEpO3JldHVybiByPzE9PXQ/XCJvbmVcIjpcIm90aGVyXCI6aSYmKDE9PW58fDI9PW58fDM9PW4pfHxpJiY0IT11JiY2IT11JiY5IT11fHwhaSYmNCE9YSYmNiE9YSYmOSE9YT9cIm9uZVwiOlwib3RoZXJcIn0sZm86ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZnI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10P1wib25lXCI6XCJvdGhlclwiOnQ+PTAmJnQ8Mj9cIm9uZVwiOlwib3RoZXJcIn0sZnVyOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGZ5OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxnYTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQ7cmV0dXJuIHI/MT09dD9cIm9uZVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOm4mJnQ+PTMmJnQ8PTY/XCJmZXdcIjpuJiZ0Pj03JiZ0PD0xMD9cIm1hbnlcIjpcIm90aGVyXCJ9LGdkOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj8xPT10fHwxMT09dD9cIm9uZVwiOjI9PXR8fDEyPT10P1widHdvXCI6Mz09dHx8MTM9PXQ/XCJmZXdcIjpcIm90aGVyXCI6MT09dHx8MTE9PXQ/XCJvbmVcIjoyPT10fHwxMj09dD9cInR3b1wiOm4mJnQ+PTMmJnQ8PTEwfHxuJiZ0Pj0xMyYmdDw9MTk/XCJmZXdcIjpcIm90aGVyXCJ9LGdsOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxnc3c6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZ3U6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjo2PT10P1wibWFueVwiOlwib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxndXc6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZ3Y6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPSFlWzFdLGk9bi5zbGljZSgtMSksdT1uLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6byYmMT09aT9cIm9uZVwiOm8mJjI9PWk/XCJ0d29cIjohb3x8MCE9dSYmMjAhPXUmJjQwIT11JiY2MCE9dSYmODAhPXU/bz9cIm90aGVyXCI6XCJtYW55XCI6XCJmZXdcIn0saGE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0saGF3OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGhlOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXSxpPU51bWJlcihlWzBdKT09dCx1PWkmJmVbMF0uc2xpY2UoLTEpO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZvP1wib25lXCI6Mj09biYmbz9cInR3b1wiOm8mJih0PDB8fHQ+MTApJiZpJiYwPT11P1wibWFueVwiOlwib3RoZXJcIn0saGk6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjo2PT10P1wibWFueVwiOlwib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxocjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMSksYT1uLnNsaWNlKC0yKSxjPW8uc2xpY2UoLTEpLGg9by5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOmkmJjE9PXUmJjExIT1hfHwxPT1jJiYxMSE9aD9cIm9uZVwiOmkmJnU+PTImJnU8PTQmJihhPDEyfHxhPjE0KXx8Yz49MiYmYzw9NCYmKGg8MTJ8fGg+MTQpP1wiZmV3XCI6XCJvdGhlclwifSxoc2I6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTIpLGE9by5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOmkmJjE9PXV8fDE9PWE/XCJvbmVcIjppJiYyPT11fHwyPT1hP1widHdvXCI6aSYmKDM9PXV8fDQ9PXUpfHwzPT1hfHw0PT1hP1wiZmV3XCI6XCJvdGhlclwifSxodTpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXR8fDU9PXQ/XCJvbmVcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0saHk6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10P1wib25lXCI6XCJvdGhlclwiOnQ+PTAmJnQ8Mj9cIm9uZVwiOlwib3RoZXJcIn0saWE6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGlkOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxpZzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0saWk6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGluOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxpbzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0saXM6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPU51bWJlcihlWzBdKT09dCxpPW4uc2xpY2UoLTEpLHU9bi5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOm8mJjE9PWkmJjExIT11fHwhbz9cIm9uZVwiOlwib3RoZXJcIn0saXQ6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/MTE9PXR8fDg9PXR8fDgwPT10fHw4MDA9PXQ/XCJtYW55XCI6XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGl1OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxpdzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV0saT1OdW1iZXIoZVswXSk9PXQsdT1pJiZlWzBdLnNsaWNlKC0xKTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbz9cIm9uZVwiOjI9PW4mJm8/XCJ0d29cIjpvJiYodDwwfHx0PjEwKSYmaSYmMD09dT9cIm1hbnlcIjpcIm90aGVyXCJ9LGphOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxqYm86ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGpnbzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxqaTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sam1jOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGp2OmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxqdzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sa2E6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPW4uc2xpY2UoLTIpO3JldHVybiByPzE9PW4/XCJvbmVcIjowPT1ufHxvPj0yJiZvPD0yMHx8NDA9PW98fDYwPT1vfHw4MD09bz9cIm1hbnlcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa2FiOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOnQ+PTAmJnQ8Mj9cIm9uZVwiOlwib3RoZXJcIn0sa2FqOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGtjZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxrZGU6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGtlYTpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sa2s6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMSk7cmV0dXJuIHI/Nj09b3x8OT09b3x8biYmMD09byYmMCE9dD9cIm1hbnlcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa2tqOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGtsOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGttOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxrbjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxrbzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sa3M6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa3NiOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGtzaDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10P1wiemVyb1wiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGt1OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGt3OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxreTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxsYWc6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXTtyZXR1cm4gcj9cIm90aGVyXCI6MD09dD9cInplcm9cIjowIT1uJiYxIT1ufHwwPT10P1wib3RoZXJcIjpcIm9uZVwifSxsYjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxsZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxsa3Q6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGxuOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGxvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHImJjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGx0OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMV18fFwiXCIsbz1OdW1iZXIoZVswXSk9PXQsaT1vJiZlWzBdLnNsaWNlKC0xKSx1PW8mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjoxPT1pJiYodTwxMXx8dT4xOSk/XCJvbmVcIjppPj0yJiZpPD05JiYodTwxMXx8dT4xOSk/XCJmZXdcIjowIT1uP1wibWFueVwiOlwib3RoZXJcIn0sbHY6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVsxXXx8XCJcIixvPW4ubGVuZ3RoLGk9TnVtYmVyKGVbMF0pPT10LHU9aSYmZVswXS5zbGljZSgtMSksYT1pJiZlWzBdLnNsaWNlKC0yKSxjPW4uc2xpY2UoLTIpLGg9bi5zbGljZSgtMSk7cmV0dXJuIHI/XCJvdGhlclwiOmkmJjA9PXV8fGE+PTExJiZhPD0xOXx8Mj09byYmYz49MTEmJmM8PTE5P1wiemVyb1wiOjE9PXUmJjExIT1hfHwyPT1vJiYxPT1oJiYxMSE9Y3x8MiE9byYmMT09aD9cIm9uZVwiOlwib3RoZXJcIn0sbWFzOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG1nOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG1nbzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxtazpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMSksYT1uLnNsaWNlKC0yKSxjPW8uc2xpY2UoLTEpLGg9by5zbGljZSgtMik7cmV0dXJuIHI/MT09dSYmMTEhPWE/XCJvbmVcIjoyPT11JiYxMiE9YT9cInR3b1wiOjchPXUmJjghPXV8fDE3PT1hfHwxOD09YT9cIm90aGVyXCI6XCJtYW55XCI6aSYmMT09dSYmMTEhPWF8fDE9PWMmJjExIT1oP1wib25lXCI6XCJvdGhlclwifSxtbDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxtbjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxtbzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXSxvPU51bWJlcihlWzBdKT09dCxpPW8mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByPzE9PXQ/XCJvbmVcIjpcIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOiFufHwwPT10fHwxIT10JiZpPj0xJiZpPD0xOT9cImZld1wiOlwib3RoZXJcIn0sbXI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8xPT10P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjpcIm90aGVyXCI6dD49MCYmdDw9MT9cIm9uZVwiOlwib3RoZXJcIn0sbXM6ZnVuY3Rpb24odCxyKXtyZXR1cm4gciYmMT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbXQ6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjowPT10fHxvPj0yJiZvPD0xMD9cImZld1wiOm8+PTExJiZvPD0xOT9cIm1hbnlcIjpcIm90aGVyXCJ9LG15OmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxuYWg6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbmFxOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxuYjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxuZDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxuZTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQ7cmV0dXJuIHI/biYmdD49MSYmdDw9ND9cIm9uZVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxubDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sbm46ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbm5oOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG5vOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG5xbzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sbnI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbnNvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG55OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG55bjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxvbTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxvcjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQ7cmV0dXJuIHI/MT09dHx8NT09dHx8biYmdD49NyYmdDw9OT9cIm9uZVwiOjI9PXR8fDM9PXQ/XCJ0d29cIjo0PT10P1wiZmV3XCI6Nj09dD9cIm1hbnlcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sb3M6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0scGE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0scGFwOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHBsOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXSxpPW4uc2xpY2UoLTEpLHU9bi5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm8/XCJvbmVcIjpvJiZpPj0yJiZpPD00JiYodTwxMnx8dT4xNCk/XCJmZXdcIjpvJiYxIT1uJiYoMD09aXx8MT09aSl8fG8mJmk+PTUmJmk8PTl8fG8mJnU+PTEyJiZ1PD0xND9cIm1hbnlcIjpcIm90aGVyXCJ9LHByZzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzFdfHxcIlwiLG89bi5sZW5ndGgsaT1OdW1iZXIoZVswXSk9PXQsdT1pJiZlWzBdLnNsaWNlKC0xKSxhPWkmJmVbMF0uc2xpY2UoLTIpLGM9bi5zbGljZSgtMiksaD1uLnNsaWNlKC0xKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMD09dXx8YT49MTEmJmE8PTE5fHwyPT1vJiZjPj0xMSYmYzw9MTk/XCJ6ZXJvXCI6MT09dSYmMTEhPWF8fDI9PW8mJjE9PWgmJjExIT1jfHwyIT1vJiYxPT1oP1wib25lXCI6XCJvdGhlclwifSxwczpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxwdDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdO3JldHVybiByP1wib3RoZXJcIjowPT1ufHwxPT1uP1wib25lXCI6XCJvdGhlclwifSxcInB0LVBUXCI6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHJtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHJvOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdLG89TnVtYmVyKGVbMF0pPT10LGk9byYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/MT09dD9cIm9uZVwiOlwib3RoZXJcIjoxPT10JiZuP1wib25lXCI6IW58fDA9PXR8fDEhPXQmJmk+PTEmJmk8PTE5P1wiZmV3XCI6XCJvdGhlclwifSxyb2Y6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0scm9vdDpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0scnU6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPSFlWzFdLGk9bi5zbGljZSgtMSksdT1uLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6byYmMT09aSYmMTEhPXU/XCJvbmVcIjpvJiZpPj0yJiZpPD00JiYodTwxMnx8dT4xNCk/XCJmZXdcIjpvJiYwPT1pfHxvJiZpPj01JiZpPD05fHxvJiZ1Pj0xMSYmdTw9MTQ/XCJtYW55XCI6XCJvdGhlclwifSxyd2s6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc2FoOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxzYXE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc2M6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/MTE9PXR8fDg9PXR8fDgwPT10fHw4MDA9PXQ/XCJtYW55XCI6XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHNjbjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj8xMT09dHx8OD09dHx8ODA9PXR8fDgwMD09dD9cIm1hbnlcIjpcIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sc2Q6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc2RoOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHNlOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxzZWg6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc2VzOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxzZzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sc2g6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTEpLGE9bi5zbGljZSgtMiksYz1vLnNsaWNlKC0xKSxoPW8uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjppJiYxPT11JiYxMSE9YXx8MT09YyYmMTEhPWg/XCJvbmVcIjppJiZ1Pj0yJiZ1PD00JiYoYTwxMnx8YT4xNCl8fGM+PTImJmM8PTQmJihoPDEyfHxoPjE0KT9cImZld1wiOlwib3RoZXJcIn0sc2hpOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj9cIm90aGVyXCI6dD49MCYmdDw9MT9cIm9uZVwiOm4mJnQ+PTImJnQ8PTEwP1wiZmV3XCI6XCJvdGhlclwifSxzaTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIjtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dHx8MD09biYmMT09bz9cIm9uZVwiOlwib3RoZXJcIn0sc2s6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZvP1wib25lXCI6bj49MiYmbjw9NCYmbz9cImZld1wiOm8/XCJvdGhlclwiOlwibWFueVwifSxzbDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV0saT1uLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6byYmMT09aT9cIm9uZVwiOm8mJjI9PWk/XCJ0d29cIjpvJiYoMz09aXx8ND09aSl8fCFvP1wiZmV3XCI6XCJvdGhlclwifSxzbWE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LHNtaTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOlwib3RoZXJcIn0sc21qOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxzbW46ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LHNtczpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOlwib3RoZXJcIn0sc246ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc286ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc3E6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMSksaT1uJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj8xPT10P1wib25lXCI6ND09byYmMTQhPWk/XCJtYW55XCI6XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHNyOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiLGk9IWVbMV0sdT1uLnNsaWNlKC0xKSxhPW4uc2xpY2UoLTIpLGM9by5zbGljZSgtMSksaD1vLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMT09dSYmMTEhPWF8fDE9PWMmJjExIT1oP1wib25lXCI6aSYmdT49MiYmdTw9NCYmKGE8MTJ8fGE+MTQpfHxjPj0yJiZjPD00JiYoaDwxMnx8aD4xNCk/XCJmZXdcIjpcIm90aGVyXCJ9LHNzOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHNzeTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzdDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzdjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXSxvPU51bWJlcihlWzBdKT09dCxpPW8mJmVbMF0uc2xpY2UoLTEpLHU9byYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/MSE9aSYmMiE9aXx8MTE9PXV8fDEyPT11P1wib3RoZXJcIjpcIm9uZVwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHN3OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxzeXI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGU6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGVvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHRoOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSx0aTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSx0aWc6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGs6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMSk7cmV0dXJuIHI/Nj09b3x8OT09b3x8MTA9PXQ/XCJmZXdcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGw6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTEpLGE9by5zbGljZSgtMSk7cmV0dXJuIHI/MT09dD9cIm9uZVwiOlwib3RoZXJcIjppJiYoMT09bnx8Mj09bnx8Mz09bil8fGkmJjQhPXUmJjYhPXUmJjkhPXV8fCFpJiY0IT1hJiY2IT1hJiY5IT1hP1wib25lXCI6XCJvdGhlclwifSx0bjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0bzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sdHI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdHM6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdHptOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dHx8biYmdD49MTEmJnQ8PTk5P1wib25lXCI6XCJvdGhlclwifSx1ZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx1azpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV0saT1OdW1iZXIoZVswXSk9PXQsdT1pJiZlWzBdLnNsaWNlKC0xKSxhPWkmJmVbMF0uc2xpY2UoLTIpLGM9bi5zbGljZSgtMSksaD1uLnNsaWNlKC0yKTtyZXR1cm4gcj8zPT11JiYxMyE9YT9cImZld1wiOlwib3RoZXJcIjpvJiYxPT1jJiYxMSE9aD9cIm9uZVwiOm8mJmM+PTImJmM8PTQmJihoPDEyfHxoPjE0KT9cImZld1wiOm8mJjA9PWN8fG8mJmM+PTUmJmM8PTl8fG8mJmg+PTExJiZoPD0xND9cIm1hbnlcIjpcIm90aGVyXCJ9LHVyOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSx1ejpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx2ZTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx2aTpmdW5jdGlvbih0LHIpe3JldHVybiByJiYxPT10P1wib25lXCI6XCJvdGhlclwifSx2bzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx2dW46ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sd2E6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sd2FlOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHdvOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSx4aDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx4b2c6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0seWk6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHlvOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSx5dWU6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHpoOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSx6dTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifX0pP24uY2FsbChyLGUscix0KTpuKXx8KHQuZXhwb3J0cz1vKX0sZnVuY3Rpb24odCxyLGUpe3QuZXhwb3J0cz17ZGF0ZTplKDQpLGR1cmF0aW9uOmUoNSksbnVtYmVyOmUoNiksdGltZTplKDcpfX0sZnVuY3Rpb24odCxyLGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIG4odCxyLGUsbyl7dGhpcy5tZXNzYWdlPXQsdGhpcy5leHBlY3RlZD1yLHRoaXMuZm91bmQ9ZSx0aGlzLmxvY2F0aW9uPW8sdGhpcy5uYW1lPVwiU3ludGF4RXJyb3JcIixcImZ1bmN0aW9uXCI9PXR5cGVvZiBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSYmRXJyb3IuY2FwdHVyZVN0YWNrVHJhY2UodGhpcyxuKX0hZnVuY3Rpb24odCxyKXtmdW5jdGlvbiBlKCl7dGhpcy5jb25zdHJ1Y3Rvcj10fWUucHJvdG90eXBlPXIucHJvdG90eXBlLHQucHJvdG90eXBlPW5ldyBlfShuLEVycm9yKSxuLmJ1aWxkTWVzc2FnZT1mdW5jdGlvbih0LHIpe3ZhciBlPXtsaXRlcmFsOmZ1bmN0aW9uKHQpe3JldHVybidcIicrbyh0LnRleHQpKydcIid9LGNsYXNzOmZ1bmN0aW9uKHQpe3ZhciByLGU9XCJcIjtmb3Iocj0wO3I8dC5wYXJ0cy5sZW5ndGg7cisrKWUrPXQucGFydHNbcl1pbnN0YW5jZW9mIEFycmF5P2kodC5wYXJ0c1tyXVswXSkrXCItXCIraSh0LnBhcnRzW3JdWzFdKTppKHQucGFydHNbcl0pO3JldHVyblwiW1wiKyh0LmludmVydGVkP1wiXlwiOlwiXCIpK2UrXCJdXCJ9LGFueTpmdW5jdGlvbih0KXtyZXR1cm5cImFueSBjaGFyYWN0ZXJcIn0sZW5kOmZ1bmN0aW9uKHQpe3JldHVyblwiZW5kIG9mIGlucHV0XCJ9LG90aGVyOmZ1bmN0aW9uKHQpe3JldHVybiB0LmRlc2NyaXB0aW9ufX07ZnVuY3Rpb24gbih0KXtyZXR1cm4gdC5jaGFyQ29kZUF0KDApLnRvU3RyaW5nKDE2KS50b1VwcGVyQ2FzZSgpfWZ1bmN0aW9uIG8odCl7cmV0dXJuIHQucmVwbGFjZSgvXFxcXC9nLFwiXFxcXFxcXFxcIikucmVwbGFjZSgvXCIvZywnXFxcXFwiJykucmVwbGFjZSgvXFwwL2csXCJcXFxcMFwiKS5yZXBsYWNlKC9cXHQvZyxcIlxcXFx0XCIpLnJlcGxhY2UoL1xcbi9nLFwiXFxcXG5cIikucmVwbGFjZSgvXFxyL2csXCJcXFxcclwiKS5yZXBsYWNlKC9bXFx4MDAtXFx4MEZdL2csZnVuY3Rpb24odCl7cmV0dXJuXCJcXFxceDBcIituKHQpfSkucmVwbGFjZSgvW1xceDEwLVxceDFGXFx4N0YtXFx4OUZdL2csZnVuY3Rpb24odCl7cmV0dXJuXCJcXFxceFwiK24odCl9KX1mdW5jdGlvbiBpKHQpe3JldHVybiB0LnJlcGxhY2UoL1xcXFwvZyxcIlxcXFxcXFxcXCIpLnJlcGxhY2UoL1xcXS9nLFwiXFxcXF1cIikucmVwbGFjZSgvXFxeL2csXCJcXFxcXlwiKS5yZXBsYWNlKC8tL2csXCJcXFxcLVwiKS5yZXBsYWNlKC9cXDAvZyxcIlxcXFwwXCIpLnJlcGxhY2UoL1xcdC9nLFwiXFxcXHRcIikucmVwbGFjZSgvXFxuL2csXCJcXFxcblwiKS5yZXBsYWNlKC9cXHIvZyxcIlxcXFxyXCIpLnJlcGxhY2UoL1tcXHgwMC1cXHgwRl0vZyxmdW5jdGlvbih0KXtyZXR1cm5cIlxcXFx4MFwiK24odCl9KS5yZXBsYWNlKC9bXFx4MTAtXFx4MUZcXHg3Ri1cXHg5Rl0vZyxmdW5jdGlvbih0KXtyZXR1cm5cIlxcXFx4XCIrbih0KX0pfXJldHVyblwiRXhwZWN0ZWQgXCIrZnVuY3Rpb24odCl7dmFyIHIsbixvLGk9bmV3IEFycmF5KHQubGVuZ3RoKTtmb3Iocj0wO3I8dC5sZW5ndGg7cisrKWlbcl09KG89dFtyXSxlW28udHlwZV0obykpO2lmKGkuc29ydCgpLGkubGVuZ3RoPjApe2ZvcihyPTEsbj0xO3I8aS5sZW5ndGg7cisrKWlbci0xXSE9PWlbcl0mJihpW25dPWlbcl0sbisrKTtpLmxlbmd0aD1ufXN3aXRjaChpLmxlbmd0aCl7Y2FzZSAxOnJldHVybiBpWzBdO2Nhc2UgMjpyZXR1cm4gaVswXStcIiBvciBcIitpWzFdO2RlZmF1bHQ6cmV0dXJuIGkuc2xpY2UoMCwtMSkuam9pbihcIiwgXCIpK1wiLCBvciBcIitpW2kubGVuZ3RoLTFdfX0odCkrXCIgYnV0IFwiK2Z1bmN0aW9uKHQpe3JldHVybiB0PydcIicrbyh0KSsnXCInOlwiZW5kIG9mIGlucHV0XCJ9KHIpK1wiIGZvdW5kLlwifSx0LmV4cG9ydHM9e1N5bnRheEVycm9yOm4scGFyc2U6ZnVuY3Rpb24odCxyKXtyPXZvaWQgMCE9PXI/cjp7fTt2YXIgZSxvPXt9LGk9e3N0YXJ0OnRyfSx1PXRyLGE9XCIjXCIsYz1JdChcIiNcIiwhMSksaD1mdW5jdGlvbigpe3JldHVybiBwclswXX0sZj1mdW5jdGlvbigpe3JldHVybnt0eXBlOlwib2N0b3Rob3JwZVwifX0scz1mdW5jdGlvbih0KXtyZXR1cm4gdC5qb2luKFwiXCIpfSxsPVwie1wiLHA9SXQoXCJ7XCIsITEpLG09XCJ9XCIsZD1JdChcIn1cIiwhMSkseT1mdW5jdGlvbih0KXtyZXR1cm57dHlwZTpcImFyZ3VtZW50XCIsYXJnOnR9fSxnPVwiLFwiLHY9SXQoXCIsXCIsITEpLHc9XCJzZWxlY3RcIixiPUl0KFwic2VsZWN0XCIsITEpLFM9ZnVuY3Rpb24odCxlKXtyZXR1cm4gci5zdHJpY3QmJnByLnVuc2hpZnQoITEpLGV9LGs9ZnVuY3Rpb24odCxlKXtyZXR1cm4gci5zdHJpY3QmJnByLnNoaWZ0KCkse3R5cGU6XCJzZWxlY3RcIixhcmc6dCxjYXNlczplfX0seD1cInBsdXJhbFwiLEE9SXQoXCJwbHVyYWxcIiwhMSksaj1cInNlbGVjdG9yZGluYWxcIixOPUl0KFwic2VsZWN0b3JkaW5hbFwiLCExKSxDPWZ1bmN0aW9uKHQscil7cmV0dXJuIHByLnVuc2hpZnQoITApLHJ9LEY9ZnVuY3Rpb24odCxlLG4sbyl7dmFyIGk9KFwic2VsZWN0b3JkaW5hbFwiPT09ZT9yLm9yZGluYWw6ci5jYXJkaW5hbCl8fFtcInplcm9cIixcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdO3JldHVybiBpJiZpLmxlbmd0aCYmby5mb3JFYWNoKGZ1bmN0aW9uKHIpe2lmKGlzTmFOKHIua2V5KSYmaS5pbmRleE9mKHIua2V5KTwwKXRocm93IG5ldyBFcnJvcihcIkludmFsaWQga2V5IGBcIityLmtleStcImAgZm9yIGFyZ3VtZW50IGBcIit0K1wiYC4gVmFsaWQgXCIrZStcIiBrZXlzIGZvciB0aGlzIGxvY2FsZSBhcmUgYFwiK2kuam9pbihcImAsIGBcIikrXCJgLCBhbmQgZXhwbGljaXQga2V5cyBsaWtlIGA9MGAuXCIpfSkscHIuc2hpZnQoKSx7dHlwZTplLGFyZzp0LG9mZnNldDpufHwwLGNhc2VzOm99fSxPPWZ1bmN0aW9uKHQscixlKXtyZXR1cm57dHlwZTpcImZ1bmN0aW9uXCIsYXJnOnQsa2V5OnIscGFyYW06ZX19LEU9VnQoXCJpZGVudGlmaWVyXCIpLHo9L15bXlxcdC1cXHIgXFx4ODVcXHUyMDBFXFx1MjAwRlxcdTIwMjhcXHUyMDI5IS1cXC86LUBbLVxcXmB7LX5cXHhBMS1cXHhBN1xceEE5XFx4QUJcXHhBQ1xceEFFXFx4QjBcXHhCMVxceEI2XFx4QkJcXHhCRlxceEQ3XFx4RjdcXHUyMDEwLVxcdTIwMjdcXHUyMDMwLVxcdTIwM0VcXHUyMDQxLVxcdTIwNTNcXHUyMDU1LVxcdTIwNUVcXHUyMTkwLVxcdTI0NUZcXHUyNTAwLVxcdTI3NzVcXHUyNzk0LVxcdTJCRkZcXHUyRTAwLVxcdTJFN0ZcXHUzMDAxLVxcdTMwMDNcXHUzMDA4LVxcdTMwMjBcXHUzMDMwXFx1RkQzRVxcdUZEM0ZcXHVGRTQ1XFx1RkU0Nl0vLFA9WXQoW1tcIlxcdFwiLFwiXFxyXCJdLFwiIFwiLFwiwoVcIixcIuKAjlwiLFwi4oCPXCIsXCJcXHUyMDI4XCIsXCJcXHUyMDI5XCIsW1wiIVwiLFwiL1wiXSxbXCI6XCIsXCJAXCJdLFtcIltcIixcIl5cIl0sXCJgXCIsW1wie1wiLFwiflwiXSxbXCLCoVwiLFwiwqdcIl0sXCLCqVwiLFwiwqtcIixcIsKsXCIsXCLCrlwiLFwiwrBcIixcIsKxXCIsXCLCtlwiLFwiwrtcIixcIsK/XCIsXCLDl1wiLFwiw7dcIixbXCLigJBcIixcIuKAp1wiXSxbXCLigLBcIixcIuKAvlwiXSxbXCLigYFcIixcIuKBk1wiXSxbXCLigZVcIixcIuKBnlwiXSxbXCLihpBcIixcIuKRn1wiXSxbXCLilIBcIixcIuKdtVwiXSxbXCLinpRcIixcIuKvv1wiXSxbXCLiuIBcIixcIuK5v1wiXSxbXCLjgIFcIixcIuOAg1wiXSxbXCLjgIhcIixcIuOAoFwiXSxcIuOAsFwiLFwi77S+XCIsXCLvtL9cIixcIu+5hVwiLFwi77mGXCJdLCEwLCExKSxMPWZ1bmN0aW9uKHQscil7cmV0dXJue2tleTp0LHRva2VuczpyfX0sSj1mdW5jdGlvbih0KXtyZXR1cm4gdH0sRD1WdChcInBsdXJhbCBvZmZzZXRcIiksTT1cIm9mZnNldFwiLF89SXQoXCJvZmZzZXRcIiwhMSksVD1cIjpcIixSPUl0KFwiOlwiLCExKSxCPWZ1bmN0aW9uKHQpe3JldHVybiB0fSxxPVwiPVwiLCQ9SXQoXCI9XCIsITEpLEs9XCJudW1iZXJcIixHPUl0KFwibnVtYmVyXCIsITEpLFU9XCJkYXRlXCIsWj1JdChcImRhdGVcIiwhMSksST1cInRpbWVcIixZPUl0KFwidGltZVwiLCExKSxWPVwic3BlbGxvdXRcIixXPUl0KFwic3BlbGxvdXRcIiwhMSksSD1cIm9yZGluYWxcIixRPUl0KFwib3JkaW5hbFwiLCExKSxYPVwiZHVyYXRpb25cIix0dD1JdChcImR1cmF0aW9uXCIsITEpLHJ0PWZ1bmN0aW9uKHQpe2lmKHIuc3RyaWN0fHwvXlxcZC8udGVzdCh0KSlyZXR1cm4hMTtzd2l0Y2godC50b0xvd2VyQ2FzZSgpKXtjYXNlXCJzZWxlY3RcIjpjYXNlXCJwbHVyYWxcIjpjYXNlXCJzZWxlY3RvcmRpbmFsXCI6cmV0dXJuITE7ZGVmYXVsdDpyZXR1cm4hMH19LGV0PWZ1bmN0aW9uKHQpe3JldHVybiB0fSxudD1mdW5jdGlvbih0KXtyZXR1cm4hci5zdHJpY3R9LG90PWZ1bmN0aW9uKHQpe3JldHVybnt0b2tlbnM6dH19LGl0PWZ1bmN0aW9uKHQpe3JldHVybnt0b2tlbnM6W3Quam9pbihcIlwiKV19fSx1dD1WdChcImEgdmFsaWQgKHN0cmljdCkgZnVuY3Rpb24gcGFyYW1ldGVyXCIpLGF0PS9eW14ne31dLyxjdD1ZdChbXCInXCIsXCJ7XCIsXCJ9XCJdLCEwLCExKSxodD1mdW5jdGlvbih0KXtyZXR1cm4gdC5qb2luKFwiXCIpfSxmdD1cIidcIixzdD1JdChcIidcIiwhMSksbHQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHB0PWZ1bmN0aW9uKHQpe3JldHVyblwie1wiK3Quam9pbihcIlwiKStcIn1cIn0sbXQ9VnQoXCJkb3VibGVkIGFwb3N0cm9waGVcIiksZHQ9XCInJ1wiLHl0PUl0KFwiJydcIiwhMSksZ3Q9ZnVuY3Rpb24oKXtyZXR1cm5cIidcIn0sdnQ9L15bXiddLyx3dD1ZdChbXCInXCJdLCEwLCExKSxidD1cIid7XCIsU3Q9SXQoXCIne1wiLCExKSxrdD1mdW5jdGlvbih0KXtyZXR1cm5cIntcIit0LmpvaW4oXCJcIil9LHh0PVwiJ31cIixBdD1JdChcIid9XCIsITEpLGp0PWZ1bmN0aW9uKHQpe3JldHVyblwifVwiK3Quam9pbihcIlwiKX0sTnQ9VnQoXCJlc2NhcGVkIHN0cmluZ1wiKSxDdD1cIicjXCIsRnQ9SXQoXCInI1wiLCExKSxPdD1mdW5jdGlvbih0KXtyZXR1cm5cIiNcIit0LmpvaW4oXCJcIil9LEV0PWZ1bmN0aW9uKHQpe3JldHVybiB0WzBdfSx6dD1WdChcInBsYWluIGNoYXJcIiksUHQ9L15bXnt9I1xcMC1cXHgwOFxceDBFLVxceDFGXFx4N0ZdLyxMdD1ZdChbXCJ7XCIsXCJ9XCIsXCIjXCIsW1wiXFwwXCIsXCJcXGJcIl0sW1wiXHUwMDBlXCIsXCJcdTAwMWZcIl0sXCJ/XCJdLCEwLCExKSxKdD1mdW5jdGlvbih0KXtyZXR1cm4hcHJbMF19LER0PWZ1bmN0aW9uKHQpe3JldHVybiB0fSxNdD1WdChcImludGVnZXJcIiksX3Q9L15bMC05XS8sVHQ9WXQoW1tcIjBcIixcIjlcIl1dLCExLCExKSxSdD1WdChcIndoaXRlIHNwYWNlXCIpLEJ0PS9eW1xcdC1cXHIgXFx4ODVcXHUyMDBFXFx1MjAwRlxcdTIwMjhcXHUyMDI5XS8scXQ9WXQoW1tcIlxcdFwiLFwiXFxyXCJdLFwiIFwiLFwiwoVcIixcIuKAjlwiLFwi4oCPXCIsXCJcXHUyMDI4XCIsXCJcXHUyMDI5XCJdLCExLCExKSwkdD0wLEt0PVt7bGluZToxLGNvbHVtbjoxfV0sR3Q9MCxVdD1bXSxadD0wO2lmKFwic3RhcnRSdWxlXCJpbiByKXtpZighKHIuc3RhcnRSdWxlIGluIGkpKXRocm93IG5ldyBFcnJvcihcIkNhbid0IHN0YXJ0IHBhcnNpbmcgZnJvbSBydWxlIFxcXCJcIityLnN0YXJ0UnVsZSsnXCIuJyk7dT1pW3Iuc3RhcnRSdWxlXX1mdW5jdGlvbiBJdCh0LHIpe3JldHVybnt0eXBlOlwibGl0ZXJhbFwiLHRleHQ6dCxpZ25vcmVDYXNlOnJ9fWZ1bmN0aW9uIFl0KHQscixlKXtyZXR1cm57dHlwZTpcImNsYXNzXCIscGFydHM6dCxpbnZlcnRlZDpyLGlnbm9yZUNhc2U6ZX19ZnVuY3Rpb24gVnQodCl7cmV0dXJue3R5cGU6XCJvdGhlclwiLGRlc2NyaXB0aW9uOnR9fWZ1bmN0aW9uIFd0KHIpe3ZhciBlLG49S3Rbcl07aWYobilyZXR1cm4gbjtmb3IoZT1yLTE7IUt0W2VdOyllLS07Zm9yKG49e2xpbmU6KG49S3RbZV0pLmxpbmUsY29sdW1uOm4uY29sdW1ufTtlPHI7KTEwPT09dC5jaGFyQ29kZUF0KGUpPyhuLmxpbmUrKyxuLmNvbHVtbj0xKTpuLmNvbHVtbisrLGUrKztyZXR1cm4gS3Rbcl09bixufWZ1bmN0aW9uIEh0KHQscil7dmFyIGU9V3QodCksbj1XdChyKTtyZXR1cm57c3RhcnQ6e29mZnNldDp0LGxpbmU6ZS5saW5lLGNvbHVtbjplLmNvbHVtbn0sZW5kOntvZmZzZXQ6cixsaW5lOm4ubGluZSxjb2x1bW46bi5jb2x1bW59fX1mdW5jdGlvbiBRdCh0KXskdDxHdHx8KCR0Pkd0JiYoR3Q9JHQsVXQ9W10pLFV0LnB1c2godCkpfWZ1bmN0aW9uIFh0KHQscixlKXtyZXR1cm4gbmV3IG4obi5idWlsZE1lc3NhZ2UodCxyKSx0LHIsZSl9ZnVuY3Rpb24gdHIoKXt2YXIgdCxyO2Zvcih0PVtdLHI9cnIoKTtyIT09bzspdC5wdXNoKHIpLHI9cnIoKTtyZXR1cm4gdH1mdW5jdGlvbiBycigpe3ZhciByLGUsbjtpZigocj1mdW5jdGlvbigpe3ZhciByLGUsbixpO3JldHVybiByPSR0LDEyMz09PXQuY2hhckNvZGVBdCgkdCk/KGU9bCwkdCsrKTooZT1vLDA9PT1adCYmUXQocCkpLGUhPT1vJiZscigpIT09byYmKG49ZXIoKSkhPT1vJiZscigpIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1tLCR0KyspOihpPW8sMD09PVp0JiZRdChkKSksaSE9PW8/KGU9eShuKSxyPWUpOigkdD1yLHI9bykpOigkdD1yLHI9bykscn0oKSk9PT1vJiYocj1mdW5jdGlvbigpe3ZhciByLGUsbixpLHUsYSxjLGgsZjtpZihyPSR0LDEyMz09PXQuY2hhckNvZGVBdCgkdCk/KGU9bCwkdCsrKTooZT1vLDA9PT1adCYmUXQocCkpLGUhPT1vKWlmKGxyKCkhPT1vKWlmKChuPWVyKCkpIT09bylpZihscigpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KGk9ZywkdCsrKTooaT1vLDA9PT1adCYmUXQodikpLGkhPT1vKWlmKGxyKCkhPT1vKWlmKCR0LHQuc3Vic3RyKCR0LDYpPT09dz8odT13LCR0Kz02KToodT1vLDA9PT1adCYmUXQoYikpLHUhPT1vJiYodT1TKG4sdSkpLHUhPT1vKWlmKCh1PWxyKCkpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KGE9ZywkdCsrKTooYT1vLDA9PT1adCYmUXQodikpLGEhPT1vKWlmKGxyKCkhPT1vKXtpZihjPVtdLChoPW5yKCkpIT09bylmb3IoO2ghPT1vOyljLnB1c2goaCksaD1ucigpO2Vsc2UgYz1vO2MhPT1vJiYoaD1scigpKSE9PW8/KDEyNT09PXQuY2hhckNvZGVBdCgkdCk/KGY9bSwkdCsrKTooZj1vLDA9PT1adCYmUXQoZCkpLGYhPT1vPyhlPWsobixjKSxyPWUpOigkdD1yLHI9bykpOigkdD1yLHI9byl9ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztyZXR1cm4gcn0oKSk9PT1vJiYocj1mdW5jdGlvbigpe3ZhciByLGUsbixpLHUsYSxjLGgsZixzLHk7aWYocj0kdCwxMjM9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWwsJHQrKyk6KGU9bywwPT09WnQmJlF0KHApKSxlIT09bylpZihscigpIT09bylpZigobj1lcigpKSE9PW8paWYobHIoKSE9PW8paWYoNDQ9PT10LmNoYXJDb2RlQXQoJHQpPyhpPWcsJHQrKyk6KGk9bywwPT09WnQmJlF0KHYpKSxpIT09bylpZihscigpIT09bylpZih1PSR0LHQuc3Vic3RyKCR0LDYpPT09eD8oYT14LCR0Kz02KTooYT1vLDA9PT1adCYmUXQoQSkpLGE9PT1vJiYodC5zdWJzdHIoJHQsMTMpPT09aj8oYT1qLCR0Kz0xMyk6KGE9bywwPT09WnQmJlF0KE4pKSksYSE9PW8mJihhPUMobixhKSksKHU9YSkhPT1vKWlmKChhPWxyKCkpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KGM9ZywkdCsrKTooYz1vLDA9PT1adCYmUXQodikpLGMhPT1vKWlmKGxyKCkhPT1vKWlmKChoPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGksdTtyZXR1cm4gWnQrKyxyPSR0LChlPWxyKCkpIT09bz8odC5zdWJzdHIoJHQsNik9PT1NPyhuPU0sJHQrPTYpOihuPW8sMD09PVp0JiZRdChfKSksbiE9PW8mJmxyKCkhPT1vPyg1OD09PXQuY2hhckNvZGVBdCgkdCk/KGk9VCwkdCsrKTooaT1vLDA9PT1adCYmUXQoUikpLGkhPT1vJiZscigpIT09byYmKHU9c3IoKSkhPT1vJiZscigpIT09bz8oZT1CKHUpLHI9ZSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSxadC0tLHI9PT1vJiYoZT1vLDA9PT1adCYmUXQoRCkpLHJ9KCkpPT09byYmKGg9bnVsbCksaCE9PW8pe2lmKGY9W10sKHM9b3IoKSkhPT1vKWZvcig7cyE9PW87KWYucHVzaChzKSxzPW9yKCk7ZWxzZSBmPW87ZiE9PW8mJihzPWxyKCkpIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oeT1tLCR0KyspOih5PW8sMD09PVp0JiZRdChkKSkseSE9PW8/KGU9RihuLHUsaCxmKSxyPWUpOigkdD1yLHI9bykpOigkdD1yLHI9byl9ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO3JldHVybiByfSgpKT09PW8mJihyPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGksdSxhLGM7cmV0dXJuIHI9JHQsMTIzPT09dC5jaGFyQ29kZUF0KCR0KT8oZT1sLCR0KyspOihlPW8sMD09PVp0JiZRdChwKSksZSE9PW8mJmxyKCkhPT1vJiYobj1lcigpKSE9PW8mJmxyKCkhPT1vPyg0ND09PXQuY2hhckNvZGVBdCgkdCk/KGk9ZywkdCsrKTooaT1vLDA9PT1adCYmUXQodikpLGkhPT1vJiZscigpIT09byYmKHU9ZnVuY3Rpb24oKXt2YXIgcixlLG4saSx1O3JldHVybiB0LnN1YnN0cigkdCw2KT09PUs/KHI9SywkdCs9Nik6KHI9bywwPT09WnQmJlF0KEcpKSxyPT09byYmKHQuc3Vic3RyKCR0LDQpPT09VT8ocj1VLCR0Kz00KToocj1vLDA9PT1adCYmUXQoWikpLHI9PT1vJiYodC5zdWJzdHIoJHQsNCk9PT1JPyhyPUksJHQrPTQpOihyPW8sMD09PVp0JiZRdChZKSkscj09PW8mJih0LnN1YnN0cigkdCw4KT09PVY/KHI9ViwkdCs9OCk6KHI9bywwPT09WnQmJlF0KFcpKSxyPT09byYmKHQuc3Vic3RyKCR0LDcpPT09SD8ocj1ILCR0Kz03KToocj1vLDA9PT1adCYmUXQoUSkpLHI9PT1vJiYodC5zdWJzdHIoJHQsOCk9PT1YPyhyPVgsJHQrPTgpOihyPW8sMD09PVp0JiZRdCh0dCkpLHI9PT1vJiYocj0kdCxlPSR0LFp0KyssdC5zdWJzdHIoJHQsNik9PT13PyhuPXcsJHQrPTYpOihuPW8sMD09PVp0JiZRdChiKSksWnQtLSxuPT09bz9lPXZvaWQgMDooJHQ9ZSxlPW8pLGUhPT1vPyhuPSR0LFp0KyssdC5zdWJzdHIoJHQsNik9PT14PyhpPXgsJHQrPTYpOihpPW8sMD09PVp0JiZRdChBKSksWnQtLSxpPT09bz9uPXZvaWQgMDooJHQ9bixuPW8pLG4hPT1vPyhpPSR0LFp0KyssdC5zdWJzdHIoJHQsMTMpPT09aj8odT1qLCR0Kz0xMyk6KHU9bywwPT09WnQmJlF0KE4pKSxadC0tLHU9PT1vP2k9dm9pZCAwOigkdD1pLGk9byksaSE9PW8mJih1PWVyKCkpIT09byYmKHJ0KHUpP3ZvaWQgMDpvKSE9PW8/KGU9ZXQodSkscj1lKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pKSkpKSkpLHJ9KCkpIT09byYmbHIoKSE9PW8/KChhPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGksdTtpZihyPSR0LChlPWxyKCkpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KG49ZywkdCsrKToobj1vLDA9PT1adCYmUXQodikpLG4hPT1vKXtmb3IoaT1bXSx1PXJyKCk7dSE9PW87KWkucHVzaCh1KSx1PXJyKCk7aSE9PW8mJih1PSh1PW50KGkpKT92b2lkIDA6bykhPT1vPyhlPW90KGkpLHI9ZSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87aWYocj09PW8paWYocj0kdCwoZT1scigpKSE9PW8paWYoNDQ9PT10LmNoYXJDb2RlQXQoJHQpPyhuPWcsJHQrKyk6KG49bywwPT09WnQmJlF0KHYpKSxuIT09byl7Zm9yKGk9W10sdT11cigpO3UhPT1vOylpLnB1c2godSksdT11cigpO2khPT1vPyhlPWl0KGkpLHI9ZSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87cmV0dXJuIHJ9KCkpPT09byYmKGE9bnVsbCksYSE9PW8/KDEyNT09PXQuY2hhckNvZGVBdCgkdCk/KGM9bSwkdCsrKTooYz1vLDA9PT1adCYmUXQoZCkpLGMhPT1vPyhlPU8obix1LGEpLHI9ZSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSxyfSgpKT09PW8mJihyPSR0LDM1PT09dC5jaGFyQ29kZUF0KCR0KT8oZT1hLCR0KyspOihlPW8sMD09PVp0JiZRdChjKSksZSE9PW8mJihuPShuPWgoKSk/dm9pZCAwOm8pIT09bz9yPWU9ZigpOigkdD1yLHI9bykscj09PW8pKXtpZihyPSR0LGU9W10sKG49ZnIoKSkhPT1vKWZvcig7biE9PW87KWUucHVzaChuKSxuPWZyKCk7ZWxzZSBlPW87ZSE9PW8mJihlPXMoZSkpLHI9ZX1yZXR1cm4gcn1mdW5jdGlvbiBlcigpe3ZhciByLGUsbjtpZihadCsrLHI9JHQsZT1bXSx6LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KFApKSxuIT09bylmb3IoO24hPT1vOyllLnB1c2gobiksei50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdChQKSk7ZWxzZSBlPW87cmV0dXJuIHI9ZSE9PW8/dC5zdWJzdHJpbmcociwkdCk6ZSxadC0tLHI9PT1vJiYoZT1vLDA9PT1adCYmUXQoRSkpLHJ9ZnVuY3Rpb24gbnIoKXt2YXIgdCxyLGU7cmV0dXJuIHQ9JHQsbHIoKSE9PW8mJihyPWVyKCkpIT09byYmbHIoKSE9PW8mJihlPWlyKCkpIT09bz90PUwocixlKTooJHQ9dCx0PW8pLHR9ZnVuY3Rpb24gb3IoKXt2YXIgcixlLG47cmV0dXJuIHI9JHQsbHIoKSE9PW8mJihlPWZ1bmN0aW9uKCl7dmFyIHIsZSxuO3JldHVybihyPWVyKCkpPT09byYmKHI9JHQsNjE9PT10LmNoYXJDb2RlQXQoJHQpPyhlPXEsJHQrKyk6KGU9bywwPT09WnQmJlF0KCQpKSxlIT09byYmKG49c3IoKSkhPT1vPyhlPUIobikscj1lKTooJHQ9cixyPW8pKSxyfSgpKSE9PW8mJmxyKCkhPT1vJiYobj1pcigpKSE9PW8/cj1MKGUsbik6KCR0PXIscj1vKSxyfWZ1bmN0aW9uIGlyKCl7dmFyIHIsZSxuLGksdSxhO2lmKHI9JHQsMTIzPT09dC5jaGFyQ29kZUF0KCR0KT8oZT1sLCR0KyspOihlPW8sMD09PVp0JiZRdChwKSksZSE9PW8paWYobj0kdCwoaT1scigpKSE9PW8/KHU9JHQsWnQrKywxMjM9PT10LmNoYXJDb2RlQXQoJHQpPyhhPWwsJHQrKyk6KGE9bywwPT09WnQmJlF0KHApKSxadC0tLGEhPT1vPygkdD11LHU9dm9pZCAwKTp1PW8sdSE9PW8/bj1pPVtpLHVdOigkdD1uLG49bykpOigkdD1uLG49byksbj09PW8mJihuPW51bGwpLG4hPT1vKXtmb3IoaT1bXSx1PXJyKCk7dSE9PW87KWkucHVzaCh1KSx1PXJyKCk7aSE9PW8mJih1PWxyKCkpIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oYT1tLCR0KyspOihhPW8sMD09PVp0JiZRdChkKSksYSE9PW8/cj1lPUooaSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87cmV0dXJuIHJ9ZnVuY3Rpb24gdXIoKXt2YXIgcixlLG4saTtpZihadCsrLHI9JHQsZT1bXSxhdC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdChjdCkpLG4hPT1vKWZvcig7biE9PW87KWUucHVzaChuKSxhdC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdChjdCkpO2Vsc2UgZT1vO2lmKGUhPT1vJiYoZT1odChlKSksKHI9ZSk9PT1vJiYocj1hcigpKT09PW8mJihyPSR0LDM5PT09dC5jaGFyQ29kZUF0KCR0KT8oZT1mdCwkdCsrKTooZT1vLDA9PT1adCYmUXQoc3QpKSxlIT09byYmKG49Y3IoKSkhPT1vPygzOT09PXQuY2hhckNvZGVBdCgkdCk/KGk9ZnQsJHQrKyk6KGk9bywwPT09WnQmJlF0KHN0KSksaSE9PW8/cj1lPWx0KG4pOigkdD1yLHI9bykpOigkdD1yLHI9bykscj09PW8pKWlmKHI9JHQsMTIzPT09dC5jaGFyQ29kZUF0KCR0KT8oZT1sLCR0KyspOihlPW8sMD09PVp0JiZRdChwKSksZSE9PW8pe2ZvcihuPVtdLGk9dXIoKTtpIT09bzspbi5wdXNoKGkpLGk9dXIoKTtuIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1tLCR0KyspOihpPW8sMD09PVp0JiZRdChkKSksaSE9PW8/cj1lPXB0KG4pOigkdD1yLHI9bykpOigkdD1yLHI9byl9ZWxzZSAkdD1yLHI9bztyZXR1cm4gWnQtLSxyPT09byYmKGU9bywwPT09WnQmJlF0KHV0KSkscn1mdW5jdGlvbiBhcigpe3ZhciByLGU7cmV0dXJuIFp0Kysscj0kdCx0LnN1YnN0cigkdCwyKT09PWR0PyhlPWR0LCR0Kz0yKTooZT1vLDA9PT1adCYmUXQoeXQpKSxlIT09byYmKGU9Z3QoKSksWnQtLSwocj1lKT09PW8mJihlPW8sMD09PVp0JiZRdChtdCkpLHJ9ZnVuY3Rpb24gY3IoKXt2YXIgcixlLG47aWYoKHI9YXIoKSk9PT1vKXtpZihyPSR0LGU9W10sdnQudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQod3QpKSxuIT09bylmb3IoO24hPT1vOyllLnB1c2gobiksdnQudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQod3QpKTtlbHNlIGU9bztlIT09byYmKGU9cyhlKSkscj1lfXJldHVybiByfWZ1bmN0aW9uIGhyKCl7dmFyIHIsZSxuLGksdSxhO2lmKFp0KyssKHI9ZnVuY3Rpb24oKXt2YXIgcixlLG4saTtpZihyPSR0LHQuc3Vic3RyKCR0LDIpPT09YnQ/KGU9YnQsJHQrPTIpOihlPW8sMD09PVp0JiZRdChTdCkpLGUhPT1vKXtmb3Iobj1bXSxpPWNyKCk7aSE9PW87KW4ucHVzaChpKSxpPWNyKCk7biE9PW8/KDM5PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1mdCwkdCsrKTooaT1vLDA9PT1adCYmUXQoc3QpKSxpIT09bz9yPWU9a3Qobik6KCR0PXIscj1vKSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2lmKHI9PT1vKWlmKHI9JHQsdC5zdWJzdHIoJHQsMik9PT14dD8oZT14dCwkdCs9Mik6KGU9bywwPT09WnQmJlF0KEF0KSksZSE9PW8pe2ZvcihuPVtdLGk9Y3IoKTtpIT09bzspbi5wdXNoKGkpLGk9Y3IoKTtuIT09bz8oMzk9PT10LmNoYXJDb2RlQXQoJHQpPyhpPWZ0LCR0KyspOihpPW8sMD09PVp0JiZRdChzdCkpLGkhPT1vP3I9ZT1qdChuKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pfWVsc2UgJHQ9cixyPW87cmV0dXJuIHJ9KCkpPT09byl7aWYocj0kdCxlPSR0LG49JHQsdC5zdWJzdHIoJHQsMik9PT1DdD8oaT1DdCwkdCs9Mik6KGk9bywwPT09WnQmJlF0KEZ0KSksaSE9PW8pe2Zvcih1PVtdLGE9Y3IoKTthIT09bzspdS5wdXNoKGEpLGE9Y3IoKTt1IT09bz8oMzk9PT10LmNoYXJDb2RlQXQoJHQpPyhhPWZ0LCR0KyspOihhPW8sMD09PVp0JiZRdChzdCkpLGEhPT1vP249aT1PdCh1KTooJHQ9bixuPW8pKTooJHQ9bixuPW8pfWVsc2UgJHQ9bixuPW87biE9PW8mJihpPShpPWgoKSk/dm9pZCAwOm8pIT09bz9lPW49W24saV06KCR0PWUsZT1vKSxlIT09byYmKGU9RXQoZSkpLChyPWUpPT09byYmKDM5PT09dC5jaGFyQ29kZUF0KCR0KT8ocj1mdCwkdCsrKToocj1vLDA9PT1adCYmUXQoc3QpKSl9cmV0dXJuIFp0LS0scj09PW8mJihlPW8sMD09PVp0JiZRdChOdCkpLHJ9ZnVuY3Rpb24gZnIoKXt2YXIgcixlO3JldHVybihyPWFyKCkpPT09byYmKHI9aHIoKSk9PT1vJiYocj0kdCwzNT09PXQuY2hhckNvZGVBdCgkdCk/KGU9YSwkdCsrKTooZT1vLDA9PT1adCYmUXQoYykpLGUhPT1vJiYoSnQoZSk/dm9pZCAwOm8pIT09bz9yPWU9RHQoZSk6KCR0PXIscj1vKSxyPT09byYmKHI9ZnVuY3Rpb24oKXt2YXIgcjtyZXR1cm4gWnQrKyxQdC50ZXN0KHQuY2hhckF0KCR0KSk/KHI9dC5jaGFyQXQoJHQpLCR0KyspOihyPW8sMD09PVp0JiZRdChMdCkpLFp0LS0scj09PW8mJjA9PT1adCYmUXQoenQpLHJ9KCkpKSxyfWZ1bmN0aW9uIHNyKCl7dmFyIHIsZSxuO2lmKFp0Kysscj0kdCxlPVtdLF90LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KFR0KSksbiE9PW8pZm9yKDtuIT09bzspZS5wdXNoKG4pLF90LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KFR0KSk7ZWxzZSBlPW87cmV0dXJuIHI9ZSE9PW8/dC5zdWJzdHJpbmcociwkdCk6ZSxadC0tLHI9PT1vJiYoZT1vLDA9PT1adCYmUXQoTXQpKSxyfWZ1bmN0aW9uIGxyKCl7dmFyIHIsZSxuO2ZvcihadCsrLHI9JHQsZT1bXSxCdC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdChxdCkpO24hPT1vOyllLnB1c2gobiksQnQudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQocXQpKTtyZXR1cm4gcj1lIT09bz90LnN1YnN0cmluZyhyLCR0KTplLFp0LS0scj09PW8mJihlPW8sMD09PVp0JiZRdChSdCkpLHJ9dmFyIHByPVshMV07aWYoKGU9dSgpKSE9PW8mJiR0PT09dC5sZW5ndGgpcmV0dXJuIGU7dGhyb3cgZSE9PW8mJiR0PHQubGVuZ3RoJiZRdCh7dHlwZTpcImVuZFwifSksWHQoVXQsR3Q8dC5sZW5ndGg/dC5jaGFyQXQoR3QpOm51bGwsR3Q8dC5sZW5ndGg/SHQoR3QsR3QrMSk6SHQoR3QsR3QpKX19fSxmdW5jdGlvbih0LHIsZSl7dmFyIG4sbyxpPVt7Y2FyZGluYWw6W1wib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0se2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0se2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSx7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19XTt2b2lkIDA9PT0obz1cImZ1bmN0aW9uXCI9PXR5cGVvZihuPXthZjppWzFdLGFrOmlbMV0sYW06aVsxXSxhcjp7Y2FyZGluYWw6W1wiemVyb1wiLFwib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sYXJzOntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxhczp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdfSxhc2E6aVsxXSxhc3Q6aVsxXSxhejp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXX0sYmU6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcImZld1wiLFwib3RoZXJcIl19LGJlbTppWzFdLGJlejppWzFdLGJnOmlbMV0sYmg6aVsxXSxibTppWzBdLGJuOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl19LGJvOmlbMF0sYnI6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGJyeDppWzFdLGJzOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sY2E6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXX0sY2U6aVsxXSxjZ2c6aVsxXSxjaHI6aVsxXSxja2I6aVsxXSxjczp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGN5OntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcInplcm9cIixcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdfSxkYTppWzFdLGRlOmlbMV0sZHNiOntjYXJkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxkdjppWzFdLGR6OmlbMF0sZWU6aVsxXSxlbDppWzFdLGVuOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwib3RoZXJcIl19LGVvOmlbMV0sZXM6aVsxXSxldDppWzFdLGV1OmlbMV0sZmE6aVsxXSxmZjppWzFdLGZpOmlbMV0sZmlsOmlbMl0sZm86aVsxXSxmcjppWzJdLGZ1cjppWzFdLGZ5OmlbMV0sZ2E6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJvdGhlclwiXX0sZ2Q6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwib3RoZXJcIl19LGdsOmlbMV0sZ3N3OmlbMV0sZ3U6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXX0sZ3V3OmlbMV0sZ3Y6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGhhOmlbMV0saGF3OmlbMV0saGU6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxoaTp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdfSxocjp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGhzYjp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0saHU6aVsyXSxoeTppWzJdLGlhOmlbMV0saWQ6aVswXSxpZzppWzBdLGlpOmlbMF0saW46aVswXSxpbzppWzFdLGlzOmlbMV0saXQ6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJtYW55XCIsXCJvdGhlclwiXX0saXU6aVszXSxpdzp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGphOmlbMF0samJvOmlbMF0samdvOmlbMV0samk6aVsxXSxqbWM6aVsxXSxqdjppWzBdLGp3OmlbMF0sa2E6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm1hbnlcIixcIm90aGVyXCJdfSxrYWI6aVsxXSxrYWo6aVsxXSxrY2c6aVsxXSxrZGU6aVswXSxrZWE6aVswXSxrazp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm1hbnlcIixcIm90aGVyXCJdfSxra2o6aVsxXSxrbDppWzFdLGttOmlbMF0sa246aVsxXSxrbzppWzBdLGtzOmlbMV0sa3NiOmlbMV0sa3NoOntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGt1OmlbMV0sa3c6aVszXSxreTppWzFdLGxhZzp7Y2FyZGluYWw6W1wiemVyb1wiLFwib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxsYjppWzFdLGxnOmlbMV0sbGt0OmlbMF0sbG46aVsxXSxsbzp7Y2FyZGluYWw6W1wib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSxsdDp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGx2OntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LG1hczppWzFdLG1nOmlbMV0sbWdvOmlbMV0sbWs6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwibWFueVwiLFwib3RoZXJcIl19LG1sOmlbMV0sbW46aVsxXSxtbzp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJvdGhlclwiXX0sbXI6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXX0sbXM6e2NhcmRpbmFsOltcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJvdGhlclwiXX0sbXQ6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxteTppWzBdLG5haDppWzFdLG5hcTppWzNdLG5iOmlbMV0sbmQ6aVsxXSxuZTppWzJdLG5sOmlbMV0sbm46aVsxXSxubmg6aVsxXSxubzppWzFdLG5xbzppWzBdLG5yOmlbMV0sbnNvOmlbMV0sbnk6aVsxXSxueW46aVsxXSxvbTppWzFdLG9yOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl19LG9zOmlbMV0scGE6aVsxXSxwYXA6aVsxXSxwbDp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LHByZzp7Y2FyZGluYWw6W1wiemVyb1wiLFwib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxwczppWzFdLHB0OmlbMV0sXCJwdC1QVFwiOmlbMV0scm06aVsxXSxybzp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJvdGhlclwiXX0scm9mOmlbMV0scm9vdDppWzBdLHJ1OntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0scndrOmlbMV0sc2FoOmlbMF0sc2FxOmlbMV0sc2M6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJtYW55XCIsXCJvdGhlclwiXX0sc2NuOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wibWFueVwiLFwib3RoZXJcIl19LHNkOmlbMV0sc2RoOmlbMV0sc2U6aVszXSxzZWg6aVsxXSxzZXM6aVswXSxzZzppWzBdLHNoOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sc2hpOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sc2k6aVsxXSxzazp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LHNsOntjYXJkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxzbWE6aVszXSxzbWk6aVszXSxzbWo6aVszXSxzbW46aVszXSxzbXM6aVszXSxzbjppWzFdLHNvOmlbMV0sc3E6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm1hbnlcIixcIm90aGVyXCJdfSxzcjp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LHNzOmlbMV0sc3N5OmlbMV0sc3Q6aVsxXSxzdjppWzJdLHN3OmlbMV0sc3lyOmlbMV0sdGE6aVsxXSx0ZTppWzFdLHRlbzppWzFdLHRoOmlbMF0sdGk6aVsxXSx0aWc6aVsxXSx0azp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcImZld1wiLFwib3RoZXJcIl19LHRsOmlbMl0sdG46aVsxXSx0bzppWzBdLHRyOmlbMV0sdHM6aVsxXSx0em06aVsxXSx1ZzppWzFdLHVrOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJmZXdcIixcIm90aGVyXCJdfSx1cjppWzFdLHV6OmlbMV0sdmU6aVsxXSx2aTp7Y2FyZGluYWw6W1wib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSx2bzppWzFdLHZ1bjppWzFdLHdhOmlbMV0sd2FlOmlbMV0sd286aVswXSx4aDppWzFdLHhvZzppWzFdLHlpOmlbMV0seW86aVswXSx5dWU6aVswXSx6aDppWzBdLHp1OmlbMV19KT9uLmNhbGwocixlLHIsdCk6bil8fCh0LmV4cG9ydHM9byl9LGZ1bmN0aW9uKHQscil7ZnVuY3Rpb24gZSh0LHIsZSl7dmFyIG49e2RheTpcIm51bWVyaWNcIixtb250aDpcInNob3J0XCIseWVhcjpcIm51bWVyaWNcIn07c3dpdGNoKGUpe2Nhc2VcImZ1bGxcIjpuLndlZWtkYXk9XCJsb25nXCI7Y2FzZVwibG9uZ1wiOm4ubW9udGg9XCJsb25nXCI7YnJlYWs7Y2FzZVwic2hvcnRcIjpuLm1vbnRoPVwibnVtZXJpY1wifXJldHVybiBuZXcgRGF0ZSh0KS50b0xvY2FsZURhdGVTdHJpbmcocixuKX10LmV4cG9ydHM9ZnVuY3Rpb24oKXtyZXR1cm4gZX19LGZ1bmN0aW9uKHQscil7ZnVuY3Rpb24gZSh0KXtpZighaXNGaW5pdGUodCkpcmV0dXJuIFN0cmluZyh0KTt2YXIgcj1cIlwiO3Q8MD8ocj1cIi1cIix0PU1hdGguYWJzKHQpKTp0PU51bWJlcih0KTt2YXIgZT10JTYwLG49W01hdGgucm91bmQoZSk9PT1lP2U6ZS50b0ZpeGVkKDMpXTtyZXR1cm4gdDw2MD9uLnVuc2hpZnQoMCk6KHQ9TWF0aC5yb3VuZCgodC1uWzBdKS82MCksbi51bnNoaWZ0KHQlNjApLHQ+PTYwJiYodD1NYXRoLnJvdW5kKCh0LW5bMF0pLzYwKSxuLnVuc2hpZnQodCkpKSxyK24uc2hpZnQoKStcIjpcIituLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gdDwxMD9cIjBcIitTdHJpbmcodCk6U3RyaW5nKHQpfSkuam9pbihcIjpcIil9dC5leHBvcnRzPWZ1bmN0aW9uKCl7cmV0dXJuIGV9fSxmdW5jdGlvbih0LHIpe3QuZXhwb3J0cz1mdW5jdGlvbih0KXt2YXIgcj1mdW5jdGlvbih0LHIsZSl7dmFyIG49ZSYmZS5zcGxpdChcIjpcIil8fFtdLG89e2ludGVnZXI6e21heGltdW1GcmFjdGlvbkRpZ2l0czowfSxwZXJjZW50OntzdHlsZTpcInBlcmNlbnRcIn0sY3VycmVuY3k6e3N0eWxlOlwiY3VycmVuY3lcIixjdXJyZW5jeTpuWzFdJiZuWzFdLnRyaW0oKXx8Q1VSUkVOQ1ksbWluaW11bUZyYWN0aW9uRGlnaXRzOjIsbWF4aW11bUZyYWN0aW9uRGlnaXRzOjJ9fTtyZXR1cm4gbmV3IEludGwuTnVtYmVyRm9ybWF0KHIsb1tuWzBdXXx8e30pLmZvcm1hdCh0KX0udG9TdHJpbmcoKS5yZXBsYWNlKFwiQ1VSUkVOQ1lcIixKU09OLnN0cmluZ2lmeSh0LmN1cnJlbmN5fHxcIlVTRFwiKSkubWF0Y2goL1xcKChbXildKilcXClbXntdKnsoW1xcc1xcU10qKX0vKTtyZXR1cm4gbmV3IEZ1bmN0aW9uKHJbMV0sclsyXSl9fSxmdW5jdGlvbih0LHIpe2Z1bmN0aW9uIGUodCxyLGUpe3ZhciBuPXtzZWNvbmQ6XCJudW1lcmljXCIsbWludXRlOlwibnVtZXJpY1wiLGhvdXI6XCJudW1lcmljXCJ9O3N3aXRjaChlKXtjYXNlXCJmdWxsXCI6Y2FzZVwibG9uZ1wiOm4udGltZVpvbmVOYW1lPVwic2hvcnRcIjticmVhaztjYXNlXCJzaG9ydFwiOmRlbGV0ZSBuLnNlY29uZH1yZXR1cm4gbmV3IERhdGUodCkudG9Mb2NhbGVUaW1lU3RyaW5nKHIsbil9dC5leHBvcnRzPWZ1bmN0aW9uKCl7cmV0dXJuIGV9fSxmdW5jdGlvbih0LHIsZSl7XCJ1c2Ugc3RyaWN0XCI7ZS5yKHIpO3ZhciBuPWUoMSksbz1lLm4obiksaT1lKDIpLHU9e2JyZWFrOiEwLGNvbnRpbnVlOiEwLGRlbGV0ZTohMCxlbHNlOiEwLGZvcjohMCxmdW5jdGlvbjohMCxpZjohMCxpbjohMCxuZXc6ITAscmV0dXJuOiEwLHRoaXM6ITAsdHlwZW9mOiEwLHZhcjohMCx2b2lkOiEwLHdoaWxlOiEwLHdpdGg6ITAsY2FzZTohMCxjYXRjaDohMCxkZWZhdWx0OiEwLGRvOiEwLGZpbmFsbHk6ITAsaW5zdGFuY2VvZjohMCxzd2l0Y2g6ITAsdGhyb3c6ITAsdHJ5OiEwfSxhPXtkZWJ1Z2dlcjohMCxjbGFzczohMCxlbnVtOiEwLGV4dGVuZHM6ITAsc3VwZXI6ITAsY29uc3Q6ITAsZXhwb3J0OiEwLGltcG9ydDohMCxudWxsOiEwLHRydWU6ITAsZmFsc2U6ITAsaW1wbGVtZW50czohMCxsZXQ6ITAscHJpdmF0ZTohMCxwdWJsaWM6ITAseWllbGQ6ITAsaW50ZXJmYWNlOiEwLHBhY2thZ2U6ITAscHJvdGVjdGVkOiEwLHN0YXRpYzohMH07ZnVuY3Rpb24gYyh0LHIpe2lmKC9eW0EtWl8kXVswLTlBLVpfJF0qJC9pLnRlc3QodCkmJiF1W3RdKXJldHVybiByP1wiXCIuY29uY2F0KHIsXCIuXCIpLmNvbmNhdCh0KTp0O3ZhciBlPUpTT04uc3RyaW5naWZ5KHQpO3JldHVybiByP3IrXCJbXCIuY29uY2F0KGUsXCJdXCIpOmV9ZnVuY3Rpb24gaCh0KXt2YXIgcj10LnRyaW0oKS5yZXBsYWNlKC9cXFcrL2csXCJfXCIpO3JldHVybiB1W3JdfHxhW3JdfHwvXlxcZC8udGVzdChyKT9cIl9cIityOnJ9dmFyIGY9bmV3IFJlZ0V4cChcIl5cIitbXCJhclwiLFwiY2tiXCIsXCJmYVwiLFwiaGVcIixcImtzKCR8W15iZmhdKVwiLFwibHJjXCIsXCJtem5cIixcInBhLUFyYWJcIixcInBzXCIsXCJ1Z1wiLFwidXJcIixcInV6LUFyYWJcIixcInlpXCJdLmpvaW4oXCJ8XlwiKSk7ZnVuY3Rpb24gcyh0KXtyZXR1cm4ocz1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZ0LmNvbnN0cnVjdG9yPT09U3ltYm9sJiZ0IT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fSkodCl9ZnVuY3Rpb24gbCh0LHIpe2Zvcih2YXIgZT0wO2U8ci5sZW5ndGg7ZSsrKXt2YXIgbj1yW2VdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19dmFyIHA9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHIpeyFmdW5jdGlvbih0LHIpe2lmKCEodCBpbnN0YW5jZW9mIHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9KHRoaXMsdCksdGhpcy5tZj1yLHRoaXMubGM9bnVsbCx0aGlzLmxvY2FsZXM9e30sdGhpcy5ydW50aW1lPXt9LHRoaXMuZm9ybWF0dGVycz17fX12YXIgcixlLG47cmV0dXJuIHI9dCwoZT1be2tleTpcImNvbXBpbGVcIix2YWx1ZTpmdW5jdGlvbih0LHIsZSl7dmFyIG49dGhpcztpZihcIm9iamVjdFwiIT1zKHQpKXt0aGlzLmxjPXI7dmFyIG89ZVtyXXx8e2NhcmRpbmFsOltdLG9yZGluYWw6W119O28uc3RyaWN0PSEhdGhpcy5tZi5vcHRpb25zLnN0cmljdE51bWJlclNpZ247dmFyIHU9T2JqZWN0KGkucGFyc2UpKHQsbykubWFwKGZ1bmN0aW9uKHQpe3JldHVybiBuLnRva2VuKHQpfSk7cmV0dXJuXCJmdW5jdGlvbihkKSB7IHJldHVybiBcIi5jb25jYXQodS5qb2luKFwiICsgXCIpfHwnXCJcIicsXCI7IH1cIil9dmFyIGE9e307Zm9yKHZhciBjIGluIHQpe3ZhciBoPWUuaGFzT3duUHJvcGVydHkoYyk/YzpyO2FbY109dGhpcy5jb21waWxlKHRbY10saCxlKX1yZXR1cm4gYX19LHtrZXk6XCJjYXNlc1wiLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGU9dGhpcyxuPVwic2VsZWN0XCI9PT10LnR5cGV8fCF0aGlzLm1mLmhhc0N1c3RvbVBsdXJhbEZ1bmNzLG89dC5jYXNlcy5tYXAoZnVuY3Rpb24odCl7dmFyIG89dC5rZXksaT10LnRva2VucztcIm90aGVyXCI9PT1vJiYobj0hMSk7dmFyIHU9aS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIGUudG9rZW4odCxyKX0pO3JldHVybiBjKG8pK1wiOiBcIisodS5qb2luKFwiICsgXCIpfHwnXCJcIicpfSk7aWYobil0aHJvdyBuZXcgRXJyb3IoXCJObyAnb3RoZXInIGZvcm0gZm91bmQgaW4gXCIrSlNPTi5zdHJpbmdpZnkodCkpO3JldHVyblwieyBcIi5jb25jYXQoby5qb2luKFwiLCBcIiksXCIgfVwiKX19LHtrZXk6XCJ0b2tlblwiLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGUsbj10aGlzO2lmKFwic3RyaW5nXCI9PXR5cGVvZiB0KXJldHVybiBKU09OLnN0cmluZ2lmeSh0KTt2YXIgbyxpLHUsYSxzPVtjKHQuYXJnLFwiZFwiKV07c3dpdGNoKHQudHlwZSl7Y2FzZVwiYXJndW1lbnRcIjpyZXR1cm4gdGhpcy5tZi5vcHRpb25zLmJpRGlTdXBwb3J0PyhvPXNbMF0saT10aGlzLmxjLHU9Zi50ZXN0KGkpLGE9SlNPTi5zdHJpbmdpZnkodT9cIuKAj1wiOlwi4oCOXCIpLFwiXCIuY29uY2F0KGEsXCIgKyBcIikuY29uY2F0KG8sXCIgKyBcIikuY29uY2F0KGEpKTpzWzBdO2Nhc2VcInNlbGVjdFwiOmU9XCJzZWxlY3RcIixyJiZ0aGlzLm1mLm9wdGlvbnMuc3RyaWN0TnVtYmVyU2lnbiYmKHI9bnVsbCkscy5wdXNoKHRoaXMuY2FzZXModCxyKSksdGhpcy5ydW50aW1lLnNlbGVjdD0hMDticmVhaztjYXNlXCJzZWxlY3RvcmRpbmFsXCI6ZT1cInBsdXJhbFwiLHMucHVzaCgwLGgodGhpcy5sYyksdGhpcy5jYXNlcyh0LHQpLDEpLHRoaXMubG9jYWxlc1t0aGlzLmxjXT0hMCx0aGlzLnJ1bnRpbWUucGx1cmFsPSEwO2JyZWFrO2Nhc2VcInBsdXJhbFwiOmU9XCJwbHVyYWxcIixzLnB1c2godC5vZmZzZXR8fDAsaCh0aGlzLmxjKSx0aGlzLmNhc2VzKHQsdCkpLHRoaXMubG9jYWxlc1t0aGlzLmxjXT0hMCx0aGlzLnJ1bnRpbWUucGx1cmFsPSEwO2JyZWFrO2Nhc2VcImZ1bmN0aW9uXCI6aWYoISh0LmtleSBpbiB0aGlzLm1mLmZtdCkmJnQua2V5IGluIHRoaXMubWYuY29uc3RydWN0b3IuZm9ybWF0dGVycyl7dmFyIGw9dGhpcy5tZi5jb25zdHJ1Y3Rvci5mb3JtYXR0ZXJzW3Qua2V5XTt0aGlzLm1mLmZtdFt0LmtleV09bCh0aGlzLm1mKX1pZighdGhpcy5tZi5mbXRbdC5rZXldKXRocm93IG5ldyBFcnJvcihcIkZvcm1hdHRpbmcgZnVuY3Rpb24gXCIuY29uY2F0KEpTT04uc3RyaW5naWZ5KHQua2V5KSxcIiBub3QgZm91bmQhXCIpKTtpZihzLnB1c2goSlNPTi5zdHJpbmdpZnkodGhpcy5sYykpLHQucGFyYW0pe3ImJnRoaXMubWYub3B0aW9ucy5zdHJpY3ROdW1iZXJTaWduJiYocj1udWxsKTt2YXIgcD10LnBhcmFtLnRva2Vucy5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIG4udG9rZW4odCxyKX0pO3MucHVzaChcIihcIisocC5qb2luKFwiICsgXCIpfHwnXCJcIicpK1wiKS50cmltKClcIil9ZT1jKHQua2V5LFwiZm10XCIpLHRoaXMuZm9ybWF0dGVyc1t0LmtleV09ITA7YnJlYWs7Y2FzZVwib2N0b3Rob3JwZVwiOmlmKCFyKXJldHVybidcIiNcIic7ZT1cIm51bWJlclwiLHM9W2Moci5hcmcsXCJkXCIpLEpTT04uc3RyaW5naWZ5KHIuYXJnKV0sci5vZmZzZXQmJnMucHVzaChyLm9mZnNldCksdGhpcy5ydW50aW1lLm51bWJlcj0hMH1pZighZSl0aHJvdyBuZXcgRXJyb3IoXCJQYXJzZXIgZXJyb3IgZm9yIHRva2VuIFwiK0pTT04uc3RyaW5naWZ5KHQpKTtyZXR1cm5cIlwiLmNvbmNhdChlLFwiKFwiKS5jb25jYXQocy5qb2luKFwiLCBcIiksXCIpXCIpfX1dKSYmbChyLnByb3RvdHlwZSxlKSxuJiZsKHIsbiksdH0oKSxtPWUoMyksZD1lLm4obSkseT1lKDApLGc9ZS5uKHkpO2Z1bmN0aW9uIHYodCxyLGUpe3ZhciBuPWZ1bmN0aW9uKCl7cmV0dXJuIHIuYXBwbHkodGhpcyxhcmd1bWVudHMpfTtpZihuLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIHIudG9TdHJpbmcoKX0sZSl7dmFyIG89ZC5hW3RdfHx7fTtuLmNhcmRpbmFsPW8uY2FyZGluYWwsbi5vcmRpbmFsPW8ub3JkaW5hbH1lbHNlIG4uY2FyZGluYWw9W10sbi5vcmRpbmFsPVtdO3JldHVybiBufWZ1bmN0aW9uIHcodCxyKXtmb3IodmFyIGU9ci5wbHVyYWxLZXlDaGVja3Msbj1TdHJpbmcodCk7bjtuPW4ucmVwbGFjZSgvWy1fXT9bXi1fXSokLyxcIlwiKSl7dmFyIG89Zy5hW25dO2lmKG8pcmV0dXJuIHYobixvLGUpfXRocm93IG5ldyBFcnJvcihcIkxvY2FsaXNhdGlvbiBmdW5jdGlvbiBub3QgZm91bmQgZm9yIGxvY2FsZSBcIitKU09OLnN0cmluZ2lmeSh0KSl9ZnVuY3Rpb24gYih0KXtyZXR1cm4oYj1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZ0LmNvbnN0cnVjdG9yPT09U3ltYm9sJiZ0IT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fSkodCl9ZnVuY3Rpb24gUyh0LHIpe2Zvcih2YXIgZT0wO2U8ci5sZW5ndGg7ZSsrKXt2YXIgbj1yW2VdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19dmFyIGs9ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHIpeyFmdW5jdGlvbih0LHIpe2lmKCEodCBpbnN0YW5jZW9mIHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9KHRoaXMsdCksdGhpcy5wbHVyYWw9ZnVuY3Rpb24odCxyLGUsbixvKXtpZih7fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG4sdCkpcmV0dXJuIG5bdF07ciYmKHQtPXIpO3ZhciBpPWUodCxvKTtyZXR1cm4gaSBpbiBuP25baV06bi5vdGhlcn0sdGhpcy5zZWxlY3Q9ZnVuY3Rpb24odCxyKXtyZXR1cm57fS5oYXNPd25Qcm9wZXJ0eS5jYWxsKHIsdCk/clt0XTpyLm90aGVyfSx0aGlzLm1mPXIsdGhpcy5zZXRTdHJpY3ROdW1iZXIoci5vcHRpb25zLnN0cmljdE51bWJlclNpZ24pfXZhciByLGUsbjtyZXR1cm4gcj10LChlPVt7a2V5Olwic2V0U3RyaWN0TnVtYmVyXCIsdmFsdWU6ZnVuY3Rpb24ocil7dGhpcy5udW1iZXI9cj90LnN0cmljdE51bWJlcjp0LmRlZmF1bHROdW1iZXJ9fSx7a2V5OlwidG9TdHJpbmdcIix2YWx1ZTpmdW5jdGlvbih0LHIpe2Zvcih2YXIgZT17fSxuPU9iamVjdC5rZXlzKHIubG9jYWxlcyksbz0wO288bi5sZW5ndGg7KytvKXt2YXIgaT1uW29dO2VbaChpKV09dFtpXX1mb3IodmFyIHU9T2JqZWN0LmtleXMoci5ydW50aW1lKSxhPTA7YTx1Lmxlbmd0aDsrK2Epe3ZhciBmPXVbYV07ZVtmXT10aGlzW2ZdfXZhciBzPU9iamVjdC5rZXlzKHIuZm9ybWF0dGVycyk7aWYocy5sZW5ndGg+MCl7ZS5mbXQ9e307Zm9yKHZhciBsPTA7bDxzLmxlbmd0aDsrK2wpe3ZhciBwPXNbbF07ZS5mbXRbcF09dGhpcy5tZi5mbXRbcF19fXJldHVybiBmdW5jdGlvbiB0KHIsZSl7aWYoXCJvYmplY3RcIiE9YihyKSl7dmFyIG49ci50b1N0cmluZygpLnJlcGxhY2UoL14oZnVuY3Rpb24gKVxcdyovLFwiJDFcIiksbz0vKFsgXFx0XSopXFxTLiokLy5leGVjKG4pO3JldHVybiBvP24ucmVwbGFjZShuZXcgUmVnRXhwKFwiXlwiK29bMV0sXCJtZ1wiKSxcIlwiKTpufXZhciBpPVtdO2Zvcih2YXIgdSBpbiByKXt2YXIgYT10KHJbdV0sZSsxKTtpLnB1c2goMD09PWU/XCJ2YXIgXCIuY29uY2F0KHUsXCIgPSBcIikuY29uY2F0KGEsXCI7XFxuXCIpOlwiXCIuY29uY2F0KGModSksXCI6IFwiKS5jb25jYXQoYSkpfWlmKDA9PT1lKXJldHVybiBpLmpvaW4oXCJcIik7aWYoMD09PWkubGVuZ3RoKXJldHVyblwie31cIjtmb3IodmFyIGg9XCIgIFwiOy0tZTspaCs9XCIgIFwiO3ZhciBmPWkuam9pbihcIixcXG5cIikucmVwbGFjZSgvXi9nbSxoKTtyZXR1cm5cIntcXG5cIi5jb25jYXQoZixcIlxcbn1cIil9KGUsMCl9fV0pJiZTKHIucHJvdG90eXBlLGUpLG4mJlMocixuKSx0fSgpO2Z1bmN0aW9uIHgodCl7cmV0dXJuKHg9XCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZcInN5bWJvbFwiPT10eXBlb2YgU3ltYm9sLml0ZXJhdG9yP2Z1bmN0aW9uKHQpe3JldHVybiB0eXBlb2YgdH06ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmdC5jb25zdHJ1Y3Rvcj09PVN5bWJvbCYmdCE9PVN5bWJvbC5wcm90b3R5cGU/XCJzeW1ib2xcIjp0eXBlb2YgdH0pKHQpfWZ1bmN0aW9uIEEodCxyKXtmb3IodmFyIGU9MDtlPHIubGVuZ3RoO2UrKyl7dmFyIG49cltlXTtuLmVudW1lcmFibGU9bi5lbnVtZXJhYmxlfHwhMSxuLmNvbmZpZ3VyYWJsZT0hMCxcInZhbHVlXCJpbiBuJiYobi53cml0YWJsZT0hMCksT2JqZWN0LmRlZmluZVByb3BlcnR5KHQsbi5rZXksbil9fWZ1bmN0aW9uIGoodCxyLGUpe3JldHVybiByJiZBKHQucHJvdG90eXBlLHIpLGUmJkEodCxlKSx0fWsuZGVmYXVsdE51bWJlcj1mdW5jdGlvbih0LHIsZSl7aWYoIWUpcmV0dXJuIHQ7aWYoaXNOYU4odCkpdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3QgYXBwbHkgb2Zmc2V0OlwiK2UrXCIgdG8gYXJndW1lbnQgYFwiK3IrXCJgIHdpdGggbm9uLW51bWVyaWNhbCB2YWx1ZSBcIitKU09OLnN0cmluZ2lmeSh0KStcIi5cIik7cmV0dXJuIHQtZX0say5zdHJpY3ROdW1iZXI9ZnVuY3Rpb24odCxyLGUpe2lmKGlzTmFOKHQpKXRocm93IG5ldyBFcnJvcihcIkFyZ3VtZW50IGBcIityK1wiYCBoYXMgbm9uLW51bWVyaWNhbCB2YWx1ZSBcIitKU09OLnN0cmluZ2lmeSh0KStcIi5cIik7cmV0dXJuIHQtKGV8fDApfSxlLmQocixcImRlZmF1bHRcIixmdW5jdGlvbigpe3JldHVybiBOfSk7dmFyIE49ZnVuY3Rpb24oKXtmdW5jdGlvbiB0KHIsZSl7dmFyIG49dGhpcztpZihmdW5jdGlvbih0LHIpe2lmKCEodCBpbnN0YW5jZW9mIHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIil9KHRoaXMsdCksdGhpcy5vcHRpb25zPU9iamVjdC5hc3NpZ24oe2JpRGlTdXBwb3J0OiExLGN1c3RvbUZvcm1hdHRlcnM6bnVsbCxwbHVyYWxLZXlDaGVja3M6ITAsc3RyaWN0TnVtYmVyU2lnbjohMX0sZSksdGhpcy5wbHVyYWxGdW5jcz17fSxcInN0cmluZ1wiPT10eXBlb2Ygcil0aGlzLnBsdXJhbEZ1bmNzW3JdPXcocix0aGlzLm9wdGlvbnMpLHRoaXMuZGVmYXVsdExvY2FsZT1yO2Vsc2UgaWYoQXJyYXkuaXNBcnJheShyKSlyLmZvckVhY2goZnVuY3Rpb24odCl7bi5wbHVyYWxGdW5jc1t0XT13KHQsbi5vcHRpb25zKX0pLHRoaXMuZGVmYXVsdExvY2FsZT1yWzBdO2Vsc2V7aWYocilmb3IodmFyIG89T2JqZWN0LmtleXMociksaT0wO2k8by5sZW5ndGg7KytpKXt2YXIgdT1vW2ldO2lmKFwiZnVuY3Rpb25cIiE9dHlwZW9mIHJbdV0pe3ZhciBhPVwiRXhwZWN0ZWQgZnVuY3Rpb24gdmFsdWUgZm9yIGxvY2FsZSBcIitTdHJpbmcodSk7dGhyb3cgbmV3IEVycm9yKGEpfXRoaXMucGx1cmFsRnVuY3NbdV09clt1XSx0aGlzLmRlZmF1bHRMb2NhbGV8fCh0aGlzLmRlZmF1bHRMb2NhbGU9dSl9dGhpcy5kZWZhdWx0TG9jYWxlP3RoaXMuaGFzQ3VzdG9tUGx1cmFsRnVuY3M9ITA6KHRoaXMuZGVmYXVsdExvY2FsZT10LmRlZmF1bHRMb2NhbGUsdGhpcy5oYXNDdXN0b21QbHVyYWxGdW5jcz0hMSl9dGhpcy5mbXQ9T2JqZWN0LmFzc2lnbih7fSx0aGlzLm9wdGlvbnMuY3VzdG9tRm9ybWF0dGVycyksdGhpcy5ydW50aW1lPW5ldyBrKHRoaXMpfXJldHVybiBqKHQsbnVsbCxbe2tleTpcImVzY2FwZVwiLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGU9cj8vWyN7fV0vZzovW3t9XS9nO3JldHVybiBTdHJpbmcodCkucmVwbGFjZShlLFwiJyQmJ1wiKX19XSksaih0LFt7a2V5OlwiYWRkRm9ybWF0dGVyc1wiLHZhbHVlOmZ1bmN0aW9uKHQpe2Zvcih2YXIgcj1PYmplY3Qua2V5cyh0KSxlPTA7ZTxyLmxlbmd0aDsrK2Upe3ZhciBuPXJbZV07dGhpcy5mbXRbbl09dFtuXX1yZXR1cm4gdGhpc319LHtrZXk6XCJkaXNhYmxlUGx1cmFsS2V5Q2hlY2tzXCIsdmFsdWU6ZnVuY3Rpb24oKXtmb3IodmFyIHQgaW4gdGhpcy5vcHRpb25zLnBsdXJhbEtleUNoZWNrcz0hMSx0aGlzLnBsdXJhbEZ1bmNzKXt2YXIgcj10aGlzLnBsdXJhbEZ1bmNzW3RdO3ImJihyLmNhcmRpbmFsPVtdLHIub3JkaW5hbD1bXSl9cmV0dXJuIHRoaXN9fSx7a2V5Olwic2V0QmlEaVN1cHBvcnRcIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vcHRpb25zLmJpRGlTdXBwb3J0PSEhdHx8dm9pZCAwPT09dCx0aGlzfX0se2tleTpcInNldFN0cmljdE51bWJlclNpZ25cIix2YWx1ZTpmdW5jdGlvbih0KXtyZXR1cm4gdGhpcy5vcHRpb25zLnN0cmljdE51bWJlclNpZ249ISF0fHx2b2lkIDA9PT10LHRoaXMucnVudGltZS5zZXRTdHJpY3ROdW1iZXIodGhpcy5vcHRpb25zLnN0cmljdE51bWJlclNpZ24pLHRoaXN9fSx7a2V5OlwiY29tcGlsZVwiLHZhbHVlOmZ1bmN0aW9uKHQscil7dmFyIGU9e307aWYoMD09PU9iamVjdC5rZXlzKHRoaXMucGx1cmFsRnVuY3MpLmxlbmd0aClpZihyKXt2YXIgbj13KHIsdGhpcy5vcHRpb25zKTtpZighbil7dmFyIG89SlNPTi5zdHJpbmdpZnkocik7dGhyb3cgbmV3IEVycm9yKFwiTG9jYWxlIFwiLmNvbmNhdChvLFwiIG5vdCBmb3VuZCFcIikpfWVbcl09bn1lbHNlIHI9dGhpcy5kZWZhdWx0TG9jYWxlLGU9ZnVuY3Rpb24odCl7Zm9yKHZhciByPXQucGx1cmFsS2V5Q2hlY2tzLGU9e30sbj1PYmplY3Qua2V5cyhnLmEpLG89MDtvPG4ubGVuZ3RoOysrbyl7dmFyIGk9bltvXTtlW2ldPXYoaSxnLmFbaV0scil9cmV0dXJuIGV9KHRoaXMub3B0aW9ucyk7ZWxzZSBpZihyKXt2YXIgaT10aGlzLnBsdXJhbEZ1bmNzW3JdO2lmKCFpKXt2YXIgdT1KU09OLnN0cmluZ2lmeShyKSxhPUpTT04uc3RyaW5naWZ5KHRoaXMucGx1cmFsRnVuY3MpO3Rocm93IG5ldyBFcnJvcihcIkxvY2FsZSBcIi5jb25jYXQodSxcIiBub3QgZm91bmQgaW4gXCIpLmNvbmNhdChhLFwiIVwiKSl9ZVtyXT1pfWVsc2Ugcj10aGlzLmRlZmF1bHRMb2NhbGUsZT10aGlzLnBsdXJhbEZ1bmNzO3ZhciBmPW5ldyBwKHRoaXMpLHM9Zi5jb21waWxlKHQscixlKTtpZihcIm9iamVjdFwiIT14KHQpKXt2YXIgbD1uZXcgRnVuY3Rpb24oXCJudW1iZXIsIHBsdXJhbCwgc2VsZWN0LCBmbXRcIixoKHIpLFwicmV0dXJuIFwiK3MpLG09dGhpcy5ydW50aW1lO3JldHVybiBsKG0ubnVtYmVyLG0ucGx1cmFsLG0uc2VsZWN0LHRoaXMuZm10LGVbcl0pfXZhciBkPXRoaXMucnVudGltZS50b1N0cmluZyhlLGYpK1wiXFxuXCIseT1mdW5jdGlvbiB0KHIsZSl7aWYoZXx8KGU9MCksXCJvYmplY3RcIiE9eChyKSlyZXR1cm4gcjtmb3IodmFyIG49XCJcIixvPTA7bzxlOysrbyluKz1cIiAgXCI7dmFyIGk9W107Zm9yKHZhciB1IGluIHIpe3ZhciBhPXQoclt1XSxlKzEpO2kucHVzaChcIlxcblwiLmNvbmNhdChuLFwiICBcIikuY29uY2F0KGModSksXCI6IFwiKS5jb25jYXQoYSkpfXJldHVyblwie1wiLmNvbmNhdChpLmpvaW4oXCIsXCIpLFwiXFxuXCIpLmNvbmNhdChuLFwifVwiKX0ocyksYj1uZXcgRnVuY3Rpb24oZCtcInJldHVybiBcIit5KSgpO2lmKGIuaGFzT3duUHJvcGVydHkoXCJ0b1N0cmluZ1wiKSl0aHJvdyBuZXcgRXJyb3IoXCJUaGUgdG9wLWxldmVsIG1lc3NhZ2Uga2V5IGB0b1N0cmluZ2AgaXMgcmVzZXJ2ZWRcIik7cmV0dXJuIGIudG9TdHJpbmc9ZnVuY3Rpb24odCl7cmV0dXJuIHQmJlwiZXhwb3J0IGRlZmF1bHRcIiE9PXQ/dC5pbmRleE9mKFwiLlwiKT4tMT9kK3QrXCIgPSBcIit5OmQrW1wiKGZ1bmN0aW9uIChyb290LCBHKSB7XCIsJyAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7IGRlZmluZShHKTsgfScsJyAgZWxzZSBpZiAodHlwZW9mIGV4cG9ydHMgPT09IFwib2JqZWN0XCIpIHsgbW9kdWxlLmV4cG9ydHMgPSBHOyB9JyxcIiAgZWxzZSB7IFwiK2ModCxcInJvb3RcIikrXCIgPSBHOyB9XCIsXCJ9KSh0aGlzLCBcIit5K1wiKTtcIl0uam9pbihcIlxcblwiKTpkK1wiZXhwb3J0IGRlZmF1bHQgXCIreX0sYn19XSksdH0oKTtOLmRlZmF1bHRMb2NhbGU9XCJlblwiLE4uZm9ybWF0dGVycz1vLmF9XSkuZGVmYXVsdH0pO1xuLy8jIHNvdXJjZU1hcHBpbmdVUkw9bWVzc2FnZWZvcm1hdC5qcy5tYXAiLCIvLyBzaGltIGZvciB1c2luZyBwcm9jZXNzIGluIGJyb3dzZXJcbnZhciBwcm9jZXNzID0gbW9kdWxlLmV4cG9ydHMgPSB7fTtcblxuLy8gY2FjaGVkIGZyb20gd2hhdGV2ZXIgZ2xvYmFsIGlzIHByZXNlbnQgc28gdGhhdCB0ZXN0IHJ1bm5lcnMgdGhhdCBzdHViIGl0XG4vLyBkb24ndCBicmVhayB0aGluZ3MuICBCdXQgd2UgbmVlZCB0byB3cmFwIGl0IGluIGEgdHJ5IGNhdGNoIGluIGNhc2UgaXQgaXNcbi8vIHdyYXBwZWQgaW4gc3RyaWN0IG1vZGUgY29kZSB3aGljaCBkb2Vzbid0IGRlZmluZSBhbnkgZ2xvYmFscy4gIEl0J3MgaW5zaWRlIGFcbi8vIGZ1bmN0aW9uIGJlY2F1c2UgdHJ5L2NhdGNoZXMgZGVvcHRpbWl6ZSBpbiBjZXJ0YWluIGVuZ2luZXMuXG5cbnZhciBjYWNoZWRTZXRUaW1lb3V0O1xudmFyIGNhY2hlZENsZWFyVGltZW91dDtcblxuZnVuY3Rpb24gZGVmYXVsdFNldFRpbW91dCgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbmZ1bmN0aW9uIGRlZmF1bHRDbGVhclRpbWVvdXQgKCkge1xuICAgIHRocm93IG5ldyBFcnJvcignY2xlYXJUaW1lb3V0IGhhcyBub3QgYmVlbiBkZWZpbmVkJyk7XG59XG4oZnVuY3Rpb24gKCkge1xuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc2V0VGltZW91dCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgY2FjaGVkU2V0VGltZW91dCA9IGRlZmF1bHRTZXRUaW1vdXQ7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIGlmICh0eXBlb2YgY2xlYXJUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBjbGVhclRpbWVvdXQ7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRDbGVhclRpbWVvdXQgPSBkZWZhdWx0Q2xlYXJUaW1lb3V0O1xuICAgIH1cbn0gKCkpXG5mdW5jdGlvbiBydW5UaW1lb3V0KGZ1bikge1xuICAgIGlmIChjYWNoZWRTZXRUaW1lb3V0ID09PSBzZXRUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICAvLyBpZiBzZXRUaW1lb3V0IHdhc24ndCBhdmFpbGFibGUgYnV0IHdhcyBsYXR0ZXIgZGVmaW5lZFxuICAgIGlmICgoY2FjaGVkU2V0VGltZW91dCA9PT0gZGVmYXVsdFNldFRpbW91dCB8fCAhY2FjaGVkU2V0VGltZW91dCkgJiYgc2V0VGltZW91dCkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgcmV0dXJuIHNldFRpbWVvdXQoZnVuLCAwKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gd2hlbiB3aGVuIHNvbWVib2R5IGhhcyBzY3Jld2VkIHdpdGggc2V0VGltZW91dCBidXQgbm8gSS5FLiBtYWRkbmVzc1xuICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dChmdW4sIDApO1xuICAgIH0gY2F0Y2goZSl7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICAvLyBXaGVuIHdlIGFyZSBpbiBJLkUuIGJ1dCB0aGUgc2NyaXB0IGhhcyBiZWVuIGV2YWxlZCBzbyBJLkUuIGRvZXNuJ3QgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwobnVsbCwgZnVuLCAwKTtcbiAgICAgICAgfSBjYXRjaChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yXG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkU2V0VGltZW91dC5jYWxsKHRoaXMsIGZ1biwgMCk7XG4gICAgICAgIH1cbiAgICB9XG5cblxufVxuZnVuY3Rpb24gcnVuQ2xlYXJUaW1lb3V0KG1hcmtlcikge1xuICAgIGlmIChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGNsZWFyVGltZW91dCkge1xuICAgICAgICAvL25vcm1hbCBlbnZpcm9tZW50cyBpbiBzYW5lIHNpdHVhdGlvbnNcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICAvLyBpZiBjbGVhclRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRDbGVhclRpbWVvdXQgPT09IGRlZmF1bHRDbGVhclRpbWVvdXQgfHwgIWNhY2hlZENsZWFyVGltZW91dCkgJiYgY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgcmV0dXJuIGNsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQobWFya2VyKTtcbiAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCAgdHJ1c3QgdGhlIGdsb2JhbCBvYmplY3Qgd2hlbiBjYWxsZWQgbm9ybWFsbHlcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRDbGVhclRpbWVvdXQuY2FsbChudWxsLCBtYXJrZXIpO1xuICAgICAgICB9IGNhdGNoIChlKXtcbiAgICAgICAgICAgIC8vIHNhbWUgYXMgYWJvdmUgYnV0IHdoZW4gaXQncyBhIHZlcnNpb24gb2YgSS5FLiB0aGF0IG11c3QgaGF2ZSB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgJ3RoaXMnLCBob3BmdWxseSBvdXIgY29udGV4dCBjb3JyZWN0IG90aGVyd2lzZSBpdCB3aWxsIHRocm93IGEgZ2xvYmFsIGVycm9yLlxuICAgICAgICAgICAgLy8gU29tZSB2ZXJzaW9ucyBvZiBJLkUuIGhhdmUgZGlmZmVyZW50IHJ1bGVzIGZvciBjbGVhclRpbWVvdXQgdnMgc2V0VGltZW91dFxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKHRoaXMsIG1hcmtlcik7XG4gICAgICAgIH1cbiAgICB9XG5cblxuXG59XG52YXIgcXVldWUgPSBbXTtcbnZhciBkcmFpbmluZyA9IGZhbHNlO1xudmFyIGN1cnJlbnRRdWV1ZTtcbnZhciBxdWV1ZUluZGV4ID0gLTE7XG5cbmZ1bmN0aW9uIGNsZWFuVXBOZXh0VGljaygpIHtcbiAgICBpZiAoIWRyYWluaW5nIHx8ICFjdXJyZW50UXVldWUpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIGlmIChjdXJyZW50UXVldWUubGVuZ3RoKSB7XG4gICAgICAgIHF1ZXVlID0gY3VycmVudFF1ZXVlLmNvbmNhdChxdWV1ZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgIH1cbiAgICBpZiAocXVldWUubGVuZ3RoKSB7XG4gICAgICAgIGRyYWluUXVldWUoKTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIGRyYWluUXVldWUoKSB7XG4gICAgaWYgKGRyYWluaW5nKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdmFyIHRpbWVvdXQgPSBydW5UaW1lb3V0KGNsZWFuVXBOZXh0VGljayk7XG4gICAgZHJhaW5pbmcgPSB0cnVlO1xuXG4gICAgdmFyIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB3aGlsZShsZW4pIHtcbiAgICAgICAgY3VycmVudFF1ZXVlID0gcXVldWU7XG4gICAgICAgIHF1ZXVlID0gW107XG4gICAgICAgIHdoaWxlICgrK3F1ZXVlSW5kZXggPCBsZW4pIHtcbiAgICAgICAgICAgIGlmIChjdXJyZW50UXVldWUpIHtcbiAgICAgICAgICAgICAgICBjdXJyZW50UXVldWVbcXVldWVJbmRleF0ucnVuKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcXVldWVJbmRleCA9IC0xO1xuICAgICAgICBsZW4gPSBxdWV1ZS5sZW5ndGg7XG4gICAgfVxuICAgIGN1cnJlbnRRdWV1ZSA9IG51bGw7XG4gICAgZHJhaW5pbmcgPSBmYWxzZTtcbiAgICBydW5DbGVhclRpbWVvdXQodGltZW91dCk7XG59XG5cbnByb2Nlc3MubmV4dFRpY2sgPSBmdW5jdGlvbiAoZnVuKSB7XG4gICAgdmFyIGFyZ3MgPSBuZXcgQXJyYXkoYXJndW1lbnRzLmxlbmd0aCAtIDEpO1xuICAgIGlmIChhcmd1bWVudHMubGVuZ3RoID4gMSkge1xuICAgICAgICBmb3IgKHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgYXJnc1tpIC0gMV0gPSBhcmd1bWVudHNbaV07XG4gICAgICAgIH1cbiAgICB9XG4gICAgcXVldWUucHVzaChuZXcgSXRlbShmdW4sIGFyZ3MpKTtcbiAgICBpZiAocXVldWUubGVuZ3RoID09PSAxICYmICFkcmFpbmluZykge1xuICAgICAgICBydW5UaW1lb3V0KGRyYWluUXVldWUpO1xuICAgIH1cbn07XG5cbi8vIHY4IGxpa2VzIHByZWRpY3RpYmxlIG9iamVjdHNcbmZ1bmN0aW9uIEl0ZW0oZnVuLCBhcnJheSkge1xuICAgIHRoaXMuZnVuID0gZnVuO1xuICAgIHRoaXMuYXJyYXkgPSBhcnJheTtcbn1cbkl0ZW0ucHJvdG90eXBlLnJ1biA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmZ1bi5hcHBseShudWxsLCB0aGlzLmFycmF5KTtcbn07XG5wcm9jZXNzLnRpdGxlID0gJ2Jyb3dzZXInO1xucHJvY2Vzcy5icm93c2VyID0gdHJ1ZTtcbnByb2Nlc3MuZW52ID0ge307XG5wcm9jZXNzLmFyZ3YgPSBbXTtcbnByb2Nlc3MudmVyc2lvbiA9ICcnOyAvLyBlbXB0eSBzdHJpbmcgdG8gYXZvaWQgcmVnZXhwIGlzc3Vlc1xucHJvY2Vzcy52ZXJzaW9ucyA9IHt9O1xuXG5mdW5jdGlvbiBub29wKCkge31cblxucHJvY2Vzcy5vbiA9IG5vb3A7XG5wcm9jZXNzLmFkZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3Mub25jZSA9IG5vb3A7XG5wcm9jZXNzLm9mZiA9IG5vb3A7XG5wcm9jZXNzLnJlbW92ZUxpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlQWxsTGlzdGVuZXJzID0gbm9vcDtcbnByb2Nlc3MuZW1pdCA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRMaXN0ZW5lciA9IG5vb3A7XG5wcm9jZXNzLnByZXBlbmRPbmNlTGlzdGVuZXIgPSBub29wO1xuXG5wcm9jZXNzLmxpc3RlbmVycyA9IGZ1bmN0aW9uIChuYW1lKSB7IHJldHVybiBbXSB9XG5cbnByb2Nlc3MuYmluZGluZyA9IGZ1bmN0aW9uIChuYW1lKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmJpbmRpbmcgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcblxucHJvY2Vzcy5jd2QgPSBmdW5jdGlvbiAoKSB7IHJldHVybiAnLycgfTtcbnByb2Nlc3MuY2hkaXIgPSBmdW5jdGlvbiAoZGlyKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdwcm9jZXNzLmNoZGlyIGlzIG5vdCBzdXBwb3J0ZWQnKTtcbn07XG5wcm9jZXNzLnVtYXNrID0gZnVuY3Rpb24oKSB7IHJldHVybiAwOyB9O1xuIiwiLyohXG4gKiBRVW5pdCAyLjExLjNcbiAqIGh0dHBzOi8vcXVuaXRqcy5jb20vXG4gKlxuICogQ29weXJpZ2h0IE9wZW5KUyBGb3VuZGF0aW9uIGFuZCBvdGhlciBjb250cmlidXRvcnNcbiAqIFJlbGVhc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZVxuICogaHR0cHM6Ly9qcXVlcnkub3JnL2xpY2Vuc2VcbiAqXG4gKiBEYXRlOiAyMDIwLTEwLTA1VDAxOjM0WlxuICovXG4oZnVuY3Rpb24gKGdsb2JhbCQxKSB7XG5cdCd1c2Ugc3RyaWN0JztcblxuXHRmdW5jdGlvbiBfaW50ZXJvcERlZmF1bHRMZWdhY3kgKGUpIHsgcmV0dXJuIGUgJiYgdHlwZW9mIGUgPT09ICdvYmplY3QnICYmICdkZWZhdWx0JyBpbiBlID8gZSA6IHsgJ2RlZmF1bHQnOiBlIH07IH1cblxuXHR2YXIgZ2xvYmFsX19kZWZhdWx0ID0gLyojX19QVVJFX18qL19pbnRlcm9wRGVmYXVsdExlZ2FjeShnbG9iYWwkMSk7XG5cblx0dmFyIHdpbmRvdyQxID0gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10ud2luZG93O1xuXHR2YXIgc2VsZiQxID0gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uc2VsZjtcblx0dmFyIGNvbnNvbGUgPSBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS5jb25zb2xlO1xuXHR2YXIgc2V0VGltZW91dCQxID0gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uc2V0VGltZW91dDtcblx0dmFyIGNsZWFyVGltZW91dCA9IGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLmNsZWFyVGltZW91dDtcblx0dmFyIGRvY3VtZW50JDEgPSB3aW5kb3ckMSAmJiB3aW5kb3ckMS5kb2N1bWVudDtcblx0dmFyIG5hdmlnYXRvciA9IHdpbmRvdyQxICYmIHdpbmRvdyQxLm5hdmlnYXRvcjtcblx0dmFyIGxvY2FsU2Vzc2lvblN0b3JhZ2UgPSBmdW5jdGlvbiAoKSB7XG5cdCAgdmFyIHggPSBcInF1bml0LXRlc3Qtc3RyaW5nXCI7XG5cblx0ICB0cnkge1xuXHQgICAgZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uc2Vzc2lvblN0b3JhZ2Uuc2V0SXRlbSh4LCB4KTtcblx0ICAgIGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLnNlc3Npb25TdG9yYWdlLnJlbW92ZUl0ZW0oeCk7XG5cdCAgICByZXR1cm4gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uc2Vzc2lvblN0b3JhZ2U7XG5cdCAgfSBjYXRjaCAoZSkge1xuXHQgICAgcmV0dXJuIHVuZGVmaW5lZDtcblx0ICB9XG5cdH0oKTsgLy8gU3VwcG9ydCBJRSA5LTEwOiBGYWxsYmFjayBmb3IgZnV6enlzb3J0LmpzIHVzZWQgYnkgL3JlcG9ydGVyL2h0bWwuanNcblxuXHRpZiAoIWdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLk1hcCkge1xuXHQgIGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLk1hcCA9IGZ1bmN0aW9uIFN0cmluZ01hcCgpIHtcblx0ICAgIHZhciBzdG9yZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cblx0ICAgIHRoaXMuZ2V0ID0gZnVuY3Rpb24gKHN0cktleSkge1xuXHQgICAgICByZXR1cm4gc3RvcmVbc3RyS2V5XTtcblx0ICAgIH07XG5cblx0ICAgIHRoaXMuc2V0ID0gZnVuY3Rpb24gKHN0cktleSwgdmFsKSB7XG5cdCAgICAgIHN0b3JlW3N0cktleV0gPSB2YWw7XG5cdCAgICAgIHJldHVybiB0aGlzO1xuXHQgICAgfTtcblxuXHQgICAgdGhpcy5jbGVhciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgc3RvcmUgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHQgICAgfTtcblx0ICB9O1xuXHR9XG5cblx0ZnVuY3Rpb24gX3R5cGVvZihvYmopIHtcblx0ICBcIkBiYWJlbC9oZWxwZXJzIC0gdHlwZW9mXCI7XG5cblx0ICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBTeW1ib2wuaXRlcmF0b3IgPT09IFwic3ltYm9sXCIpIHtcblx0ICAgIF90eXBlb2YgPSBmdW5jdGlvbiAob2JqKSB7XG5cdCAgICAgIHJldHVybiB0eXBlb2Ygb2JqO1xuXHQgICAgfTtcblx0ICB9IGVsc2Uge1xuXHQgICAgX3R5cGVvZiA9IGZ1bmN0aW9uIChvYmopIHtcblx0ICAgICAgcmV0dXJuIG9iaiAmJiB0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgb2JqLmNvbnN0cnVjdG9yID09PSBTeW1ib2wgJiYgb2JqICE9PSBTeW1ib2wucHJvdG90eXBlID8gXCJzeW1ib2xcIiA6IHR5cGVvZiBvYmo7XG5cdCAgICB9O1xuXHQgIH1cblxuXHQgIHJldHVybiBfdHlwZW9mKG9iaik7XG5cdH1cblxuXHRmdW5jdGlvbiBfY2xhc3NDYWxsQ2hlY2soaW5zdGFuY2UsIENvbnN0cnVjdG9yKSB7XG5cdCAgaWYgKCEoaW5zdGFuY2UgaW5zdGFuY2VvZiBDb25zdHJ1Y3RvcikpIHtcblx0ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3QgY2FsbCBhIGNsYXNzIGFzIGEgZnVuY3Rpb25cIik7XG5cdCAgfVxuXHR9XG5cblx0ZnVuY3Rpb24gX2RlZmluZVByb3BlcnRpZXModGFyZ2V0LCBwcm9wcykge1xuXHQgIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvcHMubGVuZ3RoOyBpKyspIHtcblx0ICAgIHZhciBkZXNjcmlwdG9yID0gcHJvcHNbaV07XG5cdCAgICBkZXNjcmlwdG9yLmVudW1lcmFibGUgPSBkZXNjcmlwdG9yLmVudW1lcmFibGUgfHwgZmFsc2U7XG5cdCAgICBkZXNjcmlwdG9yLmNvbmZpZ3VyYWJsZSA9IHRydWU7XG5cdCAgICBpZiAoXCJ2YWx1ZVwiIGluIGRlc2NyaXB0b3IpIGRlc2NyaXB0b3Iud3JpdGFibGUgPSB0cnVlO1xuXHQgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KHRhcmdldCwgZGVzY3JpcHRvci5rZXksIGRlc2NyaXB0b3IpO1xuXHQgIH1cblx0fVxuXG5cdGZ1bmN0aW9uIF9jcmVhdGVDbGFzcyhDb25zdHJ1Y3RvciwgcHJvdG9Qcm9wcywgc3RhdGljUHJvcHMpIHtcblx0ICBpZiAocHJvdG9Qcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IucHJvdG90eXBlLCBwcm90b1Byb3BzKTtcblx0ICBpZiAoc3RhdGljUHJvcHMpIF9kZWZpbmVQcm9wZXJ0aWVzKENvbnN0cnVjdG9yLCBzdGF0aWNQcm9wcyk7XG5cdCAgcmV0dXJuIENvbnN0cnVjdG9yO1xuXHR9XG5cblx0ZnVuY3Rpb24gX3RvQ29uc3VtYWJsZUFycmF5KGFycikge1xuXHQgIHJldHVybiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB8fCBfaXRlcmFibGVUb0FycmF5KGFycikgfHwgX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KGFycikgfHwgX25vbkl0ZXJhYmxlU3ByZWFkKCk7XG5cdH1cblxuXHRmdW5jdGlvbiBfYXJyYXlXaXRob3V0SG9sZXMoYXJyKSB7XG5cdCAgaWYgKEFycmF5LmlzQXJyYXkoYXJyKSkgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KGFycik7XG5cdH1cblxuXHRmdW5jdGlvbiBfaXRlcmFibGVUb0FycmF5KGl0ZXIpIHtcblx0ICBpZiAodHlwZW9mIFN5bWJvbCAhPT0gXCJ1bmRlZmluZWRcIiAmJiBTeW1ib2wuaXRlcmF0b3IgaW4gT2JqZWN0KGl0ZXIpKSByZXR1cm4gQXJyYXkuZnJvbShpdGVyKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvLCBtaW5MZW4pIHtcblx0ICBpZiAoIW8pIHJldHVybjtcblx0ICBpZiAodHlwZW9mIG8gPT09IFwic3RyaW5nXCIpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xuXHQgIHZhciBuID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKG8pLnNsaWNlKDgsIC0xKTtcblx0ICBpZiAobiA9PT0gXCJPYmplY3RcIiAmJiBvLmNvbnN0cnVjdG9yKSBuID0gby5jb25zdHJ1Y3Rvci5uYW1lO1xuXHQgIGlmIChuID09PSBcIk1hcFwiIHx8IG4gPT09IFwiU2V0XCIpIHJldHVybiBBcnJheS5mcm9tKG8pO1xuXHQgIGlmIChuID09PSBcIkFyZ3VtZW50c1wiIHx8IC9eKD86VWl8SSludCg/Ojh8MTZ8MzIpKD86Q2xhbXBlZCk/QXJyYXkkLy50ZXN0KG4pKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkobywgbWluTGVuKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9hcnJheUxpa2VUb0FycmF5KGFyciwgbGVuKSB7XG5cdCAgaWYgKGxlbiA9PSBudWxsIHx8IGxlbiA+IGFyci5sZW5ndGgpIGxlbiA9IGFyci5sZW5ndGg7XG5cblx0ICBmb3IgKHZhciBpID0gMCwgYXJyMiA9IG5ldyBBcnJheShsZW4pOyBpIDwgbGVuOyBpKyspIGFycjJbaV0gPSBhcnJbaV07XG5cblx0ICByZXR1cm4gYXJyMjtcblx0fVxuXG5cdGZ1bmN0aW9uIF9ub25JdGVyYWJsZVNwcmVhZCgpIHtcblx0ICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiSW52YWxpZCBhdHRlbXB0IHRvIHNwcmVhZCBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKG8sIGFsbG93QXJyYXlMaWtlKSB7XG5cdCAgdmFyIGl0O1xuXG5cdCAgaWYgKHR5cGVvZiBTeW1ib2wgPT09IFwidW5kZWZpbmVkXCIgfHwgb1tTeW1ib2wuaXRlcmF0b3JdID09IG51bGwpIHtcblx0ICAgIGlmIChBcnJheS5pc0FycmF5KG8pIHx8IChpdCA9IF91bnN1cHBvcnRlZEl0ZXJhYmxlVG9BcnJheShvKSkgfHwgYWxsb3dBcnJheUxpa2UgJiYgbyAmJiB0eXBlb2Ygby5sZW5ndGggPT09IFwibnVtYmVyXCIpIHtcblx0ICAgICAgaWYgKGl0KSBvID0gaXQ7XG5cdCAgICAgIHZhciBpID0gMDtcblxuXHQgICAgICB2YXIgRiA9IGZ1bmN0aW9uICgpIHt9O1xuXG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgczogRixcblx0ICAgICAgICBuOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBpZiAoaSA+PSBvLmxlbmd0aCkgcmV0dXJuIHtcblx0ICAgICAgICAgICAgZG9uZTogdHJ1ZVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIGRvbmU6IGZhbHNlLFxuXHQgICAgICAgICAgICB2YWx1ZTogb1tpKytdXG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZTogZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICAgIHRocm93IGU7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBmOiBGXG5cdCAgICAgIH07XG5cdCAgICB9XG5cblx0ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gaXRlcmF0ZSBub24taXRlcmFibGUgaW5zdGFuY2UuXFxuSW4gb3JkZXIgdG8gYmUgaXRlcmFibGUsIG5vbi1hcnJheSBvYmplY3RzIG11c3QgaGF2ZSBhIFtTeW1ib2wuaXRlcmF0b3JdKCkgbWV0aG9kLlwiKTtcblx0ICB9XG5cblx0ICB2YXIgbm9ybWFsQ29tcGxldGlvbiA9IHRydWUsXG5cdCAgICAgIGRpZEVyciA9IGZhbHNlLFxuXHQgICAgICBlcnI7XG5cdCAgcmV0dXJuIHtcblx0ICAgIHM6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaXQgPSBvW1N5bWJvbC5pdGVyYXRvcl0oKTtcblx0ICAgIH0sXG5cdCAgICBuOiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHZhciBzdGVwID0gaXQubmV4dCgpO1xuXHQgICAgICBub3JtYWxDb21wbGV0aW9uID0gc3RlcC5kb25lO1xuXHQgICAgICByZXR1cm4gc3RlcDtcblx0ICAgIH0sXG5cdCAgICBlOiBmdW5jdGlvbiAoZSkge1xuXHQgICAgICBkaWRFcnIgPSB0cnVlO1xuXHQgICAgICBlcnIgPSBlO1xuXHQgICAgfSxcblx0ICAgIGY6IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICBpZiAoIW5vcm1hbENvbXBsZXRpb24gJiYgaXQucmV0dXJuICE9IG51bGwpIGl0LnJldHVybigpO1xuXHQgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgIGlmIChkaWRFcnIpIHRocm93IGVycjtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH07XG5cdH1cblxuXHQvLyBUaGlzIGFsbG93cyBzdXBwb3J0IGZvciBJRSA5LCB3aGljaCBkb2Vzbid0IGhhdmUgYSBjb25zb2xlXG5cdC8vIG9iamVjdCBpZiB0aGUgZGV2ZWxvcGVyIHRvb2xzIGFyZSBub3Qgb3Blbi5cblxuXHR2YXIgTG9nZ2VyID0ge1xuXHQgIHdhcm46IGNvbnNvbGUgPyBjb25zb2xlLndhcm4uYmluZChjb25zb2xlKSA6IGZ1bmN0aW9uICgpIHt9XG5cdH07XG5cblx0dmFyIHRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZztcblx0dmFyIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cdHZhciBub3cgPSBEYXRlLm5vdyB8fCBmdW5jdGlvbiAoKSB7XG5cdCAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xuXHR9O1xuXHR2YXIgaGFzUGVyZm9ybWFuY2VBcGkgPSBkZXRlY3RQZXJmb3JtYW5jZUFwaSgpO1xuXHR2YXIgcGVyZm9ybWFuY2UgPSBoYXNQZXJmb3JtYW5jZUFwaSA/IHdpbmRvdyQxLnBlcmZvcm1hbmNlIDogdW5kZWZpbmVkO1xuXHR2YXIgcGVyZm9ybWFuY2VOb3cgPSBoYXNQZXJmb3JtYW5jZUFwaSA/IHBlcmZvcm1hbmNlLm5vdy5iaW5kKHBlcmZvcm1hbmNlKSA6IG5vdztcblxuXHRmdW5jdGlvbiBkZXRlY3RQZXJmb3JtYW5jZUFwaSgpIHtcblx0ICByZXR1cm4gd2luZG93JDEgJiYgdHlwZW9mIHdpbmRvdyQxLnBlcmZvcm1hbmNlICE9PSBcInVuZGVmaW5lZFwiICYmIHR5cGVvZiB3aW5kb3ckMS5wZXJmb3JtYW5jZS5tYXJrID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIHdpbmRvdyQxLnBlcmZvcm1hbmNlLm1lYXN1cmUgPT09IFwiZnVuY3Rpb25cIjtcblx0fVxuXG5cdGZ1bmN0aW9uIG1lYXN1cmUoY29tbWVudCwgc3RhcnRNYXJrLCBlbmRNYXJrKSB7XG5cdCAgLy8gYHBlcmZvcm1hbmNlLm1lYXN1cmVgIG1heSBmYWlsIGlmIHRoZSBtYXJrIGNvdWxkIG5vdCBiZSBmb3VuZC5cblx0ICAvLyByZWFzb25zIGEgc3BlY2lmaWMgbWFyayBjb3VsZCBub3QgYmUgZm91bmQgaW5jbHVkZTogb3V0c2lkZSBjb2RlIGludm9raW5nIGBwZXJmb3JtYW5jZS5jbGVhck1hcmtzKClgXG5cdCAgdHJ5IHtcblx0ICAgIHBlcmZvcm1hbmNlLm1lYXN1cmUoY29tbWVudCwgc3RhcnRNYXJrLCBlbmRNYXJrKTtcblx0ICB9IGNhdGNoIChleCkge1xuXHQgICAgTG9nZ2VyLndhcm4oXCJwZXJmb3JtYW5jZS5tZWFzdXJlIGNvdWxkIG5vdCBiZSBleGVjdXRlZCBiZWNhdXNlIG9mIFwiLCBleC5tZXNzYWdlKTtcblx0ICB9XG5cdH1cblx0dmFyIGRlZmluZWQgPSB7XG5cdCAgZG9jdW1lbnQ6IHdpbmRvdyQxICYmIHdpbmRvdyQxLmRvY3VtZW50ICE9PSB1bmRlZmluZWQsXG5cdCAgc2V0VGltZW91dDogc2V0VGltZW91dCQxICE9PSB1bmRlZmluZWRcblx0fTsgLy8gUmV0dXJucyBhIG5ldyBBcnJheSB3aXRoIHRoZSBlbGVtZW50cyB0aGF0IGFyZSBpbiBhIGJ1dCBub3QgaW4gYlxuXG5cdGZ1bmN0aW9uIGRpZmYoYSwgYikge1xuXHQgIHZhciBpLFxuXHQgICAgICBqLFxuXHQgICAgICByZXN1bHQgPSBhLnNsaWNlKCk7XG5cblx0ICBmb3IgKGkgPSAwOyBpIDwgcmVzdWx0Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICBmb3IgKGogPSAwOyBqIDwgYi5sZW5ndGg7IGorKykge1xuXHQgICAgICBpZiAocmVzdWx0W2ldID09PSBiW2pdKSB7XG5cdCAgICAgICAgcmVzdWx0LnNwbGljZShpLCAxKTtcblx0ICAgICAgICBpLS07XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cblx0ICByZXR1cm4gcmVzdWx0O1xuXHR9XG5cdC8qKlxuXHQgKiBEZXRlcm1pbmVzIHdoZXRoZXIgYW4gZWxlbWVudCBleGlzdHMgaW4gYSBnaXZlbiBhcnJheSBvciBub3QuXG5cdCAqXG5cdCAqIEBtZXRob2QgaW5BcnJheVxuXHQgKiBAcGFyYW0ge0FueX0gZWxlbVxuXHQgKiBAcGFyYW0ge0FycmF5fSBhcnJheVxuXHQgKiBAcmV0dXJuIHtCb29sZWFufVxuXHQgKi9cblxuXHRmdW5jdGlvbiBpbkFycmF5KGVsZW0sIGFycmF5KSB7XG5cdCAgcmV0dXJuIGFycmF5LmluZGV4T2YoZWxlbSkgIT09IC0xO1xuXHR9XG5cdC8qKlxuXHQgKiBNYWtlcyBhIGNsb25lIG9mIGFuIG9iamVjdCB1c2luZyBvbmx5IEFycmF5IG9yIE9iamVjdCBhcyBiYXNlLFxuXHQgKiBhbmQgY29waWVzIG92ZXIgdGhlIG93biBlbnVtZXJhYmxlIHByb3BlcnRpZXMuXG5cdCAqXG5cdCAqIEBwYXJhbSB7T2JqZWN0fSBvYmpcblx0ICogQHJldHVybiB7T2JqZWN0fSBOZXcgb2JqZWN0IHdpdGggb25seSB0aGUgb3duIHByb3BlcnRpZXMgKHJlY3Vyc2l2ZWx5KS5cblx0ICovXG5cblx0ZnVuY3Rpb24gb2JqZWN0VmFsdWVzKG9iaikge1xuXHQgIHZhciBrZXksXG5cdCAgICAgIHZhbCxcblx0ICAgICAgdmFscyA9IGlzKFwiYXJyYXlcIiwgb2JqKSA/IFtdIDoge307XG5cblx0ICBmb3IgKGtleSBpbiBvYmopIHtcblx0ICAgIGlmIChoYXNPd24uY2FsbChvYmosIGtleSkpIHtcblx0ICAgICAgdmFsID0gb2JqW2tleV07XG5cdCAgICAgIHZhbHNba2V5XSA9IHZhbCA9PT0gT2JqZWN0KHZhbCkgPyBvYmplY3RWYWx1ZXModmFsKSA6IHZhbDtcblx0ICAgIH1cblx0ICB9XG5cblx0ICByZXR1cm4gdmFscztcblx0fVxuXHRmdW5jdGlvbiBleHRlbmQoYSwgYiwgdW5kZWZPbmx5KSB7XG5cdCAgZm9yICh2YXIgcHJvcCBpbiBiKSB7XG5cdCAgICBpZiAoaGFzT3duLmNhbGwoYiwgcHJvcCkpIHtcblx0ICAgICAgaWYgKGJbcHJvcF0gPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIGRlbGV0ZSBhW3Byb3BdO1xuXHQgICAgICB9IGVsc2UgaWYgKCEodW5kZWZPbmx5ICYmIHR5cGVvZiBhW3Byb3BdICE9PSBcInVuZGVmaW5lZFwiKSkge1xuXHQgICAgICAgIGFbcHJvcF0gPSBiW3Byb3BdO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgcmV0dXJuIGE7XG5cdH1cblx0ZnVuY3Rpb24gb2JqZWN0VHlwZShvYmopIHtcblx0ICBpZiAodHlwZW9mIG9iaiA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHQgICAgcmV0dXJuIFwidW5kZWZpbmVkXCI7XG5cdCAgfSAvLyBDb25zaWRlcjogdHlwZW9mIG51bGwgPT09IG9iamVjdFxuXG5cblx0ICBpZiAob2JqID09PSBudWxsKSB7XG5cdCAgICByZXR1cm4gXCJudWxsXCI7XG5cdCAgfVxuXG5cdCAgdmFyIG1hdGNoID0gdG9TdHJpbmcuY2FsbChvYmopLm1hdGNoKC9eXFxbb2JqZWN0XFxzKC4qKVxcXSQvKSxcblx0ICAgICAgdHlwZSA9IG1hdGNoICYmIG1hdGNoWzFdO1xuXG5cdCAgc3dpdGNoICh0eXBlKSB7XG5cdCAgICBjYXNlIFwiTnVtYmVyXCI6XG5cdCAgICAgIGlmIChpc05hTihvYmopKSB7XG5cdCAgICAgICAgcmV0dXJuIFwibmFuXCI7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gXCJudW1iZXJcIjtcblxuXHQgICAgY2FzZSBcIlN0cmluZ1wiOlxuXHQgICAgY2FzZSBcIkJvb2xlYW5cIjpcblx0ICAgIGNhc2UgXCJBcnJheVwiOlxuXHQgICAgY2FzZSBcIlNldFwiOlxuXHQgICAgY2FzZSBcIk1hcFwiOlxuXHQgICAgY2FzZSBcIkRhdGVcIjpcblx0ICAgIGNhc2UgXCJSZWdFeHBcIjpcblx0ICAgIGNhc2UgXCJGdW5jdGlvblwiOlxuXHQgICAgY2FzZSBcIlN5bWJvbFwiOlxuXHQgICAgICByZXR1cm4gdHlwZS50b0xvd2VyQ2FzZSgpO1xuXG5cdCAgICBkZWZhdWx0OlxuXHQgICAgICByZXR1cm4gX3R5cGVvZihvYmopO1xuXHQgIH1cblx0fSAvLyBTYWZlIG9iamVjdCB0eXBlIGNoZWNraW5nXG5cblx0ZnVuY3Rpb24gaXModHlwZSwgb2JqKSB7XG5cdCAgcmV0dXJuIG9iamVjdFR5cGUob2JqKSA9PT0gdHlwZTtcblx0fSAvLyBCYXNlZCBvbiBKYXZhJ3MgU3RyaW5nLmhhc2hDb2RlLCBhIHNpbXBsZSBidXQgbm90XG5cdC8vIHJpZ29yb3VzbHkgY29sbGlzaW9uIHJlc2lzdGFudCBoYXNoaW5nIGZ1bmN0aW9uXG5cblx0ZnVuY3Rpb24gZ2VuZXJhdGVIYXNoKG1vZHVsZSwgdGVzdE5hbWUpIHtcblx0ICB2YXIgc3RyID0gbW9kdWxlICsgXCJcXHgxQ1wiICsgdGVzdE5hbWU7XG5cdCAgdmFyIGhhc2ggPSAwO1xuXG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHIubGVuZ3RoOyBpKyspIHtcblx0ICAgIGhhc2ggPSAoaGFzaCA8PCA1KSAtIGhhc2ggKyBzdHIuY2hhckNvZGVBdChpKTtcblx0ICAgIGhhc2ggfD0gMDtcblx0ICB9IC8vIENvbnZlcnQgdGhlIHBvc3NpYmx5IG5lZ2F0aXZlIGludGVnZXIgaGFzaCBjb2RlIGludG8gYW4gOCBjaGFyYWN0ZXIgaGV4IHN0cmluZywgd2hpY2ggaXNuJ3Rcblx0ICAvLyBzdHJpY3RseSBuZWNlc3NhcnkgYnV0IGluY3JlYXNlcyB1c2VyIHVuZGVyc3RhbmRpbmcgdGhhdCB0aGUgaWQgaXMgYSBTSEEtbGlrZSBoYXNoXG5cblxuXHQgIHZhciBoZXggPSAoMHgxMDAwMDAwMDAgKyBoYXNoKS50b1N0cmluZygxNik7XG5cblx0ICBpZiAoaGV4Lmxlbmd0aCA8IDgpIHtcblx0ICAgIGhleCA9IFwiMDAwMDAwMFwiICsgaGV4O1xuXHQgIH1cblxuXHQgIHJldHVybiBoZXguc2xpY2UoLTgpO1xuXHR9XG5cblx0Ly8gQXV0aG9yczogUGhpbGlwcGUgUmF0aMOpIDxwcmF0aGVAZ21haWwuY29tPiwgRGF2aWQgQ2hhbiA8ZGF2aWRAdHJvaS5vcmc+XG5cblx0dmFyIGVxdWl2ID0gKGZ1bmN0aW9uICgpIHtcblx0ICAvLyBWYWx1ZSBwYWlycyBxdWV1ZWQgZm9yIGNvbXBhcmlzb24uIFVzZWQgZm9yIGJyZWFkdGgtZmlyc3QgcHJvY2Vzc2luZyBvcmRlciwgcmVjdXJzaW9uXG5cdCAgLy8gZGV0ZWN0aW9uIGFuZCBhdm9pZGluZyByZXBlYXRlZCBjb21wYXJpc29uIChzZWUgYmVsb3cgZm9yIGRldGFpbHMpLlxuXHQgIC8vIEVsZW1lbnRzIGFyZSB7IGE6IHZhbCwgYjogdmFsIH0uXG5cdCAgdmFyIHBhaXJzID0gW107XG5cblx0ICB2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YgfHwgZnVuY3Rpb24gKG9iaikge1xuXHQgICAgcmV0dXJuIG9iai5fX3Byb3RvX187XG5cdCAgfTtcblxuXHQgIGZ1bmN0aW9uIHVzZVN0cmljdEVxdWFsaXR5KGEsIGIpIHtcblx0ICAgIC8vIFRoaXMgb25seSBnZXRzIGNhbGxlZCBpZiBhIGFuZCBiIGFyZSBub3Qgc3RyaWN0IGVxdWFsLCBhbmQgaXMgdXNlZCB0byBjb21wYXJlIG9uXG5cdCAgICAvLyB0aGUgcHJpbWl0aXZlIHZhbHVlcyBpbnNpZGUgb2JqZWN0IHdyYXBwZXJzLiBGb3IgZXhhbXBsZTpcblx0ICAgIC8vIGB2YXIgaSA9IDE7YFxuXHQgICAgLy8gYHZhciBqID0gbmV3IE51bWJlcigxKTtgXG5cdCAgICAvLyBOZWl0aGVyIGEgbm9yIGIgY2FuIGJlIG51bGwsIGFzIGEgIT09IGIgYW5kIHRoZXkgaGF2ZSB0aGUgc2FtZSB0eXBlLlxuXHQgICAgaWYgKF90eXBlb2YoYSkgPT09IFwib2JqZWN0XCIpIHtcblx0ICAgICAgYSA9IGEudmFsdWVPZigpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoX3R5cGVvZihiKSA9PT0gXCJvYmplY3RcIikge1xuXHQgICAgICBiID0gYi52YWx1ZU9mKCk7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBhID09PSBiO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGNvbXBhcmVDb25zdHJ1Y3RvcnMoYSwgYikge1xuXHQgICAgdmFyIHByb3RvQSA9IGdldFByb3RvKGEpO1xuXHQgICAgdmFyIHByb3RvQiA9IGdldFByb3RvKGIpOyAvLyBDb21wYXJpbmcgY29uc3RydWN0b3JzIGlzIG1vcmUgc3RyaWN0IHRoYW4gdXNpbmcgYGluc3RhbmNlb2ZgXG5cblx0ICAgIGlmIChhLmNvbnN0cnVjdG9yID09PSBiLmNvbnN0cnVjdG9yKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfSAvLyBSZWYgIzg1MVxuXHQgICAgLy8gSWYgdGhlIG9iaiBwcm90b3R5cGUgZGVzY2VuZHMgZnJvbSBhIG51bGwgY29uc3RydWN0b3IsIHRyZWF0IGl0XG5cdCAgICAvLyBhcyBhIG51bGwgcHJvdG90eXBlLlxuXG5cblx0ICAgIGlmIChwcm90b0EgJiYgcHJvdG9BLmNvbnN0cnVjdG9yID09PSBudWxsKSB7XG5cdCAgICAgIHByb3RvQSA9IG51bGw7XG5cdCAgICB9XG5cblx0ICAgIGlmIChwcm90b0IgJiYgcHJvdG9CLmNvbnN0cnVjdG9yID09PSBudWxsKSB7XG5cdCAgICAgIHByb3RvQiA9IG51bGw7XG5cdCAgICB9IC8vIEFsbG93IG9iamVjdHMgd2l0aCBubyBwcm90b3R5cGUgdG8gYmUgZXF1aXZhbGVudCB0b1xuXHQgICAgLy8gb2JqZWN0cyB3aXRoIE9iamVjdCBhcyB0aGVpciBjb25zdHJ1Y3Rvci5cblxuXG5cdCAgICBpZiAocHJvdG9BID09PSBudWxsICYmIHByb3RvQiA9PT0gT2JqZWN0LnByb3RvdHlwZSB8fCBwcm90b0IgPT09IG51bGwgJiYgcHJvdG9BID09PSBPYmplY3QucHJvdG90eXBlKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gZmFsc2U7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gZ2V0UmVnRXhwRmxhZ3MocmVnZXhwKSB7XG5cdCAgICByZXR1cm4gXCJmbGFnc1wiIGluIHJlZ2V4cCA/IHJlZ2V4cC5mbGFncyA6IHJlZ2V4cC50b1N0cmluZygpLm1hdGNoKC9bZ2ltdXldKiQvKVswXTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBpc0NvbnRhaW5lcih2YWwpIHtcblx0ICAgIHJldHVybiBbXCJvYmplY3RcIiwgXCJhcnJheVwiLCBcIm1hcFwiLCBcInNldFwiXS5pbmRleE9mKG9iamVjdFR5cGUodmFsKSkgIT09IC0xO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGJyZWFkdGhGaXJzdENvbXBhcmVDaGlsZChhLCBiKSB7XG5cdCAgICAvLyBJZiBhIGlzIGEgY29udGFpbmVyIG5vdCByZWZlcmVuY2UtZXF1YWwgdG8gYiwgcG9zdHBvbmUgdGhlIGNvbXBhcmlzb24gdG8gdGhlXG5cdCAgICAvLyBlbmQgb2YgdGhlIHBhaXJzIHF1ZXVlIC0tIHVubGVzcyAoYSwgYikgaGFzIGJlZW4gc2VlbiBiZWZvcmUsIGluIHdoaWNoIGNhc2Ugc2tpcFxuXHQgICAgLy8gb3ZlciB0aGUgcGFpci5cblx0ICAgIGlmIChhID09PSBiKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoIWlzQ29udGFpbmVyKGEpKSB7XG5cdCAgICAgIHJldHVybiB0eXBlRXF1aXYoYSwgYik7XG5cdCAgICB9XG5cblx0ICAgIGlmIChwYWlycy5ldmVyeShmdW5jdGlvbiAocGFpcikge1xuXHQgICAgICByZXR1cm4gcGFpci5hICE9PSBhIHx8IHBhaXIuYiAhPT0gYjtcblx0ICAgIH0pKSB7XG5cdCAgICAgIC8vIE5vdCB5ZXQgc3RhcnRlZCBjb21wYXJpbmcgdGhpcyBwYWlyXG5cdCAgICAgIHBhaXJzLnB1c2goe1xuXHQgICAgICAgIGE6IGEsXG5cdCAgICAgICAgYjogYlxuXHQgICAgICB9KTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHRydWU7XG5cdCAgfVxuXG5cdCAgdmFyIGNhbGxiYWNrcyA9IHtcblx0ICAgIFwic3RyaW5nXCI6IHVzZVN0cmljdEVxdWFsaXR5LFxuXHQgICAgXCJib29sZWFuXCI6IHVzZVN0cmljdEVxdWFsaXR5LFxuXHQgICAgXCJudW1iZXJcIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcIm51bGxcIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcInVuZGVmaW5lZFwiOiB1c2VTdHJpY3RFcXVhbGl0eSxcblx0ICAgIFwic3ltYm9sXCI6IHVzZVN0cmljdEVxdWFsaXR5LFxuXHQgICAgXCJkYXRlXCI6IHVzZVN0cmljdEVxdWFsaXR5LFxuXHQgICAgXCJuYW5cIjogZnVuY3Rpb24gbmFuKCkge1xuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH0sXG5cdCAgICBcInJlZ2V4cFwiOiBmdW5jdGlvbiByZWdleHAoYSwgYikge1xuXHQgICAgICByZXR1cm4gYS5zb3VyY2UgPT09IGIuc291cmNlICYmIC8vIEluY2x1ZGUgZmxhZ3MgaW4gdGhlIGNvbXBhcmlzb25cblx0ICAgICAgZ2V0UmVnRXhwRmxhZ3MoYSkgPT09IGdldFJlZ0V4cEZsYWdzKGIpO1xuXHQgICAgfSxcblx0ICAgIC8vIGFib3J0IChpZGVudGljYWwgcmVmZXJlbmNlcyAvIGluc3RhbmNlIG1ldGhvZHMgd2VyZSBza2lwcGVkIGVhcmxpZXIpXG5cdCAgICBcImZ1bmN0aW9uXCI6IGZ1bmN0aW9uIF9mdW5jdGlvbigpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfSxcblx0ICAgIFwiYXJyYXlcIjogZnVuY3Rpb24gYXJyYXkoYSwgYikge1xuXHQgICAgICB2YXIgaSwgbGVuO1xuXHQgICAgICBsZW4gPSBhLmxlbmd0aDtcblxuXHQgICAgICBpZiAobGVuICE9PSBiLmxlbmd0aCkge1xuXHQgICAgICAgIC8vIFNhZmUgYW5kIGZhc3RlclxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgIC8vIENvbXBhcmUgbm9uLWNvbnRhaW5lcnM7IHF1ZXVlIG5vbi1yZWZlcmVuY2UtZXF1YWwgY29udGFpbmVyc1xuXHQgICAgICAgIGlmICghYnJlYWR0aEZpcnN0Q29tcGFyZUNoaWxkKGFbaV0sIGJbaV0pKSB7XG5cdCAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9LFxuXHQgICAgLy8gRGVmaW5lIHNldHMgYSBhbmQgYiB0byBiZSBlcXVpdmFsZW50IGlmIGZvciBlYWNoIGVsZW1lbnQgYVZhbCBpbiBhLCB0aGVyZVxuXHQgICAgLy8gaXMgc29tZSBlbGVtZW50IGJWYWwgaW4gYiBzdWNoIHRoYXQgYVZhbCBhbmQgYlZhbCBhcmUgZXF1aXZhbGVudC4gRWxlbWVudFxuXHQgICAgLy8gcmVwZXRpdGlvbnMgYXJlIG5vdCBjb3VudGVkLCBzbyB0aGVzZSBhcmUgZXF1aXZhbGVudDpcblx0ICAgIC8vIGEgPSBuZXcgU2V0KCBbIHt9LCBbXSwgW10gXSApO1xuXHQgICAgLy8gYiA9IG5ldyBTZXQoIFsge30sIHt9LCBbXSBdICk7XG5cdCAgICBcInNldFwiOiBmdW5jdGlvbiBzZXQoYSwgYikge1xuXHQgICAgICB2YXIgaW5uZXJFcSxcblx0ICAgICAgICAgIG91dGVyRXEgPSB0cnVlO1xuXG5cdCAgICAgIGlmIChhLnNpemUgIT09IGIuc2l6ZSkge1xuXHQgICAgICAgIC8vIFRoaXMgb3B0aW1pemF0aW9uIGhhcyBjZXJ0YWluIHF1aXJrcyBiZWNhdXNlIG9mIHRoZSBsYWNrIG9mXG5cdCAgICAgICAgLy8gcmVwZXRpdGlvbiBjb3VudGluZy4gRm9yIGluc3RhbmNlLCBhZGRpbmcgdGhlIHNhbWVcblx0ICAgICAgICAvLyAocmVmZXJlbmNlLWlkZW50aWNhbCkgZWxlbWVudCB0byB0d28gZXF1aXZhbGVudCBzZXRzIGNhblxuXHQgICAgICAgIC8vIG1ha2UgdGhlbSBub24tZXF1aXZhbGVudC5cblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblxuXHQgICAgICBhLmZvckVhY2goZnVuY3Rpb24gKGFWYWwpIHtcblx0ICAgICAgICAvLyBTaG9ydC1jaXJjdWl0IGlmIHRoZSByZXN1bHQgaXMgYWxyZWFkeSBrbm93bi4gKFVzaW5nIGZvci4uLm9mXG5cdCAgICAgICAgLy8gd2l0aCBhIGJyZWFrIGNsYXVzZSB3b3VsZCBiZSBjbGVhbmVyIGhlcmUsIGJ1dCBpdCB3b3VsZCBjYXVzZVxuXHQgICAgICAgIC8vIGEgc3ludGF4IGVycm9yIG9uIG9sZGVyIEphdmFzY3JpcHQgaW1wbGVtZW50YXRpb25zIGV2ZW4gaWZcblx0ICAgICAgICAvLyBTZXQgaXMgdW51c2VkKVxuXHQgICAgICAgIGlmICghb3V0ZXJFcSkge1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlubmVyRXEgPSBmYWxzZTtcblx0ICAgICAgICBiLmZvckVhY2goZnVuY3Rpb24gKGJWYWwpIHtcblx0ICAgICAgICAgIHZhciBwYXJlbnRQYWlyczsgLy8gTGlrZXdpc2UsIHNob3J0LWNpcmN1aXQgaWYgdGhlIHJlc3VsdCBpcyBhbHJlYWR5IGtub3duXG5cblx0ICAgICAgICAgIGlmIChpbm5lckVxKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH0gLy8gU3dhcCBvdXQgdGhlIGdsb2JhbCBwYWlycyBsaXN0LCBhcyB0aGUgbmVzdGVkIGNhbGwgdG9cblx0ICAgICAgICAgIC8vIGlubmVyRXF1aXYgd2lsbCBjbG9iYmVyIGl0cyBjb250ZW50c1xuXG5cblx0ICAgICAgICAgIHBhcmVudFBhaXJzID0gcGFpcnM7XG5cblx0ICAgICAgICAgIGlmIChpbm5lckVxdWl2KGJWYWwsIGFWYWwpKSB7XG5cdCAgICAgICAgICAgIGlubmVyRXEgPSB0cnVlO1xuXHQgICAgICAgICAgfSAvLyBSZXBsYWNlIHRoZSBnbG9iYWwgcGFpcnMgbGlzdFxuXG5cblx0ICAgICAgICAgIHBhaXJzID0gcGFyZW50UGFpcnM7XG5cdCAgICAgICAgfSk7XG5cblx0ICAgICAgICBpZiAoIWlubmVyRXEpIHtcblx0ICAgICAgICAgIG91dGVyRXEgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gb3V0ZXJFcTtcblx0ICAgIH0sXG5cdCAgICAvLyBEZWZpbmUgbWFwcyBhIGFuZCBiIHRvIGJlIGVxdWl2YWxlbnQgaWYgZm9yIGVhY2gga2V5LXZhbHVlIHBhaXIgKGFLZXksIGFWYWwpXG5cdCAgICAvLyBpbiBhLCB0aGVyZSBpcyBzb21lIGtleS12YWx1ZSBwYWlyIChiS2V5LCBiVmFsKSBpbiBiIHN1Y2ggdGhhdFxuXHQgICAgLy8gWyBhS2V5LCBhVmFsIF0gYW5kIFsgYktleSwgYlZhbCBdIGFyZSBlcXVpdmFsZW50LiBLZXkgcmVwZXRpdGlvbnMgYXJlIG5vdFxuXHQgICAgLy8gY291bnRlZCwgc28gdGhlc2UgYXJlIGVxdWl2YWxlbnQ6XG5cdCAgICAvLyBhID0gbmV3IE1hcCggWyBbIHt9LCAxIF0sIFsge30sIDEgXSwgWyBbXSwgMSBdIF0gKTtcblx0ICAgIC8vIGIgPSBuZXcgTWFwKCBbIFsge30sIDEgXSwgWyBbXSwgMSBdLCBbIFtdLCAxIF0gXSApO1xuXHQgICAgXCJtYXBcIjogZnVuY3Rpb24gbWFwKGEsIGIpIHtcblx0ICAgICAgdmFyIGlubmVyRXEsXG5cdCAgICAgICAgICBvdXRlckVxID0gdHJ1ZTtcblxuXHQgICAgICBpZiAoYS5zaXplICE9PSBiLnNpemUpIHtcblx0ICAgICAgICAvLyBUaGlzIG9wdGltaXphdGlvbiBoYXMgY2VydGFpbiBxdWlya3MgYmVjYXVzZSBvZiB0aGUgbGFjayBvZlxuXHQgICAgICAgIC8vIHJlcGV0aXRpb24gY291bnRpbmcuIEZvciBpbnN0YW5jZSwgYWRkaW5nIHRoZSBzYW1lXG5cdCAgICAgICAgLy8gKHJlZmVyZW5jZS1pZGVudGljYWwpIGtleS12YWx1ZSBwYWlyIHRvIHR3byBlcXVpdmFsZW50IG1hcHNcblx0ICAgICAgICAvLyBjYW4gbWFrZSB0aGVtIG5vbi1lcXVpdmFsZW50LlxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGEuZm9yRWFjaChmdW5jdGlvbiAoYVZhbCwgYUtleSkge1xuXHQgICAgICAgIC8vIFNob3J0LWNpcmN1aXQgaWYgdGhlIHJlc3VsdCBpcyBhbHJlYWR5IGtub3duLiAoVXNpbmcgZm9yLi4ub2Zcblx0ICAgICAgICAvLyB3aXRoIGEgYnJlYWsgY2xhdXNlIHdvdWxkIGJlIGNsZWFuZXIgaGVyZSwgYnV0IGl0IHdvdWxkIGNhdXNlXG5cdCAgICAgICAgLy8gYSBzeW50YXggZXJyb3Igb24gb2xkZXIgSmF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbnMgZXZlbiBpZlxuXHQgICAgICAgIC8vIE1hcCBpcyB1bnVzZWQpXG5cdCAgICAgICAgaWYgKCFvdXRlckVxKSB7XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaW5uZXJFcSA9IGZhbHNlO1xuXHQgICAgICAgIGIuZm9yRWFjaChmdW5jdGlvbiAoYlZhbCwgYktleSkge1xuXHQgICAgICAgICAgdmFyIHBhcmVudFBhaXJzOyAvLyBMaWtld2lzZSwgc2hvcnQtY2lyY3VpdCBpZiB0aGUgcmVzdWx0IGlzIGFscmVhZHkga25vd25cblxuXHQgICAgICAgICAgaWYgKGlubmVyRXEpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfSAvLyBTd2FwIG91dCB0aGUgZ2xvYmFsIHBhaXJzIGxpc3QsIGFzIHRoZSBuZXN0ZWQgY2FsbCB0b1xuXHQgICAgICAgICAgLy8gaW5uZXJFcXVpdiB3aWxsIGNsb2JiZXIgaXRzIGNvbnRlbnRzXG5cblxuXHQgICAgICAgICAgcGFyZW50UGFpcnMgPSBwYWlycztcblxuXHQgICAgICAgICAgaWYgKGlubmVyRXF1aXYoW2JWYWwsIGJLZXldLCBbYVZhbCwgYUtleV0pKSB7XG5cdCAgICAgICAgICAgIGlubmVyRXEgPSB0cnVlO1xuXHQgICAgICAgICAgfSAvLyBSZXBsYWNlIHRoZSBnbG9iYWwgcGFpcnMgbGlzdFxuXG5cblx0ICAgICAgICAgIHBhaXJzID0gcGFyZW50UGFpcnM7XG5cdCAgICAgICAgfSk7XG5cblx0ICAgICAgICBpZiAoIWlubmVyRXEpIHtcblx0ICAgICAgICAgIG91dGVyRXEgPSBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gb3V0ZXJFcTtcblx0ICAgIH0sXG5cdCAgICBcIm9iamVjdFwiOiBmdW5jdGlvbiBvYmplY3QoYSwgYikge1xuXHQgICAgICB2YXIgaSxcblx0ICAgICAgICAgIGFQcm9wZXJ0aWVzID0gW10sXG5cdCAgICAgICAgICBiUHJvcGVydGllcyA9IFtdO1xuXG5cdCAgICAgIGlmIChjb21wYXJlQ29uc3RydWN0b3JzKGEsIGIpID09PSBmYWxzZSkge1xuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfSAvLyBCZSBzdHJpY3Q6IGRvbid0IGVuc3VyZSBoYXNPd25Qcm9wZXJ0eSBhbmQgZ28gZGVlcFxuXG5cblx0ICAgICAgZm9yIChpIGluIGEpIHtcblx0ICAgICAgICAvLyBDb2xsZWN0IGEncyBwcm9wZXJ0aWVzXG5cdCAgICAgICAgYVByb3BlcnRpZXMucHVzaChpKTsgLy8gU2tpcCBPT1AgbWV0aG9kcyB0aGF0IGxvb2sgdGhlIHNhbWVcblxuXHQgICAgICAgIGlmIChhLmNvbnN0cnVjdG9yICE9PSBPYmplY3QgJiYgdHlwZW9mIGEuY29uc3RydWN0b3IgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIGFbaV0gPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2YgYltpXSA9PT0gXCJmdW5jdGlvblwiICYmIGFbaV0udG9TdHJpbmcoKSA9PT0gYltpXS50b1N0cmluZygpKSB7XG5cdCAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICB9IC8vIENvbXBhcmUgbm9uLWNvbnRhaW5lcnM7IHF1ZXVlIG5vbi1yZWZlcmVuY2UtZXF1YWwgY29udGFpbmVyc1xuXG5cblx0ICAgICAgICBpZiAoIWJyZWFkdGhGaXJzdENvbXBhcmVDaGlsZChhW2ldLCBiW2ldKSkge1xuXHQgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIGZvciAoaSBpbiBiKSB7XG5cdCAgICAgICAgLy8gQ29sbGVjdCBiJ3MgcHJvcGVydGllc1xuXHQgICAgICAgIGJQcm9wZXJ0aWVzLnB1c2goaSk7XG5cdCAgICAgIH0gLy8gRW5zdXJlcyBpZGVudGljYWwgcHJvcGVydGllcyBuYW1lXG5cblxuXHQgICAgICByZXR1cm4gdHlwZUVxdWl2KGFQcm9wZXJ0aWVzLnNvcnQoKSwgYlByb3BlcnRpZXMuc29ydCgpKTtcblx0ICAgIH1cblx0ICB9O1xuXG5cdCAgZnVuY3Rpb24gdHlwZUVxdWl2KGEsIGIpIHtcblx0ICAgIHZhciB0eXBlID0gb2JqZWN0VHlwZShhKTsgLy8gQ2FsbGJhY2tzIGZvciBjb250YWluZXJzIHdpbGwgYXBwZW5kIHRvIHRoZSBwYWlycyBxdWV1ZSB0byBhY2hpZXZlIGJyZWFkdGgtZmlyc3Rcblx0ICAgIC8vIHNlYXJjaCBvcmRlci4gVGhlIHBhaXJzIHF1ZXVlIGlzIGFsc28gdXNlZCB0byBhdm9pZCByZXByb2Nlc3NpbmcgYW55IHBhaXIgb2Zcblx0ICAgIC8vIGNvbnRhaW5lcnMgdGhhdCBhcmUgcmVmZXJlbmNlLWVxdWFsIHRvIGEgcHJldmlvdXNseSB2aXNpdGVkIHBhaXIgKGEgc3BlY2lhbCBjYXNlXG5cdCAgICAvLyB0aGlzIGJlaW5nIHJlY3Vyc2lvbiBkZXRlY3Rpb24pLlxuXHQgICAgLy9cblx0ICAgIC8vIEJlY2F1c2Ugb2YgdGhpcyBhcHByb2FjaCwgb25jZSB0eXBlRXF1aXYgcmV0dXJucyBhIGZhbHNlIHZhbHVlLCBpdCBzaG91bGQgbm90IGJlXG5cdCAgICAvLyBjYWxsZWQgYWdhaW4gd2l0aG91dCBjbGVhcmluZyB0aGUgcGFpciBxdWV1ZSBlbHNlIGl0IG1heSB3cm9uZ2x5IHJlcG9ydCBhIHZpc2l0ZWRcblx0ICAgIC8vIHBhaXIgYXMgYmVpbmcgZXF1aXZhbGVudC5cblxuXHQgICAgcmV0dXJuIG9iamVjdFR5cGUoYikgPT09IHR5cGUgJiYgY2FsbGJhY2tzW3R5cGVdKGEsIGIpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGlubmVyRXF1aXYoYSwgYikge1xuXHQgICAgdmFyIGksIHBhaXI7IC8vIFdlJ3JlIGRvbmUgd2hlbiB0aGVyZSdzIG5vdGhpbmcgbW9yZSB0byBjb21wYXJlXG5cblx0ICAgIGlmIChhcmd1bWVudHMubGVuZ3RoIDwgMikge1xuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH0gLy8gQ2xlYXIgdGhlIGdsb2JhbCBwYWlyIHF1ZXVlIGFuZCBhZGQgdGhlIHRvcC1sZXZlbCB2YWx1ZXMgYmVpbmcgY29tcGFyZWRcblxuXG5cdCAgICBwYWlycyA9IFt7XG5cdCAgICAgIGE6IGEsXG5cdCAgICAgIGI6IGJcblx0ICAgIH1dO1xuXG5cdCAgICBmb3IgKGkgPSAwOyBpIDwgcGFpcnMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgcGFpciA9IHBhaXJzW2ldOyAvLyBQZXJmb3JtIHR5cGUtc3BlY2lmaWMgY29tcGFyaXNvbiBvbiBhbnkgcGFpcnMgdGhhdCBhcmUgbm90IHN0cmljdGx5XG5cdCAgICAgIC8vIGVxdWFsLiBGb3IgY29udGFpbmVyIHR5cGVzLCB0aGF0IGNvbXBhcmlzb24gd2lsbCBwb3N0cG9uZSBjb21wYXJpc29uXG5cdCAgICAgIC8vIG9mIGFueSBzdWItY29udGFpbmVyIHBhaXIgdG8gdGhlIGVuZCBvZiB0aGUgcGFpciBxdWV1ZS4gVGhpcyBnaXZlc1xuXHQgICAgICAvLyBicmVhZHRoLWZpcnN0IHNlYXJjaCBvcmRlci4gSXQgYWxzbyBhdm9pZHMgdGhlIHJlcHJvY2Vzc2luZyBvZlxuXHQgICAgICAvLyByZWZlcmVuY2UtZXF1YWwgc2libGluZ3MsIGNvdXNpbnMgZXRjLCB3aGljaCBjYW4gaGF2ZSBhIHNpZ25pZmljYW50IHNwZWVkXG5cdCAgICAgIC8vIGltcGFjdCB3aGVuIGNvbXBhcmluZyBhIGNvbnRhaW5lciBvZiBzbWFsbCBvYmplY3RzIGVhY2ggb2Ygd2hpY2ggaGFzIGFcblx0ICAgICAgLy8gcmVmZXJlbmNlIHRvIHRoZSBzYW1lIChzaW5nbGV0b24pIGxhcmdlIG9iamVjdC5cblxuXHQgICAgICBpZiAocGFpci5hICE9PSBwYWlyLmIgJiYgIXR5cGVFcXVpdihwYWlyLmEsIHBhaXIuYikpIHtcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgIH0gLy8gLi4uYWNyb3NzIGFsbCBjb25zZWN1dGl2ZSBhcmd1bWVudCBwYWlyc1xuXG5cblx0ICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID09PSAyIHx8IGlubmVyRXF1aXYuYXBwbHkodGhpcywgW10uc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpKTtcblx0ICB9XG5cblx0ICByZXR1cm4gZnVuY3Rpb24gKCkge1xuXHQgICAgdmFyIHJlc3VsdCA9IGlubmVyRXF1aXYuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpOyAvLyBSZWxlYXNlIGFueSByZXRhaW5lZCBvYmplY3RzXG5cblx0ICAgIHBhaXJzLmxlbmd0aCA9IDA7XG5cdCAgICByZXR1cm4gcmVzdWx0O1xuXHQgIH07XG5cdH0pKCk7XG5cblx0LyoqXG5cdCAqIENvbmZpZyBvYmplY3Q6IE1haW50YWluIGludGVybmFsIHN0YXRlXG5cdCAqIExhdGVyIGV4cG9zZWQgYXMgUVVuaXQuY29uZmlnXG5cdCAqIGBjb25maWdgIGluaXRpYWxpemVkIGF0IHRvcCBvZiBzY29wZVxuXHQgKi9cblxuXHR2YXIgY29uZmlnID0ge1xuXHQgIC8vIFRoZSBxdWV1ZSBvZiB0ZXN0cyB0byBydW5cblx0ICBxdWV1ZTogW10sXG5cdCAgLy8gQmxvY2sgdW50aWwgZG9jdW1lbnQgcmVhZHlcblx0ICBibG9ja2luZzogdHJ1ZSxcblx0ICAvLyBCeSBkZWZhdWx0LCBydW4gcHJldmlvdXNseSBmYWlsZWQgdGVzdHMgZmlyc3Rcblx0ICAvLyB2ZXJ5IHVzZWZ1bCBpbiBjb21iaW5hdGlvbiB3aXRoIFwiSGlkZSBwYXNzZWQgdGVzdHNcIiBjaGVja2VkXG5cdCAgcmVvcmRlcjogdHJ1ZSxcblx0ICAvLyBCeSBkZWZhdWx0LCBtb2RpZnkgZG9jdW1lbnQudGl0bGUgd2hlbiBzdWl0ZSBpcyBkb25lXG5cdCAgYWx0ZXJ0aXRsZTogdHJ1ZSxcblx0ICAvLyBIVE1MIFJlcG9ydGVyOiBjb2xsYXBzZSBldmVyeSB0ZXN0IGV4Y2VwdCB0aGUgZmlyc3QgZmFpbGluZyB0ZXN0XG5cdCAgLy8gSWYgZmFsc2UsIGFsbCBmYWlsaW5nIHRlc3RzIHdpbGwgYmUgZXhwYW5kZWRcblx0ICBjb2xsYXBzZTogdHJ1ZSxcblx0ICAvLyBCeSBkZWZhdWx0LCBzY3JvbGwgdG8gdG9wIG9mIHRoZSBwYWdlIHdoZW4gc3VpdGUgaXMgZG9uZVxuXHQgIHNjcm9sbHRvcDogdHJ1ZSxcblx0ICAvLyBEZXB0aCB1cC10byB3aGljaCBvYmplY3Qgd2lsbCBiZSBkdW1wZWRcblx0ICBtYXhEZXB0aDogNSxcblx0ICAvLyBXaGVuIGVuYWJsZWQsIGFsbCB0ZXN0cyBtdXN0IGNhbGwgZXhwZWN0KClcblx0ICByZXF1aXJlRXhwZWN0czogZmFsc2UsXG5cdCAgLy8gUGxhY2Vob2xkZXIgZm9yIHVzZXItY29uZmlndXJhYmxlIGZvcm0tZXhwb3NlZCBVUkwgcGFyYW1ldGVyc1xuXHQgIHVybENvbmZpZzogW10sXG5cdCAgLy8gU2V0IG9mIGFsbCBtb2R1bGVzLlxuXHQgIG1vZHVsZXM6IFtdLFxuXHQgIC8vIFRoZSBmaXJzdCB1bm5hbWVkIG1vZHVsZVxuXHQgIGN1cnJlbnRNb2R1bGU6IHtcblx0ICAgIG5hbWU6IFwiXCIsXG5cdCAgICB0ZXN0czogW10sXG5cdCAgICBjaGlsZE1vZHVsZXM6IFtdLFxuXHQgICAgdGVzdHNSdW46IDAsXG5cdCAgICB1bnNraXBwZWRUZXN0c1J1bjogMCxcblx0ICAgIGhvb2tzOiB7XG5cdCAgICAgIGJlZm9yZTogW10sXG5cdCAgICAgIGJlZm9yZUVhY2g6IFtdLFxuXHQgICAgICBhZnRlckVhY2g6IFtdLFxuXHQgICAgICBhZnRlcjogW11cblx0ICAgIH1cblx0ICB9LFxuXHQgIGNhbGxiYWNrczoge30sXG5cdCAgLy8gVGhlIHN0b3JhZ2UgbW9kdWxlIHRvIHVzZSBmb3IgcmVvcmRlcmluZyB0ZXN0c1xuXHQgIHN0b3JhZ2U6IGxvY2FsU2Vzc2lvblN0b3JhZ2Vcblx0fTsgLy8gdGFrZSBhIHByZWRlZmluZWQgUVVuaXQuY29uZmlnIGFuZCBleHRlbmQgdGhlIGRlZmF1bHRzXG5cblx0dmFyIGdsb2JhbENvbmZpZyA9IHdpbmRvdyQxICYmIHdpbmRvdyQxLlFVbml0ICYmIHdpbmRvdyQxLlFVbml0LmNvbmZpZzsgLy8gb25seSBleHRlbmQgdGhlIGdsb2JhbCBjb25maWcgaWYgdGhlcmUgaXMgbm8gUVVuaXQgb3ZlcmxvYWRcblxuXHRpZiAod2luZG93JDEgJiYgd2luZG93JDEuUVVuaXQgJiYgIXdpbmRvdyQxLlFVbml0LnZlcnNpb24pIHtcblx0ICBleHRlbmQoY29uZmlnLCBnbG9iYWxDb25maWcpO1xuXHR9IC8vIFB1c2ggYSBsb29zZSB1bm5hbWVkIG1vZHVsZSB0byB0aGUgbW9kdWxlcyBjb2xsZWN0aW9uXG5cblxuXHRjb25maWcubW9kdWxlcy5wdXNoKGNvbmZpZy5jdXJyZW50TW9kdWxlKTtcblxuXHQvLyBodHRwczovL2ZsZXNsZXIuYmxvZ3Nwb3QuY29tLzIwMDgvMDUvanNkdW1wLXByZXR0eS1kdW1wLW9mLWFueS1qYXZhc2NyaXB0Lmh0bWxcblxuXHR2YXIgZHVtcCA9IChmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gcXVvdGUoc3RyKSB7XG5cdCAgICByZXR1cm4gXCJcXFwiXCIgKyBzdHIudG9TdHJpbmcoKS5yZXBsYWNlKC9cXFxcL2csIFwiXFxcXFxcXFxcIikucmVwbGFjZSgvXCIvZywgXCJcXFxcXFxcIlwiKSArIFwiXFxcIlwiO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGxpdGVyYWwobykge1xuXHQgICAgcmV0dXJuIG8gKyBcIlwiO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGpvaW4ocHJlLCBhcnIsIHBvc3QpIHtcblx0ICAgIHZhciBzID0gZHVtcC5zZXBhcmF0b3IoKSxcblx0ICAgICAgICBiYXNlID0gZHVtcC5pbmRlbnQoKSxcblx0ICAgICAgICBpbm5lciA9IGR1bXAuaW5kZW50KDEpO1xuXG5cdCAgICBpZiAoYXJyLmpvaW4pIHtcblx0ICAgICAgYXJyID0gYXJyLmpvaW4oXCIsXCIgKyBzICsgaW5uZXIpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoIWFycikge1xuXHQgICAgICByZXR1cm4gcHJlICsgcG9zdDtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIFtwcmUsIGlubmVyICsgYXJyLCBiYXNlICsgcG9zdF0uam9pbihzKTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhcnJheShhcnIsIHN0YWNrKSB7XG5cdCAgICB2YXIgaSA9IGFyci5sZW5ndGgsXG5cdCAgICAgICAgcmV0ID0gbmV3IEFycmF5KGkpO1xuXG5cdCAgICBpZiAoZHVtcC5tYXhEZXB0aCAmJiBkdW1wLmRlcHRoID4gZHVtcC5tYXhEZXB0aCkge1xuXHQgICAgICByZXR1cm4gXCJbb2JqZWN0IEFycmF5XVwiO1xuXHQgICAgfVxuXG5cdCAgICB0aGlzLnVwKCk7XG5cblx0ICAgIHdoaWxlIChpLS0pIHtcblx0ICAgICAgcmV0W2ldID0gdGhpcy5wYXJzZShhcnJbaV0sIHVuZGVmaW5lZCwgc3RhY2spO1xuXHQgICAgfVxuXG5cdCAgICB0aGlzLmRvd24oKTtcblx0ICAgIHJldHVybiBqb2luKFwiW1wiLCByZXQsIFwiXVwiKTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBpc0FycmF5KG9iaikge1xuXHQgICAgcmV0dXJuICgvL05hdGl2ZSBBcnJheXNcblx0ICAgICAgdG9TdHJpbmcuY2FsbChvYmopID09PSBcIltvYmplY3QgQXJyYXldXCIgfHwgLy8gTm9kZUxpc3Qgb2JqZWN0c1xuXHQgICAgICB0eXBlb2Ygb2JqLmxlbmd0aCA9PT0gXCJudW1iZXJcIiAmJiBvYmouaXRlbSAhPT0gdW5kZWZpbmVkICYmIChvYmoubGVuZ3RoID8gb2JqLml0ZW0oMCkgPT09IG9ialswXSA6IG9iai5pdGVtKDApID09PSBudWxsICYmIG9ialswXSA9PT0gdW5kZWZpbmVkKVxuXHQgICAgKTtcblx0ICB9XG5cblx0ICB2YXIgcmVOYW1lID0gL15mdW5jdGlvbiAoXFx3KykvLFxuXHQgICAgICBkdW1wID0ge1xuXHQgICAgLy8gVGhlIG9ialR5cGUgaXMgdXNlZCBtb3N0bHkgaW50ZXJuYWxseSwgeW91IGNhbiBmaXggYSAoY3VzdG9tKSB0eXBlIGluIGFkdmFuY2Vcblx0ICAgIHBhcnNlOiBmdW5jdGlvbiBwYXJzZShvYmosIG9ialR5cGUsIHN0YWNrKSB7XG5cdCAgICAgIHN0YWNrID0gc3RhY2sgfHwgW107XG5cdCAgICAgIHZhciByZXMsXG5cdCAgICAgICAgICBwYXJzZXIsXG5cdCAgICAgICAgICBwYXJzZXJUeXBlLFxuXHQgICAgICAgICAgb2JqSW5kZXggPSBzdGFjay5pbmRleE9mKG9iaik7XG5cblx0ICAgICAgaWYgKG9iakluZGV4ICE9PSAtMSkge1xuXHQgICAgICAgIHJldHVybiBcInJlY3Vyc2lvbihcIi5jb25jYXQob2JqSW5kZXggLSBzdGFjay5sZW5ndGgsIFwiKVwiKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIG9ialR5cGUgPSBvYmpUeXBlIHx8IHRoaXMudHlwZU9mKG9iaik7XG5cdCAgICAgIHBhcnNlciA9IHRoaXMucGFyc2Vyc1tvYmpUeXBlXTtcblx0ICAgICAgcGFyc2VyVHlwZSA9IF90eXBlb2YocGFyc2VyKTtcblxuXHQgICAgICBpZiAocGFyc2VyVHlwZSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICAgICAgc3RhY2sucHVzaChvYmopO1xuXHQgICAgICAgIHJlcyA9IHBhcnNlci5jYWxsKHRoaXMsIG9iaiwgc3RhY2spO1xuXHQgICAgICAgIHN0YWNrLnBvcCgpO1xuXHQgICAgICAgIHJldHVybiByZXM7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gcGFyc2VyVHlwZSA9PT0gXCJzdHJpbmdcIiA/IHBhcnNlciA6IHRoaXMucGFyc2Vycy5lcnJvcjtcblx0ICAgIH0sXG5cdCAgICB0eXBlT2Y6IGZ1bmN0aW9uIHR5cGVPZihvYmopIHtcblx0ICAgICAgdmFyIHR5cGU7XG5cblx0ICAgICAgaWYgKG9iaiA9PT0gbnVsbCkge1xuXHQgICAgICAgIHR5cGUgPSBcIm51bGxcIjtcblx0ICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICAgICAgdHlwZSA9IFwidW5kZWZpbmVkXCI7XG5cdCAgICAgIH0gZWxzZSBpZiAoaXMoXCJyZWdleHBcIiwgb2JqKSkge1xuXHQgICAgICAgIHR5cGUgPSBcInJlZ2V4cFwiO1xuXHQgICAgICB9IGVsc2UgaWYgKGlzKFwiZGF0ZVwiLCBvYmopKSB7XG5cdCAgICAgICAgdHlwZSA9IFwiZGF0ZVwiO1xuXHQgICAgICB9IGVsc2UgaWYgKGlzKFwiZnVuY3Rpb25cIiwgb2JqKSkge1xuXHQgICAgICAgIHR5cGUgPSBcImZ1bmN0aW9uXCI7XG5cdCAgICAgIH0gZWxzZSBpZiAob2JqLnNldEludGVydmFsICE9PSB1bmRlZmluZWQgJiYgb2JqLmRvY3VtZW50ICE9PSB1bmRlZmluZWQgJiYgb2JqLm5vZGVUeXBlID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICB0eXBlID0gXCJ3aW5kb3dcIjtcblx0ICAgICAgfSBlbHNlIGlmIChvYmoubm9kZVR5cGUgPT09IDkpIHtcblx0ICAgICAgICB0eXBlID0gXCJkb2N1bWVudFwiO1xuXHQgICAgICB9IGVsc2UgaWYgKG9iai5ub2RlVHlwZSkge1xuXHQgICAgICAgIHR5cGUgPSBcIm5vZGVcIjtcblx0ICAgICAgfSBlbHNlIGlmIChpc0FycmF5KG9iaikpIHtcblx0ICAgICAgICB0eXBlID0gXCJhcnJheVwiO1xuXHQgICAgICB9IGVsc2UgaWYgKG9iai5jb25zdHJ1Y3RvciA9PT0gRXJyb3IucHJvdG90eXBlLmNvbnN0cnVjdG9yKSB7XG5cdCAgICAgICAgdHlwZSA9IFwiZXJyb3JcIjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0eXBlID0gX3R5cGVvZihvYmopO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIHR5cGU7XG5cdCAgICB9LFxuXHQgICAgc2VwYXJhdG9yOiBmdW5jdGlvbiBzZXBhcmF0b3IoKSB7XG5cdCAgICAgIGlmICh0aGlzLm11bHRpbGluZSkge1xuXHQgICAgICAgIHJldHVybiB0aGlzLkhUTUwgPyBcIjxiciAvPlwiIDogXCJcXG5cIjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gdGhpcy5IVE1MID8gXCImIzE2MDtcIiA6IFwiIFwiO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHQgICAgLy8gRXh0cmEgY2FuIGJlIGEgbnVtYmVyLCBzaG9ydGN1dCBmb3IgaW5jcmVhc2luZy1jYWxsaW5nLWRlY3JlYXNpbmdcblx0ICAgIGluZGVudDogZnVuY3Rpb24gaW5kZW50KGV4dHJhKSB7XG5cdCAgICAgIGlmICghdGhpcy5tdWx0aWxpbmUpIHtcblx0ICAgICAgICByZXR1cm4gXCJcIjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciBjaHIgPSB0aGlzLmluZGVudENoYXI7XG5cblx0ICAgICAgaWYgKHRoaXMuSFRNTCkge1xuXHQgICAgICAgIGNociA9IGNoci5yZXBsYWNlKC9cXHQvZywgXCIgICBcIikucmVwbGFjZSgvIC9nLCBcIiYjMTYwO1wiKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBuZXcgQXJyYXkodGhpcy5kZXB0aCArIChleHRyYSB8fCAwKSkuam9pbihjaHIpO1xuXHQgICAgfSxcblx0ICAgIHVwOiBmdW5jdGlvbiB1cChhKSB7XG5cdCAgICAgIHRoaXMuZGVwdGggKz0gYSB8fCAxO1xuXHQgICAgfSxcblx0ICAgIGRvd246IGZ1bmN0aW9uIGRvd24oYSkge1xuXHQgICAgICB0aGlzLmRlcHRoIC09IGEgfHwgMTtcblx0ICAgIH0sXG5cdCAgICBzZXRQYXJzZXI6IGZ1bmN0aW9uIHNldFBhcnNlcihuYW1lLCBwYXJzZXIpIHtcblx0ICAgICAgdGhpcy5wYXJzZXJzW25hbWVdID0gcGFyc2VyO1xuXHQgICAgfSxcblx0ICAgIC8vIFRoZSBuZXh0IDMgYXJlIGV4cG9zZWQgc28geW91IGNhbiB1c2UgdGhlbVxuXHQgICAgcXVvdGU6IHF1b3RlLFxuXHQgICAgbGl0ZXJhbDogbGl0ZXJhbCxcblx0ICAgIGpvaW46IGpvaW4sXG5cdCAgICBkZXB0aDogMSxcblx0ICAgIG1heERlcHRoOiBjb25maWcubWF4RGVwdGgsXG5cdCAgICAvLyBUaGlzIGlzIHRoZSBsaXN0IG9mIHBhcnNlcnMsIHRvIG1vZGlmeSB0aGVtLCB1c2UgZHVtcC5zZXRQYXJzZXJcblx0ICAgIHBhcnNlcnM6IHtcblx0ICAgICAgd2luZG93OiBcIltXaW5kb3ddXCIsXG5cdCAgICAgIGRvY3VtZW50OiBcIltEb2N1bWVudF1cIixcblx0ICAgICAgZXJyb3I6IGZ1bmN0aW9uIGVycm9yKF9lcnJvcikge1xuXHQgICAgICAgIHJldHVybiBcIkVycm9yKFxcXCJcIiArIF9lcnJvci5tZXNzYWdlICsgXCJcXFwiKVwiO1xuXHQgICAgICB9LFxuXHQgICAgICB1bmtub3duOiBcIltVbmtub3duXVwiLFxuXHQgICAgICBcIm51bGxcIjogXCJudWxsXCIsXG5cdCAgICAgIFwidW5kZWZpbmVkXCI6IFwidW5kZWZpbmVkXCIsXG5cdCAgICAgIFwiZnVuY3Rpb25cIjogZnVuY3Rpb24gX2Z1bmN0aW9uKGZuKSB7XG5cdCAgICAgICAgdmFyIHJldCA9IFwiZnVuY3Rpb25cIixcblx0ICAgICAgICAgICAgLy8gRnVuY3Rpb25zIG5ldmVyIGhhdmUgbmFtZSBpbiBJRVxuXHQgICAgICAgIG5hbWUgPSBcIm5hbWVcIiBpbiBmbiA/IGZuLm5hbWUgOiAocmVOYW1lLmV4ZWMoZm4pIHx8IFtdKVsxXTtcblxuXHQgICAgICAgIGlmIChuYW1lKSB7XG5cdCAgICAgICAgICByZXQgKz0gXCIgXCIgKyBuYW1lO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldCArPSBcIihcIjtcblx0ICAgICAgICByZXQgPSBbcmV0LCBkdW1wLnBhcnNlKGZuLCBcImZ1bmN0aW9uQXJnc1wiKSwgXCIpe1wiXS5qb2luKFwiXCIpO1xuXHQgICAgICAgIHJldHVybiBqb2luKHJldCwgZHVtcC5wYXJzZShmbiwgXCJmdW5jdGlvbkNvZGVcIiksIFwifVwiKTtcblx0ICAgICAgfSxcblx0ICAgICAgYXJyYXk6IGFycmF5LFxuXHQgICAgICBub2RlbGlzdDogYXJyYXksXG5cdCAgICAgIFwiYXJndW1lbnRzXCI6IGFycmF5LFxuXHQgICAgICBvYmplY3Q6IGZ1bmN0aW9uIG9iamVjdChtYXAsIHN0YWNrKSB7XG5cdCAgICAgICAgdmFyIGtleXMsXG5cdCAgICAgICAgICAgIGtleSxcblx0ICAgICAgICAgICAgdmFsLFxuXHQgICAgICAgICAgICBpLFxuXHQgICAgICAgICAgICBub25FbnVtZXJhYmxlUHJvcGVydGllcyxcblx0ICAgICAgICAgICAgcmV0ID0gW107XG5cblx0ICAgICAgICBpZiAoZHVtcC5tYXhEZXB0aCAmJiBkdW1wLmRlcHRoID4gZHVtcC5tYXhEZXB0aCkge1xuXHQgICAgICAgICAgcmV0dXJuIFwiW29iamVjdCBPYmplY3RdXCI7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgZHVtcC51cCgpO1xuXHQgICAgICAgIGtleXMgPSBbXTtcblxuXHQgICAgICAgIGZvciAoa2V5IGluIG1hcCkge1xuXHQgICAgICAgICAga2V5cy5wdXNoKGtleSk7XG5cdCAgICAgICAgfSAvLyBTb21lIHByb3BlcnRpZXMgYXJlIG5vdCBhbHdheXMgZW51bWVyYWJsZSBvbiBFcnJvciBvYmplY3RzLlxuXG5cblx0ICAgICAgICBub25FbnVtZXJhYmxlUHJvcGVydGllcyA9IFtcIm1lc3NhZ2VcIiwgXCJuYW1lXCJdO1xuXG5cdCAgICAgICAgZm9yIChpIGluIG5vbkVudW1lcmFibGVQcm9wZXJ0aWVzKSB7XG5cdCAgICAgICAgICBrZXkgPSBub25FbnVtZXJhYmxlUHJvcGVydGllc1tpXTtcblxuXHQgICAgICAgICAgaWYgKGtleSBpbiBtYXAgJiYgIWluQXJyYXkoa2V5LCBrZXlzKSkge1xuXHQgICAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cblx0ICAgICAgICBrZXlzLnNvcnQoKTtcblxuXHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCBrZXlzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBrZXkgPSBrZXlzW2ldO1xuXHQgICAgICAgICAgdmFsID0gbWFwW2tleV07XG5cdCAgICAgICAgICByZXQucHVzaChkdW1wLnBhcnNlKGtleSwgXCJrZXlcIikgKyBcIjogXCIgKyBkdW1wLnBhcnNlKHZhbCwgdW5kZWZpbmVkLCBzdGFjaykpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGR1bXAuZG93bigpO1xuXHQgICAgICAgIHJldHVybiBqb2luKFwie1wiLCByZXQsIFwifVwiKTtcblx0ICAgICAgfSxcblx0ICAgICAgbm9kZTogZnVuY3Rpb24gbm9kZShfbm9kZSkge1xuXHQgICAgICAgIHZhciBsZW4sXG5cdCAgICAgICAgICAgIGksXG5cdCAgICAgICAgICAgIHZhbCxcblx0ICAgICAgICAgICAgb3BlbiA9IGR1bXAuSFRNTCA/IFwiJmx0O1wiIDogXCI8XCIsXG5cdCAgICAgICAgICAgIGNsb3NlID0gZHVtcC5IVE1MID8gXCImZ3Q7XCIgOiBcIj5cIixcblx0ICAgICAgICAgICAgdGFnID0gX25vZGUubm9kZU5hbWUudG9Mb3dlckNhc2UoKSxcblx0ICAgICAgICAgICAgcmV0ID0gb3BlbiArIHRhZyxcblx0ICAgICAgICAgICAgYXR0cnMgPSBfbm9kZS5hdHRyaWJ1dGVzO1xuXG5cdCAgICAgICAgaWYgKGF0dHJzKSB7XG5cdCAgICAgICAgICBmb3IgKGkgPSAwLCBsZW4gPSBhdHRycy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuXHQgICAgICAgICAgICB2YWwgPSBhdHRyc1tpXS5ub2RlVmFsdWU7IC8vIElFNiBpbmNsdWRlcyBhbGwgYXR0cmlidXRlcyBpbiAuYXR0cmlidXRlcywgZXZlbiBvbmVzIG5vdCBleHBsaWNpdGx5XG5cdCAgICAgICAgICAgIC8vIHNldC4gVGhvc2UgaGF2ZSB2YWx1ZXMgbGlrZSB1bmRlZmluZWQsIG51bGwsIDAsIGZhbHNlLCBcIlwiIG9yXG5cdCAgICAgICAgICAgIC8vIFwiaW5oZXJpdFwiLlxuXG5cdCAgICAgICAgICAgIGlmICh2YWwgJiYgdmFsICE9PSBcImluaGVyaXRcIikge1xuXHQgICAgICAgICAgICAgIHJldCArPSBcIiBcIiArIGF0dHJzW2ldLm5vZGVOYW1lICsgXCI9XCIgKyBkdW1wLnBhcnNlKHZhbCwgXCJhdHRyaWJ1dGVcIik7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cblx0ICAgICAgICByZXQgKz0gY2xvc2U7IC8vIFNob3cgY29udGVudCBvZiBUZXh0Tm9kZSBvciBDREFUQVNlY3Rpb25cblxuXHQgICAgICAgIGlmIChfbm9kZS5ub2RlVHlwZSA9PT0gMyB8fCBfbm9kZS5ub2RlVHlwZSA9PT0gNCkge1xuXHQgICAgICAgICAgcmV0ICs9IF9ub2RlLm5vZGVWYWx1ZTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICByZXR1cm4gcmV0ICsgb3BlbiArIFwiL1wiICsgdGFnICsgY2xvc2U7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIEZ1bmN0aW9uIGNhbGxzIGl0IGludGVybmFsbHksIGl0J3MgdGhlIGFyZ3VtZW50cyBwYXJ0IG9mIHRoZSBmdW5jdGlvblxuXHQgICAgICBmdW5jdGlvbkFyZ3M6IGZ1bmN0aW9uIGZ1bmN0aW9uQXJncyhmbikge1xuXHQgICAgICAgIHZhciBhcmdzLFxuXHQgICAgICAgICAgICBsID0gZm4ubGVuZ3RoO1xuXG5cdCAgICAgICAgaWYgKCFsKSB7XG5cdCAgICAgICAgICByZXR1cm4gXCJcIjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBhcmdzID0gbmV3IEFycmF5KGwpO1xuXG5cdCAgICAgICAgd2hpbGUgKGwtLSkge1xuXHQgICAgICAgICAgLy8gOTcgaXMgJ2EnXG5cdCAgICAgICAgICBhcmdzW2xdID0gU3RyaW5nLmZyb21DaGFyQ29kZSg5NyArIGwpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldHVybiBcIiBcIiArIGFyZ3Muam9pbihcIiwgXCIpICsgXCIgXCI7XG5cdCAgICAgIH0sXG5cdCAgICAgIC8vIE9iamVjdCBjYWxscyBpdCBpbnRlcm5hbGx5LCB0aGUga2V5IHBhcnQgb2YgYW4gaXRlbSBpbiBhIG1hcFxuXHQgICAgICBrZXk6IHF1b3RlLFxuXHQgICAgICAvLyBGdW5jdGlvbiBjYWxscyBpdCBpbnRlcm5hbGx5LCBpdCdzIHRoZSBjb250ZW50IG9mIHRoZSBmdW5jdGlvblxuXHQgICAgICBmdW5jdGlvbkNvZGU6IFwiW2NvZGVdXCIsXG5cdCAgICAgIC8vIE5vZGUgY2FsbHMgaXQgaW50ZXJuYWxseSwgaXQncyBhIGh0bWwgYXR0cmlidXRlIHZhbHVlXG5cdCAgICAgIGF0dHJpYnV0ZTogcXVvdGUsXG5cdCAgICAgIHN0cmluZzogcXVvdGUsXG5cdCAgICAgIGRhdGU6IHF1b3RlLFxuXHQgICAgICByZWdleHA6IGxpdGVyYWwsXG5cdCAgICAgIG51bWJlcjogbGl0ZXJhbCxcblx0ICAgICAgXCJib29sZWFuXCI6IGxpdGVyYWwsXG5cdCAgICAgIHN5bWJvbDogZnVuY3Rpb24gc3ltYm9sKHN5bSkge1xuXHQgICAgICAgIHJldHVybiBzeW0udG9TdHJpbmcoKTtcblx0ICAgICAgfVxuXHQgICAgfSxcblx0ICAgIC8vIElmIHRydWUsIGVudGl0aWVzIGFyZSBlc2NhcGVkICggPCwgPiwgXFx0LCBzcGFjZSBhbmQgXFxuIClcblx0ICAgIEhUTUw6IGZhbHNlLFxuXHQgICAgLy8gSW5kZW50YXRpb24gdW5pdFxuXHQgICAgaW5kZW50Q2hhcjogXCIgIFwiLFxuXHQgICAgLy8gSWYgdHJ1ZSwgaXRlbXMgaW4gYSBjb2xsZWN0aW9uLCBhcmUgc2VwYXJhdGVkIGJ5IGEgXFxuLCBlbHNlIGp1c3QgYSBzcGFjZS5cblx0ICAgIG11bHRpbGluZTogdHJ1ZVxuXHQgIH07XG5cdCAgcmV0dXJuIGR1bXA7XG5cdH0pKCk7XG5cblx0dmFyIFN1aXRlUmVwb3J0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcblx0ICBmdW5jdGlvbiBTdWl0ZVJlcG9ydChuYW1lLCBwYXJlbnRTdWl0ZSkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIFN1aXRlUmVwb3J0KTtcblxuXHQgICAgdGhpcy5uYW1lID0gbmFtZTtcblx0ICAgIHRoaXMuZnVsbE5hbWUgPSBwYXJlbnRTdWl0ZSA/IHBhcmVudFN1aXRlLmZ1bGxOYW1lLmNvbmNhdChuYW1lKSA6IFtdO1xuXHQgICAgdGhpcy50ZXN0cyA9IFtdO1xuXHQgICAgdGhpcy5jaGlsZFN1aXRlcyA9IFtdO1xuXG5cdCAgICBpZiAocGFyZW50U3VpdGUpIHtcblx0ICAgICAgcGFyZW50U3VpdGUucHVzaENoaWxkU3VpdGUodGhpcyk7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgX2NyZWF0ZUNsYXNzKFN1aXRlUmVwb3J0LCBbe1xuXHQgICAga2V5OiBcInN0YXJ0XCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc3RhcnQocmVjb3JkVGltZSkge1xuXHQgICAgICBpZiAocmVjb3JkVGltZSkge1xuXHQgICAgICAgIHRoaXMuX3N0YXJ0VGltZSA9IHBlcmZvcm1hbmNlTm93KCk7XG5cblx0ICAgICAgICBpZiAocGVyZm9ybWFuY2UpIHtcblx0ICAgICAgICAgIHZhciBzdWl0ZUxldmVsID0gdGhpcy5mdWxsTmFtZS5sZW5ndGg7XG5cdCAgICAgICAgICBwZXJmb3JtYW5jZS5tYXJrKFwicXVuaXRfc3VpdGVfXCIuY29uY2F0KHN1aXRlTGV2ZWwsIFwiX3N0YXJ0XCIpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcblx0ICAgICAgICBmdWxsTmFtZTogdGhpcy5mdWxsTmFtZS5zbGljZSgpLFxuXHQgICAgICAgIHRlc3RzOiB0aGlzLnRlc3RzLm1hcChmdW5jdGlvbiAodGVzdCkge1xuXHQgICAgICAgICAgcmV0dXJuIHRlc3Quc3RhcnQoKTtcblx0ICAgICAgICB9KSxcblx0ICAgICAgICBjaGlsZFN1aXRlczogdGhpcy5jaGlsZFN1aXRlcy5tYXAoZnVuY3Rpb24gKHN1aXRlKSB7XG5cdCAgICAgICAgICByZXR1cm4gc3VpdGUuc3RhcnQoKTtcblx0ICAgICAgICB9KSxcblx0ICAgICAgICB0ZXN0Q291bnRzOiB7XG5cdCAgICAgICAgICB0b3RhbDogdGhpcy5nZXRUZXN0Q291bnRzKCkudG90YWxcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImVuZFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGVuZChyZWNvcmRUaW1lKSB7XG5cdCAgICAgIGlmIChyZWNvcmRUaW1lKSB7XG5cdCAgICAgICAgdGhpcy5fZW5kVGltZSA9IHBlcmZvcm1hbmNlTm93KCk7XG5cblx0ICAgICAgICBpZiAocGVyZm9ybWFuY2UpIHtcblx0ICAgICAgICAgIHZhciBzdWl0ZUxldmVsID0gdGhpcy5mdWxsTmFtZS5sZW5ndGg7XG5cdCAgICAgICAgICBwZXJmb3JtYW5jZS5tYXJrKFwicXVuaXRfc3VpdGVfXCIuY29uY2F0KHN1aXRlTGV2ZWwsIFwiX2VuZFwiKSk7XG5cdCAgICAgICAgICB2YXIgc3VpdGVOYW1lID0gdGhpcy5mdWxsTmFtZS5qb2luKFwiIOKAkyBcIik7XG5cdCAgICAgICAgICBtZWFzdXJlKHN1aXRlTGV2ZWwgPT09IDAgPyBcIlFVbml0IFRlc3QgUnVuXCIgOiBcIlFVbml0IFRlc3QgU3VpdGU6IFwiLmNvbmNhdChzdWl0ZU5hbWUpLCBcInF1bml0X3N1aXRlX1wiLmNvbmNhdChzdWl0ZUxldmVsLCBcIl9zdGFydFwiKSwgXCJxdW5pdF9zdWl0ZV9cIi5jb25jYXQoc3VpdGVMZXZlbCwgXCJfZW5kXCIpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcblx0ICAgICAgICBmdWxsTmFtZTogdGhpcy5mdWxsTmFtZS5zbGljZSgpLFxuXHQgICAgICAgIHRlc3RzOiB0aGlzLnRlc3RzLm1hcChmdW5jdGlvbiAodGVzdCkge1xuXHQgICAgICAgICAgcmV0dXJuIHRlc3QuZW5kKCk7XG5cdCAgICAgICAgfSksXG5cdCAgICAgICAgY2hpbGRTdWl0ZXM6IHRoaXMuY2hpbGRTdWl0ZXMubWFwKGZ1bmN0aW9uIChzdWl0ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIHN1aXRlLmVuZCgpO1xuXHQgICAgICAgIH0pLFxuXHQgICAgICAgIHRlc3RDb3VudHM6IHRoaXMuZ2V0VGVzdENvdW50cygpLFxuXHQgICAgICAgIHJ1bnRpbWU6IHRoaXMuZ2V0UnVudGltZSgpLFxuXHQgICAgICAgIHN0YXR1czogdGhpcy5nZXRTdGF0dXMoKVxuXHQgICAgICB9O1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJwdXNoQ2hpbGRTdWl0ZVwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2hDaGlsZFN1aXRlKHN1aXRlKSB7XG5cdCAgICAgIHRoaXMuY2hpbGRTdWl0ZXMucHVzaChzdWl0ZSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInB1c2hUZXN0XCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcHVzaFRlc3QodGVzdCkge1xuXHQgICAgICB0aGlzLnRlc3RzLnB1c2godGVzdCk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImdldFJ1bnRpbWVcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSdW50aW1lKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5fZW5kVGltZSAtIHRoaXMuX3N0YXJ0VGltZTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0VGVzdENvdW50c1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFRlc3RDb3VudHMoKSB7XG5cdCAgICAgIHZhciBjb3VudHMgPSBhcmd1bWVudHMubGVuZ3RoID4gMCAmJiBhcmd1bWVudHNbMF0gIT09IHVuZGVmaW5lZCA/IGFyZ3VtZW50c1swXSA6IHtcblx0ICAgICAgICBwYXNzZWQ6IDAsXG5cdCAgICAgICAgZmFpbGVkOiAwLFxuXHQgICAgICAgIHNraXBwZWQ6IDAsXG5cdCAgICAgICAgdG9kbzogMCxcblx0ICAgICAgICB0b3RhbDogMFxuXHQgICAgICB9O1xuXHQgICAgICBjb3VudHMgPSB0aGlzLnRlc3RzLnJlZHVjZShmdW5jdGlvbiAoY291bnRzLCB0ZXN0KSB7XG5cdCAgICAgICAgaWYgKHRlc3QudmFsaWQpIHtcblx0ICAgICAgICAgIGNvdW50c1t0ZXN0LmdldFN0YXR1cygpXSsrO1xuXHQgICAgICAgICAgY291bnRzLnRvdGFsKys7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0dXJuIGNvdW50cztcblx0ICAgICAgfSwgY291bnRzKTtcblx0ICAgICAgcmV0dXJuIHRoaXMuY2hpbGRTdWl0ZXMucmVkdWNlKGZ1bmN0aW9uIChjb3VudHMsIHN1aXRlKSB7XG5cdCAgICAgICAgcmV0dXJuIHN1aXRlLmdldFRlc3RDb3VudHMoY291bnRzKTtcblx0ICAgICAgfSwgY291bnRzKTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0U3RhdHVzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3RhdHVzKCkge1xuXHQgICAgICB2YXIgX3RoaXMkZ2V0VGVzdENvdW50cyA9IHRoaXMuZ2V0VGVzdENvdW50cygpLFxuXHQgICAgICAgICAgdG90YWwgPSBfdGhpcyRnZXRUZXN0Q291bnRzLnRvdGFsLFxuXHQgICAgICAgICAgZmFpbGVkID0gX3RoaXMkZ2V0VGVzdENvdW50cy5mYWlsZWQsXG5cdCAgICAgICAgICBza2lwcGVkID0gX3RoaXMkZ2V0VGVzdENvdW50cy5za2lwcGVkLFxuXHQgICAgICAgICAgdG9kbyA9IF90aGlzJGdldFRlc3RDb3VudHMudG9kbztcblxuXHQgICAgICBpZiAoZmFpbGVkKSB7XG5cdCAgICAgICAgcmV0dXJuIFwiZmFpbGVkXCI7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgaWYgKHNraXBwZWQgPT09IHRvdGFsKSB7XG5cdCAgICAgICAgICByZXR1cm4gXCJza2lwcGVkXCI7XG5cdCAgICAgICAgfSBlbHNlIGlmICh0b2RvID09PSB0b3RhbCkge1xuXHQgICAgICAgICAgcmV0dXJuIFwidG9kb1wiO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICByZXR1cm4gXCJwYXNzZWRcIjtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XSk7XG5cblx0ICByZXR1cm4gU3VpdGVSZXBvcnQ7XG5cdH0oKTtcblxuXHR2YXIgZm9jdXNlZCA9IGZhbHNlO1xuXHR2YXIgbW9kdWxlU3RhY2sgPSBbXTtcblxuXHRmdW5jdGlvbiBpc1BhcmVudE1vZHVsZUluUXVldWUoKSB7XG5cdCAgdmFyIG1vZHVsZXNJblF1ZXVlID0gY29uZmlnLm1vZHVsZXMubWFwKGZ1bmN0aW9uIChtb2R1bGUpIHtcblx0ICAgIHJldHVybiBtb2R1bGUubW9kdWxlSWQ7XG5cdCAgfSk7XG5cdCAgcmV0dXJuIG1vZHVsZVN0YWNrLnNvbWUoZnVuY3Rpb24gKG1vZHVsZSkge1xuXHQgICAgcmV0dXJuIG1vZHVsZXNJblF1ZXVlLmluY2x1ZGVzKG1vZHVsZS5tb2R1bGVJZCk7XG5cdCAgfSk7XG5cdH1cblxuXHRmdW5jdGlvbiBjcmVhdGVNb2R1bGUobmFtZSwgdGVzdEVudmlyb25tZW50LCBtb2RpZmllcnMpIHtcblx0ICB2YXIgcGFyZW50TW9kdWxlID0gbW9kdWxlU3RhY2subGVuZ3RoID8gbW9kdWxlU3RhY2suc2xpY2UoLTEpWzBdIDogbnVsbDtcblx0ICB2YXIgbW9kdWxlTmFtZSA9IHBhcmVudE1vZHVsZSAhPT0gbnVsbCA/IFtwYXJlbnRNb2R1bGUubmFtZSwgbmFtZV0uam9pbihcIiA+IFwiKSA6IG5hbWU7XG5cdCAgdmFyIHBhcmVudFN1aXRlID0gcGFyZW50TW9kdWxlID8gcGFyZW50TW9kdWxlLnN1aXRlUmVwb3J0IDogZ2xvYmFsU3VpdGU7XG5cdCAgdmFyIHNraXAgPSBwYXJlbnRNb2R1bGUgIT09IG51bGwgJiYgcGFyZW50TW9kdWxlLnNraXAgfHwgbW9kaWZpZXJzLnNraXA7XG5cdCAgdmFyIHRvZG8gPSBwYXJlbnRNb2R1bGUgIT09IG51bGwgJiYgcGFyZW50TW9kdWxlLnRvZG8gfHwgbW9kaWZpZXJzLnRvZG87XG5cdCAgdmFyIG1vZHVsZSA9IHtcblx0ICAgIG5hbWU6IG1vZHVsZU5hbWUsXG5cdCAgICBwYXJlbnRNb2R1bGU6IHBhcmVudE1vZHVsZSxcblx0ICAgIHRlc3RzOiBbXSxcblx0ICAgIG1vZHVsZUlkOiBnZW5lcmF0ZUhhc2gobW9kdWxlTmFtZSksXG5cdCAgICB0ZXN0c1J1bjogMCxcblx0ICAgIHVuc2tpcHBlZFRlc3RzUnVuOiAwLFxuXHQgICAgY2hpbGRNb2R1bGVzOiBbXSxcblx0ICAgIHN1aXRlUmVwb3J0OiBuZXcgU3VpdGVSZXBvcnQobmFtZSwgcGFyZW50U3VpdGUpLFxuXHQgICAgLy8gUGFzcyBhbG9uZyBgc2tpcGAgYW5kIGB0b2RvYCBwcm9wZXJ0aWVzIGZyb20gcGFyZW50IG1vZHVsZSwgaW4gY2FzZVxuXHQgICAgLy8gdGhlcmUgaXMgb25lLCB0byBjaGlsZHMuIEFuZCB1c2Ugb3duIG90aGVyd2lzZS5cblx0ICAgIC8vIFRoaXMgcHJvcGVydHkgd2lsbCBiZSB1c2VkIHRvIG1hcmsgb3duIHRlc3RzIGFuZCB0ZXN0cyBvZiBjaGlsZCBzdWl0ZXNcblx0ICAgIC8vIGFzIGVpdGhlciBgc2tpcHBlZGAgb3IgYHRvZG9gLlxuXHQgICAgc2tpcDogc2tpcCxcblx0ICAgIHRvZG86IHNraXAgPyBmYWxzZSA6IHRvZG9cblx0ICB9O1xuXHQgIHZhciBlbnYgPSB7fTtcblxuXHQgIGlmIChwYXJlbnRNb2R1bGUpIHtcblx0ICAgIHBhcmVudE1vZHVsZS5jaGlsZE1vZHVsZXMucHVzaChtb2R1bGUpO1xuXHQgICAgZXh0ZW5kKGVudiwgcGFyZW50TW9kdWxlLnRlc3RFbnZpcm9ubWVudCk7XG5cdCAgfVxuXG5cdCAgZXh0ZW5kKGVudiwgdGVzdEVudmlyb25tZW50KTtcblx0ICBtb2R1bGUudGVzdEVudmlyb25tZW50ID0gZW52O1xuXHQgIGNvbmZpZy5tb2R1bGVzLnB1c2gobW9kdWxlKTtcblx0ICByZXR1cm4gbW9kdWxlO1xuXHR9XG5cblx0ZnVuY3Rpb24gcHJvY2Vzc01vZHVsZShuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93KSB7XG5cdCAgdmFyIG1vZGlmaWVycyA9IGFyZ3VtZW50cy5sZW5ndGggPiAzICYmIGFyZ3VtZW50c1szXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzNdIDoge307XG5cblx0ICBpZiAob2JqZWN0VHlwZShvcHRpb25zKSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICBleGVjdXRlTm93ID0gb3B0aW9ucztcblx0ICAgIG9wdGlvbnMgPSB1bmRlZmluZWQ7XG5cdCAgfVxuXG5cdCAgdmFyIG1vZHVsZSA9IGNyZWF0ZU1vZHVsZShuYW1lLCBvcHRpb25zLCBtb2RpZmllcnMpOyAvLyBNb3ZlIGFueSBob29rcyB0byBhICdob29rcycgb2JqZWN0XG5cblx0ICB2YXIgdGVzdEVudmlyb25tZW50ID0gbW9kdWxlLnRlc3RFbnZpcm9ubWVudDtcblx0ICB2YXIgaG9va3MgPSBtb2R1bGUuaG9va3MgPSB7fTtcblx0ICBzZXRIb29rRnJvbUVudmlyb25tZW50KGhvb2tzLCB0ZXN0RW52aXJvbm1lbnQsIFwiYmVmb3JlXCIpO1xuXHQgIHNldEhvb2tGcm9tRW52aXJvbm1lbnQoaG9va3MsIHRlc3RFbnZpcm9ubWVudCwgXCJiZWZvcmVFYWNoXCIpO1xuXHQgIHNldEhvb2tGcm9tRW52aXJvbm1lbnQoaG9va3MsIHRlc3RFbnZpcm9ubWVudCwgXCJhZnRlckVhY2hcIik7XG5cdCAgc2V0SG9va0Zyb21FbnZpcm9ubWVudChob29rcywgdGVzdEVudmlyb25tZW50LCBcImFmdGVyXCIpO1xuXHQgIHZhciBtb2R1bGVGbnMgPSB7XG5cdCAgICBiZWZvcmU6IHNldEhvb2tGdW5jdGlvbihtb2R1bGUsIFwiYmVmb3JlXCIpLFxuXHQgICAgYmVmb3JlRWFjaDogc2V0SG9va0Z1bmN0aW9uKG1vZHVsZSwgXCJiZWZvcmVFYWNoXCIpLFxuXHQgICAgYWZ0ZXJFYWNoOiBzZXRIb29rRnVuY3Rpb24obW9kdWxlLCBcImFmdGVyRWFjaFwiKSxcblx0ICAgIGFmdGVyOiBzZXRIb29rRnVuY3Rpb24obW9kdWxlLCBcImFmdGVyXCIpXG5cdCAgfTtcblx0ICB2YXIgY3VycmVudE1vZHVsZSA9IGNvbmZpZy5jdXJyZW50TW9kdWxlO1xuXG5cdCAgaWYgKG9iamVjdFR5cGUoZXhlY3V0ZU5vdykgPT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgbW9kdWxlU3RhY2sucHVzaChtb2R1bGUpO1xuXHQgICAgY29uZmlnLmN1cnJlbnRNb2R1bGUgPSBtb2R1bGU7XG5cdCAgICBleGVjdXRlTm93LmNhbGwobW9kdWxlLnRlc3RFbnZpcm9ubWVudCwgbW9kdWxlRm5zKTtcblx0ICAgIG1vZHVsZVN0YWNrLnBvcCgpO1xuXHQgICAgbW9kdWxlID0gbW9kdWxlLnBhcmVudE1vZHVsZSB8fCBjdXJyZW50TW9kdWxlO1xuXHQgIH1cblxuXHQgIGNvbmZpZy5jdXJyZW50TW9kdWxlID0gbW9kdWxlO1xuXG5cdCAgZnVuY3Rpb24gc2V0SG9va0Zyb21FbnZpcm9ubWVudChob29rcywgZW52aXJvbm1lbnQsIG5hbWUpIHtcblx0ICAgIHZhciBwb3RlbnRpYWxIb29rID0gZW52aXJvbm1lbnRbbmFtZV07XG5cdCAgICBob29rc1tuYW1lXSA9IHR5cGVvZiBwb3RlbnRpYWxIb29rID09PSBcImZ1bmN0aW9uXCIgPyBbcG90ZW50aWFsSG9va10gOiBbXTtcblx0ICAgIGRlbGV0ZSBlbnZpcm9ubWVudFtuYW1lXTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBzZXRIb29rRnVuY3Rpb24obW9kdWxlLCBob29rTmFtZSkge1xuXHQgICAgcmV0dXJuIGZ1bmN0aW9uIHNldEhvb2soY2FsbGJhY2spIHtcblx0ICAgICAgbW9kdWxlLmhvb2tzW2hvb2tOYW1lXS5wdXNoKGNhbGxiYWNrKTtcblx0ICAgIH07XG5cdCAgfVxuXHR9XG5cblx0ZnVuY3Rpb24gbW9kdWxlJDEobmFtZSwgb3B0aW9ucywgZXhlY3V0ZU5vdykge1xuXHQgIGlmIChmb2N1c2VkICYmICFpc1BhcmVudE1vZHVsZUluUXVldWUoKSkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHByb2Nlc3NNb2R1bGUobmFtZSwgb3B0aW9ucywgZXhlY3V0ZU5vdyk7XG5cdH1cblxuXHRtb2R1bGUkMS5vbmx5ID0gZnVuY3Rpb24gKCkge1xuXHQgIGlmICghZm9jdXNlZCkge1xuXHQgICAgY29uZmlnLm1vZHVsZXMubGVuZ3RoID0gMDtcblx0ICAgIGNvbmZpZy5xdWV1ZS5sZW5ndGggPSAwO1xuXHQgIH1cblxuXHQgIHByb2Nlc3NNb2R1bGUuYXBwbHkodm9pZCAwLCBhcmd1bWVudHMpO1xuXHQgIGZvY3VzZWQgPSB0cnVlO1xuXHR9O1xuXG5cdG1vZHVsZSQxLnNraXAgPSBmdW5jdGlvbiAobmFtZSwgb3B0aW9ucywgZXhlY3V0ZU5vdykge1xuXHQgIGlmIChmb2N1c2VkKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgcHJvY2Vzc01vZHVsZShuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93LCB7XG5cdCAgICBza2lwOiB0cnVlXG5cdCAgfSk7XG5cdH07XG5cblx0bW9kdWxlJDEudG9kbyA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93KSB7XG5cdCAgaWYgKGZvY3VzZWQpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICBwcm9jZXNzTW9kdWxlKG5hbWUsIG9wdGlvbnMsIGV4ZWN1dGVOb3csIHtcblx0ICAgIHRvZG86IHRydWVcblx0ICB9KTtcblx0fTtcblxuXHR2YXIgTElTVEVORVJTID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblx0dmFyIFNVUFBPUlRFRF9FVkVOVFMgPSBbXCJydW5TdGFydFwiLCBcInN1aXRlU3RhcnRcIiwgXCJ0ZXN0U3RhcnRcIiwgXCJhc3NlcnRpb25cIiwgXCJ0ZXN0RW5kXCIsIFwic3VpdGVFbmRcIiwgXCJydW5FbmRcIl07XG5cdC8qKlxuXHQgKiBFbWl0cyBhbiBldmVudCB3aXRoIHRoZSBzcGVjaWZpZWQgZGF0YSB0byBhbGwgY3VycmVudGx5IHJlZ2lzdGVyZWQgbGlzdGVuZXJzLlxuXHQgKiBDYWxsYmFja3Mgd2lsbCBmaXJlIGluIHRoZSBvcmRlciBpbiB3aGljaCB0aGV5IGFyZSByZWdpc3RlcmVkIChGSUZPKS4gVGhpc1xuXHQgKiBmdW5jdGlvbiBpcyBub3QgZXhwb3NlZCBwdWJsaWNseTsgaXQgaXMgdXNlZCBieSBRVW5pdCBpbnRlcm5hbHMgdG8gZW1pdFxuXHQgKiBsb2dnaW5nIGV2ZW50cy5cblx0ICpcblx0ICogQHByaXZhdGVcblx0ICogQG1ldGhvZCBlbWl0XG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWVcblx0ICogQHBhcmFtIHtPYmplY3R9IGRhdGFcblx0ICogQHJldHVybiB7Vm9pZH1cblx0ICovXG5cblx0ZnVuY3Rpb24gZW1pdChldmVudE5hbWUsIGRhdGEpIHtcblx0ICBpZiAob2JqZWN0VHlwZShldmVudE5hbWUpICE9PSBcInN0cmluZ1wiKSB7XG5cdCAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiZXZlbnROYW1lIG11c3QgYmUgYSBzdHJpbmcgd2hlbiBlbWl0dGluZyBhbiBldmVudFwiKTtcblx0ICB9IC8vIENsb25lIHRoZSBjYWxsYmFja3MgaW4gY2FzZSBvbmUgb2YgdGhlbSByZWdpc3RlcnMgYSBuZXcgY2FsbGJhY2tcblxuXG5cdCAgdmFyIG9yaWdpbmFsQ2FsbGJhY2tzID0gTElTVEVORVJTW2V2ZW50TmFtZV07XG5cdCAgdmFyIGNhbGxiYWNrcyA9IG9yaWdpbmFsQ2FsbGJhY2tzID8gX3RvQ29uc3VtYWJsZUFycmF5KG9yaWdpbmFsQ2FsbGJhY2tzKSA6IFtdO1xuXG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBjYWxsYmFja3MubGVuZ3RoOyBpKyspIHtcblx0ICAgIGNhbGxiYWNrc1tpXShkYXRhKTtcblx0ICB9XG5cdH1cblx0LyoqXG5cdCAqIFJlZ2lzdGVycyBhIGNhbGxiYWNrIGFzIGEgbGlzdGVuZXIgdG8gdGhlIHNwZWNpZmllZCBldmVudC5cblx0ICpcblx0ICogQHB1YmxpY1xuXHQgKiBAbWV0aG9kIG9uXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBldmVudE5hbWVcblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tcblx0ICogQHJldHVybiB7Vm9pZH1cblx0ICovXG5cblx0ZnVuY3Rpb24gb24oZXZlbnROYW1lLCBjYWxsYmFjaykge1xuXHQgIGlmIChvYmplY3RUeXBlKGV2ZW50TmFtZSkgIT09IFwic3RyaW5nXCIpIHtcblx0ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJldmVudE5hbWUgbXVzdCBiZSBhIHN0cmluZyB3aGVuIHJlZ2lzdGVyaW5nIGEgbGlzdGVuZXJcIik7XG5cdCAgfSBlbHNlIGlmICghaW5BcnJheShldmVudE5hbWUsIFNVUFBPUlRFRF9FVkVOVFMpKSB7XG5cdCAgICB2YXIgZXZlbnRzID0gU1VQUE9SVEVEX0VWRU5UUy5qb2luKFwiLCBcIik7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoXCJcXFwiXCIuY29uY2F0KGV2ZW50TmFtZSwgXCJcXFwiIGlzIG5vdCBhIHZhbGlkIGV2ZW50OyBtdXN0IGJlIG9uZSBvZjogXCIpLmNvbmNhdChldmVudHMsIFwiLlwiKSk7XG5cdCAgfSBlbHNlIGlmIChvYmplY3RUeXBlKGNhbGxiYWNrKSAhPT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiY2FsbGJhY2sgbXVzdCBiZSBhIGZ1bmN0aW9uIHdoZW4gcmVnaXN0ZXJpbmcgYSBsaXN0ZW5lclwiKTtcblx0ICB9XG5cblx0ICBpZiAoIUxJU1RFTkVSU1tldmVudE5hbWVdKSB7XG5cdCAgICBMSVNURU5FUlNbZXZlbnROYW1lXSA9IFtdO1xuXHQgIH0gLy8gRG9uJ3QgcmVnaXN0ZXIgdGhlIHNhbWUgY2FsbGJhY2sgbW9yZSB0aGFuIG9uY2VcblxuXG5cdCAgaWYgKCFpbkFycmF5KGNhbGxiYWNrLCBMSVNURU5FUlNbZXZlbnROYW1lXSkpIHtcblx0ICAgIExJU1RFTkVSU1tldmVudE5hbWVdLnB1c2goY2FsbGJhY2spO1xuXHQgIH1cblx0fVxuXG5cdHZhciBjb21tb25qc0dsb2JhbCA9IHR5cGVvZiBnbG9iYWxUaGlzICE9PSAndW5kZWZpbmVkJyA/IGdsb2JhbFRoaXMgOiB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHR5cGVvZiBnbG9iYWwgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsIDogdHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnID8gc2VsZiA6IHt9O1xuXG5cdGZ1bmN0aW9uIGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZuLCBiYXNlZGlyLCBtb2R1bGUpIHtcblx0XHRyZXR1cm4gbW9kdWxlID0ge1xuXHRcdCAgcGF0aDogYmFzZWRpcixcblx0XHQgIGV4cG9ydHM6IHt9LFxuXHRcdCAgcmVxdWlyZTogZnVuY3Rpb24gKHBhdGgsIGJhc2UpIHtcblx0ICAgICAgcmV0dXJuIGNvbW1vbmpzUmVxdWlyZShwYXRoLCAoYmFzZSA9PT0gdW5kZWZpbmVkIHx8IGJhc2UgPT09IG51bGwpID8gbW9kdWxlLnBhdGggOiBiYXNlKTtcblx0ICAgIH1cblx0XHR9LCBmbihtb2R1bGUsIG1vZHVsZS5leHBvcnRzKSwgbW9kdWxlLmV4cG9ydHM7XG5cdH1cblxuXHRmdW5jdGlvbiBjb21tb25qc1JlcXVpcmUgKCkge1xuXHRcdHRocm93IG5ldyBFcnJvcignRHluYW1pYyByZXF1aXJlcyBhcmUgbm90IGN1cnJlbnRseSBzdXBwb3J0ZWQgYnkgQHJvbGx1cC9wbHVnaW4tY29tbW9uanMnKTtcblx0fVxuXG5cdHZhciBlczZQcm9taXNlID0gY3JlYXRlQ29tbW9uanNNb2R1bGUoZnVuY3Rpb24gKG1vZHVsZSwgZXhwb3J0cykge1xuXHQgIC8qIVxuXHQgICAqIEBvdmVydmlldyBlczYtcHJvbWlzZSAtIGEgdGlueSBpbXBsZW1lbnRhdGlvbiBvZiBQcm9taXNlcy9BKy5cblx0ICAgKiBAY29weXJpZ2h0IENvcHlyaWdodCAoYykgMjAxNCBZZWh1ZGEgS2F0eiwgVG9tIERhbGUsIFN0ZWZhbiBQZW5uZXIgYW5kIGNvbnRyaWJ1dG9ycyAoQ29udmVyc2lvbiB0byBFUzYgQVBJIGJ5IEpha2UgQXJjaGliYWxkKVxuXHQgICAqIEBsaWNlbnNlICAgTGljZW5zZWQgdW5kZXIgTUlUIGxpY2Vuc2Vcblx0ICAgKiAgICAgICAgICAgIFNlZSBodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vc3RlZmFucGVubmVyL2VzNi1wcm9taXNlL21hc3Rlci9MSUNFTlNFXG5cdCAgICogQHZlcnNpb24gICB2NC4yLjgrMWU2OGRjZTZcblx0ICAgKi9cblx0ICAoZnVuY3Rpb24gKGdsb2JhbCwgZmFjdG9yeSkge1xuXHQgICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpIDtcblx0ICB9KShjb21tb25qc0dsb2JhbCwgZnVuY3Rpb24gKCkge1xuXG5cdCAgICBmdW5jdGlvbiBvYmplY3RPckZ1bmN0aW9uKHgpIHtcblx0ICAgICAgdmFyIHR5cGUgPSB0eXBlb2YgeDtcblx0ICAgICAgcmV0dXJuIHggIT09IG51bGwgJiYgKHR5cGUgPT09ICdvYmplY3QnIHx8IHR5cGUgPT09ICdmdW5jdGlvbicpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBpc0Z1bmN0aW9uKHgpIHtcblx0ICAgICAgcmV0dXJuIHR5cGVvZiB4ID09PSAnZnVuY3Rpb24nO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgX2lzQXJyYXkgPSB2b2lkIDA7XG5cblx0ICAgIGlmIChBcnJheS5pc0FycmF5KSB7XG5cdCAgICAgIF9pc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIF9pc0FycmF5ID0gZnVuY3Rpb24gKHgpIHtcblx0ICAgICAgICByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKHgpID09PSAnW29iamVjdCBBcnJheV0nO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXG5cdCAgICB2YXIgaXNBcnJheSA9IF9pc0FycmF5O1xuXHQgICAgdmFyIGxlbiA9IDA7XG5cdCAgICB2YXIgdmVydHhOZXh0ID0gdm9pZCAwO1xuXHQgICAgdmFyIGN1c3RvbVNjaGVkdWxlckZuID0gdm9pZCAwO1xuXG5cdCAgICB2YXIgYXNhcCA9IGZ1bmN0aW9uIGFzYXAoY2FsbGJhY2ssIGFyZykge1xuXHQgICAgICBxdWV1ZVtsZW5dID0gY2FsbGJhY2s7XG5cdCAgICAgIHF1ZXVlW2xlbiArIDFdID0gYXJnO1xuXHQgICAgICBsZW4gKz0gMjtcblxuXHQgICAgICBpZiAobGVuID09PSAyKSB7XG5cdCAgICAgICAgLy8gSWYgbGVuIGlzIDIsIHRoYXQgbWVhbnMgdGhhdCB3ZSBuZWVkIHRvIHNjaGVkdWxlIGFuIGFzeW5jIGZsdXNoLlxuXHQgICAgICAgIC8vIElmIGFkZGl0aW9uYWwgY2FsbGJhY2tzIGFyZSBxdWV1ZWQgYmVmb3JlIHRoZSBxdWV1ZSBpcyBmbHVzaGVkLCB0aGV5XG5cdCAgICAgICAgLy8gd2lsbCBiZSBwcm9jZXNzZWQgYnkgdGhpcyBmbHVzaCB0aGF0IHdlIGFyZSBzY2hlZHVsaW5nLlxuXHQgICAgICAgIGlmIChjdXN0b21TY2hlZHVsZXJGbikge1xuXHQgICAgICAgICAgY3VzdG9tU2NoZWR1bGVyRm4oZmx1c2gpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBzY2hlZHVsZUZsdXNoKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICBmdW5jdGlvbiBzZXRTY2hlZHVsZXIoc2NoZWR1bGVGbikge1xuXHQgICAgICBjdXN0b21TY2hlZHVsZXJGbiA9IHNjaGVkdWxlRm47XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHNldEFzYXAoYXNhcEZuKSB7XG5cdCAgICAgIGFzYXAgPSBhc2FwRm47XG5cdCAgICB9XG5cblx0ICAgIHZhciBicm93c2VyV2luZG93ID0gdHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgPyB3aW5kb3cgOiB1bmRlZmluZWQ7XG5cdCAgICB2YXIgYnJvd3Nlckdsb2JhbCA9IGJyb3dzZXJXaW5kb3cgfHwge307XG5cdCAgICB2YXIgQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIgPSBicm93c2VyR2xvYmFsLk11dGF0aW9uT2JzZXJ2ZXIgfHwgYnJvd3Nlckdsb2JhbC5XZWJLaXRNdXRhdGlvbk9ic2VydmVyO1xuXHQgICAgdmFyIGlzTm9kZSA9IHR5cGVvZiBzZWxmID09PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgcHJvY2VzcyAhPT0gJ3VuZGVmaW5lZCcgJiYge30udG9TdHJpbmcuY2FsbChwcm9jZXNzKSA9PT0gJ1tvYmplY3QgcHJvY2Vzc10nOyAvLyB0ZXN0IGZvciB3ZWIgd29ya2VyIGJ1dCBub3QgaW4gSUUxMFxuXG5cdCAgICB2YXIgaXNXb3JrZXIgPSB0eXBlb2YgVWludDhDbGFtcGVkQXJyYXkgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBpbXBvcnRTY3JpcHRzICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YgTWVzc2FnZUNoYW5uZWwgIT09ICd1bmRlZmluZWQnOyAvLyBub2RlXG5cblx0ICAgIGZ1bmN0aW9uIHVzZU5leHRUaWNrKCkge1xuXHQgICAgICAvLyBub2RlIHZlcnNpb24gMC4xMC54IGRpc3BsYXlzIGEgZGVwcmVjYXRpb24gd2FybmluZyB3aGVuIG5leHRUaWNrIGlzIHVzZWQgcmVjdXJzaXZlbHlcblx0ICAgICAgLy8gc2VlIGh0dHBzOi8vZ2l0aHViLmNvbS9jdWpvanMvd2hlbi9pc3N1ZXMvNDEwIGZvciBkZXRhaWxzXG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHByb2Nlc3MubmV4dFRpY2soZmx1c2gpO1xuXHQgICAgICB9O1xuXHQgICAgfSAvLyB2ZXJ0eFxuXG5cblx0ICAgIGZ1bmN0aW9uIHVzZVZlcnR4VGltZXIoKSB7XG5cdCAgICAgIGlmICh0eXBlb2YgdmVydHhOZXh0ICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICB2ZXJ0eE5leHQoZmx1c2gpO1xuXHQgICAgICAgIH07XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gdXNlU2V0VGltZW91dCgpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiB1c2VNdXRhdGlvbk9ic2VydmVyKCkge1xuXHQgICAgICB2YXIgaXRlcmF0aW9ucyA9IDA7XG5cdCAgICAgIHZhciBvYnNlcnZlciA9IG5ldyBCcm93c2VyTXV0YXRpb25PYnNlcnZlcihmbHVzaCk7XG5cdCAgICAgIHZhciBub2RlID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoJycpO1xuXHQgICAgICBvYnNlcnZlci5vYnNlcnZlKG5vZGUsIHtcblx0ICAgICAgICBjaGFyYWN0ZXJEYXRhOiB0cnVlXG5cdCAgICAgIH0pO1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIG5vZGUuZGF0YSA9IGl0ZXJhdGlvbnMgPSArK2l0ZXJhdGlvbnMgJSAyO1xuXHQgICAgICB9O1xuXHQgICAgfSAvLyB3ZWIgd29ya2VyXG5cblxuXHQgICAgZnVuY3Rpb24gdXNlTWVzc2FnZUNoYW5uZWwoKSB7XG5cdCAgICAgIHZhciBjaGFubmVsID0gbmV3IE1lc3NhZ2VDaGFubmVsKCk7XG5cdCAgICAgIGNoYW5uZWwucG9ydDEub25tZXNzYWdlID0gZmx1c2g7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIGNoYW5uZWwucG9ydDIucG9zdE1lc3NhZ2UoMCk7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHVzZVNldFRpbWVvdXQoKSB7XG5cdCAgICAgIC8vIFN0b3JlIHNldFRpbWVvdXQgcmVmZXJlbmNlIHNvIGVzNi1wcm9taXNlIHdpbGwgYmUgdW5hZmZlY3RlZCBieVxuXHQgICAgICAvLyBvdGhlciBjb2RlIG1vZGlmeWluZyBzZXRUaW1lb3V0IChsaWtlIHNpbm9uLnVzZUZha2VUaW1lcnMoKSlcblx0ICAgICAgdmFyIGdsb2JhbFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiBnbG9iYWxTZXRUaW1lb3V0KGZsdXNoLCAxKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblxuXHQgICAgdmFyIHF1ZXVlID0gbmV3IEFycmF5KDEwMDApO1xuXG5cdCAgICBmdW5jdGlvbiBmbHVzaCgpIHtcblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkgKz0gMikge1xuXHQgICAgICAgIHZhciBjYWxsYmFjayA9IHF1ZXVlW2ldO1xuXHQgICAgICAgIHZhciBhcmcgPSBxdWV1ZVtpICsgMV07XG5cdCAgICAgICAgY2FsbGJhY2soYXJnKTtcblx0ICAgICAgICBxdWV1ZVtpXSA9IHVuZGVmaW5lZDtcblx0ICAgICAgICBxdWV1ZVtpICsgMV0gPSB1bmRlZmluZWQ7XG5cdCAgICAgIH1cblxuXHQgICAgICBsZW4gPSAwO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBhdHRlbXB0VmVydHgoKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgdmFyIHZlcnR4ID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKS5yZXF1aXJlKCd2ZXJ0eCcpO1xuXG5cdCAgICAgICAgdmVydHhOZXh0ID0gdmVydHgucnVuT25Mb29wIHx8IHZlcnR4LnJ1bk9uQ29udGV4dDtcblx0ICAgICAgICByZXR1cm4gdXNlVmVydHhUaW1lcigpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgcmV0dXJuIHVzZVNldFRpbWVvdXQoKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICB2YXIgc2NoZWR1bGVGbHVzaCA9IHZvaWQgMDsgLy8gRGVjaWRlIHdoYXQgYXN5bmMgbWV0aG9kIHRvIHVzZSB0byB0cmlnZ2VyaW5nIHByb2Nlc3Npbmcgb2YgcXVldWVkIGNhbGxiYWNrczpcblxuXHQgICAgaWYgKGlzTm9kZSkge1xuXHQgICAgICBzY2hlZHVsZUZsdXNoID0gdXNlTmV4dFRpY2soKTtcblx0ICAgIH0gZWxzZSBpZiAoQnJvd3Nlck11dGF0aW9uT2JzZXJ2ZXIpIHtcblx0ICAgICAgc2NoZWR1bGVGbHVzaCA9IHVzZU11dGF0aW9uT2JzZXJ2ZXIoKTtcblx0ICAgIH0gZWxzZSBpZiAoaXNXb3JrZXIpIHtcblx0ICAgICAgc2NoZWR1bGVGbHVzaCA9IHVzZU1lc3NhZ2VDaGFubmVsKCk7XG5cdCAgICB9IGVsc2UgaWYgKGJyb3dzZXJXaW5kb3cgPT09IHVuZGVmaW5lZCAmJiB0eXBlb2YgY29tbW9uanNSZXF1aXJlID09PSAnZnVuY3Rpb24nKSB7XG5cdCAgICAgIHNjaGVkdWxlRmx1c2ggPSBhdHRlbXB0VmVydHgoKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHNjaGVkdWxlRmx1c2ggPSB1c2VTZXRUaW1lb3V0KCk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHRoZW4ob25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcblx0ICAgICAgdmFyIHBhcmVudCA9IHRoaXM7XG5cdCAgICAgIHZhciBjaGlsZCA9IG5ldyB0aGlzLmNvbnN0cnVjdG9yKG5vb3ApO1xuXG5cdCAgICAgIGlmIChjaGlsZFtQUk9NSVNFX0lEXSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgbWFrZVByb21pc2UoY2hpbGQpO1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIF9zdGF0ZSA9IHBhcmVudC5fc3RhdGU7XG5cblx0ICAgICAgaWYgKF9zdGF0ZSkge1xuXHQgICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3VtZW50c1tfc3RhdGUgLSAxXTtcblx0ICAgICAgICBhc2FwKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHJldHVybiBpbnZva2VDYWxsYmFjayhfc3RhdGUsIGNoaWxkLCBjYWxsYmFjaywgcGFyZW50Ll9yZXN1bHQpO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHN1YnNjcmliZShwYXJlbnQsIGNoaWxkLCBvbkZ1bGZpbGxtZW50LCBvblJlamVjdGlvbik7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gY2hpbGQ7XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICAgYFByb21pc2UucmVzb2x2ZWAgcmV0dXJucyBhIHByb21pc2UgdGhhdCB3aWxsIGJlY29tZSByZXNvbHZlZCB3aXRoIHRoZVxuXHQgICAgICBwYXNzZWQgYHZhbHVlYC4gSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuXHQgICAgICAgIHJlc29sdmUoMSk7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG5cdCAgICAgICAgLy8gdmFsdWUgPT09IDFcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZXNvbHZlKDEpO1xuXHQgICAgXG5cdCAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSl7XG5cdCAgICAgICAgLy8gdmFsdWUgPT09IDFcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEBtZXRob2QgcmVzb2x2ZVxuXHQgICAgICBAc3RhdGljXG5cdCAgICAgIEBwYXJhbSB7QW55fSB2YWx1ZSB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVzb2x2ZWQgd2l0aFxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIGZ1bGZpbGxlZCB3aXRoIHRoZSBnaXZlblxuXHQgICAgICBgdmFsdWVgXG5cdCAgICAqL1xuXG5cblx0ICAgIGZ1bmN0aW9uIHJlc29sdmUkMShvYmplY3QpIHtcblx0ICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cblx0ICAgICAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuXHQgICAgICBpZiAob2JqZWN0ICYmIHR5cGVvZiBvYmplY3QgPT09ICdvYmplY3QnICYmIG9iamVjdC5jb25zdHJ1Y3RvciA9PT0gQ29uc3RydWN0b3IpIHtcblx0ICAgICAgICByZXR1cm4gb2JqZWN0O1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIHByb21pc2UgPSBuZXcgQ29uc3RydWN0b3Iobm9vcCk7XG5cdCAgICAgIHJlc29sdmUocHJvbWlzZSwgb2JqZWN0KTtcblx0ICAgICAgcmV0dXJuIHByb21pc2U7XG5cdCAgICB9XG5cblx0ICAgIHZhciBQUk9NSVNFX0lEID0gTWF0aC5yYW5kb20oKS50b1N0cmluZygzNikuc3Vic3RyaW5nKDIpO1xuXG5cdCAgICBmdW5jdGlvbiBub29wKCkge31cblxuXHQgICAgdmFyIFBFTkRJTkcgPSB2b2lkIDA7XG5cdCAgICB2YXIgRlVMRklMTEVEID0gMTtcblx0ICAgIHZhciBSRUpFQ1RFRCA9IDI7XG5cblx0ICAgIGZ1bmN0aW9uIHNlbGZGdWxmaWxsbWVudCgpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoXCJZb3UgY2Fubm90IHJlc29sdmUgYSBwcm9taXNlIHdpdGggaXRzZWxmXCIpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBjYW5ub3RSZXR1cm5Pd24oKSB7XG5cdCAgICAgIHJldHVybiBuZXcgVHlwZUVycm9yKCdBIHByb21pc2VzIGNhbGxiYWNrIGNhbm5vdCByZXR1cm4gdGhhdCBzYW1lIHByb21pc2UuJyk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHRyeVRoZW4odGhlbiQkMSwgdmFsdWUsIGZ1bGZpbGxtZW50SGFuZGxlciwgcmVqZWN0aW9uSGFuZGxlcikge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHRoZW4kJDEuY2FsbCh2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKTtcblx0ICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgIHJldHVybiBlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGhhbmRsZUZvcmVpZ25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSwgdGhlbiQkMSkge1xuXHQgICAgICBhc2FwKGZ1bmN0aW9uIChwcm9taXNlKSB7XG5cdCAgICAgICAgdmFyIHNlYWxlZCA9IGZhbHNlO1xuXHQgICAgICAgIHZhciBlcnJvciA9IHRyeVRoZW4odGhlbiQkMSwgdGhlbmFibGUsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgaWYgKHNlYWxlZCkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHNlYWxlZCA9IHRydWU7XG5cblx0ICAgICAgICAgIGlmICh0aGVuYWJsZSAhPT0gdmFsdWUpIHtcblx0ICAgICAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgICBpZiAoc2VhbGVkKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgc2VhbGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHJlamVjdChwcm9taXNlLCByZWFzb24pO1xuXHQgICAgICAgIH0sICdTZXR0bGU6ICcgKyAocHJvbWlzZS5fbGFiZWwgfHwgJyB1bmtub3duIHByb21pc2UnKSk7XG5cblx0ICAgICAgICBpZiAoIXNlYWxlZCAmJiBlcnJvcikge1xuXHQgICAgICAgICAgc2VhbGVkID0gdHJ1ZTtcblx0ICAgICAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBwcm9taXNlKTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gaGFuZGxlT3duVGhlbmFibGUocHJvbWlzZSwgdGhlbmFibGUpIHtcblx0ICAgICAgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gRlVMRklMTEVEKSB7XG5cdCAgICAgICAgZnVsZmlsbChwcm9taXNlLCB0aGVuYWJsZS5fcmVzdWx0KTtcblx0ICAgICAgfSBlbHNlIGlmICh0aGVuYWJsZS5fc3RhdGUgPT09IFJFSkVDVEVEKSB7XG5cdCAgICAgICAgcmVqZWN0KHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHN1YnNjcmliZSh0aGVuYWJsZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgICByZXR1cm4gcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlLCB0aGVuJCQxKSB7XG5cdCAgICAgIGlmIChtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yID09PSBwcm9taXNlLmNvbnN0cnVjdG9yICYmIHRoZW4kJDEgPT09IHRoZW4gJiYgbWF5YmVUaGVuYWJsZS5jb25zdHJ1Y3Rvci5yZXNvbHZlID09PSByZXNvbHZlJDEpIHtcblx0ICAgICAgICBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCBtYXliZVRoZW5hYmxlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBpZiAodGhlbiQkMSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgICBmdWxmaWxsKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoaXNGdW5jdGlvbih0aGVuJCQxKSkge1xuXHQgICAgICAgICAgaGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBmdWxmaWxsKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiByZXNvbHZlKHByb21pc2UsIHZhbHVlKSB7XG5cdCAgICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuXHQgICAgICAgIHJlamVjdChwcm9taXNlLCBzZWxmRnVsZmlsbG1lbnQoKSk7XG5cdCAgICAgIH0gZWxzZSBpZiAob2JqZWN0T3JGdW5jdGlvbih2YWx1ZSkpIHtcblx0ICAgICAgICB2YXIgdGhlbiQkMSA9IHZvaWQgMDtcblxuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICB0aGVuJCQxID0gdmFsdWUudGhlbjtcblx0ICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuXHQgICAgICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIHZhbHVlLCB0aGVuJCQxKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBmdWxmaWxsKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBwdWJsaXNoUmVqZWN0aW9uKHByb21pc2UpIHtcblx0ICAgICAgaWYgKHByb21pc2UuX29uZXJyb3IpIHtcblx0ICAgICAgICBwcm9taXNlLl9vbmVycm9yKHByb21pc2UuX3Jlc3VsdCk7XG5cdCAgICAgIH1cblxuXHQgICAgICBwdWJsaXNoKHByb21pc2UpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBmdWxmaWxsKHByb21pc2UsIHZhbHVlKSB7XG5cdCAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHByb21pc2UuX3Jlc3VsdCA9IHZhbHVlO1xuXHQgICAgICBwcm9taXNlLl9zdGF0ZSA9IEZVTEZJTExFRDtcblxuXHQgICAgICBpZiAocHJvbWlzZS5fc3Vic2NyaWJlcnMubGVuZ3RoICE9PSAwKSB7XG5cdCAgICAgICAgYXNhcChwdWJsaXNoLCBwcm9taXNlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiByZWplY3QocHJvbWlzZSwgcmVhc29uKSB7XG5cdCAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSAhPT0gUEVORElORykge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHByb21pc2UuX3N0YXRlID0gUkVKRUNURUQ7XG5cdCAgICAgIHByb21pc2UuX3Jlc3VsdCA9IHJlYXNvbjtcblx0ICAgICAgYXNhcChwdWJsaXNoUmVqZWN0aW9uLCBwcm9taXNlKTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKSB7XG5cdCAgICAgIHZhciBfc3Vic2NyaWJlcnMgPSBwYXJlbnQuX3N1YnNjcmliZXJzO1xuXHQgICAgICB2YXIgbGVuZ3RoID0gX3N1YnNjcmliZXJzLmxlbmd0aDtcblx0ICAgICAgcGFyZW50Ll9vbmVycm9yID0gbnVsbDtcblx0ICAgICAgX3N1YnNjcmliZXJzW2xlbmd0aF0gPSBjaGlsZDtcblx0ICAgICAgX3N1YnNjcmliZXJzW2xlbmd0aCArIEZVTEZJTExFRF0gPSBvbkZ1bGZpbGxtZW50O1xuXHQgICAgICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgUkVKRUNURURdID0gb25SZWplY3Rpb247XG5cblx0ICAgICAgaWYgKGxlbmd0aCA9PT0gMCAmJiBwYXJlbnQuX3N0YXRlKSB7XG5cdCAgICAgICAgYXNhcChwdWJsaXNoLCBwYXJlbnQpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHB1Ymxpc2gocHJvbWlzZSkge1xuXHQgICAgICB2YXIgc3Vic2NyaWJlcnMgPSBwcm9taXNlLl9zdWJzY3JpYmVycztcblx0ICAgICAgdmFyIHNldHRsZWQgPSBwcm9taXNlLl9zdGF0ZTtcblxuXHQgICAgICBpZiAoc3Vic2NyaWJlcnMubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIGNoaWxkID0gdm9pZCAwLFxuXHQgICAgICAgICAgY2FsbGJhY2sgPSB2b2lkIDAsXG5cdCAgICAgICAgICBkZXRhaWwgPSBwcm9taXNlLl9yZXN1bHQ7XG5cblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdWJzY3JpYmVycy5sZW5ndGg7IGkgKz0gMykge1xuXHQgICAgICAgIGNoaWxkID0gc3Vic2NyaWJlcnNbaV07XG5cdCAgICAgICAgY2FsbGJhY2sgPSBzdWJzY3JpYmVyc1tpICsgc2V0dGxlZF07XG5cblx0ICAgICAgICBpZiAoY2hpbGQpIHtcblx0ICAgICAgICAgIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIGNoaWxkLCBjYWxsYmFjaywgZGV0YWlsKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgY2FsbGJhY2soZGV0YWlsKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICBwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggPSAwO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBpbnZva2VDYWxsYmFjayhzZXR0bGVkLCBwcm9taXNlLCBjYWxsYmFjaywgZGV0YWlsKSB7XG5cdCAgICAgIHZhciBoYXNDYWxsYmFjayA9IGlzRnVuY3Rpb24oY2FsbGJhY2spLFxuXHQgICAgICAgICAgdmFsdWUgPSB2b2lkIDAsXG5cdCAgICAgICAgICBlcnJvciA9IHZvaWQgMCxcblx0ICAgICAgICAgIHN1Y2NlZWRlZCA9IHRydWU7XG5cblx0ICAgICAgaWYgKGhhc0NhbGxiYWNrKSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIHZhbHVlID0gY2FsbGJhY2soZGV0YWlsKTtcblx0ICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICBzdWNjZWVkZWQgPSBmYWxzZTtcblx0ICAgICAgICAgIGVycm9yID0gZTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAocHJvbWlzZSA9PT0gdmFsdWUpIHtcblx0ICAgICAgICAgIHJlamVjdChwcm9taXNlLCBjYW5ub3RSZXR1cm5Pd24oKSk7XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHZhbHVlID0gZGV0YWlsO1xuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSA7IGVsc2UgaWYgKGhhc0NhbGxiYWNrICYmIHN1Y2NlZWRlZCkge1xuXHQgICAgICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICB9IGVsc2UgaWYgKHN1Y2NlZWRlZCA9PT0gZmFsc2UpIHtcblx0ICAgICAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuXHQgICAgICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IEZVTEZJTExFRCkge1xuXHQgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICB9IGVsc2UgaWYgKHNldHRsZWQgPT09IFJFSkVDVEVEKSB7XG5cdCAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBpbml0aWFsaXplUHJvbWlzZShwcm9taXNlLCByZXNvbHZlcikge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIHJlc29sdmVyKGZ1bmN0aW9uIHJlc29sdmVQcm9taXNlKHZhbHVlKSB7XG5cdCAgICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiByZWplY3RQcm9taXNlKHJlYXNvbikge1xuXHQgICAgICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICByZWplY3QocHJvbWlzZSwgZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgdmFyIGlkID0gMDtcblxuXHQgICAgZnVuY3Rpb24gbmV4dElkKCkge1xuXHQgICAgICByZXR1cm4gaWQrKztcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gbWFrZVByb21pc2UocHJvbWlzZSkge1xuXHQgICAgICBwcm9taXNlW1BST01JU0VfSURdID0gaWQrKztcblx0ICAgICAgcHJvbWlzZS5fc3RhdGUgPSB1bmRlZmluZWQ7XG5cdCAgICAgIHByb21pc2UuX3Jlc3VsdCA9IHVuZGVmaW5lZDtcblx0ICAgICAgcHJvbWlzZS5fc3Vic2NyaWJlcnMgPSBbXTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gdmFsaWRhdGlvbkVycm9yKCkge1xuXHQgICAgICByZXR1cm4gbmV3IEVycm9yKCdBcnJheSBNZXRob2RzIG11c3QgYmUgcHJvdmlkZWQgYW4gQXJyYXknKTtcblx0ICAgIH1cblxuXHQgICAgdmFyIEVudW1lcmF0b3IgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGZ1bmN0aW9uIEVudW1lcmF0b3IoQ29uc3RydWN0b3IsIGlucHV0KSB7XG5cdCAgICAgICAgdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3RvciA9IENvbnN0cnVjdG9yO1xuXHQgICAgICAgIHRoaXMucHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcblxuXHQgICAgICAgIGlmICghdGhpcy5wcm9taXNlW1BST01JU0VfSURdKSB7XG5cdCAgICAgICAgICBtYWtlUHJvbWlzZSh0aGlzLnByb21pc2UpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChpc0FycmF5KGlucHV0KSkge1xuXHQgICAgICAgICAgdGhpcy5sZW5ndGggPSBpbnB1dC5sZW5ndGg7XG5cdCAgICAgICAgICB0aGlzLl9yZW1haW5pbmcgPSBpbnB1dC5sZW5ndGg7XG5cdCAgICAgICAgICB0aGlzLl9yZXN1bHQgPSBuZXcgQXJyYXkodGhpcy5sZW5ndGgpO1xuXG5cdCAgICAgICAgICBpZiAodGhpcy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICB0aGlzLmxlbmd0aCA9IHRoaXMubGVuZ3RoIHx8IDA7XG5cblx0ICAgICAgICAgICAgdGhpcy5fZW51bWVyYXRlKGlucHV0KTtcblxuXHQgICAgICAgICAgICBpZiAodGhpcy5fcmVtYWluaW5nID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgZnVsZmlsbCh0aGlzLnByb21pc2UsIHRoaXMuX3Jlc3VsdCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcmVqZWN0KHRoaXMucHJvbWlzZSwgdmFsaWRhdGlvbkVycm9yKCkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIEVudW1lcmF0b3IucHJvdG90eXBlLl9lbnVtZXJhdGUgPSBmdW5jdGlvbiBfZW51bWVyYXRlKGlucHV0KSB7XG5cdCAgICAgICAgZm9yICh2YXIgaSA9IDA7IHRoaXMuX3N0YXRlID09PSBQRU5ESU5HICYmIGkgPCBpbnB1dC5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgdGhpcy5fZWFjaEVudHJ5KGlucHV0W2ldLCBpKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cblx0ICAgICAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VhY2hFbnRyeSA9IGZ1bmN0aW9uIF9lYWNoRW50cnkoZW50cnksIGkpIHtcblx0ICAgICAgICB2YXIgYyA9IHRoaXMuX2luc3RhbmNlQ29uc3RydWN0b3I7XG5cdCAgICAgICAgdmFyIHJlc29sdmUkJDEgPSBjLnJlc29sdmU7XG5cblx0ICAgICAgICBpZiAocmVzb2x2ZSQkMSA9PT0gcmVzb2x2ZSQxKSB7XG5cdCAgICAgICAgICB2YXIgX3RoZW4gPSB2b2lkIDA7XG5cblx0ICAgICAgICAgIHZhciBlcnJvciA9IHZvaWQgMDtcblx0ICAgICAgICAgIHZhciBkaWRFcnJvciA9IGZhbHNlO1xuXG5cdCAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICBfdGhlbiA9IGVudHJ5LnRoZW47XG5cdCAgICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICAgIGRpZEVycm9yID0gdHJ1ZTtcblx0ICAgICAgICAgICAgZXJyb3IgPSBlO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBpZiAoX3RoZW4gPT09IHRoZW4gJiYgZW50cnkuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3NldHRsZWRBdChlbnRyeS5fc3RhdGUsIGksIGVudHJ5Ll9yZXN1bHQpO1xuXHQgICAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgX3RoZW4gIT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cdCAgICAgICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IGVudHJ5O1xuXHQgICAgICAgICAgfSBlbHNlIGlmIChjID09PSBQcm9taXNlJDEpIHtcblx0ICAgICAgICAgICAgdmFyIHByb21pc2UgPSBuZXcgYyhub29wKTtcblxuXHQgICAgICAgICAgICBpZiAoZGlkRXJyb3IpIHtcblx0ICAgICAgICAgICAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgZW50cnksIF90aGVuKTtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChuZXcgYyhmdW5jdGlvbiAocmVzb2x2ZSQkMSkge1xuXHQgICAgICAgICAgICAgIHJldHVybiByZXNvbHZlJCQxKGVudHJ5KTtcblx0ICAgICAgICAgICAgfSksIGkpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGlzLl93aWxsU2V0dGxlQXQocmVzb2x2ZSQkMShlbnRyeSksIGkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblxuXHQgICAgICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fc2V0dGxlZEF0ID0gZnVuY3Rpb24gX3NldHRsZWRBdChzdGF0ZSwgaSwgdmFsdWUpIHtcblx0ICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTtcblxuXHQgICAgICAgIGlmIChwcm9taXNlLl9zdGF0ZSA9PT0gUEVORElORykge1xuXHQgICAgICAgICAgdGhpcy5fcmVtYWluaW5nLS07XG5cblx0ICAgICAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcblx0ICAgICAgICAgICAgcmVqZWN0KHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMuX3Jlc3VsdFtpXSA9IHZhbHVlO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcblx0ICAgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH07XG5cblx0ICAgICAgRW51bWVyYXRvci5wcm90b3R5cGUuX3dpbGxTZXR0bGVBdCA9IGZ1bmN0aW9uIF93aWxsU2V0dGxlQXQocHJvbWlzZSwgaSkge1xuXHQgICAgICAgIHZhciBlbnVtZXJhdG9yID0gdGhpcztcblx0ICAgICAgICBzdWJzY3JpYmUocHJvbWlzZSwgdW5kZWZpbmVkLCBmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAgIHJldHVybiBlbnVtZXJhdG9yLl9zZXR0bGVkQXQoRlVMRklMTEVELCBpLCB2YWx1ZSk7XG5cdCAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuXHQgICAgICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChSRUpFQ1RFRCwgaSwgcmVhc29uKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfTtcblxuXHQgICAgICByZXR1cm4gRW51bWVyYXRvcjtcblx0ICAgIH0oKTtcblx0ICAgIC8qKlxuXHQgICAgICBgUHJvbWlzZS5hbGxgIGFjY2VwdHMgYW4gYXJyYXkgb2YgcHJvbWlzZXMsIGFuZCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2hcblx0ICAgICAgaXMgZnVsZmlsbGVkIHdpdGggYW4gYXJyYXkgb2YgZnVsZmlsbG1lbnQgdmFsdWVzIGZvciB0aGUgcGFzc2VkIHByb21pc2VzLCBvclxuXHQgICAgICByZWplY3RlZCB3aXRoIHRoZSByZWFzb24gb2YgdGhlIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIGJlIHJlamVjdGVkLiBJdCBjYXN0cyBhbGxcblx0ICAgICAgZWxlbWVudHMgb2YgdGhlIHBhc3NlZCBpdGVyYWJsZSB0byBwcm9taXNlcyBhcyBpdCBydW5zIHRoaXMgYWxnb3JpdGhtLlxuXHQgICAgXG5cdCAgICAgIEV4YW1wbGU6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuXHQgICAgICBsZXQgcHJvbWlzZTIgPSByZXNvbHZlKDIpO1xuXHQgICAgICBsZXQgcHJvbWlzZTMgPSByZXNvbHZlKDMpO1xuXHQgICAgICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblx0ICAgIFxuXHQgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG5cdCAgICAgICAgLy8gVGhlIGFycmF5IGhlcmUgd291bGQgYmUgWyAxLCAyLCAzIF07XG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBJZiBhbnkgb2YgdGhlIGBwcm9taXNlc2AgZ2l2ZW4gdG8gYGFsbGAgYXJlIHJlamVjdGVkLCB0aGUgZmlyc3QgcHJvbWlzZVxuXHQgICAgICB0aGF0IGlzIHJlamVjdGVkIHdpbGwgYmUgZ2l2ZW4gYXMgYW4gYXJndW1lbnQgdG8gdGhlIHJldHVybmVkIHByb21pc2VzJ3Ncblx0ICAgICAgcmVqZWN0aW9uIGhhbmRsZXIuIEZvciBleGFtcGxlOlxuXHQgICAgXG5cdCAgICAgIEV4YW1wbGU6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZTEgPSByZXNvbHZlKDEpO1xuXHQgICAgICBsZXQgcHJvbWlzZTIgPSByZWplY3QobmV3IEVycm9yKFwiMlwiKSk7XG5cdCAgICAgIGxldCBwcm9taXNlMyA9IHJlamVjdChuZXcgRXJyb3IoXCIzXCIpKTtcblx0ICAgICAgbGV0IHByb21pc2VzID0gWyBwcm9taXNlMSwgcHJvbWlzZTIsIHByb21pc2UzIF07XG5cdCAgICBcblx0ICAgICAgUHJvbWlzZS5hbGwocHJvbWlzZXMpLnRoZW4oZnVuY3Rpb24oYXJyYXkpe1xuXHQgICAgICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zIGJlY2F1c2UgdGhlcmUgYXJlIHJlamVjdGVkIHByb21pc2VzIVxuXHQgICAgICB9LCBmdW5jdGlvbihlcnJvcikge1xuXHQgICAgICAgIC8vIGVycm9yLm1lc3NhZ2UgPT09IFwiMlwiXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBAbWV0aG9kIGFsbFxuXHQgICAgICBAc3RhdGljXG5cdCAgICAgIEBwYXJhbSB7QXJyYXl9IGVudHJpZXMgYXJyYXkgb2YgcHJvbWlzZXNcblx0ICAgICAgQHBhcmFtIHtTdHJpbmd9IGxhYmVsIG9wdGlvbmFsIHN0cmluZyBmb3IgbGFiZWxpbmcgdGhlIHByb21pc2UuXG5cdCAgICAgIFVzZWZ1bCBmb3IgdG9vbGluZy5cblx0ICAgICAgQHJldHVybiB7UHJvbWlzZX0gcHJvbWlzZSB0aGF0IGlzIGZ1bGZpbGxlZCB3aGVuIGFsbCBgcHJvbWlzZXNgIGhhdmUgYmVlblxuXHQgICAgICBmdWxmaWxsZWQsIG9yIHJlamVjdGVkIGlmIGFueSBvZiB0aGVtIGJlY29tZSByZWplY3RlZC5cblx0ICAgICAgQHN0YXRpY1xuXHQgICAgKi9cblxuXG5cdCAgICBmdW5jdGlvbiBhbGwoZW50cmllcykge1xuXHQgICAgICByZXR1cm4gbmV3IEVudW1lcmF0b3IodGhpcywgZW50cmllcykucHJvbWlzZTtcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgICBgUHJvbWlzZS5yYWNlYCByZXR1cm5zIGEgbmV3IHByb21pc2Ugd2hpY2ggaXMgc2V0dGxlZCBpbiB0aGUgc2FtZSB3YXkgYXMgdGhlXG5cdCAgICAgIGZpcnN0IHBhc3NlZCBwcm9taXNlIHRvIHNldHRsZS5cblx0ICAgIFxuXHQgICAgICBFeGFtcGxlOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHByb21pc2UxID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICByZXNvbHZlKCdwcm9taXNlIDEnKTtcblx0ICAgICAgICB9LCAyMDApO1xuXHQgICAgICB9KTtcblx0ICAgIFxuXHQgICAgICBsZXQgcHJvbWlzZTIgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0ICAgICAgICAgIHJlc29sdmUoJ3Byb21pc2UgMicpO1xuXHQgICAgICAgIH0sIDEwMCk7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIFByb21pc2UucmFjZShbcHJvbWlzZTEsIHByb21pc2UyXSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHQgICAgICAgIC8vIHJlc3VsdCA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBpdCB3YXMgcmVzb2x2ZWQgYmVmb3JlIHByb21pc2UxXG5cdCAgICAgICAgLy8gd2FzIHJlc29sdmVkLlxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgYFByb21pc2UucmFjZWAgaXMgZGV0ZXJtaW5pc3RpYyBpbiB0aGF0IG9ubHkgdGhlIHN0YXRlIG9mIHRoZSBmaXJzdFxuXHQgICAgICBzZXR0bGVkIHByb21pc2UgbWF0dGVycy4gRm9yIGV4YW1wbGUsIGV2ZW4gaWYgb3RoZXIgcHJvbWlzZXMgZ2l2ZW4gdG8gdGhlXG5cdCAgICAgIGBwcm9taXNlc2AgYXJyYXkgYXJndW1lbnQgYXJlIHJlc29sdmVkLCBidXQgdGhlIGZpcnN0IHNldHRsZWQgcHJvbWlzZSBoYXNcblx0ICAgICAgYmVjb21lIHJlamVjdGVkIGJlZm9yZSB0aGUgb3RoZXIgcHJvbWlzZXMgYmVjYW1lIGZ1bGZpbGxlZCwgdGhlIHJldHVybmVkXG5cdCAgICAgIHByb21pc2Ugd2lsbCBiZWNvbWUgcmVqZWN0ZWQ6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0ICAgICAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuXHQgICAgICAgIH0sIDIwMCk7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHQgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcigncHJvbWlzZSAyJykpO1xuXHQgICAgICAgIH0sIDEwMCk7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIFByb21pc2UucmFjZShbcHJvbWlzZTEsIHByb21pc2UyXSkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHQgICAgICAgIC8vIENvZGUgaGVyZSBuZXZlciBydW5zXG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgICAgLy8gcmVhc29uLm1lc3NhZ2UgPT09ICdwcm9taXNlIDInIGJlY2F1c2UgcHJvbWlzZSAyIGJlY2FtZSByZWplY3RlZCBiZWZvcmVcblx0ICAgICAgICAvLyBwcm9taXNlIDEgYmVjYW1lIGZ1bGZpbGxlZFxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQW4gZXhhbXBsZSByZWFsLXdvcmxkIHVzZSBjYXNlIGlzIGltcGxlbWVudGluZyB0aW1lb3V0czpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIFByb21pc2UucmFjZShbYWpheCgnZm9vLmpzb24nKSwgdGltZW91dCg1MDAwKV0pXG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEBtZXRob2QgcmFjZVxuXHQgICAgICBAc3RhdGljXG5cdCAgICAgIEBwYXJhbSB7QXJyYXl9IHByb21pc2VzIGFycmF5IG9mIHByb21pc2VzIHRvIG9ic2VydmVcblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2Ugd2hpY2ggc2V0dGxlcyBpbiB0aGUgc2FtZSB3YXkgYXMgdGhlIGZpcnN0IHBhc3NlZFxuXHQgICAgICBwcm9taXNlIHRvIHNldHRsZS5cblx0ICAgICovXG5cblxuXHQgICAgZnVuY3Rpb24gcmFjZShlbnRyaWVzKSB7XG5cdCAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG5cdCAgICAgIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cblx0ICAgICAgaWYgKCFpc0FycmF5KGVudHJpZXMpKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAoXywgcmVqZWN0KSB7XG5cdCAgICAgICAgICByZXR1cm4gcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYW4gYXJyYXkgdG8gcmFjZS4nKSk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBDb25zdHJ1Y3RvcihmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgICB2YXIgbGVuZ3RoID0gZW50cmllcy5sZW5ndGg7XG5cblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgQ29uc3RydWN0b3IucmVzb2x2ZShlbnRyaWVzW2ldKS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgICBgUHJvbWlzZS5yZWplY3RgIHJldHVybnMgYSBwcm9taXNlIHJlamVjdGVkIHdpdGggdGhlIHBhc3NlZCBgcmVhc29uYC5cblx0ICAgICAgSXQgaXMgc2hvcnRoYW5kIGZvciB0aGUgZm9sbG93aW5nOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuXHQgICAgICAgIHJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcblx0ICAgICAgfSk7XG5cdCAgICBcblx0ICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcblx0ICAgICAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcblx0ICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEluc3RlYWQgb2Ygd3JpdGluZyB0aGUgYWJvdmUsIHlvdXIgY29kZSBub3cgc2ltcGx5IGJlY29tZXMgdGhlIGZvbGxvd2luZzpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGxldCBwcm9taXNlID0gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdXSE9PUFMnKSk7XG5cdCAgICBcblx0ICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcblx0ICAgICAgICAvLyBDb2RlIGhlcmUgZG9lc24ndCBydW4gYmVjYXVzZSB0aGUgcHJvbWlzZSBpcyByZWplY3RlZCFcblx0ICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ1dIT09QUydcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEBtZXRob2QgcmVqZWN0XG5cdCAgICAgIEBzdGF0aWNcblx0ICAgICAgQHBhcmFtIHtBbnl9IHJlYXNvbiB2YWx1ZSB0aGF0IHRoZSByZXR1cm5lZCBwcm9taXNlIHdpbGwgYmUgcmVqZWN0ZWQgd2l0aC5cblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAcmV0dXJuIHtQcm9taXNlfSBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgZ2l2ZW4gYHJlYXNvbmAuXG5cdCAgICAqL1xuXG5cblx0ICAgIGZ1bmN0aW9uIHJlamVjdCQxKHJlYXNvbikge1xuXHQgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXHQgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcblx0ICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgIHJldHVybiBwcm9taXNlO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBuZWVkc1Jlc29sdmVyKCkge1xuXHQgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdZb3UgbXVzdCBwYXNzIGEgcmVzb2x2ZXIgZnVuY3Rpb24gYXMgdGhlIGZpcnN0IGFyZ3VtZW50IHRvIHRoZSBwcm9taXNlIGNvbnN0cnVjdG9yJyk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIG5lZWRzTmV3KCkge1xuXHQgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmFpbGVkIHRvIGNvbnN0cnVjdCAnUHJvbWlzZSc6IFBsZWFzZSB1c2UgdGhlICduZXcnIG9wZXJhdG9yLCB0aGlzIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uXCIpO1xuXHQgICAgfVxuXHQgICAgLyoqXG5cdCAgICAgIFByb21pc2Ugb2JqZWN0cyByZXByZXNlbnQgdGhlIGV2ZW50dWFsIHJlc3VsdCBvZiBhbiBhc3luY2hyb25vdXMgb3BlcmF0aW9uLiBUaGVcblx0ICAgICAgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCwgd2hpY2hcblx0ICAgICAgcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGUgcmVhc29uXG5cdCAgICAgIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuXHQgICAgXG5cdCAgICAgIFRlcm1pbm9sb2d5XG5cdCAgICAgIC0tLS0tLS0tLS0tXG5cdCAgICBcblx0ICAgICAgLSBgcHJvbWlzZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHdpdGggYSBgdGhlbmAgbWV0aG9kIHdob3NlIGJlaGF2aW9yIGNvbmZvcm1zIHRvIHRoaXMgc3BlY2lmaWNhdGlvbi5cblx0ICAgICAgLSBgdGhlbmFibGVgIGlzIGFuIG9iamVjdCBvciBmdW5jdGlvbiB0aGF0IGRlZmluZXMgYSBgdGhlbmAgbWV0aG9kLlxuXHQgICAgICAtIGB2YWx1ZWAgaXMgYW55IGxlZ2FsIEphdmFTY3JpcHQgdmFsdWUgKGluY2x1ZGluZyB1bmRlZmluZWQsIGEgdGhlbmFibGUsIG9yIGEgcHJvbWlzZSkuXG5cdCAgICAgIC0gYGV4Y2VwdGlvbmAgaXMgYSB2YWx1ZSB0aGF0IGlzIHRocm93biB1c2luZyB0aGUgdGhyb3cgc3RhdGVtZW50LlxuXHQgICAgICAtIGByZWFzb25gIGlzIGEgdmFsdWUgdGhhdCBpbmRpY2F0ZXMgd2h5IGEgcHJvbWlzZSB3YXMgcmVqZWN0ZWQuXG5cdCAgICAgIC0gYHNldHRsZWRgIHRoZSBmaW5hbCByZXN0aW5nIHN0YXRlIG9mIGEgcHJvbWlzZSwgZnVsZmlsbGVkIG9yIHJlamVjdGVkLlxuXHQgICAgXG5cdCAgICAgIEEgcHJvbWlzZSBjYW4gYmUgaW4gb25lIG9mIHRocmVlIHN0YXRlczogcGVuZGluZywgZnVsZmlsbGVkLCBvciByZWplY3RlZC5cblx0ICAgIFxuXHQgICAgICBQcm9taXNlcyB0aGF0IGFyZSBmdWxmaWxsZWQgaGF2ZSBhIGZ1bGZpbGxtZW50IHZhbHVlIGFuZCBhcmUgaW4gdGhlIGZ1bGZpbGxlZFxuXHQgICAgICBzdGF0ZS4gIFByb21pc2VzIHRoYXQgYXJlIHJlamVjdGVkIGhhdmUgYSByZWplY3Rpb24gcmVhc29uIGFuZCBhcmUgaW4gdGhlXG5cdCAgICAgIHJlamVjdGVkIHN0YXRlLiAgQSBmdWxmaWxsbWVudCB2YWx1ZSBpcyBuZXZlciBhIHRoZW5hYmxlLlxuXHQgICAgXG5cdCAgICAgIFByb21pc2VzIGNhbiBhbHNvIGJlIHNhaWQgdG8gKnJlc29sdmUqIGEgdmFsdWUuICBJZiB0aGlzIHZhbHVlIGlzIGFsc28gYVxuXHQgICAgICBwcm9taXNlLCB0aGVuIHRoZSBvcmlnaW5hbCBwcm9taXNlJ3Mgc2V0dGxlZCBzdGF0ZSB3aWxsIG1hdGNoIHRoZSB2YWx1ZSdzXG5cdCAgICAgIHNldHRsZWQgc3RhdGUuICBTbyBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IHJlamVjdHMgd2lsbFxuXHQgICAgICBpdHNlbGYgcmVqZWN0LCBhbmQgYSBwcm9taXNlIHRoYXQgKnJlc29sdmVzKiBhIHByb21pc2UgdGhhdCBmdWxmaWxscyB3aWxsXG5cdCAgICAgIGl0c2VsZiBmdWxmaWxsLlxuXHQgICAgXG5cdCAgICBcblx0ICAgICAgQmFzaWMgVXNhZ2U6XG5cdCAgICAgIC0tLS0tLS0tLS0tLVxuXHQgICAgXG5cdCAgICAgIGBgYGpzXG5cdCAgICAgIGxldCBwcm9taXNlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG5cdCAgICAgICAgLy8gb24gc3VjY2Vzc1xuXHQgICAgICAgIHJlc29sdmUodmFsdWUpO1xuXHQgICAgXG5cdCAgICAgICAgLy8gb24gZmFpbHVyZVxuXHQgICAgICAgIHJlamVjdChyZWFzb24pO1xuXHQgICAgICB9KTtcblx0ICAgIFxuXHQgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcblx0ICAgICAgICAvLyBvbiBmdWxmaWxsbWVudFxuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pIHtcblx0ICAgICAgICAvLyBvbiByZWplY3Rpb25cblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEFkdmFuY2VkIFVzYWdlOlxuXHQgICAgICAtLS0tLS0tLS0tLS0tLS1cblx0ICAgIFxuXHQgICAgICBQcm9taXNlcyBzaGluZSB3aGVuIGFic3RyYWN0aW5nIGF3YXkgYXN5bmNocm9ub3VzIGludGVyYWN0aW9ucyBzdWNoIGFzXG5cdCAgICAgIGBYTUxIdHRwUmVxdWVzdGBzLlxuXHQgICAgXG5cdCAgICAgIGBgYGpzXG5cdCAgICAgIGZ1bmN0aW9uIGdldEpTT04odXJsKSB7XG5cdCAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgICBsZXQgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cdCAgICBcblx0ICAgICAgICAgIHhoci5vcGVuKCdHRVQnLCB1cmwpO1xuXHQgICAgICAgICAgeGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGhhbmRsZXI7XG5cdCAgICAgICAgICB4aHIucmVzcG9uc2VUeXBlID0gJ2pzb24nO1xuXHQgICAgICAgICAgeGhyLnNldFJlcXVlc3RIZWFkZXIoJ0FjY2VwdCcsICdhcHBsaWNhdGlvbi9qc29uJyk7XG5cdCAgICAgICAgICB4aHIuc2VuZCgpO1xuXHQgICAgXG5cdCAgICAgICAgICBmdW5jdGlvbiBoYW5kbGVyKCkge1xuXHQgICAgICAgICAgICBpZiAodGhpcy5yZWFkeVN0YXRlID09PSB0aGlzLkRPTkUpIHtcblx0ICAgICAgICAgICAgICBpZiAodGhpcy5zdGF0dXMgPT09IDIwMCkge1xuXHQgICAgICAgICAgICAgICAgcmVzb2x2ZSh0aGlzLnJlc3BvbnNlKTtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignZ2V0SlNPTjogYCcgKyB1cmwgKyAnYCBmYWlsZWQgd2l0aCBzdGF0dXM6IFsnICsgdGhpcy5zdGF0dXMgKyAnXScpKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH07XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH1cblx0ICAgIFxuXHQgICAgICBnZXRKU09OKCcvcG9zdHMuanNvbicpLnRoZW4oZnVuY3Rpb24oanNvbikge1xuXHQgICAgICAgIC8vIG9uIGZ1bGZpbGxtZW50XG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICAgIC8vIG9uIHJlamVjdGlvblxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgVW5saWtlIGNhbGxiYWNrcywgcHJvbWlzZXMgYXJlIGdyZWF0IGNvbXBvc2FibGUgcHJpbWl0aXZlcy5cblx0ICAgIFxuXHQgICAgICBgYGBqc1xuXHQgICAgICBQcm9taXNlLmFsbChbXG5cdCAgICAgICAgZ2V0SlNPTignL3Bvc3RzJyksXG5cdCAgICAgICAgZ2V0SlNPTignL2NvbW1lbnRzJylcblx0ICAgICAgXSkudGhlbihmdW5jdGlvbih2YWx1ZXMpe1xuXHQgICAgICAgIHZhbHVlc1swXSAvLyA9PiBwb3N0c0pTT05cblx0ICAgICAgICB2YWx1ZXNbMV0gLy8gPT4gY29tbWVudHNKU09OXG5cdCAgICBcblx0ICAgICAgICByZXR1cm4gdmFsdWVzO1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQGNsYXNzIFByb21pc2Vcblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gcmVzb2x2ZXJcblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAY29uc3RydWN0b3Jcblx0ICAgICovXG5cblxuXHQgICAgdmFyIFByb21pc2UkMSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgZnVuY3Rpb24gUHJvbWlzZShyZXNvbHZlcikge1xuXHQgICAgICAgIHRoaXNbUFJPTUlTRV9JRF0gPSBuZXh0SWQoKTtcblx0ICAgICAgICB0aGlzLl9yZXN1bHQgPSB0aGlzLl9zdGF0ZSA9IHVuZGVmaW5lZDtcblx0ICAgICAgICB0aGlzLl9zdWJzY3JpYmVycyA9IFtdO1xuXG5cdCAgICAgICAgaWYgKG5vb3AgIT09IHJlc29sdmVyKSB7XG5cdCAgICAgICAgICB0eXBlb2YgcmVzb2x2ZXIgIT09ICdmdW5jdGlvbicgJiYgbmVlZHNSZXNvbHZlcigpO1xuXHQgICAgICAgICAgdGhpcyBpbnN0YW5jZW9mIFByb21pc2UgPyBpbml0aWFsaXplUHJvbWlzZSh0aGlzLCByZXNvbHZlcikgOiBuZWVkc05ldygpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgICAvKipcblx0ICAgICAgVGhlIHByaW1hcnkgd2F5IG9mIGludGVyYWN0aW5nIHdpdGggYSBwcm9taXNlIGlzIHRocm91Z2ggaXRzIGB0aGVuYCBtZXRob2QsXG5cdCAgICAgIHdoaWNoIHJlZ2lzdGVycyBjYWxsYmFja3MgdG8gcmVjZWl2ZSBlaXRoZXIgYSBwcm9taXNlJ3MgZXZlbnR1YWwgdmFsdWUgb3IgdGhlXG5cdCAgICAgIHJlYXNvbiB3aHkgdGhlIHByb21pc2UgY2Fubm90IGJlIGZ1bGZpbGxlZC5cblx0ICAgICAgIGBgYGpzXG5cdCAgICAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbih1c2VyKXtcblx0ICAgICAgICAvLyB1c2VyIGlzIGF2YWlsYWJsZVxuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIHVzZXIgaXMgdW5hdmFpbGFibGUsIGFuZCB5b3UgYXJlIGdpdmVuIHRoZSByZWFzb24gd2h5XG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgICAgIENoYWluaW5nXG5cdCAgICAgIC0tLS0tLS0tXG5cdCAgICAgICBUaGUgcmV0dXJuIHZhbHVlIG9mIGB0aGVuYCBpcyBpdHNlbGYgYSBwcm9taXNlLiAgVGhpcyBzZWNvbmQsICdkb3duc3RyZWFtJ1xuXHQgICAgICBwcm9taXNlIGlzIHJlc29sdmVkIHdpdGggdGhlIHJldHVybiB2YWx1ZSBvZiB0aGUgZmlyc3QgcHJvbWlzZSdzIGZ1bGZpbGxtZW50XG5cdCAgICAgIG9yIHJlamVjdGlvbiBoYW5kbGVyLCBvciByZWplY3RlZCBpZiB0aGUgaGFuZGxlciB0aHJvd3MgYW4gZXhjZXB0aW9uLlxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgcmV0dXJuIHVzZXIubmFtZTtcblx0ICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuXHQgICAgICAgIHJldHVybiAnZGVmYXVsdCBuYW1lJztcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodXNlck5hbWUpIHtcblx0ICAgICAgICAvLyBJZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHVzZXJOYW1lYCB3aWxsIGJlIHRoZSB1c2VyJ3MgbmFtZSwgb3RoZXJ3aXNlIGl0XG5cdCAgICAgICAgLy8gd2lsbCBiZSBgJ2RlZmF1bHQgbmFtZSdgXG5cdCAgICAgIH0pO1xuXHQgICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdGb3VuZCB1c2VyLCBidXQgc3RpbGwgdW5oYXBweScpO1xuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdgZmluZFVzZXJgIHJlamVjdGVkIGFuZCB3ZSdyZSB1bmhhcHB5Jyk7XG5cdCAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgLy8gbmV2ZXIgcmVhY2hlZFxuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgLy8gaWYgYGZpbmRVc2VyYCBmdWxmaWxsZWQsIGByZWFzb25gIHdpbGwgYmUgJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jy5cblx0ICAgICAgICAvLyBJZiBgZmluZFVzZXJgIHJlamVjdGVkLCBgcmVhc29uYCB3aWxsIGJlICdgZmluZFVzZXJgIHJlamVjdGVkIGFuZCB3ZSdyZSB1bmhhcHB5Jy5cblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICBJZiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIGRvZXMgbm90IHNwZWNpZnkgYSByZWplY3Rpb24gaGFuZGxlciwgcmVqZWN0aW9uIHJlYXNvbnMgd2lsbCBiZSBwcm9wYWdhdGVkIGZ1cnRoZXIgZG93bnN0cmVhbS5cblx0ICAgICAgIGBgYGpzXG5cdCAgICAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuXHQgICAgICAgIHRocm93IG5ldyBQZWRhZ29naWNhbEV4Y2VwdGlvbignVXBzdHJlYW0gZXJyb3InKTtcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAvLyBuZXZlciByZWFjaGVkXG5cdCAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgLy8gbmV2ZXIgcmVhY2hlZFxuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgLy8gVGhlIGBQZWRnYWdvY2lhbEV4Y2VwdGlvbmAgaXMgcHJvcGFnYXRlZCBhbGwgdGhlIHdheSBkb3duIHRvIGhlcmVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgQXNzaW1pbGF0aW9uXG5cdCAgICAgIC0tLS0tLS0tLS0tLVxuXHQgICAgICAgU29tZXRpbWVzIHRoZSB2YWx1ZSB5b3Ugd2FudCB0byBwcm9wYWdhdGUgdG8gYSBkb3duc3RyZWFtIHByb21pc2UgY2FuIG9ubHkgYmVcblx0ICAgICAgcmV0cmlldmVkIGFzeW5jaHJvbm91c2x5LiBUaGlzIGNhbiBiZSBhY2hpZXZlZCBieSByZXR1cm5pbmcgYSBwcm9taXNlIGluIHRoZVxuXHQgICAgICBmdWxmaWxsbWVudCBvciByZWplY3Rpb24gaGFuZGxlci4gVGhlIGRvd25zdHJlYW0gcHJvbWlzZSB3aWxsIHRoZW4gYmUgcGVuZGluZ1xuXHQgICAgICB1bnRpbCB0aGUgcmV0dXJuZWQgcHJvbWlzZSBpcyBzZXR0bGVkLiBUaGlzIGlzIGNhbGxlZCAqYXNzaW1pbGF0aW9uKi5cblx0ICAgICAgIGBgYGpzXG5cdCAgICAgIGZpbmRVc2VyKCkudGhlbihmdW5jdGlvbiAodXNlcikge1xuXHQgICAgICAgIHJldHVybiBmaW5kQ29tbWVudHNCeUF1dGhvcih1c2VyKTtcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAoY29tbWVudHMpIHtcblx0ICAgICAgICAvLyBUaGUgdXNlcidzIGNvbW1lbnRzIGFyZSBub3cgYXZhaWxhYmxlXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgICAgIElmIHRoZSBhc3NpbWxpYXRlZCBwcm9taXNlIHJlamVjdHMsIHRoZW4gdGhlIGRvd25zdHJlYW0gcHJvbWlzZSB3aWxsIGFsc28gcmVqZWN0LlxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuXHQgICAgICAgIC8vIElmIGBmaW5kQ29tbWVudHNCeUF1dGhvcmAgZnVsZmlsbHMsIHdlJ2xsIGhhdmUgdGhlIHZhbHVlIGhlcmVcblx0ICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuXHQgICAgICAgIC8vIElmIGBmaW5kQ29tbWVudHNCeUF1dGhvcmAgcmVqZWN0cywgd2UnbGwgaGF2ZSB0aGUgcmVhc29uIGhlcmVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgU2ltcGxlIEV4YW1wbGVcblx0ICAgICAgLS0tLS0tLS0tLS0tLS1cblx0ICAgICAgIFN5bmNocm9ub3VzIEV4YW1wbGVcblx0ICAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHJlc3VsdDtcblx0ICAgICAgIHRyeSB7XG5cdCAgICAgICAgcmVzdWx0ID0gZmluZFJlc3VsdCgpO1xuXHQgICAgICAgIC8vIHN1Y2Nlc3Ncblx0ICAgICAgfSBjYXRjaChyZWFzb24pIHtcblx0ICAgICAgICAvLyBmYWlsdXJlXG5cdCAgICAgIH1cblx0ICAgICAgYGBgXG5cdCAgICAgICBFcnJiYWNrIEV4YW1wbGVcblx0ICAgICAgIGBgYGpzXG5cdCAgICAgIGZpbmRSZXN1bHQoZnVuY3Rpb24ocmVzdWx0LCBlcnIpe1xuXHQgICAgICAgIGlmIChlcnIpIHtcblx0ICAgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgUHJvbWlzZSBFeGFtcGxlO1xuXHQgICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBmaW5kUmVzdWx0KCkudGhlbihmdW5jdGlvbihyZXN1bHQpe1xuXHQgICAgICAgIC8vIHN1Y2Nlc3Ncblx0ICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyBmYWlsdXJlXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgICAgIEFkdmFuY2VkIEV4YW1wbGVcblx0ICAgICAgLS0tLS0tLS0tLS0tLS1cblx0ICAgICAgIFN5bmNocm9ub3VzIEV4YW1wbGVcblx0ICAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IGF1dGhvciwgYm9va3M7XG5cdCAgICAgICB0cnkge1xuXHQgICAgICAgIGF1dGhvciA9IGZpbmRBdXRob3IoKTtcblx0ICAgICAgICBib29rcyAgPSBmaW5kQm9va3NCeUF1dGhvcihhdXRob3IpO1xuXHQgICAgICAgIC8vIHN1Y2Nlc3Ncblx0ICAgICAgfSBjYXRjaChyZWFzb24pIHtcblx0ICAgICAgICAvLyBmYWlsdXJlXG5cdCAgICAgIH1cblx0ICAgICAgYGBgXG5cdCAgICAgICBFcnJiYWNrIEV4YW1wbGVcblx0ICAgICAgIGBgYGpzXG5cdCAgICAgICBmdW5jdGlvbiBmb3VuZEJvb2tzKGJvb2tzKSB7XG5cdCAgICAgICB9XG5cdCAgICAgICBmdW5jdGlvbiBmYWlsdXJlKHJlYXNvbikge1xuXHQgICAgICAgfVxuXHQgICAgICAgZmluZEF1dGhvcihmdW5jdGlvbihhdXRob3IsIGVycil7XG5cdCAgICAgICAgaWYgKGVycikge1xuXHQgICAgICAgICAgZmFpbHVyZShlcnIpO1xuXHQgICAgICAgICAgLy8gZmFpbHVyZVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICBmaW5kQm9vb2tzQnlBdXRob3IoYXV0aG9yLCBmdW5jdGlvbihib29rcywgZXJyKSB7XG5cdCAgICAgICAgICAgICAgaWYgKGVycikge1xuXHQgICAgICAgICAgICAgICAgZmFpbHVyZShlcnIpO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0cnkge1xuXHQgICAgICAgICAgICAgICAgICBmb3VuZEJvb2tzKGJvb2tzKTtcblx0ICAgICAgICAgICAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG5cdCAgICAgICAgICAgICAgICAgIGZhaWx1cmUocmVhc29uKTtcblx0ICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfSBjYXRjaChlcnJvcikge1xuXHQgICAgICAgICAgICBmYWlsdXJlKGVycik7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICAvLyBzdWNjZXNzXG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgICBQcm9taXNlIEV4YW1wbGU7XG5cdCAgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGZpbmRBdXRob3IoKS5cblx0ICAgICAgICB0aGVuKGZpbmRCb29rc0J5QXV0aG9yKS5cblx0ICAgICAgICB0aGVuKGZ1bmN0aW9uKGJvb2tzKXtcblx0ICAgICAgICAgIC8vIGZvdW5kIGJvb2tzXG5cdCAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgICAgLy8gc29tZXRoaW5nIHdlbnQgd3Jvbmdcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgQG1ldGhvZCB0aGVuXG5cdCAgICAgIEBwYXJhbSB7RnVuY3Rpb259IG9uRnVsZmlsbGVkXG5cdCAgICAgIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0ZWRcblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAcmV0dXJuIHtQcm9taXNlfVxuXHQgICAgICAqL1xuXG5cdCAgICAgIC8qKlxuXHQgICAgICBgY2F0Y2hgIGlzIHNpbXBseSBzdWdhciBmb3IgYHRoZW4odW5kZWZpbmVkLCBvblJlamVjdGlvbilgIHdoaWNoIG1ha2VzIGl0IHRoZSBzYW1lXG5cdCAgICAgIGFzIHRoZSBjYXRjaCBibG9jayBvZiBhIHRyeS9jYXRjaCBzdGF0ZW1lbnQuXG5cdCAgICAgIGBgYGpzXG5cdCAgICAgIGZ1bmN0aW9uIGZpbmRBdXRob3IoKXtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKCdjb3VsZG4ndCBmaW5kIHRoYXQgYXV0aG9yJyk7XG5cdCAgICAgIH1cblx0ICAgICAgLy8gc3luY2hyb25vdXNcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgZmluZEF1dGhvcigpO1xuXHQgICAgICB9IGNhdGNoKHJlYXNvbikge1xuXHQgICAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuXHQgICAgICB9XG5cdCAgICAgIC8vIGFzeW5jIHdpdGggcHJvbWlzZXNcblx0ICAgICAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgICAgQG1ldGhvZCBjYXRjaFxuXHQgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBvblJlamVjdGlvblxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9XG5cdCAgICAgICovXG5cblxuXHQgICAgICBQcm9taXNlLnByb3RvdHlwZS5jYXRjaCA9IGZ1bmN0aW9uIF9jYXRjaChvblJlamVjdGlvbikge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnRoZW4obnVsbCwgb25SZWplY3Rpb24pO1xuXHQgICAgICB9O1xuXHQgICAgICAvKipcblx0ICAgICAgICBgZmluYWxseWAgd2lsbCBiZSBpbnZva2VkIHJlZ2FyZGxlc3Mgb2YgdGhlIHByb21pc2UncyBmYXRlIGp1c3QgYXMgbmF0aXZlXG5cdCAgICAgICAgdHJ5L2NhdGNoL2ZpbmFsbHkgYmVoYXZlc1xuXHQgICAgICBcblx0ICAgICAgICBTeW5jaHJvbm91cyBleGFtcGxlOlxuXHQgICAgICBcblx0ICAgICAgICBgYGBqc1xuXHQgICAgICAgIGZpbmRBdXRob3IoKSB7XG5cdCAgICAgICAgICBpZiAoTWF0aC5yYW5kb20oKSA+IDAuNSkge1xuXHQgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHJldHVybiBuZXcgQXV0aG9yKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICBcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgcmV0dXJuIGZpbmRBdXRob3IoKTsgLy8gc3VjY2VlZCBvciBmYWlsXG5cdCAgICAgICAgfSBjYXRjaChlcnJvcikge1xuXHQgICAgICAgICAgcmV0dXJuIGZpbmRPdGhlckF1dGhlcigpO1xuXHQgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAvLyBhbHdheXMgcnVuc1xuXHQgICAgICAgICAgLy8gZG9lc24ndCBhZmZlY3QgdGhlIHJldHVybiB2YWx1ZVxuXHQgICAgICAgIH1cblx0ICAgICAgICBgYGBcblx0ICAgICAgXG5cdCAgICAgICAgQXN5bmNocm9ub3VzIGV4YW1wbGU6XG5cdCAgICAgIFxuXHQgICAgICAgIGBgYGpzXG5cdCAgICAgICAgZmluZEF1dGhvcigpLmNhdGNoKGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG5cdCAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbigpe1xuXHQgICAgICAgICAgLy8gYXV0aG9yIHdhcyBlaXRoZXIgZm91bmQsIG9yIG5vdFxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGBgYFxuXHQgICAgICBcblx0ICAgICAgICBAbWV0aG9kIGZpbmFsbHlcblx0ICAgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuXHQgICAgICAgIEByZXR1cm4ge1Byb21pc2V9XG5cdCAgICAgICovXG5cblxuXHQgICAgICBQcm9taXNlLnByb3RvdHlwZS5maW5hbGx5ID0gZnVuY3Rpb24gX2ZpbmFsbHkoY2FsbGJhY2spIHtcblx0ICAgICAgICB2YXIgcHJvbWlzZSA9IHRoaXM7XG5cdCAgICAgICAgdmFyIGNvbnN0cnVjdG9yID0gcHJvbWlzZS5jb25zdHJ1Y3RvcjtcblxuXHQgICAgICAgIGlmIChpc0Z1bmN0aW9uKGNhbGxiYWNrKSkge1xuXHQgICAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yLnJlc29sdmUoY2FsbGJhY2soKSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgICAgdGhyb3cgcmVhc29uO1xuXHQgICAgICAgICAgICB9KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldHVybiBwcm9taXNlLnRoZW4oY2FsbGJhY2ssIGNhbGxiYWNrKTtcblx0ICAgICAgfTtcblxuXHQgICAgICByZXR1cm4gUHJvbWlzZTtcblx0ICAgIH0oKTtcblxuXHQgICAgUHJvbWlzZSQxLnByb3RvdHlwZS50aGVuID0gdGhlbjtcblx0ICAgIFByb21pc2UkMS5hbGwgPSBhbGw7XG5cdCAgICBQcm9taXNlJDEucmFjZSA9IHJhY2U7XG5cdCAgICBQcm9taXNlJDEucmVzb2x2ZSA9IHJlc29sdmUkMTtcblx0ICAgIFByb21pc2UkMS5yZWplY3QgPSByZWplY3QkMTtcblx0ICAgIFByb21pc2UkMS5fc2V0U2NoZWR1bGVyID0gc2V0U2NoZWR1bGVyO1xuXHQgICAgUHJvbWlzZSQxLl9zZXRBc2FwID0gc2V0QXNhcDtcblx0ICAgIFByb21pc2UkMS5fYXNhcCA9IGFzYXA7XG5cdCAgICAvKmdsb2JhbCBzZWxmKi9cblxuXHQgICAgZnVuY3Rpb24gcG9seWZpbGwoKSB7XG5cdCAgICAgIHZhciBsb2NhbCA9IHZvaWQgMDtcblxuXHQgICAgICBpZiAodHlwZW9mIGNvbW1vbmpzR2xvYmFsICE9PSAndW5kZWZpbmVkJykge1xuXHQgICAgICAgIGxvY2FsID0gY29tbW9uanNHbG9iYWw7XG5cdCAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHNlbGYgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgICAgbG9jYWwgPSBzZWxmO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICBsb2NhbCA9IEZ1bmN0aW9uKCdyZXR1cm4gdGhpcycpKCk7XG5cdCAgICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdwb2x5ZmlsbCBmYWlsZWQgYmVjYXVzZSBnbG9iYWwgb2JqZWN0IGlzIHVuYXZhaWxhYmxlIGluIHRoaXMgZW52aXJvbm1lbnQnKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgUCA9IGxvY2FsLlByb21pc2U7XG5cblx0ICAgICAgaWYgKFApIHtcblx0ICAgICAgICB2YXIgcHJvbWlzZVRvU3RyaW5nID0gbnVsbDtcblxuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICBwcm9taXNlVG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoUC5yZXNvbHZlKCkpO1xuXHQgICAgICAgIH0gY2F0Y2ggKGUpIHsvLyBzaWxlbnRseSBpZ25vcmVkXG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKHByb21pc2VUb1N0cmluZyA9PT0gJ1tvYmplY3QgUHJvbWlzZV0nICYmICFQLmNhc3QpIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICBsb2NhbC5Qcm9taXNlID0gUHJvbWlzZSQxO1xuXHQgICAgfSAvLyBTdHJhbmdlIGNvbXBhdC4uXG5cblxuXHQgICAgUHJvbWlzZSQxLnBvbHlmaWxsID0gcG9seWZpbGw7XG5cdCAgICBQcm9taXNlJDEuUHJvbWlzZSA9IFByb21pc2UkMTtcblx0ICAgIHJldHVybiBQcm9taXNlJDE7XG5cdCAgfSk7XG5cdH0pO1xuXG5cdHZhciBQcm9taXNlJDEgPSB0eXBlb2YgUHJvbWlzZSAhPT0gXCJ1bmRlZmluZWRcIiA/IFByb21pc2UgOiBlczZQcm9taXNlO1xuXG5cdGZ1bmN0aW9uIHJlZ2lzdGVyTG9nZ2luZ0NhbGxiYWNrcyhvYmopIHtcblx0ICB2YXIgaSxcblx0ICAgICAgbCxcblx0ICAgICAga2V5LFxuXHQgICAgICBjYWxsYmFja05hbWVzID0gW1wiYmVnaW5cIiwgXCJkb25lXCIsIFwibG9nXCIsIFwidGVzdFN0YXJ0XCIsIFwidGVzdERvbmVcIiwgXCJtb2R1bGVTdGFydFwiLCBcIm1vZHVsZURvbmVcIl07XG5cblx0ICBmdW5jdGlvbiByZWdpc3RlckxvZ2dpbmdDYWxsYmFjayhrZXkpIHtcblx0ICAgIHZhciBsb2dnaW5nQ2FsbGJhY2sgPSBmdW5jdGlvbiBsb2dnaW5nQ2FsbGJhY2soY2FsbGJhY2spIHtcblx0ICAgICAgaWYgKG9iamVjdFR5cGUoY2FsbGJhY2spICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJRVW5pdCBsb2dnaW5nIG1ldGhvZHMgcmVxdWlyZSBhIGNhbGxiYWNrIGZ1bmN0aW9uIGFzIHRoZWlyIGZpcnN0IHBhcmFtZXRlcnMuXCIpO1xuXHQgICAgICB9XG5cblx0ICAgICAgY29uZmlnLmNhbGxiYWNrc1trZXldLnB1c2goY2FsbGJhY2spO1xuXHQgICAgfTtcblxuXHQgICAgcmV0dXJuIGxvZ2dpbmdDYWxsYmFjaztcblx0ICB9XG5cblx0ICBmb3IgKGkgPSAwLCBsID0gY2FsbGJhY2tOYW1lcy5sZW5ndGg7IGkgPCBsOyBpKyspIHtcblx0ICAgIGtleSA9IGNhbGxiYWNrTmFtZXNbaV07IC8vIEluaXRpYWxpemUga2V5IGNvbGxlY3Rpb24gb2YgbG9nZ2luZyBjYWxsYmFja1xuXG5cdCAgICBpZiAob2JqZWN0VHlwZShjb25maWcuY2FsbGJhY2tzW2tleV0pID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICAgIGNvbmZpZy5jYWxsYmFja3Nba2V5XSA9IFtdO1xuXHQgICAgfVxuXG5cdCAgICBvYmpba2V5XSA9IHJlZ2lzdGVyTG9nZ2luZ0NhbGxiYWNrKGtleSk7XG5cdCAgfVxuXHR9XG5cdGZ1bmN0aW9uIHJ1bkxvZ2dpbmdDYWxsYmFja3Moa2V5LCBhcmdzKSB7XG5cdCAgdmFyIGNhbGxiYWNrcyA9IGNvbmZpZy5jYWxsYmFja3Nba2V5XTsgLy8gSGFuZGxpbmcgJ2xvZycgY2FsbGJhY2tzIHNlcGFyYXRlbHkuIFVubGlrZSB0aGUgb3RoZXIgY2FsbGJhY2tzLFxuXHQgIC8vIHRoZSBsb2cgY2FsbGJhY2sgaXMgbm90IGNvbnRyb2xsZWQgYnkgdGhlIHByb2Nlc3NpbmcgcXVldWUsXG5cdCAgLy8gYnV0IHJhdGhlciB1c2VkIGJ5IGFzc2VydHMuIEhlbmNlIHRvIHByb21pc2Z5IHRoZSAnbG9nJyBjYWxsYmFja1xuXHQgIC8vIHdvdWxkIG1lYW4gcHJvbWlzZnlpbmcgZWFjaCBzdGVwIG9mIGEgdGVzdFxuXG5cdCAgaWYgKGtleSA9PT0gXCJsb2dcIikge1xuXHQgICAgY2FsbGJhY2tzLm1hcChmdW5jdGlvbiAoY2FsbGJhY2spIHtcblx0ICAgICAgcmV0dXJuIGNhbGxiYWNrKGFyZ3MpO1xuXHQgICAgfSk7XG5cdCAgICByZXR1cm47XG5cdCAgfSAvLyBlbnN1cmUgdGhhdCBlYWNoIGNhbGxiYWNrIGlzIGV4ZWN1dGVkIHNlcmlhbGx5XG5cblxuXHQgIHJldHVybiBjYWxsYmFja3MucmVkdWNlKGZ1bmN0aW9uIChwcm9taXNlQ2hhaW4sIGNhbGxiYWNrKSB7XG5cdCAgICByZXR1cm4gcHJvbWlzZUNoYWluLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gUHJvbWlzZSQxLnJlc29sdmUoY2FsbGJhY2soYXJncykpO1xuXHQgICAgfSk7XG5cdCAgfSwgUHJvbWlzZSQxLnJlc29sdmUoW10pKTtcblx0fVxuXG5cdC8vIERvZXNuJ3Qgc3VwcG9ydCBJRTksIGl0IHdpbGwgcmV0dXJuIHVuZGVmaW5lZCBvbiB0aGVzZSBicm93c2Vyc1xuXHQvLyBTZWUgYWxzbyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi9KYXZhU2NyaXB0L1JlZmVyZW5jZS9HbG9iYWxfT2JqZWN0cy9FcnJvci9TdGFja1xuXHR2YXIgZmlsZU5hbWUgPSAoc291cmNlRnJvbVN0YWNrdHJhY2UoMCkgfHwgXCJcIikucmVwbGFjZSgvKDpcXGQrKStcXCk/LywgXCJcIikucmVwbGFjZSgvLitcXC8vLCBcIlwiKTtcblx0ZnVuY3Rpb24gZXh0cmFjdFN0YWNrdHJhY2UoZSwgb2Zmc2V0KSB7XG5cdCAgb2Zmc2V0ID0gb2Zmc2V0ID09PSB1bmRlZmluZWQgPyA0IDogb2Zmc2V0O1xuXHQgIHZhciBzdGFjaywgaW5jbHVkZSwgaTtcblxuXHQgIGlmIChlICYmIGUuc3RhY2spIHtcblx0ICAgIHN0YWNrID0gZS5zdGFjay5zcGxpdChcIlxcblwiKTtcblxuXHQgICAgaWYgKC9eZXJyb3IkL2kudGVzdChzdGFja1swXSkpIHtcblx0ICAgICAgc3RhY2suc2hpZnQoKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGZpbGVOYW1lKSB7XG5cdCAgICAgIGluY2x1ZGUgPSBbXTtcblxuXHQgICAgICBmb3IgKGkgPSBvZmZzZXQ7IGkgPCBzdGFjay5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGlmIChzdGFja1tpXS5pbmRleE9mKGZpbGVOYW1lKSAhPT0gLTEpIHtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGluY2x1ZGUucHVzaChzdGFja1tpXSk7XG5cdCAgICAgIH1cblxuXHQgICAgICBpZiAoaW5jbHVkZS5sZW5ndGgpIHtcblx0ICAgICAgICByZXR1cm4gaW5jbHVkZS5qb2luKFwiXFxuXCIpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBzdGFja1tvZmZzZXRdO1xuXHQgIH1cblx0fVxuXHRmdW5jdGlvbiBzb3VyY2VGcm9tU3RhY2t0cmFjZShvZmZzZXQpIHtcblx0ICB2YXIgZXJyb3IgPSBuZXcgRXJyb3IoKTsgLy8gU3VwcG9ydDogU2FmYXJpIDw9NyBvbmx5LCBJRSA8PTEwIC0gMTEgb25seVxuXHQgIC8vIE5vdCBhbGwgYnJvd3NlcnMgZ2VuZXJhdGUgdGhlIGBzdGFja2AgcHJvcGVydHkgZm9yIGBuZXcgRXJyb3IoKWAsIHNlZSBhbHNvICM2MzZcblxuXHQgIGlmICghZXJyb3Iuc3RhY2spIHtcblx0ICAgIHRyeSB7XG5cdCAgICAgIHRocm93IGVycm9yO1xuXHQgICAgfSBjYXRjaCAoZXJyKSB7XG5cdCAgICAgIGVycm9yID0gZXJyO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIHJldHVybiBleHRyYWN0U3RhY2t0cmFjZShlcnJvciwgb2Zmc2V0KTtcblx0fVxuXG5cdHZhciBwcmlvcml0eUNvdW50ID0gMDtcblx0dmFyIHVuaXRTYW1wbGVyOyAvLyBUaGlzIGlzIGEgcXVldWUgb2YgZnVuY3Rpb25zIHRoYXQgYXJlIHRhc2tzIHdpdGhpbiBhIHNpbmdsZSB0ZXN0LlxuXHQvLyBBZnRlciB0ZXN0cyBhcmUgZGVxdWV1ZWQgZnJvbSBjb25maWcucXVldWUgdGhleSBhcmUgZXhwYW5kZWQgaW50b1xuXHQvLyBhIHNldCBvZiB0YXNrcyBpbiB0aGlzIHF1ZXVlLlxuXG5cdHZhciB0YXNrUXVldWUgPSBbXTtcblx0LyoqXG5cdCAqIEFkdmFuY2VzIHRoZSB0YXNrUXVldWUgdG8gdGhlIG5leHQgdGFzay4gSWYgdGhlIHRhc2tRdWV1ZSBpcyBlbXB0eSxcblx0ICogcHJvY2VzcyB0aGUgdGVzdFF1ZXVlXG5cdCAqL1xuXG5cdGZ1bmN0aW9uIGFkdmFuY2UoKSB7XG5cdCAgYWR2YW5jZVRhc2tRdWV1ZSgpO1xuXG5cdCAgaWYgKCF0YXNrUXVldWUubGVuZ3RoICYmICFjb25maWcuYmxvY2tpbmcgJiYgIWNvbmZpZy5jdXJyZW50KSB7XG5cdCAgICBhZHZhbmNlVGVzdFF1ZXVlKCk7XG5cdCAgfVxuXHR9XG5cdC8qKlxuXHQgKiBBZHZhbmNlcyB0aGUgdGFza1F1ZXVlIHdpdGggYW4gaW5jcmVhc2VkIGRlcHRoXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gYWR2YW5jZVRhc2tRdWV1ZSgpIHtcblx0ICB2YXIgc3RhcnQgPSBub3coKTtcblx0ICBjb25maWcuZGVwdGggPSAoY29uZmlnLmRlcHRoIHx8IDApICsgMTtcblx0ICBwcm9jZXNzVGFza1F1ZXVlKHN0YXJ0KTtcblx0ICBjb25maWcuZGVwdGgtLTtcblx0fVxuXHQvKipcblx0ICogUHJvY2VzcyB0aGUgZmlyc3QgdGFzayBvbiB0aGUgdGFza1F1ZXVlIGFzIGEgcHJvbWlzZS5cblx0ICogRWFjaCB0YXNrIGlzIGEgZnVuY3Rpb24gcmV0dXJuZWQgYnkgaHR0cHM6Ly9naXRodWIuY29tL3F1bml0anMvcXVuaXQvYmxvYi9tYXN0ZXIvc3JjL3Rlc3QuanMjTDM4MVxuXHQgKi9cblxuXG5cdGZ1bmN0aW9uIHByb2Nlc3NUYXNrUXVldWUoc3RhcnQpIHtcblx0ICBpZiAodGFza1F1ZXVlLmxlbmd0aCAmJiAhY29uZmlnLmJsb2NraW5nKSB7XG5cdCAgICB2YXIgZWxhcHNlZFRpbWUgPSBub3coKSAtIHN0YXJ0O1xuXG5cdCAgICBpZiAoIWRlZmluZWQuc2V0VGltZW91dCB8fCBjb25maWcudXBkYXRlUmF0ZSA8PSAwIHx8IGVsYXBzZWRUaW1lIDwgY29uZmlnLnVwZGF0ZVJhdGUpIHtcblx0ICAgICAgdmFyIHRhc2sgPSB0YXNrUXVldWUuc2hpZnQoKTtcblx0ICAgICAgUHJvbWlzZSQxLnJlc29sdmUodGFzaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBpZiAoIXRhc2tRdWV1ZS5sZW5ndGgpIHtcblx0ICAgICAgICAgIGFkdmFuY2UoKTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgcHJvY2Vzc1Rhc2tRdWV1ZShzdGFydCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHNldFRpbWVvdXQkMShhZHZhbmNlKTtcblx0ICAgIH1cblx0ICB9XG5cdH1cblx0LyoqXG5cdCAqIEFkdmFuY2UgdGhlIHRlc3RRdWV1ZSB0byB0aGUgbmV4dCB0ZXN0IHRvIHByb2Nlc3MuIENhbGwgZG9uZSgpIGlmIHRlc3RRdWV1ZSBjb21wbGV0ZXMuXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gYWR2YW5jZVRlc3RRdWV1ZSgpIHtcblx0ICBpZiAoIWNvbmZpZy5ibG9ja2luZyAmJiAhY29uZmlnLnF1ZXVlLmxlbmd0aCAmJiBjb25maWcuZGVwdGggPT09IDApIHtcblx0ICAgIGRvbmUoKTtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICB2YXIgdGVzdFRhc2tzID0gY29uZmlnLnF1ZXVlLnNoaWZ0KCk7XG5cdCAgYWRkVG9UYXNrUXVldWUodGVzdFRhc2tzKCkpO1xuXG5cdCAgaWYgKHByaW9yaXR5Q291bnQgPiAwKSB7XG5cdCAgICBwcmlvcml0eUNvdW50LS07XG5cdCAgfVxuXG5cdCAgYWR2YW5jZSgpO1xuXHR9XG5cdC8qKlxuXHQgKiBFbnF1ZXVlIHRoZSB0YXNrcyBmb3IgYSB0ZXN0IGludG8gdGhlIHRhc2sgcXVldWUuXG5cdCAqIEBwYXJhbSB7QXJyYXl9IHRhc2tzQXJyYXlcblx0ICovXG5cblxuXHRmdW5jdGlvbiBhZGRUb1Rhc2tRdWV1ZSh0YXNrc0FycmF5KSB7XG5cdCAgdGFza1F1ZXVlLnB1c2guYXBwbHkodGFza1F1ZXVlLCBfdG9Db25zdW1hYmxlQXJyYXkodGFza3NBcnJheSkpO1xuXHR9XG5cdC8qKlxuXHQgKiBSZXR1cm4gdGhlIG51bWJlciBvZiB0YXNrcyByZW1haW5pbmcgaW4gdGhlIHRhc2sgcXVldWUgdG8gYmUgcHJvY2Vzc2VkLlxuXHQgKiBAcmV0dXJuIHtOdW1iZXJ9XG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gdGFza1F1ZXVlTGVuZ3RoKCkge1xuXHQgIHJldHVybiB0YXNrUXVldWUubGVuZ3RoO1xuXHR9XG5cdC8qKlxuXHQgKiBBZGRzIGEgdGVzdCB0byB0aGUgVGVzdFF1ZXVlIGZvciBleGVjdXRpb24uXG5cdCAqIEBwYXJhbSB7RnVuY3Rpb259IHRlc3RUYXNrc0Z1bmNcblx0ICogQHBhcmFtIHtCb29sZWFufSBwcmlvcml0aXplXG5cdCAqIEBwYXJhbSB7U3RyaW5nfSBzZWVkXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gYWRkVG9UZXN0UXVldWUodGVzdFRhc2tzRnVuYywgcHJpb3JpdGl6ZSwgc2VlZCkge1xuXHQgIGlmIChwcmlvcml0aXplKSB7XG5cdCAgICBjb25maWcucXVldWUuc3BsaWNlKHByaW9yaXR5Q291bnQrKywgMCwgdGVzdFRhc2tzRnVuYyk7XG5cdCAgfSBlbHNlIGlmIChzZWVkKSB7XG5cdCAgICBpZiAoIXVuaXRTYW1wbGVyKSB7XG5cdCAgICAgIHVuaXRTYW1wbGVyID0gdW5pdFNhbXBsZXJHZW5lcmF0b3Ioc2VlZCk7XG5cdCAgICB9IC8vIEluc2VydCBpbnRvIGEgcmFuZG9tIHBvc2l0aW9uIGFmdGVyIGFsbCBwcmlvcml0aXplZCBpdGVtc1xuXG5cblx0ICAgIHZhciBpbmRleCA9IE1hdGguZmxvb3IodW5pdFNhbXBsZXIoKSAqIChjb25maWcucXVldWUubGVuZ3RoIC0gcHJpb3JpdHlDb3VudCArIDEpKTtcblx0ICAgIGNvbmZpZy5xdWV1ZS5zcGxpY2UocHJpb3JpdHlDb3VudCArIGluZGV4LCAwLCB0ZXN0VGFza3NGdW5jKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgY29uZmlnLnF1ZXVlLnB1c2godGVzdFRhc2tzRnVuYyk7XG5cdCAgfVxuXHR9XG5cdC8qKlxuXHQgKiBDcmVhdGVzIGEgc2VlZGVkIFwic2FtcGxlXCIgZ2VuZXJhdG9yIHdoaWNoIGlzIHVzZWQgZm9yIHJhbmRvbWl6aW5nIHRlc3RzLlxuXHQgKi9cblxuXG5cdGZ1bmN0aW9uIHVuaXRTYW1wbGVyR2VuZXJhdG9yKHNlZWQpIHtcblx0ICAvLyAzMi1iaXQgeG9yc2hpZnQsIHJlcXVpcmVzIG9ubHkgYSBub256ZXJvIHNlZWRcblx0ICAvLyBodHRwczovL2V4Y2FtZXJhLmNvbS9zcGhpbngvYXJ0aWNsZS14b3JzaGlmdC5odG1sXG5cdCAgdmFyIHNhbXBsZSA9IHBhcnNlSW50KGdlbmVyYXRlSGFzaChzZWVkKSwgMTYpIHx8IC0xO1xuXHQgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICBzYW1wbGUgXj0gc2FtcGxlIDw8IDEzO1xuXHQgICAgc2FtcGxlIF49IHNhbXBsZSA+Pj4gMTc7XG5cdCAgICBzYW1wbGUgXj0gc2FtcGxlIDw8IDU7IC8vIEVDTUFTY3JpcHQgaGFzIG5vIHVuc2lnbmVkIG51bWJlciB0eXBlXG5cblx0ICAgIGlmIChzYW1wbGUgPCAwKSB7XG5cdCAgICAgIHNhbXBsZSArPSAweDEwMDAwMDAwMDtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHNhbXBsZSAvIDB4MTAwMDAwMDAwO1xuXHQgIH07XG5cdH1cblx0LyoqXG5cdCAqIFRoaXMgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gdGhlIFByb2Nlc3NpbmdRdWV1ZSBpcyBkb25lIHByb2Nlc3NpbmcgYWxsXG5cdCAqIGl0ZW1zLiBJdCBoYW5kbGVzIGVtaXR0aW5nIHRoZSBmaW5hbCBydW4gZXZlbnRzLlxuXHQgKi9cblxuXG5cdGZ1bmN0aW9uIGRvbmUoKSB7XG5cdCAgdmFyIHN0b3JhZ2UgPSBjb25maWcuc3RvcmFnZTtcblx0ICBQcm9jZXNzaW5nUXVldWUuZmluaXNoZWQgPSB0cnVlO1xuXHQgIHZhciBydW50aW1lID0gbm93KCkgLSBjb25maWcuc3RhcnRlZDtcblx0ICB2YXIgcGFzc2VkID0gY29uZmlnLnN0YXRzLmFsbCAtIGNvbmZpZy5zdGF0cy5iYWQ7XG5cblx0ICBpZiAoY29uZmlnLnN0YXRzLnRlc3RDb3VudCA9PT0gMCkge1xuXHQgICAgaWYgKGNvbmZpZy5maWx0ZXIgJiYgY29uZmlnLmZpbHRlci5sZW5ndGgpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGVzdHMgbWF0Y2hlZCB0aGUgZmlsdGVyIFxcXCJcIi5jb25jYXQoY29uZmlnLmZpbHRlciwgXCJcXFwiLlwiKSk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcubW9kdWxlICYmIGNvbmZpZy5tb2R1bGUubGVuZ3RoKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRlc3RzIG1hdGNoZWQgdGhlIG1vZHVsZSBcXFwiXCIuY29uY2F0KGNvbmZpZy5tb2R1bGUsIFwiXFxcIi5cIikpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29uZmlnLm1vZHVsZUlkICYmIGNvbmZpZy5tb2R1bGVJZC5sZW5ndGgpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGVzdHMgbWF0Y2hlZCB0aGUgbW9kdWxlSWQgXFxcIlwiLmNvbmNhdChjb25maWcubW9kdWxlSWQsIFwiXFxcIi5cIikpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29uZmlnLnRlc3RJZCAmJiBjb25maWcudGVzdElkLmxlbmd0aCkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0ZXN0cyBtYXRjaGVkIHRoZSB0ZXN0SWQgXFxcIlwiLmNvbmNhdChjb25maWcudGVzdElkLCBcIlxcXCIuXCIpKTtcblx0ICAgIH1cblxuXHQgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGVzdHMgd2VyZSBydW4uXCIpO1xuXHQgIH1cblxuXHQgIGVtaXQoXCJydW5FbmRcIiwgZ2xvYmFsU3VpdGUuZW5kKHRydWUpKTtcblx0ICBydW5Mb2dnaW5nQ2FsbGJhY2tzKFwiZG9uZVwiLCB7XG5cdCAgICBwYXNzZWQ6IHBhc3NlZCxcblx0ICAgIGZhaWxlZDogY29uZmlnLnN0YXRzLmJhZCxcblx0ICAgIHRvdGFsOiBjb25maWcuc3RhdHMuYWxsLFxuXHQgICAgcnVudGltZTogcnVudGltZVxuXHQgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgLy8gQ2xlYXIgb3duIHN0b3JhZ2UgaXRlbXMgaWYgYWxsIHRlc3RzIHBhc3NlZFxuXHQgICAgaWYgKHN0b3JhZ2UgJiYgY29uZmlnLnN0YXRzLmJhZCA9PT0gMCkge1xuXHQgICAgICBmb3IgKHZhciBpID0gc3RvcmFnZS5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuXHQgICAgICAgIHZhciBrZXkgPSBzdG9yYWdlLmtleShpKTtcblxuXHQgICAgICAgIGlmIChrZXkuaW5kZXhPZihcInF1bml0LXRlc3QtXCIpID09PSAwKSB7XG5cdCAgICAgICAgICBzdG9yYWdlLnJlbW92ZUl0ZW0oa2V5KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9KTtcblx0fVxuXG5cdHZhciBQcm9jZXNzaW5nUXVldWUgPSB7XG5cdCAgZmluaXNoZWQ6IGZhbHNlLFxuXHQgIGFkZDogYWRkVG9UZXN0UXVldWUsXG5cdCAgYWR2YW5jZTogYWR2YW5jZSxcblx0ICB0YXNrQ291bnQ6IHRhc2tRdWV1ZUxlbmd0aFxuXHR9O1xuXG5cdHZhciBUZXN0UmVwb3J0ID0gLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHtcblx0ICBmdW5jdGlvbiBUZXN0UmVwb3J0KG5hbWUsIHN1aXRlLCBvcHRpb25zKSB7XG5cdCAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgVGVzdFJlcG9ydCk7XG5cblx0ICAgIHRoaXMubmFtZSA9IG5hbWU7XG5cdCAgICB0aGlzLnN1aXRlTmFtZSA9IHN1aXRlLm5hbWU7XG5cdCAgICB0aGlzLmZ1bGxOYW1lID0gc3VpdGUuZnVsbE5hbWUuY29uY2F0KG5hbWUpO1xuXHQgICAgdGhpcy5ydW50aW1lID0gMDtcblx0ICAgIHRoaXMuYXNzZXJ0aW9ucyA9IFtdO1xuXHQgICAgdGhpcy5za2lwcGVkID0gISFvcHRpb25zLnNraXA7XG5cdCAgICB0aGlzLnRvZG8gPSAhIW9wdGlvbnMudG9kbztcblx0ICAgIHRoaXMudmFsaWQgPSBvcHRpb25zLnZhbGlkO1xuXHQgICAgdGhpcy5fc3RhcnRUaW1lID0gMDtcblx0ICAgIHRoaXMuX2VuZFRpbWUgPSAwO1xuXHQgICAgc3VpdGUucHVzaFRlc3QodGhpcyk7XG5cdCAgfVxuXG5cdCAgX2NyZWF0ZUNsYXNzKFRlc3RSZXBvcnQsIFt7XG5cdCAgICBrZXk6IFwic3RhcnRcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydChyZWNvcmRUaW1lKSB7XG5cdCAgICAgIGlmIChyZWNvcmRUaW1lKSB7XG5cdCAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcblxuXHQgICAgICAgIGlmIChwZXJmb3JtYW5jZSkge1xuXHQgICAgICAgICAgcGVyZm9ybWFuY2UubWFyayhcInF1bml0X3Rlc3Rfc3RhcnRcIik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBuYW1lOiB0aGlzLm5hbWUsXG5cdCAgICAgICAgc3VpdGVOYW1lOiB0aGlzLnN1aXRlTmFtZSxcblx0ICAgICAgICBmdWxsTmFtZTogdGhpcy5mdWxsTmFtZS5zbGljZSgpXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImVuZFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGVuZChyZWNvcmRUaW1lKSB7XG5cdCAgICAgIGlmIChyZWNvcmRUaW1lKSB7XG5cdCAgICAgICAgdGhpcy5fZW5kVGltZSA9IHBlcmZvcm1hbmNlTm93KCk7XG5cblx0ICAgICAgICBpZiAocGVyZm9ybWFuY2UpIHtcblx0ICAgICAgICAgIHBlcmZvcm1hbmNlLm1hcmsoXCJxdW5pdF90ZXN0X2VuZFwiKTtcblx0ICAgICAgICAgIHZhciB0ZXN0TmFtZSA9IHRoaXMuZnVsbE5hbWUuam9pbihcIiDigJMgXCIpO1xuXHQgICAgICAgICAgbWVhc3VyZShcIlFVbml0IFRlc3Q6IFwiLmNvbmNhdCh0ZXN0TmFtZSksIFwicXVuaXRfdGVzdF9zdGFydFwiLCBcInF1bml0X3Rlc3RfZW5kXCIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBleHRlbmQodGhpcy5zdGFydCgpLCB7XG5cdCAgICAgICAgcnVudGltZTogdGhpcy5nZXRSdW50aW1lKCksXG5cdCAgICAgICAgc3RhdHVzOiB0aGlzLmdldFN0YXR1cygpLFxuXHQgICAgICAgIGVycm9yczogdGhpcy5nZXRGYWlsZWRBc3NlcnRpb25zKCksXG5cdCAgICAgICAgYXNzZXJ0aW9uczogdGhpcy5nZXRBc3NlcnRpb25zKClcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInB1c2hBc3NlcnRpb25cIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBwdXNoQXNzZXJ0aW9uKGFzc2VydGlvbikge1xuXHQgICAgICB0aGlzLmFzc2VydGlvbnMucHVzaChhc3NlcnRpb24pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJnZXRSdW50aW1lXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0UnVudGltZSgpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuX2VuZFRpbWUgLSB0aGlzLl9zdGFydFRpbWU7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImdldFN0YXR1c1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFN0YXR1cygpIHtcblx0ICAgICAgaWYgKHRoaXMuc2tpcHBlZCkge1xuXHQgICAgICAgIHJldHVybiBcInNraXBwZWRcIjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciB0ZXN0UGFzc2VkID0gdGhpcy5nZXRGYWlsZWRBc3NlcnRpb25zKCkubGVuZ3RoID4gMCA/IHRoaXMudG9kbyA6ICF0aGlzLnRvZG87XG5cblx0ICAgICAgaWYgKCF0ZXN0UGFzc2VkKSB7XG5cdCAgICAgICAgcmV0dXJuIFwiZmFpbGVkXCI7XG5cdCAgICAgIH0gZWxzZSBpZiAodGhpcy50b2RvKSB7XG5cdCAgICAgICAgcmV0dXJuIFwidG9kb1wiO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiBcInBhc3NlZFwiO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImdldEZhaWxlZEFzc2VydGlvbnNcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRGYWlsZWRBc3NlcnRpb25zKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5hc3NlcnRpb25zLmZpbHRlcihmdW5jdGlvbiAoYXNzZXJ0aW9uKSB7XG5cdCAgICAgICAgcmV0dXJuICFhc3NlcnRpb24ucGFzc2VkO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0QXNzZXJ0aW9uc1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEFzc2VydGlvbnMoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmFzc2VydGlvbnMuc2xpY2UoKTtcblx0ICAgIH0gLy8gUmVtb3ZlIGFjdHVhbCBhbmQgZXhwZWN0ZWQgdmFsdWVzIGZyb20gYXNzZXJ0aW9ucy4gVGhpcyBpcyB0byBwcmV2ZW50XG5cdCAgICAvLyBsZWFraW5nIG1lbW9yeSB0aHJvdWdob3V0IGEgdGVzdCBzdWl0ZS5cblxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJzbGltQXNzZXJ0aW9uc1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHNsaW1Bc3NlcnRpb25zKCkge1xuXHQgICAgICB0aGlzLmFzc2VydGlvbnMgPSB0aGlzLmFzc2VydGlvbnMubWFwKGZ1bmN0aW9uIChhc3NlcnRpb24pIHtcblx0ICAgICAgICBkZWxldGUgYXNzZXJ0aW9uLmFjdHVhbDtcblx0ICAgICAgICBkZWxldGUgYXNzZXJ0aW9uLmV4cGVjdGVkO1xuXHQgICAgICAgIHJldHVybiBhc3NlcnRpb247XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH1dKTtcblxuXHQgIHJldHVybiBUZXN0UmVwb3J0O1xuXHR9KCk7XG5cblx0dmFyIGZvY3VzZWQkMSA9IGZhbHNlO1xuXHRmdW5jdGlvbiBUZXN0KHNldHRpbmdzKSB7XG5cdCAgdmFyIGksIGw7XG5cdCAgKytUZXN0LmNvdW50O1xuXHQgIHRoaXMuZXhwZWN0ZWQgPSBudWxsO1xuXHQgIHRoaXMuYXNzZXJ0aW9ucyA9IFtdO1xuXHQgIHRoaXMuc2VtYXBob3JlID0gMDtcblx0ICB0aGlzLm1vZHVsZSA9IGNvbmZpZy5jdXJyZW50TW9kdWxlO1xuXHQgIHRoaXMuc3RlcHMgPSBbXTtcblx0ICB0aGlzLnRpbWVvdXQgPSB1bmRlZmluZWQ7XG5cdCAgdGhpcy5lcnJvckZvclN0YWNrID0gbmV3IEVycm9yKCk7IC8vIElmIGEgbW9kdWxlIGlzIHNraXBwZWQsIGFsbCBpdHMgdGVzdHMgYW5kIHRoZSB0ZXN0cyBvZiB0aGUgY2hpbGQgc3VpdGVzXG5cdCAgLy8gc2hvdWxkIGJlIHRyZWF0ZWQgYXMgc2tpcHBlZCBldmVuIGlmIHRoZXkgYXJlIGRlZmluZWQgYXMgYG9ubHlgIG9yIGB0b2RvYC5cblx0ICAvLyBBcyBmb3IgYHRvZG9gIG1vZHVsZSwgYWxsIGl0cyB0ZXN0cyB3aWxsIGJlIHRyZWF0ZWQgYXMgYHRvZG9gIGV4Y2VwdCBmb3Jcblx0ICAvLyB0ZXN0cyBkZWZpbmVkIGFzIGBza2lwYCB3aGljaCB3aWxsIGJlIGxlZnQgaW50YWN0LlxuXHQgIC8vXG5cdCAgLy8gU28sIGlmIGEgdGVzdCBpcyBkZWZpbmVkIGFzIGB0b2RvYCBhbmQgaXMgaW5zaWRlIGEgc2tpcHBlZCBtb2R1bGUsIHdlIHNob3VsZFxuXHQgIC8vIHRoZW4gdHJlYXQgdGhhdCB0ZXN0IGFzIGlmIHdhcyBkZWZpbmVkIGFzIGBza2lwYC5cblxuXHQgIGlmICh0aGlzLm1vZHVsZS5za2lwKSB7XG5cdCAgICBzZXR0aW5ncy5za2lwID0gdHJ1ZTtcblx0ICAgIHNldHRpbmdzLnRvZG8gPSBmYWxzZTsgLy8gU2tpcHBlZCB0ZXN0cyBzaG91bGQgYmUgbGVmdCBpbnRhY3Rcblx0ICB9IGVsc2UgaWYgKHRoaXMubW9kdWxlLnRvZG8gJiYgIXNldHRpbmdzLnNraXApIHtcblx0ICAgIHNldHRpbmdzLnRvZG8gPSB0cnVlO1xuXHQgIH1cblxuXHQgIGV4dGVuZCh0aGlzLCBzZXR0aW5ncyk7XG5cdCAgdGhpcy50ZXN0UmVwb3J0ID0gbmV3IFRlc3RSZXBvcnQoc2V0dGluZ3MudGVzdE5hbWUsIHRoaXMubW9kdWxlLnN1aXRlUmVwb3J0LCB7XG5cdCAgICB0b2RvOiBzZXR0aW5ncy50b2RvLFxuXHQgICAgc2tpcDogc2V0dGluZ3Muc2tpcCxcblx0ICAgIHZhbGlkOiB0aGlzLnZhbGlkKClcblx0ICB9KTsgLy8gUmVnaXN0ZXIgdW5pcXVlIHN0cmluZ3NcblxuXHQgIGZvciAoaSA9IDAsIGwgPSB0aGlzLm1vZHVsZS50ZXN0czsgaSA8IGwubGVuZ3RoOyBpKyspIHtcblx0ICAgIGlmICh0aGlzLm1vZHVsZS50ZXN0c1tpXS5uYW1lID09PSB0aGlzLnRlc3ROYW1lKSB7XG5cdCAgICAgIHRoaXMudGVzdE5hbWUgKz0gXCIgXCI7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgdGhpcy50ZXN0SWQgPSBnZW5lcmF0ZUhhc2godGhpcy5tb2R1bGUubmFtZSwgdGhpcy50ZXN0TmFtZSk7XG5cdCAgdGhpcy5tb2R1bGUudGVzdHMucHVzaCh7XG5cdCAgICBuYW1lOiB0aGlzLnRlc3ROYW1lLFxuXHQgICAgdGVzdElkOiB0aGlzLnRlc3RJZCxcblx0ICAgIHNraXA6ICEhc2V0dGluZ3Muc2tpcFxuXHQgIH0pO1xuXG5cdCAgaWYgKHNldHRpbmdzLnNraXApIHtcblx0ICAgIC8vIFNraXBwZWQgdGVzdHMgd2lsbCBmdWxseSBpZ25vcmUgYW55IHNlbnQgY2FsbGJhY2tcblx0ICAgIHRoaXMuY2FsbGJhY2sgPSBmdW5jdGlvbiAoKSB7fTtcblxuXHQgICAgdGhpcy5hc3luYyA9IGZhbHNlO1xuXHQgICAgdGhpcy5leHBlY3RlZCA9IDA7XG5cdCAgfSBlbHNlIHtcblx0ICAgIGlmICh0eXBlb2YgdGhpcy5jYWxsYmFjayAhPT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICAgIHZhciBtZXRob2QgPSB0aGlzLnRvZG8gPyBcInRvZG9cIiA6IFwidGVzdFwiOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbWF4LWxlblxuXG5cdCAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJZb3UgbXVzdCBwcm92aWRlIGEgZnVuY3Rpb24gYXMgYSB0ZXN0IGNhbGxiYWNrIHRvIFFVbml0LlwiLmNvbmNhdChtZXRob2QsIFwiKFxcXCJcIikuY29uY2F0KHNldHRpbmdzLnRlc3ROYW1lLCBcIlxcXCIpXCIpKTtcblx0ICAgIH1cblxuXHQgICAgdGhpcy5hc3NlcnQgPSBuZXcgQXNzZXJ0KHRoaXMpO1xuXHQgIH1cblx0fVxuXHRUZXN0LmNvdW50ID0gMDtcblxuXHRmdW5jdGlvbiBnZXROb3RTdGFydGVkTW9kdWxlcyhzdGFydE1vZHVsZSkge1xuXHQgIHZhciBtb2R1bGUgPSBzdGFydE1vZHVsZSxcblx0ICAgICAgbW9kdWxlcyA9IFtdO1xuXG5cdCAgd2hpbGUgKG1vZHVsZSAmJiBtb2R1bGUudGVzdHNSdW4gPT09IDApIHtcblx0ICAgIG1vZHVsZXMucHVzaChtb2R1bGUpO1xuXHQgICAgbW9kdWxlID0gbW9kdWxlLnBhcmVudE1vZHVsZTtcblx0ICB9IC8vIFRoZSBhYm92ZSBwdXNoIG1vZHVsZXMgZnJvbSB0aGUgY2hpbGQgdG8gdGhlIHBhcmVudFxuXHQgIC8vIHJldHVybiBhIHJldmVyc2VkIG9yZGVyIHdpdGggdGhlIHRvcCBiZWluZyB0aGUgdG9wIG1vc3QgcGFyZW50IG1vZHVsZVxuXG5cblx0ICByZXR1cm4gbW9kdWxlcy5yZXZlcnNlKCk7XG5cdH1cblxuXHRUZXN0LnByb3RvdHlwZSA9IHtcblx0ICAvLyBnZW5lcmF0aW5nIGEgc3RhY2sgdHJhY2UgY2FuIGJlIGV4cGVuc2l2ZSwgc28gdXNpbmcgYSBnZXR0ZXIgZGVmZXJzIHRoaXMgdW50aWwgd2UgbmVlZCBpdFxuXHQgIGdldCBzdGFjaygpIHtcblx0ICAgIHJldHVybiBleHRyYWN0U3RhY2t0cmFjZSh0aGlzLmVycm9yRm9yU3RhY2ssIDIpO1xuXHQgIH0sXG5cblx0ICBiZWZvcmU6IGZ1bmN0aW9uIGJlZm9yZSgpIHtcblx0ICAgIHZhciBfdGhpcyA9IHRoaXM7XG5cblx0ICAgIHZhciBtb2R1bGUgPSB0aGlzLm1vZHVsZSxcblx0ICAgICAgICBub3RTdGFydGVkTW9kdWxlcyA9IGdldE5vdFN0YXJ0ZWRNb2R1bGVzKG1vZHVsZSk7IC8vIGVuc3VyZSB0aGUgY2FsbGJhY2tzIGFyZSBleGVjdXRlZCBzZXJpYWxseSBmb3IgZWFjaCBtb2R1bGVcblxuXHQgICAgdmFyIGNhbGxiYWNrUHJvbWlzZXMgPSBub3RTdGFydGVkTW9kdWxlcy5yZWR1Y2UoZnVuY3Rpb24gKHByb21pc2VDaGFpbiwgc3RhcnRNb2R1bGUpIHtcblx0ICAgICAgcmV0dXJuIHByb21pc2VDaGFpbi50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICBzdGFydE1vZHVsZS5zdGF0cyA9IHtcblx0ICAgICAgICAgIGFsbDogMCxcblx0ICAgICAgICAgIGJhZDogMCxcblx0ICAgICAgICAgIHN0YXJ0ZWQ6IG5vdygpXG5cdCAgICAgICAgfTtcblx0ICAgICAgICBlbWl0KFwic3VpdGVTdGFydFwiLCBzdGFydE1vZHVsZS5zdWl0ZVJlcG9ydC5zdGFydCh0cnVlKSk7XG5cdCAgICAgICAgcmV0dXJuIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJtb2R1bGVTdGFydFwiLCB7XG5cdCAgICAgICAgICBuYW1lOiBzdGFydE1vZHVsZS5uYW1lLFxuXHQgICAgICAgICAgdGVzdHM6IHN0YXJ0TW9kdWxlLnRlc3RzXG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0pO1xuXHQgICAgfSwgUHJvbWlzZSQxLnJlc29sdmUoW10pKTtcblx0ICAgIHJldHVybiBjYWxsYmFja1Byb21pc2VzLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICBjb25maWcuY3VycmVudCA9IF90aGlzO1xuXHQgICAgICBfdGhpcy50ZXN0RW52aXJvbm1lbnQgPSBleHRlbmQoe30sIG1vZHVsZS50ZXN0RW52aXJvbm1lbnQpO1xuXHQgICAgICBfdGhpcy5zdGFydGVkID0gbm93KCk7XG5cdCAgICAgIGVtaXQoXCJ0ZXN0U3RhcnRcIiwgX3RoaXMudGVzdFJlcG9ydC5zdGFydCh0cnVlKSk7XG5cdCAgICAgIHJldHVybiBydW5Mb2dnaW5nQ2FsbGJhY2tzKFwidGVzdFN0YXJ0XCIsIHtcblx0ICAgICAgICBuYW1lOiBfdGhpcy50ZXN0TmFtZSxcblx0ICAgICAgICBtb2R1bGU6IG1vZHVsZS5uYW1lLFxuXHQgICAgICAgIHRlc3RJZDogX3RoaXMudGVzdElkLFxuXHQgICAgICAgIHByZXZpb3VzRmFpbHVyZTogX3RoaXMucHJldmlvdXNGYWlsdXJlXG5cdCAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghY29uZmlnLnBvbGx1dGlvbikge1xuXHQgICAgICAgICAgc2F2ZUdsb2JhbCgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICB9KTtcblx0ICB9LFxuXHQgIHJ1bjogZnVuY3Rpb24gcnVuKCkge1xuXHQgICAgdmFyIHByb21pc2U7XG5cdCAgICBjb25maWcuY3VycmVudCA9IHRoaXM7XG5cdCAgICB0aGlzLmNhbGxiYWNrU3RhcnRlZCA9IG5vdygpO1xuXG5cdCAgICBpZiAoY29uZmlnLm5vdHJ5Y2F0Y2gpIHtcblx0ICAgICAgcnVuVGVzdCh0aGlzKTtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICB0cnkge1xuXHQgICAgICBydW5UZXN0KHRoaXMpO1xuXHQgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICB0aGlzLnB1c2hGYWlsdXJlKFwiRGllZCBvbiB0ZXN0ICNcIiArICh0aGlzLmFzc2VydGlvbnMubGVuZ3RoICsgMSkgKyBcIiBcIiArIHRoaXMuc3RhY2sgKyBcIjogXCIgKyAoZS5tZXNzYWdlIHx8IGUpLCBleHRyYWN0U3RhY2t0cmFjZShlLCAwKSk7IC8vIEVsc2UgbmV4dCB0ZXN0IHdpbGwgY2FycnkgdGhlIHJlc3BvbnNpYmlsaXR5XG5cblx0ICAgICAgc2F2ZUdsb2JhbCgpOyAvLyBSZXN0YXJ0IHRoZSB0ZXN0cyBpZiB0aGV5J3JlIGJsb2NraW5nXG5cblx0ICAgICAgaWYgKGNvbmZpZy5ibG9ja2luZykge1xuXHQgICAgICAgIGludGVybmFsUmVjb3Zlcih0aGlzKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBydW5UZXN0KHRlc3QpIHtcblx0ICAgICAgcHJvbWlzZSA9IHRlc3QuY2FsbGJhY2suY2FsbCh0ZXN0LnRlc3RFbnZpcm9ubWVudCwgdGVzdC5hc3NlcnQpO1xuXHQgICAgICB0ZXN0LnJlc29sdmVQcm9taXNlKHByb21pc2UpOyAvLyBJZiB0aGUgdGVzdCBoYXMgYSBcImxvY2tcIiBvbiBpdCwgYnV0IHRoZSB0aW1lb3V0IGlzIDAsIHRoZW4gd2UgcHVzaCBhXG5cdCAgICAgIC8vIGZhaWx1cmUgYXMgdGhlIHRlc3Qgc2hvdWxkIGJlIHN5bmNocm9ub3VzLlxuXG5cdCAgICAgIGlmICh0ZXN0LnRpbWVvdXQgPT09IDAgJiYgdGVzdC5zZW1hcGhvcmUgIT09IDApIHtcblx0ICAgICAgICBwdXNoRmFpbHVyZShcIlRlc3QgZGlkIG5vdCBmaW5pc2ggc3luY2hyb25vdXNseSBldmVuIHRob3VnaCBhc3NlcnQudGltZW91dCggMCApIHdhcyB1c2VkLlwiLCBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LFxuXHQgIGFmdGVyOiBmdW5jdGlvbiBhZnRlcigpIHtcblx0ICAgIGNoZWNrUG9sbHV0aW9uKCk7XG5cdCAgfSxcblx0ICBxdWV1ZUhvb2s6IGZ1bmN0aW9uIHF1ZXVlSG9vayhob29rLCBob29rTmFtZSwgaG9va093bmVyKSB7XG5cdCAgICB2YXIgX3RoaXMyID0gdGhpcztcblxuXHQgICAgdmFyIGNhbGxIb29rID0gZnVuY3Rpb24gY2FsbEhvb2soKSB7XG5cdCAgICAgIHZhciBwcm9taXNlID0gaG9vay5jYWxsKF90aGlzMi50ZXN0RW52aXJvbm1lbnQsIF90aGlzMi5hc3NlcnQpO1xuXG5cdCAgICAgIF90aGlzMi5yZXNvbHZlUHJvbWlzZShwcm9taXNlLCBob29rTmFtZSk7XG5cdCAgICB9O1xuXG5cdCAgICB2YXIgcnVuSG9vayA9IGZ1bmN0aW9uIHJ1bkhvb2soKSB7XG5cdCAgICAgIGlmIChob29rTmFtZSA9PT0gXCJiZWZvcmVcIikge1xuXHQgICAgICAgIGlmIChob29rT3duZXIudW5za2lwcGVkVGVzdHNSdW4gIT09IDApIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBfdGhpczIucHJlc2VydmVFbnZpcm9ubWVudCA9IHRydWU7XG5cdCAgICAgIH0gLy8gVGhlICdhZnRlcicgaG9vayBzaG91bGQgb25seSBleGVjdXRlIHdoZW4gdGhlcmUgYXJlIG5vdCB0ZXN0cyBsZWZ0IGFuZFxuXHQgICAgICAvLyB3aGVuIHRoZSAnYWZ0ZXInIGFuZCAnZmluaXNoJyB0YXNrcyBhcmUgdGhlIG9ubHkgdGFza3MgbGVmdCB0byBwcm9jZXNzXG5cblxuXHQgICAgICBpZiAoaG9va05hbWUgPT09IFwiYWZ0ZXJcIiAmJiBob29rT3duZXIudW5za2lwcGVkVGVzdHNSdW4gIT09IG51bWJlck9mVW5za2lwcGVkVGVzdHMoaG9va093bmVyKSAtIDEgJiYgKGNvbmZpZy5xdWV1ZS5sZW5ndGggPiAwIHx8IFByb2Nlc3NpbmdRdWV1ZS50YXNrQ291bnQoKSA+IDIpKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgY29uZmlnLmN1cnJlbnQgPSBfdGhpczI7XG5cblx0ICAgICAgaWYgKGNvbmZpZy5ub3RyeWNhdGNoKSB7XG5cdCAgICAgICAgY2FsbEhvb2soKTtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblxuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGNhbGxIb29rKCk7XG5cdCAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cdCAgICAgICAgX3RoaXMyLnB1c2hGYWlsdXJlKGhvb2tOYW1lICsgXCIgZmFpbGVkIG9uIFwiICsgX3RoaXMyLnRlc3ROYW1lICsgXCI6IFwiICsgKGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpLCBleHRyYWN0U3RhY2t0cmFjZShlcnJvciwgMCkpO1xuXHQgICAgICB9XG5cdCAgICB9O1xuXG5cdCAgICByZXR1cm4gcnVuSG9vaztcblx0ICB9LFxuXHQgIC8vIEN1cnJlbnRseSBvbmx5IHVzZWQgZm9yIG1vZHVsZSBsZXZlbCBob29rcywgY2FuIGJlIHVzZWQgdG8gYWRkIGdsb2JhbCBsZXZlbCBvbmVzXG5cdCAgaG9va3M6IGZ1bmN0aW9uIGhvb2tzKGhhbmRsZXIpIHtcblx0ICAgIHZhciBob29rcyA9IFtdO1xuXG5cdCAgICBmdW5jdGlvbiBwcm9jZXNzSG9va3ModGVzdCwgbW9kdWxlKSB7XG5cdCAgICAgIGlmIChtb2R1bGUucGFyZW50TW9kdWxlKSB7XG5cdCAgICAgICAgcHJvY2Vzc0hvb2tzKHRlc3QsIG1vZHVsZS5wYXJlbnRNb2R1bGUpO1xuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKG1vZHVsZS5ob29rc1toYW5kbGVyXS5sZW5ndGgpIHtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IG1vZHVsZS5ob29rc1toYW5kbGVyXS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgaG9va3MucHVzaCh0ZXN0LnF1ZXVlSG9vayhtb2R1bGUuaG9va3NbaGFuZGxlcl1baV0sIGhhbmRsZXIsIG1vZHVsZSkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSAvLyBIb29rcyBhcmUgaWdub3JlZCBvbiBza2lwcGVkIHRlc3RzXG5cblxuXHQgICAgaWYgKCF0aGlzLnNraXApIHtcblx0ICAgICAgcHJvY2Vzc0hvb2tzKHRoaXMsIHRoaXMubW9kdWxlKTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIGhvb2tzO1xuXHQgIH0sXG5cdCAgZmluaXNoOiBmdW5jdGlvbiBmaW5pc2goKSB7XG5cdCAgICBjb25maWcuY3VycmVudCA9IHRoaXM7IC8vIFJlbGVhc2UgdGhlIHRlc3QgY2FsbGJhY2sgdG8gZW5zdXJlIHRoYXQgYW55dGhpbmcgcmVmZXJlbmNlZCBoYXMgYmVlblxuXHQgICAgLy8gcmVsZWFzZWQgdG8gYmUgZ2FyYmFnZSBjb2xsZWN0ZWQuXG5cblx0ICAgIHRoaXMuY2FsbGJhY2sgPSB1bmRlZmluZWQ7XG5cblx0ICAgIGlmICh0aGlzLnN0ZXBzLmxlbmd0aCkge1xuXHQgICAgICB2YXIgc3RlcHNMaXN0ID0gdGhpcy5zdGVwcy5qb2luKFwiLCBcIik7XG5cdCAgICAgIHRoaXMucHVzaEZhaWx1cmUoXCJFeHBlY3RlZCBhc3NlcnQudmVyaWZ5U3RlcHMoKSB0byBiZSBjYWxsZWQgYmVmb3JlIGVuZCBvZiB0ZXN0IFwiICsgXCJhZnRlciB1c2luZyBhc3NlcnQuc3RlcCgpLiBVbnZlcmlmaWVkIHN0ZXBzOiBcIi5jb25jYXQoc3RlcHNMaXN0KSwgdGhpcy5zdGFjayk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcucmVxdWlyZUV4cGVjdHMgJiYgdGhpcy5leHBlY3RlZCA9PT0gbnVsbCkge1xuXHQgICAgICB0aGlzLnB1c2hGYWlsdXJlKFwiRXhwZWN0ZWQgbnVtYmVyIG9mIGFzc2VydGlvbnMgdG8gYmUgZGVmaW5lZCwgYnV0IGV4cGVjdCgpIHdhcyBcIiArIFwibm90IGNhbGxlZC5cIiwgdGhpcy5zdGFjayk7XG5cdCAgICB9IGVsc2UgaWYgKHRoaXMuZXhwZWN0ZWQgIT09IG51bGwgJiYgdGhpcy5leHBlY3RlZCAhPT0gdGhpcy5hc3NlcnRpb25zLmxlbmd0aCkge1xuXHQgICAgICB0aGlzLnB1c2hGYWlsdXJlKFwiRXhwZWN0ZWQgXCIgKyB0aGlzLmV4cGVjdGVkICsgXCIgYXNzZXJ0aW9ucywgYnV0IFwiICsgdGhpcy5hc3NlcnRpb25zLmxlbmd0aCArIFwiIHdlcmUgcnVuXCIsIHRoaXMuc3RhY2spO1xuXHQgICAgfSBlbHNlIGlmICh0aGlzLmV4cGVjdGVkID09PSBudWxsICYmICF0aGlzLmFzc2VydGlvbnMubGVuZ3RoKSB7XG5cdCAgICAgIHRoaXMucHVzaEZhaWx1cmUoXCJFeHBlY3RlZCBhdCBsZWFzdCBvbmUgYXNzZXJ0aW9uLCBidXQgbm9uZSB3ZXJlIHJ1biAtIGNhbGwgXCIgKyBcImV4cGVjdCgwKSB0byBhY2NlcHQgemVybyBhc3NlcnRpb25zLlwiLCB0aGlzLnN0YWNrKTtcblx0ICAgIH1cblxuXHQgICAgdmFyIGksXG5cdCAgICAgICAgbW9kdWxlID0gdGhpcy5tb2R1bGUsXG5cdCAgICAgICAgbW9kdWxlTmFtZSA9IG1vZHVsZS5uYW1lLFxuXHQgICAgICAgIHRlc3ROYW1lID0gdGhpcy50ZXN0TmFtZSxcblx0ICAgICAgICBza2lwcGVkID0gISF0aGlzLnNraXAsXG5cdCAgICAgICAgdG9kbyA9ICEhdGhpcy50b2RvLFxuXHQgICAgICAgIGJhZCA9IDAsXG5cdCAgICAgICAgc3RvcmFnZSA9IGNvbmZpZy5zdG9yYWdlO1xuXHQgICAgdGhpcy5ydW50aW1lID0gbm93KCkgLSB0aGlzLnN0YXJ0ZWQ7XG5cdCAgICBjb25maWcuc3RhdHMuYWxsICs9IHRoaXMuYXNzZXJ0aW9ucy5sZW5ndGg7XG5cdCAgICBjb25maWcuc3RhdHMudGVzdENvdW50ICs9IDE7XG5cdCAgICBtb2R1bGUuc3RhdHMuYWxsICs9IHRoaXMuYXNzZXJ0aW9ucy5sZW5ndGg7XG5cblx0ICAgIGZvciAoaSA9IDA7IGkgPCB0aGlzLmFzc2VydGlvbnMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgaWYgKCF0aGlzLmFzc2VydGlvbnNbaV0ucmVzdWx0KSB7XG5cdCAgICAgICAgYmFkKys7XG5cdCAgICAgICAgY29uZmlnLnN0YXRzLmJhZCsrO1xuXHQgICAgICAgIG1vZHVsZS5zdGF0cy5iYWQrKztcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBub3RpZnlUZXN0c1Jhbihtb2R1bGUsIHNraXBwZWQpOyAvLyBTdG9yZSByZXN1bHQgd2hlbiBwb3NzaWJsZVxuXG5cdCAgICBpZiAoc3RvcmFnZSkge1xuXHQgICAgICBpZiAoYmFkKSB7XG5cdCAgICAgICAgc3RvcmFnZS5zZXRJdGVtKFwicXVuaXQtdGVzdC1cIiArIG1vZHVsZU5hbWUgKyBcIi1cIiArIHRlc3ROYW1lLCBiYWQpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHN0b3JhZ2UucmVtb3ZlSXRlbShcInF1bml0LXRlc3QtXCIgKyBtb2R1bGVOYW1lICsgXCItXCIgKyB0ZXN0TmFtZSk7XG5cdCAgICAgIH1cblx0ICAgIH0gLy8gQWZ0ZXIgZW1pdHRpbmcgdGhlIGpzLXJlcG9ydGVycyBldmVudCB3ZSBjbGVhbnVwIHRoZSBhc3NlcnRpb24gZGF0YSB0b1xuXHQgICAgLy8gYXZvaWQgbGVha2luZyBpdC4gSXQgaXMgbm90IHVzZWQgYnkgdGhlIGxlZ2FjeSB0ZXN0RG9uZSBjYWxsYmFja3MuXG5cblxuXHQgICAgZW1pdChcInRlc3RFbmRcIiwgdGhpcy50ZXN0UmVwb3J0LmVuZCh0cnVlKSk7XG5cdCAgICB0aGlzLnRlc3RSZXBvcnQuc2xpbUFzc2VydGlvbnMoKTtcblx0ICAgIHZhciB0ZXN0ID0gdGhpcztcblx0ICAgIHJldHVybiBydW5Mb2dnaW5nQ2FsbGJhY2tzKFwidGVzdERvbmVcIiwge1xuXHQgICAgICBuYW1lOiB0ZXN0TmFtZSxcblx0ICAgICAgbW9kdWxlOiBtb2R1bGVOYW1lLFxuXHQgICAgICBza2lwcGVkOiBza2lwcGVkLFxuXHQgICAgICB0b2RvOiB0b2RvLFxuXHQgICAgICBmYWlsZWQ6IGJhZCxcblx0ICAgICAgcGFzc2VkOiB0aGlzLmFzc2VydGlvbnMubGVuZ3RoIC0gYmFkLFxuXHQgICAgICB0b3RhbDogdGhpcy5hc3NlcnRpb25zLmxlbmd0aCxcblx0ICAgICAgcnVudGltZTogc2tpcHBlZCA/IDAgOiB0aGlzLnJ1bnRpbWUsXG5cdCAgICAgIC8vIEhUTUwgUmVwb3J0ZXIgdXNlXG5cdCAgICAgIGFzc2VydGlvbnM6IHRoaXMuYXNzZXJ0aW9ucyxcblx0ICAgICAgdGVzdElkOiB0aGlzLnRlc3RJZCxcblxuXHQgICAgICAvLyBTb3VyY2Ugb2YgVGVzdFxuXHQgICAgICAvLyBnZW5lcmF0aW5nIHN0YWNrIHRyYWNlIGlzIGV4cGVuc2l2ZSwgc28gdXNpbmcgYSBnZXR0ZXIgd2lsbCBoZWxwIGRlZmVyIHRoaXMgdW50aWwgd2UgbmVlZCBpdFxuXHQgICAgICBnZXQgc291cmNlKCkge1xuXHQgICAgICAgIHJldHVybiB0ZXN0LnN0YWNrO1xuXHQgICAgICB9XG5cblx0ICAgIH0pLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAobW9kdWxlLnRlc3RzUnVuID09PSBudW1iZXJPZlRlc3RzKG1vZHVsZSkpIHtcblx0ICAgICAgICB2YXIgY29tcGxldGVkTW9kdWxlcyA9IFttb2R1bGVdOyAvLyBDaGVjayBpZiB0aGUgcGFyZW50IG1vZHVsZXMsIGl0ZXJhdGl2ZWx5LCBhcmUgZG9uZS4gSWYgdGhhdCB0aGUgY2FzZSxcblx0ICAgICAgICAvLyB3ZSBlbWl0IHRoZSBgc3VpdGVFbmRgIGV2ZW50IGFuZCB0cmlnZ2VyIGBtb2R1bGVEb25lYCBjYWxsYmFjay5cblxuXHQgICAgICAgIHZhciBwYXJlbnQgPSBtb2R1bGUucGFyZW50TW9kdWxlO1xuXG5cdCAgICAgICAgd2hpbGUgKHBhcmVudCAmJiBwYXJlbnQudGVzdHNSdW4gPT09IG51bWJlck9mVGVzdHMocGFyZW50KSkge1xuXHQgICAgICAgICAgY29tcGxldGVkTW9kdWxlcy5wdXNoKHBhcmVudCk7XG5cdCAgICAgICAgICBwYXJlbnQgPSBwYXJlbnQucGFyZW50TW9kdWxlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldHVybiBjb21wbGV0ZWRNb2R1bGVzLnJlZHVjZShmdW5jdGlvbiAocHJvbWlzZUNoYWluLCBjb21wbGV0ZWRNb2R1bGUpIHtcblx0ICAgICAgICAgIHJldHVybiBwcm9taXNlQ2hhaW4udGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICAgIHJldHVybiBsb2dTdWl0ZUVuZChjb21wbGV0ZWRNb2R1bGUpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfSwgUHJvbWlzZSQxLnJlc29sdmUoW10pKTtcblx0ICAgICAgfVxuXHQgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGNvbmZpZy5jdXJyZW50ID0gdW5kZWZpbmVkO1xuXHQgICAgfSk7XG5cblx0ICAgIGZ1bmN0aW9uIGxvZ1N1aXRlRW5kKG1vZHVsZSkge1xuXHQgICAgICAvLyBSZXNldCBgbW9kdWxlLmhvb2tzYCB0byBlbnN1cmUgdGhhdCBhbnl0aGluZyByZWZlcmVuY2VkIGluIHRoZXNlIGhvb2tzXG5cdCAgICAgIC8vIGhhcyBiZWVuIHJlbGVhc2VkIHRvIGJlIGdhcmJhZ2UgY29sbGVjdGVkLlxuXHQgICAgICBtb2R1bGUuaG9va3MgPSB7fTtcblx0ICAgICAgZW1pdChcInN1aXRlRW5kXCIsIG1vZHVsZS5zdWl0ZVJlcG9ydC5lbmQodHJ1ZSkpO1xuXHQgICAgICByZXR1cm4gcnVuTG9nZ2luZ0NhbGxiYWNrcyhcIm1vZHVsZURvbmVcIiwge1xuXHQgICAgICAgIG5hbWU6IG1vZHVsZS5uYW1lLFxuXHQgICAgICAgIHRlc3RzOiBtb2R1bGUudGVzdHMsXG5cdCAgICAgICAgZmFpbGVkOiBtb2R1bGUuc3RhdHMuYmFkLFxuXHQgICAgICAgIHBhc3NlZDogbW9kdWxlLnN0YXRzLmFsbCAtIG1vZHVsZS5zdGF0cy5iYWQsXG5cdCAgICAgICAgdG90YWw6IG1vZHVsZS5zdGF0cy5hbGwsXG5cdCAgICAgICAgcnVudGltZTogbm93KCkgLSBtb2R1bGUuc3RhdHMuc3RhcnRlZFxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LFxuXHQgIHByZXNlcnZlVGVzdEVudmlyb25tZW50OiBmdW5jdGlvbiBwcmVzZXJ2ZVRlc3RFbnZpcm9ubWVudCgpIHtcblx0ICAgIGlmICh0aGlzLnByZXNlcnZlRW52aXJvbm1lbnQpIHtcblx0ICAgICAgdGhpcy5tb2R1bGUudGVzdEVudmlyb25tZW50ID0gdGhpcy50ZXN0RW52aXJvbm1lbnQ7XG5cdCAgICAgIHRoaXMudGVzdEVudmlyb25tZW50ID0gZXh0ZW5kKHt9LCB0aGlzLm1vZHVsZS50ZXN0RW52aXJvbm1lbnQpO1xuXHQgICAgfVxuXHQgIH0sXG5cdCAgcXVldWU6IGZ1bmN0aW9uIHF1ZXVlKCkge1xuXHQgICAgdmFyIHRlc3QgPSB0aGlzO1xuXG5cdCAgICBpZiAoIXRoaXMudmFsaWQoKSkge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHJ1blRlc3QoKSB7XG5cdCAgICAgIHJldHVybiBbZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0ZXN0LmJlZm9yZSgpO1xuXHQgICAgICB9XS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHRlc3QuaG9va3MoXCJiZWZvcmVcIikpLCBbZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRlc3QucHJlc2VydmVUZXN0RW52aXJvbm1lbnQoKTtcblx0ICAgICAgfV0sIF90b0NvbnN1bWFibGVBcnJheSh0ZXN0Lmhvb2tzKFwiYmVmb3JlRWFjaFwiKSksIFtmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGVzdC5ydW4oKTtcblx0ICAgICAgfV0sIF90b0NvbnN1bWFibGVBcnJheSh0ZXN0Lmhvb2tzKFwiYWZ0ZXJFYWNoXCIpLnJldmVyc2UoKSksIF90b0NvbnN1bWFibGVBcnJheSh0ZXN0Lmhvb2tzKFwiYWZ0ZXJcIikucmV2ZXJzZSgpKSwgW2Z1bmN0aW9uICgpIHtcblx0ICAgICAgICB0ZXN0LmFmdGVyKCk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gdGVzdC5maW5pc2goKTtcblx0ICAgICAgfV0pO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgcHJldmlvdXNGYWlsQ291bnQgPSBjb25maWcuc3RvcmFnZSAmJiArY29uZmlnLnN0b3JhZ2UuZ2V0SXRlbShcInF1bml0LXRlc3QtXCIgKyB0aGlzLm1vZHVsZS5uYW1lICsgXCItXCIgKyB0aGlzLnRlc3ROYW1lKTsgLy8gUHJpb3JpdGl6ZSBwcmV2aW91c2x5IGZhaWxlZCB0ZXN0cywgZGV0ZWN0ZWQgZnJvbSBzdG9yYWdlXG5cblx0ICAgIHZhciBwcmlvcml0aXplID0gY29uZmlnLnJlb3JkZXIgJiYgISFwcmV2aW91c0ZhaWxDb3VudDtcblx0ICAgIHRoaXMucHJldmlvdXNGYWlsdXJlID0gISFwcmV2aW91c0ZhaWxDb3VudDtcblx0ICAgIFByb2Nlc3NpbmdRdWV1ZS5hZGQocnVuVGVzdCwgcHJpb3JpdGl6ZSwgY29uZmlnLnNlZWQpOyAvLyBJZiB0aGUgcXVldWUgaGFzIGFscmVhZHkgZmluaXNoZWQsIHdlIG1hbnVhbGx5IHByb2Nlc3MgdGhlIG5ldyB0ZXN0XG5cblx0ICAgIGlmIChQcm9jZXNzaW5nUXVldWUuZmluaXNoZWQpIHtcblx0ICAgICAgUHJvY2Vzc2luZ1F1ZXVlLmFkdmFuY2UoKTtcblx0ICAgIH1cblx0ICB9LFxuXHQgIHB1c2hSZXN1bHQ6IGZ1bmN0aW9uIHB1c2hSZXN1bHQocmVzdWx0SW5mbykge1xuXHQgICAgaWYgKHRoaXMgIT09IGNvbmZpZy5jdXJyZW50KSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcIkFzc2VydGlvbiBvY2N1cnJlZCBhZnRlciB0ZXN0IGhhZCBmaW5pc2hlZC5cIik7XG5cdCAgICB9IC8vIERlc3RydWN0dXJlIG9mIHJlc3VsdEluZm8gPSB7IHJlc3VsdCwgYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgbmVnYXRpdmUgfVxuXG5cblx0ICAgIHZhciBzb3VyY2UsXG5cdCAgICAgICAgZGV0YWlscyA9IHtcblx0ICAgICAgbW9kdWxlOiB0aGlzLm1vZHVsZS5uYW1lLFxuXHQgICAgICBuYW1lOiB0aGlzLnRlc3ROYW1lLFxuXHQgICAgICByZXN1bHQ6IHJlc3VsdEluZm8ucmVzdWx0LFxuXHQgICAgICBtZXNzYWdlOiByZXN1bHRJbmZvLm1lc3NhZ2UsXG5cdCAgICAgIGFjdHVhbDogcmVzdWx0SW5mby5hY3R1YWwsXG5cdCAgICAgIHRlc3RJZDogdGhpcy50ZXN0SWQsXG5cdCAgICAgIG5lZ2F0aXZlOiByZXN1bHRJbmZvLm5lZ2F0aXZlIHx8IGZhbHNlLFxuXHQgICAgICBydW50aW1lOiBub3coKSAtIHRoaXMuc3RhcnRlZCxcblx0ICAgICAgdG9kbzogISF0aGlzLnRvZG9cblx0ICAgIH07XG5cblx0ICAgIGlmIChoYXNPd24uY2FsbChyZXN1bHRJbmZvLCBcImV4cGVjdGVkXCIpKSB7XG5cdCAgICAgIGRldGFpbHMuZXhwZWN0ZWQgPSByZXN1bHRJbmZvLmV4cGVjdGVkO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoIXJlc3VsdEluZm8ucmVzdWx0KSB7XG5cdCAgICAgIHNvdXJjZSA9IHJlc3VsdEluZm8uc291cmNlIHx8IHNvdXJjZUZyb21TdGFja3RyYWNlKCk7XG5cblx0ICAgICAgaWYgKHNvdXJjZSkge1xuXHQgICAgICAgIGRldGFpbHMuc291cmNlID0gc291cmNlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHRoaXMubG9nQXNzZXJ0aW9uKGRldGFpbHMpO1xuXHQgICAgdGhpcy5hc3NlcnRpb25zLnB1c2goe1xuXHQgICAgICByZXN1bHQ6ICEhcmVzdWx0SW5mby5yZXN1bHQsXG5cdCAgICAgIG1lc3NhZ2U6IHJlc3VsdEluZm8ubWVzc2FnZVxuXHQgICAgfSk7XG5cdCAgfSxcblx0ICBwdXNoRmFpbHVyZTogZnVuY3Rpb24gcHVzaEZhaWx1cmUobWVzc2FnZSwgc291cmNlLCBhY3R1YWwpIHtcblx0ICAgIGlmICghKHRoaXMgaW5zdGFuY2VvZiBUZXN0KSkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJwdXNoRmFpbHVyZSgpIGFzc2VydGlvbiBvdXRzaWRlIHRlc3QgY29udGV4dCwgd2FzIFwiICsgc291cmNlRnJvbVN0YWNrdHJhY2UoMikpO1xuXHQgICAgfVxuXG5cdCAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICByZXN1bHQ6IGZhbHNlLFxuXHQgICAgICBtZXNzYWdlOiBtZXNzYWdlIHx8IFwiZXJyb3JcIixcblx0ICAgICAgYWN0dWFsOiBhY3R1YWwgfHwgbnVsbCxcblx0ICAgICAgc291cmNlOiBzb3VyY2Vcblx0ICAgIH0pO1xuXHQgIH0sXG5cblx0ICAvKipcblx0ICAgKiBMb2cgYXNzZXJ0aW9uIGRldGFpbHMgdXNpbmcgYm90aCB0aGUgb2xkIFFVbml0LmxvZyBpbnRlcmZhY2UgYW5kXG5cdCAgICogUVVuaXQub24oIFwiYXNzZXJ0aW9uXCIgKSBpbnRlcmZhY2UuXG5cdCAgICpcblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXHQgIGxvZ0Fzc2VydGlvbjogZnVuY3Rpb24gbG9nQXNzZXJ0aW9uKGRldGFpbHMpIHtcblx0ICAgIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJsb2dcIiwgZGV0YWlscyk7XG5cdCAgICB2YXIgYXNzZXJ0aW9uID0ge1xuXHQgICAgICBwYXNzZWQ6IGRldGFpbHMucmVzdWx0LFxuXHQgICAgICBhY3R1YWw6IGRldGFpbHMuYWN0dWFsLFxuXHQgICAgICBleHBlY3RlZDogZGV0YWlscy5leHBlY3RlZCxcblx0ICAgICAgbWVzc2FnZTogZGV0YWlscy5tZXNzYWdlLFxuXHQgICAgICBzdGFjazogZGV0YWlscy5zb3VyY2UsXG5cdCAgICAgIHRvZG86IGRldGFpbHMudG9kb1xuXHQgICAgfTtcblx0ICAgIHRoaXMudGVzdFJlcG9ydC5wdXNoQXNzZXJ0aW9uKGFzc2VydGlvbik7XG5cdCAgICBlbWl0KFwiYXNzZXJ0aW9uXCIsIGFzc2VydGlvbik7XG5cdCAgfSxcblx0ICByZXNvbHZlUHJvbWlzZTogZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UocHJvbWlzZSwgcGhhc2UpIHtcblx0ICAgIHZhciB0aGVuLFxuXHQgICAgICAgIHJlc3VtZSxcblx0ICAgICAgICBtZXNzYWdlLFxuXHQgICAgICAgIHRlc3QgPSB0aGlzO1xuXG5cdCAgICBpZiAocHJvbWlzZSAhPSBudWxsKSB7XG5cdCAgICAgIHRoZW4gPSBwcm9taXNlLnRoZW47XG5cblx0ICAgICAgaWYgKG9iamVjdFR5cGUodGhlbikgPT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgICAgIHJlc3VtZSA9IGludGVybmFsU3RvcCh0ZXN0KTtcblxuXHQgICAgICAgIGlmIChjb25maWcubm90cnljYXRjaCkge1xuXHQgICAgICAgICAgdGhlbi5jYWxsKHByb21pc2UsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmVzdW1lKCk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhlbi5jYWxsKHByb21pc2UsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmVzdW1lKCk7XG5cdCAgICAgICAgICB9LCBmdW5jdGlvbiAoZXJyb3IpIHtcblx0ICAgICAgICAgICAgbWVzc2FnZSA9IFwiUHJvbWlzZSByZWplY3RlZCBcIiArICghcGhhc2UgPyBcImR1cmluZ1wiIDogcGhhc2UucmVwbGFjZSgvRWFjaCQvLCBcIlwiKSkgKyBcIiBcXFwiXCIgKyB0ZXN0LnRlc3ROYW1lICsgXCJcXFwiOiBcIiArIChlcnJvciAmJiBlcnJvci5tZXNzYWdlIHx8IGVycm9yKTtcblx0ICAgICAgICAgICAgdGVzdC5wdXNoRmFpbHVyZShtZXNzYWdlLCBleHRyYWN0U3RhY2t0cmFjZShlcnJvciwgMCkpOyAvLyBFbHNlIG5leHQgdGVzdCB3aWxsIGNhcnJ5IHRoZSByZXNwb25zaWJpbGl0eVxuXG5cdCAgICAgICAgICAgIHNhdmVHbG9iYWwoKTsgLy8gVW5ibG9ja1xuXG5cdCAgICAgICAgICAgIGludGVybmFsUmVjb3Zlcih0ZXN0KTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0sXG5cdCAgdmFsaWQ6IGZ1bmN0aW9uIHZhbGlkKCkge1xuXHQgICAgdmFyIGZpbHRlciA9IGNvbmZpZy5maWx0ZXIsXG5cdCAgICAgICAgcmVnZXhGaWx0ZXIgPSAvXighPylcXC8oW1xcd1xcV10qKVxcLyhpPyQpLy5leGVjKGZpbHRlciksXG5cdCAgICAgICAgbW9kdWxlID0gY29uZmlnLm1vZHVsZSAmJiBjb25maWcubW9kdWxlLnRvTG93ZXJDYXNlKCksXG5cdCAgICAgICAgZnVsbE5hbWUgPSB0aGlzLm1vZHVsZS5uYW1lICsgXCI6IFwiICsgdGhpcy50ZXN0TmFtZTtcblxuXHQgICAgZnVuY3Rpb24gbW9kdWxlQ2hhaW5OYW1lTWF0Y2godGVzdE1vZHVsZSkge1xuXHQgICAgICB2YXIgdGVzdE1vZHVsZU5hbWUgPSB0ZXN0TW9kdWxlLm5hbWUgPyB0ZXN0TW9kdWxlLm5hbWUudG9Mb3dlckNhc2UoKSA6IG51bGw7XG5cblx0ICAgICAgaWYgKHRlc3RNb2R1bGVOYW1lID09PSBtb2R1bGUpIHtcblx0ICAgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgICAgfSBlbHNlIGlmICh0ZXN0TW9kdWxlLnBhcmVudE1vZHVsZSkge1xuXHQgICAgICAgIHJldHVybiBtb2R1bGVDaGFpbk5hbWVNYXRjaCh0ZXN0TW9kdWxlLnBhcmVudE1vZHVsZSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIG1vZHVsZUNoYWluSWRNYXRjaCh0ZXN0TW9kdWxlKSB7XG5cdCAgICAgIHJldHVybiBpbkFycmF5KHRlc3RNb2R1bGUubW9kdWxlSWQsIGNvbmZpZy5tb2R1bGVJZCkgfHwgdGVzdE1vZHVsZS5wYXJlbnRNb2R1bGUgJiYgbW9kdWxlQ2hhaW5JZE1hdGNoKHRlc3RNb2R1bGUucGFyZW50TW9kdWxlKTtcblx0ICAgIH0gLy8gSW50ZXJuYWxseS1nZW5lcmF0ZWQgdGVzdHMgYXJlIGFsd2F5cyB2YWxpZFxuXG5cblx0ICAgIGlmICh0aGlzLmNhbGxiYWNrICYmIHRoaXMuY2FsbGJhY2sudmFsaWRUZXN0KSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29uZmlnLm1vZHVsZUlkICYmIGNvbmZpZy5tb2R1bGVJZC5sZW5ndGggPiAwICYmICFtb2R1bGVDaGFpbklkTWF0Y2godGhpcy5tb2R1bGUpKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGNvbmZpZy50ZXN0SWQgJiYgY29uZmlnLnRlc3RJZC5sZW5ndGggPiAwICYmICFpbkFycmF5KHRoaXMudGVzdElkLCBjb25maWcudGVzdElkKSkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cblx0ICAgIGlmIChtb2R1bGUgJiYgIW1vZHVsZUNoYWluTmFtZU1hdGNoKHRoaXMubW9kdWxlKSkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9XG5cblx0ICAgIGlmICghZmlsdGVyKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gcmVnZXhGaWx0ZXIgPyB0aGlzLnJlZ2V4RmlsdGVyKCEhcmVnZXhGaWx0ZXJbMV0sIHJlZ2V4RmlsdGVyWzJdLCByZWdleEZpbHRlclszXSwgZnVsbE5hbWUpIDogdGhpcy5zdHJpbmdGaWx0ZXIoZmlsdGVyLCBmdWxsTmFtZSk7XG5cdCAgfSxcblx0ICByZWdleEZpbHRlcjogZnVuY3Rpb24gcmVnZXhGaWx0ZXIoZXhjbHVkZSwgcGF0dGVybiwgZmxhZ3MsIGZ1bGxOYW1lKSB7XG5cdCAgICB2YXIgcmVnZXggPSBuZXcgUmVnRXhwKHBhdHRlcm4sIGZsYWdzKTtcblx0ICAgIHZhciBtYXRjaCA9IHJlZ2V4LnRlc3QoZnVsbE5hbWUpO1xuXHQgICAgcmV0dXJuIG1hdGNoICE9PSBleGNsdWRlO1xuXHQgIH0sXG5cdCAgc3RyaW5nRmlsdGVyOiBmdW5jdGlvbiBzdHJpbmdGaWx0ZXIoZmlsdGVyLCBmdWxsTmFtZSkge1xuXHQgICAgZmlsdGVyID0gZmlsdGVyLnRvTG93ZXJDYXNlKCk7XG5cdCAgICBmdWxsTmFtZSA9IGZ1bGxOYW1lLnRvTG93ZXJDYXNlKCk7XG5cdCAgICB2YXIgaW5jbHVkZSA9IGZpbHRlci5jaGFyQXQoMCkgIT09IFwiIVwiO1xuXG5cdCAgICBpZiAoIWluY2x1ZGUpIHtcblx0ICAgICAgZmlsdGVyID0gZmlsdGVyLnNsaWNlKDEpO1xuXHQgICAgfSAvLyBJZiB0aGUgZmlsdGVyIG1hdGNoZXMsIHdlIG5lZWQgdG8gaG9ub3VyIGluY2x1ZGVcblxuXG5cdCAgICBpZiAoZnVsbE5hbWUuaW5kZXhPZihmaWx0ZXIpICE9PSAtMSkge1xuXHQgICAgICByZXR1cm4gaW5jbHVkZTtcblx0ICAgIH0gLy8gT3RoZXJ3aXNlLCBkbyB0aGUgb3Bwb3NpdGVcblxuXG5cdCAgICByZXR1cm4gIWluY2x1ZGU7XG5cdCAgfVxuXHR9O1xuXHRmdW5jdGlvbiBwdXNoRmFpbHVyZSgpIHtcblx0ICBpZiAoIWNvbmZpZy5jdXJyZW50KSB7XG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoXCJwdXNoRmFpbHVyZSgpIGFzc2VydGlvbiBvdXRzaWRlIHRlc3QgY29udGV4dCwgaW4gXCIgKyBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgfSAvLyBHZXRzIGN1cnJlbnQgdGVzdCBvYmpcblxuXG5cdCAgdmFyIGN1cnJlbnRUZXN0ID0gY29uZmlnLmN1cnJlbnQ7XG5cdCAgcmV0dXJuIGN1cnJlbnRUZXN0LnB1c2hGYWlsdXJlLmFwcGx5KGN1cnJlbnRUZXN0LCBhcmd1bWVudHMpO1xuXHR9XG5cblx0ZnVuY3Rpb24gc2F2ZUdsb2JhbCgpIHtcblx0ICBjb25maWcucG9sbHV0aW9uID0gW107XG5cblx0ICBpZiAoY29uZmlnLm5vZ2xvYmFscykge1xuXHQgICAgZm9yICh2YXIga2V5IGluIGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddKSB7XG5cdCAgICAgIGlmIChoYXNPd24uY2FsbChnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXSwga2V5KSkge1xuXHQgICAgICAgIC8vIEluIE9wZXJhIHNvbWV0aW1lcyBET00gZWxlbWVudCBpZHMgc2hvdyB1cCBoZXJlLCBpZ25vcmUgdGhlbVxuXHQgICAgICAgIGlmICgvXnF1bml0LXRlc3Qtb3V0cHV0Ly50ZXN0KGtleSkpIHtcblx0ICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGNvbmZpZy5wb2xsdXRpb24ucHVzaChrZXkpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfVxuXHR9XG5cblx0ZnVuY3Rpb24gY2hlY2tQb2xsdXRpb24oKSB7XG5cdCAgdmFyIG5ld0dsb2JhbHMsXG5cdCAgICAgIGRlbGV0ZWRHbG9iYWxzLFxuXHQgICAgICBvbGQgPSBjb25maWcucG9sbHV0aW9uO1xuXHQgIHNhdmVHbG9iYWwoKTtcblx0ICBuZXdHbG9iYWxzID0gZGlmZihjb25maWcucG9sbHV0aW9uLCBvbGQpO1xuXG5cdCAgaWYgKG5ld0dsb2JhbHMubGVuZ3RoID4gMCkge1xuXHQgICAgcHVzaEZhaWx1cmUoXCJJbnRyb2R1Y2VkIGdsb2JhbCB2YXJpYWJsZShzKTogXCIgKyBuZXdHbG9iYWxzLmpvaW4oXCIsIFwiKSk7XG5cdCAgfVxuXG5cdCAgZGVsZXRlZEdsb2JhbHMgPSBkaWZmKG9sZCwgY29uZmlnLnBvbGx1dGlvbik7XG5cblx0ICBpZiAoZGVsZXRlZEdsb2JhbHMubGVuZ3RoID4gMCkge1xuXHQgICAgcHVzaEZhaWx1cmUoXCJEZWxldGVkIGdsb2JhbCB2YXJpYWJsZShzKTogXCIgKyBkZWxldGVkR2xvYmFscy5qb2luKFwiLCBcIikpO1xuXHQgIH1cblx0fSAvLyBXaWxsIGJlIGV4cG9zZWQgYXMgUVVuaXQudGVzdFxuXG5cblx0ZnVuY3Rpb24gdGVzdCh0ZXN0TmFtZSwgY2FsbGJhY2spIHtcblx0ICBpZiAoZm9jdXNlZCQxKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgdmFyIG5ld1Rlc3QgPSBuZXcgVGVzdCh7XG5cdCAgICB0ZXN0TmFtZTogdGVzdE5hbWUsXG5cdCAgICBjYWxsYmFjazogY2FsbGJhY2tcblx0ICB9KTtcblx0ICBuZXdUZXN0LnF1ZXVlKCk7XG5cdH1cblx0ZnVuY3Rpb24gdG9kbyh0ZXN0TmFtZSwgY2FsbGJhY2spIHtcblx0ICBpZiAoZm9jdXNlZCQxKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgdmFyIG5ld1Rlc3QgPSBuZXcgVGVzdCh7XG5cdCAgICB0ZXN0TmFtZTogdGVzdE5hbWUsXG5cdCAgICBjYWxsYmFjazogY2FsbGJhY2ssXG5cdCAgICB0b2RvOiB0cnVlXG5cdCAgfSk7XG5cdCAgbmV3VGVzdC5xdWV1ZSgpO1xuXHR9IC8vIFdpbGwgYmUgZXhwb3NlZCBhcyBRVW5pdC5za2lwXG5cblx0ZnVuY3Rpb24gc2tpcCh0ZXN0TmFtZSkge1xuXHQgIGlmIChmb2N1c2VkJDEpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICB2YXIgdGVzdCA9IG5ldyBUZXN0KHtcblx0ICAgIHRlc3ROYW1lOiB0ZXN0TmFtZSxcblx0ICAgIHNraXA6IHRydWVcblx0ICB9KTtcblx0ICB0ZXN0LnF1ZXVlKCk7XG5cdH0gLy8gV2lsbCBiZSBleHBvc2VkIGFzIFFVbml0Lm9ubHlcblxuXHRmdW5jdGlvbiBvbmx5KHRlc3ROYW1lLCBjYWxsYmFjaykge1xuXHQgIGlmICghZm9jdXNlZCQxKSB7XG5cdCAgICBjb25maWcucXVldWUubGVuZ3RoID0gMDtcblx0ICAgIGZvY3VzZWQkMSA9IHRydWU7XG5cdCAgfVxuXG5cdCAgdmFyIG5ld1Rlc3QgPSBuZXcgVGVzdCh7XG5cdCAgICB0ZXN0TmFtZTogdGVzdE5hbWUsXG5cdCAgICBjYWxsYmFjazogY2FsbGJhY2tcblx0ICB9KTtcblx0ICBuZXdUZXN0LnF1ZXVlKCk7XG5cdH0gLy8gUmVzZXRzIGNvbmZpZy50aW1lb3V0IHdpdGggYSBuZXcgdGltZW91dCBkdXJhdGlvbi5cblxuXHRmdW5jdGlvbiByZXNldFRlc3RUaW1lb3V0KHRpbWVvdXREdXJhdGlvbikge1xuXHQgIGNsZWFyVGltZW91dChjb25maWcudGltZW91dCk7XG5cdCAgY29uZmlnLnRpbWVvdXQgPSBzZXRUaW1lb3V0JDEoY29uZmlnLnRpbWVvdXRIYW5kbGVyKHRpbWVvdXREdXJhdGlvbiksIHRpbWVvdXREdXJhdGlvbik7XG5cdH0gLy8gUHV0IGEgaG9sZCBvbiBwcm9jZXNzaW5nIGFuZCByZXR1cm4gYSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVsZWFzZSBpdC5cblxuXHRmdW5jdGlvbiBpbnRlcm5hbFN0b3AodGVzdCkge1xuXHQgIHZhciByZWxlYXNlZCA9IGZhbHNlO1xuXHQgIHRlc3Quc2VtYXBob3JlICs9IDE7XG5cdCAgY29uZmlnLmJsb2NraW5nID0gdHJ1ZTsgLy8gU2V0IGEgcmVjb3ZlcnkgdGltZW91dCwgaWYgc28gY29uZmlndXJlZC5cblxuXHQgIGlmIChkZWZpbmVkLnNldFRpbWVvdXQpIHtcblx0ICAgIHZhciB0aW1lb3V0RHVyYXRpb247XG5cblx0ICAgIGlmICh0eXBlb2YgdGVzdC50aW1lb3V0ID09PSBcIm51bWJlclwiKSB7XG5cdCAgICAgIHRpbWVvdXREdXJhdGlvbiA9IHRlc3QudGltZW91dDtcblx0ICAgIH0gZWxzZSBpZiAodHlwZW9mIGNvbmZpZy50ZXN0VGltZW91dCA9PT0gXCJudW1iZXJcIikge1xuXHQgICAgICB0aW1lb3V0RHVyYXRpb24gPSBjb25maWcudGVzdFRpbWVvdXQ7XG5cdCAgICB9XG5cblx0ICAgIGlmICh0eXBlb2YgdGltZW91dER1cmF0aW9uID09PSBcIm51bWJlclwiICYmIHRpbWVvdXREdXJhdGlvbiA+IDApIHtcblx0ICAgICAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0KTtcblxuXHQgICAgICBjb25maWcudGltZW91dEhhbmRsZXIgPSBmdW5jdGlvbiAodGltZW91dCkge1xuXHQgICAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgICBwdXNoRmFpbHVyZShcIlRlc3QgdG9vayBsb25nZXIgdGhhbiBcIi5jb25jYXQodGltZW91dCwgXCJtczsgdGVzdCB0aW1lZCBvdXQuXCIpLCBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgICAgICAgICByZWxlYXNlZCA9IHRydWU7XG5cdCAgICAgICAgICBpbnRlcm5hbFJlY292ZXIodGVzdCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgfTtcblxuXHQgICAgICBjb25maWcudGltZW91dCA9IHNldFRpbWVvdXQkMShjb25maWcudGltZW91dEhhbmRsZXIodGltZW91dER1cmF0aW9uKSwgdGltZW91dER1cmF0aW9uKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICByZXR1cm4gZnVuY3Rpb24gcmVzdW1lKCkge1xuXHQgICAgaWYgKHJlbGVhc2VkKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgcmVsZWFzZWQgPSB0cnVlO1xuXHQgICAgdGVzdC5zZW1hcGhvcmUgLT0gMTtcblx0ICAgIGludGVybmFsU3RhcnQodGVzdCk7XG5cdCAgfTtcblx0fSAvLyBGb3JjZWZ1bGx5IHJlbGVhc2UgYWxsIHByb2Nlc3NpbmcgaG9sZHMuXG5cblx0ZnVuY3Rpb24gaW50ZXJuYWxSZWNvdmVyKHRlc3QpIHtcblx0ICB0ZXN0LnNlbWFwaG9yZSA9IDA7XG5cdCAgaW50ZXJuYWxTdGFydCh0ZXN0KTtcblx0fSAvLyBSZWxlYXNlIGEgcHJvY2Vzc2luZyBob2xkLCBzY2hlZHVsaW5nIGEgcmVzdW1wdGlvbiBhdHRlbXB0IGlmIG5vIGhvbGRzIHJlbWFpbi5cblxuXG5cdGZ1bmN0aW9uIGludGVybmFsU3RhcnQodGVzdCkge1xuXHQgIC8vIElmIHNlbWFwaG9yZSBpcyBub24tbnVtZXJpYywgdGhyb3cgZXJyb3Jcblx0ICBpZiAoaXNOYU4odGVzdC5zZW1hcGhvcmUpKSB7XG5cdCAgICB0ZXN0LnNlbWFwaG9yZSA9IDA7XG5cdCAgICBwdXNoRmFpbHVyZShcIkludmFsaWQgdmFsdWUgb24gdGVzdC5zZW1hcGhvcmVcIiwgc291cmNlRnJvbVN0YWNrdHJhY2UoMikpO1xuXHQgICAgcmV0dXJuO1xuXHQgIH0gLy8gRG9uJ3Qgc3RhcnQgdW50aWwgZXF1YWwgbnVtYmVyIG9mIHN0b3AtY2FsbHNcblxuXG5cdCAgaWYgKHRlc3Quc2VtYXBob3JlID4gMCkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH0gLy8gVGhyb3cgYW4gRXJyb3IgaWYgc3RhcnQgaXMgY2FsbGVkIG1vcmUgb2Z0ZW4gdGhhbiBzdG9wXG5cblxuXHQgIGlmICh0ZXN0LnNlbWFwaG9yZSA8IDApIHtcblx0ICAgIHRlc3Quc2VtYXBob3JlID0gMDtcblx0ICAgIHB1c2hGYWlsdXJlKFwiVHJpZWQgdG8gcmVzdGFydCB0ZXN0IHdoaWxlIGFscmVhZHkgc3RhcnRlZCAodGVzdCdzIHNlbWFwaG9yZSB3YXMgMCBhbHJlYWR5KVwiLCBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgICByZXR1cm47XG5cdCAgfSAvLyBBZGQgYSBzbGlnaHQgZGVsYXkgdG8gYWxsb3cgbW9yZSBhc3NlcnRpb25zIGV0Yy5cblxuXG5cdCAgaWYgKGRlZmluZWQuc2V0VGltZW91dCkge1xuXHQgICAgaWYgKGNvbmZpZy50aW1lb3V0KSB7XG5cdCAgICAgIGNsZWFyVGltZW91dChjb25maWcudGltZW91dCk7XG5cdCAgICB9XG5cblx0ICAgIGNvbmZpZy50aW1lb3V0ID0gc2V0VGltZW91dCQxKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgaWYgKHRlc3Quc2VtYXBob3JlID4gMCkge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChjb25maWcudGltZW91dCkge1xuXHQgICAgICAgIGNsZWFyVGltZW91dChjb25maWcudGltZW91dCk7XG5cdCAgICAgIH1cblxuXHQgICAgICBiZWdpbigpO1xuXHQgICAgfSk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIGJlZ2luKCk7XG5cdCAgfVxuXHR9XG5cblx0ZnVuY3Rpb24gY29sbGVjdFRlc3RzKG1vZHVsZSkge1xuXHQgIHZhciB0ZXN0cyA9IFtdLmNvbmNhdChtb2R1bGUudGVzdHMpO1xuXG5cdCAgdmFyIG1vZHVsZXMgPSBfdG9Db25zdW1hYmxlQXJyYXkobW9kdWxlLmNoaWxkTW9kdWxlcyk7IC8vIERvIGEgYnJlYWR0aC1maXJzdCB0cmF2ZXJzYWwgb2YgdGhlIGNoaWxkIG1vZHVsZXNcblxuXG5cdCAgd2hpbGUgKG1vZHVsZXMubGVuZ3RoKSB7XG5cdCAgICB2YXIgbmV4dE1vZHVsZSA9IG1vZHVsZXMuc2hpZnQoKTtcblx0ICAgIHRlc3RzLnB1c2guYXBwbHkodGVzdHMsIG5leHRNb2R1bGUudGVzdHMpO1xuXHQgICAgbW9kdWxlcy5wdXNoLmFwcGx5KG1vZHVsZXMsIF90b0NvbnN1bWFibGVBcnJheShuZXh0TW9kdWxlLmNoaWxkTW9kdWxlcykpO1xuXHQgIH1cblxuXHQgIHJldHVybiB0ZXN0cztcblx0fVxuXG5cdGZ1bmN0aW9uIG51bWJlck9mVGVzdHMobW9kdWxlKSB7XG5cdCAgcmV0dXJuIGNvbGxlY3RUZXN0cyhtb2R1bGUpLmxlbmd0aDtcblx0fVxuXG5cdGZ1bmN0aW9uIG51bWJlck9mVW5za2lwcGVkVGVzdHMobW9kdWxlKSB7XG5cdCAgcmV0dXJuIGNvbGxlY3RUZXN0cyhtb2R1bGUpLmZpbHRlcihmdW5jdGlvbiAodGVzdCkge1xuXHQgICAgcmV0dXJuICF0ZXN0LnNraXA7XG5cdCAgfSkubGVuZ3RoO1xuXHR9XG5cblx0ZnVuY3Rpb24gbm90aWZ5VGVzdHNSYW4obW9kdWxlLCBza2lwcGVkKSB7XG5cdCAgbW9kdWxlLnRlc3RzUnVuKys7XG5cblx0ICBpZiAoIXNraXBwZWQpIHtcblx0ICAgIG1vZHVsZS51bnNraXBwZWRUZXN0c1J1bisrO1xuXHQgIH1cblxuXHQgIHdoaWxlIChtb2R1bGUgPSBtb2R1bGUucGFyZW50TW9kdWxlKSB7XG5cdCAgICBtb2R1bGUudGVzdHNSdW4rKztcblxuXHQgICAgaWYgKCFza2lwcGVkKSB7XG5cdCAgICAgIG1vZHVsZS51bnNraXBwZWRUZXN0c1J1bisrO1xuXHQgICAgfVxuXHQgIH1cblx0fVxuXG5cdHZhciBBc3NlcnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuXHQgIGZ1bmN0aW9uIEFzc2VydCh0ZXN0Q29udGV4dCkge1xuXHQgICAgX2NsYXNzQ2FsbENoZWNrKHRoaXMsIEFzc2VydCk7XG5cblx0ICAgIHRoaXMudGVzdCA9IHRlc3RDb250ZXh0O1xuXHQgIH0gLy8gQXNzZXJ0IGhlbHBlcnNcblxuXG5cdCAgX2NyZWF0ZUNsYXNzKEFzc2VydCwgW3tcblx0ICAgIGtleTogXCJ0aW1lb3V0XCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gdGltZW91dChkdXJhdGlvbikge1xuXHQgICAgICBpZiAodHlwZW9mIGR1cmF0aW9uICE9PSBcIm51bWJlclwiKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiWW91IG11c3QgcGFzcyBhIG51bWJlciBhcyB0aGUgZHVyYXRpb24gdG8gYXNzZXJ0LnRpbWVvdXRcIik7XG5cdCAgICAgIH1cblxuXHQgICAgICB0aGlzLnRlc3QudGltZW91dCA9IGR1cmF0aW9uOyAvLyBJZiBhIHRpbWVvdXQgaGFzIGJlZW4gc2V0LCBjbGVhciBpdCBhbmQgcmVzZXQgd2l0aCB0aGUgbmV3IGR1cmF0aW9uXG5cblx0ICAgICAgaWYgKGNvbmZpZy50aW1lb3V0KSB7XG5cdCAgICAgICAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0KTtcblxuXHQgICAgICAgIGlmIChjb25maWcudGltZW91dEhhbmRsZXIgJiYgdGhpcy50ZXN0LnRpbWVvdXQgPiAwKSB7XG5cdCAgICAgICAgICByZXNldFRlc3RUaW1lb3V0KHRoaXMudGVzdC50aW1lb3V0KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH0gLy8gRG9jdW1lbnRzIGEgXCJzdGVwXCIsIHdoaWNoIGlzIGEgc3RyaW5nIHZhbHVlLCBpbiBhIHRlc3QgYXMgYSBwYXNzaW5nIGFzc2VydGlvblxuXG5cdCAgfSwge1xuXHQgICAga2V5OiBcInN0ZXBcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzdGVwKG1lc3NhZ2UpIHtcblx0ICAgICAgdmFyIGFzc2VydGlvbk1lc3NhZ2UgPSBtZXNzYWdlO1xuXHQgICAgICB2YXIgcmVzdWx0ID0gISFtZXNzYWdlO1xuXHQgICAgICB0aGlzLnRlc3Quc3RlcHMucHVzaChtZXNzYWdlKTtcblxuXHQgICAgICBpZiAob2JqZWN0VHlwZShtZXNzYWdlKSA9PT0gXCJ1bmRlZmluZWRcIiB8fCBtZXNzYWdlID09PSBcIlwiKSB7XG5cdCAgICAgICAgYXNzZXJ0aW9uTWVzc2FnZSA9IFwiWW91IG11c3QgcHJvdmlkZSBhIG1lc3NhZ2UgdG8gYXNzZXJ0LnN0ZXBcIjtcblx0ICAgICAgfSBlbHNlIGlmIChvYmplY3RUeXBlKG1lc3NhZ2UpICE9PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgYXNzZXJ0aW9uTWVzc2FnZSA9IFwiWW91IG11c3QgcHJvdmlkZSBhIHN0cmluZyB2YWx1ZSB0byBhc3NlcnQuc3RlcFwiO1xuXHQgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuXHQgICAgICB9XG5cblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCxcblx0ICAgICAgICBtZXNzYWdlOiBhc3NlcnRpb25NZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfSAvLyBWZXJpZmllcyB0aGUgc3RlcHMgaW4gYSB0ZXN0IG1hdGNoIGEgZ2l2ZW4gYXJyYXkgb2Ygc3RyaW5nIHZhbHVlc1xuXG5cdCAgfSwge1xuXHQgICAga2V5OiBcInZlcmlmeVN0ZXBzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gdmVyaWZ5U3RlcHMoc3RlcHMsIG1lc3NhZ2UpIHtcblx0ICAgICAgLy8gU2luY2UgdGhlIHN0ZXBzIGFycmF5IGlzIGp1c3Qgc3RyaW5nIHZhbHVlcywgd2UgY2FuIGNsb25lIHdpdGggc2xpY2Vcblx0ICAgICAgdmFyIGFjdHVhbFN0ZXBzQ2xvbmUgPSB0aGlzLnRlc3Quc3RlcHMuc2xpY2UoKTtcblx0ICAgICAgdGhpcy5kZWVwRXF1YWwoYWN0dWFsU3RlcHNDbG9uZSwgc3RlcHMsIG1lc3NhZ2UpO1xuXHQgICAgICB0aGlzLnRlc3Quc3RlcHMubGVuZ3RoID0gMDtcblx0ICAgIH0gLy8gU3BlY2lmeSB0aGUgbnVtYmVyIG9mIGV4cGVjdGVkIGFzc2VydGlvbnMgdG8gZ3VhcmFudGVlIHRoYXQgZmFpbGVkIHRlc3Rcblx0ICAgIC8vIChubyBhc3NlcnRpb25zIGFyZSBydW4gYXQgYWxsKSBkb24ndCBzbGlwIHRocm91Z2guXG5cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZXhwZWN0XCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZXhwZWN0KGFzc2VydHMpIHtcblx0ICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPT09IDEpIHtcblx0ICAgICAgICB0aGlzLnRlc3QuZXhwZWN0ZWQgPSBhc3NlcnRzO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiB0aGlzLnRlc3QuZXhwZWN0ZWQ7XG5cdCAgICAgIH1cblx0ICAgIH0gLy8gUHV0IGEgaG9sZCBvbiBwcm9jZXNzaW5nIGFuZCByZXR1cm4gYSBmdW5jdGlvbiB0aGF0IHdpbGwgcmVsZWFzZSBpdCBhIG1heGltdW0gb2Ygb25jZS5cblxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJhc3luY1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGFzeW5jKGNvdW50KSB7XG5cdCAgICAgIHZhciB0ZXN0ID0gdGhpcy50ZXN0O1xuXHQgICAgICB2YXIgcG9wcGVkID0gZmFsc2UsXG5cdCAgICAgICAgICBhY2NlcHRDYWxsQ291bnQgPSBjb3VudDtcblxuXHQgICAgICBpZiAodHlwZW9mIGFjY2VwdENhbGxDb3VudCA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHQgICAgICAgIGFjY2VwdENhbGxDb3VudCA9IDE7XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgcmVzdW1lID0gaW50ZXJuYWxTdG9wKHRlc3QpO1xuXHQgICAgICByZXR1cm4gZnVuY3Rpb24gZG9uZSgpIHtcblx0ICAgICAgICBpZiAoY29uZmlnLmN1cnJlbnQgIT09IHRlc3QpIHtcblx0ICAgICAgICAgIHRocm93IEVycm9yKFwiYXNzZXJ0LmFzeW5jIGNhbGxiYWNrIGNhbGxlZCBhZnRlciB0ZXN0IGZpbmlzaGVkLlwiKTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAocG9wcGVkKSB7XG5cdCAgICAgICAgICB0ZXN0LnB1c2hGYWlsdXJlKFwiVG9vIG1hbnkgY2FsbHMgdG8gdGhlIGBhc3NlcnQuYXN5bmNgIGNhbGxiYWNrXCIsIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBhY2NlcHRDYWxsQ291bnQgLT0gMTtcblxuXHQgICAgICAgIGlmIChhY2NlcHRDYWxsQ291bnQgPiAwKSB7XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcG9wcGVkID0gdHJ1ZTtcblx0ICAgICAgICByZXN1bWUoKTtcblx0ICAgICAgfTtcblx0ICAgIH0gLy8gRXhwb3J0cyB0ZXN0LnB1c2goKSB0byB0aGUgdXNlciBBUElcblx0ICAgIC8vIEFsaWFzIG9mIHB1c2hSZXN1bHQuXG5cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicHVzaFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2gocmVzdWx0LCBhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCBuZWdhdGl2ZSkge1xuXHQgICAgICBMb2dnZXIud2FybihcImFzc2VydC5wdXNoIGlzIGRlcHJlY2F0ZWQgYW5kIHdpbGwgYmUgcmVtb3ZlZCBpbiBRVW5pdCAzLjAuXCIgKyBcIiBQbGVhc2UgdXNlIGFzc2VydC5wdXNoUmVzdWx0IGluc3RlYWQgKGh0dHBzOi8vYXBpLnF1bml0anMuY29tL2Fzc2VydC9wdXNoUmVzdWx0KS5cIik7XG5cdCAgICAgIHZhciBjdXJyZW50QXNzZXJ0ID0gdGhpcyBpbnN0YW5jZW9mIEFzc2VydCA/IHRoaXMgOiBjb25maWcuY3VycmVudC5hc3NlcnQ7XG5cdCAgICAgIHJldHVybiBjdXJyZW50QXNzZXJ0LnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuXHQgICAgICAgIG5lZ2F0aXZlOiBuZWdhdGl2ZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicHVzaFJlc3VsdFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2hSZXN1bHQocmVzdWx0SW5mbykge1xuXHQgICAgICAvLyBEZXN0cnVjdHVyZSBvZiByZXN1bHRJbmZvID0geyByZXN1bHQsIGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsIG5lZ2F0aXZlIH1cblx0ICAgICAgdmFyIGFzc2VydCA9IHRoaXM7XG5cdCAgICAgIHZhciBjdXJyZW50VGVzdCA9IGFzc2VydCBpbnN0YW5jZW9mIEFzc2VydCAmJiBhc3NlcnQudGVzdCB8fCBjb25maWcuY3VycmVudDsgLy8gQmFja3dhcmRzIGNvbXBhdGliaWxpdHkgZml4LlxuXHQgICAgICAvLyBBbGxvd3MgdGhlIGRpcmVjdCB1c2Ugb2YgZ2xvYmFsIGV4cG9ydGVkIGFzc2VydGlvbnMgYW5kIFFVbml0LmFzc2VydC4qXG5cdCAgICAgIC8vIEFsdGhvdWdoLCBpdCdzIHVzZSBpcyBub3QgcmVjb21tZW5kZWQgYXMgaXQgY2FuIGxlYWsgYXNzZXJ0aW9uc1xuXHQgICAgICAvLyB0byBvdGhlciB0ZXN0cyBmcm9tIGFzeW5jIHRlc3RzLCBiZWNhdXNlIHdlIG9ubHkgZ2V0IGEgcmVmZXJlbmNlIHRvIHRoZSBjdXJyZW50IHRlc3QsXG5cdCAgICAgIC8vIG5vdCBleGFjdGx5IHRoZSB0ZXN0IHdoZXJlIGFzc2VydGlvbiB3ZXJlIGludGVuZGVkIHRvIGJlIGNhbGxlZC5cblxuXHQgICAgICBpZiAoIWN1cnJlbnRUZXN0KSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiYXNzZXJ0aW9uIG91dHNpZGUgdGVzdCBjb250ZXh0LCBpbiBcIiArIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmICghKGFzc2VydCBpbnN0YW5jZW9mIEFzc2VydCkpIHtcblx0ICAgICAgICBhc3NlcnQgPSBjdXJyZW50VGVzdC5hc3NlcnQ7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gYXNzZXJ0LnRlc3QucHVzaFJlc3VsdChyZXN1bHRJbmZvKTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwib2tcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBvayhyZXN1bHQsIG1lc3NhZ2UpIHtcblx0ICAgICAgaWYgKCFtZXNzYWdlKSB7XG5cdCAgICAgICAgbWVzc2FnZSA9IHJlc3VsdCA/IFwib2theVwiIDogXCJmYWlsZWQsIGV4cGVjdGVkIGFyZ3VtZW50IHRvIGJlIHRydXRoeSwgd2FzOiBcIi5jb25jYXQoZHVtcC5wYXJzZShyZXN1bHQpKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiAhIXJlc3VsdCxcblx0ICAgICAgICBhY3R1YWw6IHJlc3VsdCxcblx0ICAgICAgICBleHBlY3RlZDogdHJ1ZSxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJub3RPa1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIG5vdE9rKHJlc3VsdCwgbWVzc2FnZSkge1xuXHQgICAgICBpZiAoIW1lc3NhZ2UpIHtcblx0ICAgICAgICBtZXNzYWdlID0gIXJlc3VsdCA/IFwib2theVwiIDogXCJmYWlsZWQsIGV4cGVjdGVkIGFyZ3VtZW50IHRvIGJlIGZhbHN5LCB3YXM6IFwiLmNvbmNhdChkdW1wLnBhcnNlKHJlc3VsdCkpO1xuXHQgICAgICB9XG5cblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6ICFyZXN1bHQsXG5cdCAgICAgICAgYWN0dWFsOiByZXN1bHQsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGZhbHNlLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInRydWVcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBfdHJ1ZShyZXN1bHQsIG1lc3NhZ2UpIHtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCA9PT0gdHJ1ZSxcblx0ICAgICAgICBhY3R1YWw6IHJlc3VsdCxcblx0ICAgICAgICBleHBlY3RlZDogdHJ1ZSxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJmYWxzZVwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIF9mYWxzZShyZXN1bHQsIG1lc3NhZ2UpIHtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCA9PT0gZmFsc2UsXG5cdCAgICAgICAgYWN0dWFsOiByZXN1bHQsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGZhbHNlLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxXG5cdCAgICAgIHZhciByZXN1bHQgPSBleHBlY3RlZCA9PSBhY3R1YWw7XG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiByZXN1bHQsXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcIm5vdEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gbm90RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZXFlcWVxXG5cdCAgICAgIHZhciByZXN1bHQgPSBleHBlY3RlZCAhPSBhY3R1YWw7XG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiByZXN1bHQsXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdCAgICAgICAgbmVnYXRpdmU6IHRydWVcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInByb3BFcXVhbFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHByb3BFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIGFjdHVhbCA9IG9iamVjdFZhbHVlcyhhY3R1YWwpO1xuXHQgICAgICBleHBlY3RlZCA9IG9iamVjdFZhbHVlcyhleHBlY3RlZCk7XG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiBlcXVpdihhY3R1YWwsIGV4cGVjdGVkKSxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwibm90UHJvcEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gbm90UHJvcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgYWN0dWFsID0gb2JqZWN0VmFsdWVzKGFjdHVhbCk7XG5cdCAgICAgIGV4cGVjdGVkID0gb2JqZWN0VmFsdWVzKGV4cGVjdGVkKTtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6ICFlcXVpdihhY3R1YWwsIGV4cGVjdGVkKSxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcblx0ICAgICAgICBuZWdhdGl2ZTogdHJ1ZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZGVlcEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZGVlcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IGVxdWl2KGFjdHVhbCwgZXhwZWN0ZWQpLFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJub3REZWVwRXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBub3REZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogIWVxdWl2KGFjdHVhbCwgZXhwZWN0ZWQpLFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuXHQgICAgICAgIG5lZ2F0aXZlOiB0cnVlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJzdHJpY3RFcXVhbFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN0cmljdEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IGV4cGVjdGVkID09PSBhY3R1YWwsXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcIm5vdFN0cmljdEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gbm90U3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogZXhwZWN0ZWQgIT09IGFjdHVhbCxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcblx0ICAgICAgICBuZWdhdGl2ZTogdHJ1ZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwidGhyb3dzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gdGhyb3dzKGJsb2NrLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB2YXIgYWN0dWFsLFxuXHQgICAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG5cdCAgICAgIHZhciBjdXJyZW50VGVzdCA9IHRoaXMgaW5zdGFuY2VvZiBBc3NlcnQgJiYgdGhpcy50ZXN0IHx8IGNvbmZpZy5jdXJyZW50OyAvLyAnZXhwZWN0ZWQnIGlzIG9wdGlvbmFsIHVubGVzcyBkb2luZyBzdHJpbmcgY29tcGFyaXNvblxuXG5cdCAgICAgIGlmIChvYmplY3RUeXBlKGV4cGVjdGVkKSA9PT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAgIGlmIChtZXNzYWdlID09IG51bGwpIHtcblx0ICAgICAgICAgIG1lc3NhZ2UgPSBleHBlY3RlZDtcblx0ICAgICAgICAgIGV4cGVjdGVkID0gbnVsbDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwidGhyb3dzL3JhaXNlcyBkb2VzIG5vdCBhY2NlcHQgYSBzdHJpbmcgdmFsdWUgZm9yIHRoZSBleHBlY3RlZCBhcmd1bWVudC5cXG5cIiArIFwiVXNlIGEgbm9uLXN0cmluZyBvYmplY3QgdmFsdWUgKGUuZy4gcmVnRXhwKSBpbnN0ZWFkIGlmIGl0J3MgbmVjZXNzYXJ5LlwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICBjdXJyZW50VGVzdC5pZ25vcmVHbG9iYWxFcnJvcnMgPSB0cnVlO1xuXG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgYmxvY2suY2FsbChjdXJyZW50VGVzdC50ZXN0RW52aXJvbm1lbnQpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgYWN0dWFsID0gZTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGN1cnJlbnRUZXN0Lmlnbm9yZUdsb2JhbEVycm9ycyA9IGZhbHNlO1xuXG5cdCAgICAgIGlmIChhY3R1YWwpIHtcblx0ICAgICAgICB2YXIgZXhwZWN0ZWRUeXBlID0gb2JqZWN0VHlwZShleHBlY3RlZCk7IC8vIFdlIGRvbid0IHdhbnQgdG8gdmFsaWRhdGUgdGhyb3duIGVycm9yXG5cblx0ICAgICAgICBpZiAoIWV4cGVjdGVkKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSB0cnVlOyAvLyBFeHBlY3RlZCBpcyBhIHJlZ2V4cFxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcInJlZ2V4cFwiKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSBleHBlY3RlZC50ZXN0KGVycm9yU3RyaW5nKGFjdHVhbCkpOyAvLyBMb2cgdGhlIHN0cmluZyBmb3JtIG9mIHRoZSByZWdleHBcblxuXHQgICAgICAgICAgZXhwZWN0ZWQgPSBTdHJpbmcoZXhwZWN0ZWQpOyAvLyBFeHBlY3RlZCBpcyBhIGNvbnN0cnVjdG9yLCBtYXliZSBhbiBFcnJvciBjb25zdHJ1Y3RvclxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcImZ1bmN0aW9uXCIgJiYgYWN0dWFsIGluc3RhbmNlb2YgZXhwZWN0ZWQpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRydWU7IC8vIEV4cGVjdGVkIGlzIGFuIEVycm9yIG9iamVjdFxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcIm9iamVjdFwiKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSBhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZC5jb25zdHJ1Y3RvciAmJiBhY3R1YWwubmFtZSA9PT0gZXhwZWN0ZWQubmFtZSAmJiBhY3R1YWwubWVzc2FnZSA9PT0gZXhwZWN0ZWQubWVzc2FnZTsgLy8gTG9nIHRoZSBzdHJpbmcgZm9ybSBvZiB0aGUgRXJyb3Igb2JqZWN0XG5cblx0ICAgICAgICAgIGV4cGVjdGVkID0gZXJyb3JTdHJpbmcoZXhwZWN0ZWQpOyAvLyBFeHBlY3RlZCBpcyBhIHZhbGlkYXRpb24gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyB0cnVlIGlmIHZhbGlkYXRpb24gcGFzc2VkXG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwiZnVuY3Rpb25cIiAmJiBleHBlY3RlZC5jYWxsKHt9LCBhY3R1YWwpID09PSB0cnVlKSB7XG5cdCAgICAgICAgICBleHBlY3RlZCA9IG51bGw7XG5cdCAgICAgICAgICByZXN1bHQgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIGN1cnJlbnRUZXN0LmFzc2VydC5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCxcblx0ICAgICAgICAvLyB1bmRlZmluZWQgaWYgaXQgZGlkbid0IHRocm93XG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwgJiYgZXJyb3JTdHJpbmcoYWN0dWFsKSxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicmVqZWN0c1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHJlamVjdHMocHJvbWlzZSwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgdmFyIHJlc3VsdCA9IGZhbHNlO1xuXHQgICAgICB2YXIgY3VycmVudFRlc3QgPSB0aGlzIGluc3RhbmNlb2YgQXNzZXJ0ICYmIHRoaXMudGVzdCB8fCBjb25maWcuY3VycmVudDsgLy8gJ2V4cGVjdGVkJyBpcyBvcHRpb25hbCB1bmxlc3MgZG9pbmcgc3RyaW5nIGNvbXBhcmlzb25cblxuXHQgICAgICBpZiAob2JqZWN0VHlwZShleHBlY3RlZCkgPT09IFwic3RyaW5nXCIpIHtcblx0ICAgICAgICBpZiAobWVzc2FnZSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgICBtZXNzYWdlID0gZXhwZWN0ZWQ7XG5cdCAgICAgICAgICBleHBlY3RlZCA9IHVuZGVmaW5lZDtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgbWVzc2FnZSA9IFwiYXNzZXJ0LnJlamVjdHMgZG9lcyBub3QgYWNjZXB0IGEgc3RyaW5nIHZhbHVlIGZvciB0aGUgZXhwZWN0ZWQgXCIgKyBcImFyZ3VtZW50LlxcblVzZSBhIG5vbi1zdHJpbmcgb2JqZWN0IHZhbHVlIChlLmcuIHZhbGlkYXRvciBmdW5jdGlvbikgaW5zdGVhZCBcIiArIFwiaWYgbmVjZXNzYXJ5LlwiO1xuXHQgICAgICAgICAgY3VycmVudFRlc3QuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuXHQgICAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuXHQgICAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgdGhlbiA9IHByb21pc2UgJiYgcHJvbWlzZS50aGVuO1xuXG5cdCAgICAgIGlmIChvYmplY3RUeXBlKHRoZW4pICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgICAgICB2YXIgX21lc3NhZ2UgPSBcIlRoZSB2YWx1ZSBwcm92aWRlZCB0byBgYXNzZXJ0LnJlamVjdHNgIGluIFwiICsgXCJcXFwiXCIgKyBjdXJyZW50VGVzdC50ZXN0TmFtZSArIFwiXFxcIiB3YXMgbm90IGEgcHJvbWlzZS5cIjtcblxuXHQgICAgICAgIGN1cnJlbnRUZXN0LmFzc2VydC5wdXNoUmVzdWx0KHtcblx0ICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG5cdCAgICAgICAgICBtZXNzYWdlOiBfbWVzc2FnZSxcblx0ICAgICAgICAgIGFjdHVhbDogcHJvbWlzZVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciBkb25lID0gdGhpcy5hc3luYygpO1xuXHQgICAgICByZXR1cm4gdGhlbi5jYWxsKHByb21pc2UsIGZ1bmN0aW9uIGhhbmRsZUZ1bGZpbGxtZW50KCkge1xuXHQgICAgICAgIHZhciBtZXNzYWdlID0gXCJUaGUgcHJvbWlzZSByZXR1cm5lZCBieSB0aGUgYGFzc2VydC5yZWplY3RzYCBjYWxsYmFjayBpbiBcIiArIFwiXFxcIlwiICsgY3VycmVudFRlc3QudGVzdE5hbWUgKyBcIlxcXCIgZGlkIG5vdCByZWplY3QuXCI7XG5cdCAgICAgICAgY3VycmVudFRlc3QuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuXHQgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcblx0ICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdCAgICAgICAgICBhY3R1YWw6IHByb21pc2Vcblx0ICAgICAgICB9KTtcblx0ICAgICAgICBkb25lKCk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uIGhhbmRsZVJlamVjdGlvbihhY3R1YWwpIHtcblx0ICAgICAgICB2YXIgZXhwZWN0ZWRUeXBlID0gb2JqZWN0VHlwZShleHBlY3RlZCk7IC8vIFdlIGRvbid0IHdhbnQgdG8gdmFsaWRhdGVcblxuXHQgICAgICAgIGlmIChleHBlY3RlZCA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSB0cnVlOyAvLyBFeHBlY3RlZCBpcyBhIHJlZ2V4cFxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcInJlZ2V4cFwiKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSBleHBlY3RlZC50ZXN0KGVycm9yU3RyaW5nKGFjdHVhbCkpOyAvLyBMb2cgdGhlIHN0cmluZyBmb3JtIG9mIHRoZSByZWdleHBcblxuXHQgICAgICAgICAgZXhwZWN0ZWQgPSBTdHJpbmcoZXhwZWN0ZWQpOyAvLyBFeHBlY3RlZCBpcyBhIGNvbnN0cnVjdG9yLCBtYXliZSBhbiBFcnJvciBjb25zdHJ1Y3RvclxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcImZ1bmN0aW9uXCIgJiYgYWN0dWFsIGluc3RhbmNlb2YgZXhwZWN0ZWQpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRydWU7IC8vIEV4cGVjdGVkIGlzIGFuIEVycm9yIG9iamVjdFxuXHQgICAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWRUeXBlID09PSBcIm9iamVjdFwiKSB7XG5cdCAgICAgICAgICByZXN1bHQgPSBhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZC5jb25zdHJ1Y3RvciAmJiBhY3R1YWwubmFtZSA9PT0gZXhwZWN0ZWQubmFtZSAmJiBhY3R1YWwubWVzc2FnZSA9PT0gZXhwZWN0ZWQubWVzc2FnZTsgLy8gTG9nIHRoZSBzdHJpbmcgZm9ybSBvZiB0aGUgRXJyb3Igb2JqZWN0XG5cblx0ICAgICAgICAgIGV4cGVjdGVkID0gZXJyb3JTdHJpbmcoZXhwZWN0ZWQpOyAvLyBFeHBlY3RlZCBpcyBhIHZhbGlkYXRpb24gZnVuY3Rpb24gd2hpY2ggcmV0dXJucyB0cnVlIGlmIHZhbGlkYXRpb24gcGFzc2VkXG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGlmIChleHBlY3RlZFR5cGUgPT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgICAgICAgICByZXN1bHQgPSBleHBlY3RlZC5jYWxsKHt9LCBhY3R1YWwpID09PSB0cnVlO1xuXHQgICAgICAgICAgICBleHBlY3RlZCA9IG51bGw7IC8vIEV4cGVjdGVkIGlzIHNvbWUgb3RoZXIgaW52YWxpZCB0eXBlXG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgbWVzc2FnZSA9IFwiaW52YWxpZCBleHBlY3RlZCB2YWx1ZSBwcm92aWRlZCB0byBgYXNzZXJ0LnJlamVjdHNgIFwiICsgXCJjYWxsYmFjayBpbiBcXFwiXCIgKyBjdXJyZW50VGVzdC50ZXN0TmFtZSArIFwiXFxcIjogXCIgKyBleHBlY3RlZFR5cGUgKyBcIi5cIjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cblx0ICAgICAgICBjdXJyZW50VGVzdC5hc3NlcnQucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgICByZXN1bHQ6IHJlc3VsdCxcblx0ICAgICAgICAgIC8vIGxlYXZlIHJlamVjdGlvbiB2YWx1ZSBvZiB1bmRlZmluZWQgYXMtaXNcblx0ICAgICAgICAgIGFjdHVhbDogYWN0dWFsICYmIGVycm9yU3RyaW5nKGFjdHVhbCksXG5cdCAgICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgZG9uZSgpO1xuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9XSk7XG5cblx0ICByZXR1cm4gQXNzZXJ0O1xuXHR9KCk7IC8vIFByb3ZpZGUgYW4gYWx0ZXJuYXRpdmUgdG8gYXNzZXJ0LnRocm93cygpLCBmb3IgZW52aXJvbm1lbnRzIHRoYXQgY29uc2lkZXIgdGhyb3dzIGEgcmVzZXJ2ZWQgd29yZFxuXHQvLyBLbm93biB0byB1cyBhcmU6IENsb3N1cmUgQ29tcGlsZXIsIE5hcndoYWxcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRvdC1ub3RhdGlvblxuXG5cblx0QXNzZXJ0LnByb3RvdHlwZS5yYWlzZXMgPSBBc3NlcnQucHJvdG90eXBlW1widGhyb3dzXCJdO1xuXHQvKipcblx0ICogQ29udmVydHMgYW4gZXJyb3IgaW50byBhIHNpbXBsZSBzdHJpbmcgZm9yIGNvbXBhcmlzb25zLlxuXHQgKlxuXHQgKiBAcGFyYW0ge0Vycm9yfE9iamVjdH0gZXJyb3Jcblx0ICogQHJldHVybiB7U3RyaW5nfVxuXHQgKi9cblxuXHRmdW5jdGlvbiBlcnJvclN0cmluZyhlcnJvcikge1xuXHQgIHZhciByZXN1bHRFcnJvclN0cmluZyA9IGVycm9yLnRvU3RyaW5nKCk7IC8vIElmIHRoZSBlcnJvciB3YXNuJ3QgYSBzdWJjbGFzcyBvZiBFcnJvciBidXQgc29tZXRoaW5nIGxpa2Vcblx0ICAvLyBhbiBvYmplY3QgbGl0ZXJhbCB3aXRoIG5hbWUgYW5kIG1lc3NhZ2UgcHJvcGVydGllcy4uLlxuXG5cdCAgaWYgKHJlc3VsdEVycm9yU3RyaW5nLnN1YnN0cmluZygwLCA3KSA9PT0gXCJbb2JqZWN0XCIpIHtcblx0ICAgIHZhciBuYW1lID0gZXJyb3IubmFtZSA/IGVycm9yLm5hbWUudG9TdHJpbmcoKSA6IFwiRXJyb3JcIjtcblx0ICAgIHZhciBtZXNzYWdlID0gZXJyb3IubWVzc2FnZSA/IGVycm9yLm1lc3NhZ2UudG9TdHJpbmcoKSA6IFwiXCI7XG5cblx0ICAgIGlmIChuYW1lICYmIG1lc3NhZ2UpIHtcblx0ICAgICAgcmV0dXJuIFwiXCIuY29uY2F0KG5hbWUsIFwiOiBcIikuY29uY2F0KG1lc3NhZ2UpO1xuXHQgICAgfSBlbHNlIGlmIChuYW1lKSB7XG5cdCAgICAgIHJldHVybiBuYW1lO1xuXHQgICAgfSBlbHNlIGlmIChtZXNzYWdlKSB7XG5cdCAgICAgIHJldHVybiBtZXNzYWdlO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgcmV0dXJuIFwiRXJyb3JcIjtcblx0ICAgIH1cblx0ICB9IGVsc2Uge1xuXHQgICAgcmV0dXJuIHJlc3VsdEVycm9yU3RyaW5nO1xuXHQgIH1cblx0fVxuXG5cdC8qIGdsb2JhbCBtb2R1bGUsIGV4cG9ydHMsIGRlZmluZSAqL1xuXHRmdW5jdGlvbiBleHBvcnRRVW5pdChRVW5pdCkge1xuXHQgIGlmIChkZWZpbmVkLmRvY3VtZW50KSB7XG5cdCAgICAvLyBRVW5pdCBtYXkgYmUgZGVmaW5lZCB3aGVuIGl0IGlzIHByZWNvbmZpZ3VyZWQgYnV0IHRoZW4gb25seSBRVW5pdCBhbmQgUVVuaXQuY29uZmlnIG1heSBiZSBkZWZpbmVkLlxuXHQgICAgaWYgKHdpbmRvdyQxLlFVbml0ICYmIHdpbmRvdyQxLlFVbml0LnZlcnNpb24pIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKFwiUVVuaXQgaGFzIGFscmVhZHkgYmVlbiBkZWZpbmVkLlwiKTtcblx0ICAgIH1cblxuXHQgICAgd2luZG93JDEuUVVuaXQgPSBRVW5pdDtcblx0ICB9IC8vIEZvciBub2RlanNcblxuXG5cdCAgaWYgKHR5cGVvZiBtb2R1bGUgIT09IFwidW5kZWZpbmVkXCIgJiYgbW9kdWxlICYmIG1vZHVsZS5leHBvcnRzKSB7XG5cdCAgICBtb2R1bGUuZXhwb3J0cyA9IFFVbml0OyAvLyBGb3IgY29uc2lzdGVuY3kgd2l0aCBDb21tb25KUyBlbnZpcm9ubWVudHMnIGV4cG9ydHNcblxuXHQgICAgbW9kdWxlLmV4cG9ydHMuUVVuaXQgPSBRVW5pdDtcblx0ICB9IC8vIEZvciBDb21tb25KUyB3aXRoIGV4cG9ydHMsIGJ1dCB3aXRob3V0IG1vZHVsZS5leHBvcnRzLCBsaWtlIFJoaW5vXG5cblxuXHQgIGlmICh0eXBlb2YgZXhwb3J0cyAhPT0gXCJ1bmRlZmluZWRcIiAmJiBleHBvcnRzKSB7XG5cdCAgICBleHBvcnRzLlFVbml0ID0gUVVuaXQ7XG5cdCAgfVxuXG5cdCAgaWYgKHR5cGVvZiBkZWZpbmUgPT09IFwiZnVuY3Rpb25cIiAmJiBkZWZpbmUuYW1kKSB7XG5cdCAgICBkZWZpbmUoZnVuY3Rpb24gKCkge1xuXHQgICAgICByZXR1cm4gUVVuaXQ7XG5cdCAgICB9KTtcblx0ICAgIFFVbml0LmNvbmZpZy5hdXRvc3RhcnQgPSBmYWxzZTtcblx0ICB9IC8vIEZvciBXZWIvU2VydmljZSBXb3JrZXJzXG5cblxuXHQgIGlmIChzZWxmJDEgJiYgc2VsZiQxLldvcmtlckdsb2JhbFNjb3BlICYmIHNlbGYkMSBpbnN0YW5jZW9mIHNlbGYkMS5Xb3JrZXJHbG9iYWxTY29wZSkge1xuXHQgICAgc2VsZiQxLlFVbml0ID0gUVVuaXQ7XG5cdCAgfVxuXHR9XG5cblx0Ly8gZXJyb3IgaGFuZGxpbmcgc2hvdWxkIGJlIHN1cHByZXNzZWQgYW5kIGZhbHNlIG90aGVyd2lzZS5cblx0Ly8gSW4gdGhpcyBjYXNlLCB3ZSB3aWxsIG9ubHkgc3VwcHJlc3MgZnVydGhlciBlcnJvciBoYW5kbGluZyBpZiB0aGVcblx0Ly8gXCJpZ25vcmVHbG9iYWxFcnJvcnNcIiBjb25maWd1cmF0aW9uIG9wdGlvbiBpcyBlbmFibGVkLlxuXG5cdGZ1bmN0aW9uIG9uRXJyb3IoZXJyb3IpIHtcblx0ICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gMSA/IF9sZW4gLSAxIDogMCksIF9rZXkgPSAxOyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG5cdCAgICBhcmdzW19rZXkgLSAxXSA9IGFyZ3VtZW50c1tfa2V5XTtcblx0ICB9XG5cblx0ICBpZiAoY29uZmlnLmN1cnJlbnQpIHtcblx0ICAgIGlmIChjb25maWcuY3VycmVudC5pZ25vcmVHbG9iYWxFcnJvcnMpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cblx0ICAgIHB1c2hGYWlsdXJlLmFwcGx5KHZvaWQgMCwgW2Vycm9yLm1lc3NhZ2UsIGVycm9yLnN0YWNrdHJhY2UgfHwgZXJyb3IuZmlsZU5hbWUgKyBcIjpcIiArIGVycm9yLmxpbmVOdW1iZXJdLmNvbmNhdChhcmdzKSk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHRlc3QoXCJnbG9iYWwgZmFpbHVyZVwiLCBleHRlbmQoZnVuY3Rpb24gKCkge1xuXHQgICAgICBwdXNoRmFpbHVyZS5hcHBseSh2b2lkIDAsIFtlcnJvci5tZXNzYWdlLCBlcnJvci5zdGFja3RyYWNlIHx8IGVycm9yLmZpbGVOYW1lICsgXCI6XCIgKyBlcnJvci5saW5lTnVtYmVyXS5jb25jYXQoYXJncykpO1xuXHQgICAgfSwge1xuXHQgICAgICB2YWxpZFRlc3Q6IHRydWVcblx0ICAgIH0pKTtcblx0ICB9XG5cblx0ICByZXR1cm4gZmFsc2U7XG5cdH1cblxuXHRmdW5jdGlvbiBvblVuaGFuZGxlZFJlamVjdGlvbihyZWFzb24pIHtcblx0ICB2YXIgcmVzdWx0SW5mbyA9IHtcblx0ICAgIHJlc3VsdDogZmFsc2UsXG5cdCAgICBtZXNzYWdlOiByZWFzb24ubWVzc2FnZSB8fCBcImVycm9yXCIsXG5cdCAgICBhY3R1YWw6IHJlYXNvbixcblx0ICAgIHNvdXJjZTogcmVhc29uLnN0YWNrIHx8IHNvdXJjZUZyb21TdGFja3RyYWNlKDMpXG5cdCAgfTtcblx0ICB2YXIgY3VycmVudFRlc3QgPSBjb25maWcuY3VycmVudDtcblxuXHQgIGlmIChjdXJyZW50VGVzdCkge1xuXHQgICAgY3VycmVudFRlc3QuYXNzZXJ0LnB1c2hSZXN1bHQocmVzdWx0SW5mbyk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHRlc3QoXCJnbG9iYWwgZmFpbHVyZVwiLCBleHRlbmQoZnVuY3Rpb24gKGFzc2VydCkge1xuXHQgICAgICBhc3NlcnQucHVzaFJlc3VsdChyZXN1bHRJbmZvKTtcblx0ICAgIH0sIHtcblx0ICAgICAgdmFsaWRUZXN0OiB0cnVlXG5cdCAgICB9KSk7XG5cdCAgfVxuXHR9XG5cblx0dmFyIFFVbml0ID0ge307XG5cdHZhciBnbG9iYWxTdWl0ZSA9IG5ldyBTdWl0ZVJlcG9ydCgpOyAvLyBUaGUgaW5pdGlhbCBcImN1cnJlbnRNb2R1bGVcIiByZXByZXNlbnRzIHRoZSBnbG9iYWwgKG9yIHRvcC1sZXZlbCkgbW9kdWxlIHRoYXRcblx0Ly8gaXMgbm90IGV4cGxpY2l0bHkgZGVmaW5lZCBieSB0aGUgdXNlciwgdGhlcmVmb3JlIHdlIGFkZCB0aGUgXCJnbG9iYWxTdWl0ZVwiIHRvXG5cdC8vIGl0IHNpbmNlIGVhY2ggbW9kdWxlIGhhcyBhIHN1aXRlUmVwb3J0IGFzc29jaWF0ZWQgd2l0aCBpdC5cblxuXHRjb25maWcuY3VycmVudE1vZHVsZS5zdWl0ZVJlcG9ydCA9IGdsb2JhbFN1aXRlO1xuXHR2YXIgZ2xvYmFsU3RhcnRDYWxsZWQgPSBmYWxzZTtcblx0dmFyIHJ1blN0YXJ0ZWQgPSBmYWxzZTsgLy8gRmlndXJlIG91dCBpZiB3ZSdyZSBydW5uaW5nIHRoZSB0ZXN0cyBmcm9tIGEgc2VydmVyIG9yIG5vdFxuXG5cdFFVbml0LmlzTG9jYWwgPSAhKGRlZmluZWQuZG9jdW1lbnQgJiYgd2luZG93JDEubG9jYXRpb24ucHJvdG9jb2wgIT09IFwiZmlsZTpcIik7IC8vIEV4cG9zZSB0aGUgY3VycmVudCBRVW5pdCB2ZXJzaW9uXG5cblx0UVVuaXQudmVyc2lvbiA9IFwiMi4xMS4zXCI7XG5cdGV4dGVuZChRVW5pdCwge1xuXHQgIG9uOiBvbixcblx0ICBtb2R1bGU6IG1vZHVsZSQxLFxuXHQgIHRlc3Q6IHRlc3QsXG5cdCAgdG9kbzogdG9kbyxcblx0ICBza2lwOiBza2lwLFxuXHQgIG9ubHk6IG9ubHksXG5cdCAgc3RhcnQ6IGZ1bmN0aW9uIHN0YXJ0KGNvdW50KSB7XG5cdCAgICB2YXIgZ2xvYmFsU3RhcnRBbHJlYWR5Q2FsbGVkID0gZ2xvYmFsU3RhcnRDYWxsZWQ7XG5cblx0ICAgIGlmICghY29uZmlnLmN1cnJlbnQpIHtcblx0ICAgICAgZ2xvYmFsU3RhcnRDYWxsZWQgPSB0cnVlO1xuXG5cdCAgICAgIGlmIChydW5TdGFydGVkKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FsbGVkIHN0YXJ0KCkgd2hpbGUgdGVzdCBhbHJlYWR5IHN0YXJ0ZWQgcnVubmluZ1wiKTtcblx0ICAgICAgfSBlbHNlIGlmIChnbG9iYWxTdGFydEFscmVhZHlDYWxsZWQgfHwgY291bnQgPiAxKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FsbGVkIHN0YXJ0KCkgb3V0c2lkZSBvZiBhIHRlc3QgY29udGV4dCB0b28gbWFueSB0aW1lc1wiKTtcblx0ICAgICAgfSBlbHNlIGlmIChjb25maWcuYXV0b3N0YXJ0KSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQ2FsbGVkIHN0YXJ0KCkgb3V0c2lkZSBvZiBhIHRlc3QgY29udGV4dCB3aGVuIFwiICsgXCJRVW5pdC5jb25maWcuYXV0b3N0YXJ0IHdhcyB0cnVlXCIpO1xuXHQgICAgICB9IGVsc2UgaWYgKCFjb25maWcucGFnZUxvYWRlZCkge1xuXHQgICAgICAgIC8vIFRoZSBwYWdlIGlzbid0IGNvbXBsZXRlbHkgbG9hZGVkIHlldCwgc28gd2Ugc2V0IGF1dG9zdGFydCBhbmQgdGhlblxuXHQgICAgICAgIC8vIGxvYWQgaWYgd2UncmUgaW4gTm9kZSBvciB3YWl0IGZvciB0aGUgYnJvd3NlcidzIGxvYWQgZXZlbnQuXG5cdCAgICAgICAgY29uZmlnLmF1dG9zdGFydCA9IHRydWU7IC8vIFN0YXJ0cyBmcm9tIE5vZGUgZXZlbiBpZiAubG9hZCB3YXMgbm90IHByZXZpb3VzbHkgY2FsbGVkLiBXZSBzdGlsbCByZXR1cm5cblx0ICAgICAgICAvLyBlYXJseSBvdGhlcndpc2Ugd2UnbGwgd2luZCB1cCBcImJlZ2lubmluZ1wiIHR3aWNlLlxuXG5cdCAgICAgICAgaWYgKCFkZWZpbmVkLmRvY3VtZW50KSB7XG5cdCAgICAgICAgICBRVW5pdC5sb2FkKCk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJRVW5pdC5zdGFydCBjYW5ub3QgYmUgY2FsbGVkIGluc2lkZSBhIHRlc3QgY29udGV4dC5cIik7XG5cdCAgICB9XG5cblx0ICAgIHNjaGVkdWxlQmVnaW4oKTtcblx0ICB9LFxuXHQgIGNvbmZpZzogY29uZmlnLFxuXHQgIGlzOiBpcyxcblx0ICBvYmplY3RUeXBlOiBvYmplY3RUeXBlLFxuXHQgIGV4dGVuZDogZXh0ZW5kLFxuXHQgIGxvYWQ6IGZ1bmN0aW9uIGxvYWQoKSB7XG5cdCAgICBjb25maWcucGFnZUxvYWRlZCA9IHRydWU7IC8vIEluaXRpYWxpemUgdGhlIGNvbmZpZ3VyYXRpb24gb3B0aW9uc1xuXG5cdCAgICBleHRlbmQoY29uZmlnLCB7XG5cdCAgICAgIHN0YXRzOiB7XG5cdCAgICAgICAgYWxsOiAwLFxuXHQgICAgICAgIGJhZDogMCxcblx0ICAgICAgICB0ZXN0Q291bnQ6IDBcblx0ICAgICAgfSxcblx0ICAgICAgc3RhcnRlZDogMCxcblx0ICAgICAgdXBkYXRlUmF0ZTogMTAwMCxcblx0ICAgICAgYXV0b3N0YXJ0OiB0cnVlLFxuXHQgICAgICBmaWx0ZXI6IFwiXCJcblx0ICAgIH0sIHRydWUpO1xuXG5cdCAgICBpZiAoIXJ1blN0YXJ0ZWQpIHtcblx0ICAgICAgY29uZmlnLmJsb2NraW5nID0gZmFsc2U7XG5cblx0ICAgICAgaWYgKGNvbmZpZy5hdXRvc3RhcnQpIHtcblx0ICAgICAgICBzY2hlZHVsZUJlZ2luKCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LFxuXHQgIHN0YWNrOiBmdW5jdGlvbiBzdGFjayhvZmZzZXQpIHtcblx0ICAgIG9mZnNldCA9IChvZmZzZXQgfHwgMCkgKyAyO1xuXHQgICAgcmV0dXJuIHNvdXJjZUZyb21TdGFja3RyYWNlKG9mZnNldCk7XG5cdCAgfSxcblx0ICBvbkVycm9yOiBvbkVycm9yLFxuXHQgIG9uVW5oYW5kbGVkUmVqZWN0aW9uOiBvblVuaGFuZGxlZFJlamVjdGlvblxuXHR9KTtcblx0UVVuaXQucHVzaEZhaWx1cmUgPSBwdXNoRmFpbHVyZTtcblx0UVVuaXQuYXNzZXJ0ID0gQXNzZXJ0LnByb3RvdHlwZTtcblx0UVVuaXQuZXF1aXYgPSBlcXVpdjtcblx0UVVuaXQuZHVtcCA9IGR1bXA7XG5cdHJlZ2lzdGVyTG9nZ2luZ0NhbGxiYWNrcyhRVW5pdCk7XG5cblx0ZnVuY3Rpb24gc2NoZWR1bGVCZWdpbigpIHtcblx0ICBydW5TdGFydGVkID0gdHJ1ZTsgLy8gQWRkIGEgc2xpZ2h0IGRlbGF5IHRvIGFsbG93IGRlZmluaXRpb24gb2YgbW9yZSBtb2R1bGVzIGFuZCB0ZXN0cy5cblxuXHQgIGlmIChkZWZpbmVkLnNldFRpbWVvdXQpIHtcblx0ICAgIHNldFRpbWVvdXQkMShmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGJlZ2luKCk7XG5cdCAgICB9KTtcblx0ICB9IGVsc2Uge1xuXHQgICAgYmVnaW4oKTtcblx0ICB9XG5cdH1cblxuXHRmdW5jdGlvbiB1bmJsb2NrQW5kQWR2YW5jZVF1ZXVlKCkge1xuXHQgIGNvbmZpZy5ibG9ja2luZyA9IGZhbHNlO1xuXHQgIFByb2Nlc3NpbmdRdWV1ZS5hZHZhbmNlKCk7XG5cdH1cblxuXHRmdW5jdGlvbiBiZWdpbigpIHtcblx0ICB2YXIgaSxcblx0ICAgICAgbCxcblx0ICAgICAgbW9kdWxlc0xvZyA9IFtdOyAvLyBJZiB0aGUgdGVzdCBydW4gaGFzbid0IG9mZmljaWFsbHkgYmVndW4geWV0XG5cblx0ICBpZiAoIWNvbmZpZy5zdGFydGVkKSB7XG5cdCAgICAvLyBSZWNvcmQgdGhlIHRpbWUgb2YgdGhlIHRlc3QgcnVuJ3MgYmVnaW5uaW5nXG5cdCAgICBjb25maWcuc3RhcnRlZCA9IG5vdygpOyAvLyBEZWxldGUgdGhlIGxvb3NlIHVubmFtZWQgbW9kdWxlIGlmIHVudXNlZC5cblxuXHQgICAgaWYgKGNvbmZpZy5tb2R1bGVzWzBdLm5hbWUgPT09IFwiXCIgJiYgY29uZmlnLm1vZHVsZXNbMF0udGVzdHMubGVuZ3RoID09PSAwKSB7XG5cdCAgICAgIGNvbmZpZy5tb2R1bGVzLnNoaWZ0KCk7XG5cdCAgICB9IC8vIEF2b2lkIHVubmVjZXNzYXJ5IGluZm9ybWF0aW9uIGJ5IG5vdCBsb2dnaW5nIG1vZHVsZXMnIHRlc3QgZW52aXJvbm1lbnRzXG5cblxuXHQgICAgZm9yIChpID0gMCwgbCA9IGNvbmZpZy5tb2R1bGVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAgICBtb2R1bGVzTG9nLnB1c2goe1xuXHQgICAgICAgIG5hbWU6IGNvbmZpZy5tb2R1bGVzW2ldLm5hbWUsXG5cdCAgICAgICAgdGVzdHM6IGNvbmZpZy5tb2R1bGVzW2ldLnRlc3RzXG5cdCAgICAgIH0pO1xuXHQgICAgfSAvLyBUaGUgdGVzdCBydW4gaXMgb2ZmaWNpYWxseSBiZWdpbm5pbmcgbm93XG5cblxuXHQgICAgZW1pdChcInJ1blN0YXJ0XCIsIGdsb2JhbFN1aXRlLnN0YXJ0KHRydWUpKTtcblx0ICAgIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJiZWdpblwiLCB7XG5cdCAgICAgIHRvdGFsVGVzdHM6IFRlc3QuY291bnQsXG5cdCAgICAgIG1vZHVsZXM6IG1vZHVsZXNMb2dcblx0ICAgIH0pLnRoZW4odW5ibG9ja0FuZEFkdmFuY2VRdWV1ZSk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIHVuYmxvY2tBbmRBZHZhbmNlUXVldWUoKTtcblx0ICB9XG5cdH1cblx0ZXhwb3J0UVVuaXQoUVVuaXQpO1xuXG5cdChmdW5jdGlvbiAoKSB7XG5cdCAgaWYgKHR5cGVvZiB3aW5kb3ckMSA9PT0gXCJ1bmRlZmluZWRcIiB8fCB0eXBlb2YgZG9jdW1lbnQkMSA9PT0gXCJ1bmRlZmluZWRcIikge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHZhciBjb25maWcgPSBRVW5pdC5jb25maWcsXG5cdCAgICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7IC8vIFN0b3JlcyBmaXh0dXJlIEhUTUwgZm9yIHJlc2V0dGluZyBsYXRlclxuXG5cdCAgZnVuY3Rpb24gc3RvcmVGaXh0dXJlKCkge1xuXHQgICAgLy8gQXZvaWQgb3ZlcndyaXRpbmcgdXNlci1kZWZpbmVkIHZhbHVlc1xuXHQgICAgaWYgKGhhc093bi5jYWxsKGNvbmZpZywgXCJmaXh0dXJlXCIpKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgdmFyIGZpeHR1cmUgPSBkb2N1bWVudCQxLmdldEVsZW1lbnRCeUlkKFwicXVuaXQtZml4dHVyZVwiKTtcblxuXHQgICAgaWYgKGZpeHR1cmUpIHtcblx0ICAgICAgY29uZmlnLmZpeHR1cmUgPSBmaXh0dXJlLmNsb25lTm9kZSh0cnVlKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBRVW5pdC5iZWdpbihzdG9yZUZpeHR1cmUpOyAvLyBSZXNldHMgdGhlIGZpeHR1cmUgRE9NIGVsZW1lbnQgaWYgYXZhaWxhYmxlLlxuXG5cdCAgZnVuY3Rpb24gcmVzZXRGaXh0dXJlKCkge1xuXHQgICAgaWYgKGNvbmZpZy5maXh0dXJlID09IG51bGwpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgZml4dHVyZSA9IGRvY3VtZW50JDEuZ2V0RWxlbWVudEJ5SWQoXCJxdW5pdC1maXh0dXJlXCIpO1xuXG5cdCAgICB2YXIgcmVzZXRGaXh0dXJlVHlwZSA9IF90eXBlb2YoY29uZmlnLmZpeHR1cmUpO1xuXG5cdCAgICBpZiAocmVzZXRGaXh0dXJlVHlwZSA9PT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAvLyBzdXBwb3J0IHVzZXIgZGVmaW5lZCB2YWx1ZXMgZm9yIGBjb25maWcuZml4dHVyZWBcblx0ICAgICAgdmFyIG5ld0ZpeHR1cmUgPSBkb2N1bWVudCQxLmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG5cdCAgICAgIG5ld0ZpeHR1cmUuc2V0QXR0cmlidXRlKFwiaWRcIiwgXCJxdW5pdC1maXh0dXJlXCIpO1xuXHQgICAgICBuZXdGaXh0dXJlLmlubmVySFRNTCA9IGNvbmZpZy5maXh0dXJlO1xuXHQgICAgICBmaXh0dXJlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKG5ld0ZpeHR1cmUsIGZpeHR1cmUpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFyIGNsb25lZEZpeHR1cmUgPSBjb25maWcuZml4dHVyZS5jbG9uZU5vZGUodHJ1ZSk7XG5cdCAgICAgIGZpeHR1cmUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQoY2xvbmVkRml4dHVyZSwgZml4dHVyZSk7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgUVVuaXQudGVzdFN0YXJ0KHJlc2V0Rml4dHVyZSk7XG5cdH0pKCk7XG5cblx0KGZ1bmN0aW9uICgpIHtcblx0ICAvLyBPbmx5IGludGVyYWN0IHdpdGggVVJMcyB2aWEgd2luZG93LmxvY2F0aW9uXG5cdCAgdmFyIGxvY2F0aW9uID0gdHlwZW9mIHdpbmRvdyQxICE9PSBcInVuZGVmaW5lZFwiICYmIHdpbmRvdyQxLmxvY2F0aW9uO1xuXG5cdCAgaWYgKCFsb2NhdGlvbikge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHZhciB1cmxQYXJhbXMgPSBnZXRVcmxQYXJhbXMoKTtcblx0ICBRVW5pdC51cmxQYXJhbXMgPSB1cmxQYXJhbXM7IC8vIE1hdGNoIG1vZHVsZS90ZXN0IGJ5IGluY2x1c2lvbiBpbiBhbiBhcnJheVxuXG5cdCAgUVVuaXQuY29uZmlnLm1vZHVsZUlkID0gW10uY29uY2F0KHVybFBhcmFtcy5tb2R1bGVJZCB8fCBbXSk7XG5cdCAgUVVuaXQuY29uZmlnLnRlc3RJZCA9IFtdLmNvbmNhdCh1cmxQYXJhbXMudGVzdElkIHx8IFtdKTsgLy8gRXhhY3QgY2FzZS1pbnNlbnNpdGl2ZSBtYXRjaCBvZiB0aGUgbW9kdWxlIG5hbWVcblxuXHQgIFFVbml0LmNvbmZpZy5tb2R1bGUgPSB1cmxQYXJhbXMubW9kdWxlOyAvLyBSZWd1bGFyIGV4cHJlc3Npb24gb3IgY2FzZS1pbnNlbnN0aXZlIHN1YnN0cmluZyBtYXRjaCBhZ2FpbnN0IFwibW9kdWxlTmFtZTogdGVzdE5hbWVcIlxuXG5cdCAgUVVuaXQuY29uZmlnLmZpbHRlciA9IHVybFBhcmFtcy5maWx0ZXI7IC8vIFRlc3Qgb3JkZXIgcmFuZG9taXphdGlvblxuXG5cdCAgaWYgKHVybFBhcmFtcy5zZWVkID09PSB0cnVlKSB7XG5cdCAgICAvLyBHZW5lcmF0ZSBhIHJhbmRvbSBzZWVkIGlmIHRoZSBvcHRpb24gaXMgc3BlY2lmaWVkIHdpdGhvdXQgYSB2YWx1ZVxuXHQgICAgUVVuaXQuY29uZmlnLnNlZWQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zbGljZSgyKTtcblx0ICB9IGVsc2UgaWYgKHVybFBhcmFtcy5zZWVkKSB7XG5cdCAgICBRVW5pdC5jb25maWcuc2VlZCA9IHVybFBhcmFtcy5zZWVkO1xuXHQgIH0gLy8gQWRkIFVSTC1wYXJhbWV0ZXItbWFwcGVkIGNvbmZpZyB2YWx1ZXMgd2l0aCBVSSBmb3JtIHJlbmRlcmluZyBkYXRhXG5cblxuXHQgIFFVbml0LmNvbmZpZy51cmxDb25maWcucHVzaCh7XG5cdCAgICBpZDogXCJoaWRlcGFzc2VkXCIsXG5cdCAgICBsYWJlbDogXCJIaWRlIHBhc3NlZCB0ZXN0c1wiLFxuXHQgICAgdG9vbHRpcDogXCJPbmx5IHNob3cgdGVzdHMgYW5kIGFzc2VydGlvbnMgdGhhdCBmYWlsLiBTdG9yZWQgYXMgcXVlcnktc3RyaW5ncy5cIlxuXHQgIH0sIHtcblx0ICAgIGlkOiBcIm5vZ2xvYmFsc1wiLFxuXHQgICAgbGFiZWw6IFwiQ2hlY2sgZm9yIEdsb2JhbHNcIixcblx0ICAgIHRvb2x0aXA6IFwiRW5hYmxpbmcgdGhpcyB3aWxsIHRlc3QgaWYgYW55IHRlc3QgaW50cm9kdWNlcyBuZXcgcHJvcGVydGllcyBvbiB0aGUgXCIgKyBcImdsb2JhbCBvYmplY3QgKGB3aW5kb3dgIGluIEJyb3dzZXJzKS4gU3RvcmVkIGFzIHF1ZXJ5LXN0cmluZ3MuXCJcblx0ICB9LCB7XG5cdCAgICBpZDogXCJub3RyeWNhdGNoXCIsXG5cdCAgICBsYWJlbDogXCJObyB0cnktY2F0Y2hcIixcblx0ICAgIHRvb2x0aXA6IFwiRW5hYmxpbmcgdGhpcyB3aWxsIHJ1biB0ZXN0cyBvdXRzaWRlIG9mIGEgdHJ5LWNhdGNoIGJsb2NrLiBNYWtlcyBkZWJ1Z2dpbmcgXCIgKyBcImV4Y2VwdGlvbnMgaW4gSUUgcmVhc29uYWJsZS4gU3RvcmVkIGFzIHF1ZXJ5LXN0cmluZ3MuXCJcblx0ICB9KTtcblx0ICBRVW5pdC5iZWdpbihmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgaSxcblx0ICAgICAgICBvcHRpb24sXG5cdCAgICAgICAgdXJsQ29uZmlnID0gUVVuaXQuY29uZmlnLnVybENvbmZpZztcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IHVybENvbmZpZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAvLyBPcHRpb25zIGNhbiBiZSBlaXRoZXIgc3RyaW5ncyBvciBvYmplY3RzIHdpdGggbm9uZW1wdHkgXCJpZFwiIHByb3BlcnRpZXNcblx0ICAgICAgb3B0aW9uID0gUVVuaXQuY29uZmlnLnVybENvbmZpZ1tpXTtcblxuXHQgICAgICBpZiAodHlwZW9mIG9wdGlvbiAhPT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAgIG9wdGlvbiA9IG9wdGlvbi5pZDtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChRVW5pdC5jb25maWdbb3B0aW9uXSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgUVVuaXQuY29uZmlnW29wdGlvbl0gPSB1cmxQYXJhbXNbb3B0aW9uXTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0pO1xuXG5cdCAgZnVuY3Rpb24gZ2V0VXJsUGFyYW1zKCkge1xuXHQgICAgdmFyIGksIHBhcmFtLCBuYW1lLCB2YWx1ZTtcblx0ICAgIHZhciB1cmxQYXJhbXMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHQgICAgdmFyIHBhcmFtcyA9IGxvY2F0aW9uLnNlYXJjaC5zbGljZSgxKS5zcGxpdChcIiZcIik7XG5cdCAgICB2YXIgbGVuZ3RoID0gcGFyYW1zLmxlbmd0aDtcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIGlmIChwYXJhbXNbaV0pIHtcblx0ICAgICAgICBwYXJhbSA9IHBhcmFtc1tpXS5zcGxpdChcIj1cIik7XG5cdCAgICAgICAgbmFtZSA9IGRlY29kZVF1ZXJ5UGFyYW0ocGFyYW1bMF0pOyAvLyBBbGxvdyBqdXN0IGEga2V5IHRvIHR1cm4gb24gYSBmbGFnLCBlLmcuLCB0ZXN0Lmh0bWw/bm9nbG9iYWxzXG5cblx0ICAgICAgICB2YWx1ZSA9IHBhcmFtLmxlbmd0aCA9PT0gMSB8fCBkZWNvZGVRdWVyeVBhcmFtKHBhcmFtLnNsaWNlKDEpLmpvaW4oXCI9XCIpKTtcblxuXHQgICAgICAgIGlmIChuYW1lIGluIHVybFBhcmFtcykge1xuXHQgICAgICAgICAgdXJsUGFyYW1zW25hbWVdID0gW10uY29uY2F0KHVybFBhcmFtc1tuYW1lXSwgdmFsdWUpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB1cmxQYXJhbXNbbmFtZV0gPSB2YWx1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHVybFBhcmFtcztcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBkZWNvZGVRdWVyeVBhcmFtKHBhcmFtKSB7XG5cdCAgICByZXR1cm4gZGVjb2RlVVJJQ29tcG9uZW50KHBhcmFtLnJlcGxhY2UoL1xcKy9nLCBcIiUyMFwiKSk7XG5cdCAgfVxuXHR9KSgpO1xuXG5cdHZhciBmdXp6eXNvcnQgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlKSB7XG5cblx0ICAoZnVuY3Rpb24gKHJvb3QsIFVNRCkge1xuXHQgICAgaWYgKCBtb2R1bGUuZXhwb3J0cykgbW9kdWxlLmV4cG9ydHMgPSBVTUQoKTtlbHNlIHJvb3QuZnV6enlzb3J0ID0gVU1EKCk7XG5cdCAgfSkoY29tbW9uanNHbG9iYWwsIGZ1bmN0aW9uIFVNRCgpIHtcblx0ICAgIGZ1bmN0aW9uIGZ1enp5c29ydE5ldyhpbnN0YW5jZU9wdGlvbnMpIHtcblx0ICAgICAgdmFyIGZ1enp5c29ydCA9IHtcblx0ICAgICAgICBzaW5nbGU6IGZ1bmN0aW9uIChzZWFyY2gsIHRhcmdldCwgb3B0aW9ucykge1xuXHQgICAgICAgICAgaWYgKCFzZWFyY2gpIHJldHVybiBudWxsO1xuXHQgICAgICAgICAgaWYgKCFpc09iaihzZWFyY2gpKSBzZWFyY2ggPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWRTZWFyY2goc2VhcmNoKTtcblx0ICAgICAgICAgIGlmICghdGFyZ2V0KSByZXR1cm4gbnVsbDtcblx0ICAgICAgICAgIGlmICghaXNPYmoodGFyZ2V0KSkgdGFyZ2V0ID0gZnV6enlzb3J0LmdldFByZXBhcmVkKHRhcmdldCk7XG5cdCAgICAgICAgICB2YXIgYWxsb3dUeXBvID0gb3B0aW9ucyAmJiBvcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5hbGxvd1R5cG8gOiBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyA6IHRydWU7XG5cdCAgICAgICAgICB2YXIgYWxnb3JpdGhtID0gYWxsb3dUeXBvID8gZnV6enlzb3J0LmFsZ29yaXRobSA6IGZ1enp5c29ydC5hbGdvcml0aG1Ob1R5cG87XG5cdCAgICAgICAgICByZXR1cm4gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hbMF0pOyAvLyB2YXIgdGhyZXNob2xkID0gb3B0aW9ucyAmJiBvcHRpb25zLnRocmVzaG9sZCB8fCBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLnRocmVzaG9sZCB8fCAtOTAwNzE5OTI1NDc0MDk5MVxuXHQgICAgICAgICAgLy8gdmFyIHJlc3VsdCA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoWzBdKVxuXHQgICAgICAgICAgLy8gaWYocmVzdWx0ID09PSBudWxsKSByZXR1cm4gbnVsbFxuXHQgICAgICAgICAgLy8gaWYocmVzdWx0LnNjb3JlIDwgdGhyZXNob2xkKSByZXR1cm4gbnVsbFxuXHQgICAgICAgICAgLy8gcmV0dXJuIHJlc3VsdFxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZ286IGZ1bmN0aW9uIChzZWFyY2gsIHRhcmdldHMsIG9wdGlvbnMpIHtcblx0ICAgICAgICAgIGlmICghc2VhcmNoKSByZXR1cm4gbm9SZXN1bHRzO1xuXHQgICAgICAgICAgc2VhcmNoID0gZnV6enlzb3J0LnByZXBhcmVTZWFyY2goc2VhcmNoKTtcblx0ICAgICAgICAgIHZhciBzZWFyY2hMb3dlckNvZGUgPSBzZWFyY2hbMF07XG5cdCAgICAgICAgICB2YXIgdGhyZXNob2xkID0gb3B0aW9ucyAmJiBvcHRpb25zLnRocmVzaG9sZCB8fCBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLnRocmVzaG9sZCB8fCAtOTAwNzE5OTI1NDc0MDk5MTtcblx0ICAgICAgICAgIHZhciBsaW1pdCA9IG9wdGlvbnMgJiYgb3B0aW9ucy5saW1pdCB8fCBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLmxpbWl0IHx8IDkwMDcxOTkyNTQ3NDA5OTE7XG5cdCAgICAgICAgICB2YXIgYWxsb3dUeXBvID0gb3B0aW9ucyAmJiBvcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5hbGxvd1R5cG8gOiBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyA6IHRydWU7XG5cdCAgICAgICAgICB2YXIgYWxnb3JpdGhtID0gYWxsb3dUeXBvID8gZnV6enlzb3J0LmFsZ29yaXRobSA6IGZ1enp5c29ydC5hbGdvcml0aG1Ob1R5cG87XG5cdCAgICAgICAgICB2YXIgcmVzdWx0c0xlbiA9IDA7XG5cdCAgICAgICAgICB2YXIgbGltaXRlZENvdW50ID0gMDtcblx0ICAgICAgICAgIHZhciB0YXJnZXRzTGVuID0gdGFyZ2V0cy5sZW5ndGg7IC8vIFRoaXMgY29kZSBpcyBjb3B5L3Bhc3RlZCAzIHRpbWVzIGZvciBwZXJmb3JtYW5jZSByZWFzb25zIFtvcHRpb25zLmtleXMsIG9wdGlvbnMua2V5LCBubyBrZXlzXVxuXHQgICAgICAgICAgLy8gb3B0aW9ucy5rZXlzXG5cblx0ICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMua2V5cykge1xuXHQgICAgICAgICAgICB2YXIgc2NvcmVGbiA9IG9wdGlvbnMuc2NvcmVGbiB8fCBkZWZhdWx0U2NvcmVGbjtcblx0ICAgICAgICAgICAgdmFyIGtleXMgPSBvcHRpb25zLmtleXM7XG5cdCAgICAgICAgICAgIHZhciBrZXlzTGVuID0ga2V5cy5sZW5ndGg7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRhcmdldHNMZW4gLSAxOyBpID49IDA7IC0taSkge1xuXHQgICAgICAgICAgICAgIHZhciBvYmogPSB0YXJnZXRzW2ldO1xuXHQgICAgICAgICAgICAgIHZhciBvYmpSZXN1bHRzID0gbmV3IEFycmF5KGtleXNMZW4pO1xuXG5cdCAgICAgICAgICAgICAgZm9yICh2YXIga2V5SSA9IGtleXNMZW4gLSAxOyBrZXlJID49IDA7IC0ta2V5SSkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNba2V5SV07XG5cdCAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gZ2V0VmFsdWUob2JqLCBrZXkpO1xuXG5cdCAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkge1xuXHQgICAgICAgICAgICAgICAgICBvYmpSZXN1bHRzW2tleUldID0gbnVsbDtcblx0ICAgICAgICAgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIGlmICghaXNPYmoodGFyZ2V0KSkgdGFyZ2V0ID0gZnV6enlzb3J0LmdldFByZXBhcmVkKHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgICBvYmpSZXN1bHRzW2tleUldID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hMb3dlckNvZGUpO1xuXHQgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgIG9ialJlc3VsdHMub2JqID0gb2JqOyAvLyBiZWZvcmUgc2NvcmVGbiBzbyBzY29yZUZuIGNhbiB1c2UgaXRcblxuXHQgICAgICAgICAgICAgIHZhciBzY29yZSA9IHNjb3JlRm4ob2JqUmVzdWx0cyk7XG5cdCAgICAgICAgICAgICAgaWYgKHNjb3JlID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICBpZiAoc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIG9ialJlc3VsdHMuc2NvcmUgPSBzY29yZTtcblxuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuIDwgbGltaXQpIHtcblx0ICAgICAgICAgICAgICAgIHEuYWRkKG9ialJlc3VsdHMpO1xuXHQgICAgICAgICAgICAgICAgKytyZXN1bHRzTGVuO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICArK2xpbWl0ZWRDb3VudDtcblx0ICAgICAgICAgICAgICAgIGlmIChzY29yZSA+IHEucGVlaygpLnNjb3JlKSBxLnJlcGxhY2VUb3Aob2JqUmVzdWx0cyk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9IC8vIG9wdGlvbnMua2V5XG5cblx0ICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmtleSkge1xuXHQgICAgICAgICAgICB2YXIga2V5ID0gb3B0aW9ucy5rZXk7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IHRhcmdldHNMZW4gLSAxOyBpID49IDA7IC0taSkge1xuXHQgICAgICAgICAgICAgIHZhciBvYmogPSB0YXJnZXRzW2ldO1xuXHQgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBnZXRWYWx1ZShvYmosIGtleSk7XG5cdCAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIGlmICghaXNPYmoodGFyZ2V0KSkgdGFyZ2V0ID0gZnV6enlzb3J0LmdldFByZXBhcmVkKHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoTG93ZXJDb2RlKTtcblx0ICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjb3JlIDwgdGhyZXNob2xkKSBjb250aW51ZTsgLy8gaGF2ZSB0byBjbG9uZSByZXN1bHQgc28gZHVwbGljYXRlIHRhcmdldHMgZnJvbSBkaWZmZXJlbnQgb2JqIGNhbiBlYWNoIHJlZmVyZW5jZSB0aGUgY29ycmVjdCBvYmpcblxuXHQgICAgICAgICAgICAgIHJlc3VsdCA9IHtcblx0ICAgICAgICAgICAgICAgIHRhcmdldDogcmVzdWx0LnRhcmdldCxcblx0ICAgICAgICAgICAgICAgIF90YXJnZXRMb3dlckNvZGVzOiBudWxsLFxuXHQgICAgICAgICAgICAgICAgX25leHRCZWdpbm5pbmdJbmRleGVzOiBudWxsLFxuXHQgICAgICAgICAgICAgICAgc2NvcmU6IHJlc3VsdC5zY29yZSxcblx0ICAgICAgICAgICAgICAgIGluZGV4ZXM6IHJlc3VsdC5pbmRleGVzLFxuXHQgICAgICAgICAgICAgICAgb2JqOiBvYmpcblx0ICAgICAgICAgICAgICB9OyAvLyBoaWRkZW5cblxuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuIDwgbGltaXQpIHtcblx0ICAgICAgICAgICAgICAgIHEuYWRkKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICArK3Jlc3VsdHNMZW47XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICsrbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zY29yZSA+IHEucGVlaygpLnNjb3JlKSBxLnJlcGxhY2VUb3AocmVzdWx0KTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gLy8gbm8ga2V5c1xuXG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gdGFyZ2V0c0xlbiAtIDE7IGkgPj0gMDsgLS1pKSB7XG5cdCAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IHRhcmdldHNbaV07XG5cdCAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIGlmICghaXNPYmoodGFyZ2V0KSkgdGFyZ2V0ID0gZnV6enlzb3J0LmdldFByZXBhcmVkKHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoTG93ZXJDb2RlKTtcblx0ICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjb3JlIDwgdGhyZXNob2xkKSBjb250aW51ZTtcblxuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuIDwgbGltaXQpIHtcblx0ICAgICAgICAgICAgICAgIHEuYWRkKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICArK3Jlc3VsdHNMZW47XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICsrbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zY29yZSA+IHEucGVlaygpLnNjb3JlKSBxLnJlcGxhY2VUb3AocmVzdWx0KTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPT09IDApIHJldHVybiBub1Jlc3VsdHM7XG5cdCAgICAgICAgICB2YXIgcmVzdWx0cyA9IG5ldyBBcnJheShyZXN1bHRzTGVuKTtcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IHJlc3VsdHNMZW4gLSAxOyBpID49IDA7IC0taSkgcmVzdWx0c1tpXSA9IHEucG9sbCgpO1xuXG5cdCAgICAgICAgICByZXN1bHRzLnRvdGFsID0gcmVzdWx0c0xlbiArIGxpbWl0ZWRDb3VudDtcblx0ICAgICAgICAgIHJldHVybiByZXN1bHRzO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZ29Bc3luYzogZnVuY3Rpb24gKHNlYXJjaCwgdGFyZ2V0cywgb3B0aW9ucykge1xuXHQgICAgICAgICAgdmFyIGNhbmNlbGVkID0gZmFsc2U7XG5cdCAgICAgICAgICB2YXIgcCA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgICAgaWYgKCFzZWFyY2gpIHJldHVybiByZXNvbHZlKG5vUmVzdWx0cyk7XG5cdCAgICAgICAgICAgIHNlYXJjaCA9IGZ1enp5c29ydC5wcmVwYXJlU2VhcmNoKHNlYXJjaCk7XG5cdCAgICAgICAgICAgIHZhciBzZWFyY2hMb3dlckNvZGUgPSBzZWFyY2hbMF07XG5cdCAgICAgICAgICAgIHZhciBxID0gZmFzdHByaW9yaXR5cXVldWUoKTtcblx0ICAgICAgICAgICAgdmFyIGlDdXJyZW50ID0gdGFyZ2V0cy5sZW5ndGggLSAxO1xuXHQgICAgICAgICAgICB2YXIgdGhyZXNob2xkID0gb3B0aW9ucyAmJiBvcHRpb25zLnRocmVzaG9sZCB8fCBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLnRocmVzaG9sZCB8fCAtOTAwNzE5OTI1NDc0MDk5MTtcblx0ICAgICAgICAgICAgdmFyIGxpbWl0ID0gb3B0aW9ucyAmJiBvcHRpb25zLmxpbWl0IHx8IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMubGltaXQgfHwgOTAwNzE5OTI1NDc0MDk5MTtcblx0ICAgICAgICAgICAgdmFyIGFsbG93VHlwbyA9IG9wdGlvbnMgJiYgb3B0aW9ucy5hbGxvd1R5cG8gIT09IHVuZGVmaW5lZCA/IG9wdGlvbnMuYWxsb3dUeXBvIDogaW5zdGFuY2VPcHRpb25zICYmIGluc3RhbmNlT3B0aW9ucy5hbGxvd1R5cG8gIT09IHVuZGVmaW5lZCA/IGluc3RhbmNlT3B0aW9ucy5hbGxvd1R5cG8gOiB0cnVlO1xuXHQgICAgICAgICAgICB2YXIgYWxnb3JpdGhtID0gYWxsb3dUeXBvID8gZnV6enlzb3J0LmFsZ29yaXRobSA6IGZ1enp5c29ydC5hbGdvcml0aG1Ob1R5cG87XG5cdCAgICAgICAgICAgIHZhciByZXN1bHRzTGVuID0gMDtcblx0ICAgICAgICAgICAgdmFyIGxpbWl0ZWRDb3VudCA9IDA7XG5cblx0ICAgICAgICAgICAgZnVuY3Rpb24gc3RlcCgpIHtcblx0ICAgICAgICAgICAgICBpZiAoY2FuY2VsZWQpIHJldHVybiByZWplY3QoJ2NhbmNlbGVkJyk7XG5cdCAgICAgICAgICAgICAgdmFyIHN0YXJ0TXMgPSBEYXRlLm5vdygpOyAvLyBUaGlzIGNvZGUgaXMgY29weS9wYXN0ZWQgMyB0aW1lcyBmb3IgcGVyZm9ybWFuY2UgcmVhc29ucyBbb3B0aW9ucy5rZXlzLCBvcHRpb25zLmtleSwgbm8ga2V5c11cblx0ICAgICAgICAgICAgICAvLyBvcHRpb25zLmtleXNcblxuXHQgICAgICAgICAgICAgIGlmIChvcHRpb25zICYmIG9wdGlvbnMua2V5cykge1xuXHQgICAgICAgICAgICAgICAgdmFyIHNjb3JlRm4gPSBvcHRpb25zLnNjb3JlRm4gfHwgZGVmYXVsdFNjb3JlRm47XG5cdCAgICAgICAgICAgICAgICB2YXIga2V5cyA9IG9wdGlvbnMua2V5cztcblx0ICAgICAgICAgICAgICAgIHZhciBrZXlzTGVuID0ga2V5cy5sZW5ndGg7XG5cblx0ICAgICAgICAgICAgICAgIGZvciAoOyBpQ3VycmVudCA+PSAwOyAtLWlDdXJyZW50KSB7XG5cdCAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB0YXJnZXRzW2lDdXJyZW50XTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIG9ialJlc3VsdHMgPSBuZXcgQXJyYXkoa2V5c0xlbik7XG5cblx0ICAgICAgICAgICAgICAgICAgZm9yICh2YXIga2V5SSA9IGtleXNMZW4gLSAxOyBrZXlJID49IDA7IC0ta2V5SSkge1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzW2tleUldO1xuXHQgICAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBnZXRWYWx1ZShvYmosIGtleSk7XG5cblx0ICAgICAgICAgICAgICAgICAgICBpZiAoIXRhcmdldCkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgb2JqUmVzdWx0c1trZXlJXSA9IG51bGw7XG5cdCAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgICAgICBpZiAoIWlzT2JqKHRhcmdldCkpIHRhcmdldCA9IGZ1enp5c29ydC5nZXRQcmVwYXJlZCh0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICAgIG9ialJlc3VsdHNba2V5SV0gPSBhbGdvcml0aG0oc2VhcmNoLCB0YXJnZXQsIHNlYXJjaExvd2VyQ29kZSk7XG5cdCAgICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgICBvYmpSZXN1bHRzLm9iaiA9IG9iajsgLy8gYmVmb3JlIHNjb3JlRm4gc28gc2NvcmVGbiBjYW4gdXNlIGl0XG5cblx0ICAgICAgICAgICAgICAgICAgdmFyIHNjb3JlID0gc2NvcmVGbihvYmpSZXN1bHRzKTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHNjb3JlID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHNjb3JlIDwgdGhyZXNob2xkKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgb2JqUmVzdWx0cy5zY29yZSA9IHNjb3JlO1xuXG5cdCAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuIDwgbGltaXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICBxLmFkZChvYmpSZXN1bHRzKTtcblx0ICAgICAgICAgICAgICAgICAgICArK3Jlc3VsdHNMZW47XG5cdCAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgKytsaW1pdGVkQ291bnQ7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3JlID4gcS5wZWVrKCkuc2NvcmUpIHEucmVwbGFjZVRvcChvYmpSZXN1bHRzKTtcblx0ICAgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICAgIGlmIChpQ3VycmVudCAlIDEwMDBcblx0ICAgICAgICAgICAgICAgICAgLyppdGVtc1BlckNoZWNrKi9cblx0ICAgICAgICAgICAgICAgICAgPT09IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0TXMgPj0gMTBcblx0ICAgICAgICAgICAgICAgICAgICAvKmFzeW5jSW50ZXJ2YWwqL1xuXHQgICAgICAgICAgICAgICAgICAgICkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpc05vZGUgPyBzZXRJbW1lZGlhdGUoc3RlcCkgOiBzZXRUaW1lb3V0KHN0ZXApO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH0gLy8gb3B0aW9ucy5rZXlcblxuXHQgICAgICAgICAgICAgIH0gZWxzZSBpZiAob3B0aW9ucyAmJiBvcHRpb25zLmtleSkge1xuXHQgICAgICAgICAgICAgICAgdmFyIGtleSA9IG9wdGlvbnMua2V5O1xuXG5cdCAgICAgICAgICAgICAgICBmb3IgKDsgaUN1cnJlbnQgPj0gMDsgLS1pQ3VycmVudCkge1xuXHQgICAgICAgICAgICAgICAgICB2YXIgb2JqID0gdGFyZ2V0c1tpQ3VycmVudF07XG5cdCAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBnZXRWYWx1ZShvYmosIGtleSk7XG5cdCAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoTG93ZXJDb2RlKTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkgY29udGludWU7XG5cdCAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlOyAvLyBoYXZlIHRvIGNsb25lIHJlc3VsdCBzbyBkdXBsaWNhdGUgdGFyZ2V0cyBmcm9tIGRpZmZlcmVudCBvYmogY2FuIGVhY2ggcmVmZXJlbmNlIHRoZSBjb3JyZWN0IG9ialxuXG5cdCAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHtcblx0ICAgICAgICAgICAgICAgICAgICB0YXJnZXQ6IHJlc3VsdC50YXJnZXQsXG5cdCAgICAgICAgICAgICAgICAgICAgX3RhcmdldExvd2VyQ29kZXM6IG51bGwsXG5cdCAgICAgICAgICAgICAgICAgICAgX25leHRCZWdpbm5pbmdJbmRleGVzOiBudWxsLFxuXHQgICAgICAgICAgICAgICAgICAgIHNjb3JlOiByZXN1bHQuc2NvcmUsXG5cdCAgICAgICAgICAgICAgICAgICAgaW5kZXhlczogcmVzdWx0LmluZGV4ZXMsXG5cdCAgICAgICAgICAgICAgICAgICAgb2JqOiBvYmpcblx0ICAgICAgICAgICAgICAgICAgfTsgLy8gaGlkZGVuXG5cblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHEuYWRkKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICAgICAgKytyZXN1bHRzTGVuO1xuXHQgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICsrbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPiBxLnBlZWsoKS5zY29yZSkgcS5yZXBsYWNlVG9wKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgICBpZiAoaUN1cnJlbnQgJSAxMDAwXG5cdCAgICAgICAgICAgICAgICAgIC8qaXRlbXNQZXJDaGVjayovXG5cdCAgICAgICAgICAgICAgICAgID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydE1zID49IDEwXG5cdCAgICAgICAgICAgICAgICAgICAgLyphc3luY0ludGVydmFsKi9cblx0ICAgICAgICAgICAgICAgICAgICApIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaXNOb2RlID8gc2V0SW1tZWRpYXRlKHN0ZXApIDogc2V0VGltZW91dChzdGVwKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9IC8vIG5vIGtleXNcblxuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICBmb3IgKDsgaUN1cnJlbnQgPj0gMDsgLS1pQ3VycmVudCkge1xuXHQgICAgICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGFyZ2V0c1tpQ3VycmVudF07XG5cdCAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoTG93ZXJDb2RlKTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkgY29udGludWU7XG5cdCAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlO1xuXG5cdCAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuIDwgbGltaXQpIHtcblx0ICAgICAgICAgICAgICAgICAgICBxLmFkZChyZXN1bHQpO1xuXHQgICAgICAgICAgICAgICAgICAgICsrcmVzdWx0c0xlbjtcblx0ICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICArK2xpbWl0ZWRDb3VudDtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjb3JlID4gcS5wZWVrKCkuc2NvcmUpIHEucmVwbGFjZVRvcChyZXN1bHQpO1xuXHQgICAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgICAgaWYgKGlDdXJyZW50ICUgMTAwMFxuXHQgICAgICAgICAgICAgICAgICAvKml0ZW1zUGVyQ2hlY2sqL1xuXHQgICAgICAgICAgICAgICAgICA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc3RhcnRNcyA+PSAxMFxuXHQgICAgICAgICAgICAgICAgICAgIC8qYXN5bmNJbnRlcnZhbCovXG5cdCAgICAgICAgICAgICAgICAgICAgKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlzTm9kZSA/IHNldEltbWVkaWF0ZShzdGVwKSA6IHNldFRpbWVvdXQoc3RlcCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHRzTGVuID09PSAwKSByZXR1cm4gcmVzb2x2ZShub1Jlc3VsdHMpO1xuXHQgICAgICAgICAgICAgIHZhciByZXN1bHRzID0gbmV3IEFycmF5KHJlc3VsdHNMZW4pO1xuXG5cdCAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IHJlc3VsdHNMZW4gLSAxOyBpID49IDA7IC0taSkgcmVzdWx0c1tpXSA9IHEucG9sbCgpO1xuXG5cdCAgICAgICAgICAgICAgcmVzdWx0cy50b3RhbCA9IHJlc3VsdHNMZW4gKyBsaW1pdGVkQ291bnQ7XG5cdCAgICAgICAgICAgICAgcmVzb2x2ZShyZXN1bHRzKTtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIGlzTm9kZSA/IHNldEltbWVkaWF0ZShzdGVwKSA6IHN0ZXAoKTtcblx0ICAgICAgICAgIH0pO1xuXG5cdCAgICAgICAgICBwLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgY2FuY2VsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgfTtcblxuXHQgICAgICAgICAgcmV0dXJuIHA7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBoaWdobGlnaHQ6IGZ1bmN0aW9uIChyZXN1bHQsIGhPcGVuLCBoQ2xvc2UpIHtcblx0ICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwpIHJldHVybiBudWxsO1xuXHQgICAgICAgICAgaWYgKGhPcGVuID09PSB1bmRlZmluZWQpIGhPcGVuID0gJzxiPic7XG5cdCAgICAgICAgICBpZiAoaENsb3NlID09PSB1bmRlZmluZWQpIGhDbG9zZSA9ICc8L2I+Jztcblx0ICAgICAgICAgIHZhciBoaWdobGlnaHRlZCA9ICcnO1xuXHQgICAgICAgICAgdmFyIG1hdGNoZXNJbmRleCA9IDA7XG5cdCAgICAgICAgICB2YXIgb3BlbmVkID0gZmFsc2U7XG5cdCAgICAgICAgICB2YXIgdGFyZ2V0ID0gcmVzdWx0LnRhcmdldDtcblx0ICAgICAgICAgIHZhciB0YXJnZXRMZW4gPSB0YXJnZXQubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0ID0gcmVzdWx0LmluZGV4ZXM7XG5cblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0TGVuOyArK2kpIHtcblx0ICAgICAgICAgICAgdmFyIGNoYXIgPSB0YXJnZXRbaV07XG5cblx0ICAgICAgICAgICAgaWYgKG1hdGNoZXNCZXN0W21hdGNoZXNJbmRleF0gPT09IGkpIHtcblx0ICAgICAgICAgICAgICArK21hdGNoZXNJbmRleDtcblxuXHQgICAgICAgICAgICAgIGlmICghb3BlbmVkKSB7XG5cdCAgICAgICAgICAgICAgICBvcGVuZWQgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgaGlnaGxpZ2h0ZWQgKz0gaE9wZW47XG5cdCAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgaWYgKG1hdGNoZXNJbmRleCA9PT0gbWF0Y2hlc0Jlc3QubGVuZ3RoKSB7XG5cdCAgICAgICAgICAgICAgICBoaWdobGlnaHRlZCArPSBjaGFyICsgaENsb3NlICsgdGFyZ2V0LnN1YnN0cihpICsgMSk7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgaWYgKG9wZW5lZCkge1xuXHQgICAgICAgICAgICAgICAgb3BlbmVkID0gZmFsc2U7XG5cdCAgICAgICAgICAgICAgICBoaWdobGlnaHRlZCArPSBoQ2xvc2U7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgaGlnaGxpZ2h0ZWQgKz0gY2hhcjtcblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgcmV0dXJuIGhpZ2hsaWdodGVkO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgcHJlcGFyZTogZnVuY3Rpb24gKHRhcmdldCkge1xuXHQgICAgICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjtcblx0ICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuXHQgICAgICAgICAgICBfdGFyZ2V0TG93ZXJDb2RlczogZnV6enlzb3J0LnByZXBhcmVMb3dlckNvZGVzKHRhcmdldCksXG5cdCAgICAgICAgICAgIF9uZXh0QmVnaW5uaW5nSW5kZXhlczogbnVsbCxcblx0ICAgICAgICAgICAgc2NvcmU6IG51bGwsXG5cdCAgICAgICAgICAgIGluZGV4ZXM6IG51bGwsXG5cdCAgICAgICAgICAgIG9iajogbnVsbFxuXHQgICAgICAgICAgfTsgLy8gaGlkZGVuXG5cdCAgICAgICAgfSxcblx0ICAgICAgICBwcmVwYXJlU2xvdzogZnVuY3Rpb24gKHRhcmdldCkge1xuXHQgICAgICAgICAgaWYgKCF0YXJnZXQpIHJldHVybjtcblx0ICAgICAgICAgIHJldHVybiB7XG5cdCAgICAgICAgICAgIHRhcmdldDogdGFyZ2V0LFxuXHQgICAgICAgICAgICBfdGFyZ2V0TG93ZXJDb2RlczogZnV6enlzb3J0LnByZXBhcmVMb3dlckNvZGVzKHRhcmdldCksXG5cdCAgICAgICAgICAgIF9uZXh0QmVnaW5uaW5nSW5kZXhlczogZnV6enlzb3J0LnByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlcyh0YXJnZXQpLFxuXHQgICAgICAgICAgICBzY29yZTogbnVsbCxcblx0ICAgICAgICAgICAgaW5kZXhlczogbnVsbCxcblx0ICAgICAgICAgICAgb2JqOiBudWxsXG5cdCAgICAgICAgICB9OyAvLyBoaWRkZW5cblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByZXBhcmVTZWFyY2g6IGZ1bmN0aW9uIChzZWFyY2gpIHtcblx0ICAgICAgICAgIGlmICghc2VhcmNoKSByZXR1cm47XG5cdCAgICAgICAgICByZXR1cm4gZnV6enlzb3J0LnByZXBhcmVMb3dlckNvZGVzKHNlYXJjaCk7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICAvLyBCZWxvdyB0aGlzIHBvaW50IGlzIG9ubHkgaW50ZXJuYWwgY29kZVxuXHQgICAgICAgIC8vIEJlbG93IHRoaXMgcG9pbnQgaXMgb25seSBpbnRlcm5hbCBjb2RlXG5cdCAgICAgICAgLy8gQmVsb3cgdGhpcyBwb2ludCBpcyBvbmx5IGludGVybmFsIGNvZGVcblx0ICAgICAgICAvLyBCZWxvdyB0aGlzIHBvaW50IGlzIG9ubHkgaW50ZXJuYWwgY29kZVxuXHQgICAgICAgIGdldFByZXBhcmVkOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cdCAgICAgICAgICBpZiAodGFyZ2V0Lmxlbmd0aCA+IDk5OSkgcmV0dXJuIGZ1enp5c29ydC5wcmVwYXJlKHRhcmdldCk7IC8vIGRvbid0IGNhY2hlIGh1Z2UgdGFyZ2V0c1xuXG5cdCAgICAgICAgICB2YXIgdGFyZ2V0UHJlcGFyZWQgPSBwcmVwYXJlZENhY2hlLmdldCh0YXJnZXQpO1xuXHQgICAgICAgICAgaWYgKHRhcmdldFByZXBhcmVkICE9PSB1bmRlZmluZWQpIHJldHVybiB0YXJnZXRQcmVwYXJlZDtcblx0ICAgICAgICAgIHRhcmdldFByZXBhcmVkID0gZnV6enlzb3J0LnByZXBhcmUodGFyZ2V0KTtcblx0ICAgICAgICAgIHByZXBhcmVkQ2FjaGUuc2V0KHRhcmdldCwgdGFyZ2V0UHJlcGFyZWQpO1xuXHQgICAgICAgICAgcmV0dXJuIHRhcmdldFByZXBhcmVkO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgZ2V0UHJlcGFyZWRTZWFyY2g6IGZ1bmN0aW9uIChzZWFyY2gpIHtcblx0ICAgICAgICAgIGlmIChzZWFyY2gubGVuZ3RoID4gOTk5KSByZXR1cm4gZnV6enlzb3J0LnByZXBhcmVTZWFyY2goc2VhcmNoKTsgLy8gZG9uJ3QgY2FjaGUgaHVnZSBzZWFyY2hlc1xuXG5cdCAgICAgICAgICB2YXIgc2VhcmNoUHJlcGFyZWQgPSBwcmVwYXJlZFNlYXJjaENhY2hlLmdldChzZWFyY2gpO1xuXHQgICAgICAgICAgaWYgKHNlYXJjaFByZXBhcmVkICE9PSB1bmRlZmluZWQpIHJldHVybiBzZWFyY2hQcmVwYXJlZDtcblx0ICAgICAgICAgIHNlYXJjaFByZXBhcmVkID0gZnV6enlzb3J0LnByZXBhcmVTZWFyY2goc2VhcmNoKTtcblx0ICAgICAgICAgIHByZXBhcmVkU2VhcmNoQ2FjaGUuc2V0KHNlYXJjaCwgc2VhcmNoUHJlcGFyZWQpO1xuXHQgICAgICAgICAgcmV0dXJuIHNlYXJjaFByZXBhcmVkO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgYWxnb3JpdGhtOiBmdW5jdGlvbiAoc2VhcmNoTG93ZXJDb2RlcywgcHJlcGFyZWQsIHNlYXJjaExvd2VyQ29kZSkge1xuXHQgICAgICAgICAgdmFyIHRhcmdldExvd2VyQ29kZXMgPSBwcmVwYXJlZC5fdGFyZ2V0TG93ZXJDb2Rlcztcblx0ICAgICAgICAgIHZhciBzZWFyY2hMZW4gPSBzZWFyY2hMb3dlckNvZGVzLmxlbmd0aDtcblx0ICAgICAgICAgIHZhciB0YXJnZXRMZW4gPSB0YXJnZXRMb3dlckNvZGVzLmxlbmd0aDtcblx0ICAgICAgICAgIHZhciBzZWFyY2hJID0gMDsgLy8gd2hlcmUgd2UgYXRcblxuXHQgICAgICAgICAgdmFyIHRhcmdldEkgPSAwOyAvLyB3aGVyZSB5b3UgYXRcblxuXHQgICAgICAgICAgdmFyIHR5cG9TaW1wbGVJID0gMDtcblx0ICAgICAgICAgIHZhciBtYXRjaGVzU2ltcGxlTGVuID0gMDsgLy8gdmVyeSBiYXNpYyBmdXp6eSBtYXRjaDsgdG8gcmVtb3ZlIG5vbi1tYXRjaGluZyB0YXJnZXRzIEFTQVAhXG5cdCAgICAgICAgICAvLyB3YWxrIHRocm91Z2ggdGFyZ2V0LiBmaW5kIHNlcXVlbnRpYWwgbWF0Y2hlcy5cblx0ICAgICAgICAgIC8vIGlmIGFsbCBjaGFycyBhcmVuJ3QgZm91bmQgdGhlbiBleGl0XG5cblx0ICAgICAgICAgIGZvciAoOzspIHtcblx0ICAgICAgICAgICAgdmFyIGlzTWF0Y2ggPSBzZWFyY2hMb3dlckNvZGUgPT09IHRhcmdldExvd2VyQ29kZXNbdGFyZ2V0SV07XG5cblx0ICAgICAgICAgICAgaWYgKGlzTWF0Y2gpIHtcblx0ICAgICAgICAgICAgICBtYXRjaGVzU2ltcGxlW21hdGNoZXNTaW1wbGVMZW4rK10gPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICAgICsrc2VhcmNoSTtcblx0ICAgICAgICAgICAgICBpZiAoc2VhcmNoSSA9PT0gc2VhcmNoTGVuKSBicmVhaztcblx0ICAgICAgICAgICAgICBzZWFyY2hMb3dlckNvZGUgPSBzZWFyY2hMb3dlckNvZGVzW3R5cG9TaW1wbGVJID09PSAwID8gc2VhcmNoSSA6IHR5cG9TaW1wbGVJID09PSBzZWFyY2hJID8gc2VhcmNoSSArIDEgOiB0eXBvU2ltcGxlSSA9PT0gc2VhcmNoSSAtIDEgPyBzZWFyY2hJIC0gMSA6IHNlYXJjaEldO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgKyt0YXJnZXRJO1xuXG5cdCAgICAgICAgICAgIGlmICh0YXJnZXRJID49IHRhcmdldExlbikge1xuXHQgICAgICAgICAgICAgIC8vIEZhaWxlZCB0byBmaW5kIHNlYXJjaElcblx0ICAgICAgICAgICAgICAvLyBDaGVjayBmb3IgdHlwbyBvciBleGl0XG5cdCAgICAgICAgICAgICAgLy8gd2UgZ28gYXMgZmFyIGFzIHBvc3NpYmxlIGJlZm9yZSB0cnlpbmcgdG8gdHJhbnNwb3NlXG5cdCAgICAgICAgICAgICAgLy8gdGhlbiB3ZSB0cmFuc3Bvc2UgYmFja3dhcmRzIHVudGlsIHdlIHJlYWNoIHRoZSBiZWdpbm5pbmdcblx0ICAgICAgICAgICAgICBmb3IgKDs7KSB7XG5cdCAgICAgICAgICAgICAgICBpZiAoc2VhcmNoSSA8PSAxKSByZXR1cm4gbnVsbDsgLy8gbm90IGFsbG93ZWQgdG8gdHJhbnNwb3NlIGZpcnN0IGNoYXJcblxuXHQgICAgICAgICAgICAgICAgaWYgKHR5cG9TaW1wbGVJID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgIC8vIHdlIGhhdmVuJ3QgdHJpZWQgdG8gdHJhbnNwb3NlIHlldFxuXHQgICAgICAgICAgICAgICAgICAtLXNlYXJjaEk7XG5cdCAgICAgICAgICAgICAgICAgIHZhciBzZWFyY2hMb3dlckNvZGVOZXcgPSBzZWFyY2hMb3dlckNvZGVzW3NlYXJjaEldO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoc2VhcmNoTG93ZXJDb2RlID09PSBzZWFyY2hMb3dlckNvZGVOZXcpIGNvbnRpbnVlOyAvLyBkb2Vzbid0IG1ha2Ugc2Vuc2UgdG8gdHJhbnNwb3NlIGEgcmVwZWF0IGNoYXJcblxuXHQgICAgICAgICAgICAgICAgICB0eXBvU2ltcGxlSSA9IHNlYXJjaEk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICBpZiAodHlwb1NpbXBsZUkgPT09IDEpIHJldHVybiBudWxsOyAvLyByZWFjaGVkIHRoZSBlbmQgb2YgdGhlIGxpbmUgZm9yIHRyYW5zcG9zaW5nXG5cblx0ICAgICAgICAgICAgICAgICAgLS10eXBvU2ltcGxlSTtcblx0ICAgICAgICAgICAgICAgICAgc2VhcmNoSSA9IHR5cG9TaW1wbGVJO1xuXHQgICAgICAgICAgICAgICAgICBzZWFyY2hMb3dlckNvZGUgPSBzZWFyY2hMb3dlckNvZGVzW3NlYXJjaEkgKyAxXTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaExvd2VyQ29kZU5ldyA9IHNlYXJjaExvd2VyQ29kZXNbc2VhcmNoSV07XG5cdCAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hMb3dlckNvZGUgPT09IHNlYXJjaExvd2VyQ29kZU5ldykgY29udGludWU7IC8vIGRvZXNuJ3QgbWFrZSBzZW5zZSB0byB0cmFuc3Bvc2UgYSByZXBlYXQgY2hhclxuXHQgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICBtYXRjaGVzU2ltcGxlTGVuID0gc2VhcmNoSTtcblx0ICAgICAgICAgICAgICAgIHRhcmdldEkgPSBtYXRjaGVzU2ltcGxlW21hdGNoZXNTaW1wbGVMZW4gLSAxXSArIDE7XG5cdCAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgdmFyIHNlYXJjaEkgPSAwO1xuXHQgICAgICAgICAgdmFyIHR5cG9TdHJpY3RJID0gMDtcblx0ICAgICAgICAgIHZhciBzdWNjZXNzU3RyaWN0ID0gZmFsc2U7XG5cdCAgICAgICAgICB2YXIgbWF0Y2hlc1N0cmljdExlbiA9IDA7XG5cdCAgICAgICAgICB2YXIgbmV4dEJlZ2lubmluZ0luZGV4ZXMgPSBwcmVwYXJlZC5fbmV4dEJlZ2lubmluZ0luZGV4ZXM7XG5cdCAgICAgICAgICBpZiAobmV4dEJlZ2lubmluZ0luZGV4ZXMgPT09IG51bGwpIG5leHRCZWdpbm5pbmdJbmRleGVzID0gcHJlcGFyZWQuX25leHRCZWdpbm5pbmdJbmRleGVzID0gZnV6enlzb3J0LnByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlcyhwcmVwYXJlZC50YXJnZXQpO1xuXHQgICAgICAgICAgdmFyIGZpcnN0UG9zc2libGVJID0gdGFyZ2V0SSA9IG1hdGNoZXNTaW1wbGVbMF0gPT09IDAgPyAwIDogbmV4dEJlZ2lubmluZ0luZGV4ZXNbbWF0Y2hlc1NpbXBsZVswXSAtIDFdOyAvLyBPdXIgdGFyZ2V0IHN0cmluZyBzdWNjZXNzZnVsbHkgbWF0Y2hlZCBhbGwgY2hhcmFjdGVycyBpbiBzZXF1ZW5jZSFcblx0ICAgICAgICAgIC8vIExldCdzIHRyeSBhIG1vcmUgYWR2YW5jZWQgYW5kIHN0cmljdCB0ZXN0IHRvIGltcHJvdmUgdGhlIHNjb3JlXG5cdCAgICAgICAgICAvLyBvbmx5IGNvdW50IGl0IGFzIGEgbWF0Y2ggaWYgaXQncyBjb25zZWN1dGl2ZSBvciBhIGJlZ2lubmluZyBjaGFyYWN0ZXIhXG5cblx0ICAgICAgICAgIGlmICh0YXJnZXRJICE9PSB0YXJnZXRMZW4pIGZvciAoOzspIHtcblx0ICAgICAgICAgICAgaWYgKHRhcmdldEkgPj0gdGFyZ2V0TGVuKSB7XG5cdCAgICAgICAgICAgICAgLy8gV2UgZmFpbGVkIHRvIGZpbmQgYSBnb29kIHNwb3QgZm9yIHRoaXMgc2VhcmNoIGNoYXIsIGdvIGJhY2sgdG8gdGhlIHByZXZpb3VzIHNlYXJjaCBjaGFyIGFuZCBmb3JjZSBpdCBmb3J3YXJkXG5cdCAgICAgICAgICAgICAgaWYgKHNlYXJjaEkgPD0gMCkge1xuXHQgICAgICAgICAgICAgICAgLy8gV2UgZmFpbGVkIHRvIHB1c2ggY2hhcnMgZm9yd2FyZCBmb3IgYSBiZXR0ZXIgbWF0Y2hcblx0ICAgICAgICAgICAgICAgIC8vIHRyYW5zcG9zZSwgc3RhcnRpbmcgZnJvbSB0aGUgYmVnaW5uaW5nXG5cdCAgICAgICAgICAgICAgICArK3R5cG9TdHJpY3RJO1xuXHQgICAgICAgICAgICAgICAgaWYgKHR5cG9TdHJpY3RJID4gc2VhcmNoTGVuIC0gMikgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICBpZiAoc2VhcmNoTG93ZXJDb2Rlc1t0eXBvU3RyaWN0SV0gPT09IHNlYXJjaExvd2VyQ29kZXNbdHlwb1N0cmljdEkgKyAxXSkgY29udGludWU7IC8vIGRvZXNuJ3QgbWFrZSBzZW5zZSB0byB0cmFuc3Bvc2UgYSByZXBlYXQgY2hhclxuXG5cdCAgICAgICAgICAgICAgICB0YXJnZXRJID0gZmlyc3RQb3NzaWJsZUk7XG5cdCAgICAgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAtLXNlYXJjaEk7XG5cdCAgICAgICAgICAgICAgdmFyIGxhc3RNYXRjaCA9IG1hdGNoZXNTdHJpY3RbLS1tYXRjaGVzU3RyaWN0TGVuXTtcblx0ICAgICAgICAgICAgICB0YXJnZXRJID0gbmV4dEJlZ2lubmluZ0luZGV4ZXNbbGFzdE1hdGNoXTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICB2YXIgaXNNYXRjaCA9IHNlYXJjaExvd2VyQ29kZXNbdHlwb1N0cmljdEkgPT09IDAgPyBzZWFyY2hJIDogdHlwb1N0cmljdEkgPT09IHNlYXJjaEkgPyBzZWFyY2hJICsgMSA6IHR5cG9TdHJpY3RJID09PSBzZWFyY2hJIC0gMSA/IHNlYXJjaEkgLSAxIDogc2VhcmNoSV0gPT09IHRhcmdldExvd2VyQ29kZXNbdGFyZ2V0SV07XG5cblx0ICAgICAgICAgICAgICBpZiAoaXNNYXRjaCkge1xuXHQgICAgICAgICAgICAgICAgbWF0Y2hlc1N0cmljdFttYXRjaGVzU3RyaWN0TGVuKytdID0gdGFyZ2V0STtcblx0ICAgICAgICAgICAgICAgICsrc2VhcmNoSTtcblxuXHQgICAgICAgICAgICAgICAgaWYgKHNlYXJjaEkgPT09IHNlYXJjaExlbikge1xuXHQgICAgICAgICAgICAgICAgICBzdWNjZXNzU3RyaWN0ID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgICsrdGFyZ2V0STtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGFyZ2V0SSA9IG5leHRCZWdpbm5pbmdJbmRleGVzW3RhcmdldEldO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAge1xuXHQgICAgICAgICAgICAvLyB0YWxseSB1cCB0aGUgc2NvcmUgJiBrZWVwIHRyYWNrIG9mIG1hdGNoZXMgZm9yIGhpZ2hsaWdodGluZyBsYXRlclxuXHQgICAgICAgICAgICBpZiAoc3VjY2Vzc1N0cmljdCkge1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdCA9IG1hdGNoZXNTdHJpY3Q7XG5cdCAgICAgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0TGVuID0gbWF0Y2hlc1N0cmljdExlbjtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3QgPSBtYXRjaGVzU2ltcGxlO1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdExlbiA9IG1hdGNoZXNTaW1wbGVMZW47XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICB2YXIgc2NvcmUgPSAwO1xuXHQgICAgICAgICAgICB2YXIgbGFzdFRhcmdldEkgPSAtMTtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXJjaExlbjsgKytpKSB7XG5cdCAgICAgICAgICAgICAgdmFyIHRhcmdldEkgPSBtYXRjaGVzQmVzdFtpXTsgLy8gc2NvcmUgb25seSBnb2VzIGRvd24gaWYgdGhleSdyZSBub3QgY29uc2VjdXRpdmVcblxuXHQgICAgICAgICAgICAgIGlmIChsYXN0VGFyZ2V0SSAhPT0gdGFyZ2V0SSAtIDEpIHNjb3JlIC09IHRhcmdldEk7XG5cdCAgICAgICAgICAgICAgbGFzdFRhcmdldEkgPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgaWYgKCFzdWNjZXNzU3RyaWN0KSB7XG5cdCAgICAgICAgICAgICAgc2NvcmUgKj0gMTAwMDtcblx0ICAgICAgICAgICAgICBpZiAodHlwb1NpbXBsZUkgIT09IDApIHNjb3JlICs9IC0yMDtcblx0ICAgICAgICAgICAgICAvKnR5cG9QZW5hbHR5Ki9cblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBpZiAodHlwb1N0cmljdEkgIT09IDApIHNjb3JlICs9IC0yMDtcblx0ICAgICAgICAgICAgICAvKnR5cG9QZW5hbHR5Ki9cblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIHNjb3JlIC09IHRhcmdldExlbiAtIHNlYXJjaExlbjtcblx0ICAgICAgICAgICAgcHJlcGFyZWQuc2NvcmUgPSBzY29yZTtcblx0ICAgICAgICAgICAgcHJlcGFyZWQuaW5kZXhlcyA9IG5ldyBBcnJheShtYXRjaGVzQmVzdExlbik7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IG1hdGNoZXNCZXN0TGVuIC0gMTsgaSA+PSAwOyAtLWkpIHByZXBhcmVkLmluZGV4ZXNbaV0gPSBtYXRjaGVzQmVzdFtpXTtcblxuXHQgICAgICAgICAgICByZXR1cm4gcHJlcGFyZWQ7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBhbGdvcml0aG1Ob1R5cG86IGZ1bmN0aW9uIChzZWFyY2hMb3dlckNvZGVzLCBwcmVwYXJlZCwgc2VhcmNoTG93ZXJDb2RlKSB7XG5cdCAgICAgICAgICB2YXIgdGFyZ2V0TG93ZXJDb2RlcyA9IHByZXBhcmVkLl90YXJnZXRMb3dlckNvZGVzO1xuXHQgICAgICAgICAgdmFyIHNlYXJjaExlbiA9IHNlYXJjaExvd2VyQ29kZXMubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIHRhcmdldExlbiA9IHRhcmdldExvd2VyQ29kZXMubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIHNlYXJjaEkgPSAwOyAvLyB3aGVyZSB3ZSBhdFxuXG5cdCAgICAgICAgICB2YXIgdGFyZ2V0SSA9IDA7IC8vIHdoZXJlIHlvdSBhdFxuXG5cdCAgICAgICAgICB2YXIgbWF0Y2hlc1NpbXBsZUxlbiA9IDA7IC8vIHZlcnkgYmFzaWMgZnV6enkgbWF0Y2g7IHRvIHJlbW92ZSBub24tbWF0Y2hpbmcgdGFyZ2V0cyBBU0FQIVxuXHQgICAgICAgICAgLy8gd2FsayB0aHJvdWdoIHRhcmdldC4gZmluZCBzZXF1ZW50aWFsIG1hdGNoZXMuXG5cdCAgICAgICAgICAvLyBpZiBhbGwgY2hhcnMgYXJlbid0IGZvdW5kIHRoZW4gZXhpdFxuXG5cdCAgICAgICAgICBmb3IgKDs7KSB7XG5cdCAgICAgICAgICAgIHZhciBpc01hdGNoID0gc2VhcmNoTG93ZXJDb2RlID09PSB0YXJnZXRMb3dlckNvZGVzW3RhcmdldEldO1xuXG5cdCAgICAgICAgICAgIGlmIChpc01hdGNoKSB7XG5cdCAgICAgICAgICAgICAgbWF0Y2hlc1NpbXBsZVttYXRjaGVzU2ltcGxlTGVuKytdID0gdGFyZ2V0STtcblx0ICAgICAgICAgICAgICArK3NlYXJjaEk7XG5cdCAgICAgICAgICAgICAgaWYgKHNlYXJjaEkgPT09IHNlYXJjaExlbikgYnJlYWs7XG5cdCAgICAgICAgICAgICAgc2VhcmNoTG93ZXJDb2RlID0gc2VhcmNoTG93ZXJDb2Rlc1tzZWFyY2hJXTtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICsrdGFyZ2V0STtcblx0ICAgICAgICAgICAgaWYgKHRhcmdldEkgPj0gdGFyZ2V0TGVuKSByZXR1cm4gbnVsbDsgLy8gRmFpbGVkIHRvIGZpbmQgc2VhcmNoSVxuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICB2YXIgc2VhcmNoSSA9IDA7XG5cdCAgICAgICAgICB2YXIgc3VjY2Vzc1N0cmljdCA9IGZhbHNlO1xuXHQgICAgICAgICAgdmFyIG1hdGNoZXNTdHJpY3RMZW4gPSAwO1xuXHQgICAgICAgICAgdmFyIG5leHRCZWdpbm5pbmdJbmRleGVzID0gcHJlcGFyZWQuX25leHRCZWdpbm5pbmdJbmRleGVzO1xuXHQgICAgICAgICAgaWYgKG5leHRCZWdpbm5pbmdJbmRleGVzID09PSBudWxsKSBuZXh0QmVnaW5uaW5nSW5kZXhlcyA9IHByZXBhcmVkLl9uZXh0QmVnaW5uaW5nSW5kZXhlcyA9IGZ1enp5c29ydC5wcmVwYXJlTmV4dEJlZ2lubmluZ0luZGV4ZXMocHJlcGFyZWQudGFyZ2V0KTtcblx0ICAgICAgICAgIHZhciBmaXJzdFBvc3NpYmxlSSA9IHRhcmdldEkgPSBtYXRjaGVzU2ltcGxlWzBdID09PSAwID8gMCA6IG5leHRCZWdpbm5pbmdJbmRleGVzW21hdGNoZXNTaW1wbGVbMF0gLSAxXTsgLy8gT3VyIHRhcmdldCBzdHJpbmcgc3VjY2Vzc2Z1bGx5IG1hdGNoZWQgYWxsIGNoYXJhY3RlcnMgaW4gc2VxdWVuY2UhXG5cdCAgICAgICAgICAvLyBMZXQncyB0cnkgYSBtb3JlIGFkdmFuY2VkIGFuZCBzdHJpY3QgdGVzdCB0byBpbXByb3ZlIHRoZSBzY29yZVxuXHQgICAgICAgICAgLy8gb25seSBjb3VudCBpdCBhcyBhIG1hdGNoIGlmIGl0J3MgY29uc2VjdXRpdmUgb3IgYSBiZWdpbm5pbmcgY2hhcmFjdGVyIVxuXG5cdCAgICAgICAgICBpZiAodGFyZ2V0SSAhPT0gdGFyZ2V0TGVuKSBmb3IgKDs7KSB7XG5cdCAgICAgICAgICAgIGlmICh0YXJnZXRJID49IHRhcmdldExlbikge1xuXHQgICAgICAgICAgICAgIC8vIFdlIGZhaWxlZCB0byBmaW5kIGEgZ29vZCBzcG90IGZvciB0aGlzIHNlYXJjaCBjaGFyLCBnbyBiYWNrIHRvIHRoZSBwcmV2aW91cyBzZWFyY2ggY2hhciBhbmQgZm9yY2UgaXQgZm9yd2FyZFxuXHQgICAgICAgICAgICAgIGlmIChzZWFyY2hJIDw9IDApIGJyZWFrOyAvLyBXZSBmYWlsZWQgdG8gcHVzaCBjaGFycyBmb3J3YXJkIGZvciBhIGJldHRlciBtYXRjaFxuXG5cdCAgICAgICAgICAgICAgLS1zZWFyY2hJO1xuXHQgICAgICAgICAgICAgIHZhciBsYXN0TWF0Y2ggPSBtYXRjaGVzU3RyaWN0Wy0tbWF0Y2hlc1N0cmljdExlbl07XG5cdCAgICAgICAgICAgICAgdGFyZ2V0SSA9IG5leHRCZWdpbm5pbmdJbmRleGVzW2xhc3RNYXRjaF07XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgdmFyIGlzTWF0Y2ggPSBzZWFyY2hMb3dlckNvZGVzW3NlYXJjaEldID09PSB0YXJnZXRMb3dlckNvZGVzW3RhcmdldEldO1xuXG5cdCAgICAgICAgICAgICAgaWYgKGlzTWF0Y2gpIHtcblx0ICAgICAgICAgICAgICAgIG1hdGNoZXNTdHJpY3RbbWF0Y2hlc1N0cmljdExlbisrXSA9IHRhcmdldEk7XG5cdCAgICAgICAgICAgICAgICArK3NlYXJjaEk7XG5cblx0ICAgICAgICAgICAgICAgIGlmIChzZWFyY2hJID09PSBzZWFyY2hMZW4pIHtcblx0ICAgICAgICAgICAgICAgICAgc3VjY2Vzc1N0cmljdCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICArK3RhcmdldEk7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHRhcmdldEkgPSBuZXh0QmVnaW5uaW5nSW5kZXhlc1t0YXJnZXRJXTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIHtcblx0ICAgICAgICAgICAgLy8gdGFsbHkgdXAgdGhlIHNjb3JlICYga2VlcCB0cmFjayBvZiBtYXRjaGVzIGZvciBoaWdobGlnaHRpbmcgbGF0ZXJcblx0ICAgICAgICAgICAgaWYgKHN1Y2Nlc3NTdHJpY3QpIHtcblx0ICAgICAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3QgPSBtYXRjaGVzU3RyaWN0O1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdExlbiA9IG1hdGNoZXNTdHJpY3RMZW47XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0ID0gbWF0Y2hlc1NpbXBsZTtcblx0ICAgICAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3RMZW4gPSBtYXRjaGVzU2ltcGxlTGVuO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgdmFyIHNjb3JlID0gMDtcblx0ICAgICAgICAgICAgdmFyIGxhc3RUYXJnZXRJID0gLTE7XG5cblx0ICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWFyY2hMZW47ICsraSkge1xuXHQgICAgICAgICAgICAgIHZhciB0YXJnZXRJID0gbWF0Y2hlc0Jlc3RbaV07IC8vIHNjb3JlIG9ubHkgZ29lcyBkb3duIGlmIHRoZXkncmUgbm90IGNvbnNlY3V0aXZlXG5cblx0ICAgICAgICAgICAgICBpZiAobGFzdFRhcmdldEkgIT09IHRhcmdldEkgLSAxKSBzY29yZSAtPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICAgIGxhc3RUYXJnZXRJID0gdGFyZ2V0STtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIGlmICghc3VjY2Vzc1N0cmljdCkgc2NvcmUgKj0gMTAwMDtcblx0ICAgICAgICAgICAgc2NvcmUgLT0gdGFyZ2V0TGVuIC0gc2VhcmNoTGVuO1xuXHQgICAgICAgICAgICBwcmVwYXJlZC5zY29yZSA9IHNjb3JlO1xuXHQgICAgICAgICAgICBwcmVwYXJlZC5pbmRleGVzID0gbmV3IEFycmF5KG1hdGNoZXNCZXN0TGVuKTtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gbWF0Y2hlc0Jlc3RMZW4gLSAxOyBpID49IDA7IC0taSkgcHJlcGFyZWQuaW5kZXhlc1tpXSA9IG1hdGNoZXNCZXN0W2ldO1xuXG5cdCAgICAgICAgICAgIHJldHVybiBwcmVwYXJlZDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByZXBhcmVMb3dlckNvZGVzOiBmdW5jdGlvbiAoc3RyKSB7XG5cdCAgICAgICAgICB2YXIgc3RyTGVuID0gc3RyLmxlbmd0aDtcblx0ICAgICAgICAgIHZhciBsb3dlckNvZGVzID0gW107IC8vIG5ldyBBcnJheShzdHJMZW4pICAgIHNwYXJzZSBhcnJheSBpcyB0b28gc2xvd1xuXG5cdCAgICAgICAgICB2YXIgbG93ZXIgPSBzdHIudG9Mb3dlckNhc2UoKTtcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzdHJMZW47ICsraSkgbG93ZXJDb2Rlc1tpXSA9IGxvd2VyLmNoYXJDb2RlQXQoaSk7XG5cblx0ICAgICAgICAgIHJldHVybiBsb3dlckNvZGVzO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgcHJlcGFyZUJlZ2lubmluZ0luZGV4ZXM6IGZ1bmN0aW9uICh0YXJnZXQpIHtcblx0ICAgICAgICAgIHZhciB0YXJnZXRMZW4gPSB0YXJnZXQubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIGJlZ2lubmluZ0luZGV4ZXMgPSBbXTtcblx0ICAgICAgICAgIHZhciBiZWdpbm5pbmdJbmRleGVzTGVuID0gMDtcblx0ICAgICAgICAgIHZhciB3YXNVcHBlciA9IGZhbHNlO1xuXHQgICAgICAgICAgdmFyIHdhc0FscGhhbnVtID0gZmFsc2U7XG5cblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0TGVuOyArK2kpIHtcblx0ICAgICAgICAgICAgdmFyIHRhcmdldENvZGUgPSB0YXJnZXQuY2hhckNvZGVBdChpKTtcblx0ICAgICAgICAgICAgdmFyIGlzVXBwZXIgPSB0YXJnZXRDb2RlID49IDY1ICYmIHRhcmdldENvZGUgPD0gOTA7XG5cdCAgICAgICAgICAgIHZhciBpc0FscGhhbnVtID0gaXNVcHBlciB8fCB0YXJnZXRDb2RlID49IDk3ICYmIHRhcmdldENvZGUgPD0gMTIyIHx8IHRhcmdldENvZGUgPj0gNDggJiYgdGFyZ2V0Q29kZSA8PSA1Nztcblx0ICAgICAgICAgICAgdmFyIGlzQmVnaW5uaW5nID0gaXNVcHBlciAmJiAhd2FzVXBwZXIgfHwgIXdhc0FscGhhbnVtIHx8ICFpc0FscGhhbnVtO1xuXHQgICAgICAgICAgICB3YXNVcHBlciA9IGlzVXBwZXI7XG5cdCAgICAgICAgICAgIHdhc0FscGhhbnVtID0gaXNBbHBoYW51bTtcblx0ICAgICAgICAgICAgaWYgKGlzQmVnaW5uaW5nKSBiZWdpbm5pbmdJbmRleGVzW2JlZ2lubmluZ0luZGV4ZXNMZW4rK10gPSBpO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICByZXR1cm4gYmVnaW5uaW5nSW5kZXhlcztcblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlczogZnVuY3Rpb24gKHRhcmdldCkge1xuXHQgICAgICAgICAgdmFyIHRhcmdldExlbiA9IHRhcmdldC5sZW5ndGg7XG5cdCAgICAgICAgICB2YXIgYmVnaW5uaW5nSW5kZXhlcyA9IGZ1enp5c29ydC5wcmVwYXJlQmVnaW5uaW5nSW5kZXhlcyh0YXJnZXQpO1xuXHQgICAgICAgICAgdmFyIG5leHRCZWdpbm5pbmdJbmRleGVzID0gW107IC8vIG5ldyBBcnJheSh0YXJnZXRMZW4pICAgICBzcGFyc2UgYXJyYXkgaXMgdG9vIHNsb3dcblxuXHQgICAgICAgICAgdmFyIGxhc3RJc0JlZ2lubmluZyA9IGJlZ2lubmluZ0luZGV4ZXNbMF07XG5cdCAgICAgICAgICB2YXIgbGFzdElzQmVnaW5uaW5nSSA9IDA7XG5cblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGFyZ2V0TGVuOyArK2kpIHtcblx0ICAgICAgICAgICAgaWYgKGxhc3RJc0JlZ2lubmluZyA+IGkpIHtcblx0ICAgICAgICAgICAgICBuZXh0QmVnaW5uaW5nSW5kZXhlc1tpXSA9IGxhc3RJc0JlZ2lubmluZztcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBsYXN0SXNCZWdpbm5pbmcgPSBiZWdpbm5pbmdJbmRleGVzWysrbGFzdElzQmVnaW5uaW5nSV07XG5cdCAgICAgICAgICAgICAgbmV4dEJlZ2lubmluZ0luZGV4ZXNbaV0gPSBsYXN0SXNCZWdpbm5pbmcgPT09IHVuZGVmaW5lZCA/IHRhcmdldExlbiA6IGxhc3RJc0JlZ2lubmluZztcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICByZXR1cm4gbmV4dEJlZ2lubmluZ0luZGV4ZXM7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBjbGVhbnVwOiBjbGVhbnVwLFxuXHQgICAgICAgIG5ldzogZnV6enlzb3J0TmV3XG5cdCAgICAgIH07XG5cdCAgICAgIHJldHVybiBmdXp6eXNvcnQ7XG5cdCAgICB9IC8vIGZ1enp5c29ydE5ld1xuXHQgICAgLy8gVGhpcyBzdHVmZiBpcyBvdXRzaWRlIGZ1enp5c29ydE5ldywgYmVjYXVzZSBpdCdzIHNoYXJlZCB3aXRoIGluc3RhbmNlcyBvZiBmdXp6eXNvcnQubmV3KClcblxuXG5cdCAgICB2YXIgaXNOb2RlID0gdHlwZW9mIGNvbW1vbmpzUmVxdWlyZSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIHdpbmRvdyA9PT0gJ3VuZGVmaW5lZCc7IC8vIHZhciBNQVhfSU5UID0gTnVtYmVyLk1BWF9TQUZFX0lOVEVHRVJcblx0ICAgIC8vIHZhciBNSU5fSU5UID0gTnVtYmVyLk1JTl9WQUxVRVxuXG5cdCAgICB2YXIgcHJlcGFyZWRDYWNoZSA9IG5ldyBNYXAoKTtcblx0ICAgIHZhciBwcmVwYXJlZFNlYXJjaENhY2hlID0gbmV3IE1hcCgpO1xuXHQgICAgdmFyIG5vUmVzdWx0cyA9IFtdO1xuXHQgICAgbm9SZXN1bHRzLnRvdGFsID0gMDtcblx0ICAgIHZhciBtYXRjaGVzU2ltcGxlID0gW107XG5cdCAgICB2YXIgbWF0Y2hlc1N0cmljdCA9IFtdO1xuXG5cdCAgICBmdW5jdGlvbiBjbGVhbnVwKCkge1xuXHQgICAgICBwcmVwYXJlZENhY2hlLmNsZWFyKCk7XG5cdCAgICAgIHByZXBhcmVkU2VhcmNoQ2FjaGUuY2xlYXIoKTtcblx0ICAgICAgbWF0Y2hlc1NpbXBsZSA9IFtdO1xuXHQgICAgICBtYXRjaGVzU3RyaWN0ID0gW107XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGRlZmF1bHRTY29yZUZuKGEpIHtcblx0ICAgICAgdmFyIG1heCA9IC05MDA3MTk5MjU0NzQwOTkxO1xuXG5cdCAgICAgIGZvciAodmFyIGkgPSBhLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pKSB7XG5cdCAgICAgICAgdmFyIHJlc3VsdCA9IGFbaV07XG5cdCAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkgY29udGludWU7XG5cdCAgICAgICAgdmFyIHNjb3JlID0gcmVzdWx0LnNjb3JlO1xuXHQgICAgICAgIGlmIChzY29yZSA+IG1heCkgbWF4ID0gc2NvcmU7XG5cdCAgICAgIH1cblxuXHQgICAgICBpZiAobWF4ID09PSAtOTAwNzE5OTI1NDc0MDk5MSkgcmV0dXJuIG51bGw7XG5cdCAgICAgIHJldHVybiBtYXg7XG5cdCAgICB9IC8vIHByb3AgPSAna2V5JyAgICAgICAgICAgICAgMi41bXMgb3B0aW1pemVkIGZvciB0aGlzIGNhc2UsIHNlZW1zIHRvIGJlIGFib3V0IGFzIGZhc3QgYXMgZGlyZWN0IG9ialtwcm9wXVxuXHQgICAgLy8gcHJvcCA9ICdrZXkxLmtleTInICAgICAgICAxMG1zXG5cdCAgICAvLyBwcm9wID0gWydrZXkxJywgJ2tleTInXSAgIDI3bXNcblxuXG5cdCAgICBmdW5jdGlvbiBnZXRWYWx1ZShvYmosIHByb3ApIHtcblx0ICAgICAgdmFyIHRtcCA9IG9ialtwcm9wXTtcblx0ICAgICAgaWYgKHRtcCAhPT0gdW5kZWZpbmVkKSByZXR1cm4gdG1wO1xuXHQgICAgICB2YXIgc2VncyA9IHByb3A7XG5cdCAgICAgIGlmICghQXJyYXkuaXNBcnJheShwcm9wKSkgc2VncyA9IHByb3Auc3BsaXQoJy4nKTtcblx0ICAgICAgdmFyIGxlbiA9IHNlZ3MubGVuZ3RoO1xuXHQgICAgICB2YXIgaSA9IC0xO1xuXG5cdCAgICAgIHdoaWxlIChvYmogJiYgKytpIDwgbGVuKSBvYmogPSBvYmpbc2Vnc1tpXV07XG5cblx0ICAgICAgcmV0dXJuIG9iajtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gaXNPYmooeCkge1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdvYmplY3QnO1xuXHQgICAgfSAvLyBmYXN0ZXIgYXMgYSBmdW5jdGlvblxuXHQgICAgLy8gSGFja2VkIHZlcnNpb24gb2YgaHR0cHM6Ly9naXRodWIuY29tL2xlbWlyZS9GYXN0UHJpb3JpdHlRdWV1ZS5qc1xuXG5cblx0ICAgIHZhciBmYXN0cHJpb3JpdHlxdWV1ZSA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHIgPSBbXSxcblx0ICAgICAgICAgIG8gPSAwLFxuXHQgICAgICAgICAgZSA9IHt9O1xuXG5cdCAgICAgIGZ1bmN0aW9uIG4oKSB7XG5cdCAgICAgICAgZm9yICh2YXIgZSA9IDAsIG4gPSByW2VdLCBjID0gMTsgYyA8IG87KSB7XG5cdCAgICAgICAgICB2YXIgZiA9IGMgKyAxO1xuXHQgICAgICAgICAgZSA9IGMsIGYgPCBvICYmIHJbZl0uc2NvcmUgPCByW2NdLnNjb3JlICYmIChlID0gZiksIHJbZSAtIDEgPj4gMV0gPSByW2VdLCBjID0gMSArIChlIDw8IDEpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGZvciAodmFyIGEgPSBlIC0gMSA+PiAxOyBlID4gMCAmJiBuLnNjb3JlIDwgclthXS5zY29yZTsgYSA9IChlID0gYSkgLSAxID4+IDEpIHJbZV0gPSByW2FdO1xuXG5cdCAgICAgICAgcltlXSA9IG47XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gZS5hZGQgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIHZhciBuID0gbztcblx0ICAgICAgICByW28rK10gPSBlO1xuXG5cdCAgICAgICAgZm9yICh2YXIgYyA9IG4gLSAxID4+IDE7IG4gPiAwICYmIGUuc2NvcmUgPCByW2NdLnNjb3JlOyBjID0gKG4gPSBjKSAtIDEgPj4gMSkgcltuXSA9IHJbY107XG5cblx0ICAgICAgICByW25dID0gZTtcblx0ICAgICAgfSwgZS5wb2xsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICgwICE9PSBvKSB7XG5cdCAgICAgICAgICB2YXIgZSA9IHJbMF07XG5cdCAgICAgICAgICByZXR1cm4gclswXSA9IHJbLS1vXSwgbigpLCBlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSwgZS5wZWVrID0gZnVuY3Rpb24gKGUpIHtcblx0ICAgICAgICBpZiAoMCAhPT0gbykgcmV0dXJuIHJbMF07XG5cdCAgICAgIH0sIGUucmVwbGFjZVRvcCA9IGZ1bmN0aW9uIChvKSB7XG5cdCAgICAgICAgclswXSA9IG8sIG4oKTtcblx0ICAgICAgfSwgZTtcblx0ICAgIH07XG5cblx0ICAgIHZhciBxID0gZmFzdHByaW9yaXR5cXVldWUoKTsgLy8gcmV1c2UgdGhpcywgZXhjZXB0IGZvciBhc3luYywgaXQgbmVlZHMgdG8gbWFrZSBpdHMgb3duXG5cblx0ICAgIHJldHVybiBmdXp6eXNvcnROZXcoKTtcblx0ICB9KTsgLy8gVU1EXG5cdCAgLy8gVE9ETzogKHBlcmZvcm1hbmNlKSB3YXNtIHZlcnNpb24hP1xuXHQgIC8vIFRPRE86IChwZXJmb3JtYW5jZSkgbGF5b3V0IG1lbW9yeSBpbiBhbiBvcHRpbWFsIHdheSB0byBnbyBmYXN0IGJ5IGF2b2lkaW5nIGNhY2hlIG1pc3Nlc1xuXHQgIC8vIFRPRE86IChwZXJmb3JtYW5jZSkgcHJlcGFyZWRDYWNoZSBpcyBhIG1lbW9yeSBsZWFrXG5cdCAgLy8gVE9ETzogKGxpa2Ugc3VibGltZSkgYmFja3NsYXNoID09PSBmb3J3YXJkc2xhc2hcblx0ICAvLyBUT0RPOiAocGVyZm9ybWFuY2UpIGkgaGF2ZSBubyBpZGVhIGhvdyB3ZWxsIG9wdGl6bWllZCB0aGUgYWxsb3dpbmcgdHlwb3MgYWxnb3JpdGhtIGlzXG5cblx0fSk7XG5cblx0dmFyIHN0YXRzID0ge1xuXHQgIHBhc3NlZFRlc3RzOiAwLFxuXHQgIGZhaWxlZFRlc3RzOiAwLFxuXHQgIHNraXBwZWRUZXN0czogMCxcblx0ICB0b2RvVGVzdHM6IDBcblx0fTsgLy8gRXNjYXBlIHRleHQgZm9yIGF0dHJpYnV0ZSBvciB0ZXh0IGNvbnRlbnQuXG5cblx0ZnVuY3Rpb24gZXNjYXBlVGV4dChzKSB7XG5cdCAgaWYgKCFzKSB7XG5cdCAgICByZXR1cm4gXCJcIjtcblx0ICB9XG5cblx0ICBzID0gcyArIFwiXCI7IC8vIEJvdGggc2luZ2xlIHF1b3RlcyBhbmQgZG91YmxlIHF1b3RlcyAoZm9yIGF0dHJpYnV0ZXMpXG5cblx0ICByZXR1cm4gcy5yZXBsYWNlKC9bJ1wiPD4mXS9nLCBmdW5jdGlvbiAocykge1xuXHQgICAgc3dpdGNoIChzKSB7XG5cdCAgICAgIGNhc2UgXCInXCI6XG5cdCAgICAgICAgcmV0dXJuIFwiJiMwMzk7XCI7XG5cblx0ICAgICAgY2FzZSBcIlxcXCJcIjpcblx0ICAgICAgICByZXR1cm4gXCImcXVvdDtcIjtcblxuXHQgICAgICBjYXNlIFwiPFwiOlxuXHQgICAgICAgIHJldHVybiBcIiZsdDtcIjtcblxuXHQgICAgICBjYXNlIFwiPlwiOlxuXHQgICAgICAgIHJldHVybiBcIiZndDtcIjtcblxuXHQgICAgICBjYXNlIFwiJlwiOlxuXHQgICAgICAgIHJldHVybiBcIiZhbXA7XCI7XG5cdCAgICB9XG5cdCAgfSk7XG5cdH1cblxuXHQoZnVuY3Rpb24gKCkge1xuXHQgIC8vIERvbid0IGxvYWQgdGhlIEhUTUwgUmVwb3J0ZXIgb24gbm9uLWJyb3dzZXIgZW52aXJvbm1lbnRzXG5cdCAgaWYgKHR5cGVvZiB3aW5kb3ckMSA9PT0gXCJ1bmRlZmluZWRcIiB8fCAhd2luZG93JDEuZG9jdW1lbnQpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICB2YXIgY29uZmlnID0gUVVuaXQuY29uZmlnLFxuXHQgICAgICBoaWRkZW5UZXN0cyA9IFtdLFxuXHQgICAgICBkb2N1bWVudCA9IHdpbmRvdyQxLmRvY3VtZW50LFxuXHQgICAgICBjb2xsYXBzZU5leHQgPSBmYWxzZSxcblx0ICAgICAgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eSxcblx0ICAgICAgdW5maWx0ZXJlZFVybCA9IHNldFVybCh7XG5cdCAgICBmaWx0ZXI6IHVuZGVmaW5lZCxcblx0ICAgIG1vZHVsZTogdW5kZWZpbmVkLFxuXHQgICAgbW9kdWxlSWQ6IHVuZGVmaW5lZCxcblx0ICAgIHRlc3RJZDogdW5kZWZpbmVkXG5cdCAgfSksXG5cdCAgICAgIG1vZHVsZXNMaXN0ID0gW107XG5cblx0ICBmdW5jdGlvbiBhZGRFdmVudChlbGVtLCB0eXBlLCBmbikge1xuXHQgICAgZWxlbS5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBmYWxzZSk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gcmVtb3ZlRXZlbnQoZWxlbSwgdHlwZSwgZm4pIHtcblx0ICAgIGVsZW0ucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgZmFsc2UpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFkZEV2ZW50cyhlbGVtcywgdHlwZSwgZm4pIHtcblx0ICAgIHZhciBpID0gZWxlbXMubGVuZ3RoO1xuXG5cdCAgICB3aGlsZSAoaS0tKSB7XG5cdCAgICAgIGFkZEV2ZW50KGVsZW1zW2ldLCB0eXBlLCBmbik7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gaGFzQ2xhc3MoZWxlbSwgbmFtZSkge1xuXHQgICAgcmV0dXJuIChcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCIpLmluZGV4T2YoXCIgXCIgKyBuYW1lICsgXCIgXCIpID49IDA7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYWRkQ2xhc3MoZWxlbSwgbmFtZSkge1xuXHQgICAgaWYgKCFoYXNDbGFzcyhlbGVtLCBuYW1lKSkge1xuXHQgICAgICBlbGVtLmNsYXNzTmFtZSArPSAoZWxlbS5jbGFzc05hbWUgPyBcIiBcIiA6IFwiXCIpICsgbmFtZTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiB0b2dnbGVDbGFzcyhlbGVtLCBuYW1lLCBmb3JjZSkge1xuXHQgICAgaWYgKGZvcmNlIHx8IHR5cGVvZiBmb3JjZSA9PT0gXCJ1bmRlZmluZWRcIiAmJiAhaGFzQ2xhc3MoZWxlbSwgbmFtZSkpIHtcblx0ICAgICAgYWRkQ2xhc3MoZWxlbSwgbmFtZSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZW1vdmVDbGFzcyhlbGVtLCBuYW1lKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiByZW1vdmVDbGFzcyhlbGVtLCBuYW1lKSB7XG5cdCAgICB2YXIgc2V0ID0gXCIgXCIgKyBlbGVtLmNsYXNzTmFtZSArIFwiIFwiOyAvLyBDbGFzcyBuYW1lIG1heSBhcHBlYXIgbXVsdGlwbGUgdGltZXNcblxuXHQgICAgd2hpbGUgKHNldC5pbmRleE9mKFwiIFwiICsgbmFtZSArIFwiIFwiKSA+PSAwKSB7XG5cdCAgICAgIHNldCA9IHNldC5yZXBsYWNlKFwiIFwiICsgbmFtZSArIFwiIFwiLCBcIiBcIik7XG5cdCAgICB9IC8vIFRyaW0gZm9yIHByZXR0aW5lc3NcblxuXG5cdCAgICBlbGVtLmNsYXNzTmFtZSA9IHR5cGVvZiBzZXQudHJpbSA9PT0gXCJmdW5jdGlvblwiID8gc2V0LnRyaW0oKSA6IHNldC5yZXBsYWNlKC9eXFxzK3xcXHMrJC9nLCBcIlwiKTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBpZChuYW1lKSB7XG5cdCAgICByZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgJiYgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQobmFtZSk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYWJvcnRUZXN0cygpIHtcblx0ICAgIHZhciBhYm9ydEJ1dHRvbiA9IGlkKFwicXVuaXQtYWJvcnQtdGVzdHMtYnV0dG9uXCIpO1xuXG5cdCAgICBpZiAoYWJvcnRCdXR0b24pIHtcblx0ICAgICAgYWJvcnRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuXHQgICAgICBhYm9ydEJ1dHRvbi5pbm5lckhUTUwgPSBcIkFib3J0aW5nLi4uXCI7XG5cdCAgICB9XG5cblx0ICAgIFFVbml0LmNvbmZpZy5xdWV1ZS5sZW5ndGggPSAwO1xuXHQgICAgcmV0dXJuIGZhbHNlO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGludGVyY2VwdE5hdmlnYXRpb24oZXYpIHtcblx0ICAgIGFwcGx5VXJsUGFyYW1zKCk7XG5cblx0ICAgIGlmIChldiAmJiBldi5wcmV2ZW50RGVmYXVsdCkge1xuXHQgICAgICBldi5wcmV2ZW50RGVmYXVsdCgpO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gZmFsc2U7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gZ2V0VXJsQ29uZmlnSHRtbCgpIHtcblx0ICAgIHZhciBpLFxuXHQgICAgICAgIGosXG5cdCAgICAgICAgdmFsLFxuXHQgICAgICAgIGVzY2FwZWQsXG5cdCAgICAgICAgZXNjYXBlZFRvb2x0aXAsXG5cdCAgICAgICAgc2VsZWN0aW9uID0gZmFsc2UsXG5cdCAgICAgICAgdXJsQ29uZmlnID0gY29uZmlnLnVybENvbmZpZyxcblx0ICAgICAgICB1cmxDb25maWdIdG1sID0gXCJcIjtcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IHVybENvbmZpZy5sZW5ndGg7IGkrKykge1xuXHQgICAgICAvLyBPcHRpb25zIGNhbiBiZSBlaXRoZXIgc3RyaW5ncyBvciBvYmplY3RzIHdpdGggbm9uZW1wdHkgXCJpZFwiIHByb3BlcnRpZXNcblx0ICAgICAgdmFsID0gY29uZmlnLnVybENvbmZpZ1tpXTtcblxuXHQgICAgICBpZiAodHlwZW9mIHZhbCA9PT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAgIHZhbCA9IHtcblx0ICAgICAgICAgIGlkOiB2YWwsXG5cdCAgICAgICAgICBsYWJlbDogdmFsXG5cdCAgICAgICAgfTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGVzY2FwZWQgPSBlc2NhcGVUZXh0KHZhbC5pZCk7XG5cdCAgICAgIGVzY2FwZWRUb29sdGlwID0gZXNjYXBlVGV4dCh2YWwudG9vbHRpcCk7XG5cblx0ICAgICAgaWYgKCF2YWwudmFsdWUgfHwgdHlwZW9mIHZhbC52YWx1ZSA9PT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAgIHVybENvbmZpZ0h0bWwgKz0gXCI8bGFiZWwgZm9yPSdxdW5pdC11cmxjb25maWctXCIgKyBlc2NhcGVkICsgXCInIHRpdGxlPSdcIiArIGVzY2FwZWRUb29sdGlwICsgXCInPjxpbnB1dCBpZD0ncXVuaXQtdXJsY29uZmlnLVwiICsgZXNjYXBlZCArIFwiJyBuYW1lPSdcIiArIGVzY2FwZWQgKyBcIicgdHlwZT0nY2hlY2tib3gnXCIgKyAodmFsLnZhbHVlID8gXCIgdmFsdWU9J1wiICsgZXNjYXBlVGV4dCh2YWwudmFsdWUpICsgXCInXCIgOiBcIlwiKSArIChjb25maWdbdmFsLmlkXSA/IFwiIGNoZWNrZWQ9J2NoZWNrZWQnXCIgOiBcIlwiKSArIFwiIHRpdGxlPSdcIiArIGVzY2FwZWRUb29sdGlwICsgXCInIC8+XCIgKyBlc2NhcGVUZXh0KHZhbC5sYWJlbCkgKyBcIjwvbGFiZWw+XCI7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdXJsQ29uZmlnSHRtbCArPSBcIjxsYWJlbCBmb3I9J3F1bml0LXVybGNvbmZpZy1cIiArIGVzY2FwZWQgKyBcIicgdGl0bGU9J1wiICsgZXNjYXBlZFRvb2x0aXAgKyBcIic+XCIgKyB2YWwubGFiZWwgKyBcIjogPC9sYWJlbD48c2VsZWN0IGlkPSdxdW5pdC11cmxjb25maWctXCIgKyBlc2NhcGVkICsgXCInIG5hbWU9J1wiICsgZXNjYXBlZCArIFwiJyB0aXRsZT0nXCIgKyBlc2NhcGVkVG9vbHRpcCArIFwiJz48b3B0aW9uPjwvb3B0aW9uPlwiO1xuXG5cdCAgICAgICAgaWYgKFFVbml0LmlzKFwiYXJyYXlcIiwgdmFsLnZhbHVlKSkge1xuXHQgICAgICAgICAgZm9yIChqID0gMDsgaiA8IHZhbC52YWx1ZS5sZW5ndGg7IGorKykge1xuXHQgICAgICAgICAgICBlc2NhcGVkID0gZXNjYXBlVGV4dCh2YWwudmFsdWVbal0pO1xuXHQgICAgICAgICAgICB1cmxDb25maWdIdG1sICs9IFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyBlc2NhcGVkICsgXCInXCIgKyAoY29uZmlnW3ZhbC5pZF0gPT09IHZhbC52YWx1ZVtqXSA/IChzZWxlY3Rpb24gPSB0cnVlKSAmJiBcIiBzZWxlY3RlZD0nc2VsZWN0ZWQnXCIgOiBcIlwiKSArIFwiPlwiICsgZXNjYXBlZCArIFwiPC9vcHRpb24+XCI7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGZvciAoaiBpbiB2YWwudmFsdWUpIHtcblx0ICAgICAgICAgICAgaWYgKGhhc093bi5jYWxsKHZhbC52YWx1ZSwgaikpIHtcblx0ICAgICAgICAgICAgICB1cmxDb25maWdIdG1sICs9IFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyBlc2NhcGVUZXh0KGopICsgXCInXCIgKyAoY29uZmlnW3ZhbC5pZF0gPT09IGogPyAoc2VsZWN0aW9uID0gdHJ1ZSkgJiYgXCIgc2VsZWN0ZWQ9J3NlbGVjdGVkJ1wiIDogXCJcIikgKyBcIj5cIiArIGVzY2FwZVRleHQodmFsLnZhbHVlW2pdKSArIFwiPC9vcHRpb24+XCI7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAoY29uZmlnW3ZhbC5pZF0gJiYgIXNlbGVjdGlvbikge1xuXHQgICAgICAgICAgZXNjYXBlZCA9IGVzY2FwZVRleHQoY29uZmlnW3ZhbC5pZF0pO1xuXHQgICAgICAgICAgdXJsQ29uZmlnSHRtbCArPSBcIjxvcHRpb24gdmFsdWU9J1wiICsgZXNjYXBlZCArIFwiJyBzZWxlY3RlZD0nc2VsZWN0ZWQnIGRpc2FibGVkPSdkaXNhYmxlZCc+XCIgKyBlc2NhcGVkICsgXCI8L29wdGlvbj5cIjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICB1cmxDb25maWdIdG1sICs9IFwiPC9zZWxlY3Q+XCI7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHVybENvbmZpZ0h0bWw7XG5cdCAgfSAvLyBIYW5kbGUgXCJjbGlja1wiIGV2ZW50cyBvbiB0b29sYmFyIGNoZWNrYm94ZXMgYW5kIFwiY2hhbmdlXCIgZm9yIHNlbGVjdCBtZW51cy5cblx0ICAvLyBVcGRhdGVzIHRoZSBVUkwgd2l0aCB0aGUgbmV3IHN0YXRlIG9mIGBjb25maWcudXJsQ29uZmlnYCB2YWx1ZXMuXG5cblxuXHQgIGZ1bmN0aW9uIHRvb2xiYXJDaGFuZ2VkKCkge1xuXHQgICAgdmFyIHVwZGF0ZWRVcmwsXG5cdCAgICAgICAgdmFsdWUsXG5cdCAgICAgICAgdGVzdHMsXG5cdCAgICAgICAgZmllbGQgPSB0aGlzLFxuXHQgICAgICAgIHBhcmFtcyA9IHt9OyAvLyBEZXRlY3QgaWYgZmllbGQgaXMgYSBzZWxlY3QgbWVudSBvciBhIGNoZWNrYm94XG5cblx0ICAgIGlmIChcInNlbGVjdGVkSW5kZXhcIiBpbiBmaWVsZCkge1xuXHQgICAgICB2YWx1ZSA9IGZpZWxkLm9wdGlvbnNbZmllbGQuc2VsZWN0ZWRJbmRleF0udmFsdWUgfHwgdW5kZWZpbmVkO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdmFsdWUgPSBmaWVsZC5jaGVja2VkID8gZmllbGQuZGVmYXVsdFZhbHVlIHx8IHRydWUgOiB1bmRlZmluZWQ7XG5cdCAgICB9XG5cblx0ICAgIHBhcmFtc1tmaWVsZC5uYW1lXSA9IHZhbHVlO1xuXHQgICAgdXBkYXRlZFVybCA9IHNldFVybChwYXJhbXMpOyAvLyBDaGVjayBpZiB3ZSBjYW4gYXBwbHkgdGhlIGNoYW5nZSB3aXRob3V0IGEgcGFnZSByZWZyZXNoXG5cblx0ICAgIGlmIChcImhpZGVwYXNzZWRcIiA9PT0gZmllbGQubmFtZSAmJiBcInJlcGxhY2VTdGF0ZVwiIGluIHdpbmRvdyQxLmhpc3RvcnkpIHtcblx0ICAgICAgUVVuaXQudXJsUGFyYW1zW2ZpZWxkLm5hbWVdID0gdmFsdWU7XG5cdCAgICAgIGNvbmZpZ1tmaWVsZC5uYW1lXSA9IHZhbHVlIHx8IGZhbHNlO1xuXHQgICAgICB0ZXN0cyA9IGlkKFwicXVuaXQtdGVzdHNcIik7XG5cblx0ICAgICAgaWYgKHRlc3RzKSB7XG5cdCAgICAgICAgdmFyIGxlbmd0aCA9IHRlc3RzLmNoaWxkcmVuLmxlbmd0aDtcblx0ICAgICAgICB2YXIgY2hpbGRyZW4gPSB0ZXN0cy5jaGlsZHJlbjtcblxuXHQgICAgICAgIGlmIChmaWVsZC5jaGVja2VkKSB7XG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICAgIHZhciB0ZXN0ID0gY2hpbGRyZW5baV07XG5cdCAgICAgICAgICAgIHZhciBjbGFzc05hbWUgPSB0ZXN0ID8gdGVzdC5jbGFzc05hbWUgOiBcIlwiO1xuXHQgICAgICAgICAgICB2YXIgY2xhc3NOYW1lSGFzUGFzcyA9IGNsYXNzTmFtZS5pbmRleE9mKFwicGFzc1wiKSA+IC0xO1xuXHQgICAgICAgICAgICB2YXIgY2xhc3NOYW1lSGFzU2tpcHBlZCA9IGNsYXNzTmFtZS5pbmRleE9mKFwic2tpcHBlZFwiKSA+IC0xO1xuXG5cdCAgICAgICAgICAgIGlmIChjbGFzc05hbWVIYXNQYXNzIHx8IGNsYXNzTmFtZUhhc1NraXBwZWQpIHtcblx0ICAgICAgICAgICAgICBoaWRkZW5UZXN0cy5wdXNoKHRlc3QpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihoaWRkZW5UZXN0cyksXG5cdCAgICAgICAgICAgICAgX3N0ZXA7XG5cblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIGZvciAoX2l0ZXJhdG9yLnMoKTsgIShfc3RlcCA9IF9pdGVyYXRvci5uKCkpLmRvbmU7KSB7XG5cdCAgICAgICAgICAgICAgdmFyIGhpZGRlblRlc3QgPSBfc3RlcC52YWx1ZTtcblx0ICAgICAgICAgICAgICB0ZXN0cy5yZW1vdmVDaGlsZChoaWRkZW5UZXN0KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG5cdCAgICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7XG5cdCAgICAgICAgICB9IGZpbmFsbHkge1xuXHQgICAgICAgICAgICBfaXRlcmF0b3IuZigpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB3aGlsZSAoKHRlc3QgPSBoaWRkZW5UZXN0cy5wb3AoKSkgIT0gbnVsbCkge1xuXHQgICAgICAgICAgICB0ZXN0cy5hcHBlbmRDaGlsZCh0ZXN0KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICB3aW5kb3ckMS5oaXN0b3J5LnJlcGxhY2VTdGF0ZShudWxsLCBcIlwiLCB1cGRhdGVkVXJsKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHdpbmRvdyQxLmxvY2F0aW9uID0gdXBkYXRlZFVybDtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiBzZXRVcmwocGFyYW1zKSB7XG5cdCAgICB2YXIga2V5LFxuXHQgICAgICAgIGFyclZhbHVlLFxuXHQgICAgICAgIGksXG5cdCAgICAgICAgcXVlcnlzdHJpbmcgPSBcIj9cIixcblx0ICAgICAgICBsb2NhdGlvbiA9IHdpbmRvdyQxLmxvY2F0aW9uO1xuXHQgICAgcGFyYW1zID0gUVVuaXQuZXh0ZW5kKFFVbml0LmV4dGVuZCh7fSwgUVVuaXQudXJsUGFyYW1zKSwgcGFyYW1zKTtcblxuXHQgICAgZm9yIChrZXkgaW4gcGFyYW1zKSB7XG5cdCAgICAgIC8vIFNraXAgaW5oZXJpdGVkIG9yIHVuZGVmaW5lZCBwcm9wZXJ0aWVzXG5cdCAgICAgIGlmIChoYXNPd24uY2FsbChwYXJhbXMsIGtleSkgJiYgcGFyYW1zW2tleV0gIT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIC8vIE91dHB1dCBhIHBhcmFtZXRlciBmb3IgZWFjaCB2YWx1ZSBvZiB0aGlzIGtleVxuXHQgICAgICAgIC8vIChidXQgdXN1YWxseSBqdXN0IG9uZSlcblx0ICAgICAgICBhcnJWYWx1ZSA9IFtdLmNvbmNhdChwYXJhbXNba2V5XSk7XG5cblx0ICAgICAgICBmb3IgKGkgPSAwOyBpIDwgYXJyVmFsdWUubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgIHF1ZXJ5c3RyaW5nICs9IGVuY29kZVVSSUNvbXBvbmVudChrZXkpO1xuXG5cdCAgICAgICAgICBpZiAoYXJyVmFsdWVbaV0gIT09IHRydWUpIHtcblx0ICAgICAgICAgICAgcXVlcnlzdHJpbmcgKz0gXCI9XCIgKyBlbmNvZGVVUklDb21wb25lbnQoYXJyVmFsdWVbaV0pO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBxdWVyeXN0cmluZyArPSBcIiZcIjtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIGxvY2F0aW9uLnByb3RvY29sICsgXCIvL1wiICsgbG9jYXRpb24uaG9zdCArIGxvY2F0aW9uLnBhdGhuYW1lICsgcXVlcnlzdHJpbmcuc2xpY2UoMCwgLTEpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGx5VXJsUGFyYW1zKCkge1xuXHQgICAgdmFyIGksXG5cdCAgICAgICAgc2VsZWN0ZWRNb2R1bGVzID0gW10sXG5cdCAgICAgICAgbW9kdWxlc0xpc3QgPSBpZChcInF1bml0LW1vZHVsZWZpbHRlci1kcm9wZG93bi1saXN0XCIpLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIiksXG5cdCAgICAgICAgZmlsdGVyID0gaWQoXCJxdW5pdC1maWx0ZXItaW5wdXRcIikudmFsdWU7XG5cblx0ICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzTGlzdC5sZW5ndGg7IGkrKykge1xuXHQgICAgICBpZiAobW9kdWxlc0xpc3RbaV0uY2hlY2tlZCkge1xuXHQgICAgICAgIHNlbGVjdGVkTW9kdWxlcy5wdXNoKG1vZHVsZXNMaXN0W2ldLnZhbHVlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICB3aW5kb3ckMS5sb2NhdGlvbiA9IHNldFVybCh7XG5cdCAgICAgIGZpbHRlcjogZmlsdGVyID09PSBcIlwiID8gdW5kZWZpbmVkIDogZmlsdGVyLFxuXHQgICAgICBtb2R1bGVJZDogc2VsZWN0ZWRNb2R1bGVzLmxlbmd0aCA9PT0gMCA/IHVuZGVmaW5lZCA6IHNlbGVjdGVkTW9kdWxlcyxcblx0ICAgICAgLy8gUmVtb3ZlIG1vZHVsZSBhbmQgdGVzdElkIGZpbHRlclxuXHQgICAgICBtb2R1bGU6IHVuZGVmaW5lZCxcblx0ICAgICAgdGVzdElkOiB1bmRlZmluZWRcblx0ICAgIH0pO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHRvb2xiYXJVcmxDb25maWdDb250YWluZXIoKSB7XG5cdCAgICB2YXIgdXJsQ29uZmlnQ29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdCAgICB1cmxDb25maWdDb250YWluZXIuaW5uZXJIVE1MID0gZ2V0VXJsQ29uZmlnSHRtbCgpO1xuXHQgICAgYWRkQ2xhc3ModXJsQ29uZmlnQ29udGFpbmVyLCBcInF1bml0LXVybC1jb25maWdcIik7XG5cdCAgICBhZGRFdmVudHModXJsQ29uZmlnQ29udGFpbmVyLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwiaW5wdXRcIiksIFwiY2hhbmdlXCIsIHRvb2xiYXJDaGFuZ2VkKTtcblx0ICAgIGFkZEV2ZW50cyh1cmxDb25maWdDb250YWluZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzZWxlY3RcIiksIFwiY2hhbmdlXCIsIHRvb2xiYXJDaGFuZ2VkKTtcblx0ICAgIHJldHVybiB1cmxDb25maWdDb250YWluZXI7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYWJvcnRUZXN0c0J1dHRvbigpIHtcblx0ICAgIHZhciBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuXHQgICAgYnV0dG9uLmlkID0gXCJxdW5pdC1hYm9ydC10ZXN0cy1idXR0b25cIjtcblx0ICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBcIkFib3J0XCI7XG5cdCAgICBhZGRFdmVudChidXR0b24sIFwiY2xpY2tcIiwgYWJvcnRUZXN0cyk7XG5cdCAgICByZXR1cm4gYnV0dG9uO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHRvb2xiYXJMb29zZUZpbHRlcigpIHtcblx0ICAgIHZhciBmaWx0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKSxcblx0ICAgICAgICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKSxcblx0ICAgICAgICBpbnB1dCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0ICAgICAgICBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xuXHQgICAgYWRkQ2xhc3MoZmlsdGVyLCBcInF1bml0LWZpbHRlclwiKTtcblx0ICAgIGxhYmVsLmlubmVySFRNTCA9IFwiRmlsdGVyOiBcIjtcblx0ICAgIGlucHV0LnR5cGUgPSBcInRleHRcIjtcblx0ICAgIGlucHV0LnZhbHVlID0gY29uZmlnLmZpbHRlciB8fCBcIlwiO1xuXHQgICAgaW5wdXQubmFtZSA9IFwiZmlsdGVyXCI7XG5cdCAgICBpbnB1dC5pZCA9IFwicXVuaXQtZmlsdGVyLWlucHV0XCI7XG5cdCAgICBidXR0b24uaW5uZXJIVE1MID0gXCJHb1wiO1xuXHQgICAgbGFiZWwuYXBwZW5kQ2hpbGQoaW5wdXQpO1xuXHQgICAgZmlsdGVyLmFwcGVuZENoaWxkKGxhYmVsKTtcblx0ICAgIGZpbHRlci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIiBcIikpO1xuXHQgICAgZmlsdGVyLmFwcGVuZENoaWxkKGJ1dHRvbik7XG5cdCAgICBhZGRFdmVudChmaWx0ZXIsIFwic3VibWl0XCIsIGludGVyY2VwdE5hdmlnYXRpb24pO1xuXHQgICAgcmV0dXJuIGZpbHRlcjtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBtb2R1bGVMaXN0SHRtbChtb2R1bGVzKSB7XG5cdCAgICB2YXIgaSxcblx0ICAgICAgICBjaGVja2VkLFxuXHQgICAgICAgIGh0bWwgPSBcIlwiO1xuXG5cdCAgICBmb3IgKGkgPSAwOyBpIDwgbW9kdWxlcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICBpZiAobW9kdWxlc1tpXS5uYW1lICE9PSBcIlwiKSB7XG5cdCAgICAgICAgY2hlY2tlZCA9IGNvbmZpZy5tb2R1bGVJZC5pbmRleE9mKG1vZHVsZXNbaV0ubW9kdWxlSWQpID4gLTE7XG5cdCAgICAgICAgaHRtbCArPSBcIjxsaT48bGFiZWwgY2xhc3M9J2NsaWNrYWJsZVwiICsgKGNoZWNrZWQgPyBcIiBjaGVja2VkXCIgOiBcIlwiKSArIFwiJz48aW5wdXQgdHlwZT0nY2hlY2tib3gnIFwiICsgXCJ2YWx1ZT0nXCIgKyBtb2R1bGVzW2ldLm1vZHVsZUlkICsgXCInXCIgKyAoY2hlY2tlZCA/IFwiIGNoZWNrZWQ9J2NoZWNrZWQnXCIgOiBcIlwiKSArIFwiIC8+XCIgKyBlc2NhcGVUZXh0KG1vZHVsZXNbaV0ubmFtZSkgKyBcIjwvbGFiZWw+PC9saT5cIjtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gaHRtbDtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiB0b29sYmFyTW9kdWxlRmlsdGVyKCkge1xuXHQgICAgdmFyIGNvbW1pdCxcblx0ICAgICAgICByZXNldCxcblx0ICAgICAgICBtb2R1bGVGaWx0ZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKSxcblx0ICAgICAgICBsYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKSxcblx0ICAgICAgICBtb2R1bGVTZWFyY2ggPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiaW5wdXRcIiksXG5cdCAgICAgICAgZHJvcERvd24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpLFxuXHQgICAgICAgIGFjdGlvbnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKSxcblx0ICAgICAgICBhcHBseUJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiksXG5cdCAgICAgICAgcmVzZXRCdXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpLFxuXHQgICAgICAgIGFsbE1vZHVsZXNMYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKSxcblx0ICAgICAgICBhbGxDaGVja2JveCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0ICAgICAgICBkcm9wRG93bkxpc3QgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidWxcIiksXG5cdCAgICAgICAgZGlydHkgPSBmYWxzZTtcblx0ICAgIG1vZHVsZVNlYXJjaC5pZCA9IFwicXVuaXQtbW9kdWxlZmlsdGVyLXNlYXJjaFwiO1xuXHQgICAgbW9kdWxlU2VhcmNoLmF1dG9jb21wbGV0ZSA9IFwib2ZmXCI7XG5cdCAgICBhZGRFdmVudChtb2R1bGVTZWFyY2gsIFwiaW5wdXRcIiwgc2VhcmNoSW5wdXQpO1xuXHQgICAgYWRkRXZlbnQobW9kdWxlU2VhcmNoLCBcImlucHV0XCIsIHNlYXJjaEZvY3VzKTtcblx0ICAgIGFkZEV2ZW50KG1vZHVsZVNlYXJjaCwgXCJmb2N1c1wiLCBzZWFyY2hGb2N1cyk7XG5cdCAgICBhZGRFdmVudChtb2R1bGVTZWFyY2gsIFwiY2xpY2tcIiwgc2VhcmNoRm9jdXMpO1xuXHQgICAgY29uZmlnLm1vZHVsZXMuZm9yRWFjaChmdW5jdGlvbiAobW9kdWxlKSB7XG5cdCAgICAgIHJldHVybiBtb2R1bGUubmFtZVByZXBhcmVkID0gZnV6enlzb3J0LnByZXBhcmUobW9kdWxlLm5hbWUpO1xuXHQgICAgfSk7XG5cdCAgICBsYWJlbC5pZCA9IFwicXVuaXQtbW9kdWxlZmlsdGVyLXNlYXJjaC1jb250YWluZXJcIjtcblx0ICAgIGxhYmVsLmlubmVySFRNTCA9IFwiTW9kdWxlOiBcIjtcblx0ICAgIGxhYmVsLmFwcGVuZENoaWxkKG1vZHVsZVNlYXJjaCk7XG5cdCAgICBhcHBseUJ1dHRvbi50ZXh0Q29udGVudCA9IFwiQXBwbHlcIjtcblx0ICAgIGFwcGx5QnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0ICAgIHJlc2V0QnV0dG9uLnRleHRDb250ZW50ID0gXCJSZXNldFwiO1xuXHQgICAgcmVzZXRCdXR0b24udHlwZSA9IFwicmVzZXRcIjtcblx0ICAgIHJlc2V0QnV0dG9uLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0ICAgIGFsbENoZWNrYm94LnR5cGUgPSBcImNoZWNrYm94XCI7XG5cdCAgICBhbGxDaGVja2JveC5jaGVja2VkID0gY29uZmlnLm1vZHVsZUlkLmxlbmd0aCA9PT0gMDtcblx0ICAgIGFsbE1vZHVsZXNMYWJlbC5jbGFzc05hbWUgPSBcImNsaWNrYWJsZVwiO1xuXG5cdCAgICBpZiAoY29uZmlnLm1vZHVsZUlkLmxlbmd0aCkge1xuXHQgICAgICBhbGxNb2R1bGVzTGFiZWwuY2xhc3NOYW1lID0gXCJjaGVja2VkXCI7XG5cdCAgICB9XG5cblx0ICAgIGFsbE1vZHVsZXNMYWJlbC5hcHBlbmRDaGlsZChhbGxDaGVja2JveCk7XG5cdCAgICBhbGxNb2R1bGVzTGFiZWwuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoXCJBbGwgbW9kdWxlc1wiKSk7XG5cdCAgICBhY3Rpb25zLmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXItYWN0aW9uc1wiO1xuXHQgICAgYWN0aW9ucy5hcHBlbmRDaGlsZChhcHBseUJ1dHRvbik7XG5cdCAgICBhY3Rpb25zLmFwcGVuZENoaWxkKHJlc2V0QnV0dG9uKTtcblx0ICAgIGFjdGlvbnMuYXBwZW5kQ2hpbGQoYWxsTW9kdWxlc0xhYmVsKTtcblx0ICAgIGNvbW1pdCA9IGFjdGlvbnMuZmlyc3RDaGlsZDtcblx0ICAgIHJlc2V0ID0gY29tbWl0Lm5leHRTaWJsaW5nO1xuXHQgICAgYWRkRXZlbnQoY29tbWl0LCBcImNsaWNrXCIsIGFwcGx5VXJsUGFyYW1zKTtcblx0ICAgIGRyb3BEb3duTGlzdC5pZCA9IFwicXVuaXQtbW9kdWxlZmlsdGVyLWRyb3Bkb3duLWxpc3RcIjtcblx0ICAgIGRyb3BEb3duTGlzdC5pbm5lckhUTUwgPSBtb2R1bGVMaXN0SHRtbChjb25maWcubW9kdWxlcyk7XG5cdCAgICBkcm9wRG93bi5pZCA9IFwicXVuaXQtbW9kdWxlZmlsdGVyLWRyb3Bkb3duXCI7XG5cdCAgICBkcm9wRG93bi5zdHlsZS5kaXNwbGF5ID0gXCJub25lXCI7XG5cdCAgICBkcm9wRG93bi5hcHBlbmRDaGlsZChhY3Rpb25zKTtcblx0ICAgIGRyb3BEb3duLmFwcGVuZENoaWxkKGRyb3BEb3duTGlzdCk7XG5cdCAgICBhZGRFdmVudChkcm9wRG93biwgXCJjaGFuZ2VcIiwgc2VsZWN0aW9uQ2hhbmdlKTtcblx0ICAgIHNlbGVjdGlvbkNoYW5nZSgpO1xuXHQgICAgbW9kdWxlRmlsdGVyLmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXJcIjtcblx0ICAgIG1vZHVsZUZpbHRlci5hcHBlbmRDaGlsZChsYWJlbCk7XG5cdCAgICBtb2R1bGVGaWx0ZXIuYXBwZW5kQ2hpbGQoZHJvcERvd24pO1xuXHQgICAgYWRkRXZlbnQobW9kdWxlRmlsdGVyLCBcInN1Ym1pdFwiLCBpbnRlcmNlcHROYXZpZ2F0aW9uKTtcblx0ICAgIGFkZEV2ZW50KG1vZHVsZUZpbHRlciwgXCJyZXNldFwiLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgIC8vIExldCB0aGUgcmVzZXQgaGFwcGVuLCB0aGVuIHVwZGF0ZSBzdHlsZXNcblx0ICAgICAgd2luZG93JDEuc2V0VGltZW91dChzZWxlY3Rpb25DaGFuZ2UpO1xuXHQgICAgfSk7IC8vIEVuYWJsZXMgc2hvdy9oaWRlIGZvciB0aGUgZHJvcGRvd25cblxuXHQgICAgZnVuY3Rpb24gc2VhcmNoRm9jdXMoKSB7XG5cdCAgICAgIGlmIChkcm9wRG93bi5zdHlsZS5kaXNwbGF5ICE9PSBcIm5vbmVcIikge1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIGRyb3BEb3duLnN0eWxlLmRpc3BsYXkgPSBcImJsb2NrXCI7XG5cdCAgICAgIGFkZEV2ZW50KGRvY3VtZW50LCBcImNsaWNrXCIsIGhpZGVIYW5kbGVyKTtcblx0ICAgICAgYWRkRXZlbnQoZG9jdW1lbnQsIFwia2V5ZG93blwiLCBoaWRlSGFuZGxlcik7IC8vIEhpZGUgb24gRXNjYXBlIGtleWRvd24gb3Igb3V0c2lkZS1jb250YWluZXIgY2xpY2tcblxuXHQgICAgICBmdW5jdGlvbiBoaWRlSGFuZGxlcihlKSB7XG5cdCAgICAgICAgdmFyIGluQ29udGFpbmVyID0gbW9kdWxlRmlsdGVyLmNvbnRhaW5zKGUudGFyZ2V0KTtcblxuXHQgICAgICAgIGlmIChlLmtleUNvZGUgPT09IDI3IHx8ICFpbkNvbnRhaW5lcikge1xuXHQgICAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcgJiYgaW5Db250YWluZXIpIHtcblx0ICAgICAgICAgICAgbW9kdWxlU2VhcmNoLmZvY3VzKCk7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIGRyb3BEb3duLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0ICAgICAgICAgIHJlbW92ZUV2ZW50KGRvY3VtZW50LCBcImNsaWNrXCIsIGhpZGVIYW5kbGVyKTtcblx0ICAgICAgICAgIHJlbW92ZUV2ZW50KGRvY3VtZW50LCBcImtleWRvd25cIiwgaGlkZUhhbmRsZXIpO1xuXHQgICAgICAgICAgbW9kdWxlU2VhcmNoLnZhbHVlID0gXCJcIjtcblx0ICAgICAgICAgIHNlYXJjaElucHV0KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGZpbHRlck1vZHVsZXMoc2VhcmNoVGV4dCkge1xuXHQgICAgICBpZiAoc2VhcmNoVGV4dCA9PT0gXCJcIikge1xuXHQgICAgICAgIHJldHVybiBjb25maWcubW9kdWxlcztcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBmdXp6eXNvcnQuZ28oc2VhcmNoVGV4dCwgY29uZmlnLm1vZHVsZXMsIHtcblx0ICAgICAgICBrZXk6IFwibmFtZVByZXBhcmVkXCIsXG5cdCAgICAgICAgdGhyZXNob2xkOiAtMTAwMDBcblx0ICAgICAgfSkubWFwKGZ1bmN0aW9uIChtb2R1bGUpIHtcblx0ICAgICAgICByZXR1cm4gbW9kdWxlLm9iajtcblx0ICAgICAgfSk7XG5cdCAgICB9IC8vIFByb2Nlc3NlcyBtb2R1bGUgc2VhcmNoIGJveCBpbnB1dFxuXG5cblx0ICAgIHZhciBzZWFyY2hJbnB1dFRpbWVvdXQ7XG5cblx0ICAgIGZ1bmN0aW9uIHNlYXJjaElucHV0KCkge1xuXHQgICAgICB3aW5kb3ckMS5jbGVhclRpbWVvdXQoc2VhcmNoSW5wdXRUaW1lb3V0KTtcblx0ICAgICAgc2VhcmNoSW5wdXRUaW1lb3V0ID0gd2luZG93JDEuc2V0VGltZW91dChmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdmFyIHNlYXJjaFRleHQgPSBtb2R1bGVTZWFyY2gudmFsdWUudG9Mb3dlckNhc2UoKSxcblx0ICAgICAgICAgICAgZmlsdGVyZWRNb2R1bGVzID0gZmlsdGVyTW9kdWxlcyhzZWFyY2hUZXh0KTtcblx0ICAgICAgICBkcm9wRG93bkxpc3QuaW5uZXJIVE1MID0gbW9kdWxlTGlzdEh0bWwoZmlsdGVyZWRNb2R1bGVzKTtcblx0ICAgICAgfSwgMjAwKTtcblx0ICAgIH0gLy8gUHJvY2Vzc2VzIHNlbGVjdGlvbiBjaGFuZ2VzXG5cblxuXHQgICAgZnVuY3Rpb24gc2VsZWN0aW9uQ2hhbmdlKGV2dCkge1xuXHQgICAgICB2YXIgaSxcblx0ICAgICAgICAgIGl0ZW0sXG5cdCAgICAgICAgICBjaGVja2JveCA9IGV2dCAmJiBldnQudGFyZ2V0IHx8IGFsbENoZWNrYm94LFxuXHQgICAgICAgICAgbW9kdWxlc0xpc3QgPSBkcm9wRG93bkxpc3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSxcblx0ICAgICAgICAgIHNlbGVjdGVkTmFtZXMgPSBbXTtcblx0ICAgICAgdG9nZ2xlQ2xhc3MoY2hlY2tib3gucGFyZW50Tm9kZSwgXCJjaGVja2VkXCIsIGNoZWNrYm94LmNoZWNrZWQpO1xuXHQgICAgICBkaXJ0eSA9IGZhbHNlO1xuXG5cdCAgICAgIGlmIChjaGVja2JveC5jaGVja2VkICYmIGNoZWNrYm94ICE9PSBhbGxDaGVja2JveCkge1xuXHQgICAgICAgIGFsbENoZWNrYm94LmNoZWNrZWQgPSBmYWxzZTtcblx0ICAgICAgICByZW1vdmVDbGFzcyhhbGxDaGVja2JveC5wYXJlbnROb2RlLCBcImNoZWNrZWRcIik7XG5cdCAgICAgIH1cblxuXHQgICAgICBmb3IgKGkgPSAwOyBpIDwgbW9kdWxlc0xpc3QubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICBpdGVtID0gbW9kdWxlc0xpc3RbaV07XG5cblx0ICAgICAgICBpZiAoIWV2dCkge1xuXHQgICAgICAgICAgdG9nZ2xlQ2xhc3MoaXRlbS5wYXJlbnROb2RlLCBcImNoZWNrZWRcIiwgaXRlbS5jaGVja2VkKTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGNoZWNrYm94ID09PSBhbGxDaGVja2JveCAmJiBjaGVja2JveC5jaGVja2VkKSB7XG5cdCAgICAgICAgICBpdGVtLmNoZWNrZWQgPSBmYWxzZTtcblx0ICAgICAgICAgIHJlbW92ZUNsYXNzKGl0ZW0ucGFyZW50Tm9kZSwgXCJjaGVja2VkXCIpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGRpcnR5ID0gZGlydHkgfHwgaXRlbS5jaGVja2VkICE9PSBpdGVtLmRlZmF1bHRDaGVja2VkO1xuXG5cdCAgICAgICAgaWYgKGl0ZW0uY2hlY2tlZCkge1xuXHQgICAgICAgICAgc2VsZWN0ZWROYW1lcy5wdXNoKGl0ZW0ucGFyZW50Tm9kZS50ZXh0Q29udGVudCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgY29tbWl0LnN0eWxlLmRpc3BsYXkgPSByZXNldC5zdHlsZS5kaXNwbGF5ID0gZGlydHkgPyBcIlwiIDogXCJub25lXCI7XG5cdCAgICAgIG1vZHVsZVNlYXJjaC5wbGFjZWhvbGRlciA9IHNlbGVjdGVkTmFtZXMuam9pbihcIiwgXCIpIHx8IGFsbENoZWNrYm94LnBhcmVudE5vZGUudGV4dENvbnRlbnQ7XG5cdCAgICAgIG1vZHVsZVNlYXJjaC50aXRsZSA9IFwiVHlwZSB0byBmaWx0ZXIgbGlzdC4gQ3VycmVudCBzZWxlY3Rpb246XFxuXCIgKyAoc2VsZWN0ZWROYW1lcy5qb2luKFwiXFxuXCIpIHx8IGFsbENoZWNrYm94LnBhcmVudE5vZGUudGV4dENvbnRlbnQpO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gbW9kdWxlRmlsdGVyO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHRvb2xiYXJGaWx0ZXJzKCkge1xuXHQgICAgdmFyIHRvb2xiYXJGaWx0ZXJzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdCAgICB0b29sYmFyRmlsdGVycy5pZCA9IFwicXVuaXQtdG9vbGJhci1maWx0ZXJzXCI7XG5cdCAgICB0b29sYmFyRmlsdGVycy5hcHBlbmRDaGlsZCh0b29sYmFyTG9vc2VGaWx0ZXIoKSk7XG5cdCAgICB0b29sYmFyRmlsdGVycy5hcHBlbmRDaGlsZCh0b29sYmFyTW9kdWxlRmlsdGVyKCkpO1xuXHQgICAgcmV0dXJuIHRvb2xiYXJGaWx0ZXJzO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZFRvb2xiYXIoKSB7XG5cdCAgICB2YXIgdG9vbGJhciA9IGlkKFwicXVuaXQtdGVzdHJ1bm5lci10b29sYmFyXCIpO1xuXG5cdCAgICBpZiAodG9vbGJhcikge1xuXHQgICAgICB0b29sYmFyLmFwcGVuZENoaWxkKHRvb2xiYXJVcmxDb25maWdDb250YWluZXIoKSk7XG5cdCAgICAgIHRvb2xiYXIuYXBwZW5kQ2hpbGQodG9vbGJhckZpbHRlcnMoKSk7XG5cdCAgICAgIHRvb2xiYXIuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKSkuY2xhc3NOYW1lID0gXCJjbGVhcmZpeFwiO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZEhlYWRlcigpIHtcblx0ICAgIHZhciBoZWFkZXIgPSBpZChcInF1bml0LWhlYWRlclwiKTtcblxuXHQgICAgaWYgKGhlYWRlcikge1xuXHQgICAgICBoZWFkZXIuaW5uZXJIVE1MID0gXCI8YSBocmVmPSdcIiArIGVzY2FwZVRleHQodW5maWx0ZXJlZFVybCkgKyBcIic+XCIgKyBoZWFkZXIuaW5uZXJIVE1MICsgXCI8L2E+IFwiO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZEJhbm5lcigpIHtcblx0ICAgIHZhciBiYW5uZXIgPSBpZChcInF1bml0LWJhbm5lclwiKTtcblxuXHQgICAgaWYgKGJhbm5lcikge1xuXHQgICAgICBiYW5uZXIuY2xhc3NOYW1lID0gXCJcIjtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhcHBlbmRUZXN0UmVzdWx0cygpIHtcblx0ICAgIHZhciB0ZXN0cyA9IGlkKFwicXVuaXQtdGVzdHNcIiksXG5cdCAgICAgICAgcmVzdWx0ID0gaWQoXCJxdW5pdC10ZXN0cmVzdWx0XCIpLFxuXHQgICAgICAgIGNvbnRyb2xzO1xuXG5cdCAgICBpZiAocmVzdWx0KSB7XG5cdCAgICAgIHJlc3VsdC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHJlc3VsdCk7XG5cdCAgICB9XG5cblx0ICAgIGlmICh0ZXN0cykge1xuXHQgICAgICB0ZXN0cy5pbm5lckhUTUwgPSBcIlwiO1xuXHQgICAgICByZXN1bHQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicFwiKTtcblx0ICAgICAgcmVzdWx0LmlkID0gXCJxdW5pdC10ZXN0cmVzdWx0XCI7XG5cdCAgICAgIHJlc3VsdC5jbGFzc05hbWUgPSBcInJlc3VsdFwiO1xuXHQgICAgICB0ZXN0cy5wYXJlbnROb2RlLmluc2VydEJlZm9yZShyZXN1bHQsIHRlc3RzKTtcblx0ICAgICAgcmVzdWx0LmlubmVySFRNTCA9IFwiPGRpdiBpZD1cXFwicXVuaXQtdGVzdHJlc3VsdC1kaXNwbGF5XFxcIj5SdW5uaW5nLi4uPGJyIC8+JiMxNjA7PC9kaXY+XCIgKyBcIjxkaXYgaWQ9XFxcInF1bml0LXRlc3RyZXN1bHQtY29udHJvbHNcXFwiPjwvZGl2PlwiICsgXCI8ZGl2IGNsYXNzPVxcXCJjbGVhcmZpeFxcXCI+PC9kaXY+XCI7XG5cdCAgICAgIGNvbnRyb2xzID0gaWQoXCJxdW5pdC10ZXN0cmVzdWx0LWNvbnRyb2xzXCIpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29udHJvbHMpIHtcblx0ICAgICAgY29udHJvbHMuYXBwZW5kQ2hpbGQoYWJvcnRUZXN0c0J1dHRvbigpKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhcHBlbmRGaWx0ZXJlZFRlc3QoKSB7XG5cdCAgICB2YXIgdGVzdElkID0gUVVuaXQuY29uZmlnLnRlc3RJZDtcblxuXHQgICAgaWYgKCF0ZXN0SWQgfHwgdGVzdElkLmxlbmd0aCA8PSAwKSB7XG5cdCAgICAgIHJldHVybiBcIlwiO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gXCI8ZGl2IGlkPSdxdW5pdC1maWx0ZXJlZFRlc3QnPlJlcnVubmluZyBzZWxlY3RlZCB0ZXN0czogXCIgKyBlc2NhcGVUZXh0KHRlc3RJZC5qb2luKFwiLCBcIikpICsgXCIgPGEgaWQ9J3F1bml0LWNsZWFyRmlsdGVyJyBocmVmPSdcIiArIGVzY2FwZVRleHQodW5maWx0ZXJlZFVybCkgKyBcIic+UnVuIGFsbCB0ZXN0czwvYT48L2Rpdj5cIjtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhcHBlbmRVc2VyQWdlbnQoKSB7XG5cdCAgICB2YXIgdXNlckFnZW50ID0gaWQoXCJxdW5pdC11c2VyQWdlbnRcIik7XG5cblx0ICAgIGlmICh1c2VyQWdlbnQpIHtcblx0ICAgICAgdXNlckFnZW50LmlubmVySFRNTCA9IFwiXCI7XG5cdCAgICAgIHVzZXJBZ2VudC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlFVbml0IFwiICsgUVVuaXQudmVyc2lvbiArIFwiOyBcIiArIG5hdmlnYXRvci51c2VyQWdlbnQpKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhcHBlbmRJbnRlcmZhY2UoKSB7XG5cdCAgICB2YXIgcXVuaXQgPSBpZChcInF1bml0XCIpOyAvLyBGb3IgY29tcGF0IHdpdGggUVVuaXQgMS4yLCBhbmQgdG8gc3VwcG9ydCBmdWxseSBjdXN0b20gdGhlbWUgSFRNTCxcblx0ICAgIC8vIHdlIHdpbGwgdXNlIGFueSBleGlzdGluZyBlbGVtZW50cyBpZiBubyBpZD1cInF1bml0XCIgZWxlbWVudCBleGlzdHMuXG5cdCAgICAvL1xuXHQgICAgLy8gTm90ZSB0aGF0IHdlIGRvbid0IGZhaWwgb3IgZmFsbGJhY2sgdG8gY3JlYXRpbmcgaXQgb3Vyc2VsdmVzLFxuXHQgICAgLy8gYmVjYXVzZSBub3QgaGF2aW5nIGlkPVwicXVuaXRcIiAoYW5kIG5vdCBoYXZpbmcgdGhlIGJlbG93IGVsZW1lbnRzKVxuXHQgICAgLy8gc2ltcGx5IG1lYW5zIFFVbml0IGFjdHMgaGVhZGxlc3MsIGFsbG93aW5nIHVzZXJzIHRvIHVzZSB0aGVpciBvd25cblx0ICAgIC8vIHJlcG9ydGVycywgb3IgZm9yIGEgdGVzdCBydW5uZXIgdG8gbGlzdGVuIGZvciBldmVudHMgZGlyZWN0bHkgd2l0aG91dFxuXHQgICAgLy8gaGF2aW5nIHRoZSBIVE1MIHJlcG9ydGVyIGFjdGl2ZWx5IHJlbmRlciBhbnl0aGluZy5cblxuXHQgICAgaWYgKHF1bml0KSB7XG5cdCAgICAgIC8vIFNpbmNlIFFVbml0IDEuMywgdGhlc2UgYXJlIGNyZWF0ZWQgYXV0b21hdGljYWxseSBpZiB0aGUgcGFnZVxuXHQgICAgICAvLyBjb250YWlucyBpZD1cInF1bml0XCIuXG5cdCAgICAgIHF1bml0LmlubmVySFRNTCA9IFwiPGgxIGlkPSdxdW5pdC1oZWFkZXInPlwiICsgZXNjYXBlVGV4dChkb2N1bWVudC50aXRsZSkgKyBcIjwvaDE+XCIgKyBcIjxoMiBpZD0ncXVuaXQtYmFubmVyJz48L2gyPlwiICsgXCI8ZGl2IGlkPSdxdW5pdC10ZXN0cnVubmVyLXRvb2xiYXInPjwvZGl2PlwiICsgYXBwZW5kRmlsdGVyZWRUZXN0KCkgKyBcIjxoMiBpZD0ncXVuaXQtdXNlckFnZW50Jz48L2gyPlwiICsgXCI8b2wgaWQ9J3F1bml0LXRlc3RzJz48L29sPlwiO1xuXHQgICAgfVxuXG5cdCAgICBhcHBlbmRIZWFkZXIoKTtcblx0ICAgIGFwcGVuZEJhbm5lcigpO1xuXHQgICAgYXBwZW5kVGVzdFJlc3VsdHMoKTtcblx0ICAgIGFwcGVuZFVzZXJBZ2VudCgpO1xuXHQgICAgYXBwZW5kVG9vbGJhcigpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZFRlc3QobmFtZSwgdGVzdElkLCBtb2R1bGVOYW1lKSB7XG5cdCAgICB2YXIgdGl0bGUsXG5cdCAgICAgICAgcmVydW5UcmlnZ2VyLFxuXHQgICAgICAgIHRlc3RCbG9jayxcblx0ICAgICAgICBhc3NlcnRMaXN0LFxuXHQgICAgICAgIHRlc3RzID0gaWQoXCJxdW5pdC10ZXN0c1wiKTtcblxuXHQgICAgaWYgKCF0ZXN0cykge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cblx0ICAgIHRpdGxlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0cm9uZ1wiKTtcblx0ICAgIHRpdGxlLmlubmVySFRNTCA9IGdldE5hbWVIdG1sKG5hbWUsIG1vZHVsZU5hbWUpO1xuXHQgICAgcmVydW5UcmlnZ2VyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImFcIik7XG5cdCAgICByZXJ1blRyaWdnZXIuaW5uZXJIVE1MID0gXCJSZXJ1blwiO1xuXHQgICAgcmVydW5UcmlnZ2VyLmhyZWYgPSBzZXRVcmwoe1xuXHQgICAgICB0ZXN0SWQ6IHRlc3RJZFxuXHQgICAgfSk7XG5cdCAgICB0ZXN0QmxvY2sgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG5cdCAgICB0ZXN0QmxvY2suYXBwZW5kQ2hpbGQodGl0bGUpO1xuXHQgICAgdGVzdEJsb2NrLmFwcGVuZENoaWxkKHJlcnVuVHJpZ2dlcik7XG5cdCAgICB0ZXN0QmxvY2suaWQgPSBcInF1bml0LXRlc3Qtb3V0cHV0LVwiICsgdGVzdElkO1xuXHQgICAgYXNzZXJ0TGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJvbFwiKTtcblx0ICAgIGFzc2VydExpc3QuY2xhc3NOYW1lID0gXCJxdW5pdC1hc3NlcnQtbGlzdFwiO1xuXHQgICAgdGVzdEJsb2NrLmFwcGVuZENoaWxkKGFzc2VydExpc3QpO1xuXHQgICAgdGVzdHMuYXBwZW5kQ2hpbGQodGVzdEJsb2NrKTtcblx0ICB9IC8vIEhUTUwgUmVwb3J0ZXIgaW5pdGlhbGl6YXRpb24gYW5kIGxvYWRcblxuXG5cdCAgUVVuaXQuYmVnaW4oZnVuY3Rpb24gKGRldGFpbHMpIHtcblx0ICAgIHZhciBpLCBtb2R1bGVPYmo7IC8vIFNvcnQgbW9kdWxlcyBieSBuYW1lIGZvciB0aGUgcGlja2VyXG5cblx0ICAgIGZvciAoaSA9IDA7IGkgPCBkZXRhaWxzLm1vZHVsZXMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgbW9kdWxlT2JqID0gZGV0YWlscy5tb2R1bGVzW2ldO1xuXG5cdCAgICAgIGlmIChtb2R1bGVPYmoubmFtZSkge1xuXHQgICAgICAgIG1vZHVsZXNMaXN0LnB1c2gobW9kdWxlT2JqLm5hbWUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIG1vZHVsZXNMaXN0LnNvcnQoZnVuY3Rpb24gKGEsIGIpIHtcblx0ICAgICAgcmV0dXJuIGEubG9jYWxlQ29tcGFyZShiKTtcblx0ICAgIH0pOyAvLyBJbml0aWFsaXplIFFVbml0IGVsZW1lbnRzXG5cblx0ICAgIGFwcGVuZEludGVyZmFjZSgpO1xuXHQgIH0pO1xuXHQgIFFVbml0LmRvbmUoZnVuY3Rpb24gKGRldGFpbHMpIHtcblx0ICAgIHZhciBiYW5uZXIgPSBpZChcInF1bml0LWJhbm5lclwiKSxcblx0ICAgICAgICB0ZXN0cyA9IGlkKFwicXVuaXQtdGVzdHNcIiksXG5cdCAgICAgICAgYWJvcnRCdXR0b24gPSBpZChcInF1bml0LWFib3J0LXRlc3RzLWJ1dHRvblwiKSxcblx0ICAgICAgICB0b3RhbFRlc3RzID0gc3RhdHMucGFzc2VkVGVzdHMgKyBzdGF0cy5za2lwcGVkVGVzdHMgKyBzdGF0cy50b2RvVGVzdHMgKyBzdGF0cy5mYWlsZWRUZXN0cyxcblx0ICAgICAgICBodG1sID0gW3RvdGFsVGVzdHMsIFwiIHRlc3RzIGNvbXBsZXRlZCBpbiBcIiwgZGV0YWlscy5ydW50aW1lLCBcIiBtaWxsaXNlY29uZHMsIHdpdGggXCIsIHN0YXRzLmZhaWxlZFRlc3RzLCBcIiBmYWlsZWQsIFwiLCBzdGF0cy5za2lwcGVkVGVzdHMsIFwiIHNraXBwZWQsIGFuZCBcIiwgc3RhdHMudG9kb1Rlc3RzLCBcIiB0b2RvLjxiciAvPlwiLCBcIjxzcGFuIGNsYXNzPSdwYXNzZWQnPlwiLCBkZXRhaWxzLnBhc3NlZCwgXCI8L3NwYW4+IGFzc2VydGlvbnMgb2YgPHNwYW4gY2xhc3M9J3RvdGFsJz5cIiwgZGV0YWlscy50b3RhbCwgXCI8L3NwYW4+IHBhc3NlZCwgPHNwYW4gY2xhc3M9J2ZhaWxlZCc+XCIsIGRldGFpbHMuZmFpbGVkLCBcIjwvc3Bhbj4gZmFpbGVkLlwiXS5qb2luKFwiXCIpLFxuXHQgICAgICAgIHRlc3QsXG5cdCAgICAgICAgYXNzZXJ0TGksXG5cdCAgICAgICAgYXNzZXJ0TGlzdDsgLy8gVXBkYXRlIHJlbWFpbmluZyB0ZXN0cyB0byBhYm9ydGVkXG5cblx0ICAgIGlmIChhYm9ydEJ1dHRvbiAmJiBhYm9ydEJ1dHRvbi5kaXNhYmxlZCkge1xuXHQgICAgICBodG1sID0gXCJUZXN0cyBhYm9ydGVkIGFmdGVyIFwiICsgZGV0YWlscy5ydW50aW1lICsgXCIgbWlsbGlzZWNvbmRzLlwiO1xuXG5cdCAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgdGVzdHMuY2hpbGRyZW4ubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICB0ZXN0ID0gdGVzdHMuY2hpbGRyZW5baV07XG5cblx0ICAgICAgICBpZiAodGVzdC5jbGFzc05hbWUgPT09IFwiXCIgfHwgdGVzdC5jbGFzc05hbWUgPT09IFwicnVubmluZ1wiKSB7XG5cdCAgICAgICAgICB0ZXN0LmNsYXNzTmFtZSA9IFwiYWJvcnRlZFwiO1xuXHQgICAgICAgICAgYXNzZXJ0TGlzdCA9IHRlc3QuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJvbFwiKVswXTtcblx0ICAgICAgICAgIGFzc2VydExpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuXHQgICAgICAgICAgYXNzZXJ0TGkuY2xhc3NOYW1lID0gXCJmYWlsXCI7XG5cdCAgICAgICAgICBhc3NlcnRMaS5pbm5lckhUTUwgPSBcIlRlc3QgYWJvcnRlZC5cIjtcblx0ICAgICAgICAgIGFzc2VydExpc3QuYXBwZW5kQ2hpbGQoYXNzZXJ0TGkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBpZiAoYmFubmVyICYmICghYWJvcnRCdXR0b24gfHwgYWJvcnRCdXR0b24uZGlzYWJsZWQgPT09IGZhbHNlKSkge1xuXHQgICAgICBiYW5uZXIuY2xhc3NOYW1lID0gc3RhdHMuZmFpbGVkVGVzdHMgPyBcInF1bml0LWZhaWxcIiA6IFwicXVuaXQtcGFzc1wiO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoYWJvcnRCdXR0b24pIHtcblx0ICAgICAgYWJvcnRCdXR0b24ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChhYm9ydEJ1dHRvbik7XG5cdCAgICB9XG5cblx0ICAgIGlmICh0ZXN0cykge1xuXHQgICAgICBpZChcInF1bml0LXRlc3RyZXN1bHQtZGlzcGxheVwiKS5pbm5lckhUTUwgPSBodG1sO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29uZmlnLmFsdGVydGl0bGUgJiYgZG9jdW1lbnQudGl0bGUpIHtcblx0ICAgICAgLy8gU2hvdyDinJYgZm9yIGdvb2QsIOKclCBmb3IgYmFkIHN1aXRlIHJlc3VsdCBpbiB0aXRsZVxuXHQgICAgICAvLyB1c2UgZXNjYXBlIHNlcXVlbmNlcyBpbiBjYXNlIGZpbGUgZ2V0cyBsb2FkZWQgd2l0aCBub24tdXRmLThcblx0ICAgICAgLy8gY2hhcnNldFxuXHQgICAgICBkb2N1bWVudC50aXRsZSA9IFtzdGF0cy5mYWlsZWRUZXN0cyA/IFwiXFx1MjcxNlwiIDogXCJcXHUyNzE0XCIsIGRvY3VtZW50LnRpdGxlLnJlcGxhY2UoL15bXFx1MjcxNFxcdTI3MTZdIC9pLCBcIlwiKV0uam9pbihcIiBcIik7XG5cdCAgICB9IC8vIFNjcm9sbCBiYWNrIHRvIHRvcCB0byBzaG93IHJlc3VsdHNcblxuXG5cdCAgICBpZiAoY29uZmlnLnNjcm9sbHRvcCAmJiB3aW5kb3ckMS5zY3JvbGxUbykge1xuXHQgICAgICB3aW5kb3ckMS5zY3JvbGxUbygwLCAwKTtcblx0ICAgIH1cblx0ICB9KTtcblxuXHQgIGZ1bmN0aW9uIGdldE5hbWVIdG1sKG5hbWUsIG1vZHVsZSkge1xuXHQgICAgdmFyIG5hbWVIdG1sID0gXCJcIjtcblxuXHQgICAgaWYgKG1vZHVsZSkge1xuXHQgICAgICBuYW1lSHRtbCA9IFwiPHNwYW4gY2xhc3M9J21vZHVsZS1uYW1lJz5cIiArIGVzY2FwZVRleHQobW9kdWxlKSArIFwiPC9zcGFuPjogXCI7XG5cdCAgICB9XG5cblx0ICAgIG5hbWVIdG1sICs9IFwiPHNwYW4gY2xhc3M9J3Rlc3QtbmFtZSc+XCIgKyBlc2NhcGVUZXh0KG5hbWUpICsgXCI8L3NwYW4+XCI7XG5cdCAgICByZXR1cm4gbmFtZUh0bWw7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gZ2V0UHJvZ3Jlc3NIdG1sKHJ1bnRpbWUsIHN0YXRzLCB0b3RhbCkge1xuXHQgICAgdmFyIGNvbXBsZXRlZCA9IHN0YXRzLnBhc3NlZFRlc3RzICsgc3RhdHMuc2tpcHBlZFRlc3RzICsgc3RhdHMudG9kb1Rlc3RzICsgc3RhdHMuZmFpbGVkVGVzdHM7XG5cdCAgICByZXR1cm4gW1wiPGJyIC8+XCIsIGNvbXBsZXRlZCwgXCIgLyBcIiwgdG90YWwsIFwiIHRlc3RzIGNvbXBsZXRlZCBpbiBcIiwgcnVudGltZSwgXCIgbWlsbGlzZWNvbmRzLCB3aXRoIFwiLCBzdGF0cy5mYWlsZWRUZXN0cywgXCIgZmFpbGVkLCBcIiwgc3RhdHMuc2tpcHBlZFRlc3RzLCBcIiBza2lwcGVkLCBhbmQgXCIsIHN0YXRzLnRvZG9UZXN0cywgXCIgdG9kby5cIl0uam9pbihcIlwiKTtcblx0ICB9XG5cblx0ICBRVW5pdC50ZXN0U3RhcnQoZnVuY3Rpb24gKGRldGFpbHMpIHtcblx0ICAgIHZhciBydW5uaW5nLCBiYWQ7XG5cdCAgICBhcHBlbmRUZXN0KGRldGFpbHMubmFtZSwgZGV0YWlscy50ZXN0SWQsIGRldGFpbHMubW9kdWxlKTtcblx0ICAgIHJ1bm5pbmcgPSBpZChcInF1bml0LXRlc3RyZXN1bHQtZGlzcGxheVwiKTtcblxuXHQgICAgaWYgKHJ1bm5pbmcpIHtcblx0ICAgICAgYWRkQ2xhc3MocnVubmluZywgXCJydW5uaW5nXCIpO1xuXHQgICAgICBiYWQgPSBRVW5pdC5jb25maWcucmVvcmRlciAmJiBkZXRhaWxzLnByZXZpb3VzRmFpbHVyZTtcblx0ICAgICAgcnVubmluZy5pbm5lckhUTUwgPSBbYmFkID8gXCJSZXJ1bm5pbmcgcHJldmlvdXNseSBmYWlsZWQgdGVzdDogPGJyIC8+XCIgOiBcIlJ1bm5pbmc6IDxiciAvPlwiLCBnZXROYW1lSHRtbChkZXRhaWxzLm5hbWUsIGRldGFpbHMubW9kdWxlKSwgZ2V0UHJvZ3Jlc3NIdG1sKG5vdygpIC0gY29uZmlnLnN0YXJ0ZWQsIHN0YXRzLCBUZXN0LmNvdW50KV0uam9pbihcIlwiKTtcblx0ICAgIH1cblx0ICB9KTtcblxuXHQgIGZ1bmN0aW9uIHN0cmlwSHRtbChzdHJpbmcpIHtcblx0ICAgIC8vIFN0cmlwIHRhZ3MsIGh0bWwgZW50aXR5IGFuZCB3aGl0ZXNwYWNlc1xuXHQgICAgcmV0dXJuIHN0cmluZy5yZXBsYWNlKC88XFwvP1tePl0rKD58JCkvZywgXCJcIikucmVwbGFjZSgvJnF1b3Q7L2csIFwiXCIpLnJlcGxhY2UoL1xccysvZywgXCJcIik7XG5cdCAgfVxuXG5cdCAgUVVuaXQubG9nKGZ1bmN0aW9uIChkZXRhaWxzKSB7XG5cdCAgICB2YXIgYXNzZXJ0TGlzdCxcblx0ICAgICAgICBhc3NlcnRMaSxcblx0ICAgICAgICBtZXNzYWdlLFxuXHQgICAgICAgIGV4cGVjdGVkLFxuXHQgICAgICAgIGFjdHVhbCxcblx0ICAgICAgICBkaWZmLFxuXHQgICAgICAgIHNob3dEaWZmID0gZmFsc2UsXG5cdCAgICAgICAgdGVzdEl0ZW0gPSBpZChcInF1bml0LXRlc3Qtb3V0cHV0LVwiICsgZGV0YWlscy50ZXN0SWQpO1xuXG5cdCAgICBpZiAoIXRlc3RJdGVtKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgbWVzc2FnZSA9IGVzY2FwZVRleHQoZGV0YWlscy5tZXNzYWdlKSB8fCAoZGV0YWlscy5yZXN1bHQgPyBcIm9rYXlcIiA6IFwiZmFpbGVkXCIpO1xuXHQgICAgbWVzc2FnZSA9IFwiPHNwYW4gY2xhc3M9J3Rlc3QtbWVzc2FnZSc+XCIgKyBtZXNzYWdlICsgXCI8L3NwYW4+XCI7XG5cdCAgICBtZXNzYWdlICs9IFwiPHNwYW4gY2xhc3M9J3J1bnRpbWUnPkAgXCIgKyBkZXRhaWxzLnJ1bnRpbWUgKyBcIiBtczwvc3Bhbj5cIjsgLy8gVGhlIHB1c2hGYWlsdXJlIGRvZXNuJ3QgcHJvdmlkZSBkZXRhaWxzLmV4cGVjdGVkXG5cdCAgICAvLyB3aGVuIGl0IGNhbGxzLCBpdCdzIGltcGxpY2l0IHRvIGFsc28gbm90IHNob3cgZXhwZWN0ZWQgYW5kIGRpZmYgc3R1ZmZcblx0ICAgIC8vIEFsc28sIHdlIG5lZWQgdG8gY2hlY2sgZGV0YWlscy5leHBlY3RlZCBleGlzdGVuY2UsIGFzIGl0IGNhbiBleGlzdCBhbmQgYmUgdW5kZWZpbmVkXG5cblx0ICAgIGlmICghZGV0YWlscy5yZXN1bHQgJiYgaGFzT3duLmNhbGwoZGV0YWlscywgXCJleHBlY3RlZFwiKSkge1xuXHQgICAgICBpZiAoZGV0YWlscy5uZWdhdGl2ZSkge1xuXHQgICAgICAgIGV4cGVjdGVkID0gXCJOT1QgXCIgKyBRVW5pdC5kdW1wLnBhcnNlKGRldGFpbHMuZXhwZWN0ZWQpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGV4cGVjdGVkID0gUVVuaXQuZHVtcC5wYXJzZShkZXRhaWxzLmV4cGVjdGVkKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGFjdHVhbCA9IFFVbml0LmR1bXAucGFyc2UoZGV0YWlscy5hY3R1YWwpO1xuXHQgICAgICBtZXNzYWdlICs9IFwiPHRhYmxlPjx0ciBjbGFzcz0ndGVzdC1leHBlY3RlZCc+PHRoPkV4cGVjdGVkOiA8L3RoPjx0ZD48cHJlPlwiICsgZXNjYXBlVGV4dChleHBlY3RlZCkgKyBcIjwvcHJlPjwvdGQ+PC90cj5cIjtcblxuXHQgICAgICBpZiAoYWN0dWFsICE9PSBleHBlY3RlZCkge1xuXHQgICAgICAgIG1lc3NhZ2UgKz0gXCI8dHIgY2xhc3M9J3Rlc3QtYWN0dWFsJz48dGg+UmVzdWx0OiA8L3RoPjx0ZD48cHJlPlwiICsgZXNjYXBlVGV4dChhY3R1YWwpICsgXCI8L3ByZT48L3RkPjwvdHI+XCI7XG5cblx0ICAgICAgICBpZiAodHlwZW9mIGRldGFpbHMuYWN0dWFsID09PSBcIm51bWJlclwiICYmIHR5cGVvZiBkZXRhaWxzLmV4cGVjdGVkID09PSBcIm51bWJlclwiKSB7XG5cdCAgICAgICAgICBpZiAoIWlzTmFOKGRldGFpbHMuYWN0dWFsKSAmJiAhaXNOYU4oZGV0YWlscy5leHBlY3RlZCkpIHtcblx0ICAgICAgICAgICAgc2hvd0RpZmYgPSB0cnVlO1xuXHQgICAgICAgICAgICBkaWZmID0gZGV0YWlscy5hY3R1YWwgLSBkZXRhaWxzLmV4cGVjdGVkO1xuXHQgICAgICAgICAgICBkaWZmID0gKGRpZmYgPiAwID8gXCIrXCIgOiBcIlwiKSArIGRpZmY7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGV0YWlscy5hY3R1YWwgIT09IFwiYm9vbGVhblwiICYmIHR5cGVvZiBkZXRhaWxzLmV4cGVjdGVkICE9PSBcImJvb2xlYW5cIikge1xuXHQgICAgICAgICAgZGlmZiA9IFFVbml0LmRpZmYoZXhwZWN0ZWQsIGFjdHVhbCk7IC8vIGRvbid0IHNob3cgZGlmZiBpZiB0aGVyZSBpcyB6ZXJvIG92ZXJsYXBcblxuXHQgICAgICAgICAgc2hvd0RpZmYgPSBzdHJpcEh0bWwoZGlmZikubGVuZ3RoICE9PSBzdHJpcEh0bWwoZXhwZWN0ZWQpLmxlbmd0aCArIHN0cmlwSHRtbChhY3R1YWwpLmxlbmd0aDtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAoc2hvd0RpZmYpIHtcblx0ICAgICAgICAgIG1lc3NhZ2UgKz0gXCI8dHIgY2xhc3M9J3Rlc3QtZGlmZic+PHRoPkRpZmY6IDwvdGg+PHRkPjxwcmU+XCIgKyBkaWZmICsgXCI8L3ByZT48L3RkPjwvdHI+XCI7XG5cdCAgICAgICAgfVxuXHQgICAgICB9IGVsc2UgaWYgKGV4cGVjdGVkLmluZGV4T2YoXCJbb2JqZWN0IEFycmF5XVwiKSAhPT0gLTEgfHwgZXhwZWN0ZWQuaW5kZXhPZihcIltvYmplY3QgT2JqZWN0XVwiKSAhPT0gLTEpIHtcblx0ICAgICAgICBtZXNzYWdlICs9IFwiPHRyIGNsYXNzPSd0ZXN0LW1lc3NhZ2UnPjx0aD5NZXNzYWdlOiA8L3RoPjx0ZD5cIiArIFwiRGlmZiBzdXBwcmVzc2VkIGFzIHRoZSBkZXB0aCBvZiBvYmplY3QgaXMgbW9yZSB0aGFuIGN1cnJlbnQgbWF4IGRlcHRoIChcIiArIFFVbml0LmNvbmZpZy5tYXhEZXB0aCArIFwiKS48cD5IaW50OiBVc2UgPGNvZGU+UVVuaXQuZHVtcC5tYXhEZXB0aDwvY29kZT4gdG8gXCIgKyBcIiBydW4gd2l0aCBhIGhpZ2hlciBtYXggZGVwdGggb3IgPGEgaHJlZj0nXCIgKyBlc2NhcGVUZXh0KHNldFVybCh7XG5cdCAgICAgICAgICBtYXhEZXB0aDogLTFcblx0ICAgICAgICB9KSkgKyBcIic+XCIgKyBcIlJlcnVuPC9hPiB3aXRob3V0IG1heCBkZXB0aC48L3A+PC90ZD48L3RyPlwiO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIG1lc3NhZ2UgKz0gXCI8dHIgY2xhc3M9J3Rlc3QtbWVzc2FnZSc+PHRoPk1lc3NhZ2U6IDwvdGg+PHRkPlwiICsgXCJEaWZmIHN1cHByZXNzZWQgYXMgdGhlIGV4cGVjdGVkIGFuZCBhY3R1YWwgcmVzdWx0cyBoYXZlIGFuIGVxdWl2YWxlbnRcIiArIFwiIHNlcmlhbGl6YXRpb248L3RkPjwvdHI+XCI7XG5cdCAgICAgIH1cblxuXHQgICAgICBpZiAoZGV0YWlscy5zb3VyY2UpIHtcblx0ICAgICAgICBtZXNzYWdlICs9IFwiPHRyIGNsYXNzPSd0ZXN0LXNvdXJjZSc+PHRoPlNvdXJjZTogPC90aD48dGQ+PHByZT5cIiArIGVzY2FwZVRleHQoZGV0YWlscy5zb3VyY2UpICsgXCI8L3ByZT48L3RkPjwvdHI+XCI7XG5cdCAgICAgIH1cblxuXHQgICAgICBtZXNzYWdlICs9IFwiPC90YWJsZT5cIjsgLy8gVGhpcyBvY2N1cnMgd2hlbiBwdXNoRmFpbHVyZSBpcyBzZXQgYW5kIHdlIGhhdmUgYW4gZXh0cmFjdGVkIHN0YWNrIHRyYWNlXG5cdCAgICB9IGVsc2UgaWYgKCFkZXRhaWxzLnJlc3VsdCAmJiBkZXRhaWxzLnNvdXJjZSkge1xuXHQgICAgICBtZXNzYWdlICs9IFwiPHRhYmxlPlwiICsgXCI8dHIgY2xhc3M9J3Rlc3Qtc291cmNlJz48dGg+U291cmNlOiA8L3RoPjx0ZD48cHJlPlwiICsgZXNjYXBlVGV4dChkZXRhaWxzLnNvdXJjZSkgKyBcIjwvcHJlPjwvdGQ+PC90cj5cIiArIFwiPC90YWJsZT5cIjtcblx0ICAgIH1cblxuXHQgICAgYXNzZXJ0TGlzdCA9IHRlc3RJdGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKFwib2xcIilbMF07XG5cdCAgICBhc3NlcnRMaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcblx0ICAgIGFzc2VydExpLmNsYXNzTmFtZSA9IGRldGFpbHMucmVzdWx0ID8gXCJwYXNzXCIgOiBcImZhaWxcIjtcblx0ICAgIGFzc2VydExpLmlubmVySFRNTCA9IG1lc3NhZ2U7XG5cdCAgICBhc3NlcnRMaXN0LmFwcGVuZENoaWxkKGFzc2VydExpKTtcblx0ICB9KTtcblx0ICBRVW5pdC50ZXN0RG9uZShmdW5jdGlvbiAoZGV0YWlscykge1xuXHQgICAgdmFyIHRlc3RUaXRsZSxcblx0ICAgICAgICB0aW1lLFxuXHQgICAgICAgIHRlc3RJdGVtLFxuXHQgICAgICAgIGFzc2VydExpc3QsXG5cdCAgICAgICAgc3RhdHVzLFxuXHQgICAgICAgIGdvb2QsXG5cdCAgICAgICAgYmFkLFxuXHQgICAgICAgIHRlc3RDb3VudHMsXG5cdCAgICAgICAgc2tpcHBlZCxcblx0ICAgICAgICBzb3VyY2VOYW1lLFxuXHQgICAgICAgIHRlc3RzID0gaWQoXCJxdW5pdC10ZXN0c1wiKTtcblxuXHQgICAgaWYgKCF0ZXN0cykge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cblx0ICAgIHRlc3RJdGVtID0gaWQoXCJxdW5pdC10ZXN0LW91dHB1dC1cIiArIGRldGFpbHMudGVzdElkKTtcblx0ICAgIHJlbW92ZUNsYXNzKHRlc3RJdGVtLCBcInJ1bm5pbmdcIik7XG5cblx0ICAgIGlmIChkZXRhaWxzLmZhaWxlZCA+IDApIHtcblx0ICAgICAgc3RhdHVzID0gXCJmYWlsZWRcIjtcblx0ICAgIH0gZWxzZSBpZiAoZGV0YWlscy50b2RvKSB7XG5cdCAgICAgIHN0YXR1cyA9IFwidG9kb1wiO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc3RhdHVzID0gZGV0YWlscy5za2lwcGVkID8gXCJza2lwcGVkXCIgOiBcInBhc3NlZFwiO1xuXHQgICAgfVxuXG5cdCAgICBhc3NlcnRMaXN0ID0gdGVzdEl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJvbFwiKVswXTtcblx0ICAgIGdvb2QgPSBkZXRhaWxzLnBhc3NlZDtcblx0ICAgIGJhZCA9IGRldGFpbHMuZmFpbGVkOyAvLyBUaGlzIHRlc3QgcGFzc2VkIGlmIGl0IGhhcyBubyB1bmV4cGVjdGVkIGZhaWxlZCBhc3NlcnRpb25zXG5cblx0ICAgIHZhciB0ZXN0UGFzc2VkID0gZGV0YWlscy5mYWlsZWQgPiAwID8gZGV0YWlscy50b2RvIDogIWRldGFpbHMudG9kbztcblxuXHQgICAgaWYgKHRlc3RQYXNzZWQpIHtcblx0ICAgICAgLy8gQ29sbGFwc2UgdGhlIHBhc3NpbmcgdGVzdHNcblx0ICAgICAgYWRkQ2xhc3MoYXNzZXJ0TGlzdCwgXCJxdW5pdC1jb2xsYXBzZWRcIik7XG5cdCAgICB9IGVsc2UgaWYgKGNvbmZpZy5jb2xsYXBzZSkge1xuXHQgICAgICBpZiAoIWNvbGxhcHNlTmV4dCkge1xuXHQgICAgICAgIC8vIFNraXAgY29sbGFwc2luZyB0aGUgZmlyc3QgZmFpbGluZyB0ZXN0XG5cdCAgICAgICAgY29sbGFwc2VOZXh0ID0gdHJ1ZTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAvLyBDb2xsYXBzZSByZW1haW5pbmcgdGVzdHNcblx0ICAgICAgICBhZGRDbGFzcyhhc3NlcnRMaXN0LCBcInF1bml0LWNvbGxhcHNlZFwiKTtcblx0ICAgICAgfVxuXHQgICAgfSAvLyBUaGUgdGVzdEl0ZW0uZmlyc3RDaGlsZCBpcyB0aGUgdGVzdCBuYW1lXG5cblxuXHQgICAgdGVzdFRpdGxlID0gdGVzdEl0ZW0uZmlyc3RDaGlsZDtcblx0ICAgIHRlc3RDb3VudHMgPSBiYWQgPyBcIjxiIGNsYXNzPSdmYWlsZWQnPlwiICsgYmFkICsgXCI8L2I+LCBcIiArIFwiPGIgY2xhc3M9J3Bhc3NlZCc+XCIgKyBnb29kICsgXCI8L2I+LCBcIiA6IFwiXCI7XG5cdCAgICB0ZXN0VGl0bGUuaW5uZXJIVE1MICs9IFwiIDxiIGNsYXNzPSdjb3VudHMnPihcIiArIHRlc3RDb3VudHMgKyBkZXRhaWxzLmFzc2VydGlvbnMubGVuZ3RoICsgXCIpPC9iPlwiO1xuXG5cdCAgICBpZiAoZGV0YWlscy5za2lwcGVkKSB7XG5cdCAgICAgIHN0YXRzLnNraXBwZWRUZXN0cysrO1xuXHQgICAgICB0ZXN0SXRlbS5jbGFzc05hbWUgPSBcInNraXBwZWRcIjtcblx0ICAgICAgc2tpcHBlZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJlbVwiKTtcblx0ICAgICAgc2tpcHBlZC5jbGFzc05hbWUgPSBcInF1bml0LXNraXBwZWQtbGFiZWxcIjtcblx0ICAgICAgc2tpcHBlZC5pbm5lckhUTUwgPSBcInNraXBwZWRcIjtcblx0ICAgICAgdGVzdEl0ZW0uaW5zZXJ0QmVmb3JlKHNraXBwZWQsIHRlc3RUaXRsZSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBhZGRFdmVudCh0ZXN0VGl0bGUsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRvZ2dsZUNsYXNzKGFzc2VydExpc3QsIFwicXVuaXQtY29sbGFwc2VkXCIpO1xuXHQgICAgICB9KTtcblx0ICAgICAgdGVzdEl0ZW0uY2xhc3NOYW1lID0gdGVzdFBhc3NlZCA/IFwicGFzc1wiIDogXCJmYWlsXCI7XG5cblx0ICAgICAgaWYgKGRldGFpbHMudG9kbykge1xuXHQgICAgICAgIHZhciB0b2RvTGFiZWwgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZW1cIik7XG5cdCAgICAgICAgdG9kb0xhYmVsLmNsYXNzTmFtZSA9IFwicXVuaXQtdG9kby1sYWJlbFwiO1xuXHQgICAgICAgIHRvZG9MYWJlbC5pbm5lckhUTUwgPSBcInRvZG9cIjtcblx0ICAgICAgICB0ZXN0SXRlbS5jbGFzc05hbWUgKz0gXCIgdG9kb1wiO1xuXHQgICAgICAgIHRlc3RJdGVtLmluc2VydEJlZm9yZSh0b2RvTGFiZWwsIHRlc3RUaXRsZSk7XG5cdCAgICAgIH1cblxuXHQgICAgICB0aW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIik7XG5cdCAgICAgIHRpbWUuY2xhc3NOYW1lID0gXCJydW50aW1lXCI7XG5cdCAgICAgIHRpbWUuaW5uZXJIVE1MID0gZGV0YWlscy5ydW50aW1lICsgXCIgbXNcIjtcblx0ICAgICAgdGVzdEl0ZW0uaW5zZXJ0QmVmb3JlKHRpbWUsIGFzc2VydExpc3QpO1xuXG5cdCAgICAgIGlmICghdGVzdFBhc3NlZCkge1xuXHQgICAgICAgIHN0YXRzLmZhaWxlZFRlc3RzKys7XG5cdCAgICAgIH0gZWxzZSBpZiAoZGV0YWlscy50b2RvKSB7XG5cdCAgICAgICAgc3RhdHMudG9kb1Rlc3RzKys7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3RhdHMucGFzc2VkVGVzdHMrKztcblx0ICAgICAgfVxuXHQgICAgfSAvLyBTaG93IHRoZSBzb3VyY2Ugb2YgdGhlIHRlc3Qgd2hlbiBzaG93aW5nIGFzc2VydGlvbnNcblxuXG5cdCAgICBpZiAoZGV0YWlscy5zb3VyY2UpIHtcblx0ICAgICAgc291cmNlTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXHQgICAgICBzb3VyY2VOYW1lLmlubmVySFRNTCA9IFwiPHN0cm9uZz5Tb3VyY2U6IDwvc3Ryb25nPlwiICsgZXNjYXBlVGV4dChkZXRhaWxzLnNvdXJjZSk7XG5cdCAgICAgIGFkZENsYXNzKHNvdXJjZU5hbWUsIFwicXVuaXQtc291cmNlXCIpO1xuXG5cdCAgICAgIGlmICh0ZXN0UGFzc2VkKSB7XG5cdCAgICAgICAgYWRkQ2xhc3Moc291cmNlTmFtZSwgXCJxdW5pdC1jb2xsYXBzZWRcIik7XG5cdCAgICAgIH1cblxuXHQgICAgICBhZGRFdmVudCh0ZXN0VGl0bGUsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRvZ2dsZUNsYXNzKHNvdXJjZU5hbWUsIFwicXVuaXQtY29sbGFwc2VkXCIpO1xuXHQgICAgICB9KTtcblx0ICAgICAgdGVzdEl0ZW0uYXBwZW5kQ2hpbGQoc291cmNlTmFtZSk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcuaGlkZXBhc3NlZCAmJiAoc3RhdHVzID09PSBcInBhc3NlZFwiIHx8IGRldGFpbHMuc2tpcHBlZCkpIHtcblx0ICAgICAgLy8gdXNlIHJlbW92ZUNoaWxkIGluc3RlYWQgb2YgcmVtb3ZlIGJlY2F1c2Ugb2Ygc3VwcG9ydFxuXHQgICAgICBoaWRkZW5UZXN0cy5wdXNoKHRlc3RJdGVtKTtcblx0ICAgICAgdGVzdHMucmVtb3ZlQ2hpbGQodGVzdEl0ZW0pO1xuXHQgICAgfVxuXHQgIH0pOyAvLyBBdm9pZCByZWFkeVN0YXRlIGlzc3VlIHdpdGggcGhhbnRvbWpzXG5cdCAgLy8gUmVmOiAjODE4XG5cblx0ICB2YXIgbm90UGhhbnRvbSA9IGZ1bmN0aW9uIChwKSB7XG5cdCAgICByZXR1cm4gIShwICYmIHAudmVyc2lvbiAmJiBwLnZlcnNpb24ubWFqb3IgPiAwKTtcblx0ICB9KHdpbmRvdyQxLnBoYW50b20pO1xuXG5cdCAgaWYgKG5vdFBoYW50b20gJiYgZG9jdW1lbnQucmVhZHlTdGF0ZSA9PT0gXCJjb21wbGV0ZVwiKSB7XG5cdCAgICBRVW5pdC5sb2FkKCk7XG5cdCAgfSBlbHNlIHtcblx0ICAgIGFkZEV2ZW50KHdpbmRvdyQxLCBcImxvYWRcIiwgUVVuaXQubG9hZCk7XG5cdCAgfSAvLyBXcmFwIHdpbmRvdy5vbmVycm9yLiBXZSB3aWxsIGNhbGwgdGhlIG9yaWdpbmFsIHdpbmRvdy5vbmVycm9yIHRvIHNlZSBpZlxuXHQgIC8vIHRoZSBleGlzdGluZyBoYW5kbGVyIGZ1bGx5IGhhbmRsZXMgdGhlIGVycm9yOyBpZiBub3QsIHdlIHdpbGwgY2FsbCB0aGVcblx0ICAvLyBRVW5pdC5vbkVycm9yIGZ1bmN0aW9uLlxuXG5cblx0ICB2YXIgb3JpZ2luYWxXaW5kb3dPbkVycm9yID0gd2luZG93JDEub25lcnJvcjsgLy8gQ292ZXIgdW5jYXVnaHQgZXhjZXB0aW9uc1xuXHQgIC8vIFJldHVybmluZyB0cnVlIHdpbGwgc3VwcHJlc3MgdGhlIGRlZmF1bHQgYnJvd3NlciBoYW5kbGVyLFxuXHQgIC8vIHJldHVybmluZyBmYWxzZSB3aWxsIGxldCBpdCBydW4uXG5cblx0ICB3aW5kb3ckMS5vbmVycm9yID0gZnVuY3Rpb24gKG1lc3NhZ2UsIGZpbGVOYW1lLCBsaW5lTnVtYmVyLCBjb2x1bW5OdW1iZXIsIGVycm9yT2JqKSB7XG5cdCAgICB2YXIgcmV0ID0gZmFsc2U7XG5cblx0ICAgIGlmIChvcmlnaW5hbFdpbmRvd09uRXJyb3IpIHtcblx0ICAgICAgZm9yICh2YXIgX2xlbiA9IGFyZ3VtZW50cy5sZW5ndGgsIGFyZ3MgPSBuZXcgQXJyYXkoX2xlbiA+IDUgPyBfbGVuIC0gNSA6IDApLCBfa2V5ID0gNTsgX2tleSA8IF9sZW47IF9rZXkrKykge1xuXHQgICAgICAgIGFyZ3NbX2tleSAtIDVdID0gYXJndW1lbnRzW19rZXldO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0ID0gb3JpZ2luYWxXaW5kb3dPbkVycm9yLmNhbGwuYXBwbHkob3JpZ2luYWxXaW5kb3dPbkVycm9yLCBbdGhpcywgbWVzc2FnZSwgZmlsZU5hbWUsIGxpbmVOdW1iZXIsIGNvbHVtbk51bWJlciwgZXJyb3JPYmpdLmNvbmNhdChhcmdzKSk7XG5cdCAgICB9IC8vIFRyZWF0IHJldHVybiB2YWx1ZSBhcyB3aW5kb3cub25lcnJvciBpdHNlbGYgZG9lcyxcblx0ICAgIC8vIE9ubHkgZG8gb3VyIGhhbmRsaW5nIGlmIG5vdCBzdXBwcmVzc2VkLlxuXG5cblx0ICAgIGlmIChyZXQgIT09IHRydWUpIHtcblx0ICAgICAgdmFyIGVycm9yID0ge1xuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdCAgICAgICAgZmlsZU5hbWU6IGZpbGVOYW1lLFxuXHQgICAgICAgIGxpbmVOdW1iZXI6IGxpbmVOdW1iZXJcblx0ICAgICAgfTsgLy8gQWNjb3JkaW5nIHRvXG5cdCAgICAgIC8vIGh0dHBzOi8vYmxvZy5zZW50cnkuaW8vMjAxNi8wMS8wNC9jbGllbnQtamF2YXNjcmlwdC1yZXBvcnRpbmctd2luZG93LW9uZXJyb3IsXG5cdCAgICAgIC8vIG1vc3QgbW9kZXJuIGJyb3dzZXJzIHN1cHBvcnQgYW4gZXJyb3JPYmogYXJndW1lbnQ7IHVzZSB0aGF0IHRvXG5cdCAgICAgIC8vIGdldCBhIGZ1bGwgc3RhY2sgdHJhY2UgaWYgaXQncyBhdmFpbGFibGUuXG5cblx0ICAgICAgaWYgKGVycm9yT2JqICYmIGVycm9yT2JqLnN0YWNrKSB7XG5cdCAgICAgICAgZXJyb3Iuc3RhY2t0cmFjZSA9IGV4dHJhY3RTdGFja3RyYWNlKGVycm9yT2JqLCAwKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldCA9IFFVbml0Lm9uRXJyb3IoZXJyb3IpO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gcmV0O1xuXHQgIH07IC8vIExpc3RlbiBmb3IgdW5oYW5kbGVkIHJlamVjdGlvbnMsIGFuZCBjYWxsIFFVbml0Lm9uVW5oYW5kbGVkUmVqZWN0aW9uXG5cblxuXHQgIHdpbmRvdyQxLmFkZEV2ZW50TGlzdGVuZXIoXCJ1bmhhbmRsZWRyZWplY3Rpb25cIiwgZnVuY3Rpb24gKGV2ZW50KSB7XG5cdCAgICBRVW5pdC5vblVuaGFuZGxlZFJlamVjdGlvbihldmVudC5yZWFzb24pO1xuXHQgIH0pO1xuXHR9KSgpO1xuXG5cdC8qXG5cdCAqIFRoaXMgZmlsZSBpcyBhIG1vZGlmaWVkIHZlcnNpb24gb2YgZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2gncyBKYXZhU2NyaXB0IGltcGxlbWVudGF0aW9uXG5cdCAqIChodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2dvb2dsZS1kaWZmLW1hdGNoLXBhdGNoL3NvdXJjZS9icm93c2UvdHJ1bmsvamF2YXNjcmlwdC9kaWZmX21hdGNoX3BhdGNoX3VuY29tcHJlc3NlZC5qcyksXG5cdCAqIG1vZGlmaWNhdGlvbnMgYXJlIGxpY2Vuc2VkIGFzIG1vcmUgZnVsbHkgc2V0IGZvcnRoIGluIExJQ0VOU0UudHh0LlxuXHQgKlxuXHQgKiBUaGUgb3JpZ2luYWwgc291cmNlIG9mIGdvb2dsZS1kaWZmLW1hdGNoLXBhdGNoIGlzIGF0dHJpYnV0YWJsZSBhbmQgbGljZW5zZWQgYXMgZm9sbG93czpcblx0ICpcblx0ICogQ29weXJpZ2h0IDIwMDYgR29vZ2xlIEluYy5cblx0ICogaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9nb29nbGUtZGlmZi1tYXRjaC1wYXRjaC9cblx0ICpcblx0ICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcblx0ICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuXHQgKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcblx0ICpcblx0ICogaHR0cHM6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuXHQgKlxuXHQgKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXG5cdCAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcblx0ICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG5cdCAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcblx0ICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG5cdCAqXG5cdCAqIE1vcmUgSW5mbzpcblx0ICogIGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2gvXG5cdCAqXG5cdCAqIFVzYWdlOiBRVW5pdC5kaWZmKGV4cGVjdGVkLCBhY3R1YWwpXG5cdCAqXG5cdCAqL1xuXG5cdFFVbml0LmRpZmYgPSBmdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gRGlmZk1hdGNoUGF0Y2goKSB7fSAvLyAgRElGRiBGVU5DVElPTlNcblxuXHQgIC8qKlxuXHQgICAqIFRoZSBkYXRhIHN0cnVjdHVyZSByZXByZXNlbnRpbmcgYSBkaWZmIGlzIGFuIGFycmF5IG9mIHR1cGxlczpcblx0ICAgKiBbW0RJRkZfREVMRVRFLCAnSGVsbG8nXSwgW0RJRkZfSU5TRVJULCAnR29vZGJ5ZSddLCBbRElGRl9FUVVBTCwgJyB3b3JsZC4nXV1cblx0ICAgKiB3aGljaCBtZWFuczogZGVsZXRlICdIZWxsbycsIGFkZCAnR29vZGJ5ZScgYW5kIGtlZXAgJyB3b3JsZC4nXG5cdCAgICovXG5cblxuXHQgIHZhciBESUZGX0RFTEVURSA9IC0xLFxuXHQgICAgICBESUZGX0lOU0VSVCA9IDEsXG5cdCAgICAgIERJRkZfRVFVQUwgPSAwLFxuXHQgICAgICBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5O1xuXHQgIC8qKlxuXHQgICAqIEZpbmQgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4gdHdvIHRleHRzLiAgU2ltcGxpZmllcyB0aGUgcHJvYmxlbSBieSBzdHJpcHBpbmdcblx0ICAgKiBhbnkgY29tbW9uIHByZWZpeCBvciBzdWZmaXggb2ZmIHRoZSB0ZXh0cyBiZWZvcmUgZGlmZmluZy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgT2xkIHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIE5ldyBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbj19IG9wdENoZWNrbGluZXMgT3B0aW9uYWwgc3BlZWR1cCBmbGFnLiBJZiBwcmVzZW50IGFuZCBmYWxzZSxcblx0ICAgKiAgICAgdGhlbiBkb24ndCBydW4gYSBsaW5lLWxldmVsIGRpZmYgZmlyc3QgdG8gaWRlbnRpZnkgdGhlIGNoYW5nZWQgYXJlYXMuXG5cdCAgICogICAgIERlZmF1bHRzIHRvIHRydWUsIHdoaWNoIGRvZXMgYSBmYXN0ZXIsIHNsaWdodGx5IGxlc3Mgb3B0aW1hbCBkaWZmLlxuXHQgICAqIEByZXR1cm4geyFBcnJheS48IURpZmZNYXRjaFBhdGNoLkRpZmY+fSBBcnJheSBvZiBkaWZmIHR1cGxlcy5cblx0ICAgKi9cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5EaWZmTWFpbiA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIsIG9wdENoZWNrbGluZXMpIHtcblx0ICAgIHZhciBkZWFkbGluZSwgY2hlY2tsaW5lcywgY29tbW9ubGVuZ3RoLCBjb21tb25wcmVmaXgsIGNvbW1vbnN1ZmZpeCwgZGlmZnM7IC8vIFRoZSBkaWZmIG11c3QgYmUgY29tcGxldGUgaW4gdXAgdG8gMSBzZWNvbmQuXG5cblx0ICAgIGRlYWRsaW5lID0gbmV3IERhdGUoKS5nZXRUaW1lKCkgKyAxMDAwOyAvLyBDaGVjayBmb3IgbnVsbCBpbnB1dHMuXG5cblx0ICAgIGlmICh0ZXh0MSA9PT0gbnVsbCB8fCB0ZXh0MiA9PT0gbnVsbCkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJOdWxsIGlucHV0LiAoRGlmZk1haW4pXCIpO1xuXHQgICAgfSAvLyBDaGVjayBmb3IgZXF1YWxpdHkgKHNwZWVkdXApLlxuXG5cblx0ICAgIGlmICh0ZXh0MSA9PT0gdGV4dDIpIHtcblx0ICAgICAgaWYgKHRleHQxKSB7XG5cdCAgICAgICAgcmV0dXJuIFtbRElGRl9FUVVBTCwgdGV4dDFdXTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBbXTtcblx0ICAgIH1cblxuXHQgICAgaWYgKHR5cGVvZiBvcHRDaGVja2xpbmVzID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICAgIG9wdENoZWNrbGluZXMgPSB0cnVlO1xuXHQgICAgfVxuXG5cdCAgICBjaGVja2xpbmVzID0gb3B0Q2hlY2tsaW5lczsgLy8gVHJpbSBvZmYgY29tbW9uIHByZWZpeCAoc3BlZWR1cCkuXG5cblx0ICAgIGNvbW1vbmxlbmd0aCA9IHRoaXMuZGlmZkNvbW1vblByZWZpeCh0ZXh0MSwgdGV4dDIpO1xuXHQgICAgY29tbW9ucHJlZml4ID0gdGV4dDEuc3Vic3RyaW5nKDAsIGNvbW1vbmxlbmd0aCk7XG5cdCAgICB0ZXh0MSA9IHRleHQxLnN1YnN0cmluZyhjb21tb25sZW5ndGgpO1xuXHQgICAgdGV4dDIgPSB0ZXh0Mi5zdWJzdHJpbmcoY29tbW9ubGVuZ3RoKTsgLy8gVHJpbSBvZmYgY29tbW9uIHN1ZmZpeCAoc3BlZWR1cCkuXG5cblx0ICAgIGNvbW1vbmxlbmd0aCA9IHRoaXMuZGlmZkNvbW1vblN1ZmZpeCh0ZXh0MSwgdGV4dDIpO1xuXHQgICAgY29tbW9uc3VmZml4ID0gdGV4dDEuc3Vic3RyaW5nKHRleHQxLmxlbmd0aCAtIGNvbW1vbmxlbmd0aCk7XG5cdCAgICB0ZXh0MSA9IHRleHQxLnN1YnN0cmluZygwLCB0ZXh0MS5sZW5ndGggLSBjb21tb25sZW5ndGgpO1xuXHQgICAgdGV4dDIgPSB0ZXh0Mi5zdWJzdHJpbmcoMCwgdGV4dDIubGVuZ3RoIC0gY29tbW9ubGVuZ3RoKTsgLy8gQ29tcHV0ZSB0aGUgZGlmZiBvbiB0aGUgbWlkZGxlIGJsb2NrLlxuXG5cdCAgICBkaWZmcyA9IHRoaXMuZGlmZkNvbXB1dGUodGV4dDEsIHRleHQyLCBjaGVja2xpbmVzLCBkZWFkbGluZSk7IC8vIFJlc3RvcmUgdGhlIHByZWZpeCBhbmQgc3VmZml4LlxuXG5cdCAgICBpZiAoY29tbW9ucHJlZml4KSB7XG5cdCAgICAgIGRpZmZzLnVuc2hpZnQoW0RJRkZfRVFVQUwsIGNvbW1vbnByZWZpeF0pO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29tbW9uc3VmZml4KSB7XG5cdCAgICAgIGRpZmZzLnB1c2goW0RJRkZfRVFVQUwsIGNvbW1vbnN1ZmZpeF0pO1xuXHQgICAgfVxuXG5cdCAgICB0aGlzLmRpZmZDbGVhbnVwTWVyZ2UoZGlmZnMpO1xuXHQgICAgcmV0dXJuIGRpZmZzO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogUmVkdWNlIHRoZSBudW1iZXIgb2YgZWRpdHMgYnkgZWxpbWluYXRpbmcgb3BlcmF0aW9uYWxseSB0cml2aWFsIGVxdWFsaXRpZXMuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gZGlmZnMgQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ2xlYW51cEVmZmljaWVuY3kgPSBmdW5jdGlvbiAoZGlmZnMpIHtcblx0ICAgIHZhciBjaGFuZ2VzLCBlcXVhbGl0aWVzLCBlcXVhbGl0aWVzTGVuZ3RoLCBsYXN0ZXF1YWxpdHksIHBvaW50ZXIsIHByZUlucywgcHJlRGVsLCBwb3N0SW5zLCBwb3N0RGVsO1xuXHQgICAgY2hhbmdlcyA9IGZhbHNlO1xuXHQgICAgZXF1YWxpdGllcyA9IFtdOyAvLyBTdGFjayBvZiBpbmRpY2VzIHdoZXJlIGVxdWFsaXRpZXMgYXJlIGZvdW5kLlxuXG5cdCAgICBlcXVhbGl0aWVzTGVuZ3RoID0gMDsgLy8gS2VlcGluZyBvdXIgb3duIGxlbmd0aCB2YXIgaXMgZmFzdGVyIGluIEpTLlxuXG5cdCAgICAvKiogQHR5cGUgez9zdHJpbmd9ICovXG5cblx0ICAgIGxhc3RlcXVhbGl0eSA9IG51bGw7IC8vIEFsd2F5cyBlcXVhbCB0byBkaWZmc1tlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXV1bMV1cblxuXHQgICAgcG9pbnRlciA9IDA7IC8vIEluZGV4IG9mIGN1cnJlbnQgcG9zaXRpb24uXG5cdCAgICAvLyBJcyB0aGVyZSBhbiBpbnNlcnRpb24gb3BlcmF0aW9uIGJlZm9yZSB0aGUgbGFzdCBlcXVhbGl0eS5cblxuXHQgICAgcHJlSW5zID0gZmFsc2U7IC8vIElzIHRoZXJlIGEgZGVsZXRpb24gb3BlcmF0aW9uIGJlZm9yZSB0aGUgbGFzdCBlcXVhbGl0eS5cblxuXHQgICAgcHJlRGVsID0gZmFsc2U7IC8vIElzIHRoZXJlIGFuIGluc2VydGlvbiBvcGVyYXRpb24gYWZ0ZXIgdGhlIGxhc3QgZXF1YWxpdHkuXG5cblx0ICAgIHBvc3RJbnMgPSBmYWxzZTsgLy8gSXMgdGhlcmUgYSBkZWxldGlvbiBvcGVyYXRpb24gYWZ0ZXIgdGhlIGxhc3QgZXF1YWxpdHkuXG5cblx0ICAgIHBvc3REZWwgPSBmYWxzZTtcblxuXHQgICAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGgpIHtcblx0ICAgICAgLy8gRXF1YWxpdHkgZm91bmQuXG5cdCAgICAgIGlmIChkaWZmc1twb2ludGVyXVswXSA9PT0gRElGRl9FUVVBTCkge1xuXHQgICAgICAgIGlmIChkaWZmc1twb2ludGVyXVsxXS5sZW5ndGggPCA0ICYmIChwb3N0SW5zIHx8IHBvc3REZWwpKSB7XG5cdCAgICAgICAgICAvLyBDYW5kaWRhdGUgZm91bmQuXG5cdCAgICAgICAgICBlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGgrK10gPSBwb2ludGVyO1xuXHQgICAgICAgICAgcHJlSW5zID0gcG9zdElucztcblx0ICAgICAgICAgIHByZURlbCA9IHBvc3REZWw7XG5cdCAgICAgICAgICBsYXN0ZXF1YWxpdHkgPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgLy8gTm90IGEgY2FuZGlkYXRlLCBhbmQgY2FuIG5ldmVyIGJlY29tZSBvbmUuXG5cdCAgICAgICAgICBlcXVhbGl0aWVzTGVuZ3RoID0gMDtcblx0ICAgICAgICAgIGxhc3RlcXVhbGl0eSA9IG51bGw7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcG9zdElucyA9IHBvc3REZWwgPSBmYWxzZTsgLy8gQW4gaW5zZXJ0aW9uIG9yIGRlbGV0aW9uLlxuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGlmIChkaWZmc1twb2ludGVyXVswXSA9PT0gRElGRl9ERUxFVEUpIHtcblx0ICAgICAgICAgIHBvc3REZWwgPSB0cnVlO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBwb3N0SW5zID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgICAgLypcblx0ICAgICAgICAgKiBGaXZlIHR5cGVzIHRvIGJlIHNwbGl0OlxuXHQgICAgICAgICAqIDxpbnM+QTwvaW5zPjxkZWw+QjwvZGVsPlhZPGlucz5DPC9pbnM+PGRlbD5EPC9kZWw+XG5cdCAgICAgICAgICogPGlucz5BPC9pbnM+WDxpbnM+QzwvaW5zPjxkZWw+RDwvZGVsPlxuXHQgICAgICAgICAqIDxpbnM+QTwvaW5zPjxkZWw+QjwvZGVsPlg8aW5zPkM8L2lucz5cblx0ICAgICAgICAgKiA8aW5zPkE8L2RlbD5YPGlucz5DPC9pbnM+PGRlbD5EPC9kZWw+XG5cdCAgICAgICAgICogPGlucz5BPC9pbnM+PGRlbD5CPC9kZWw+WDxkZWw+QzwvZGVsPlxuXHQgICAgICAgICAqL1xuXG5cblx0ICAgICAgICBpZiAobGFzdGVxdWFsaXR5ICYmIChwcmVJbnMgJiYgcHJlRGVsICYmIHBvc3RJbnMgJiYgcG9zdERlbCB8fCBsYXN0ZXF1YWxpdHkubGVuZ3RoIDwgMiAmJiBwcmVJbnMgKyBwcmVEZWwgKyBwb3N0SW5zICsgcG9zdERlbCA9PT0gMykpIHtcblx0ICAgICAgICAgIC8vIER1cGxpY2F0ZSByZWNvcmQuXG5cdCAgICAgICAgICBkaWZmcy5zcGxpY2UoZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoIC0gMV0sIDAsIFtESUZGX0RFTEVURSwgbGFzdGVxdWFsaXR5XSk7IC8vIENoYW5nZSBzZWNvbmQgY29weSB0byBpbnNlcnQuXG5cblx0ICAgICAgICAgIGRpZmZzW2VxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdICsgMV1bMF0gPSBESUZGX0lOU0VSVDtcblx0ICAgICAgICAgIGVxdWFsaXRpZXNMZW5ndGgtLTsgLy8gVGhyb3cgYXdheSB0aGUgZXF1YWxpdHkgd2UganVzdCBkZWxldGVkO1xuXG5cdCAgICAgICAgICBsYXN0ZXF1YWxpdHkgPSBudWxsO1xuXG5cdCAgICAgICAgICBpZiAocHJlSW5zICYmIHByZURlbCkge1xuXHQgICAgICAgICAgICAvLyBObyBjaGFuZ2VzIG1hZGUgd2hpY2ggY291bGQgYWZmZWN0IHByZXZpb3VzIGVudHJ5LCBrZWVwIGdvaW5nLlxuXHQgICAgICAgICAgICBwb3N0SW5zID0gcG9zdERlbCA9IHRydWU7XG5cdCAgICAgICAgICAgIGVxdWFsaXRpZXNMZW5ndGggPSAwO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgZXF1YWxpdGllc0xlbmd0aC0tOyAvLyBUaHJvdyBhd2F5IHRoZSBwcmV2aW91cyBlcXVhbGl0eS5cblxuXHQgICAgICAgICAgICBwb2ludGVyID0gZXF1YWxpdGllc0xlbmd0aCA+IDAgPyBlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSA6IC0xO1xuXHQgICAgICAgICAgICBwb3N0SW5zID0gcG9zdERlbCA9IGZhbHNlO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBjaGFuZ2VzID0gdHJ1ZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICBwb2ludGVyKys7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjaGFuZ2VzKSB7XG5cdCAgICAgIHRoaXMuZGlmZkNsZWFudXBNZXJnZShkaWZmcyk7XG5cdCAgICB9XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBDb252ZXJ0IGEgZGlmZiBhcnJheSBpbnRvIGEgcHJldHR5IEhUTUwgcmVwb3J0LlxuXHQgICAqIEBwYXJhbSB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IGRpZmZzIEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqIEBwYXJhbSB7aW50ZWdlcn0gc3RyaW5nIHRvIGJlIGJlYXV0aWZpZWQuXG5cdCAgICogQHJldHVybiB7c3RyaW5nfSBIVE1MIHJlcHJlc2VudGF0aW9uLlxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZlByZXR0eUh0bWwgPSBmdW5jdGlvbiAoZGlmZnMpIHtcblx0ICAgIHZhciBvcCxcblx0ICAgICAgICBkYXRhLFxuXHQgICAgICAgIHgsXG5cdCAgICAgICAgaHRtbCA9IFtdO1xuXG5cdCAgICBmb3IgKHggPSAwOyB4IDwgZGlmZnMubGVuZ3RoOyB4KyspIHtcblx0ICAgICAgb3AgPSBkaWZmc1t4XVswXTsgLy8gT3BlcmF0aW9uIChpbnNlcnQsIGRlbGV0ZSwgZXF1YWwpXG5cblx0ICAgICAgZGF0YSA9IGRpZmZzW3hdWzFdOyAvLyBUZXh0IG9mIGNoYW5nZS5cblxuXHQgICAgICBzd2l0Y2ggKG9wKSB7XG5cdCAgICAgICAgY2FzZSBESUZGX0lOU0VSVDpcblx0ICAgICAgICAgIGh0bWxbeF0gPSBcIjxpbnM+XCIgKyBlc2NhcGVUZXh0KGRhdGEpICsgXCI8L2lucz5cIjtcblx0ICAgICAgICAgIGJyZWFrO1xuXG5cdCAgICAgICAgY2FzZSBESUZGX0RFTEVURTpcblx0ICAgICAgICAgIGh0bWxbeF0gPSBcIjxkZWw+XCIgKyBlc2NhcGVUZXh0KGRhdGEpICsgXCI8L2RlbD5cIjtcblx0ICAgICAgICAgIGJyZWFrO1xuXG5cdCAgICAgICAgY2FzZSBESUZGX0VRVUFMOlxuXHQgICAgICAgICAgaHRtbFt4XSA9IFwiPHNwYW4+XCIgKyBlc2NhcGVUZXh0KGRhdGEpICsgXCI8L3NwYW4+XCI7XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gaHRtbC5qb2luKFwiXCIpO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRGV0ZXJtaW5lIHRoZSBjb21tb24gcHJlZml4IG9mIHR3byBzdHJpbmdzLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIFNlY29uZCBzdHJpbmcuXG5cdCAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgY29tbW9uIHRvIHRoZSBzdGFydCBvZiBlYWNoXG5cdCAgICogICAgIHN0cmluZy5cblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDb21tb25QcmVmaXggPSBmdW5jdGlvbiAodGV4dDEsIHRleHQyKSB7XG5cdCAgICB2YXIgcG9pbnRlcm1pZCwgcG9pbnRlcm1heCwgcG9pbnRlcm1pbiwgcG9pbnRlcnN0YXJ0OyAvLyBRdWljayBjaGVjayBmb3IgY29tbW9uIG51bGwgY2FzZXMuXG5cblx0ICAgIGlmICghdGV4dDEgfHwgIXRleHQyIHx8IHRleHQxLmNoYXJBdCgwKSAhPT0gdGV4dDIuY2hhckF0KDApKSB7XG5cdCAgICAgIHJldHVybiAwO1xuXHQgICAgfSAvLyBCaW5hcnkgc2VhcmNoLlxuXHQgICAgLy8gUGVyZm9ybWFuY2UgYW5hbHlzaXM6IGh0dHBzOi8vbmVpbC5mcmFzZXIubmFtZS9uZXdzLzIwMDcvMTAvMDkvXG5cblxuXHQgICAgcG9pbnRlcm1pbiA9IDA7XG5cdCAgICBwb2ludGVybWF4ID0gTWF0aC5taW4odGV4dDEubGVuZ3RoLCB0ZXh0Mi5sZW5ndGgpO1xuXHQgICAgcG9pbnRlcm1pZCA9IHBvaW50ZXJtYXg7XG5cdCAgICBwb2ludGVyc3RhcnQgPSAwO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlcm1pbiA8IHBvaW50ZXJtaWQpIHtcblx0ICAgICAgaWYgKHRleHQxLnN1YnN0cmluZyhwb2ludGVyc3RhcnQsIHBvaW50ZXJtaWQpID09PSB0ZXh0Mi5zdWJzdHJpbmcocG9pbnRlcnN0YXJ0LCBwb2ludGVybWlkKSkge1xuXHQgICAgICAgIHBvaW50ZXJtaW4gPSBwb2ludGVybWlkO1xuXHQgICAgICAgIHBvaW50ZXJzdGFydCA9IHBvaW50ZXJtaW47XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcG9pbnRlcm1heCA9IHBvaW50ZXJtaWQ7XG5cdCAgICAgIH1cblxuXHQgICAgICBwb2ludGVybWlkID0gTWF0aC5mbG9vcigocG9pbnRlcm1heCAtIHBvaW50ZXJtaW4pIC8gMiArIHBvaW50ZXJtaW4pO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gcG9pbnRlcm1pZDtcblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIERldGVybWluZSB0aGUgY29tbW9uIHN1ZmZpeCBvZiB0d28gc3RyaW5ncy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgRmlyc3Qgc3RyaW5nLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBTZWNvbmQgc3RyaW5nLlxuXHQgICAqIEByZXR1cm4ge251bWJlcn0gVGhlIG51bWJlciBvZiBjaGFyYWN0ZXJzIGNvbW1vbiB0byB0aGUgZW5kIG9mIGVhY2ggc3RyaW5nLlxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkNvbW1vblN1ZmZpeCA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIpIHtcblx0ICAgIHZhciBwb2ludGVybWlkLCBwb2ludGVybWF4LCBwb2ludGVybWluLCBwb2ludGVyZW5kOyAvLyBRdWljayBjaGVjayBmb3IgY29tbW9uIG51bGwgY2FzZXMuXG5cblx0ICAgIGlmICghdGV4dDEgfHwgIXRleHQyIHx8IHRleHQxLmNoYXJBdCh0ZXh0MS5sZW5ndGggLSAxKSAhPT0gdGV4dDIuY2hhckF0KHRleHQyLmxlbmd0aCAtIDEpKSB7XG5cdCAgICAgIHJldHVybiAwO1xuXHQgICAgfSAvLyBCaW5hcnkgc2VhcmNoLlxuXHQgICAgLy8gUGVyZm9ybWFuY2UgYW5hbHlzaXM6IGh0dHBzOi8vbmVpbC5mcmFzZXIubmFtZS9uZXdzLzIwMDcvMTAvMDkvXG5cblxuXHQgICAgcG9pbnRlcm1pbiA9IDA7XG5cdCAgICBwb2ludGVybWF4ID0gTWF0aC5taW4odGV4dDEubGVuZ3RoLCB0ZXh0Mi5sZW5ndGgpO1xuXHQgICAgcG9pbnRlcm1pZCA9IHBvaW50ZXJtYXg7XG5cdCAgICBwb2ludGVyZW5kID0gMDtcblxuXHQgICAgd2hpbGUgKHBvaW50ZXJtaW4gPCBwb2ludGVybWlkKSB7XG5cdCAgICAgIGlmICh0ZXh0MS5zdWJzdHJpbmcodGV4dDEubGVuZ3RoIC0gcG9pbnRlcm1pZCwgdGV4dDEubGVuZ3RoIC0gcG9pbnRlcmVuZCkgPT09IHRleHQyLnN1YnN0cmluZyh0ZXh0Mi5sZW5ndGggLSBwb2ludGVybWlkLCB0ZXh0Mi5sZW5ndGggLSBwb2ludGVyZW5kKSkge1xuXHQgICAgICAgIHBvaW50ZXJtaW4gPSBwb2ludGVybWlkO1xuXHQgICAgICAgIHBvaW50ZXJlbmQgPSBwb2ludGVybWluO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHBvaW50ZXJtYXggPSBwb2ludGVybWlkO1xuXHQgICAgICB9XG5cblx0ICAgICAgcG9pbnRlcm1pZCA9IE1hdGguZmxvb3IoKHBvaW50ZXJtYXggLSBwb2ludGVybWluKSAvIDIgKyBwb2ludGVybWluKTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHBvaW50ZXJtaWQ7XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBGaW5kIHRoZSBkaWZmZXJlbmNlcyBiZXR3ZWVuIHR3byB0ZXh0cy4gIEFzc3VtZXMgdGhhdCB0aGUgdGV4dHMgZG8gbm90XG5cdCAgICogaGF2ZSBhbnkgY29tbW9uIHByZWZpeCBvciBzdWZmaXguXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIE9sZCBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBOZXcgc3RyaW5nIHRvIGJlIGRpZmZlZC5cblx0ICAgKiBAcGFyYW0ge2Jvb2xlYW59IGNoZWNrbGluZXMgU3BlZWR1cCBmbGFnLiAgSWYgZmFsc2UsIHRoZW4gZG9uJ3QgcnVuIGFcblx0ICAgKiAgICAgbGluZS1sZXZlbCBkaWZmIGZpcnN0IHRvIGlkZW50aWZ5IHRoZSBjaGFuZ2VkIGFyZWFzLlxuXHQgICAqICAgICBJZiB0cnVlLCB0aGVuIHJ1biBhIGZhc3Rlciwgc2xpZ2h0bHkgbGVzcyBvcHRpbWFsIGRpZmYuXG5cdCAgICogQHBhcmFtIHtudW1iZXJ9IGRlYWRsaW5lIFRpbWUgd2hlbiB0aGUgZGlmZiBzaG91bGQgYmUgY29tcGxldGUgYnkuXG5cdCAgICogQHJldHVybiB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ29tcHV0ZSA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIsIGNoZWNrbGluZXMsIGRlYWRsaW5lKSB7XG5cdCAgICB2YXIgZGlmZnMsIGxvbmd0ZXh0LCBzaG9ydHRleHQsIGksIGhtLCB0ZXh0MUEsIHRleHQyQSwgdGV4dDFCLCB0ZXh0MkIsIG1pZENvbW1vbiwgZGlmZnNBLCBkaWZmc0I7XG5cblx0ICAgIGlmICghdGV4dDEpIHtcblx0ICAgICAgLy8gSnVzdCBhZGQgc29tZSB0ZXh0IChzcGVlZHVwKS5cblx0ICAgICAgcmV0dXJuIFtbRElGRl9JTlNFUlQsIHRleHQyXV07XG5cdCAgICB9XG5cblx0ICAgIGlmICghdGV4dDIpIHtcblx0ICAgICAgLy8gSnVzdCBkZWxldGUgc29tZSB0ZXh0IChzcGVlZHVwKS5cblx0ICAgICAgcmV0dXJuIFtbRElGRl9ERUxFVEUsIHRleHQxXV07XG5cdCAgICB9XG5cblx0ICAgIGxvbmd0ZXh0ID0gdGV4dDEubGVuZ3RoID4gdGV4dDIubGVuZ3RoID8gdGV4dDEgOiB0ZXh0Mjtcblx0ICAgIHNob3J0dGV4dCA9IHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aCA/IHRleHQyIDogdGV4dDE7XG5cdCAgICBpID0gbG9uZ3RleHQuaW5kZXhPZihzaG9ydHRleHQpO1xuXG5cdCAgICBpZiAoaSAhPT0gLTEpIHtcblx0ICAgICAgLy8gU2hvcnRlciB0ZXh0IGlzIGluc2lkZSB0aGUgbG9uZ2VyIHRleHQgKHNwZWVkdXApLlxuXHQgICAgICBkaWZmcyA9IFtbRElGRl9JTlNFUlQsIGxvbmd0ZXh0LnN1YnN0cmluZygwLCBpKV0sIFtESUZGX0VRVUFMLCBzaG9ydHRleHRdLCBbRElGRl9JTlNFUlQsIGxvbmd0ZXh0LnN1YnN0cmluZyhpICsgc2hvcnR0ZXh0Lmxlbmd0aCldXTsgLy8gU3dhcCBpbnNlcnRpb25zIGZvciBkZWxldGlvbnMgaWYgZGlmZiBpcyByZXZlcnNlZC5cblxuXHQgICAgICBpZiAodGV4dDEubGVuZ3RoID4gdGV4dDIubGVuZ3RoKSB7XG5cdCAgICAgICAgZGlmZnNbMF1bMF0gPSBkaWZmc1syXVswXSA9IERJRkZfREVMRVRFO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIGRpZmZzO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoc2hvcnR0ZXh0Lmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAvLyBTaW5nbGUgY2hhcmFjdGVyIHN0cmluZy5cblx0ICAgICAgLy8gQWZ0ZXIgdGhlIHByZXZpb3VzIHNwZWVkdXAsIHRoZSBjaGFyYWN0ZXIgY2FuJ3QgYmUgYW4gZXF1YWxpdHkuXG5cdCAgICAgIHJldHVybiBbW0RJRkZfREVMRVRFLCB0ZXh0MV0sIFtESUZGX0lOU0VSVCwgdGV4dDJdXTtcblx0ICAgIH0gLy8gQ2hlY2sgdG8gc2VlIGlmIHRoZSBwcm9ibGVtIGNhbiBiZSBzcGxpdCBpbiB0d28uXG5cblxuXHQgICAgaG0gPSB0aGlzLmRpZmZIYWxmTWF0Y2godGV4dDEsIHRleHQyKTtcblxuXHQgICAgaWYgKGhtKSB7XG5cdCAgICAgIC8vIEEgaGFsZi1tYXRjaCB3YXMgZm91bmQsIHNvcnQgb3V0IHRoZSByZXR1cm4gZGF0YS5cblx0ICAgICAgdGV4dDFBID0gaG1bMF07XG5cdCAgICAgIHRleHQxQiA9IGhtWzFdO1xuXHQgICAgICB0ZXh0MkEgPSBobVsyXTtcblx0ICAgICAgdGV4dDJCID0gaG1bM107XG5cdCAgICAgIG1pZENvbW1vbiA9IGhtWzRdOyAvLyBTZW5kIGJvdGggcGFpcnMgb2ZmIGZvciBzZXBhcmF0ZSBwcm9jZXNzaW5nLlxuXG5cdCAgICAgIGRpZmZzQSA9IHRoaXMuRGlmZk1haW4odGV4dDFBLCB0ZXh0MkEsIGNoZWNrbGluZXMsIGRlYWRsaW5lKTtcblx0ICAgICAgZGlmZnNCID0gdGhpcy5EaWZmTWFpbih0ZXh0MUIsIHRleHQyQiwgY2hlY2tsaW5lcywgZGVhZGxpbmUpOyAvLyBNZXJnZSB0aGUgcmVzdWx0cy5cblxuXHQgICAgICByZXR1cm4gZGlmZnNBLmNvbmNhdChbW0RJRkZfRVFVQUwsIG1pZENvbW1vbl1dLCBkaWZmc0IpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY2hlY2tsaW5lcyAmJiB0ZXh0MS5sZW5ndGggPiAxMDAgJiYgdGV4dDIubGVuZ3RoID4gMTAwKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmRpZmZMaW5lTW9kZSh0ZXh0MSwgdGV4dDIsIGRlYWRsaW5lKTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHRoaXMuZGlmZkJpc2VjdCh0ZXh0MSwgdGV4dDIsIGRlYWRsaW5lKTtcblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIERvIHRoZSB0d28gdGV4dHMgc2hhcmUgYSBzdWJzdHJpbmcgd2hpY2ggaXMgYXQgbGVhc3QgaGFsZiB0aGUgbGVuZ3RoIG9mIHRoZVxuXHQgICAqIGxvbmdlciB0ZXh0P1xuXHQgICAqIFRoaXMgc3BlZWR1cCBjYW4gcHJvZHVjZSBub24tbWluaW1hbCBkaWZmcy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgRmlyc3Qgc3RyaW5nLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBTZWNvbmQgc3RyaW5nLlxuXHQgICAqIEByZXR1cm4ge0FycmF5LjxzdHJpbmc+fSBGaXZlIGVsZW1lbnQgQXJyYXksIGNvbnRhaW5pbmcgdGhlIHByZWZpeCBvZlxuXHQgICAqICAgICB0ZXh0MSwgdGhlIHN1ZmZpeCBvZiB0ZXh0MSwgdGhlIHByZWZpeCBvZiB0ZXh0MiwgdGhlIHN1ZmZpeCBvZlxuXHQgICAqICAgICB0ZXh0MiBhbmQgdGhlIGNvbW1vbiBtaWRkbGUuICBPciBudWxsIGlmIHRoZXJlIHdhcyBubyBtYXRjaC5cblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkhhbGZNYXRjaCA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIpIHtcblx0ICAgIHZhciBsb25ndGV4dCwgc2hvcnR0ZXh0LCBkbXAsIHRleHQxQSwgdGV4dDJCLCB0ZXh0MkEsIHRleHQxQiwgbWlkQ29tbW9uLCBobTEsIGhtMiwgaG07XG5cdCAgICBsb25ndGV4dCA9IHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aCA/IHRleHQxIDogdGV4dDI7XG5cdCAgICBzaG9ydHRleHQgPSB0ZXh0MS5sZW5ndGggPiB0ZXh0Mi5sZW5ndGggPyB0ZXh0MiA6IHRleHQxO1xuXG5cdCAgICBpZiAobG9uZ3RleHQubGVuZ3RoIDwgNCB8fCBzaG9ydHRleHQubGVuZ3RoICogMiA8IGxvbmd0ZXh0Lmxlbmd0aCkge1xuXHQgICAgICByZXR1cm4gbnVsbDsgLy8gUG9pbnRsZXNzLlxuXHQgICAgfVxuXG5cdCAgICBkbXAgPSB0aGlzOyAvLyAndGhpcycgYmVjb21lcyAnd2luZG93JyBpbiBhIGNsb3N1cmUuXG5cblx0ICAgIC8qKlxuXHQgICAgICogRG9lcyBhIHN1YnN0cmluZyBvZiBzaG9ydHRleHQgZXhpc3Qgd2l0aGluIGxvbmd0ZXh0IHN1Y2ggdGhhdCB0aGUgc3Vic3RyaW5nXG5cdCAgICAgKiBpcyBhdCBsZWFzdCBoYWxmIHRoZSBsZW5ndGggb2YgbG9uZ3RleHQ/XG5cdCAgICAgKiBDbG9zdXJlLCBidXQgZG9lcyBub3QgcmVmZXJlbmNlIGFueSBleHRlcm5hbCB2YXJpYWJsZXMuXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gbG9uZ3RleHQgTG9uZ2VyIHN0cmluZy5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBzaG9ydHRleHQgU2hvcnRlciBzdHJpbmcuXG5cdCAgICAgKiBAcGFyYW0ge251bWJlcn0gaSBTdGFydCBpbmRleCBvZiBxdWFydGVyIGxlbmd0aCBzdWJzdHJpbmcgd2l0aGluIGxvbmd0ZXh0LlxuXHQgICAgICogQHJldHVybiB7QXJyYXkuPHN0cmluZz59IEZpdmUgZWxlbWVudCBBcnJheSwgY29udGFpbmluZyB0aGUgcHJlZml4IG9mXG5cdCAgICAgKiAgICAgbG9uZ3RleHQsIHRoZSBzdWZmaXggb2YgbG9uZ3RleHQsIHRoZSBwcmVmaXggb2Ygc2hvcnR0ZXh0LCB0aGUgc3VmZml4XG5cdCAgICAgKiAgICAgb2Ygc2hvcnR0ZXh0IGFuZCB0aGUgY29tbW9uIG1pZGRsZS4gIE9yIG51bGwgaWYgdGhlcmUgd2FzIG5vIG1hdGNoLlxuXHQgICAgICogQHByaXZhdGVcblx0ICAgICAqL1xuXG5cdCAgICBmdW5jdGlvbiBkaWZmSGFsZk1hdGNoSShsb25ndGV4dCwgc2hvcnR0ZXh0LCBpKSB7XG5cdCAgICAgIHZhciBzZWVkLCBqLCBiZXN0Q29tbW9uLCBwcmVmaXhMZW5ndGgsIHN1ZmZpeExlbmd0aCwgYmVzdExvbmd0ZXh0QSwgYmVzdExvbmd0ZXh0QiwgYmVzdFNob3J0dGV4dEEsIGJlc3RTaG9ydHRleHRCOyAvLyBTdGFydCB3aXRoIGEgMS80IGxlbmd0aCBzdWJzdHJpbmcgYXQgcG9zaXRpb24gaSBhcyBhIHNlZWQuXG5cblx0ICAgICAgc2VlZCA9IGxvbmd0ZXh0LnN1YnN0cmluZyhpLCBpICsgTWF0aC5mbG9vcihsb25ndGV4dC5sZW5ndGggLyA0KSk7XG5cdCAgICAgIGogPSAtMTtcblx0ICAgICAgYmVzdENvbW1vbiA9IFwiXCI7XG5cblx0ICAgICAgd2hpbGUgKChqID0gc2hvcnR0ZXh0LmluZGV4T2Yoc2VlZCwgaiArIDEpKSAhPT0gLTEpIHtcblx0ICAgICAgICBwcmVmaXhMZW5ndGggPSBkbXAuZGlmZkNvbW1vblByZWZpeChsb25ndGV4dC5zdWJzdHJpbmcoaSksIHNob3J0dGV4dC5zdWJzdHJpbmcoaikpO1xuXHQgICAgICAgIHN1ZmZpeExlbmd0aCA9IGRtcC5kaWZmQ29tbW9uU3VmZml4KGxvbmd0ZXh0LnN1YnN0cmluZygwLCBpKSwgc2hvcnR0ZXh0LnN1YnN0cmluZygwLCBqKSk7XG5cblx0ICAgICAgICBpZiAoYmVzdENvbW1vbi5sZW5ndGggPCBzdWZmaXhMZW5ndGggKyBwcmVmaXhMZW5ndGgpIHtcblx0ICAgICAgICAgIGJlc3RDb21tb24gPSBzaG9ydHRleHQuc3Vic3RyaW5nKGogLSBzdWZmaXhMZW5ndGgsIGopICsgc2hvcnR0ZXh0LnN1YnN0cmluZyhqLCBqICsgcHJlZml4TGVuZ3RoKTtcblx0ICAgICAgICAgIGJlc3RMb25ndGV4dEEgPSBsb25ndGV4dC5zdWJzdHJpbmcoMCwgaSAtIHN1ZmZpeExlbmd0aCk7XG5cdCAgICAgICAgICBiZXN0TG9uZ3RleHRCID0gbG9uZ3RleHQuc3Vic3RyaW5nKGkgKyBwcmVmaXhMZW5ndGgpO1xuXHQgICAgICAgICAgYmVzdFNob3J0dGV4dEEgPSBzaG9ydHRleHQuc3Vic3RyaW5nKDAsIGogLSBzdWZmaXhMZW5ndGgpO1xuXHQgICAgICAgICAgYmVzdFNob3J0dGV4dEIgPSBzaG9ydHRleHQuc3Vic3RyaW5nKGogKyBwcmVmaXhMZW5ndGgpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChiZXN0Q29tbW9uLmxlbmd0aCAqIDIgPj0gbG9uZ3RleHQubGVuZ3RoKSB7XG5cdCAgICAgICAgcmV0dXJuIFtiZXN0TG9uZ3RleHRBLCBiZXN0TG9uZ3RleHRCLCBiZXN0U2hvcnR0ZXh0QSwgYmVzdFNob3J0dGV4dEIsIGJlc3RDb21tb25dO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiBudWxsO1xuXHQgICAgICB9XG5cdCAgICB9IC8vIEZpcnN0IGNoZWNrIGlmIHRoZSBzZWNvbmQgcXVhcnRlciBpcyB0aGUgc2VlZCBmb3IgYSBoYWxmLW1hdGNoLlxuXG5cblx0ICAgIGhtMSA9IGRpZmZIYWxmTWF0Y2hJKGxvbmd0ZXh0LCBzaG9ydHRleHQsIE1hdGguY2VpbChsb25ndGV4dC5sZW5ndGggLyA0KSk7IC8vIENoZWNrIGFnYWluIGJhc2VkIG9uIHRoZSB0aGlyZCBxdWFydGVyLlxuXG5cdCAgICBobTIgPSBkaWZmSGFsZk1hdGNoSShsb25ndGV4dCwgc2hvcnR0ZXh0LCBNYXRoLmNlaWwobG9uZ3RleHQubGVuZ3RoIC8gMikpO1xuXG5cdCAgICBpZiAoIWhtMSAmJiAhaG0yKSB7XG5cdCAgICAgIHJldHVybiBudWxsO1xuXHQgICAgfSBlbHNlIGlmICghaG0yKSB7XG5cdCAgICAgIGhtID0gaG0xO1xuXHQgICAgfSBlbHNlIGlmICghaG0xKSB7XG5cdCAgICAgIGhtID0gaG0yO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgLy8gQm90aCBtYXRjaGVkLiAgU2VsZWN0IHRoZSBsb25nZXN0LlxuXHQgICAgICBobSA9IGhtMVs0XS5sZW5ndGggPiBobTJbNF0ubGVuZ3RoID8gaG0xIDogaG0yO1xuXHQgICAgfSAvLyBBIGhhbGYtbWF0Y2ggd2FzIGZvdW5kLCBzb3J0IG91dCB0aGUgcmV0dXJuIGRhdGEuXG5cblxuXHQgICAgaWYgKHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aCkge1xuXHQgICAgICB0ZXh0MUEgPSBobVswXTtcblx0ICAgICAgdGV4dDFCID0gaG1bMV07XG5cdCAgICAgIHRleHQyQSA9IGhtWzJdO1xuXHQgICAgICB0ZXh0MkIgPSBobVszXTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRleHQyQSA9IGhtWzBdO1xuXHQgICAgICB0ZXh0MkIgPSBobVsxXTtcblx0ICAgICAgdGV4dDFBID0gaG1bMl07XG5cdCAgICAgIHRleHQxQiA9IGhtWzNdO1xuXHQgICAgfVxuXG5cdCAgICBtaWRDb21tb24gPSBobVs0XTtcblx0ICAgIHJldHVybiBbdGV4dDFBLCB0ZXh0MUIsIHRleHQyQSwgdGV4dDJCLCBtaWRDb21tb25dO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRG8gYSBxdWljayBsaW5lLWxldmVsIGRpZmYgb24gYm90aCBzdHJpbmdzLCB0aGVuIHJlZGlmZiB0aGUgcGFydHMgZm9yXG5cdCAgICogZ3JlYXRlciBhY2N1cmFjeS5cblx0ICAgKiBUaGlzIHNwZWVkdXAgY2FuIHByb2R1Y2Ugbm9uLW1pbmltYWwgZGlmZnMuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIE9sZCBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBOZXcgc3RyaW5nIHRvIGJlIGRpZmZlZC5cblx0ICAgKiBAcGFyYW0ge251bWJlcn0gZGVhZGxpbmUgVGltZSB3aGVuIHRoZSBkaWZmIHNob3VsZCBiZSBjb21wbGV0ZSBieS5cblx0ICAgKiBAcmV0dXJuIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZMaW5lTW9kZSA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIsIGRlYWRsaW5lKSB7XG5cdCAgICB2YXIgYSwgZGlmZnMsIGxpbmVhcnJheSwgcG9pbnRlciwgY291bnRJbnNlcnQsIGNvdW50RGVsZXRlLCB0ZXh0SW5zZXJ0LCB0ZXh0RGVsZXRlLCBqOyAvLyBTY2FuIHRoZSB0ZXh0IG9uIGEgbGluZS1ieS1saW5lIGJhc2lzIGZpcnN0LlxuXG5cdCAgICBhID0gdGhpcy5kaWZmTGluZXNUb0NoYXJzKHRleHQxLCB0ZXh0Mik7XG5cdCAgICB0ZXh0MSA9IGEuY2hhcnMxO1xuXHQgICAgdGV4dDIgPSBhLmNoYXJzMjtcblx0ICAgIGxpbmVhcnJheSA9IGEubGluZUFycmF5O1xuXHQgICAgZGlmZnMgPSB0aGlzLkRpZmZNYWluKHRleHQxLCB0ZXh0MiwgZmFsc2UsIGRlYWRsaW5lKTsgLy8gQ29udmVydCB0aGUgZGlmZiBiYWNrIHRvIG9yaWdpbmFsIHRleHQuXG5cblx0ICAgIHRoaXMuZGlmZkNoYXJzVG9MaW5lcyhkaWZmcywgbGluZWFycmF5KTsgLy8gRWxpbWluYXRlIGZyZWFrIG1hdGNoZXMgKGUuZy4gYmxhbmsgbGluZXMpXG5cblx0ICAgIHRoaXMuZGlmZkNsZWFudXBTZW1hbnRpYyhkaWZmcyk7IC8vIFJlZGlmZiBhbnkgcmVwbGFjZW1lbnQgYmxvY2tzLCB0aGlzIHRpbWUgY2hhcmFjdGVyLWJ5LWNoYXJhY3Rlci5cblx0ICAgIC8vIEFkZCBhIGR1bW15IGVudHJ5IGF0IHRoZSBlbmQuXG5cblx0ICAgIGRpZmZzLnB1c2goW0RJRkZfRVFVQUwsIFwiXCJdKTtcblx0ICAgIHBvaW50ZXIgPSAwO1xuXHQgICAgY291bnREZWxldGUgPSAwO1xuXHQgICAgY291bnRJbnNlcnQgPSAwO1xuXHQgICAgdGV4dERlbGV0ZSA9IFwiXCI7XG5cdCAgICB0ZXh0SW5zZXJ0ID0gXCJcIjtcblxuXHQgICAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGgpIHtcblx0ICAgICAgc3dpdGNoIChkaWZmc1twb2ludGVyXVswXSkge1xuXHQgICAgICAgIGNhc2UgRElGRl9JTlNFUlQ6XG5cdCAgICAgICAgICBjb3VudEluc2VydCsrO1xuXHQgICAgICAgICAgdGV4dEluc2VydCArPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICAgIGJyZWFrO1xuXG5cdCAgICAgICAgY2FzZSBESUZGX0RFTEVURTpcblx0ICAgICAgICAgIGNvdW50RGVsZXRlKys7XG5cdCAgICAgICAgICB0ZXh0RGVsZXRlICs9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgICAgYnJlYWs7XG5cblx0ICAgICAgICBjYXNlIERJRkZfRVFVQUw6XG5cdCAgICAgICAgICAvLyBVcG9uIHJlYWNoaW5nIGFuIGVxdWFsaXR5LCBjaGVjayBmb3IgcHJpb3IgcmVkdW5kYW5jaWVzLlxuXHQgICAgICAgICAgaWYgKGNvdW50RGVsZXRlID49IDEgJiYgY291bnRJbnNlcnQgPj0gMSkge1xuXHQgICAgICAgICAgICAvLyBEZWxldGUgdGhlIG9mZmVuZGluZyByZWNvcmRzIGFuZCBhZGQgdGhlIG1lcmdlZCBvbmVzLlxuXHQgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciAtIGNvdW50RGVsZXRlIC0gY291bnRJbnNlcnQsIGNvdW50RGVsZXRlICsgY291bnRJbnNlcnQpO1xuXHQgICAgICAgICAgICBwb2ludGVyID0gcG9pbnRlciAtIGNvdW50RGVsZXRlIC0gY291bnRJbnNlcnQ7XG5cdCAgICAgICAgICAgIGEgPSB0aGlzLkRpZmZNYWluKHRleHREZWxldGUsIHRleHRJbnNlcnQsIGZhbHNlLCBkZWFkbGluZSk7XG5cblx0ICAgICAgICAgICAgZm9yIChqID0gYS5sZW5ndGggLSAxOyBqID49IDA7IGotLSkge1xuXHQgICAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyLCAwLCBhW2pdKTtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIHBvaW50ZXIgPSBwb2ludGVyICsgYS5sZW5ndGg7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIGNvdW50SW5zZXJ0ID0gMDtcblx0ICAgICAgICAgIGNvdW50RGVsZXRlID0gMDtcblx0ICAgICAgICAgIHRleHREZWxldGUgPSBcIlwiO1xuXHQgICAgICAgICAgdGV4dEluc2VydCA9IFwiXCI7XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXIrKztcblx0ICAgIH1cblxuXHQgICAgZGlmZnMucG9wKCk7IC8vIFJlbW92ZSB0aGUgZHVtbXkgZW50cnkgYXQgdGhlIGVuZC5cblxuXHQgICAgcmV0dXJuIGRpZmZzO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRmluZCB0aGUgJ21pZGRsZSBzbmFrZScgb2YgYSBkaWZmLCBzcGxpdCB0aGUgcHJvYmxlbSBpbiB0d29cblx0ICAgKiBhbmQgcmV0dXJuIHRoZSByZWN1cnNpdmVseSBjb25zdHJ1Y3RlZCBkaWZmLlxuXHQgICAqIFNlZSBNeWVycyAxOTg2IHBhcGVyOiBBbiBPKE5EKSBEaWZmZXJlbmNlIEFsZ29yaXRobSBhbmQgSXRzIFZhcmlhdGlvbnMuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIE9sZCBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBOZXcgc3RyaW5nIHRvIGJlIGRpZmZlZC5cblx0ICAgKiBAcGFyYW0ge251bWJlcn0gZGVhZGxpbmUgVGltZSBhdCB3aGljaCB0byBiYWlsIGlmIG5vdCB5ZXQgY29tcGxldGUuXG5cdCAgICogQHJldHVybiB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQmlzZWN0ID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0MiwgZGVhZGxpbmUpIHtcblx0ICAgIHZhciB0ZXh0MUxlbmd0aCwgdGV4dDJMZW5ndGgsIG1heEQsIHZPZmZzZXQsIHZMZW5ndGgsIHYxLCB2MiwgeCwgZGVsdGEsIGZyb250LCBrMXN0YXJ0LCBrMWVuZCwgazJzdGFydCwgazJlbmQsIGsyT2Zmc2V0LCBrMU9mZnNldCwgeDEsIHgyLCB5MSwgeTIsIGQsIGsxLCBrMjsgLy8gQ2FjaGUgdGhlIHRleHQgbGVuZ3RocyB0byBwcmV2ZW50IG11bHRpcGxlIGNhbGxzLlxuXG5cdCAgICB0ZXh0MUxlbmd0aCA9IHRleHQxLmxlbmd0aDtcblx0ICAgIHRleHQyTGVuZ3RoID0gdGV4dDIubGVuZ3RoO1xuXHQgICAgbWF4RCA9IE1hdGguY2VpbCgodGV4dDFMZW5ndGggKyB0ZXh0Mkxlbmd0aCkgLyAyKTtcblx0ICAgIHZPZmZzZXQgPSBtYXhEO1xuXHQgICAgdkxlbmd0aCA9IDIgKiBtYXhEO1xuXHQgICAgdjEgPSBuZXcgQXJyYXkodkxlbmd0aCk7XG5cdCAgICB2MiA9IG5ldyBBcnJheSh2TGVuZ3RoKTsgLy8gU2V0dGluZyBhbGwgZWxlbWVudHMgdG8gLTEgaXMgZmFzdGVyIGluIENocm9tZSAmIEZpcmVmb3ggdGhhbiBtaXhpbmdcblx0ICAgIC8vIGludGVnZXJzIGFuZCB1bmRlZmluZWQuXG5cblx0ICAgIGZvciAoeCA9IDA7IHggPCB2TGVuZ3RoOyB4KyspIHtcblx0ICAgICAgdjFbeF0gPSAtMTtcblx0ICAgICAgdjJbeF0gPSAtMTtcblx0ICAgIH1cblxuXHQgICAgdjFbdk9mZnNldCArIDFdID0gMDtcblx0ICAgIHYyW3ZPZmZzZXQgKyAxXSA9IDA7XG5cdCAgICBkZWx0YSA9IHRleHQxTGVuZ3RoIC0gdGV4dDJMZW5ndGg7IC8vIElmIHRoZSB0b3RhbCBudW1iZXIgb2YgY2hhcmFjdGVycyBpcyBvZGQsIHRoZW4gdGhlIGZyb250IHBhdGggd2lsbCBjb2xsaWRlXG5cdCAgICAvLyB3aXRoIHRoZSByZXZlcnNlIHBhdGguXG5cblx0ICAgIGZyb250ID0gZGVsdGEgJSAyICE9PSAwOyAvLyBPZmZzZXRzIGZvciBzdGFydCBhbmQgZW5kIG9mIGsgbG9vcC5cblx0ICAgIC8vIFByZXZlbnRzIG1hcHBpbmcgb2Ygc3BhY2UgYmV5b25kIHRoZSBncmlkLlxuXG5cdCAgICBrMXN0YXJ0ID0gMDtcblx0ICAgIGsxZW5kID0gMDtcblx0ICAgIGsyc3RhcnQgPSAwO1xuXHQgICAgazJlbmQgPSAwO1xuXG5cdCAgICBmb3IgKGQgPSAwOyBkIDwgbWF4RDsgZCsrKSB7XG5cdCAgICAgIC8vIEJhaWwgb3V0IGlmIGRlYWRsaW5lIGlzIHJlYWNoZWQuXG5cdCAgICAgIGlmIChuZXcgRGF0ZSgpLmdldFRpbWUoKSA+IGRlYWRsaW5lKSB7XG5cdCAgICAgICAgYnJlYWs7XG5cdCAgICAgIH0gLy8gV2FsayB0aGUgZnJvbnQgcGF0aCBvbmUgc3RlcC5cblxuXG5cdCAgICAgIGZvciAoazEgPSAtZCArIGsxc3RhcnQ7IGsxIDw9IGQgLSBrMWVuZDsgazEgKz0gMikge1xuXHQgICAgICAgIGsxT2Zmc2V0ID0gdk9mZnNldCArIGsxO1xuXG5cdCAgICAgICAgaWYgKGsxID09PSAtZCB8fCBrMSAhPT0gZCAmJiB2MVtrMU9mZnNldCAtIDFdIDwgdjFbazFPZmZzZXQgKyAxXSkge1xuXHQgICAgICAgICAgeDEgPSB2MVtrMU9mZnNldCArIDFdO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB4MSA9IHYxW2sxT2Zmc2V0IC0gMV0gKyAxO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHkxID0geDEgLSBrMTtcblxuXHQgICAgICAgIHdoaWxlICh4MSA8IHRleHQxTGVuZ3RoICYmIHkxIDwgdGV4dDJMZW5ndGggJiYgdGV4dDEuY2hhckF0KHgxKSA9PT0gdGV4dDIuY2hhckF0KHkxKSkge1xuXHQgICAgICAgICAgeDErKztcblx0ICAgICAgICAgIHkxKys7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgdjFbazFPZmZzZXRdID0geDE7XG5cblx0ICAgICAgICBpZiAoeDEgPiB0ZXh0MUxlbmd0aCkge1xuXHQgICAgICAgICAgLy8gUmFuIG9mZiB0aGUgcmlnaHQgb2YgdGhlIGdyYXBoLlxuXHQgICAgICAgICAgazFlbmQgKz0gMjtcblx0ICAgICAgICB9IGVsc2UgaWYgKHkxID4gdGV4dDJMZW5ndGgpIHtcblx0ICAgICAgICAgIC8vIFJhbiBvZmYgdGhlIGJvdHRvbSBvZiB0aGUgZ3JhcGguXG5cdCAgICAgICAgICBrMXN0YXJ0ICs9IDI7XG5cdCAgICAgICAgfSBlbHNlIGlmIChmcm9udCkge1xuXHQgICAgICAgICAgazJPZmZzZXQgPSB2T2Zmc2V0ICsgZGVsdGEgLSBrMTtcblxuXHQgICAgICAgICAgaWYgKGsyT2Zmc2V0ID49IDAgJiYgazJPZmZzZXQgPCB2TGVuZ3RoICYmIHYyW2syT2Zmc2V0XSAhPT0gLTEpIHtcblx0ICAgICAgICAgICAgLy8gTWlycm9yIHgyIG9udG8gdG9wLWxlZnQgY29vcmRpbmF0ZSBzeXN0ZW0uXG5cdCAgICAgICAgICAgIHgyID0gdGV4dDFMZW5ndGggLSB2MltrMk9mZnNldF07XG5cblx0ICAgICAgICAgICAgaWYgKHgxID49IHgyKSB7XG5cdCAgICAgICAgICAgICAgLy8gT3ZlcmxhcCBkZXRlY3RlZC5cblx0ICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaWZmQmlzZWN0U3BsaXQodGV4dDEsIHRleHQyLCB4MSwgeTEsIGRlYWRsaW5lKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfSAvLyBXYWxrIHRoZSByZXZlcnNlIHBhdGggb25lIHN0ZXAuXG5cblxuXHQgICAgICBmb3IgKGsyID0gLWQgKyBrMnN0YXJ0OyBrMiA8PSBkIC0gazJlbmQ7IGsyICs9IDIpIHtcblx0ICAgICAgICBrMk9mZnNldCA9IHZPZmZzZXQgKyBrMjtcblxuXHQgICAgICAgIGlmIChrMiA9PT0gLWQgfHwgazIgIT09IGQgJiYgdjJbazJPZmZzZXQgLSAxXSA8IHYyW2syT2Zmc2V0ICsgMV0pIHtcblx0ICAgICAgICAgIHgyID0gdjJbazJPZmZzZXQgKyAxXTtcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgeDIgPSB2MltrMk9mZnNldCAtIDFdICsgMTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICB5MiA9IHgyIC0gazI7XG5cblx0ICAgICAgICB3aGlsZSAoeDIgPCB0ZXh0MUxlbmd0aCAmJiB5MiA8IHRleHQyTGVuZ3RoICYmIHRleHQxLmNoYXJBdCh0ZXh0MUxlbmd0aCAtIHgyIC0gMSkgPT09IHRleHQyLmNoYXJBdCh0ZXh0Mkxlbmd0aCAtIHkyIC0gMSkpIHtcblx0ICAgICAgICAgIHgyKys7XG5cdCAgICAgICAgICB5MisrO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHYyW2syT2Zmc2V0XSA9IHgyO1xuXG5cdCAgICAgICAgaWYgKHgyID4gdGV4dDFMZW5ndGgpIHtcblx0ICAgICAgICAgIC8vIFJhbiBvZmYgdGhlIGxlZnQgb2YgdGhlIGdyYXBoLlxuXHQgICAgICAgICAgazJlbmQgKz0gMjtcblx0ICAgICAgICB9IGVsc2UgaWYgKHkyID4gdGV4dDJMZW5ndGgpIHtcblx0ICAgICAgICAgIC8vIFJhbiBvZmYgdGhlIHRvcCBvZiB0aGUgZ3JhcGguXG5cdCAgICAgICAgICBrMnN0YXJ0ICs9IDI7XG5cdCAgICAgICAgfSBlbHNlIGlmICghZnJvbnQpIHtcblx0ICAgICAgICAgIGsxT2Zmc2V0ID0gdk9mZnNldCArIGRlbHRhIC0gazI7XG5cblx0ICAgICAgICAgIGlmIChrMU9mZnNldCA+PSAwICYmIGsxT2Zmc2V0IDwgdkxlbmd0aCAmJiB2MVtrMU9mZnNldF0gIT09IC0xKSB7XG5cdCAgICAgICAgICAgIHgxID0gdjFbazFPZmZzZXRdO1xuXHQgICAgICAgICAgICB5MSA9IHZPZmZzZXQgKyB4MSAtIGsxT2Zmc2V0OyAvLyBNaXJyb3IgeDIgb250byB0b3AtbGVmdCBjb29yZGluYXRlIHN5c3RlbS5cblxuXHQgICAgICAgICAgICB4MiA9IHRleHQxTGVuZ3RoIC0geDI7XG5cblx0ICAgICAgICAgICAgaWYgKHgxID49IHgyKSB7XG5cdCAgICAgICAgICAgICAgLy8gT3ZlcmxhcCBkZXRlY3RlZC5cblx0ICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kaWZmQmlzZWN0U3BsaXQodGV4dDEsIHRleHQyLCB4MSwgeTEsIGRlYWRsaW5lKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSAvLyBEaWZmIHRvb2sgdG9vIGxvbmcgYW5kIGhpdCB0aGUgZGVhZGxpbmUgb3Jcblx0ICAgIC8vIG51bWJlciBvZiBkaWZmcyBlcXVhbHMgbnVtYmVyIG9mIGNoYXJhY3RlcnMsIG5vIGNvbW1vbmFsaXR5IGF0IGFsbC5cblxuXG5cdCAgICByZXR1cm4gW1tESUZGX0RFTEVURSwgdGV4dDFdLCBbRElGRl9JTlNFUlQsIHRleHQyXV07XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBHaXZlbiB0aGUgbG9jYXRpb24gb2YgdGhlICdtaWRkbGUgc25ha2UnLCBzcGxpdCB0aGUgZGlmZiBpbiB0d28gcGFydHNcblx0ICAgKiBhbmQgcmVjdXJzZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgT2xkIHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIE5ldyBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7bnVtYmVyfSB4IEluZGV4IG9mIHNwbGl0IHBvaW50IGluIHRleHQxLlxuXHQgICAqIEBwYXJhbSB7bnVtYmVyfSB5IEluZGV4IG9mIHNwbGl0IHBvaW50IGluIHRleHQyLlxuXHQgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWFkbGluZSBUaW1lIGF0IHdoaWNoIHRvIGJhaWwgaWYgbm90IHlldCBjb21wbGV0ZS5cblx0ICAgKiBAcmV0dXJuIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZCaXNlY3RTcGxpdCA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIsIHgsIHksIGRlYWRsaW5lKSB7XG5cdCAgICB2YXIgdGV4dDFhLCB0ZXh0MWIsIHRleHQyYSwgdGV4dDJiLCBkaWZmcywgZGlmZnNiO1xuXHQgICAgdGV4dDFhID0gdGV4dDEuc3Vic3RyaW5nKDAsIHgpO1xuXHQgICAgdGV4dDJhID0gdGV4dDIuc3Vic3RyaW5nKDAsIHkpO1xuXHQgICAgdGV4dDFiID0gdGV4dDEuc3Vic3RyaW5nKHgpO1xuXHQgICAgdGV4dDJiID0gdGV4dDIuc3Vic3RyaW5nKHkpOyAvLyBDb21wdXRlIGJvdGggZGlmZnMgc2VyaWFsbHkuXG5cblx0ICAgIGRpZmZzID0gdGhpcy5EaWZmTWFpbih0ZXh0MWEsIHRleHQyYSwgZmFsc2UsIGRlYWRsaW5lKTtcblx0ICAgIGRpZmZzYiA9IHRoaXMuRGlmZk1haW4odGV4dDFiLCB0ZXh0MmIsIGZhbHNlLCBkZWFkbGluZSk7XG5cdCAgICByZXR1cm4gZGlmZnMuY29uY2F0KGRpZmZzYik7XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBSZWR1Y2UgdGhlIG51bWJlciBvZiBlZGl0cyBieSBlbGltaW5hdGluZyBzZW1hbnRpY2FsbHkgdHJpdmlhbCBlcXVhbGl0aWVzLlxuXHQgICAqIEBwYXJhbSB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IGRpZmZzIEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkNsZWFudXBTZW1hbnRpYyA9IGZ1bmN0aW9uIChkaWZmcykge1xuXHQgICAgdmFyIGNoYW5nZXMsIGVxdWFsaXRpZXMsIGVxdWFsaXRpZXNMZW5ndGgsIGxhc3RlcXVhbGl0eSwgcG9pbnRlciwgbGVuZ3RoSW5zZXJ0aW9uczIsIGxlbmd0aERlbGV0aW9uczIsIGxlbmd0aEluc2VydGlvbnMxLCBsZW5ndGhEZWxldGlvbnMxLCBkZWxldGlvbiwgaW5zZXJ0aW9uLCBvdmVybGFwTGVuZ3RoMSwgb3ZlcmxhcExlbmd0aDI7XG5cdCAgICBjaGFuZ2VzID0gZmFsc2U7XG5cdCAgICBlcXVhbGl0aWVzID0gW107IC8vIFN0YWNrIG9mIGluZGljZXMgd2hlcmUgZXF1YWxpdGllcyBhcmUgZm91bmQuXG5cblx0ICAgIGVxdWFsaXRpZXNMZW5ndGggPSAwOyAvLyBLZWVwaW5nIG91ciBvd24gbGVuZ3RoIHZhciBpcyBmYXN0ZXIgaW4gSlMuXG5cblx0ICAgIC8qKiBAdHlwZSB7P3N0cmluZ30gKi9cblxuXHQgICAgbGFzdGVxdWFsaXR5ID0gbnVsbDsgLy8gQWx3YXlzIGVxdWFsIHRvIGRpZmZzW2VxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdXVsxXVxuXG5cdCAgICBwb2ludGVyID0gMDsgLy8gSW5kZXggb2YgY3VycmVudCBwb3NpdGlvbi5cblx0ICAgIC8vIE51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgY2hhbmdlZCBwcmlvciB0byB0aGUgZXF1YWxpdHkuXG5cblx0ICAgIGxlbmd0aEluc2VydGlvbnMxID0gMDtcblx0ICAgIGxlbmd0aERlbGV0aW9uczEgPSAwOyAvLyBOdW1iZXIgb2YgY2hhcmFjdGVycyB0aGF0IGNoYW5nZWQgYWZ0ZXIgdGhlIGVxdWFsaXR5LlxuXG5cdCAgICBsZW5ndGhJbnNlcnRpb25zMiA9IDA7XG5cdCAgICBsZW5ndGhEZWxldGlvbnMyID0gMDtcblxuXHQgICAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGgpIHtcblx0ICAgICAgaWYgKGRpZmZzW3BvaW50ZXJdWzBdID09PSBESUZGX0VRVUFMKSB7XG5cdCAgICAgICAgLy8gRXF1YWxpdHkgZm91bmQuXG5cdCAgICAgICAgZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoKytdID0gcG9pbnRlcjtcblx0ICAgICAgICBsZW5ndGhJbnNlcnRpb25zMSA9IGxlbmd0aEluc2VydGlvbnMyO1xuXHQgICAgICAgIGxlbmd0aERlbGV0aW9uczEgPSBsZW5ndGhEZWxldGlvbnMyO1xuXHQgICAgICAgIGxlbmd0aEluc2VydGlvbnMyID0gMDtcblx0ICAgICAgICBsZW5ndGhEZWxldGlvbnMyID0gMDtcblx0ICAgICAgICBsYXN0ZXF1YWxpdHkgPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAvLyBBbiBpbnNlcnRpb24gb3IgZGVsZXRpb24uXG5cdCAgICAgICAgaWYgKGRpZmZzW3BvaW50ZXJdWzBdID09PSBESUZGX0lOU0VSVCkge1xuXHQgICAgICAgICAgbGVuZ3RoSW5zZXJ0aW9uczIgKz0gZGlmZnNbcG9pbnRlcl1bMV0ubGVuZ3RoO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBsZW5ndGhEZWxldGlvbnMyICs9IGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aDtcblx0ICAgICAgICB9IC8vIEVsaW1pbmF0ZSBhbiBlcXVhbGl0eSB0aGF0IGlzIHNtYWxsZXIgb3IgZXF1YWwgdG8gdGhlIGVkaXRzIG9uIGJvdGhcblx0ICAgICAgICAvLyBzaWRlcyBvZiBpdC5cblxuXG5cdCAgICAgICAgaWYgKGxhc3RlcXVhbGl0eSAmJiBsYXN0ZXF1YWxpdHkubGVuZ3RoIDw9IE1hdGgubWF4KGxlbmd0aEluc2VydGlvbnMxLCBsZW5ndGhEZWxldGlvbnMxKSAmJiBsYXN0ZXF1YWxpdHkubGVuZ3RoIDw9IE1hdGgubWF4KGxlbmd0aEluc2VydGlvbnMyLCBsZW5ndGhEZWxldGlvbnMyKSkge1xuXHQgICAgICAgICAgLy8gRHVwbGljYXRlIHJlY29yZC5cblx0ICAgICAgICAgIGRpZmZzLnNwbGljZShlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSwgMCwgW0RJRkZfREVMRVRFLCBsYXN0ZXF1YWxpdHldKTsgLy8gQ2hhbmdlIHNlY29uZCBjb3B5IHRvIGluc2VydC5cblxuXHQgICAgICAgICAgZGlmZnNbZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoIC0gMV0gKyAxXVswXSA9IERJRkZfSU5TRVJUOyAvLyBUaHJvdyBhd2F5IHRoZSBlcXVhbGl0eSB3ZSBqdXN0IGRlbGV0ZWQuXG5cblx0ICAgICAgICAgIGVxdWFsaXRpZXNMZW5ndGgtLTsgLy8gVGhyb3cgYXdheSB0aGUgcHJldmlvdXMgZXF1YWxpdHkgKGl0IG5lZWRzIHRvIGJlIHJlZXZhbHVhdGVkKS5cblxuXHQgICAgICAgICAgZXF1YWxpdGllc0xlbmd0aC0tO1xuXHQgICAgICAgICAgcG9pbnRlciA9IGVxdWFsaXRpZXNMZW5ndGggPiAwID8gZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoIC0gMV0gOiAtMTsgLy8gUmVzZXQgdGhlIGNvdW50ZXJzLlxuXG5cdCAgICAgICAgICBsZW5ndGhJbnNlcnRpb25zMSA9IDA7XG5cdCAgICAgICAgICBsZW5ndGhEZWxldGlvbnMxID0gMDtcblx0ICAgICAgICAgIGxlbmd0aEluc2VydGlvbnMyID0gMDtcblx0ICAgICAgICAgIGxlbmd0aERlbGV0aW9uczIgPSAwO1xuXHQgICAgICAgICAgbGFzdGVxdWFsaXR5ID0gbnVsbDtcblx0ICAgICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXIrKztcblx0ICAgIH0gLy8gTm9ybWFsaXplIHRoZSBkaWZmLlxuXG5cblx0ICAgIGlmIChjaGFuZ2VzKSB7XG5cdCAgICAgIHRoaXMuZGlmZkNsZWFudXBNZXJnZShkaWZmcyk7XG5cdCAgICB9IC8vIEZpbmQgYW55IG92ZXJsYXBzIGJldHdlZW4gZGVsZXRpb25zIGFuZCBpbnNlcnRpb25zLlxuXHQgICAgLy8gZS5nOiA8ZGVsPmFiY3h4eDwvZGVsPjxpbnM+eHh4ZGVmPC9pbnM+XG5cdCAgICAvLyAgIC0+IDxkZWw+YWJjPC9kZWw+eHh4PGlucz5kZWY8L2lucz5cblx0ICAgIC8vIGUuZzogPGRlbD54eHhhYmM8L2RlbD48aW5zPmRlZnh4eDwvaW5zPlxuXHQgICAgLy8gICAtPiA8aW5zPmRlZjwvaW5zPnh4eDxkZWw+YWJjPC9kZWw+XG5cdCAgICAvLyBPbmx5IGV4dHJhY3QgYW4gb3ZlcmxhcCBpZiBpdCBpcyBhcyBiaWcgYXMgdGhlIGVkaXQgYWhlYWQgb3IgYmVoaW5kIGl0LlxuXG5cblx0ICAgIHBvaW50ZXIgPSAxO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuXHQgICAgICBpZiAoZGlmZnNbcG9pbnRlciAtIDFdWzBdID09PSBESUZGX0RFTEVURSAmJiBkaWZmc1twb2ludGVyXVswXSA9PT0gRElGRl9JTlNFUlQpIHtcblx0ICAgICAgICBkZWxldGlvbiA9IGRpZmZzW3BvaW50ZXIgLSAxXVsxXTtcblx0ICAgICAgICBpbnNlcnRpb24gPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICBvdmVybGFwTGVuZ3RoMSA9IHRoaXMuZGlmZkNvbW1vbk92ZXJsYXAoZGVsZXRpb24sIGluc2VydGlvbik7XG5cdCAgICAgICAgb3ZlcmxhcExlbmd0aDIgPSB0aGlzLmRpZmZDb21tb25PdmVybGFwKGluc2VydGlvbiwgZGVsZXRpb24pO1xuXG5cdCAgICAgICAgaWYgKG92ZXJsYXBMZW5ndGgxID49IG92ZXJsYXBMZW5ndGgyKSB7XG5cdCAgICAgICAgICBpZiAob3ZlcmxhcExlbmd0aDEgPj0gZGVsZXRpb24ubGVuZ3RoIC8gMiB8fCBvdmVybGFwTGVuZ3RoMSA+PSBpbnNlcnRpb24ubGVuZ3RoIC8gMikge1xuXHQgICAgICAgICAgICAvLyBPdmVybGFwIGZvdW5kLiAgSW5zZXJ0IGFuIGVxdWFsaXR5IGFuZCB0cmltIHRoZSBzdXJyb3VuZGluZyBlZGl0cy5cblx0ICAgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIsIDAsIFtESUZGX0VRVUFMLCBpbnNlcnRpb24uc3Vic3RyaW5nKDAsIG92ZXJsYXBMZW5ndGgxKV0pO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMV0gPSBkZWxldGlvbi5zdWJzdHJpbmcoMCwgZGVsZXRpb24ubGVuZ3RoIC0gb3ZlcmxhcExlbmd0aDEpO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyICsgMV1bMV0gPSBpbnNlcnRpb24uc3Vic3RyaW5nKG92ZXJsYXBMZW5ndGgxKTtcblx0ICAgICAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBpZiAob3ZlcmxhcExlbmd0aDIgPj0gZGVsZXRpb24ubGVuZ3RoIC8gMiB8fCBvdmVybGFwTGVuZ3RoMiA+PSBpbnNlcnRpb24ubGVuZ3RoIC8gMikge1xuXHQgICAgICAgICAgICAvLyBSZXZlcnNlIG92ZXJsYXAgZm91bmQuXG5cdCAgICAgICAgICAgIC8vIEluc2VydCBhbiBlcXVhbGl0eSBhbmQgc3dhcCBhbmQgdHJpbSB0aGUgc3Vycm91bmRpbmcgZWRpdHMuXG5cdCAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyLCAwLCBbRElGRl9FUVVBTCwgZGVsZXRpb24uc3Vic3RyaW5nKDAsIG92ZXJsYXBMZW5ndGgyKV0pO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMF0gPSBESUZGX0lOU0VSVDtcblx0ICAgICAgICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzFdID0gaW5zZXJ0aW9uLnN1YnN0cmluZygwLCBpbnNlcnRpb24ubGVuZ3RoIC0gb3ZlcmxhcExlbmd0aDIpO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyICsgMV1bMF0gPSBESUZGX0RFTEVURTtcblx0ICAgICAgICAgICAgZGlmZnNbcG9pbnRlciArIDFdWzFdID0gZGVsZXRpb24uc3Vic3RyaW5nKG92ZXJsYXBMZW5ndGgyKTtcblx0ICAgICAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHBvaW50ZXIrKztcblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXIrKztcblx0ICAgIH1cblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIERldGVybWluZSBpZiB0aGUgc3VmZml4IG9mIG9uZSBzdHJpbmcgaXMgdGhlIHByZWZpeCBvZiBhbm90aGVyLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIFNlY29uZCBzdHJpbmcuXG5cdCAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgY29tbW9uIHRvIHRoZSBlbmQgb2YgdGhlIGZpcnN0XG5cdCAgICogICAgIHN0cmluZyBhbmQgdGhlIHN0YXJ0IG9mIHRoZSBzZWNvbmQgc3RyaW5nLlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ29tbW9uT3ZlcmxhcCA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIpIHtcblx0ICAgIHZhciB0ZXh0MUxlbmd0aCwgdGV4dDJMZW5ndGgsIHRleHRMZW5ndGgsIGJlc3QsIGxlbmd0aCwgcGF0dGVybiwgZm91bmQ7IC8vIENhY2hlIHRoZSB0ZXh0IGxlbmd0aHMgdG8gcHJldmVudCBtdWx0aXBsZSBjYWxscy5cblxuXHQgICAgdGV4dDFMZW5ndGggPSB0ZXh0MS5sZW5ndGg7XG5cdCAgICB0ZXh0Mkxlbmd0aCA9IHRleHQyLmxlbmd0aDsgLy8gRWxpbWluYXRlIHRoZSBudWxsIGNhc2UuXG5cblx0ICAgIGlmICh0ZXh0MUxlbmd0aCA9PT0gMCB8fCB0ZXh0Mkxlbmd0aCA9PT0gMCkge1xuXHQgICAgICByZXR1cm4gMDtcblx0ICAgIH0gLy8gVHJ1bmNhdGUgdGhlIGxvbmdlciBzdHJpbmcuXG5cblxuXHQgICAgaWYgKHRleHQxTGVuZ3RoID4gdGV4dDJMZW5ndGgpIHtcblx0ICAgICAgdGV4dDEgPSB0ZXh0MS5zdWJzdHJpbmcodGV4dDFMZW5ndGggLSB0ZXh0Mkxlbmd0aCk7XG5cdCAgICB9IGVsc2UgaWYgKHRleHQxTGVuZ3RoIDwgdGV4dDJMZW5ndGgpIHtcblx0ICAgICAgdGV4dDIgPSB0ZXh0Mi5zdWJzdHJpbmcoMCwgdGV4dDFMZW5ndGgpO1xuXHQgICAgfVxuXG5cdCAgICB0ZXh0TGVuZ3RoID0gTWF0aC5taW4odGV4dDFMZW5ndGgsIHRleHQyTGVuZ3RoKTsgLy8gUXVpY2sgY2hlY2sgZm9yIHRoZSB3b3JzdCBjYXNlLlxuXG5cdCAgICBpZiAodGV4dDEgPT09IHRleHQyKSB7XG5cdCAgICAgIHJldHVybiB0ZXh0TGVuZ3RoO1xuXHQgICAgfSAvLyBTdGFydCBieSBsb29raW5nIGZvciBhIHNpbmdsZSBjaGFyYWN0ZXIgbWF0Y2hcblx0ICAgIC8vIGFuZCBpbmNyZWFzZSBsZW5ndGggdW50aWwgbm8gbWF0Y2ggaXMgZm91bmQuXG5cdCAgICAvLyBQZXJmb3JtYW5jZSBhbmFseXNpczogaHR0cHM6Ly9uZWlsLmZyYXNlci5uYW1lL25ld3MvMjAxMC8xMS8wNC9cblxuXG5cdCAgICBiZXN0ID0gMDtcblx0ICAgIGxlbmd0aCA9IDE7XG5cblx0ICAgIHdoaWxlICh0cnVlKSB7XG5cdCAgICAgIHBhdHRlcm4gPSB0ZXh0MS5zdWJzdHJpbmcodGV4dExlbmd0aCAtIGxlbmd0aCk7XG5cdCAgICAgIGZvdW5kID0gdGV4dDIuaW5kZXhPZihwYXR0ZXJuKTtcblxuXHQgICAgICBpZiAoZm91bmQgPT09IC0xKSB7XG5cdCAgICAgICAgcmV0dXJuIGJlc3Q7XG5cdCAgICAgIH1cblxuXHQgICAgICBsZW5ndGggKz0gZm91bmQ7XG5cblx0ICAgICAgaWYgKGZvdW5kID09PSAwIHx8IHRleHQxLnN1YnN0cmluZyh0ZXh0TGVuZ3RoIC0gbGVuZ3RoKSA9PT0gdGV4dDIuc3Vic3RyaW5nKDAsIGxlbmd0aCkpIHtcblx0ICAgICAgICBiZXN0ID0gbGVuZ3RoO1xuXHQgICAgICAgIGxlbmd0aCsrO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBTcGxpdCB0d28gdGV4dHMgaW50byBhbiBhcnJheSBvZiBzdHJpbmdzLiAgUmVkdWNlIHRoZSB0ZXh0cyB0byBhIHN0cmluZyBvZlxuXHQgICAqIGhhc2hlcyB3aGVyZSBlYWNoIFVuaWNvZGUgY2hhcmFjdGVyIHJlcHJlc2VudHMgb25lIGxpbmUuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIEZpcnN0IHN0cmluZy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgU2Vjb25kIHN0cmluZy5cblx0ICAgKiBAcmV0dXJuIHt7Y2hhcnMxOiBzdHJpbmcsIGNoYXJzMjogc3RyaW5nLCBsaW5lQXJyYXk6ICFBcnJheS48c3RyaW5nPn19XG5cdCAgICogICAgIEFuIG9iamVjdCBjb250YWluaW5nIHRoZSBlbmNvZGVkIHRleHQxLCB0aGUgZW5jb2RlZCB0ZXh0MiBhbmRcblx0ICAgKiAgICAgdGhlIGFycmF5IG9mIHVuaXF1ZSBzdHJpbmdzLlxuXHQgICAqICAgICBUaGUgemVyb3RoIGVsZW1lbnQgb2YgdGhlIGFycmF5IG9mIHVuaXF1ZSBzdHJpbmdzIGlzIGludGVudGlvbmFsbHkgYmxhbmsuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZMaW5lc1RvQ2hhcnMgPSBmdW5jdGlvbiAodGV4dDEsIHRleHQyKSB7XG5cdCAgICB2YXIgbGluZUFycmF5LCBsaW5lSGFzaCwgY2hhcnMxLCBjaGFyczI7XG5cdCAgICBsaW5lQXJyYXkgPSBbXTsgLy8gRS5nLiBsaW5lQXJyYXlbNF0gPT09ICdIZWxsb1xcbidcblxuXHQgICAgbGluZUhhc2ggPSB7fTsgLy8gRS5nLiBsaW5lSGFzaFsnSGVsbG9cXG4nXSA9PT0gNFxuXHQgICAgLy8gJ1xceDAwJyBpcyBhIHZhbGlkIGNoYXJhY3RlciwgYnV0IHZhcmlvdXMgZGVidWdnZXJzIGRvbid0IGxpa2UgaXQuXG5cdCAgICAvLyBTbyB3ZSdsbCBpbnNlcnQgYSBqdW5rIGVudHJ5IHRvIGF2b2lkIGdlbmVyYXRpbmcgYSBudWxsIGNoYXJhY3Rlci5cblxuXHQgICAgbGluZUFycmF5WzBdID0gXCJcIjtcblx0ICAgIC8qKlxuXHQgICAgICogU3BsaXQgYSB0ZXh0IGludG8gYW4gYXJyYXkgb2Ygc3RyaW5ncy4gIFJlZHVjZSB0aGUgdGV4dHMgdG8gYSBzdHJpbmcgb2Zcblx0ICAgICAqIGhhc2hlcyB3aGVyZSBlYWNoIFVuaWNvZGUgY2hhcmFjdGVyIHJlcHJlc2VudHMgb25lIGxpbmUuXG5cdCAgICAgKiBNb2RpZmllcyBsaW5lYXJyYXkgYW5kIGxpbmVoYXNoIHRocm91Z2ggYmVpbmcgYSBjbG9zdXJlLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQgU3RyaW5nIHRvIGVuY29kZS5cblx0ICAgICAqIEByZXR1cm4ge3N0cmluZ30gRW5jb2RlZCBzdHJpbmcuXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cblx0ICAgIGZ1bmN0aW9uIGRpZmZMaW5lc1RvQ2hhcnNNdW5nZSh0ZXh0KSB7XG5cdCAgICAgIHZhciBjaGFycywgbGluZVN0YXJ0LCBsaW5lRW5kLCBsaW5lQXJyYXlMZW5ndGgsIGxpbmU7XG5cdCAgICAgIGNoYXJzID0gXCJcIjsgLy8gV2FsayB0aGUgdGV4dCwgcHVsbGluZyBvdXQgYSBzdWJzdHJpbmcgZm9yIGVhY2ggbGluZS5cblx0ICAgICAgLy8gdGV4dC5zcGxpdCgnXFxuJykgd291bGQgd291bGQgdGVtcG9yYXJpbHkgZG91YmxlIG91ciBtZW1vcnkgZm9vdHByaW50LlxuXHQgICAgICAvLyBNb2RpZnlpbmcgdGV4dCB3b3VsZCBjcmVhdGUgbWFueSBsYXJnZSBzdHJpbmdzIHRvIGdhcmJhZ2UgY29sbGVjdC5cblxuXHQgICAgICBsaW5lU3RhcnQgPSAwO1xuXHQgICAgICBsaW5lRW5kID0gLTE7IC8vIEtlZXBpbmcgb3VyIG93biBsZW5ndGggdmFyaWFibGUgaXMgZmFzdGVyIHRoYW4gbG9va2luZyBpdCB1cC5cblxuXHQgICAgICBsaW5lQXJyYXlMZW5ndGggPSBsaW5lQXJyYXkubGVuZ3RoO1xuXG5cdCAgICAgIHdoaWxlIChsaW5lRW5kIDwgdGV4dC5sZW5ndGggLSAxKSB7XG5cdCAgICAgICAgbGluZUVuZCA9IHRleHQuaW5kZXhPZihcIlxcblwiLCBsaW5lU3RhcnQpO1xuXG5cdCAgICAgICAgaWYgKGxpbmVFbmQgPT09IC0xKSB7XG5cdCAgICAgICAgICBsaW5lRW5kID0gdGV4dC5sZW5ndGggLSAxO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGxpbmUgPSB0ZXh0LnN1YnN0cmluZyhsaW5lU3RhcnQsIGxpbmVFbmQgKyAxKTtcblx0ICAgICAgICBsaW5lU3RhcnQgPSBsaW5lRW5kICsgMTtcblxuXHQgICAgICAgIGlmIChoYXNPd24uY2FsbChsaW5lSGFzaCwgbGluZSkpIHtcblx0ICAgICAgICAgIGNoYXJzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUobGluZUhhc2hbbGluZV0pO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBjaGFycyArPSBTdHJpbmcuZnJvbUNoYXJDb2RlKGxpbmVBcnJheUxlbmd0aCk7XG5cdCAgICAgICAgICBsaW5lSGFzaFtsaW5lXSA9IGxpbmVBcnJheUxlbmd0aDtcblx0ICAgICAgICAgIGxpbmVBcnJheVtsaW5lQXJyYXlMZW5ndGgrK10gPSBsaW5lO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBjaGFycztcblx0ICAgIH1cblxuXHQgICAgY2hhcnMxID0gZGlmZkxpbmVzVG9DaGFyc011bmdlKHRleHQxKTtcblx0ICAgIGNoYXJzMiA9IGRpZmZMaW5lc1RvQ2hhcnNNdW5nZSh0ZXh0Mik7XG5cdCAgICByZXR1cm4ge1xuXHQgICAgICBjaGFyczE6IGNoYXJzMSxcblx0ICAgICAgY2hhcnMyOiBjaGFyczIsXG5cdCAgICAgIGxpbmVBcnJheTogbGluZUFycmF5XG5cdCAgICB9O1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogUmVoeWRyYXRlIHRoZSB0ZXh0IGluIGEgZGlmZiBmcm9tIGEgc3RyaW5nIG9mIGxpbmUgaGFzaGVzIHRvIHJlYWwgbGluZXMgb2Zcblx0ICAgKiB0ZXh0LlxuXHQgICAqIEBwYXJhbSB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IGRpZmZzIEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqIEBwYXJhbSB7IUFycmF5LjxzdHJpbmc+fSBsaW5lQXJyYXkgQXJyYXkgb2YgdW5pcXVlIHN0cmluZ3MuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDaGFyc1RvTGluZXMgPSBmdW5jdGlvbiAoZGlmZnMsIGxpbmVBcnJheSkge1xuXHQgICAgdmFyIHgsIGNoYXJzLCB0ZXh0LCB5O1xuXG5cdCAgICBmb3IgKHggPSAwOyB4IDwgZGlmZnMubGVuZ3RoOyB4KyspIHtcblx0ICAgICAgY2hhcnMgPSBkaWZmc1t4XVsxXTtcblx0ICAgICAgdGV4dCA9IFtdO1xuXG5cdCAgICAgIGZvciAoeSA9IDA7IHkgPCBjaGFycy5sZW5ndGg7IHkrKykge1xuXHQgICAgICAgIHRleHRbeV0gPSBsaW5lQXJyYXlbY2hhcnMuY2hhckNvZGVBdCh5KV07XG5cdCAgICAgIH1cblxuXHQgICAgICBkaWZmc1t4XVsxXSA9IHRleHQuam9pbihcIlwiKTtcblx0ICAgIH1cblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIFJlb3JkZXIgYW5kIG1lcmdlIGxpa2UgZWRpdCBzZWN0aW9ucy4gIE1lcmdlIGVxdWFsaXRpZXMuXG5cdCAgICogQW55IGVkaXQgc2VjdGlvbiBjYW4gbW92ZSBhcyBsb25nIGFzIGl0IGRvZXNuJ3QgY3Jvc3MgYW4gZXF1YWxpdHkuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gZGlmZnMgQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ2xlYW51cE1lcmdlID0gZnVuY3Rpb24gKGRpZmZzKSB7XG5cdCAgICB2YXIgcG9pbnRlciwgY291bnREZWxldGUsIGNvdW50SW5zZXJ0LCB0ZXh0SW5zZXJ0LCB0ZXh0RGVsZXRlLCBjb21tb25sZW5ndGgsIGNoYW5nZXMsIGRpZmZQb2ludGVyLCBwb3NpdGlvbjtcblx0ICAgIGRpZmZzLnB1c2goW0RJRkZfRVFVQUwsIFwiXCJdKTsgLy8gQWRkIGEgZHVtbXkgZW50cnkgYXQgdGhlIGVuZC5cblxuXHQgICAgcG9pbnRlciA9IDA7XG5cdCAgICBjb3VudERlbGV0ZSA9IDA7XG5cdCAgICBjb3VudEluc2VydCA9IDA7XG5cdCAgICB0ZXh0RGVsZXRlID0gXCJcIjtcblx0ICAgIHRleHRJbnNlcnQgPSBcIlwiO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuXHQgICAgICBzd2l0Y2ggKGRpZmZzW3BvaW50ZXJdWzBdKSB7XG5cdCAgICAgICAgY2FzZSBESUZGX0lOU0VSVDpcblx0ICAgICAgICAgIGNvdW50SW5zZXJ0Kys7XG5cdCAgICAgICAgICB0ZXh0SW5zZXJ0ICs9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICAgICAgYnJlYWs7XG5cblx0ICAgICAgICBjYXNlIERJRkZfREVMRVRFOlxuXHQgICAgICAgICAgY291bnREZWxldGUrKztcblx0ICAgICAgICAgIHRleHREZWxldGUgKz0gZGlmZnNbcG9pbnRlcl1bMV07XG5cdCAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICBicmVhaztcblxuXHQgICAgICAgIGNhc2UgRElGRl9FUVVBTDpcblx0ICAgICAgICAgIC8vIFVwb24gcmVhY2hpbmcgYW4gZXF1YWxpdHksIGNoZWNrIGZvciBwcmlvciByZWR1bmRhbmNpZXMuXG5cdCAgICAgICAgICBpZiAoY291bnREZWxldGUgKyBjb3VudEluc2VydCA+IDEpIHtcblx0ICAgICAgICAgICAgaWYgKGNvdW50RGVsZXRlICE9PSAwICYmIGNvdW50SW5zZXJ0ICE9PSAwKSB7XG5cdCAgICAgICAgICAgICAgLy8gRmFjdG9yIG91dCBhbnkgY29tbW9uIHByZWZpeGVzLlxuXHQgICAgICAgICAgICAgIGNvbW1vbmxlbmd0aCA9IHRoaXMuZGlmZkNvbW1vblByZWZpeCh0ZXh0SW5zZXJ0LCB0ZXh0RGVsZXRlKTtcblxuXHQgICAgICAgICAgICAgIGlmIChjb21tb25sZW5ndGggIT09IDApIHtcblx0ICAgICAgICAgICAgICAgIGlmIChwb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydCA+IDAgJiYgZGlmZnNbcG9pbnRlciAtIGNvdW50RGVsZXRlIC0gY291bnRJbnNlcnQgLSAxXVswXSA9PT0gRElGRl9FUVVBTCkge1xuXHQgICAgICAgICAgICAgICAgICBkaWZmc1twb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydCAtIDFdWzFdICs9IHRleHRJbnNlcnQuc3Vic3RyaW5nKDAsIGNvbW1vbmxlbmd0aCk7XG5cdCAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICBkaWZmcy5zcGxpY2UoMCwgMCwgW0RJRkZfRVFVQUwsIHRleHRJbnNlcnQuc3Vic3RyaW5nKDAsIGNvbW1vbmxlbmd0aCldKTtcblx0ICAgICAgICAgICAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICB0ZXh0SW5zZXJ0ID0gdGV4dEluc2VydC5zdWJzdHJpbmcoY29tbW9ubGVuZ3RoKTtcblx0ICAgICAgICAgICAgICAgIHRleHREZWxldGUgPSB0ZXh0RGVsZXRlLnN1YnN0cmluZyhjb21tb25sZW5ndGgpO1xuXHQgICAgICAgICAgICAgIH0gLy8gRmFjdG9yIG91dCBhbnkgY29tbW9uIHN1ZmZpeGllcy5cblxuXG5cdCAgICAgICAgICAgICAgY29tbW9ubGVuZ3RoID0gdGhpcy5kaWZmQ29tbW9uU3VmZml4KHRleHRJbnNlcnQsIHRleHREZWxldGUpO1xuXG5cdCAgICAgICAgICAgICAgaWYgKGNvbW1vbmxlbmd0aCAhPT0gMCkge1xuXHQgICAgICAgICAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0gPSB0ZXh0SW5zZXJ0LnN1YnN0cmluZyh0ZXh0SW5zZXJ0Lmxlbmd0aCAtIGNvbW1vbmxlbmd0aCkgKyBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICAgICAgICAgIHRleHRJbnNlcnQgPSB0ZXh0SW5zZXJ0LnN1YnN0cmluZygwLCB0ZXh0SW5zZXJ0Lmxlbmd0aCAtIGNvbW1vbmxlbmd0aCk7XG5cdCAgICAgICAgICAgICAgICB0ZXh0RGVsZXRlID0gdGV4dERlbGV0ZS5zdWJzdHJpbmcoMCwgdGV4dERlbGV0ZS5sZW5ndGggLSBjb21tb25sZW5ndGgpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSAvLyBEZWxldGUgdGhlIG9mZmVuZGluZyByZWNvcmRzIGFuZCBhZGQgdGhlIG1lcmdlZCBvbmVzLlxuXG5cblx0ICAgICAgICAgICAgaWYgKGNvdW50RGVsZXRlID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIgLSBjb3VudEluc2VydCwgY291bnREZWxldGUgKyBjb3VudEluc2VydCwgW0RJRkZfSU5TRVJULCB0ZXh0SW5zZXJ0XSk7XG5cdCAgICAgICAgICAgIH0gZWxzZSBpZiAoY291bnRJbnNlcnQgPT09IDApIHtcblx0ICAgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciAtIGNvdW50RGVsZXRlLCBjb3VudERlbGV0ZSArIGNvdW50SW5zZXJ0LCBbRElGRl9ERUxFVEUsIHRleHREZWxldGVdKTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciAtIGNvdW50RGVsZXRlIC0gY291bnRJbnNlcnQsIGNvdW50RGVsZXRlICsgY291bnRJbnNlcnQsIFtESUZGX0RFTEVURSwgdGV4dERlbGV0ZV0sIFtESUZGX0lOU0VSVCwgdGV4dEluc2VydF0pO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgcG9pbnRlciA9IHBvaW50ZXIgLSBjb3VudERlbGV0ZSAtIGNvdW50SW5zZXJ0ICsgKGNvdW50RGVsZXRlID8gMSA6IDApICsgKGNvdW50SW5zZXJ0ID8gMSA6IDApICsgMTtcblx0ICAgICAgICAgIH0gZWxzZSBpZiAocG9pbnRlciAhPT0gMCAmJiBkaWZmc1twb2ludGVyIC0gMV1bMF0gPT09IERJRkZfRVFVQUwpIHtcblx0ICAgICAgICAgICAgLy8gTWVyZ2UgdGhpcyBlcXVhbGl0eSB3aXRoIHRoZSBwcmV2aW91cyBvbmUuXG5cdCAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVsxXSArPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIsIDEpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBjb3VudEluc2VydCA9IDA7XG5cdCAgICAgICAgICBjb3VudERlbGV0ZSA9IDA7XG5cdCAgICAgICAgICB0ZXh0RGVsZXRlID0gXCJcIjtcblx0ICAgICAgICAgIHRleHRJbnNlcnQgPSBcIlwiO1xuXHQgICAgICAgICAgYnJlYWs7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgaWYgKGRpZmZzW2RpZmZzLmxlbmd0aCAtIDFdWzFdID09PSBcIlwiKSB7XG5cdCAgICAgIGRpZmZzLnBvcCgpOyAvLyBSZW1vdmUgdGhlIGR1bW15IGVudHJ5IGF0IHRoZSBlbmQuXG5cdCAgICB9IC8vIFNlY29uZCBwYXNzOiBsb29rIGZvciBzaW5nbGUgZWRpdHMgc3Vycm91bmRlZCBvbiBib3RoIHNpZGVzIGJ5IGVxdWFsaXRpZXNcblx0ICAgIC8vIHdoaWNoIGNhbiBiZSBzaGlmdGVkIHNpZGV3YXlzIHRvIGVsaW1pbmF0ZSBhbiBlcXVhbGl0eS5cblx0ICAgIC8vIGUuZzogQTxpbnM+QkE8L2lucz5DIC0+IDxpbnM+QUI8L2lucz5BQ1xuXG5cblx0ICAgIGNoYW5nZXMgPSBmYWxzZTtcblx0ICAgIHBvaW50ZXIgPSAxOyAvLyBJbnRlbnRpb25hbGx5IGlnbm9yZSB0aGUgZmlyc3QgYW5kIGxhc3QgZWxlbWVudCAoZG9uJ3QgbmVlZCBjaGVja2luZykuXG5cblx0ICAgIHdoaWxlIChwb2ludGVyIDwgZGlmZnMubGVuZ3RoIC0gMSkge1xuXHQgICAgICBpZiAoZGlmZnNbcG9pbnRlciAtIDFdWzBdID09PSBESUZGX0VRVUFMICYmIGRpZmZzW3BvaW50ZXIgKyAxXVswXSA9PT0gRElGRl9FUVVBTCkge1xuXHQgICAgICAgIGRpZmZQb2ludGVyID0gZGlmZnNbcG9pbnRlcl1bMV07XG5cdCAgICAgICAgcG9zaXRpb24gPSBkaWZmUG9pbnRlci5zdWJzdHJpbmcoZGlmZlBvaW50ZXIubGVuZ3RoIC0gZGlmZnNbcG9pbnRlciAtIDFdWzFdLmxlbmd0aCk7IC8vIFRoaXMgaXMgYSBzaW5nbGUgZWRpdCBzdXJyb3VuZGVkIGJ5IGVxdWFsaXRpZXMuXG5cblx0ICAgICAgICBpZiAocG9zaXRpb24gPT09IGRpZmZzW3BvaW50ZXIgLSAxXVsxXSkge1xuXHQgICAgICAgICAgLy8gU2hpZnQgdGhlIGVkaXQgb3ZlciB0aGUgcHJldmlvdXMgZXF1YWxpdHkuXG5cdCAgICAgICAgICBkaWZmc1twb2ludGVyXVsxXSA9IGRpZmZzW3BvaW50ZXIgLSAxXVsxXSArIGRpZmZzW3BvaW50ZXJdWzFdLnN1YnN0cmluZygwLCBkaWZmc1twb2ludGVyXVsxXS5sZW5ndGggLSBkaWZmc1twb2ludGVyIC0gMV1bMV0ubGVuZ3RoKTtcblx0ICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVsxXSA9IGRpZmZzW3BvaW50ZXIgLSAxXVsxXSArIGRpZmZzW3BvaW50ZXIgKyAxXVsxXTtcblx0ICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyIC0gMSwgMSk7XG5cdCAgICAgICAgICBjaGFuZ2VzID0gdHJ1ZTtcblx0ICAgICAgICB9IGVsc2UgaWYgKGRpZmZQb2ludGVyLnN1YnN0cmluZygwLCBkaWZmc1twb2ludGVyICsgMV1bMV0ubGVuZ3RoKSA9PT0gZGlmZnNbcG9pbnRlciArIDFdWzFdKSB7XG5cdCAgICAgICAgICAvLyBTaGlmdCB0aGUgZWRpdCBvdmVyIHRoZSBuZXh0IGVxdWFsaXR5LlxuXHQgICAgICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzFdICs9IGRpZmZzW3BvaW50ZXIgKyAxXVsxXTtcblx0ICAgICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdID0gZGlmZnNbcG9pbnRlcl1bMV0uc3Vic3RyaW5nKGRpZmZzW3BvaW50ZXIgKyAxXVsxXS5sZW5ndGgpICsgZGlmZnNbcG9pbnRlciArIDFdWzFdO1xuXHQgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIgKyAxLCAxKTtcblx0ICAgICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXIrKztcblx0ICAgIH0gLy8gSWYgc2hpZnRzIHdlcmUgbWFkZSwgdGhlIGRpZmYgbmVlZHMgcmVvcmRlcmluZyBhbmQgYW5vdGhlciBzaGlmdCBzd2VlcC5cblxuXG5cdCAgICBpZiAoY2hhbmdlcykge1xuXHQgICAgICB0aGlzLmRpZmZDbGVhbnVwTWVyZ2UoZGlmZnMpO1xuXHQgICAgfVxuXHQgIH07XG5cblx0ICByZXR1cm4gZnVuY3Rpb24gKG8sIG4pIHtcblx0ICAgIHZhciBkaWZmLCBvdXRwdXQsIHRleHQ7XG5cdCAgICBkaWZmID0gbmV3IERpZmZNYXRjaFBhdGNoKCk7XG5cdCAgICBvdXRwdXQgPSBkaWZmLkRpZmZNYWluKG8sIG4pO1xuXHQgICAgZGlmZi5kaWZmQ2xlYW51cEVmZmljaWVuY3kob3V0cHV0KTtcblx0ICAgIHRleHQgPSBkaWZmLmRpZmZQcmV0dHlIdG1sKG91dHB1dCk7XG5cdCAgICByZXR1cm4gdGV4dDtcblx0ICB9O1xuXHR9KCk7XG5cbn0oKGZ1bmN0aW9uKCkgeyByZXR1cm4gdGhpczsgfSgpKSkpO1xuIiwidmFyIG5leHRUaWNrID0gcmVxdWlyZSgncHJvY2Vzcy9icm93c2VyLmpzJykubmV4dFRpY2s7XG52YXIgYXBwbHkgPSBGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHk7XG52YXIgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2U7XG52YXIgaW1tZWRpYXRlSWRzID0ge307XG52YXIgbmV4dEltbWVkaWF0ZUlkID0gMDtcblxuLy8gRE9NIEFQSXMsIGZvciBjb21wbGV0ZW5lc3NcblxuZXhwb3J0cy5zZXRUaW1lb3V0ID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldFRpbWVvdXQsIHdpbmRvdywgYXJndW1lbnRzKSwgY2xlYXJUaW1lb3V0KTtcbn07XG5leHBvcnRzLnNldEludGVydmFsID0gZnVuY3Rpb24oKSB7XG4gIHJldHVybiBuZXcgVGltZW91dChhcHBseS5jYWxsKHNldEludGVydmFsLCB3aW5kb3csIGFyZ3VtZW50cyksIGNsZWFySW50ZXJ2YWwpO1xufTtcbmV4cG9ydHMuY2xlYXJUaW1lb3V0ID1cbmV4cG9ydHMuY2xlYXJJbnRlcnZhbCA9IGZ1bmN0aW9uKHRpbWVvdXQpIHsgdGltZW91dC5jbG9zZSgpOyB9O1xuXG5mdW5jdGlvbiBUaW1lb3V0KGlkLCBjbGVhckZuKSB7XG4gIHRoaXMuX2lkID0gaWQ7XG4gIHRoaXMuX2NsZWFyRm4gPSBjbGVhckZuO1xufVxuVGltZW91dC5wcm90b3R5cGUudW5yZWYgPSBUaW1lb3V0LnByb3RvdHlwZS5yZWYgPSBmdW5jdGlvbigpIHt9O1xuVGltZW91dC5wcm90b3R5cGUuY2xvc2UgPSBmdW5jdGlvbigpIHtcbiAgdGhpcy5fY2xlYXJGbi5jYWxsKHdpbmRvdywgdGhpcy5faWQpO1xufTtcblxuLy8gRG9lcyBub3Qgc3RhcnQgdGhlIHRpbWUsIGp1c3Qgc2V0cyB1cCB0aGUgbWVtYmVycyBuZWVkZWQuXG5leHBvcnRzLmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0sIG1zZWNzKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcbiAgaXRlbS5faWRsZVRpbWVvdXQgPSBtc2Vjcztcbn07XG5cbmV4cG9ydHMudW5lbnJvbGwgPSBmdW5jdGlvbihpdGVtKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcbiAgaXRlbS5faWRsZVRpbWVvdXQgPSAtMTtcbn07XG5cbmV4cG9ydHMuX3VucmVmQWN0aXZlID0gZXhwb3J0cy5hY3RpdmUgPSBmdW5jdGlvbihpdGVtKSB7XG4gIGNsZWFyVGltZW91dChpdGVtLl9pZGxlVGltZW91dElkKTtcblxuICB2YXIgbXNlY3MgPSBpdGVtLl9pZGxlVGltZW91dDtcbiAgaWYgKG1zZWNzID49IDApIHtcbiAgICBpdGVtLl9pZGxlVGltZW91dElkID0gc2V0VGltZW91dChmdW5jdGlvbiBvblRpbWVvdXQoKSB7XG4gICAgICBpZiAoaXRlbS5fb25UaW1lb3V0KVxuICAgICAgICBpdGVtLl9vblRpbWVvdXQoKTtcbiAgICB9LCBtc2Vjcyk7XG4gIH1cbn07XG5cbi8vIFRoYXQncyBub3QgaG93IG5vZGUuanMgaW1wbGVtZW50cyBpdCBidXQgdGhlIGV4cG9zZWQgYXBpIGlzIHRoZSBzYW1lLlxuZXhwb3J0cy5zZXRJbW1lZGlhdGUgPSB0eXBlb2Ygc2V0SW1tZWRpYXRlID09PSBcImZ1bmN0aW9uXCIgPyBzZXRJbW1lZGlhdGUgOiBmdW5jdGlvbihmbikge1xuICB2YXIgaWQgPSBuZXh0SW1tZWRpYXRlSWQrKztcbiAgdmFyIGFyZ3MgPSBhcmd1bWVudHMubGVuZ3RoIDwgMiA/IGZhbHNlIDogc2xpY2UuY2FsbChhcmd1bWVudHMsIDEpO1xuXG4gIGltbWVkaWF0ZUlkc1tpZF0gPSB0cnVlO1xuXG4gIG5leHRUaWNrKGZ1bmN0aW9uIG9uTmV4dFRpY2soKSB7XG4gICAgaWYgKGltbWVkaWF0ZUlkc1tpZF0pIHtcbiAgICAgIC8vIGZuLmNhbGwoKSBpcyBmYXN0ZXIgc28gd2Ugb3B0aW1pemUgZm9yIHRoZSBjb21tb24gdXNlLWNhc2VcbiAgICAgIC8vIEBzZWUgaHR0cDovL2pzcGVyZi5jb20vY2FsbC1hcHBseS1zZWd1XG4gICAgICBpZiAoYXJncykge1xuICAgICAgICBmbi5hcHBseShudWxsLCBhcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGZuLmNhbGwobnVsbCk7XG4gICAgICB9XG4gICAgICAvLyBQcmV2ZW50IGlkcyBmcm9tIGxlYWtpbmdcbiAgICAgIGV4cG9ydHMuY2xlYXJJbW1lZGlhdGUoaWQpO1xuICAgIH1cbiAgfSk7XG5cbiAgcmV0dXJuIGlkO1xufTtcblxuZXhwb3J0cy5jbGVhckltbWVkaWF0ZSA9IHR5cGVvZiBjbGVhckltbWVkaWF0ZSA9PT0gXCJmdW5jdGlvblwiID8gY2xlYXJJbW1lZGlhdGUgOiBmdW5jdGlvbihpZCkge1xuICBkZWxldGUgaW1tZWRpYXRlSWRzW2lkXTtcbn07IiwiLypcbiAgICBJMThORG9tYWluIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBJMThORG9tYWluID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIHB1dFRvQXV0b0RlZmluZUhlbHBlciA9IGZ1bmN0aW9uKCBzY29wZSwgYXV0b0RlZmluZUhlbHBlciApe1xuICAgICAgICBcbiAgICAgICAgdmFyIG5ld1N0cmluZyA9IHN0cmluZztcbiAgICAgICAgdmFyIGNvbmYgPSBjb250ZXh0LmdldENvbmYoKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCB0aGUgZG9tYWlucyBkZWZpbmVkIHByZXZpb3VzbHlcbiAgICAgICAgdmFyIHByZXZpb3VzVmFsdWUgPSBzY29wZS5nZXQoIGNvbmYuaTE4bkRvbWFpblZhck5hbWUgKTtcbiAgICAgICAgaWYgKCBwcmV2aW91c1ZhbHVlICkge1xuICAgICAgICAgICAgbmV3U3RyaW5nICs9IGNvbmYuaW5EZWZpbmVEZWxpbWl0ZXIgKyBjb25mLmkxOG5Eb21haW5WYXJOYW1lO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgYnJhY2tldHMgaWYgbm90IHByZXNlbnRcbiAgICAgICAgaWYgKCBuZXdTdHJpbmdbIDAgXSAhPT0gJ1snICl7XG4gICAgICAgICAgICBuZXdTdHJpbmcgPSAnWycgKyBuZXdTdHJpbmcgKyAnXSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBpMThuRG9tYWluVmFyTmFtZSB0byB0aGUgYXV0b0RlZmluZUhlbHBlclxuICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgICAgIGNvbmYuaTE4bkRvbWFpblZhck5hbWUsXG4gICAgICAgICAgICBuZXdTdHJpbmdcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHV0VG9BdXRvRGVmaW5lSGVscGVyOiBwdXRUb0F1dG9EZWZpbmVIZWxwZXIsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBJMThORG9tYWluLmlkXG4gICAgfTtcbn07XG5cbkkxOE5Eb21haW4uaWQgPSAnaTE4bjpkb21haW4nO1xuXG5JMThORG9tYWluLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICByZXR1cm4gc3RyaW5nPyBuZXcgSTE4TkRvbWFpbiggc3RyaW5nLnRyaW0oKSApOiBudWxsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJMThORG9tYWluO1xuIiwiLypcbiAgICBJMThuTGFuZ3VhZ2UgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIEkxOE5MYW5ndWFnZSA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwdXRUb0F1dG9EZWZpbmVIZWxwZXIgPSBmdW5jdGlvbiggYXV0b0RlZmluZUhlbHBlciApe1xuXG4gICAgICAgIC8vIEFkZCBpMThuTGFuZ3VhZ2VWYXJOYW1lIHRvIHRoZSBhdXRvRGVmaW5lSGVscGVyXG4gICAgICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuaTE4bkxhbmd1YWdlVmFyTmFtZSxcbiAgICAgICAgICAgIHN0cmluZ1xuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJJMThOTGFuZ3VhZ2U6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHV0VG9BdXRvRGVmaW5lSGVscGVyOiBwdXRUb0F1dG9EZWZpbmVIZWxwZXIsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBJMThOTGFuZ3VhZ2UuaWRcbiAgICB9O1xufTtcblxuSTE4Tkxhbmd1YWdlLmlkID0gJ2kxOG46bGFuZ3VhZ2UnO1xuXG5JMThOTGFuZ3VhZ2UuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHJldHVybiBzdHJpbmc/IG5ldyBJMThOTGFuZ3VhZ2UoIHN0cmluZy50cmltKCkgKTogbnVsbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSTE4Tkxhbmd1YWdlO1xuIiwiLypcbiAgICBNRVRBTERlZmluZU1hY3JvIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBNRVRBTERlZmluZU1hY3JvID0gZnVuY3Rpb24oIG5hbWVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBuYW1lID0gbmFtZVRvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEhpZGUgbWFjcm8gZGVmaW5pdGlvbnNcbiAgICAgICAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIk1FVEFMRGVmaW5lTWFjcm86IFwiICsgbmFtZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IE1FVEFMRGVmaW5lTWFjcm8uaWRcbiAgICB9O1xufTtcblxuTUVUQUxEZWZpbmVNYWNyby5pZCA9ICdtZXRhbDpkZWZpbmUtbWFjcm8nO1xuXG5NRVRBTERlZmluZU1hY3JvLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICByZXR1cm4gbmV3IE1FVEFMRGVmaW5lTWFjcm8oIHN0cmluZy50cmltKCkgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTUVUQUxEZWZpbmVNYWNybztcbiIsIi8qXG4gICAgTUVUQUxGaWxsU2xvdCBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgTUVUQUxGaWxsU2xvdCA9IGZ1bmN0aW9uKCBfc3RyaW5nLCBfZXhwcmVzc2lvbiwgX3VzZU1hY3JvTm9kZSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gX3N0cmluZztcbiAgICB2YXIgZXhwcmVzc2lvbiA9IF9leHByZXNzaW9uO1xuICAgIHZhciB1c2VNYWNyb05vZGUgPSBfdXNlTWFjcm9Ob2RlO1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gTm90aGluZyB0byBkb1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIHVuZGVmaW5lZCwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiggcGFyc2VyVXBkYXRlciApe1xuICAgICAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIHVzZU1hY3JvTm9kZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiTUVUQUxGaWxsU2xvdDogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogTUVUQUxGaWxsU2xvdC5pZFxuICAgIH07XG59O1xuXG5NRVRBTEZpbGxTbG90LmlkID0gJ21ldGFsOmZpbGwtc2xvdCc7XG5cbk1FVEFMRmlsbFNsb3QuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nLCB1c2VNYWNyb05vZGUgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgTUVUQUxGaWxsU2xvdCggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc3RyaW5nICksXG4gICAgICAgICAgICB1c2VNYWNyb05vZGVcbiAgICApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBNRVRBTEZpbGxTbG90O1xuIiwiLypcbiAgICBNRVRBTFVzZU1hY3JvIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZUluZGV4LmpzJyApO1xudmFyIGF0dHJpYnV0ZUNhY2hlID0gcmVxdWlyZSggJy4uLy4uL2NhY2hlL2F0dHJpYnV0ZUNhY2hlLmpzJyApO1xudmFyIFRBTERlZmluZSA9IHJlcXVpcmUoICcuLi9UQUwvdGFsRGVmaW5lLmpzJyApO1xudmFyIE1FVEFMRmlsbFNsb3QgPSByZXF1aXJlKCAnLi9tZXRhbEZpbGxTbG90LmpzJyApO1xudmFyIHJlc29sdmVyID0gcmVxdWlyZSggJy4uLy4uL3Jlc29sdmVyLmpzJyApO1xuXG52YXIgTUVUQUxVc2VNYWNybyA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBtYWNyb0V4cHJlc3Npb25Ub0FwcGx5LCBkZWZpbmVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBtYWNyb0V4cHJlc3Npb24gPSBtYWNyb0V4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBkZWZpbmUgPSBkZWZpbmVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlLCBhdXRvRGVmaW5lSGVscGVyLCBpbmRleEV4cHJlc3Npb25zICl7XG5cbiAgICAgICAgLy8gSW5pdCBzb21lIHZhcnNcbiAgICAgICAgdmFyIG1hY3JvS2V5ID0gcmVzb2x2ZXIuZ2V0TWFjcm9LZXkoIG1hY3JvRXhwcmVzc2lvbiwgc2NvcGUgKTtcbiAgICAgICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcbiAgICAgICAgdmFyIG5ld05vZGUgPSByZXNvbHZlci5nZXROb2RlKCBtYWNyb0tleSwgc2NvcGUgKTsgXG4gICAgICAgIFxuICAgICAgICAvLyBIaWRlIHVzZSBtYWNybyBub2RlXG4gICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcblxuICAgICAgICAvLyBSZW1vdmUgc3R5bGUgYXR0cmlidXRlIHRvIGZvcmNlIHNob3dpbmcgdGhlIG5ldyBub2RlXG4gICAgICAgIG5ld05vZGUucmVtb3ZlQXR0cmlidXRlKCAnc3R5bGUnICk7XG5cbiAgICAgICAgLy8gVXBkYXRlIGRlZmluZSBhbmQgYXV0b0RlZmluZSBhdHRyaWJ1dGVzIG9mIHRoZSBuZXcgbm9kZVxuICAgICAgICB1cGRhdGVOZXdOb2RlQXR0cmlidXRlcyggbWFjcm9LZXksIG5ld05vZGUsIGF1dG9EZWZpbmVIZWxwZXIsIHRhZ3MsIG5vZGUsIGluZGV4RXhwcmVzc2lvbnMgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEZpbGwgc2xvdHNcbiAgICAgICAgZmlsbFNsb3RzKCBzY29wZSwgbm9kZSwgdGFncywgbmV3Tm9kZSwgaW5kZXhFeHByZXNzaW9ucyApO1xuXG4gICAgICAgIC8vIEFkZCB0aGUgbWFjcm8gbm9kZVxuICAgICAgICBub2RlLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCBuZXdOb2RlLCBub2RlLm5leHRTaWJsaW5nICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbmV3Tm9kZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGVOZXdOb2RlQXR0cmlidXRlcyA9IGZ1bmN0aW9uKCBtYWNyb0tleSwgbmV3Tm9kZSwgYXV0b0RlZmluZUhlbHBlciwgdGFncywgbm9kZSwgaW5kZXhFeHByZXNzaW9ucyApe1xuXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgdGFsRGVmaW5lIGF0dHJpYnV0ZVxuICAgICAgICBUQUxEZWZpbmUudXBkYXRlQXR0cmlidXRlKCBuZXdOb2RlLCBkZWZpbmUgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSB0aGUgdGFsQXV0b0RlZmluZSBhdHRyaWJ1dGVcbiAgICAgICAgdmFyIG1hY3JvRGF0YSA9IHJlc29sdmVyLmdldE1hY3JvRGF0YSggbWFjcm9LZXkgKTtcbiAgICAgICAgaWYgKCBtYWNyb0RhdGEudXJsICl7XG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dCggXG4gICAgICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXh0ZXJuYWxNYWNyb1VybFZhck5hbWUsIFxuICAgICAgICAgICAgICAgIFwiJ1wiICsgbWFjcm9EYXRhLnVybCArIFwiJ1wiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgYXV0b0RlZmluZUhlbHBlci51cGRhdGVOb2RlKCBuZXdOb2RlICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFNldCByZWxhdGVkIGlkIGF0dHJpYnV0ZSBpZiBuZWVkZWRcbiAgICAgICAgaWYgKCBpbmRleEV4cHJlc3Npb25zICl7XG4gICAgICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZSggXG4gICAgICAgICAgICAgICAgdGFncy5yZWxhdGVkSWQsIFxuICAgICAgICAgICAgICAgIG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLmlkICkgXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZmlsbFNsb3RzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlLCB0YWdzLCBuZXdOb2RlLCBpbmRleEV4cHJlc3Npb25zICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IG5vZGUucXVlcnlTZWxlY3RvckFsbCggXG4gICAgICAgICAgICBcIltcIiArIHJlc29sdmVyLmZpbHRlclNlbGVjdG9yKCB0YWdzLm1ldGFsRmlsbFNsb3QgKSArIFwiXVwiXG4gICAgICAgICk7XG4gICAgICAgIHZhciBlbGVtZW50O1xuICAgICAgICB2YXIgcG9zID0gMDtcbiAgICAgICAgd2hpbGUgKCBlbGVtZW50ID0gbGlzdFsgcG9zKysgXSApIHtcbiAgICAgICAgICAgIHZhciBzbG90SWRFeHByZXNzaW9uU3RyaW5nID0gZWxlbWVudC5nZXRBdHRyaWJ1dGUoIHRhZ3MubWV0YWxGaWxsU2xvdCApO1xuICAgICAgICAgICAgdmFyIHNsb3RJZEV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2xvdElkRXhwcmVzc2lvblN0cmluZyApO1xuICAgICAgICAgICAgdmFyIHNsb3RJZCA9IHNsb3RJZEV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG5cbiAgICAgICAgICAgIC8vIEluZGV4IGZpbGwgc2xvdCBlbGVtZW50XG4gICAgICAgICAgICBpZiAoIGluZGV4RXhwcmVzc2lvbnMgKXtcbiAgICAgICAgICAgICAgICB2YXIgbWV0YWxGaWxsU2xvdCA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxuICAgICAgICAgICAgICAgICAgICBNRVRBTEZpbGxTbG90LCBcbiAgICAgICAgICAgICAgICAgICAgc2xvdElkRXhwcmVzc2lvblN0cmluZywgXG4gICAgICAgICAgICAgICAgICAgIGVsZW1lbnQsXG4gICAgICAgICAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIE1FVEFMRmlsbFNsb3QuYnVpbGQoIHNsb3RJZEV4cHJlc3Npb25TdHJpbmcsIG5vZGUgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5kZXguYWRkKCBlbGVtZW50LCBtZXRhbEZpbGxTbG90LCBzY29wZSApOyAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAvLyBEbyBub3RoaW5nIGlmIHNsb3RJZEV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGZhbHNlXG4gICAgICAgICAgICBpZiAoICEgc2xvdElkICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgc2xvdENvbnRlbnQgPSBlbGVtZW50LmNsb25lTm9kZSggdHJ1ZSApO1xuICAgICAgICAgICAgdmFyIGN1cnJlbnROb2RlID0gbmV3Tm9kZS5xdWVyeVNlbGVjdG9yKCBcbiAgICAgICAgICAgICAgICBcIltcIiArIHJlc29sdmVyLmZpbHRlclNlbGVjdG9yKCB0YWdzLm1ldGFsRGVmaW5lU2xvdCApICsgXCI9J1wiICsgc2xvdElkICsgXCInXVwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgaWYgKCAhIGN1cnJlbnROb2RlICl7XG4gICAgICAgICAgICAgICAgdGhyb3cgJ1Nsb3QgXCInICsgc2xvdElkICsgJ1wiIGluIGV4cHJlc3Npb24gXCInICsgc2xvdElkRXhwcmVzc2lvblN0cmluZyArJ1wiIG5vdCBmb3VuZCEnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY3VycmVudE5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIFxuICAgICAgICAgICAgICAgIHNsb3RDb250ZW50LCBcbiAgICAgICAgICAgICAgICBjdXJyZW50Tm9kZS5uZXh0U2libGluZ1xuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNsb3RDb250ZW50LnJlbW92ZUF0dHJpYnV0ZSggdGFncy5tZXRhbEZpbGxTbG90ICk7XG4gICAgICAgICAgICBzbG90Q29udGVudC5zZXRBdHRyaWJ1dGUoIHRhZ3MuaWQsIGNvbnRleHQubmV4dEV4cHJlc3Npb25Db3VudGVyKCkgKTsgLy8gU2V0IGEgbmV3IGlkIGF0dHJpYnV0ZSB0byBhdm9pZCBpZCBjb25mbGljdHNcbiAgICAgICAgICAgIGN1cnJlbnROb2RlLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggdW5kZWZpbmVkLCBzY29wZSwgbWFjcm9FeHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUgKXtcbiAgICAgICAgcGFyc2VyVXBkYXRlci51cGRhdGVOb2RlKCBub2RlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJNRVRBTFVzZU1hY3JvOiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBNRVRBTFVzZU1hY3JvLmlkXG4gICAgfTtcbn07XG5cbk1FVEFMVXNlTWFjcm8uaWQgPSAnbWV0YWw6dXNlLW1hY3JvJztcblxuTUVUQUxVc2VNYWNyby5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHN0cmluZ0RlZmluZSApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBNRVRBTFVzZU1hY3JvKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzdHJpbmcudHJpbSgpICksXG4gICAgICAgICAgICBzdHJpbmdEZWZpbmU/IHN0cmluZ0RlZmluZS50cmltKCk6IHVuZGVmaW5lZFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1FVEFMVXNlTWFjcm87XG4iLCIvKiBcbiAgICBjb250ZW50SGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V2YWx1YXRlSGVscGVyLmpzJyApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcblxuICAgIHZhciBmb3JtSW5wdXRIYXNCb2R5ID0ge1xuICAgICAgICBCVVRUT046IDEsXG4gICAgICAgIExBQkVMOiAxLFxuICAgICAgICBMRUdFTkQ6IDEsXG4gICAgICAgIEZJRUxEU0VUOiAxLFxuICAgICAgICBPUFRJT046IDFcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCB0YWcsIHN0cmluZywgY29uc3RydWN0b3JGdW5jdGlvbiApIHtcblxuICAgICAgICAvLyBQcm9jZXNzIGl0XG4gICAgICAgIHZhciBjb250ZW50ID0gc3RyaW5nLnRyaW0oKTtcblxuICAgICAgICAvLyBDaGVjayBpZiBpcyBhbiBIVE1MIGV4cHJlc3Npb25cbiAgICAgICAgdmFyIHN0cnVjdHVyZSA9IGNvbnRlbnQuaW5kZXhPZiggY29udGV4dC5nZXRDb25mKCkuaHRtbFN0cnVjdHVyZUV4cHJlc3Npb25QcmVmaXggKyAnICcgKSA9PT0gMDtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25TdHJpbmcgPSBzdHJ1Y3R1cmU/IFxuICAgICAgICAgICAgY29udGVudC5zdWJzdHIoIDEgKyBjb250ZXh0LmdldENvbmYoKS5odG1sU3RydWN0dXJlRXhwcmVzc2lvblByZWZpeC5sZW5ndGggKTogXG4gICAgICAgICAgICBjb250ZW50O1xuICAgICAgICBpZiAoICEgZXhwcmVzc2lvblN0cmluZyApe1xuICAgICAgICAgICAgdGhyb3cgdGFnICsgJyBleHByZXNzaW9uIHZvaWQuJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbnN0cnVjdG9yRnVuY3Rpb24oXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggZXhwcmVzc2lvblN0cmluZyApLFxuICAgICAgICAgICAgc3RydWN0dXJlLFxuICAgICAgICAgICAgZXhwcmVzc2lvblN0cmluZ1xuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZU5vZGUgPSBmdW5jdGlvbiggbm9kZSwgc3RydWN0dXJlLCBldmFsdWF0ZWQgKXtcblxuICAgICAgICAvLyBDaGVjayBkZWZhdWx0XG4gICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuaXNEZWZhdWx0KCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBub3RoaW5nXG4gICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuaXNOb3RoaW5nKCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgZXZhbHVhdGVkID0gXCJcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEFkZCBpdCB0byBub2RlXG4gICAgICAgIG5vZGUuaW5uZXJIVE1MID0gZXZhbHVhdGVkO1xuICAgICAgICBpZiAoICEgc3RydWN0dXJlICkge1xuICAgICAgICAgICAgbm9kZVsgXCJmb3JtXCIgaW4gbm9kZSAmJiAhZm9ybUlucHV0SGFzQm9keVsgbm9kZS50YWdOYW1lIF0gPyBcInZhbHVlXCI6IFwiaW5uZXJUZXh0XCIgXSA9IGV2YWx1YXRlZDtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGQ6IGJ1aWxkLFxuICAgICAgICB1cGRhdGVOb2RlOiB1cGRhdGVOb2RlXG4gICAgfTtcbn0pKCk7XG4iLCIvKlxuICAgIFRBTEF0dHJpYnV0ZXMgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uLy4uL3V0aWxzLmpzJyApO1xuXG52YXIgVEFMQXR0cmlidXRlcyA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBhdHRyaWJ1dGVJdGVtc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGF0dHJpYnV0ZUl0ZW1zID0gYXR0cmlidXRlSXRlbXNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlLCBhdHRyaWJ1dGVOYW1lICl7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVJdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVJdGVtID0gYXR0cmlidXRlSXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHZhciBuYW1lID0gYXR0cmlidXRlSXRlbS5uYW1lO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoICEgYXR0cmlidXRlTmFtZSB8fCBuYW1lID09PSBhdHRyaWJ1dGVOYW1lICl7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gYXR0cmlidXRlSXRlbS5leHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuXG4gICAgICAgICAgICAgICAgaWYgKCBuYW1lICl7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NTaW1wbGVBdHRyaWJ1dGVJdGVtKCBub2RlLCBuYW1lLCB2YWx1ZSApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIHByb2Nlc3NNYXBBdHRyaWJ1dGVJdGVtKCBub2RlLCB2YWx1ZSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgcHJvY2Vzc01hcEF0dHJpYnV0ZUl0ZW0gPSBmdW5jdGlvbiggbm9kZSwgbWFwICl7XG4gICAgXG4gICAgICAgIC8vIERvIG5vdGhpbmcgaWYgbWFwIGlzIG51bGxcbiAgICAgICAgaWYgKCAhIG1hcCApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgdXRpbHMuaXNQbGFpbk9iamVjdCggbWFwICkgKXtcbiAgICAgICAgICAgIHRocm93ICdJbnZhbGlkIGF0dHJpYnV0ZSB2YWx1ZTogXCInICsgbWFwICsgJ1wiLiBPYmplY3QgZXhwZWN0ZWQuJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIG5hbWUgaW4gbWFwICl7XG4gICAgICAgICAgICB2YXIgdmFsdWUgPSBtYXBbIG5hbWUgXTtcbiAgICAgICAgICAgIHByb2Nlc3NTaW1wbGVBdHRyaWJ1dGVJdGVtKCBub2RlLCBuYW1lLCB2YWx1ZSApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcHJvY2Vzc1NpbXBsZUF0dHJpYnV0ZUl0ZW0gPSBmdW5jdGlvbiggbm9kZSwgbmFtZSwgdmFsdWUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEJvb2xlYW4gYXR0cmlidXRlc1xuICAgICAgICBpZiAoIGNvbnRleHQuaXNCb29sZWFuQXR0cmlidXRlKCBuYW1lICkgKXtcbiAgICAgICAgICAgIGlmICggdmFsdWUgKXtcbiAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggbmFtZSwgJycgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoIG5hbWUgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSWYgdmFsdWUgaXMgdW5kZWZpbmVkIGRvbid0IHBhcnNlciB0aGUgYXR0cmlidXRlXG4gICAgICAgIGlmICggdmFsdWUgPT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gQWx0IGF0dHJpYnV0ZXNcbiAgICAgICAgaWYgKCBjb250ZXh0LmlzQWx0QXR0cmlidXRlKCBuYW1lICkgKSB7XG4gICAgICAgICAgICBzd2l0Y2ggKCBuYW1lICkge1xuICAgICAgICAgICAgY2FzZSBcImlubmVySFRNTFwiOlxuICAgICAgICAgICAgICAgIHRocm93IG5vZGU7IC8vIHNob3VsZCB1c2UgXCJxdGV4dFwiXG4gICAgICAgICAgICBjYXNlIFwic3R5bGVcIjpcbiAgICAgICAgICAgICAgICBub2RlLnN0eWxlLmNzc1RleHQgPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIC8qXG4gICAgICAgICAgICBjYXNlIFwidGV4dFwiOlxuICAgICAgICAgICAgICAgIG5vZGVbIHF1ZXJ5U2VsZWN0b3JBbGwgPyBuYW1lIDogaW5uZXJUZXh0IF0gPSB2YWx1ZTtcbiAgICAgICAgICAgICAgICBicmVhazsgLy8gb3B0aW9uLnRleHQgdW5zdGFibGUgaW4gSUVcbiAgICAgICAgICAgICovXG4gICAgICAgICAgICBjYXNlIFwiY2xhc3NcIjpcbiAgICAgICAgICAgICAgICBuYW1lID0gXCJjbGFzc05hbWVcIjtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgbm9kZVsgbmFtZSBdID0gdmFsdWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH0gXG5cbiAgICAgICAgLy8gUmVndWxhciBhdHRyaWJ1dGVzXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCBuYW1lLCB2YWx1ZSApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgb2JqZWN0ID0ge307XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhdHRyaWJ1dGVJdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVJdGVtID0gYXR0cmlidXRlSXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHZhciBkZXBlbmRzT25MaXN0ID0gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIHVuZGVmaW5lZCwgc2NvcGUsIGF0dHJpYnV0ZUl0ZW0uZXhwcmVzc2lvbiApO1xuICAgICAgICAgICAgaWYgKCBkZXBlbmRzT25MaXN0ICYmIGRlcGVuZHNPbkxpc3QubGVuZ3RoID4gMCApe1xuICAgICAgICAgICAgICAgIG9iamVjdFsgYXR0cmlidXRlSXRlbS5uYW1lIF0gPSBkZXBlbmRzT25MaXN0O1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIE9iamVjdC5rZXlzKCBvYmplY3QgKS5sZW5ndGggPiAwICl7XG4gICAgICAgICAgICByZXN1bHQucHVzaCggb2JqZWN0ICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUsIHNjb3BlLCBpbmRleEl0ZW0gKXtcbiAgICAgICAgcHJvY2Vzcyggc2NvcGUsIG5vZGUsIGluZGV4SXRlbS5ncm91cElkICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxBdHRyaWJ1dGVzOiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxBdHRyaWJ1dGVzLmlkXG4gICAgfTtcbn07XG5cblRBTEF0dHJpYnV0ZXMuaWQgPSAndGFsOmF0dHJpYnV0ZXMnO1xuXG5UQUxBdHRyaWJ1dGVzLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcblxuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgYXR0cmlidXRlSXRlbXMgPSBbXTtcbiAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IHN0cmluZy50cmltKCk7XG4gICAgdmFyIHRva2VucyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIGV4cHJlc3Npb25TdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuYXR0cmlidXRlRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIHRydWUgKTtcblxuICAgIHdoaWxlICggdG9rZW5zLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgdmFyIGF0dHJpYnV0ZSA9IHRva2Vucy5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgICAgIHZhciBzcGFjZSA9IGF0dHJpYnV0ZS5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5pbkF0dHJpYnV0ZURlbGltaXRlciApO1xuICAgICAgICBpZiAoIHNwYWNlID09PSAtMSApIHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZUl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgICAgIG5hbWU6IHVuZGVmaW5lZCxcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uQnVpbGRlci5idWlsZCggYXR0cmlidXRlIClcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHZhciBuYW1lID0gYXR0cmlidXRlLnN1YnN0cmluZyggMCwgc3BhY2UgKTtcbiAgICAgICAgdmFyIHZhbHVlRXhwcmVzc2lvbiA9IGF0dHJpYnV0ZS5zdWJzdHJpbmcoIHNwYWNlICsgMSApLnRyaW0oKTtcblxuICAgICAgICBhdHRyaWJ1dGVJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uQnVpbGRlci5idWlsZCggdmFsdWVFeHByZXNzaW9uIClcbiAgICAgICAgfSk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBuZXcgVEFMQXR0cmlidXRlcyggc3RyaW5nLCBhdHRyaWJ1dGVJdGVtcyApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxBdHRyaWJ1dGVzO1xuIiwiLypcbiAgICBUQUxDb25kaXRpb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBUQUxDb25kaXRpb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvblRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSwgbm9kZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlQm9vbGVhbiggc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICAgICAgXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5jb25kaXRpb25SZXN1bHQsIHJlc3VsdCApO1xuICAgICAgICBub2RlLnN0eWxlLmRpc3BsYXkgPSByZXN1bHQgPyAnJyA6ICdub25lJztcbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUgKXtcbiAgICAgICAgcGFyc2VyVXBkYXRlci51cGRhdGVOb2RlKCBub2RlLCB0cnVlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRhYmxlRnJvbUFjdGlvbiA9IGZ1bmN0aW9uKCBwYXJzZXJVcGRhdGVyLCBub2RlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgc2NvcGUgPSBwYXJzZXJVcGRhdGVyLmdldE5vZGVTY29wZSggbm9kZSApO1xuICAgICAgICB2YXIgcmVzdWx0ID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVCb29sZWFuKCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgICAgICB2YXIgdmFsdWVGcm9tVGFnID0gJ3RydWUnID09PSBub2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuY29uZGl0aW9uUmVzdWx0ICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0ICE9PSB2YWx1ZUZyb21UYWc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxDb25kaXRpb246IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB1cGRhdGFibGVGcm9tQWN0aW9uOiB1cGRhdGFibGVGcm9tQWN0aW9uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IFRBTENvbmRpdGlvbi5pZFxuICAgIH07XG59O1xuXG5UQUxDb25kaXRpb24uaWQgPSAndGFsOmNvbmRpdGlvbic7XG5cblRBTENvbmRpdGlvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgVEFMQ29uZGl0aW9uKCBcbiAgICAgICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0cmluZyApICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTENvbmRpdGlvbjtcbiIsIi8qXG4gICAgVEFMQ29udGVudCBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgY29udGVudEhlbHBlciA9IHJlcXVpcmUoICcuL2NvbnRlbnRIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgVEFMQ29udGVudCA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSwgc3RydWN0dXJlVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBzdHJ1Y3R1cmUgPSBzdHJ1Y3R1cmVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlICl7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29udGVudEhlbHBlci51cGRhdGVOb2RlKCBcbiAgICAgICAgICAgIG5vZGUsIFxuICAgICAgICAgICAgc3RydWN0dXJlLCBcbiAgICAgICAgICAgIGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlVG9Ob3ROdWxsKCBzY29wZSwgZXhwcmVzc2lvbiApIFxuICAgICAgICApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggdW5kZWZpbmVkLCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCBwYXJzZXJVcGRhdGVyLCBub2RlLCBzY29wZSApe1xuICAgICAgICBwcm9jZXNzKCBzY29wZSwgbm9kZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiVEFMQ29udGVudDogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMQ29udGVudC5pZFxuICAgIH07XG59O1xuXG5UQUxDb250ZW50LmlkID0gJ3RhbDpjb250ZW50JztcblxuVEFMQ29udGVudC5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgcmV0dXJuIGNvbnRlbnRIZWxwZXIuYnVpbGQoIFxuICAgICAgICAnVEFMQ29udGVudCcsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZnVuY3Rpb24oIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfc3RydWN0dXJlICl7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRBTENvbnRlbnQoIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfc3RydWN0dXJlICk7XG4gICAgICAgIH1cbiAgICApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxDb250ZW50O1xuIiwiLypcbiAgICBUQUxEZWNsYXJlIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIFRBTERlY2xhcmUgPSBmdW5jdGlvbiggX3N0cmluZywgX2RlY2xhcmVJdGVtcyApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gX3N0cmluZztcbiAgICB2YXIgZGVjbGFyZUl0ZW1zID0gX2RlY2xhcmVJdGVtcztcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSwgYXV0b0RlZmluZUhlbHBlciApe1xuXG4gICAgICAgIHB1dFZhcmlhYmxlcyggc2NvcGUsIGF1dG9EZWZpbmVIZWxwZXIgKTtcblxuICAgICAgICByZXR1cm4gcHJvY2Vzc0RlY2xhcmVJdGVtcyggc2NvcGUgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwdXRWYXJpYWJsZXMgPSBmdW5jdGlvbiggc2NvcGUsIGF1dG9EZWZpbmVIZWxwZXIgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgc3RyaWN0TW9kZVZhck5hbWUgdG8gdGhlIGF1dG9EZWZpbmVIZWxwZXIgaWYgbmVlZGVkXG4gICAgICAgIHZhciBzdHJpY3RNb2RlVmFyTmFtZSA9IGNvbnRleHQuZ2V0Q29uZigpLnN0cmljdE1vZGVWYXJOYW1lO1xuICAgICAgICBpZiAoIHRydWUgIT09IHNjb3BlLmdldCggc3RyaWN0TW9kZVZhck5hbWUgKSApe1xuICAgICAgICAgICAgYXV0b0RlZmluZUhlbHBlci5wdXQoIHN0cmljdE1vZGVWYXJOYW1lLCAndHJ1ZScgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgZGVjbGFyZWQgYW5kIHJlcXVpcmVkXG4gICAgICAgIHZhciBkZWNsYXJlZFZhcnNWYXJOYW1lID0gY29udGV4dC5nZXRDb25mKCkuZGVjbGFyZWRWYXJzVmFyTmFtZTtcbiAgICAgICAgdmFyIGRlY2xhcmVkID0gc2NvcGUuZ2V0KCBkZWNsYXJlZFZhcnNWYXJOYW1lICkgfHwgW107XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGRlY2xhcmVJdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBkZWNsYXJlSXRlbSA9IGRlY2xhcmVJdGVtc1sgaSBdO1xuICAgICAgICAgICAgZGVjbGFyZWQucHVzaCggZGVjbGFyZUl0ZW0ubmFtZSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBBZGQgZGVjbGFyZWRWYXJzVmFyTmFtZSB0byB0aGUgYXV0b0RlZmluZUhlbHBlclxuICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dCggXG4gICAgICAgICAgICBkZWNsYXJlZFZhcnNWYXJOYW1lLCBcbiAgICAgICAgICAgIGV4cHJlc3Npb25zVXRpbHMuYnVpbGRMaXN0KCBkZWNsYXJlZCwgdHJ1ZSApXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcHJvY2Vzc0RlY2xhcmVJdGVtcyA9IGZ1bmN0aW9uKCBzY29wZSApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBlcnJvcnNBcnJheSA9IFtdO1xuXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGRlY2xhcmVJdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBkZWNsYXJlSXRlbSA9IGRlY2xhcmVJdGVtc1sgaSBdO1xuICAgICAgICAgICAgdmFyIGVycm9ycyA9IGNoZWNrRGVjbGFyZUl0ZW0oXG4gICAgICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICAgICAgZGVjbGFyZUl0ZW0ubmFtZSxcbiAgICAgICAgICAgICAgICBkZWNsYXJlSXRlbS50eXBlLFxuICAgICAgICAgICAgICAgIGRlY2xhcmVJdGVtLnJlcXVpcmVkLFxuICAgICAgICAgICAgICAgIGRlY2xhcmVJdGVtLmRlZmF1bHRWYWx1ZVN0cmluZyxcbiAgICAgICAgICAgICAgICBkZWNsYXJlSXRlbS5kZWZhdWx0VmFsdWVFeHByZXNzaW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZXJyb3JzQXJyYXkgPSBlcnJvcnNBcnJheS5jb25jYXQoIGVycm9ycyApO1xuICAgICAgICB9XG5cbiAgICAgICAgcHJvY2Vzc0Vycm9yc0FycmF5KCBlcnJvcnNBcnJheSApO1xuXG4gICAgICAgIHJldHVybiBlcnJvcnNBcnJheS5sZW5ndGggPT09IDA7XG4gICAgfTtcblxuICAgIHZhciBjaGVja0RlY2xhcmVJdGVtID0gZnVuY3Rpb24oIHNjb3BlLCBuYW1lLCB0eXBlLCByZXF1aXJlZCwgZGVmYXVsdFZhbHVlU3RyaW5nLCBkZWZhdWx0VmFsdWVFeHByZXNzaW9uICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGVycm9yc0FycmF5ID0gW107XG4gICAgICAgIFxuICAgICAgICB2YXIgdmFsdWUgPSBzY29wZS5nZXQoIG5hbWUgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCBkZWZhdWx0IHZhbHVlIGlmIG5lZWRlZFxuICAgICAgICBpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgJiYgZGVmYXVsdFZhbHVlRXhwcmVzc2lvbiAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICB2YXIgc2V0RGVmYXVsdFZhbHVlRXJyb3IgPSBzZXREZWZhdWx0VmFsdWUoIHNjb3BlLCBuYW1lLCB0eXBlLCBkZWZhdWx0VmFsdWVTdHJpbmcsIGRlZmF1bHRWYWx1ZUV4cHJlc3Npb24gKTtcbiAgICAgICAgICAgIGlmICggc2V0RGVmYXVsdFZhbHVlRXJyb3IgKXtcbiAgICAgICAgICAgICAgICBlcnJvcnNBcnJheS5wdXNoKCBzZXREZWZhdWx0VmFsdWVFcnJvciApO1xuICAgICAgICAgICAgICAgIHJldHVybiBlcnJvcnNBcnJheTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZhbHVlID0gc2NvcGUuZ2V0KCBuYW1lICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIHR5cGVcbiAgICAgICAgdmFyIHR5cGVDaGVja0Vycm9yID0gY2hlY2tUeXBlKCBuYW1lLCB0eXBlLCB2YWx1ZSApO1xuICAgICAgICBpZiAoIHR5cGVDaGVja0Vycm9yICl7XG4gICAgICAgICAgICBlcnJvcnNBcnJheS5wdXNoKCB0eXBlQ2hlY2tFcnJvciApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayByZXF1aXJlZFxuICAgICAgICB2YXIgcmVxdWlyZWRDaGVja0Vycm9yID0gY2hlY2tSZXF1aXJlZCggbmFtZSwgcmVxdWlyZWQsIHZhbHVlICk7XG4gICAgICAgIGlmICggcmVxdWlyZWRDaGVja0Vycm9yICl7XG4gICAgICAgICAgICBlcnJvcnNBcnJheS5wdXNoKCByZXF1aXJlZENoZWNrRXJyb3IgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVycm9yc0FycmF5O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGNoZWNrVHlwZSA9IGZ1bmN0aW9uKCBuYW1lLCBleHBlY3RlZFR5cGUsIHZhbHVlICkge1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGV4cGVjdGVkVHlwZSApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVhbFR5cGUgPSBnZXRUeXBlT2YoIHZhbHVlICk7XG4gICAgICAgIHJldHVybiByZWFsVHlwZSA9PT0gZXhwZWN0ZWRUeXBlLnRvTG93ZXJDYXNlKCk/IFxuICAgICAgICAgICAgZmFsc2U6IFxuICAgICAgICAgICAgJ0V4cGVjdGVkIHZhbHVlIHR5cGUgKCcgKyBleHBlY3RlZFR5cGUudG9Mb3dlckNhc2UoKSArICcpIG9mICcgKyBuYW1lICsgJyBwcm9wZXJ0eSBkb2VzIG5vdCBtYXRjaCB0eXBlICgnICsgcmVhbFR5cGUgKyAnKSwgdmFsdWUgaXMgXCInICsgdmFsdWUgKyAnXCIuJztcbiAgICB9O1xuICAgIFxuICAgIC8qXG4gICAgICAgIHR5cGVPZigpOyAgICAgICAgICAgICAgICAgICAvLyB1bmRlZmluZWRcbiAgICAgICAgdHlwZU9mKG51bGwpOyAgICAgICAgICAgICAgIC8vIG51bGxcbiAgICAgICAgdHlwZU9mKE5hTik7ICAgICAgICAgICAgICAgIC8vIG51bWJlclxuICAgICAgICB0eXBlT2YoNSk7ICAgICAgICAgICAgICAgICAgLy8gbnVtYmVyXG4gICAgICAgIHR5cGVPZihbXSk7ICAgICAgICAgICAgICAgICAvLyBhcnJheVxuICAgICAgICB0eXBlT2YoJycpOyAgICAgICAgICAgICAgICAgLy8gc3RyaW5nXG4gICAgICAgIHR5cGVPZihmdW5jdGlvbiAoKSB7fSk7ICAgICAvLyBmdW5jdGlvblxuICAgICAgICB0eXBlT2YoL2EvKSAgICAgICAgICAgICAgICAgLy8gcmVnZXhwXG4gICAgICAgIHR5cGVPZihuZXcgRGF0ZSgpKSAgICAgICAgICAvLyBkYXRlXG4gICAgICAgIHR5cGVPZihuZXcgRXJyb3IpICAgICAgICAgICAvLyBlcnJvclxuICAgICAgICB0eXBlT2YoUHJvbWlzZS5yZXNvbHZlKCkpICAgLy8gcHJvbWlzZVxuICAgICAgICB0eXBlT2YoZnVuY3Rpb24gKigpIHt9KSAgICAgLy8gZ2VuZXJhdG9yZnVuY3Rpb25cbiAgICAgICAgdHlwZU9mKG5ldyBXZWFrTWFwKCkpICAgICAgIC8vIHdlYWttYXBcbiAgICAgICAgdHlwZU9mKG5ldyBNYXAoKSkgICAgICAgICAgIC8vIG1hcFxuICAgICAgICB0eXBlT2Yoe30pOyAgICAgICAgICAgICAgICAgLy8gb2JqZWN0XG4gICAgICAgIHR5cGVPZihuZXcgTXlDb25zdHJ1Y3RvcigpKSAvLyBNeUNvbnN0cnVjdG9yXG4gICAgKi9cbiAgICB2YXIgZ2V0VHlwZU9mID0gZnVuY3Rpb24oIHZhbHVlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgdGVtcCA9IHt9LnRvU3RyaW5nLmNhbGwoIHZhbHVlICkuc3BsaXQoJyAnKVsgMSBdLnNsaWNlKCAwLCAtMSApLnRvTG93ZXJDYXNlKCk7XG4gICAgICAgIHJldHVybiB0ZW1wID09PSAnb2JqZWN0Jz8gXG4gICAgICAgICAgICB2YWx1ZS5jb25zdHJ1Y3Rvci5uYW1lLnRvTG93ZXJDYXNlKCk6IFxuICAgICAgICAgICAgdGVtcDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBjaGVja1JlcXVpcmVkID0gZnVuY3Rpb24oIG5hbWUsIHJlcXVpcmVkLCB2YWx1ZSApIHtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0cnVlID09PSByZXF1aXJlZCAmJiB2YWx1ZSA9PT0gdW5kZWZpbmVkPyBcbiAgICAgICAgICAgICdSZXF1aXJlZCB2YWx1ZSBtdXN0IG5vdCBiZSB1bmRlZmluZWQ6ICcgKyBuYW1lOlxuICAgICAgICAgICAgZmFsc2U7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgc2V0RGVmYXVsdFZhbHVlID0gZnVuY3Rpb24oIHNjb3BlLCBuYW1lLCB0eXBlLCBkZWZhdWx0VmFsdWVTdHJpbmcsIGRlZmF1bHRWYWx1ZUV4cHJlc3Npb24gKSB7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgdmFyIGRlZmF1bHRWYWx1ZSA9IGRlZmF1bHRWYWx1ZUV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBzY29wZS5zZXQoIG5hbWUsIGRlZmF1bHRWYWx1ZSApO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gY2F0Y2ggKCBlICkge1xuICAgICAgICAgICAgcmV0dXJuICdFcnJvciB0cnlpbmcgdG8gZXZhbHVhdGUgZGVmYXVsdCB2YWx1ZSBvZiBmaWVsZCAnICsgbmFtZSArICcsIGV4cHJlc3Npb24gWycgKyBkZWZhdWx0VmFsdWVTdHJpbmcgKyAnXTogJyArIGU7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBwcm9jZXNzRXJyb3JzQXJyYXkgPSBmdW5jdGlvbiggZXJyb3JzQXJyYXkgKSB7XG5cbiAgICAgICAgaWYgKCBlcnJvcnNBcnJheS5sZW5ndGggPT09IDAgKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhyb3cgZXJyb3JzQXJyYXk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTERlY2xhcmU6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IFRBTERlY2xhcmUuaWRcbiAgICB9O1xufTtcblxuVEFMRGVjbGFyZS5pZCA9ICd0YWw6ZGVjbGFyZSc7XG5cblRBTERlY2xhcmUuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuXG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuXG4gICAgdmFyIGRlY2xhcmVJdGVtcyA9IFtdO1xuICAgIHZhciBvbWl0VHlwZXMgPSBbICd1bmRlZmluZWQnLCAnbnVsbCcgXTtcbiAgICBcbiAgICB2YXIgdG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICBzdHJpbmcudHJpbSgpLCBcbiAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZGVjbGFyZURlbGltaXRlciwgXG4gICAgICAgIHRydWUgXG4gICAgKTtcblxuICAgIHdoaWxlICggdG9rZW5zLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBpblByb3BUb2tlbnMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICB0b2tlbnMubmV4dFRva2VuKCkudHJpbSgpLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmluRGVjbGFyZURlbGltaXRlciwgXG4gICAgICAgICAgICB0cnVlIFxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgdmFyIG5hbWUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciB0eXBlID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgZGVmYXVsdFZhbHVlU3RyaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgcmVxdWlyZWQgPSBmYWxzZTtcbiAgICAgICAgdmFyIHN0YXRlID0gMTtcbiAgICAgICAgd2hpbGUgKCBpblByb3BUb2tlbnMuaGFzTW9yZVRva2VucygpICl7XG4gICAgICAgICAgICB2YXIgY3VycmVudFRva2VuID0gaW5Qcm9wVG9rZW5zLm5leHRUb2tlbigpO1xuICAgICAgICAgICAgaWYgKCBUQUxEZWNsYXJlLnRva2VuSXNSZXF1aXJlZCggY3VycmVudFRva2VuICkgKXtcbiAgICAgICAgICAgICAgICByZXF1aXJlZCA9IHRydWU7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzd2l0Y2ggKCBzdGF0ZSApIHtcbiAgICAgICAgICAgICAgICBjYXNlIDE6XG4gICAgICAgICAgICAgICAgICAgIG5hbWUgPSBjdXJyZW50VG9rZW47XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgMjpcbiAgICAgICAgICAgICAgICAgICAgaWYgKCAtMSA9PT0gb21pdFR5cGVzLmluZGV4T2YoIGN1cnJlbnRUb2tlbi50b0xvd2VyQ2FzZSgpICkgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGUgPSBjdXJyZW50VG9rZW47ICAgXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAzOlxuICAgICAgICAgICAgICAgICAgICBkZWZhdWx0VmFsdWVTdHJpbmcgPSBjdXJyZW50VG9rZW47XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93ICdUb28gbWFueSBhcmd1bWVudHMgaW4gdGFsRGVjbGFyZSBpdGVtOiAnICsgc3RyaW5nLnRyaW0oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgICsrc3RhdGU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFRoZSBuYW1lIGlzIHRoZSBvbmx5IHJlcXVpcmVkIGVsZW1lbnRcbiAgICAgICAgaWYgKCAhIG5hbWUgKXtcbiAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBkZWNsYXJlSXRlbXMucHVzaCh7XG4gICAgICAgICAgICBuYW1lOiBuYW1lLFxuICAgICAgICAgICAgdHlwZTogdHlwZSxcbiAgICAgICAgICAgIHJlcXVpcmVkOiByZXF1aXJlZCxcbiAgICAgICAgICAgIGRlZmF1bHRWYWx1ZVN0cmluZzogZGVmYXVsdFZhbHVlU3RyaW5nLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlRXhwcmVzc2lvbjogZGVmYXVsdFZhbHVlU3RyaW5nID09IHVuZGVmaW5lZD8gdW5kZWZpbmVkOiBleHByZXNzaW9uQnVpbGRlci5idWlsZCggZGVmYXVsdFZhbHVlU3RyaW5nIClcbiAgICAgICAgfSk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBUQUxEZWNsYXJlKCBzdHJpbmcsIGRlY2xhcmVJdGVtcyApO1xufTtcblxuVEFMRGVjbGFyZS50b2tlbklzUmVxdWlyZWQgPSBmdW5jdGlvbiggdG9rZW4gKSB7XG4gICAgcmV0dXJuIFwicmVxdWlyZWRcIiA9PT0gdG9rZW4udG9Mb3dlckNhc2UoKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMRGVjbGFyZTtcbiIsIi8qXG4gICAgVEFMRGVmaW5lIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xuXG52YXIgVEFMRGVmaW5lID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGRlZmluZUl0ZW1zVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZGVmaW5lSXRlbXMgPSBkZWZpbmVJdGVtc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIGZvcmNlR2xvYmFsICl7XG4gICAgICAgIFxuICAgICAgICAvLyBVcGRhdGUgc2NvcGVcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGVmaW5lSXRlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgZGVmaW5lSXRlbSA9IGRlZmluZUl0ZW1zWyBpIF07XG4gICAgICAgICAgICBzY29wZS5zZXQoIFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmVJdGVtLm5hbWUsIFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmVJdGVtLm5vY2FsbD8gZGVmaW5lSXRlbS5leHByZXNzaW9uOiBkZWZpbmVJdGVtLmV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICksIFxuICAgICAgICAgICAgICAgICAgICBmb3JjZUdsb2JhbCB8fCBkZWZpbmVJdGVtLmdsb2JhbCxcbiAgICAgICAgICAgICAgICAgICAgZGVmaW5lSXRlbS5ub2NhbGwsXG4gICAgICAgICAgICAgICAgICAgIGRlZmluZUl0ZW0uZXhwcmVzc2lvblxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxEZWZpbmU6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IFRBTERlZmluZS5pZFxuICAgIH07XG59O1xuXG5UQUxEZWZpbmUuaWQgPSAndGFsOmRlZmluZSc7XG5cblRBTERlZmluZS5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG5cbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG5cbiAgICB2YXIgZGVmaW5lSXRlbXMgPSBbXTtcbiAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IHN0cmluZy50cmltKCk7XG4gICAgdmFyIHRva2VucyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgZXhwcmVzc2lvblN0cmluZywgXG4gICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmRlZmluZURlbGltaXRlciwgXG4gICAgICAgIHRydWUgKTtcblxuICAgIHdoaWxlICggdG9rZW5zLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgdmFyIHZhcmlhYmxlID0gdG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgdmFyIHNwYWNlID0gdmFyaWFibGUuaW5kZXhPZiggY29udGV4dC5nZXRDb25mKCkuaW5EZWZpbmVEZWxpbWl0ZXIgKTtcbiAgICAgICAgaWYgKCBzcGFjZSA9PT0gLTEgKSB7XG4gICAgICAgICAgICB0aHJvdyAnQmFkIHZhcmlhYmxlIGRlZmluaXRpb246ICcgKyB2YXJpYWJsZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBub2NhbGwgPSBmYWxzZTtcbiAgICAgICAgdmFyIGdsb2JhbCA9IGZhbHNlO1xuICAgICAgICB2YXIgY3VycmVudFRva2VuID0gdmFyaWFibGUuc3Vic3RyaW5nKCAwLCBzcGFjZSApO1xuICAgICAgICB2YXIgbmV4dFRva2VucyA9IHZhcmlhYmxlLnN1YnN0cmluZyggc3BhY2UgKyAxICkudHJpbSgpO1xuICAgICAgICB2YXIgdG9rZW5Eb25lID0gZmFsc2U7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciBzcGVjaWFsVG9rZW4gPSBmYWxzZTtcbiAgICAgICAgICAgIGlmICggY29udGV4dC5nZXRDb25mKCkuZ2xvYmFsVmFyaWFibGVFeHByZXNzaW9uUHJlZml4ID09PSBjdXJyZW50VG9rZW4gKXtcbiAgICAgICAgICAgICAgICBnbG9iYWwgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHNwZWNpYWxUb2tlbiA9IHRydWU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBjb250ZXh0LmdldENvbmYoKS5ub2NhbGxWYXJpYWJsZUV4cHJlc3Npb25QcmVmaXggPT09IGN1cnJlbnRUb2tlbiApe1xuICAgICAgICAgICAgICAgIG5vY2FsbCA9IHRydWU7ICBcbiAgICAgICAgICAgICAgICBzcGVjaWFsVG9rZW4gPSB0cnVlO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCBzcGVjaWFsVG9rZW4gKXtcbiAgICAgICAgICAgICAgICBzcGFjZSA9IG5leHRUb2tlbnMuaW5kZXhPZiggY29udGV4dC5nZXRDb25mKCkuaW5EZWZpbmVEZWxpbWl0ZXIgKTtcbiAgICAgICAgICAgICAgICBjdXJyZW50VG9rZW4gPSBuZXh0VG9rZW5zLnN1YnN0cmluZyggMCwgc3BhY2UgKTtcbiAgICAgICAgICAgICAgICBuZXh0VG9rZW5zID0gbmV4dFRva2Vucy5zdWJzdHJpbmcoIHNwYWNlICsgMSApLnRyaW0oKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgZGVmaW5lSXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgIG5hbWU6IGN1cnJlbnRUb2tlbixcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIG5leHRUb2tlbnMgKSxcbiAgICAgICAgICAgICAgICAgICAgZ2xvYmFsOiBnbG9iYWwsXG4gICAgICAgICAgICAgICAgICAgIG5vY2FsbDogbm9jYWxsXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgdG9rZW5Eb25lID0gdHJ1ZTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICB9IHdoaWxlKCAhIHRva2VuRG9uZSAmJiBzcGFjZSAhPT0gLTEgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFRBTERlZmluZSggc3RyaW5nLCBkZWZpbmVJdGVtcyApO1xufTtcblxuXG5UQUxEZWZpbmUuYXBwZW5kU3RyaW5ncyA9IGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHZhciByZXN1bHQgPSBhcmd1bWVudHNbIDAgXTtcbiAgICBcbiAgICBmb3IgKCB2YXIgYyA9IDE7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyArK2MgKXtcbiAgICAgICAgdmFyIHN0cmluZyA9IGFyZ3VtZW50c1sgYyBdO1xuICAgICAgICBpZiAoIHN0cmluZyApe1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0PyByZXN1bHQgKyBjb250ZXh0LmdldENvbmYoKS5kZWZpbmVEZWxpbWl0ZXIgKyBzdHJpbmc6IHN0cmluZztcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuVEFMRGVmaW5lLnVwZGF0ZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKCBub2RlLCBkZWZpbmVUb0FkZCApe1xuXG4gICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcbiAgICB2YXIgbm9kZURlZmluZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbERlZmluZSApO1xuICAgIHZhciBmdWxsRGVmaW5lID0gVEFMRGVmaW5lLmFwcGVuZFN0cmluZ3MoIGRlZmluZVRvQWRkLCBub2RlRGVmaW5lICk7XG5cbiAgICBpZiAoIGZ1bGxEZWZpbmUgKXtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIHRhZ3MudGFsRGVmaW5lLCBmdWxsRGVmaW5lICk7XG4gICAgfVxufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxEZWZpbmU7XG4iLCIvKlxuICAgIFRBTE9taXRUYWcgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEJvb2xlYW5MaXRlcmFsID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL3BhdGgvbGl0ZXJhbHMvYm9vbGVhbkxpdGVyYWwuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIFRBTE9taXRUYWcgPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvblRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSwgbm9kZSwgcGFyc2VyTm9kZVJlbmRlcmVyICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgaWYgKCAhIHJlc3VsdCApe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBQcm9jZXNzIHRoZSBjb250ZW50c1xuICAgICAgICBwYXJzZXJOb2RlUmVuZGVyZXIuZGVmYXVsdENvbnRlbnQoIG5vZGUgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIE1vdmUgY2hpbGRyZW4gZnJvbSBjdXJyZW50IG5vZGUgdG8gaXRzIHBhcmVudCBhbmQgdGhlbiByZW1vdmUgaXRcbiAgICAgICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcbiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gICAgICAgIHdoaWxlICggbm9kZS5maXJzdENoaWxkICkge1xuICAgICAgICAgICAgaWYgKCBub2RlLmZpcnN0Q2hpbGQubm9kZVR5cGUgPT09IDEgKXtcbiAgICAgICAgICAgICAgICBub2RlLmZpcnN0Q2hpbGQuc2V0QXR0cmlidXRlKCB0YWdzLnFkdXAsIDEgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHBhcmVudE5vZGUuYXBwZW5kQ2hpbGQoIG5vZGUuZmlyc3RDaGlsZCApO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5vZGUgKTtcblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gTm90aGluZyB0byBkb1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiVEFMT21pdFRhZzogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMT21pdFRhZy5pZFxuICAgIH07XG59O1xuXG5UQUxPbWl0VGFnLmlkID0gJ3RhbDpvbWl0LXRhZyc7XG5cblRBTE9taXRUYWcuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IHN0cmluZy50cmltKCk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uU3RyaW5nID09ICcnP1xuICAgICAgICAgICAgbmV3IEJvb2xlYW5MaXRlcmFsKCB0cnVlICk6XG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggZXhwcmVzc2lvblN0cmluZyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgVEFMT21pdFRhZyggc3RyaW5nLCBleHByZXNzaW9uICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTE9taXRUYWc7XG4iLCIvKlxuICAgIFRBTE9uRXJyb3IgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBjb250ZW50SGVscGVyID0gcmVxdWlyZSggJy4vY29udGVudEhlbHBlci5qcycgKTtcblxudmFyIFRBTE9uRXJyb3IgPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgc3RydWN0dXJlVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgc3RydWN0dXJlID0gc3RydWN0dXJlVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHV0VG9BdXRvRGVmaW5lSGVscGVyID0gZnVuY3Rpb24oIGF1dG9EZWZpbmVIZWxwZXIgKXtcblxuICAgICAgICAvLyBBZGQgb25FcnJvclZhck5hbWUgdG8gdGhlIGF1dG9EZWZpbmVIZWxwZXJcbiAgICAgICAgYXV0b0RlZmluZUhlbHBlci5wdXQoXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5vbkVycm9yVmFyTmFtZSxcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBvbkVycm9yU3RydWN0dXJlVmFyTmFtZSB0byB0aGUgYXV0b0RlZmluZUhlbHBlclxuICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLm9uRXJyb3JTdHJ1Y3R1cmVWYXJOYW1lLFxuICAgICAgICAgICAgc3RydWN0dXJlLFxuICAgICAgICAgICAgZmFsc2VcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxPbkVycm9yOiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHB1dFRvQXV0b0RlZmluZUhlbHBlcjogcHV0VG9BdXRvRGVmaW5lSGVscGVyLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMT25FcnJvci5pZFxuICAgIH07XG59O1xuXG5UQUxPbkVycm9yLmlkID0gJ3RhbDpvbi1lcnJvcic7XG5cblRBTE9uRXJyb3IuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuXG4gICAgcmV0dXJuIGNvbnRlbnRIZWxwZXIuYnVpbGQoIFxuICAgICAgICAnVEFMT25FcnJvcicsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZnVuY3Rpb24oIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfc3RydWN0dXJlLCBfZXhwcmVzc2lvblN0cmluZyApe1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUQUxPbkVycm9yKCBfZXhwcmVzc2lvblN0cmluZywgX3N0cnVjdHVyZSApO1xuICAgICAgICB9XG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMT25FcnJvcjtcbiIsIi8qXG4gICAgVEFMUmVwZWF0IGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG52YXIgTG9vcCA9IHJlcXVpcmUoICcuLi8uLi9wYXJzZXJzL2xvb3AuanMnICk7XG5cbnZhciBUQUxSZXBlYXQgPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgdmFyTmFtZVRvQXBwbHksIGV4cHJlc3Npb25TdHJpbmdUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciB2YXJOYW1lID0gdmFyTmFtZVRvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25TdHJpbmcgPSBleHByZXNzaW9uU3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBleHByZXNzaW9uU3RyaW5nICk7XG4gICAgdmFyIGxvb3A7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgbG9vcCA9IG5ldyBMb29wKCB2YXJOYW1lLCBleHByZXNzaW9uU3RyaW5nLCBzY29wZSApO1xuICAgICAgICByZXR1cm4gbG9vcDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUgKXtcbiAgICAgICAgcGFyc2VyVXBkYXRlci51cGRhdGVOb2RlKCBub2RlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxSZXBlYXQ6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldEV4cHJlc3Npb25TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvblN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRWYXJOYW1lID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHZhck5hbWU7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMUmVwZWF0LmlkLFxuICAgICAgICBnZXRFeHByZXNzaW9uU3RyaW5nOiBnZXRFeHByZXNzaW9uU3RyaW5nLFxuICAgICAgICBnZXRWYXJOYW1lOiBnZXRWYXJOYW1lXG4gICAgfTtcbn07XG5cblRBTFJlcGVhdC5pZCA9ICd0YWw6cmVwZWF0JztcblxuVEFMUmVwZWF0LmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IHN0cmluZy50cmltKCk7XG4gICAgdmFyIHNwYWNlID0gZXhwcmVzc2lvblN0cmluZy5pbmRleE9mKCAnICcgKTtcbiAgICBpZiAoIHNwYWNlID09PSAtMSApIHtcbiAgICAgICAgdGhyb3cgJ0JhZCByZXBlYXQgZXhwcmVzc2lvbjogJyArIGV4cHJlc3Npb25TdHJpbmc7XG4gICAgfVxuICAgIHZhciB2YXJOYW1lID0gZXhwcmVzc2lvblN0cmluZy5zdWJzdHJpbmcoIDAsIHNwYWNlICk7XG4gICAgdmFyIGxvb3BFeHByZXNzaW9uID0gZXhwcmVzc2lvblN0cmluZy5zdWJzdHJpbmcoIHNwYWNlICsgMSApO1xuICAgIFxuICAgIHJldHVybiBuZXcgVEFMUmVwZWF0KCBzdHJpbmcsIHZhck5hbWUsIGxvb3BFeHByZXNzaW9uICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTFJlcGVhdDtcbiIsIi8qXG4gICAgVEFMUmVwbGFjZSBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgY29udGVudEhlbHBlciA9IHJlcXVpcmUoICcuL2NvbnRlbnRIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgVEFMUmVwbGFjZSA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSwgc3RydWN0dXJlVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBzdHJ1Y3R1cmUgPSBzdHJ1Y3R1cmVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlICl7XG4gICAgICAgIFxuICAgICAgICAvLyBFdmFsdWF0ZVxuICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVUb05vdE51bGwoIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayBkZWZhdWx0XG4gICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuaXNEZWZhdWx0KCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDaGVjayBub3RoaW5nXG4gICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuaXNOb3RoaW5nKCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgZXZhbHVhdGVkID0gXCJcIjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCBzdHJ1Y3R1cmUgKXtcbiAgICAgICAgICAgIC8vIFJlcGxhY2UgSFRNTFxuICAgICAgICAgICAgbm9kZS5vdXRlckhUTUwgPSBldmFsdWF0ZWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFJlcGxhY2Ugb3JpZ2luYWwgbm9kZSBieSBuZXcgdGV4dCBub2RlXG4gICAgICAgICAgICB2YXIgdGV4dE5vZGUgPSBub2RlLm93bmVyRG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoIGV2YWx1YXRlZCApO1xuICAgICAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZCggdGV4dE5vZGUsIG5vZGUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIC8vcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggdW5kZWZpbmVkLCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiAnVEFMUmVwbGFjZTogJyArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxSZXBsYWNlLmlkXG4gICAgfTtcbn07XG5cblRBTFJlcGxhY2UuaWQgPSAndGFsOnJlcGxhY2UnO1xuXG5UQUxSZXBsYWNlLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcblxuICAgIHJldHVybiBjb250ZW50SGVscGVyLmJ1aWxkKCBcbiAgICAgICAgJ1RBTFJlcGxhY2UnLFxuICAgICAgICBzdHJpbmcsXG4gICAgICAgIGZ1bmN0aW9uKCBfc3RyaW5nLCBfZXhwcmVzc2lvbiwgX3N0cnVjdHVyZSApe1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBUQUxSZXBsYWNlKCBfc3RyaW5nLCBfZXhwcmVzc2lvbiwgX3N0cnVjdHVyZSApO1xuICAgICAgICB9XG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMUmVwbGFjZTtcbiIsIi8qIFxuICAgIGF0dHJpYnV0ZUluZGV4IHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vdXRpbHMuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcbiAgICB2YXIgbWFwO1xuICAgIFxuICAgIHZhciByZXNldCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIG1hcCA9IHt9O1xuICAgIH07XG4gICAgcmVzZXQoKTtcbiAgICBcbiAgICB2YXIgYWRkID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgYWRkTGlzdChcbiAgICAgICAgICAgIG5vZGUsXG4gICAgICAgICAgICBhdHRyaWJ1dGVJbnN0YW5jZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLmRlcGVuZHNPbiggc2NvcGUgKVxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGFkZExpc3QgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGxpc3QsIGdyb3VwSWQgKXtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICBhZGRBbnkoIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCBsaXN0WyBpIF0sIGdyb3VwSWQgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIGFkZE9iamVjdCA9IGZ1bmN0aW9uKCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgaXRlbSApe1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGdyb3VwSWQgaW4gaXRlbSApe1xuICAgICAgICAgICAgYWRkQW55KCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgaXRlbVsgZ3JvdXBJZCBdLCBncm91cElkICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHZhciBhZGRBbnkgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGl0ZW0sIGdyb3VwSWQgKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggdXRpbHMuaXNQbGFpbk9iamVjdCggaXRlbSApICl7XG4gICAgICAgICAgICBhZGRPYmplY3QoIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCBpdGVtICk7XG4gICAgICAgIH0gZWxzZSBpZiAoIEFycmF5LmlzQXJyYXkoIGl0ZW0gKSApe1xuICAgICAgICAgICAgYWRkTGlzdCggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGl0ZW0sIGdyb3VwSWQgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGFkZFZhciggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGl0ZW0sIGdyb3VwSWQgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLypcbiAgICB2YXIgYWRkVmFyID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCB2YXJOYW1lLCBncm91cElkICApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGxpc3QgPSBtYXBbIHZhck5hbWUgXTtcbiAgICAgICAgaWYgKCAhIGxpc3QgKXtcbiAgICAgICAgICAgIGxpc3QgPSBbXTtcbiAgICAgICAgICAgIG1hcFsgdmFyTmFtZSBdID0gbGlzdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGxpc3QucHVzaChcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVJbnN0YW5jZTogYXR0cmlidXRlSW5zdGFuY2UsXG4gICAgICAgICAgICAgICAgbm9kZUlkOiBub2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKSxcbiAgICAgICAgICAgICAgICBncm91cElkOiBncm91cElkXG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfTtcbiAgICAqL1xuICAgIHZhciBhZGRWYXIgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIHZhck5hbWUsIGdyb3VwSWQgICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IG1hcFsgdmFyTmFtZSBdO1xuICAgICAgICBpZiAoICEgbGlzdCApe1xuICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgbWFwWyB2YXJOYW1lIF0gPSBsaXN0O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgbmV3SXRlbSA9IHtcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlOiBhdHRyaWJ1dGVJbnN0YW5jZSxcbiAgICAgICAgICAgIG5vZGVJZDogbm9kZS5nZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmlkICksXG4gICAgICAgICAgICBncm91cElkOiBncm91cElkXG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICAvL3ZhciBpbmRleCA9IGxpc3QuZmluZEluZGV4KCBpdGVtID0+IHV0aWxzLmRlZXBFcXVhbCggaXRlbSwgbmV3SXRlbSApICk7XG4gICAgICAgIHZhciBpbmRleCA9IGxpc3QuZmluZEluZGV4KCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCBpdGVtICkgeyBcbiAgICAgICAgICAgICAgICByZXR1cm4gdXRpbHMuZGVlcEVxdWFsKCBpdGVtLCBuZXdJdGVtICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICggaW5kZXggPT09IC0xICl7XG4gICAgICAgICAgICBsaXN0LnB1c2goIG5ld0l0ZW0gKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3RbIGluZGV4IF0gPSBuZXdJdGVtO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0VmFyc0xpc3QgPSBmdW5jdGlvbiggdmFyTmFtZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGl0ZW1zID0gbWFwWyB2YXJOYW1lIF07XG4gICAgICAgIFxuICAgICAgICAvLyBSZXR1cm4gYW4gZW1wdHkgbGlzdCBpZiBuZWVkZWRcbiAgICAgICAgaWYgKCBpdGVtcyA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBpdGVtcyB3aXRoIHJlbW92ZWQgbm9kZXNcbiAgICAgICAgY2xlYW5JdGVtcyggaXRlbXMgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFdlIG11c3QgYnVpbGQgYW5vdGhlciBsaXN0IHRvIGF2b2lkIHN5bmMgZXJyb3JzXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggaXRlbXMgKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIC8vVE9ETyBmaW5kTm9kZUJ5SWQgZHVwbGljYXRlZFxuICAgIHZhciBmaW5kTm9kZUJ5SWQgPSBmdW5jdGlvbiAoIG5vZGVJZCApIHtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXG4gICAgICAgICAgICAnWycgKyBjb250ZXh0LmdldFRhZ3MoKS5pZCArICc9XCInICsgbm9kZUlkICsgJ1wiXScgXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICAvLyBJdGVyYXRlIHRocm91Z2ggaXRlbXMgYW5kIHJlbW92ZSB0aGVtIHdoZW4gbm9kZSBkb2VzIG5vdCBleGlzdCBpbiBET01cbiAgICB2YXIgY2xlYW5JdGVtcyA9IGZ1bmN0aW9uKCBpdGVtcyApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGluZGV4ZXNUb1JlbW92ZSA9IFtdO1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgbGlzdCBvZiBpdGVtcyB0byByZW1vdmVcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIHZhciBpdGVtID0gaXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHZhciBub2RlID0gZmluZE5vZGVCeUlkKCBpdGVtLm5vZGVJZCApO1xuICAgICAgICAgICAgaWYgKCAhIG5vZGUgKXtcbiAgICAgICAgICAgICAgICBpbmRleGVzVG9SZW1vdmUucHVzaCggaSApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgaXRlbXNcbiAgICAgICAgZm9yICggdmFyIGogPSBpbmRleGVzVG9SZW1vdmUubGVuZ3RoIC0gMTsgaiA+PSAwIDsgLS1qICl7XG4gICAgICAgICAgICB2YXIgaW5kZXhUb1JlbW92ZSA9IGluZGV4ZXNUb1JlbW92ZVsgaiBdO1xuICAgICAgICAgICAgaXRlbXMuc3BsaWNlKCBpbmRleFRvUmVtb3ZlLCAxICk7XG4gICAgICAgIH07XG4gICAgfTtcbiAgICAvKlxuICAgIHZhciByZW1vdmVWYXIgPSBmdW5jdGlvbiggdmFyTmFtZSwgbm9kZUlkICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IG1hcFsgdmFyTmFtZSBdO1xuXG4gICAgICAgIHZhciBmaWx0ZXJlZCA9IGxpc3QuZmlsdGVyKFxuICAgICAgICAgICAgZnVuY3Rpb24oIHZhbHVlLCBpbmRleCwgYXJyICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHZhbHVlLm5vZGVJZCAhPT0gbm9kZUlkO1xuICAgICAgICAgICAgfVxuICAgICAgICApO1xuXG4gICAgICAgIG1hcFsgdmFyTmFtZSBdID0gZmlsdGVyZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVtb3ZlVmFyRnJvbU5vZGVzID0gZnVuY3Rpb24oIHZhck5hbWUsIG5vZGVJZHMgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsaXN0ID0gbWFwWyB2YXJOYW1lIF07XG5cbiAgICAgICAgdmFyIGZpbHRlcmVkID0gbGlzdC5maWx0ZXIoXG4gICAgICAgICAgICBmdW5jdGlvbiggdmFsdWUsIGluZGV4LCBhcnIgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gbm9kZUlkcy5pbmRleE9mKCB2YWx1ZS5ub2RlSWQgKSA9PT0gLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgaWYgKCBmaWx0ZXJlZC5sZW5ndGggPT09IDAgKXtcbiAgICAgICAgICAgIGRlbGV0ZSBtYXBbIHZhck5hbWUgXTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIG1hcFsgdmFyTmFtZSBdID0gZmlsdGVyZWQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0QWxsTm9kZUlkcyA9IGZ1bmN0aW9uKCB0YXJnZXQgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCB0aGUgbGlzdFxuICAgICAgICB2YXIgbGlzdCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKCAnWycgKyBjb250ZXh0LmdldFRhZ3MoKS5pZCArICddJyApO1xuXG4gICAgICAgIC8vIEl0ZXJhdGUgdGhlIGxpc3RcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICB2YXIgbm9kZUlkQXR0cmlidXRlTmFtZSA9IGNvbnRleHQuZ2V0VGFncygpLmlkO1xuICAgICAgICB2YXIgbm9kZTtcbiAgICAgICAgdmFyIHBvcyA9IDA7XG4gICAgICAgIHdoaWxlICggbm9kZSA9IGxpc3RbIHBvcysrIF0gKSB7XG4gICAgICAgICAgICByZXN1bHQucHVzaCggXG4gICAgICAgICAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoIG5vZGVJZEF0dHJpYnV0ZU5hbWUgKSBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVtb3ZlTm9kZSA9IGZ1bmN0aW9uKCBub2RlICl7XG5cbiAgICAgICAgdmFyIG5vZGVJZHMgPSBnZXRBbGxOb2RlSWRzKCBub2RlICk7XG5cbiAgICAgICAgdmFyIG5vZGVJZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5pZCApO1xuICAgICAgICBub2RlSWRzLnB1c2goIG5vZGVJZCApO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIHZhck5hbWUgaW4gbWFwICl7XG4gICAgICAgICAgICByZW1vdmVWYXJGcm9tTm9kZXMoIHZhck5hbWUsIG5vZGVJZHMgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdmFyIHJlbW92ZU11bHRpcGxlTm9kZXMgPSBmdW5jdGlvbiggbm9kZUlkcyApe1xuXG4gICAgICAgIGZvciAoIHZhciB2YXJOYW1lIGluIG1hcCApe1xuICAgICAgICAgICAgcmVtb3ZlVmFyRnJvbU5vZGVzKCB2YXJOYW1lLCBub2RlSWRzICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgICovXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBhZGQsXG4gICAgICAgIGdldFZhcnNMaXN0OiBnZXRWYXJzTGlzdCxcbiAgICAgICAgLy9yZW1vdmVWYXI6IHJlbW92ZVZhcixcbiAgICAgICAgLy9yZW1vdmVOb2RlOiByZW1vdmVOb2RlLFxuICAgICAgICAvL3JlbW92ZU11bHRpcGxlTm9kZXM6IHJlbW92ZU11bHRpcGxlTm9kZXMsXG4gICAgICAgIHJlc2V0OiByZXNldFxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBhdHRyaWJ1dGVDYWNoZSBzaW5nbGV0b24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIENhY2hlSGVscGVyID0gcmVxdWlyZSggJy4vY2FjaGVIZWxwZXIuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xudmFyIGxvZyA9IHJlcXVpcmUoICcuLi9sb2dIZWxwZXIuanMnICk7XG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9hdHRyaWJ1dGVJbmRleC5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIG1hcDtcbiAgICBcbiAgICB2YXIgcmVzZXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBtYXAgPSB7fTtcbiAgICB9O1xuICAgIHJlc2V0KCk7XG4gICAgXG4gICAgdmFyIGdldCA9IGZ1bmN0aW9uKCBhdHRyaWJ1dGUsIHN0cmluZyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBhdHRyaWJ1dGVNYXAgPSBtYXBbIGF0dHJpYnV0ZSBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGF0dHJpYnV0ZU1hcCApe1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgIFxuICAgICAgICByZXR1cm4gYXR0cmlidXRlTWFwWyBDYWNoZUhlbHBlci5oYXNoQ29kZSggc3RyaW5nICkgXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwdXQgPSBmdW5jdGlvbiggYXR0cmlidXRlLCBzdHJpbmcsIHZhbHVlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgYXR0cmlidXRlTWFwID0gbWFwWyBhdHRyaWJ1dGUgXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBhdHRyaWJ1dGVNYXAgKXtcbiAgICAgICAgICAgIGF0dHJpYnV0ZU1hcCA9IHt9O1xuICAgICAgICAgICAgbWFwWyBhdHRyaWJ1dGUgXSA9IGF0dHJpYnV0ZU1hcDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgYXR0cmlidXRlTWFwWyBDYWNoZUhlbHBlci5oYXNoQ29kZSggc3RyaW5nICkgXSA9IHZhbHVlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGluZGV4ID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZSwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggbm9kZSApe1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnTXVzdCBpbmRleCEnICk7XG4gICAgICAgICAgICBhdHRyaWJ1dGVJbmRleC5hZGQoIG5vZGUsIGF0dHJpYnV0ZSwgc2NvcGUgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnTm90IGluZGV4ZWQhJyApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYXR0cmlidXRlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldEJ5RGV0YWlscyA9IGZ1bmN0aW9uKCBhdHRyaWJ1dGVUeXBlLCBzdHJpbmcsIGJ1aWxkRnVuY3Rpb24sIGZvcmNlLCBub2RlLCBzY29wZSApIHtcbiAgICAgICAgXG4gICAgICAgIGxvZy5kZWJ1ZyggXG4gICAgICAgICAgICAnUmVxdWVzdCBidWlsZGluZyBvZiBaUFQgYXR0cmlidXRlIFwiJyArIHN0cmluZyArICdcIiwgZm9yY2UgXCInICsgZm9yY2UgKyAnXCInICk7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZnJvbSBjYWNoZSBpZiBwb3NzaWJsZVxuICAgICAgICBpZiAoIGZvcmNlIHx8ICEgY29udGV4dC5nZXRDb25mKCkuYXR0cmlidXRlQ2FjaGVPbiApe1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnQ2FjaGUgT0ZGIScgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnQ2FjaGUgT04hJyApO1xuICAgICAgICAgICAgdmFyIGZyb21DYWNoZSA9IGdldCggYXR0cmlidXRlVHlwZSwgc3RyaW5nICk7XG4gICAgICAgICAgICBpZiAoIGZyb21DYWNoZSApe1xuICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZyggJ0ZvdW5kIGluIGNhY2hlIScgKTtcbiAgICAgICAgICAgICAgICAvL3JldHVybiBmcm9tQ2FjaGU7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGluZGV4KCBub2RlLCBmcm9tQ2FjaGUsIHNjb3BlICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZyggJ05PVCBmb3VuZCBpbiBjYWNoZSEnICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZvcmNlIGJ1aWxkIGFuZCBwdXQgaW50byBjYWNoZVxuICAgICAgICBsb2cuZGVidWcoICdNdXN0IGJ1aWxkIScgKTtcbiAgICAgICAgdmFyIGJ1aWxkZWQgPSBidWlsZEZ1bmN0aW9uKCk7XG4gICAgICAgIHB1dCggYXR0cmlidXRlVHlwZSwgc3RyaW5nLCBidWlsZGVkICk7XG4gICAgICAgIC8vcmV0dXJuIGJ1aWxkZWQ7XG4gICAgICAgIHJldHVybiBpbmRleCggbm9kZSwgYnVpbGRlZCwgc2NvcGUgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRCeUF0dHJpYnV0ZUNsYXNzID0gZnVuY3Rpb24oIGF0dHJpYnV0ZUluc3RhbmNlLCBzdHJpbmcsIG5vZGUsIGluZGV4RXhwcmVzc2lvbnMsIHNjb3BlLCBjb25zdHJ1Y3RvciApIHtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBnZXRCeURldGFpbHMoIFxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLmlkLCBcbiAgICAgICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgICAgIGNvbnN0cnVjdG9yIHx8IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBhdHRyaWJ1dGVJbnN0YW5jZS5idWlsZCggc3RyaW5nICk7XG4gICAgICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgICAgZmFsc2UsXG4gICAgICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucz8gbm9kZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIHNjb3BlXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICAvL2dldEJ5RGV0YWlsczogZ2V0QnlEZXRhaWxzLFxuICAgICAgICBnZXRCeUF0dHJpYnV0ZUNsYXNzOiBnZXRCeUF0dHJpYnV0ZUNsYXNzLFxuICAgICAgICByZXNldDogcmVzZXRcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgY2FjaGVIZWxwZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGhhc2hDb2RlID0gZnVuY3Rpb24oIHN0cmluZyApIHtcblxuICAgICAgICBpZiAoIEFycmF5LnByb3RvdHlwZS5yZWR1Y2UgKSB7XG4gICAgICAgICAgICByZXR1cm4gc3RyaW5nLnNwbGl0KCBcIlwiICkucmVkdWNlKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCBhLCBiICl7XG4gICAgICAgICAgICAgICAgICAgIGEgPSAoICggYSA8PCA1ICkgLSBhICkgKyBiLmNoYXJDb2RlQXQoIDAgKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGEmYVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgMCApO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGhhc2ggPSAwO1xuICAgICAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKXtcbiAgICAgICAgICAgIHJldHVybiBoYXNoO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoIHZhciBpID0gMCwgbGVuID0gc3RyaW5nLmxlbmd0aDsgaSA8IGxlbjsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGNociA9IHN0cmluZy5jaGFyQ29kZUF0KCBpICk7XG4gICAgICAgICAgICBoYXNoID0gKCAoIGhhc2ggPDwgNSApIC0gaGFzaCApICsgY2hyO1xuICAgICAgICAgICAgaGFzaCB8PSAwOyAvLyBDb252ZXJ0IHRvIDMyYml0IGludGVnZXJcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGhhc2g7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBoYXNoQ29kZTogaGFzaENvZGVcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgZXhwcmVzc2lvbkNhY2hlIHNpbmdsZXRvbiBjbGFzc1xuKi9cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciBDYWNoZUhlbHBlciA9IHJlcXVpcmUoICcuL2NhY2hlSGVscGVyLmpzJyApO1xuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG4gICAgdmFyIGxvZyA9IHJlcXVpcmUoICcuLi9sb2dIZWxwZXIuanMnICk7XG4gICAgXG4gICAgdmFyIG1hcCA9IHt9O1xuICAgIFxuICAgIHZhciBnZXQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgICAgICByZXR1cm4gbWFwWyBDYWNoZUhlbHBlci5oYXNoQ29kZSggc3RyaW5nICkgXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwdXQgPSBmdW5jdGlvbiggc3RyaW5nLCB2YWx1ZSApe1xuICAgICAgICBtYXBbIENhY2hlSGVscGVyLmhhc2hDb2RlKCBzdHJpbmcgKSBdID0gdmFsdWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzdHJpbmcsIGJ1aWxkRnVuY3Rpb24sIGZvcmNlICkge1xuICAgICAgICBcbiAgICAgICAgbG9nLmRlYnVnKCBcbiAgICAgICAgICAgICdSZXF1ZXN0IGJ1aWxkaW5nIG9mIGV4cHJlc3Npb24gXCInICsgc3RyaW5nICsgJ1wiLCBmb3JjZSBcIicgKyBmb3JjZSArICdcIicgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmcm9tIGNhY2hlIGlmIHBvc3NpYmxlXG4gICAgICAgIGlmICggISBmb3JjZSAmJiBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uQ2FjaGVPbiApe1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnQ2FjaGUgT04hJyApO1xuICAgICAgICAgICAgdmFyIGZyb21DYWNoZSA9IGdldCggc3RyaW5nICk7XG4gICAgICAgICAgICBpZiAoIGZyb21DYWNoZSApe1xuICAgICAgICAgICAgICAgIGxvZy5kZWJ1ZyggJ0ZvdW5kIGluIGNhY2hlIScgKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnJvbUNhY2hlO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyggJ05PVCBmb3VuZCBpbiBjYWNoZSEnICk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZy5kZWJ1ZyggJ0NhY2hlIE9GRiEnICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEZvcmNlIGJ1aWxkIGFuZCBwdXQgaW50byBjYWNoZVxuICAgICAgICBsb2cuZGVidWcoICdNdXN0IGJ1aWxkIScgKTtcbiAgICAgICAgdmFyIGJ1aWxkZWQgPSBidWlsZEZ1bmN0aW9uKCk7XG4gICAgICAgIHB1dCggc3RyaW5nLCBidWlsZGVkICk7XG4gICAgICAgIHJldHVybiBidWlsZGVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGNsZWFuID0gZnVuY3Rpb24oICkge1xuICAgICAgICBtYXAgPSB7fTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGdldDogcHJvY2VzcyxcbiAgICAgICAgY2xlYW46IGNsZWFuXG4gICAgfTtcbn0pKCk7XG4iLCIvKiBcbiAgICBjb250ZXh0IHNpbmdsZXRvbiBjbGFzc1xuKi9cblxudmFyIGxvZzRqYXZhc2NyaXB0ID0gcmVxdWlyZSggJ2xvZzRqYXZhc2NyaXB0JyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4vdXRpbHMuanMnICk7XG52YXIgTG9vcEl0ZW0gPSByZXF1aXJlKCAnLi9wYXJzZXJzL2xvb3BJdGVtLmpzJyApO1xudmFyIENTU0FuaW1hdGlvbk1hbmFnZXIgPSByZXF1aXJlKCAnLi9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL2Nzc0FuaW1hdGlvbk1hbmFnZXIuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIC8qIFRhZ3MgKi9cbiAgICB2YXIgZGVmYXVsdFRhZ3MgPSB7XG4gICAgICAgIHRhbENvbmRpdGlvbjogICAgIFwiZGF0YS1jb25kaXRpb25cIixcbiAgICAgICAgdGFsUmVwZWF0OiAgICAgICAgXCJkYXRhLXJlcGVhdFwiLFxuICAgICAgICB0YWxBdHRyaWJ1dGVzOiAgICBcImRhdGEtYXR0cmlidXRlc1wiLFxuICAgICAgICB0YWxDb250ZW50OiAgICAgICBcImRhdGEtY29udGVudFwiLFxuICAgICAgICB0YWxEZWZpbmU6ICAgICAgICBcImRhdGEtZGVmaW5lXCIsXG4gICAgICAgIHRhbEF1dG9EZWZpbmU6ICAgIFwiZGF0YS10YXV0by1kZWZpbmVcIixcbiAgICAgICAgdGFsT21pdFRhZzogICAgICAgXCJkYXRhLW9taXQtdGFnXCIsXG4gICAgICAgIHRhbFJlcGxhY2U6ICAgICAgIFwiZGF0YS1yZXBsYWNlXCIsXG4gICAgICAgIHRhbE9uRXJyb3I6ICAgICAgIFwiZGF0YS1vbi1lcnJvclwiLFxuICAgICAgICB0YWxEZWNsYXJlOiAgICAgICAgIFwiZGF0YS1kZWNsYXJlXCIsXG4gICAgICAgIG1ldGFsRGVmaW5lTWFjcm86IFwiZGF0YS1kZWZpbmUtbWFjcm9cIixcbiAgICAgICAgbWV0YWxVc2VNYWNybzogICAgXCJkYXRhLXVzZS1tYWNyb1wiLFxuICAgICAgICBtZXRhbERlZmluZVNsb3Q6ICBcImRhdGEtZGVmaW5lLXNsb3RcIixcbiAgICAgICAgbWV0YWxGaWxsU2xvdDogICAgXCJkYXRhLWZpbGwtc2xvdFwiLFxuICAgICAgICBtZXRhbE1hY3JvOiAgICAgICBcImRhdGEtbW1hY3JvXCIsXG4gICAgICAgIGkxOG5Eb21haW46ICAgICAgIFwiZGF0YS1kb21haW5cIixcbiAgICAgICAgaTE4bkxhbmd1YWdlOiAgICAgXCJkYXRhLWxhbmd1YWdlXCIsXG4gICAgICAgIC8vc2NvcGVLZXk6ICAgICAgICAgXCJkYXRhLXNjb3BlLWtleVwiLFxuICAgICAgICByb290S2V5OiAgICAgICAgICBcImRhdGEtcm9vdC1rZXlcIixcbiAgICAgICAgcWR1cDogICAgICAgICAgICAgXCJkYXRhLXFkdXBcIixcbiAgICAgICAgaWQ6ICAgICAgICAgICAgICAgXCJkYXRhLWlkXCIsXG4gICAgICAgIHJlbGF0ZWRJZDogICAgICAgIFwiZGF0YS1yZWxhdGVkLWlkXCIsXG4gICAgICAgIGNvbmRpdGlvblJlc3VsdDogIFwiZGF0YS1jb25kaXRpb24tcmVzdWx0XCJcbiAgICB9O1xuICAgIHZhciBvcmlnaW5hbFRhZ3MgPSB7XG4gICAgICAgIHRhbENvbmRpdGlvbjogICAgIFwidGFsOmNvbmRpdGlvblwiLFxuICAgICAgICB0YWxSZXBlYXQ6ICAgICAgICBcInRhbDpyZXBlYXRcIixcbiAgICAgICAgdGFsQXR0cmlidXRlczogICAgXCJ0YWw6YXR0cmlidXRlc1wiLFxuICAgICAgICB0YWxDb250ZW50OiAgICAgICBcInRhbDpjb250ZW50XCIsXG4gICAgICAgIHRhbERlZmluZTogICAgICAgIFwidGFsOmRlZmluZVwiLFxuICAgICAgICB0YWxBdXRvRGVmaW5lOiAgICBcInRhbDphdXRvLWRlZmluZVwiLFxuICAgICAgICB0YWxPbWl0VGFnOiAgICAgICBcInRhbDpvbWl0LXRhZ1wiLFxuICAgICAgICB0YWxSZXBsYWNlOiAgICAgICBcInRhbDpyZXBsYWNlXCIsXG4gICAgICAgIHRhbE9uRXJyb3I6ICAgICAgIFwidGFsOm9uLWVycm9yXCIsXG4gICAgICAgIHRhbERlY2xhcmU6ICAgICAgIFwidGFsOmRlY2xhcmVcIixcbiAgICAgICAgbWV0YWxEZWZpbmVNYWNybzogXCJtZXRhbDpkZWZpbmUtbWFjcm9cIixcbiAgICAgICAgbWV0YWxVc2VNYWNybzogICAgXCJtZXRhbDp1c2UtbWFjcm9cIixcbiAgICAgICAgbWV0YWxEZWZpbmVTbG90OiAgXCJtZXRhbDpkZWZpbmUtc2xvdFwiLFxuICAgICAgICBtZXRhbEZpbGxTbG90OiAgICBcIm1ldGFsOmZpbGwtc2xvdFwiLFxuICAgICAgICBtZXRhbE1hY3JvOiAgICAgICBcImRhdGEtbW1hY3JvXCIsXG4gICAgICAgIGkxOG5Eb21haW46ICAgICAgIFwiaTE4bjpkb21haW5cIixcbiAgICAgICAgaTE4bkxhbmd1YWdlOiAgICAgXCJpMThuOmxhbmd1YWdlXCIsXG4gICAgICAgIC8vc2NvcGVLZXk6ICAgICAgICAgXCJkYXRhLXNjb3BlLWtleVwiLFxuICAgICAgICByb290S2V5OiAgICAgICAgICBcImRhdGEtcm9vdC1rZXlcIixcbiAgICAgICAgcWR1cDogICAgICAgICAgICAgXCJkYXRhLXFkdXBcIixcbiAgICAgICAgaWQ6ICAgICAgICAgICAgICAgXCJkYXRhLWlkXCIsXG4gICAgICAgIHJlbGF0ZWRJZDogICAgICAgIFwiZGF0YS1yZWxhdGVkLWlkXCIsXG4gICAgICAgIGNvbmRpdGlvblJlc3VsdDogIFwiZGF0YS1jb25kaXRpb24tcmVzdWx0XCJcbiAgICB9O1xuICAgIHZhciB0YWdzID0gZGVmYXVsdFRhZ3M7XG4gICAgdmFyIHRhbCA9ICcnO1xuICAgIFxuICAgIHZhciBnZXRUYWdzID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIHJldHVybiB0YWdzO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHNldFRhZ3MgPSBmdW5jdGlvbiAoIHRhZ3NUb1NldCApe1xuICAgICAgICB0YWdzID0gdGFnc1RvU2V0O1xuICAgICAgICB0YWwgPSAnJztcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRUYWwgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgaWYgKCB0YWwgPT09ICcnICl7XG4gICAgICAgICAgICB2YXIgYyA9IDA7XG4gICAgICAgICAgICB2YXIgbm90SW5jbHVkZSA9IHRhZ3MucWR1cDtcbiAgICAgICAgICAgIGZvciAoIHZhciBwcm9wZXJ0eSBpbiB0YWdzICkge1xuICAgICAgICAgICAgICAgIGlmICggbm90SW5jbHVkZSA9PT0gdGFnc1sgcHJvcGVydHkgXSApe1xuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKCBjKysgPiAwKXtcbiAgICAgICAgICAgICAgICAgICAgdGFsICs9IFwiLFwiO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB0YWwgKz0gXCIqW1wiICsgdGFnc1sgcHJvcGVydHkgXSArIFwiXVwiO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdGFsO1xuICAgIH07XG4gICAgdmFyIHVzZU9yaWdpbmFsVGFncyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHNldFRhZ3MoIG9yaWdpbmFsVGFncyApO1xuICAgIH07XG4gICAgLyogRW5kIFRhZ3MgKi9cbiAgICBcbiAgICAvKiBGb3JtYXR0ZXJzICovXG4gICAgdmFyIGZvcm1hdHRlcnMgPSB7fTtcbiAgICBmb3JtYXR0ZXJzLmxvd2VyQ2FzZSA9IGZ1bmN0aW9uICggdmFsdWUgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvTG9jYWxlTG93ZXJDYXNlKCk7XG4gICAgfTtcbiAgICBmb3JtYXR0ZXJzLnVwcGVyQ2FzZSA9IGZ1bmN0aW9uICggdmFsdWUgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvTG9jYWxlVXBwZXJDYXNlKCk7XG4gICAgfTtcbiAgICBmb3JtYXR0ZXJzLmxvY2FsZURhdGUgPSBmdW5jdGlvbiAoIHZhbHVlICl7XG4gICAgICAgIHJldHVybiB2YWx1ZS50b0xvY2FsZURhdGVTdHJpbmc7XG4gICAgfTtcbiAgICBmb3JtYXR0ZXJzLmxvY2FsZVRpbWUgPSBmdW5jdGlvbiAoIHZhbHVlICl7XG4gICAgICAgIHJldHVybiB2YWx1ZS50b0xvY2FsZVRpbWVTdHJpbmc7XG4gICAgfTtcbiAgICBmb3JtYXR0ZXJzLmxvY2FsZVN0cmluZyA9IGZ1bmN0aW9uICggdmFsdWUsIGxvY2FsZSApe1xuICAgICAgICByZXR1cm4gbG9jYWxlPyBcbiAgICAgICAgICAgICAgIHZhbHVlLnRvTG9jYWxlU3RyaW5nKCB2YWx1ZSwgbG9jYWxlICk6IFxuICAgICAgICAgICAgICAgdmFsdWUudG9Mb2NhbGVTdHJpbmcoIHZhbHVlICk7XG4gICAgfTtcbiAgICBmb3JtYXR0ZXJzLmZpeCA9IGZ1bmN0aW9uICggbnVtYmVyLCBmaXhUbyApe1xuICAgICAgICByZXR1cm4gbnVtYmVyLnRvRml4ZWQoIGZpeFRvICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0Rm9ybWF0dGVyID0gZnVuY3Rpb24gKCBpZCApe1xuICAgICAgICByZXR1cm4gZm9ybWF0dGVyc1sgaWQgXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZWdpc3RlckZvcm1hdHRlciA9IGZ1bmN0aW9uICggaWQsIGZvcm1hdHRlciApe1xuICAgICAgICBmb3JtYXR0ZXJzWyBpZCBdID0gZm9ybWF0dGVyO1xuICAgIH07XG4gICAgdmFyIHVucmVnaXN0ZXJGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoIGlkICl7XG4gICAgICAgIGRlbGV0ZSBmb3JtYXR0ZXJzWyBpZCBdO1xuICAgIH07XG4gICAgLyogRW5kIEZvcm1hdHRlcnMgKi9cbiAgICBcbiAgICAvKiBDb25mICovXG4gICAgdmFyIEVYUFJFU1NJT05fU1VGRklYID0gJzonO1xuICAgIHZhciBQUklWQVRFX1ZBUlNfUFJFRklYID0gJ18nO1xuICAgIHZhciBkZWZhdWx0Q29uZiA9IHtcbiAgICAgICAgcGF0aERlbGltaXRlcjogICAgICAgICAgJ3wnLFxuICAgICAgICBwYXRoU2VnbWVudERlbGltaXRlcjogICAnLycsXG4gICAgICAgIGV4cHJlc3Npb25EZWxpbWl0ZXI6ICAgICcgJyxcbiAgICAgICAgaW50ZXJ2YWxEZWxpbWl0ZXI6ICAgICAgJzonLFxuICAgICAgICBwcm9wZXJ0eURlbGltaXRlcjogICAgICAnLycsXG4gICAgICAgIGRlZmluZURlbGltaXRlcjogICAgICAgICc7JyxcbiAgICAgICAgaW5EZWZpbmVEZWxpbWl0ZXI6ICAgICAgJyAnLFxuICAgICAgICBhdHRyaWJ1dGVEZWxpbWl0ZXI6ICAgICAnOycsXG4gICAgICAgIGluQXR0cmlidXRlRGVsaW1pdGVyOiAgICcgJyxcbiAgICAgICAgZG9tYWluRGVsaW1pdGVyOiAgICAgICAgJyAnLFxuICAgICAgICBpMThuT3B0aW9uc0RlbGltaXRlcjogICAnOycsXG4gICAgICAgIGluSTE4bk9wdGlvbnNEZWxpbWl0ZXI6ICcgJyxcbiAgICAgICAgYXJndW1lbnRzRGVsaW1pdGVyOiAgICAgJywnLFxuICAgICAgICBtYWNyb0RlbGltaXRlcjogICAgICAgICAnQCcsXG4gICAgICAgIGRlY2xhcmVEZWxpbWl0ZXI6ICAgICAgICAgJzsnLFxuICAgICAgICBpbkRlY2xhcmVEZWxpbWl0ZXI6ICAgICAgICcgJyxcbiAgICAgICAgXG4gICAgICAgIGkxOG5Db25mUmVzb3VyY2VJZDogICAgICBcIi9DT05GL1wiLFxuICAgICAgICBcbiAgICAgICAgaHRtbFN0cnVjdHVyZUV4cHJlc3Npb25QcmVmaXg6ICBcInN0cnVjdHVyZVwiLFxuICAgICAgICBnbG9iYWxWYXJpYWJsZUV4cHJlc3Npb25QcmVmaXg6IFwiZ2xvYmFsXCIsXG4gICAgICAgIG5vY2FsbFZhcmlhYmxlRXhwcmVzc2lvblByZWZpeDogXCJub2NhbGxcIixcbiAgICAgICAgXG4gICAgICAgIHRlbXBsYXRlRXJyb3JWYXJOYW1lOiAgICBcImVycm9yXCIsXG4gICAgICAgIG9uRXJyb3JWYXJOYW1lOiAgICAgICAgICBQUklWQVRFX1ZBUlNfUFJFRklYICsgXCJvbi1lcnJvclwiLFxuICAgICAgICBvbkVycm9yU3RydWN0dXJlVmFyTmFtZTogUFJJVkFURV9WQVJTX1BSRUZJWCArIFwib24tZXJyb3Itc3RydWN0dXJlXCIsXG4gICAgICAgIGkxOG5Eb21haW5WYXJOYW1lOiAgICAgICBQUklWQVRFX1ZBUlNfUFJFRklYICsgXCJpMThuRG9tYWluXCIsXG4gICAgICAgIGkxOG5MYW5ndWFnZVZhck5hbWU6ICAgICBQUklWQVRFX1ZBUlNfUFJFRklYICsgXCJpMThuTGFuZ3VhZ2VcIixcbiAgICAgICAgZXh0ZXJuYWxNYWNyb1VybFZhck5hbWU6IFBSSVZBVEVfVkFSU19QUkVGSVggKyBcImV4dGVybmFsTWFjcm9VcmxcIixcbiAgICAgICAgc3RyaWN0TW9kZVZhck5hbWU6ICAgICAgIFBSSVZBVEVfVkFSU19QUkVGSVggKyBcInN0cmljdE1vZGVcIixcbiAgICAgICAgZGVjbGFyZWRWYXJzVmFyTmFtZTogICAgIFBSSVZBVEVfVkFSU19QUkVGSVggKyBcImRlY2xhcmVkVmFyc1wiLFxuICAgICAgICByZXBlYXRWYXJOYW1lOiAgICAgICAgICAgUFJJVkFURV9WQVJTX1BSRUZJWCArIFwicmVwZWF0XCIsXG4gICAgICAgIFxuICAgICAgICB3aW5kb3dWYXJOYW1lOiAgICAgICAgICAgXCJ3aW5kb3dcIixcbiAgICAgICAgY29udGV4dFZhck5hbWU6ICAgICAgICAgIFwiY29udGV4dFwiLFxuICAgICAgICBcbiAgICAgICAgbm90aGluZ1Zhck5hbWU6ICAgICAgICAgIFwibm90aGluZ1wiLFxuICAgICAgICBkZWZhdWx0VmFyTmFtZTogICAgICAgICAgXCJkZWZhdWx0XCIsXG4gICAgICAgIG5vdGhpbmdWYXJWYWx1ZTogICAgICAgICBcIl9fX25vdGhpbmdfX19cIixcbiAgICAgICAgZGVmYXVsdFZhclZhbHVlOiAgICAgICAgIFwiX19fZGVmYXVsdF9fX1wiLFxuICAgICAgICBcbiAgICAgICAgbG9nZ2luZ09uOiAgICBmYWxzZSxcbiAgICAgICAgbG9nZ2luZ0xldmVsOiBsb2c0amF2YXNjcmlwdC5MZXZlbC5FUlJPUixcblxuICAgICAgICBleHRlcm5hbE1hY3JvUHJlZml4VVJMOiBcIlwiLFxuICAgICAgICB2YXJpYWJsZU5hbWVSRTogICAgICAgICAvXltBLVphLXowLTlfLy1dKyQvLFxuICAgICAgICBleHByZXNzaW9uQ2FjaGVPbjogICAgICB0cnVlLFxuICAgICAgICBhdHRyaWJ1dGVDYWNoZU9uOiAgICAgICB0cnVlLFxuXG4gICAgICAgIGV4cHJlc3Npb25TdWZmaXg6ICAgICBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgc3RyaW5nRXhwcmVzc2lvbjogICAgIFwic3RyaW5nXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgZXhpc3RzRXhwcmVzc2lvbjogICAgIFwiZXhpc3RzXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgbm90RXhwcmVzc2lvbjogICAgICAgIFwibm90XCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgamF2YVNjcmlwdEV4cHJlc3Npb246IFwianNcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBlcXVhbHNFeHByZXNzaW9uOiAgICAgXCJlcVwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIGdyZWF0ZXJFeHByZXNzaW9uOiAgICBcImd0XCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgbG93ZXJFeHByZXNzaW9uOiAgICAgIFwibHRcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBhZGRFeHByZXNzaW9uOiAgICAgICAgXCIrXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgc3ViRXhwcmVzc2lvbjogICAgICAgIFwiLVwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIG11bEV4cHJlc3Npb246ICAgICAgICBcIipcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBkaXZFeHByZXNzaW9uOiAgICAgICAgXCIvXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgbW9kRXhwcmVzc2lvbjogICAgICAgIFwiJVwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIG9yRXhwcmVzc2lvbjogICAgICAgICBcIm9yXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgYW5kRXhwcmVzc2lvbjogICAgICAgIFwiYW5kXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgY29uZEV4cHJlc3Npb246ICAgICAgIFwiY29uZFwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIGZvcm1hdEV4cHJlc3Npb246ICAgICBcImZvcm1hdFwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIHRyRXhwcmVzc2lvbjogICAgICAgICBcInRyXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgdHJOdW1iZXJFeHByZXNzaW9uOiAgIFwidHJOdW1iZXJcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICB0ckN1cnJlbmN5RXhwcmVzc2lvbjogXCJ0ckN1cnJlbmN5XCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgdHJEYXRlVGltZUV4cHJlc3Npb246IFwidHJEYXRlXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgaW5FeHByZXNzaW9uOiAgICAgICAgIFwiaW5cIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBxdWVyeUV4cHJlc3Npb246ICAgICAgXCJxdWVyeVwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIHBhdGhFeHByZXNzaW9uOiAgICAgICBcIlwiLFxuICAgICAgICBcbiAgICAgICAgZmlyc3RJbmRleElkZW50aWZpZXI6IFwiX2ZpcnN0X1wiLFxuICAgICAgICBsYXN0SW5kZXhJZGVudGlmaWVyOiAgXCJfbGFzdF9cIlxuICAgIH07XG4gICAgdmFyIGNvbmYgPSBkZWZhdWx0Q29uZjtcbiAgICBcbiAgICB2YXIgZ2V0Q29uZiA9IGZ1bmN0aW9uICgpe1xuICAgICAgICByZXR1cm4gY29uZjtcbiAgICB9O1xuICAgIFxuICAgIHZhciBzZXRDb25mID0gZnVuY3Rpb24gKCBjb25mVG9TZXQgKXtcbiAgICAgICAgY29uZiA9IGNvbmZUb1NldDtcbiAgICB9O1xuICAgIC8qIEVuZCBjb25mICovXG4gICAgXG4gICAgLyogTG9nZ2VyICovXG4gICAgdmFyIGxvZ2dlcjtcbiAgICB2YXIgZ2V0RGVmYXVsdExvZ2dlciA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBcbiAgICAgICAgdmFyIGRlZmF1bHRMb2dnZXIgPSBsb2c0amF2YXNjcmlwdC5nZXREZWZhdWx0TG9nZ2VyKCk7XG4gICAgICAgIFxuICAgICAgICBkZWZhdWx0TG9nZ2VyLnNldExldmVsKCBnZXRDb25mKCkubG9nZ2luZ0xldmVsICk7XG4gICAgICAgIC8vZGVmYXVsdExvZ2dlci5yZW1vdmVBbGxBcHBlbmRlcnMoKTtcbiAgICAgICAgLy9kZWZhdWx0TG9nZ2VyLmFkZEFwcGVuZGVyKCBuZXcgbG9nNGphdmFzY3JpcHQuQnJvd3NlckNvbnNvbGVBcHBlbmRlciggdHJ1ZSApICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGVmYXVsdExvZ2dlcjtcbiAgICB9O1xuICAgIHZhciBnZXRMb2dnZXIgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBsb2dnZXIgJiYgZ2V0Q29uZigpLmxvZ2dpbmdPbiApe1xuICAgICAgICAgICAgbG9nZ2VyID0gZ2V0RGVmYXVsdExvZ2dlcigpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbG9nZ2VyO1xuICAgIH07XG4gICAgdmFyIHNldExvZ2dlciA9IGZ1bmN0aW9uICggbG9nZ2VyVG9TZXQgKXtcbiAgICAgICAgbG9nZ2VyID0gbG9nZ2VyVG9TZXQ7XG4gICAgfTtcbiAgICAvKiBFbmQgTG9nZ2VyICovXG4gICAgXG4gICAgLyogXG4gICAgICAgIEJvb2xlYW4gYXR0cmlidXRlczpcbiAgICAgICAgVGhlIHByZXNlbmNlIG9mIGEgYm9vbGVhbiBhdHRyaWJ1dGUgb24gYW4gZWxlbWVudCByZXByZXNlbnRzIHRoZSB0cnVlIHZhbHVlLCBhbmQgdGhlIGFic2VuY2Ugb2YgdGhlIGF0dHJpYnV0ZSByZXByZXNlbnRzIHRoZSBmYWxzZSB2YWx1ZS5cbiAgICAqL1xuICAgIHZhciBib29sZWFuQXR0cmlidXRlcyA9IHtcbiAgICAgICAgY2hlY2tlZDogMSxcbiAgICAgICAgY29tcGFjdDogMSxcbiAgICAgICAgZGVjbGFyZTogMSxcbiAgICAgICAgZGVmZXI6IDEsXG4gICAgICAgIGRpc2FibGVkOiAxLFxuICAgICAgICBpc21hcDogMSxcbiAgICAgICAgbXVsdGlwbGU6IDEsXG4gICAgICAgIG5vaHJlZjogMSxcbiAgICAgICAgbm9yZXNpemU6IDEsXG4gICAgICAgIG5vc2hhZGU6IDEsXG4gICAgICAgIG5vd3JhcDogMSxcbiAgICAgICAgcmVhZG9ubHk6IDEsXG4gICAgICAgIHNlbGVjdGVkOiAxXG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0Qm9vbGVhbkF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgcmV0dXJuIGJvb2xlYW5BdHRyaWJ1dGVzO1xuICAgIH07XG4gICAgdmFyIHNldEJvb2xlYW5BdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCBib29sZWFuQXR0cmlidXRlc1RvU2V0ICl7XG4gICAgICAgIGJvb2xlYW5BdHRyaWJ1dGVzID0gYm9vbGVhbkF0dHJpYnV0ZXNUb1NldDtcbiAgICB9O1xuICAgIHZhciBpc0Jvb2xlYW5BdHRyaWJ1dGUgPSBmdW5jdGlvbiAoIGF0dHJpYnV0ZSApe1xuICAgICAgICByZXR1cm4gYm9vbGVhbkF0dHJpYnV0ZXNbIGF0dHJpYnV0ZSBdID09PSAxO1xuICAgIH07XG4gICAgLyogRW5kIEJvb2xlYW4gYXR0cmlidXRlcyAqL1xuICAgIFxuICAgIC8qIFxuICAgICAgICBBbHQgYXR0cmlidXRlczpcbiAgICAgICAgQXR0cmlidXRlcyB3aGljaCBkb24ndCBzdXBwb3J0IHNldEF0dHJpYnV0ZSgpLlxuICAgICovXG4gICAgdmFyIGFsdEF0dHJpYnV0ZXMgPSB7XG4gICAgICAgIGNsYXNzTmFtZTogMSxcbiAgICAgICAgY2xhc3M6IDEsXG4gICAgICAgIGhyZWY6IDEsXG4gICAgICAgIGh0bWxGb3I6IDEsXG4gICAgICAgIGlkOiAxLFxuICAgICAgICBpbm5lckhUTUw6IDEsXG4gICAgICAgIGxhYmVsOiAxLFxuICAgICAgICBzdHlsZTogMSxcbiAgICAgICAgc3JjOiAxLFxuICAgICAgICB0ZXh0OiAxLFxuICAgICAgICB0aXRsZTogMSxcbiAgICAgICAgdmFsdWU6IDFcbiAgICB9O1xuICAgIC8vIEFsbCBib29sZWFuQXR0cmlidXRlcyBhcmUgYWxzbyBhbHRBdHRyaWJ1dGVzXG4gICAgdXRpbHMuZXh0ZW5kKCBhbHRBdHRyaWJ1dGVzLCBib29sZWFuQXR0cmlidXRlcyApO1xuICAgIFxuICAgIHZhciBnZXRBbHRBdHRyaWJ1dGVzID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIHJldHVybiBhbHRBdHRyaWJ1dGVzO1xuICAgIH07XG4gICAgdmFyIHNldEFsdEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoIGFsdEF0dHJpYnV0ZXNUb1NldCApe1xuICAgICAgICBhbHRBdHRyaWJ1dGVzID0gYWx0QXR0cmlidXRlc1RvU2V0O1xuICAgIH07XG4gICAgdmFyIGlzQWx0QXR0cmlidXRlID0gZnVuY3Rpb24gKCBhdHRyaWJ1dGUgKXtcbiAgICAgICAgcmV0dXJuIGFsdEF0dHJpYnV0ZXNbIGF0dHJpYnV0ZSBdID09PSAxO1xuICAgIH07XG4gICAgLyogRW5kIEFsdCBhdHRyaWJ1dGVzICovXG4gICAgXG4gICAgLyogRXJyb3JzICovXG4gICAgdmFyIGRlZmF1bHRFcnJvckZ1bmN0aW9uID0gZnVuY3Rpb24oIGVycm9yICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIG1zZyA9IEFycmF5LmlzQXJyYXkoIGVycm9yICk/XG4gICAgICAgICAgICBlcnJvci5qb2luKCAnXFxuJyApOlxuICAgICAgICAgICAgZXJyb3I7XG4gICAgICAgIFxuICAgICAgICB3aW5kb3cuYWxlcnQoIG1zZyApO1xuICAgICAgICBcbiAgICAgICAgdGhyb3cgbXNnO1xuICAgIH07XG4gICAgdmFyIGVycm9yRnVuY3Rpb24gPSBkZWZhdWx0RXJyb3JGdW5jdGlvbjtcbiAgICB2YXIgc2V0RXJyb3JGdW5jdGlvbiA9IGZ1bmN0aW9uKCBfZXJyb3JGdW5jdGlvbiApe1xuICAgICAgICBzZWxmLmVycm9yRnVuY3Rpb24gPSBfZXJyb3JGdW5jdGlvbjtcbiAgICB9O1xuICAgIHZhciBhc3luY0Vycm9yID0gZnVuY3Rpb24oIHVybCwgZXJyb3JNZXNzYWdlLCBmYWlsQ2FsbGJhY2sgKXtcblxuICAgICAgICB2YXIgbXNnID0gJ0Vycm9yIHRyeWluZyB0byBnZXQgJyArIHVybCArICc6ICcgKyBlcnJvck1lc3NhZ2U7XG4gICAgICAgIGlmICggZmFpbENhbGxiYWNrICl7XG4gICAgICAgICAgICBmYWlsQ2FsbGJhY2soIG1zZyApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZXJyb3JGdW5jdGlvbiggbXNnICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIC8qIEVuZCBlcnJvcnMgKi9cbiAgICBcbiAgICAvKiBSZXBlYXQgKi9cbiAgICB2YXIgcmVwZWF0ID0gZnVuY3Rpb24oIGluZGV4LCBsZW5ndGgsIG9mZnNldCApe1xuICAgICAgICByZXR1cm4gbmV3IExvb3BJdGVtKCBpbmRleCwgbGVuZ3RoLCBvZmZzZXQgKTtcbiAgICB9O1xuICAgIC8qIEVuZCByZXBlYXQqL1xuICAgIFxuICAgIC8qIEZvbGRlciBkaWN0aW9uYXJpZXMgKi9cbiAgICB2YXIgZm9sZGVyRGljdGlvbmFyaWVzID0gW107XG4gICAgdmFyIHNldEZvbGRlckRpY3Rpb25hcmllcyA9IGZ1bmN0aW9uKCBfZm9sZGVyRGljdGlvbmFyaWVzICl7XG4gICAgICAgIGZvbGRlckRpY3Rpb25hcmllcyA9IF9mb2xkZXJEaWN0aW9uYXJpZXM7XG4gICAgfTtcbiAgICB2YXIgZ2V0Rm9sZGVyRGljdGlvbmFyaWVzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGZvbGRlckRpY3Rpb25hcmllcztcbiAgICB9O1xuICAgIC8qIEVuZCBmb2xkZXIgZGljdGlvbmFyaWVzICovXG4gICAgXG4gICAgLyogU3RyaWN0IG1vZGUgICovXG4gICAgdmFyIHN0cmljdE1vZGUgPSBmYWxzZTtcbiAgICB2YXIgc2V0U3RyaWN0TW9kZSA9IGZ1bmN0aW9uKCBfc3RyaWN0TW9kZSApe1xuICAgICAgICBzdHJpY3RNb2RlID0gX3N0cmljdE1vZGU7XG4gICAgfTtcbiAgICB2YXIgaXNTdHJpY3RNb2RlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmljdE1vZGU7XG4gICAgfTtcbiAgICAvKiBFbmQgc3RyaWN0IG1vZGUgICovXG4gICAgXG4gICAgLyogRXhwcmVzc2lvbiBjb3VudGVyICovXG4gICAgdmFyIGV4cHJlc3Npb25Db3VudGVyID0gMDtcbiAgICB2YXIgbmV4dEV4cHJlc3Npb25Db3VudGVyID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICsrZXhwcmVzc2lvbkNvdW50ZXI7XG4gICAgfTtcbiAgICB2YXIgc2V0RXhwcmVzc2lvbkNvdW50ZXIgPSBmdW5jdGlvbiggX2V4cHJlc3Npb25Db3VudGVyICl7XG4gICAgICAgIGV4cHJlc3Npb25Db3VudGVyID0gX2V4cHJlc3Npb25Db3VudGVyO1xuICAgIH07XG4gICAgLyogRW5kIGV4cHJlc3Npb24gY291bnRlciAqL1xuICAgIFxuICAgIC8qIFJ1biBjb3VudGVyICovXG4gICAgdmFyIHJ1bkNvdW50ZXIgPSAwO1xuICAgIHZhciBuZXh0UnVuQ291bnRlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiArK3J1bkNvdW50ZXI7XG4gICAgfTtcbiAgICAvKiBFbmQgcnVuIGNvdW50ZXIgKi9cbiAgICBcbiAgICAvKiBBbmltYXRpb24gbWFuYWdlcnMgKi9cbiAgICB2YXIgZGVmYXVsdEFuaW1hdGlvbk1hbmFnZXIgPSBDU1NBbmltYXRpb25NYW5hZ2VyO1xuICAgIHZhciBhbmltYXRpb25NYW5hZ2VyID0gZGVmYXVsdEFuaW1hdGlvbk1hbmFnZXI7XG4gICAgdmFyIGdldEFuaW1hdGlvbk1hbmFnZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gYW5pbWF0aW9uTWFuYWdlcjtcbiAgICB9O1xuICAgIHZhciBzZXRBbmltYXRpb25NYW5hZ2VyID0gZnVuY3Rpb24oIF9hbmltYXRpb25NYW5hZ2VyICl7XG4gICAgICAgIGFuaW1hdGlvbk1hbmFnZXIgPSBfYW5pbWF0aW9uTWFuYWdlcjtcbiAgICB9O1xuICAgIC8qIEVuZCBhbmltYXRpb24gbWFuYWdlcnMqL1xuICAgIFxuICAgIHZhciBzZWxmID0ge1xuICAgICAgICBnZXRUYWdzOiBnZXRUYWdzLFxuICAgICAgICBzZXRUYWdzOiBzZXRUYWdzLFxuICAgICAgICBnZXRUYWw6IGdldFRhbCxcbiAgICAgICAgZ2V0Rm9ybWF0dGVyOiBnZXRGb3JtYXR0ZXIsXG4gICAgICAgIHJlZ2lzdGVyRm9ybWF0dGVyOiByZWdpc3RlckZvcm1hdHRlcixcbiAgICAgICAgdW5yZWdpc3RlckZvcm1hdHRlcjogdW5yZWdpc3RlckZvcm1hdHRlcixcbiAgICAgICAgZ2V0Q29uZjogZ2V0Q29uZixcbiAgICAgICAgc2V0Q29uZjogc2V0Q29uZixcbiAgICAgICAgZ2V0TG9nZ2VyOiBnZXRMb2dnZXIsXG4gICAgICAgIHNldExvZ2dlcjogc2V0TG9nZ2VyLFxuICAgICAgICB1c2VPcmlnaW5hbFRhZ3M6IHVzZU9yaWdpbmFsVGFncyxcbiAgICAgICAgZ2V0Qm9vbGVhbkF0dHJpYnV0ZXM6IGdldEJvb2xlYW5BdHRyaWJ1dGVzLFxuICAgICAgICBzZXRCb29sZWFuQXR0cmlidXRlczogc2V0Qm9vbGVhbkF0dHJpYnV0ZXMsXG4gICAgICAgIGlzQm9vbGVhbkF0dHJpYnV0ZTogaXNCb29sZWFuQXR0cmlidXRlLFxuICAgICAgICBnZXRBbHRBdHRyaWJ1dGVzOiBnZXRBbHRBdHRyaWJ1dGVzLFxuICAgICAgICBzZXRBbHRBdHRyaWJ1dGVzOiBzZXRBbHRBdHRyaWJ1dGVzLFxuICAgICAgICBpc0FsdEF0dHJpYnV0ZTogaXNBbHRBdHRyaWJ1dGUsXG4gICAgICAgIGVycm9yRnVuY3Rpb246IGVycm9yRnVuY3Rpb24sXG4gICAgICAgIHNldEVycm9yRnVuY3Rpb246IHNldEVycm9yRnVuY3Rpb24sXG4gICAgICAgIGFzeW5jRXJyb3I6IGFzeW5jRXJyb3IsXG4gICAgICAgIHJlcGVhdDogcmVwZWF0LFxuICAgICAgICBzZXRGb2xkZXJEaWN0aW9uYXJpZXM6IHNldEZvbGRlckRpY3Rpb25hcmllcyxcbiAgICAgICAgZ2V0Rm9sZGVyRGljdGlvbmFyaWVzOiBnZXRGb2xkZXJEaWN0aW9uYXJpZXMsXG4gICAgICAgIHNldFN0cmljdE1vZGU6IHNldFN0cmljdE1vZGUsXG4gICAgICAgIGlzU3RyaWN0TW9kZTogaXNTdHJpY3RNb2RlLFxuICAgICAgICBuZXh0RXhwcmVzc2lvbkNvdW50ZXI6IG5leHRFeHByZXNzaW9uQ291bnRlcixcbiAgICAgICAgc2V0RXhwcmVzc2lvbkNvdW50ZXI6IHNldEV4cHJlc3Npb25Db3VudGVyLFxuICAgICAgICBuZXh0UnVuQ291bnRlcjogbmV4dFJ1bkNvdW50ZXIsXG4gICAgICAgIGdldEFuaW1hdGlvbk1hbmFnZXI6IGdldEFuaW1hdGlvbk1hbmFnZXIsXG4gICAgICAgIHNldEFuaW1hdGlvbk1hbmFnZXI6IHNldEFuaW1hdGlvbk1hbmFnZXJcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiBzZWxmO1xufSkoKTtcbiIsIi8qXG4gICAgQWRkRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGFyaXRobWV0aGljSGVscGVyID0gcmVxdWlyZSggJy4vYXJpdGhtZXRoaWNIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgQWRkRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIHJldHVybiBhcml0aG1ldGhpY0hlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LCBcbiAgICAgICAgICAgIEFkZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICBmdW5jdGlvbiggdG90YWwsIHZhbHVlICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsICsgdmFsdWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuQWRkRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuQWRkRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuYWRkRXhwcmVzc2lvbjtcbn07XG5BZGRFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gPSAnYWRkJztcbkFkZEV4cHJlc3Npb24uZ2V0SWQgPSBBZGRFeHByZXNzaW9uLm1hdGhPcGVyYXRpb247XG5cbkFkZEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGFyaXRobWV0aGljSGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIEFkZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBBZGRFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFkZEV4cHJlc3Npb247XG4iLCIvKiBcbiAgICBhcml0aG1ldGhpY0hlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xuICAgIHZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG4gICAgdmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHRhZyApIHtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuXG4gICAgICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgICAgIHRocm93IHRhZyArIFwiIGV4cHJlc3Npb24gdm9pZC5cIjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIHNlZ21lbnRzID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvbkRlbGltaXRlciwgXG4gICAgICAgICAgICAgICAgZmFsc2UgXG4gICAgICAgICk7XG5cbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkTGlzdCggc2VnbWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzdHJpbmcsIHNjb3BlLCBleHByZXNzaW9uTGlzdCwgbWF0aE9wZXJhdGlvbiwgYXJpdGhtZXRoaWNGdW5jdGlvbiApIHtcbiAgICAgICAgXG4gICAgICAgIC8vIEV2YWx1YXRlIHNlZ21lbnRzXG4gICAgICAgIHZhciByZXN1bHQgPSAwO1xuICAgICAgICB2YXIgYyA9IDA7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkxpc3RbIGkgXTtcbiAgICAgICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoICEgQXJyYXkuaXNBcnJheSggZXZhbHVhdGVkICkgKXsgXG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBudW1lcmljIHZhbHVlXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcHJvY2Vzc0ludGVnZXIoIFxuICAgICAgICAgICAgICAgICAgICBjKyssIFxuICAgICAgICAgICAgICAgICAgICBldmFsdWF0ZWQsIFxuICAgICAgICAgICAgICAgICAgICByZXN1bHQsIFxuICAgICAgICAgICAgICAgICAgICBhcml0aG1ldGhpY0Z1bmN0aW9uLCBcbiAgICAgICAgICAgICAgICAgICAgbWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24gKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgLy8gUHJvY2VzcyBhcnJheSBvZiBudW1lcmljXG4gICAgICAgICAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgZXZhbHVhdGVkLmxlbmd0aDsgaisrICkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBwcm9jZXNzSW50ZWdlciggXG4gICAgICAgICAgICAgICAgICAgICAgICBjKyssIFxuICAgICAgICAgICAgICAgICAgICAgICAgZXZhbHVhdGVkWyBqIF0sIFxuICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGFyaXRobWV0aGljRnVuY3Rpb24sIFxuICAgICAgICAgICAgICAgICAgICAgICAgbWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIGMgPCAyICkge1xuICAgICAgICAgICAgdGhyb3cgJ0Vycm9yIGluIGV4cHJlc3Npb24gXCInICsgc3RyaW5nICsgJ1wiLiBPbmx5IG9uZSBlbGVtZW50IGluIGV2YWx1YXRpb24gb2YgXCInICsgbWF0aE9wZXJhdGlvbiBcbiAgICAgICAgICAgICAgICArICdcIiBleHByZXNzaW9uLCBwbGVhc2UgYWRkIGF0IGxlYXN0IG9uZSBtb3JlLic7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcHJvY2Vzc0ludGVnZXIgPSBmdW5jdGlvbiggYywgdmFsdWUsIHJlc3VsdCwgYXJpdGhtZXRoaWNGdW5jdGlvbiwgbWF0aE9wZXJhdGlvbiwgZXhwcmVzc2lvbiApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGV2YWx1YXRlSGVscGVyLmlzTnVtYmVyKCB2YWx1ZSApICkge1xuICAgICAgICAgICAgdGhyb3cgXCJFcnJvciB0cnlpbmcgZG9pbmcgbWF0aCBvcGVyYXRpb24sIHZhbHVlICdcIiArIHZhbHVlIFxuICAgICAgICAgICAgICAgICAgICArIFwiJyBpcyBub3QgYSB2YWxpZCBudW1iZXIgaW4gZXhwcmVzc2lvbiAnXCIgKyBtYXRoT3BlcmF0aW9uICsgJyAnICsgZXhwcmVzc2lvbiArIFwiJ1wiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGMgPT0gMD8gTnVtYmVyKCB2YWx1ZSApOiBhcml0aG1ldGhpY0Z1bmN0aW9uKCByZXN1bHQsIE51bWJlciggdmFsdWUgKSApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGQ6IGJ1aWxkLFxuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGVcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgRGl2aWRlRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGFyaXRobWV0aGljSGVscGVyID0gcmVxdWlyZSggJy4vYXJpdGhtZXRoaWNIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgRGl2aWRlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIHJldHVybiBhcml0aG1ldGhpY0hlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LCBcbiAgICAgICAgICAgIERpdmlkZUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICBmdW5jdGlvbiggdG90YWwsIHZhbHVlICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsIC8gdmFsdWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5EaXZpZGVFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5EaXZpZGVFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5kaXZFeHByZXNzaW9uO1xufTtcbkRpdmlkZUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiA9ICdkaXZpZGUnO1xuRGl2aWRlRXhwcmVzc2lvbi5nZXRJZCA9IERpdmlkZUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbjtcblxuRGl2aWRlRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYXJpdGhtZXRoaWNIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgRGl2aWRlRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uIFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IERpdmlkZUV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRGl2aWRlRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgTW9kRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGFyaXRobWV0aGljSGVscGVyID0gcmVxdWlyZSggJy4vYXJpdGhtZXRoaWNIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgTW9kRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIHJldHVybiBhcml0aG1ldGhpY0hlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LCBcbiAgICAgICAgICAgIE1vZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICBmdW5jdGlvbiggdG90YWwsIHZhbHVlICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsICUgdmFsdWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuTW9kRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuTW9kRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkubW9kRXhwcmVzc2lvbjtcbn07XG5Nb2RFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gPSAnbW9kJztcbk1vZEV4cHJlc3Npb24uZ2V0SWQgPSBNb2RFeHByZXNzaW9uLm1hdGhPcGVyYXRpb247XG5cbk1vZEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGFyaXRobWV0aGljSGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIE1vZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBNb2RFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1vZEV4cHJlc3Npb247XG4iLCIvKlxuICAgIE11bHRpcGx5RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGFyaXRobWV0aGljSGVscGVyID0gcmVxdWlyZSggJy4vYXJpdGhtZXRoaWNIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgTXVsdGlwbHlFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgcmV0dXJuIGFyaXRobWV0aGljSGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QsIFxuICAgICAgICAgICAgTXVsdGlwbHlFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24sIFxuICAgICAgICAgICAgZnVuY3Rpb24oIHRvdGFsLCB2YWx1ZSApe1xuICAgICAgICAgICAgICAgIHJldHVybiB0b3RhbCAqIHZhbHVlO1xuICAgICAgICAgICAgfSBcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuTXVsdGlwbHlFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5NdWx0aXBseUV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLm11bEV4cHJlc3Npb247XG59O1xuTXVsdGlwbHlFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gPSAnbXVsdGlwbHknO1xuTXVsdGlwbHlFeHByZXNzaW9uLmdldElkID0gTXVsdGlwbHlFeHByZXNzaW9uLm1hdGhPcGVyYXRpb247XG5cbk11bHRpcGx5RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYXJpdGhtZXRoaWNIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgTXVsdGlwbHlFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gXG4gICAgKTtcblxuICAgIHJldHVybiBuZXcgTXVsdGlwbHlFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE11bHRpcGx5RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgU3Vic3RyYWN0RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGFyaXRobWV0aGljSGVscGVyID0gcmVxdWlyZSggJy4vYXJpdGhtZXRoaWNIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgU3Vic3RyYWN0RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIHJldHVybiBhcml0aG1ldGhpY0hlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LCBcbiAgICAgICAgICAgIFN1YnN0cmFjdEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICBmdW5jdGlvbiggdG90YWwsIHZhbHVlICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsIC0gdmFsdWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuU3Vic3RyYWN0RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuU3Vic3RyYWN0RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuc3ViRXhwcmVzc2lvbjtcbn07XG5TdWJzdHJhY3RFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gPSAnc3Vic3RyYWN0JztcblN1YnN0cmFjdEV4cHJlc3Npb24uZ2V0SWQgPSBTdWJzdHJhY3RFeHByZXNzaW9uLm1hdGhPcGVyYXRpb247XG5cblN1YnN0cmFjdEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGFyaXRobWV0aGljSGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIFN1YnN0cmFjdEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBTdWJzdHJhY3RFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN1YnN0cmFjdEV4cHJlc3Npb247XG4iLCIvKlxuICAgIEFuZEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBBbmRFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZXhwcmVzc2lvbkxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25MaXN0WyBpIF07XG4gICAgICAgICAgICBpZiAoICEgZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVCb29sZWFuKCBzY29wZSwgZXhwcmVzc2lvbiApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5BbmRFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5BbmRFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5hbmRFeHByZXNzaW9uO1xufTtcbkFuZEV4cHJlc3Npb24uZ2V0SWQgPSBBbmRFeHByZXNzaW9uLmdldFByZWZpeDtcblxuQW5kRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgdmFyIGJvb2xIZWxwZXIgPSByZXF1aXJlKCAnLi9ib29sSGVscGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGJvb2xIZWxwZXIuYnVpbGQoIHN0cmluZywgJ0FuZCcgKTtcblxuICAgIHJldHVybiBuZXcgQW5kRXhwcmVzc2lvbiggc3RyaW5nLCBleHByZXNzaW9uTGlzdCApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBbmRFeHByZXNzaW9uO1xuIiwiLyogXG4gICAgYm9vbEhlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7ICAgIFxuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG4gICAgdmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIHMsIHRhZyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgICAgIHRocm93IHRhZyArICcgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICBmYWxzZSApO1xuICAgICAgICBpZiAoIHNlZ21lbnRzLmNvdW50VG9rZW5zKCkgPT09IDEgKSB7XG4gICAgICAgICAgICB0aHJvdyAnU3ludGF4IGVycm9yIGluIGV4cHJlc3Npb24gXCInICsgc3RyaW5nICsgJ1wiLiBPbmx5IG9uZSBlbGVtZW50IGluICcgKyB0YWcgKyAnIGV4cHJlc3Npb24sIHBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIG1vcmUuJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkTGlzdCggc2VnbWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGJ1aWxkOiBidWlsZFxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBDb25kRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG5cbnZhciBDb25kRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uMVRvQXBwbHksIGV4cHJlc3Npb24yVG9BcHBseSwgZXhwcmVzc2lvbjNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uMSA9IGV4cHJlc3Npb24xVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbjIgPSBleHByZXNzaW9uMlRvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24zID0gZXhwcmVzc2lvbjNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlQm9vbGVhbiggc2NvcGUsIGV4cHJlc3Npb24xICk/XG4gICAgICAgICAgICBleHByZXNzaW9uMi5ldmFsdWF0ZSggc2NvcGUgKTpcbiAgICAgICAgICAgIGV4cHJlc3Npb24zLmV2YWx1YXRlKCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbjEsIGV4cHJlc3Npb24yLCBleHByZXNzaW9uMyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Db25kRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuQ29uZEV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmNvbmRFeHByZXNzaW9uO1xufTtcbkNvbmRFeHByZXNzaW9uLmdldElkID0gQ29uZEV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5Db25kRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gcy50cmltKCk7XG5cbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIHRocm93ICdDb25kIGV4cHJlc3Npb24gdm9pZC4nO1xuICAgIH1cblxuICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG4gICAgaWYgKCBzZWdtZW50cy5jb3VudFRva2VucygpICE9PSAzICkge1xuICAgICAgICB0aHJvdyAnU3ludGF4IGVycm9yIGluIGNvbmQgZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIuIDMgZWxlbWVudCBhcmUgbmVlZGVkLic7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBDb25kRXhwcmVzc2lvbiggXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICksIFxuICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKSwgXG4gICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzZWdtZW50cy5uZXh0VG9rZW4oKSApIFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IENvbmRFeHByZXNzaW9uO1xuIiwiLypcbiAgICBOb3RFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgTm90RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gISBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZUJvb2xlYW4oIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuTm90RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuTm90RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkubm90RXhwcmVzc2lvbjtcbn07XG5Ob3RFeHByZXNzaW9uLmdldElkID0gTm90RXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbk5vdEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzdHJpbmcgKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IE5vdEV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbiApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBOb3RFeHByZXNzaW9uO1xuIiwiLypcbiAgICBPckV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBPckV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbkxpc3RUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGV4cHJlc3Npb25MaXN0VG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcblxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkxpc3RbIGkgXTtcbiAgICAgICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVCb29sZWFuKCBzY29wZSwgZXhwcmVzc2lvbiApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb25MaXN0ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbk9yRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuT3JFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5vckV4cHJlc3Npb247XG59O1xuT3JFeHByZXNzaW9uLmdldElkID0gT3JFeHByZXNzaW9uLmdldFByZWZpeDtcblxuT3JFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgYm9vbEhlbHBlciA9IHJlcXVpcmUoICcuL2Jvb2xIZWxwZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYm9vbEhlbHBlci5idWlsZCggc3RyaW5nLCAnT3InICk7XG5cbiAgICByZXR1cm4gbmV3IE9yRXhwcmVzc2lvbiggc3RyaW5nLCBleHByZXNzaW9uTGlzdCApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBPckV4cHJlc3Npb247XG4iLCIvKiBcbiAgICBjb21wYXJpc29uSGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xuICAgIHZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG4gICAgdmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBzLCB0YWcgKSB7XG4gICAgICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgICAgIHRocm93IHRhZyArICcgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICBmYWxzZSApO1xuICAgICAgICBpZiAoIHNlZ21lbnRzLmNvdW50VG9rZW5zKCkgIT09IDIgKSB7XG4gICAgICAgICAgICB0aHJvdyAnV3JvbmcgbnVtYmVyIG9mIGVsZW1lbnRzIGluIGV4cHJlc3Npb24gXCInICsgc3RyaW5nICsgJ1wiLCAnICsgdGFnICsgJyBleHByZXNzaW9ucyBvbmx5IHN1cHBvcnQgdHdvLic7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgZXhwcmVzc2lvbjEgPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKTtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24yID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZXhwcmVzc2lvbjE6IGV4cHJlc3Npb24xLFxuICAgICAgICAgICAgZXhwcmVzc2lvbjI6IGV4cHJlc3Npb24yXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUsIHZhbHVlRXhwcmVzc2lvbjEsIHZhbHVlRXhwcmVzc2lvbjIgKSB7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbnVtYmVyMTogZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVOdW1iZXIoIHNjb3BlLCB2YWx1ZUV4cHJlc3Npb24xICksXG4gICAgICAgICAgICBudW1iZXIyOiBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZU51bWJlciggc2NvcGUsIHZhbHVlRXhwcmVzc2lvbjIgKVxuICAgICAgICB9O1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGQ6IGJ1aWxkLFxuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGVcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgRXF1YWxzRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBFcXVhbHNFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGFyZ3NUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBhcmdzID0gYXJnc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBhcmcwID0gYXJnc1sgMCBdO1xuICAgICAgICB2YXIgcmVzdWx0MCA9IGFyZzAuZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBhcmdzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGFyZyA9IGFyZ3NbIGkgXTtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBhcmcuZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBpZiAoIHJlc3VsdDAgIT0gcmVzdWx0ICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgYXJncyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkVxdWFsc0V4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbkVxdWFsc0V4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmVxdWFsc0V4cHJlc3Npb247XG59O1xuRXF1YWxzRXhwcmVzc2lvbi5nZXRJZCA9IEVxdWFsc0V4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5FcXVhbHNFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHMgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICBcbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIHRocm93ICdFcXVhbHMgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgfVxuXG4gICAgdmFyIHNlZ21lbnRzID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25EZWxpbWl0ZXIsIFxuICAgICAgICAgICAgZmFsc2UgKTtcbiAgICBpZiAoIHNlZ21lbnRzLmNvdW50VG9rZW5zKCkgPT09IDEgKSB7XG4gICAgICAgIHRocm93ICdPbmx5IG9uZSBlbGVtZW50IGluIGVxdWFscyBleHByZXNzaW9uIFwiJyArIHN0cmluZyArICdcIiwgcGxlYXNlIGFkZCBhdCBsZWFzdCBvbmUgbW9yZS4nO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRXF1YWxzRXhwcmVzc2lvbiggXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGRMaXN0KCBzZWdtZW50cyApIFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEVxdWFsc0V4cHJlc3Npb247XG4iLCIvKlxuICAgIEdyZWF0ZXJFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgY29tcGFyaXNvbkhlbHBlciA9IHJlcXVpcmUoICcuL2NvbXBhcmlzb25IZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgR3JlYXRlckV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbjFUb0FwcGx5LCBleHByZXNzaW9uMlRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24xID0gZXhwcmVzc2lvbjFUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uMiA9IGV4cHJlc3Npb24yVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIG51bWJlcnMgPSBjb21wYXJpc29uSGVscGVyLmV2YWx1YXRlKCBzY29wZSwgZXhwcmVzc2lvbjEsIGV4cHJlc3Npb24yICk7XG4gICAgICAgIHJldHVybiBudW1iZXJzLm51bWJlcjEgPiBudW1iZXJzLm51bWJlcjI7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24xLCBleHByZXNzaW9uMiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5HcmVhdGVyRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuR3JlYXRlckV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmdyZWF0ZXJFeHByZXNzaW9uO1xufTtcbkdyZWF0ZXJFeHByZXNzaW9uLmdldElkID0gR3JlYXRlckV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5HcmVhdGVyRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGRhdGEgPSBjb21wYXJpc29uSGVscGVyLmJ1aWxkKCBzdHJpbmcsICdncmVhdGVyJyApO1xuXG4gICAgcmV0dXJuIG5ldyBHcmVhdGVyRXhwcmVzc2lvbiggc3RyaW5nLCBkYXRhLmV4cHJlc3Npb24xLCBkYXRhLmV4cHJlc3Npb24yICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEdyZWF0ZXJFeHByZXNzaW9uO1xuIiwiLypcbiAgICBJbkV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgSW5FeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBleHByZXNzaW9uMCA9IGV4cHJlc3Npb25MaXN0WyAwIF07XG4gICAgICAgIHZhciBldmFsdWF0ZWQwID0gZXhwcmVzc2lvbjAuZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkxpc3RbIGkgXTtcbiAgICAgICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIGV2YWx1YXRlZCApICl7IFxuICAgICAgICAgICAgICAgIGZvciAoIHZhciBqID0gMDsgaiA8IGV2YWx1YXRlZC5sZW5ndGg7IGorKyApIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBldmFsdWF0ZWQwID09IGV2YWx1YXRlZFsgaiBdICl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCBldmFsdWF0ZWQwID09IGV2YWx1YXRlZCApe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb25MaXN0ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkluRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuSW5FeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5pbkV4cHJlc3Npb247XG59O1xuSW5FeHByZXNzaW9uLmdldElkID0gSW5FeHByZXNzaW9uLmdldFByZWZpeDtcblxuSW5FeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHMgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICBcbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIHRocm93ICdJbiBleHByZXNzaW9uIHZvaWQuJztcbiAgICB9XG5cbiAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvbkRlbGltaXRlciwgXG4gICAgICAgICAgICBmYWxzZSBcbiAgICApO1xuICAgIGlmICggc2VnbWVudHMuY291bnRUb2tlbnMoKSA9PT0gMSApIHtcbiAgICAgICAgdGhyb3cgJ09ubHkgb25lIGVsZW1lbnQgaW4gaW4gZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIsIHBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIG1vcmUuJztcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IEluRXhwcmVzc2lvbiggXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGRMaXN0KCBzZWdtZW50cyApIFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEluRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgTG93ZXJFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgY29tcGFyaXNvbkhlbHBlciA9IHJlcXVpcmUoICcuL2NvbXBhcmlzb25IZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgTG93ZXJFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb24xVG9BcHBseSwgZXhwcmVzc2lvbjJUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uMSA9IGV4cHJlc3Npb24xVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbjIgPSBleHByZXNzaW9uMlRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBudW1iZXJzID0gY29tcGFyaXNvbkhlbHBlci5ldmFsdWF0ZSggc2NvcGUsIGV4cHJlc3Npb24xLCBleHByZXNzaW9uMiApO1xuICAgICAgICByZXR1cm4gbnVtYmVycy5udW1iZXIxIDwgbnVtYmVycy5udW1iZXIyO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbjEsIGV4cHJlc3Npb24yICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkxvd2VyRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuTG93ZXJFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5sb3dlckV4cHJlc3Npb247XG59O1xuTG93ZXJFeHByZXNzaW9uLmdldElkID0gTG93ZXJFeHByZXNzaW9uLmdldFByZWZpeDtcblxuTG93ZXJFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZGF0YSA9IGNvbXBhcmlzb25IZWxwZXIuYnVpbGQoIHN0cmluZywgJ2xvd2VyJyApO1xuXG4gICAgcmV0dXJuIG5ldyBMb3dlckV4cHJlc3Npb24oIHN0cmluZywgZGF0YS5leHByZXNzaW9uMSwgZGF0YS5leHByZXNzaW9uMiApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBMb3dlckV4cHJlc3Npb247XG4iLCIvKiBcbiAgICBldmFsdWF0ZUhlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlVG9Ob3ROdWxsID0gZnVuY3Rpb24oIHNjb3BlLCBleHByZXNzaW9uICkge1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlZCA9PSB1bmRlZmluZWQ/ICd1bmRlZmluZWQnOiBldmFsdWF0ZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGVCb29sZWFuID0gZnVuY3Rpb24oIHNjb3BlLCBleHByZXNzaW9uICkge1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggZXZhbHVhdGVkID09PSB1bmRlZmluZWRcbiAgICAgICAgICAgIHx8IGV2YWx1YXRlZCA9PSBudWxsXG4gICAgICAgICAgICB8fCBldmFsdWF0ZWQgPT0gJ2ZhbHNlJyBcbiAgICAgICAgICAgIHx8IGV2YWx1YXRlZCA9PSBmYWxzZSBcbiAgICAgICAgICAgIHx8IGV2YWx1YXRlZCA9PSAwICl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlTnVtYmVyID0gZnVuY3Rpb24oIHNjb3BlLCBleHByZXNzaW9uLCBlcnJvck1lc3NhZ2VUb0FwcGx5ICkge1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBpc051bWJlciggZXZhbHVhdGVkICkgKXtcbiAgICAgICAgICAgIHZhciBlcnJvck1lc3NhZ2UgPSBcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2VUb0FwcGx5PyBcbiAgICAgICAgICAgICAgICBlcnJvck1lc3NhZ2VUb0FwcGx5OiBcbiAgICAgICAgICAgICAgICAnRXhwcmVzc2lvbiBcIicgKyBleHByZXNzaW9uICsgJ1wiIGlzIG5vdCBhIHZhbGlkIG51bWJlci4nO1xuICAgICAgICAgICAgdGhyb3cgZXJyb3JNZXNzYWdlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGlzTnVtYmVyID0gZnVuY3Rpb24oIHN0cmluZyApe1xuICAgICAgICByZXR1cm4gISBpc05hTiggcGFyc2VGbG9hdCggc3RyaW5nICkgKSB8fCAhIGlzRmluaXRlKCBzdHJpbmcgKTtcbiAgICB9O1xuICAgIC8qXG4gICAgdmFyIGV2YWx1YXRlSW50ZWdlciA9IGZ1bmN0aW9uKCBzY29wZSwgZXhwcmVzc2lvbiwgZXJyb3JNZXNzYWdlVG9BcHBseSApIHtcbiAgICAgICAgdmFyIGV2YWx1YXRlZCA9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgaXNJbnRlZ2VyKCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZVRvQXBwbHk/IFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZVRvQXBwbHk6IFxuICAgICAgICAgICAgICAgICdFeHByZXNzaW9uIFwiJyArIGV4cHJlc3Npb24gKyAnXCIgaXMgbm90IGEgdmFsaWQgaW50ZWdlci4nXG4gICAgICAgICAgICB0aHJvdyBlcnJvck1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBldmFsdWF0ZWQ7XG4gICAgfTsqL1xuICAgIC8qXG4gICAgdmFyIGlzSW50ZWdlciA9IGZ1bmN0aW9uKCBzdHJpbmcgKXtcbiAgICAgICAgcmV0dXJuICEgaXNOYU4oIHBhcnNlSW50KCBzdHJpbmcgKSApIHx8ICEgaXNGaW5pdGUoIHN0cmluZyApO1xuICAgIH07Ki9cbiAgICBcbiAgICB2YXIgZXZhbHVhdGVFeHByZXNzaW9uTGlzdCA9IGZ1bmN0aW9uICggbGlzdCwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGxpc3RbIGkgXTtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaXNEZWZhdWx0ID0gZnVuY3Rpb24oIHZhbHVlICl7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gY29udGV4dC5nZXRDb25mKCkuZGVmYXVsdFZhclZhbHVlO1xuICAgIH07XG4gICAgdmFyIGlzTm90aGluZyA9IGZ1bmN0aW9uKCB2YWx1ZSApe1xuICAgICAgICByZXR1cm4gdmFsdWUgPT09IGNvbnRleHQuZ2V0Q29uZigpLm5vdGhpbmdWYXJWYWx1ZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlVG9Ob3ROdWxsOiBldmFsdWF0ZVRvTm90TnVsbCxcbiAgICAgICAgZXZhbHVhdGVCb29sZWFuOiBldmFsdWF0ZUJvb2xlYW4sXG4gICAgICAgIGV2YWx1YXRlTnVtYmVyOiBldmFsdWF0ZU51bWJlcixcbiAgICAgICAgLy9ldmFsdWF0ZUludGVnZXI6IGV2YWx1YXRlSW50ZWdlcixcbiAgICAgICAgaXNOdW1iZXI6IGlzTnVtYmVyLFxuICAgICAgICAvL2lzSW50ZWdlcjogaXNJbnRlZ2VyLFxuICAgICAgICBldmFsdWF0ZUV4cHJlc3Npb25MaXN0OiBldmFsdWF0ZUV4cHJlc3Npb25MaXN0LFxuICAgICAgICBpc0RlZmF1bHQ6IGlzRGVmYXVsdCxcbiAgICAgICAgaXNOb3RoaW5nOiBpc05vdGhpbmdcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgRXhpc3RzRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgRXhpc3RzRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQgIT09IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoIGUgKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkV4aXN0c0V4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbkV4aXN0c0V4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmV4aXN0c0V4cHJlc3Npb247XG59O1xuRXhpc3RzRXhwcmVzc2lvbi5nZXRJZCA9IEV4aXN0c0V4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5FeGlzdHNFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzdHJpbmcgKTtcbiAgICByZXR1cm4gbmV3IEV4aXN0c0V4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbiApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBFeGlzdHNFeHByZXNzaW9uO1xuIiwiLyogXG4gICAgZXhwcmVzc2lvbkJ1aWxkZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcbiAgICB2YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG4gICAgdmFyIFBhdGhFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vcGF0aC9wYXRoRXhwcmVzc2lvbi5qcycgKTtcbiAgICB2YXIgZXhwcmVzc2lvbkNhY2hlID0gcmVxdWlyZSggJy4uL2NhY2hlL2V4cHJlc3Npb25DYWNoZS5qcycgKTtcbiAgICAvKnZhciBsb2cgPSByZXF1aXJlKCAnLi4vbG9nSGVscGVyLmpzJyApOyovXG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25NYW5hZ2VycyA9IHt9O1xuICAgIHZhciB3aXRob3V0UHJlZml4RXhwcmVzc2lvbk1hbmFnZXJzID0ge307XG4gICAgdmFyIERFRkFVTFRfSUQgPSBQYXRoRXhwcmVzc2lvbi5nZXRJZCgpO1xuICAgIFxuICAgIC8qIFJlZ2lzdGVyIGV4cHJlc3Npb24gbWFuYWdlcnMgKi9cbiAgICB2YXIgcmVnaXN0ZXIgPSBmdW5jdGlvbiggZXhwcmVzc2lvbnNNYW5hZ2VyLCBpZCApIHtcbiAgICAgICAgZXhwcmVzc2lvbk1hbmFnZXJzWyBpZCB8fCBleHByZXNzaW9uc01hbmFnZXIuZ2V0UHJlZml4KCkgfHwgZXhwcmVzc2lvbnNNYW5hZ2VyLmdldElkKCkgXSA9IGV4cHJlc3Npb25zTWFuYWdlcjtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBleHByZXNzaW9uc01hbmFnZXIucmVtb3ZlUHJlZml4ICYmIGV4cHJlc3Npb25zTWFuYWdlci5nZXRQcmVmaXgoKSApe1xuICAgICAgICAgICAgd2l0aG91dFByZWZpeEV4cHJlc3Npb25NYW5hZ2Vyc1sgZXhwcmVzc2lvbnNNYW5hZ2VyLmdldFByZWZpeCgpIF0gPSBleHByZXNzaW9uc01hbmFnZXI7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciB1bnJlZ2lzdGVyID0gZnVuY3Rpb24oIGV4cHJlc3Npb25zTWFuYWdlciwgaWQgKSB7XG4gICAgICAgIGRlbGV0ZSBleHByZXNzaW9uTWFuYWdlcnNbIGlkIHx8IGV4cHJlc3Npb25zTWFuYWdlci5nZXRQcmVmaXgoKSB8fCBleHByZXNzaW9uc01hbmFnZXIuZ2V0SWQoKSBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHJlZ2lzdGVyR2VuZXJhbFB1cnBvc2UgPSBmdW5jdGlvbigpe1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vZXhpc3RzRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vZm9ybWF0RXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vc3RyaW5nRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vcGF0aC9wYXRoRXhwcmVzc2lvbi5qcycgKSApO1xuICAgIH07XG4gICAgdmFyIHJlZ2lzdGVyQ29tcGFyaXNvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9jb21wYXJpc29uL2VxdWFsc0V4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2NvbXBhcmlzb24vZ3JlYXRlckV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2NvbXBhcmlzb24vbG93ZXJFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9jb21wYXJpc29uL2luRXhwcmVzc2lvbi5qcycgKSApO1xuICAgIH07XG4gICAgdmFyIHJlZ2lzdGVyQXJpdGhtZXRpYyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9hcml0aG1ldGhpYy9hZGRFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9hcml0aG1ldGhpYy9zdWJzdHJhY3RFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9hcml0aG1ldGhpYy9tdWx0aXBseUV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2FyaXRobWV0aGljL2RpdmlkZUV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2FyaXRobWV0aGljL21vZEV4cHJlc3Npb24uanMnICkgKTtcbiAgICB9O1xuICAgIHZhciByZWdpc3RlckxvZ2ljYWwgPSBmdW5jdGlvbigpe1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vYm9vbC9hbmRFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9ib29sL2NvbmRFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9ib29sL25vdEV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2Jvb2wvb3JFeHByZXNzaW9uLmpzJyApICk7XG4gICAgfTtcbiAgICB2YXIgcmVnaXN0ZXJJMThuID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2kxOG4vdHJDdXJyZW5jeUV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2kxOG4vdHJEYXRlVGltZUV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2kxOG4vdHJOdW1iZXJFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9pMThuL3RyU3RyaW5nRXhwcmVzc2lvbi5qcycgKSApO1xuICAgIH07XG4gICAgdmFyIHJlZ2lzdGVyU2NyaXB0aW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL3NjcmlwdGluZy9qYXZhc2NyaXB0RXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vc2NyaXB0aW5nL3F1ZXJ5RXhwcmVzc2lvbi5qcycgKSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHJlZ2lzdGVyQWxsID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmVnaXN0ZXJHZW5lcmFsUHVycG9zZSgpO1xuICAgICAgICByZWdpc3RlckNvbXBhcmlzb24oKTtcbiAgICAgICAgcmVnaXN0ZXJBcml0aG1ldGljKCk7XG4gICAgICAgIHJlZ2lzdGVyTG9naWNhbCgpO1xuICAgICAgICByZWdpc3RlckkxOG4oKTtcbiAgICAgICAgcmVnaXN0ZXJTY3JpcHRpbmcoKTtcbiAgICB9KCk7XG4gICAgLyogRW5kIFJlZ2lzdGVyIGV4cHJlc3Npb24gbWFuYWdlcnMgKi9cbiAgICBcbiAgICB2YXIgYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nLCBmb3JjZSApIHtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25DYWNoZS5nZXQoXG4gICAgICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZm9yY2VCdWlsZCggc3RyaW5nICk7XG4gICAgICAgICAgICAgICAgfSwgXG4gICAgICAgICAgICAgICAgZm9yY2VcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBmb3JjZUJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICAgICAgdmFyIGVmZmVjdGl2ZVN0cmluZyA9IHJlbW92ZVBhcmVudGhlc2lzSWZBbnkoIHN0cmluZy50cmltKCkgKTtcbiAgICAgICAgdmFyIGluZGV4ID0gZWZmZWN0aXZlU3RyaW5nLmluZGV4T2YoIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25TdWZmaXggKTtcbiAgICAgICAgdmFyIGlkID0gdW5kZWZpbmVkO1xuICAgICAgICB2YXIgaXNEZWZhdWx0ID0gZmFsc2U7XG4gICAgICAgIFxuICAgICAgICAvLyBJcyB0aGUgZGVmYXVsdCBleHByZXNzaW9uIHR5cGU/IElzIHJlZ2lzdGVyZWQ/XG4gICAgICAgIGlmICggaW5kZXggIT09IC0xICl7XG4gICAgICAgICAgICBpZCA9IGVmZmVjdGl2ZVN0cmluZy5zdWJzdHJpbmcoIDAsIGluZGV4ICkgICsgJzonO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBJZiB0aGUgaWQgaXMgbm90IHJlc2lzdGVyZWQgbXVzdCBiZSBhIHBhdGhcbiAgICAgICAgICAgIGlzRGVmYXVsdCA9ICEgZXhwcmVzc2lvbk1hbmFnZXJzLmhhc093blByb3BlcnR5KCBpZCApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaXNEZWZhdWx0ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIHByZWZpeCBhbmQgc2V0IGlkIGlmIGl0IGlzIGRlZmF1bHQgZXhwcmVzc2lvbiB0eXBlXG4gICAgICAgIHZhciByZW1vdmVQcmVmaXggPSBmYWxzZTtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25NYW5hZ2VyID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIGlzRGVmYXVsdCApe1xuICAgICAgICAgICAgLyppZCA9IERFRkFVTFRfSUQ7Ki9cbiAgICAgICAgICAgIGV4cHJlc3Npb25NYW5hZ2VyID0gZ2V0V2l0aG91dFByZWZpeEV4cHJlc3Npb25NYW5hZ2VyKCBlZmZlY3RpdmVTdHJpbmcgKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJlbW92ZVByZWZpeCA9IHRydWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCB0aGUgZXhwcmVzc2lvbiBtYW5hZ2VyIGFuZCBidWlsZCB0aGUgZXhwcmVzc2lvblxuICAgICAgICBleHByZXNzaW9uTWFuYWdlciA9IGV4cHJlc3Npb25NYW5hZ2VyIHx8IGV4cHJlc3Npb25NYW5hZ2Vyc1sgaWQgXTtcbiAgICAgICAgdmFyIGZpbmFsU3RyaW5nID0gdW5kZWZpbmVkO1xuICAgICAgICBpZiAoIHJlbW92ZVByZWZpeCAmJiBleHByZXNzaW9uTWFuYWdlci5yZW1vdmVQcmVmaXggKXtcbiAgICAgICAgICAgIGZpbmFsU3RyaW5nID0gZWZmZWN0aXZlU3RyaW5nLnN1YnN0ciggaWQubGVuZ3RoICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBmaW5hbFN0cmluZyA9IGVmZmVjdGl2ZVN0cmluZztcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbk1hbmFnZXIuYnVpbGQoIGZpbmFsU3RyaW5nICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0V2l0aG91dFByZWZpeEV4cHJlc3Npb25NYW5hZ2VyID0gZnVuY3Rpb24oIHN0cmluZyApe1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIHByZWZpeCBpbiB3aXRob3V0UHJlZml4RXhwcmVzc2lvbk1hbmFnZXJzICkge1xuICAgICAgICAgICAgaWYgKCBzdHJpbmcuaW5kZXhPZiggcHJlZml4ICkgPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHdpdGhvdXRQcmVmaXhFeHByZXNzaW9uTWFuYWdlcnNbIHByZWZpeCBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbk1hbmFnZXJzWyBERUZBVUxUX0lEIF07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbGRMaXN0ID0gZnVuY3Rpb24oIHNlZ21lbnRzICkge1xuICAgICAgICB2YXIgbGlzdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgd2hpbGUgKCBzZWdtZW50cy5oYXNNb3JlVG9rZW5zKCkgKSB7XG4gICAgICAgICAgICBsaXN0LnB1c2goXG4gICAgICAgICAgICAgICAgYnVpbGQoIFxuICAgICAgICAgICAgICAgICAgICBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCkgICkgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBsaXN0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIHJlbW92ZVByZWZpeCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHByZWZpeCApIHtcbiAgICAgICAgcmV0dXJuIHN0cmluZy5zdWJzdHIoIHByZWZpeC5sZW5ndGggKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZW1vdmVQcmVmaXhBbmRCdWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHByZWZpeCApIHtcbiAgICAgICAgcmV0dXJuIGJ1aWxkKFxuICAgICAgICAgICAgICAgIHN0cmluZy5zdWJzdHIoIHByZWZpeC5sZW5ndGggKSk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVtb3ZlUGFyZW50aGVzaXNJZkFueSA9IGZ1bmN0aW9uKCB0b2tlbiApe1xuICAgICAgICB2YXIgZWZmZWN0aXZlVG9rZW4gPSB0b2tlbi50cmltKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIGVmZmVjdGl2ZVRva2VuID09ICcnICl7XG4gICAgICAgICAgICByZXR1cm4gZWZmZWN0aXZlVG9rZW47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggZWZmZWN0aXZlVG9rZW4uY2hhckF0KCAwICkgPT09ICcoJyApe1xuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZVBhcmVudGhlc2lzSWZBbnkoIFxuICAgICAgICAgICAgICAgICAgICAgICAgZWZmZWN0aXZlVG9rZW4uc3Vic3RyaW5nKCAxLCBlZmZlY3RpdmVUb2tlbi5sYXN0SW5kZXhPZiggJyknICkgKS50cmltKCkgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGVmZmVjdGl2ZVRva2VuO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGVuZHNXaXRoID0gZnVuY3Rpb24oIHN0ciwgc3VmZml4ICkge1xuICAgICAgICByZXR1cm4gc3RyLmluZGV4T2YoIHN1ZmZpeCwgc3RyLmxlbmd0aCAtIHN1ZmZpeC5sZW5ndGggKSAhPT0gLTE7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0QXJndW1lbnRzRnJvbVN0cmluZyA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBQYXJzZSBhbmQgZXZhbHVhdGUgYXJndW1lbnRzOyB0aGVuIHB1c2ggdGhlbSB0byBhbiBhcnJheVxuICAgICAgICB2YXIgdG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuYXJndW1lbnRzRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICB0cnVlICk7XG4gICAgICAgIHZhciBhcmdzID0gW107XG4gICAgICAgIHdoaWxlICggdG9rZW5zLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgICAgIHZhciBjdXJyZW50U3RyaW5nID0gdG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgICAgIGFyZ3MucHVzaCggXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkKCBjdXJyZW50U3RyaW5nICkgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGFyZ3M7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICByZWdpc3RlcjogcmVnaXN0ZXIsXG4gICAgICAgIHVucmVnaXN0ZXI6IHVucmVnaXN0ZXIsXG4gICAgICAgIHJlZ2lzdGVyQWxsOiByZWdpc3RlckFsbCxcbiAgICAgICAgYnVpbGQ6IGJ1aWxkLFxuICAgICAgICBidWlsZExpc3Q6IGJ1aWxkTGlzdCxcbiAgICAgICAgcmVtb3ZlUHJlZml4OiByZW1vdmVQcmVmaXgsXG4gICAgICAgIHJlbW92ZVByZWZpeEFuZEJ1aWxkOiByZW1vdmVQcmVmaXhBbmRCdWlsZCxcbiAgICAgICAgcmVtb3ZlUGFyZW50aGVzaXNJZkFueTogcmVtb3ZlUGFyZW50aGVzaXNJZkFueSxcbiAgICAgICAgZW5kc1dpdGg6IGVuZHNXaXRoLFxuICAgICAgICBnZXRBcmd1bWVudHNGcm9tU3RyaW5nOiBnZXRBcmd1bWVudHNGcm9tU3RyaW5nXG4gICAgfTtcbn0pKCk7XG4iLCIvKiBcbiAgICBDbGFzcyBFeHByZXNzaW9uVG9rZW5pemVyIFxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oIGV4cCwgZGVsaW1pdGVyLCBlc2NhcGUgKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgdmFyIHJlbW92ZVBhcmVudGhlc2lzSWZBbnkgPSBleHByZXNzaW9uQnVpbGRlci5yZW1vdmVQYXJlbnRoZXNpc0lmQW55O1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uID0gZXhwLnRyaW0oKTtcblxuICAgIHZhciBpdGVyYXRvcjtcbiAgICB2YXIgY3VyckluZGV4ID0gMDtcbiAgICB2YXIgZGVsaW1pdGVyQ291bnQgPSAwO1xuICAgIHZhciBkZWxpbWl0ZXJzID0gW107XG4gICAgXG4gICAgdmFyIG1ha2VJdGVyYXRvciA9IGZ1bmN0aW9uKCBhcnJheSApe1xuICAgICAgICB2YXIgbmV4dEluZGV4ID0gMDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBuZXh0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgIHJldHVybiBuZXh0SW5kZXggPCBhcnJheS5sZW5ndGggP1xuICAgICAgICAgICAgICAgICAgIGFycmF5IFsgbmV4dEluZGV4KysgXSA6XG4gICAgICAgICAgICAgICAgICAgdW5kZWZpbmVkO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGhhc05leHQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHRJbmRleCA8IGFycmF5Lmxlbmd0aDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBhbmFseXplID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIGF2b2lkUmVwZWF0ZWRTZXBhcmF0b3JzID0gZGVsaW1pdGVyID09PSAnICc7XG4gICAgICAgIFxuICAgICAgICAvLyBHbyBhaGVhZCBhbmQgZmluZCBkZWxpbWl0ZXJzLCBpZiBhbnksIGF0IGNvbnN0cnVjdGlvbiB0aW1lXG4gICAgICAgIHZhciBwYXJlbnRMZXZlbCA9IDA7XG4gICAgICAgIHZhciBpblF1b3RlID0gZmFsc2U7XG4gICAgICAgIHZhciBwcmV2aW91c0NoID0gJyc7XG4gICAgICAgIFxuICAgICAgICAvLyBTY2FuIGZvciBkZWxpbWl0ZXJzXG4gICAgICAgIHZhciBsZW5ndGggPSBleHByZXNzaW9uLmxlbmd0aDtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgY2ggPSBleHByZXNzaW9uLmNoYXJBdCggaSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIGNoID09PSBkZWxpbWl0ZXIgKSB7XG4gICAgICAgICAgICAgICAgLy8gSWYgZGVsaW1pdGVyIGlzIG5vdCBidXJpZWQgaW4gcGFyZW50aGVzZXMgb3IgYSBxdW90ZVxuICAgICAgICAgICAgICAgIGlmICggcGFyZW50TGV2ZWwgPT09IDAgJiYgISBpblF1b3RlICApIHtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIGlmICggYXZvaWRSZXBlYXRlZFNlcGFyYXRvcnMgJiYgKCBwcmV2aW91c0NoID09PSBkZWxpbWl0ZXIgfHwgcHJldmlvdXNDaCA9PT0gJ1xcbicgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICB2YXIgbmV4dENoID0gKCBpICsgMSA8IGxlbmd0aCApID8gZXhwcmVzc2lvbi5jaGFyQXQoIGkgKyAxICkgOiAnJztcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIEFuZCBpZiBkZWxpbWl0ZXIgaXMgbm90IGVzY2FwZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKCAhICggZXNjYXBlICYmIG5leHRDaCA9PT0gZGVsaW1pdGVyICkgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxpbWl0ZXJDb3VudCsrO1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVsaW1pdGVycy5wdXNoKCBpICk7XG4gICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBTb21ld2hhdCBpbmVmZmljaWVudCB3YXkgdG8gcGFyZSB0aGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGVzY2FwZWQgZGVsaW1pdGVyIGRvd24gdG8gYSBzaW5nbGVcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIGNoYXJhY3RlciB3aXRob3V0IGJyZWFraW5nIG91ciBzdHJpZGVcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24gPSBleHByZXNzaW9uLnN1YnN0cmluZyggMCwgaSArIDEgKSArIGV4cHJlc3Npb24uc3Vic3RyaW5nKCBpICsgMiApO1xuICAgICAgICAgICAgICAgICAgICAgICAgbGVuZ3RoLS07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAvLyBJbmNyZW1lbnQgcGFyZW50aGVzaXMgbGV2ZWxcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNoID09PSAnKCcgfHwgY2ggPT09ICdbJyApIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRMZXZlbCsrO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGVjcmVtZW50IHBhcmVudGhlc2lzIGxldmVsXG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBjaCA9PT0gJyknIHx8IGNoID09PSAnXScgKSB7XG4gICAgICAgICAgICAgICAgcGFyZW50TGV2ZWwtLTtcbiAgICAgICAgICAgICAgICAvLyBJZiB1bm1hdGNoZWQgcmlnaHQgcGFyZW50aGVzaXNcbiAgICAgICAgICAgICAgICBpZiAoIHBhcmVudExldmVsIDwgMCApIHtcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgJ1N5bnRheCBlcnJvci4gVW5tYXRjaGVkIHJpZ2h0IHBhcmVudGhlc2lzOiAnICsgZXhwcmVzc2lvbjtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBTdGFydCBvciBlbmQgcXVvdGVcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNoID09PSAnXFwnJyApIHtcbiAgICAgICAgICAgICAgICBpblF1b3RlID0gISBpblF1b3RlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBwcmV2aW91c0NoID0gY2g7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIHVubWF0Y2hlZCBsZWZ0IHBhcmVudGhlc2lzXG4gICAgICAgIGlmICggcGFyZW50TGV2ZWwgPiAwICkge1xuICAgICAgICAgICAgdGhyb3cgJ1N5bnRheCBlcnJvcjogdW5tYXRjaGVkIGxlZnQgcGFyZW50aGVzaXM6ICcgKyBleHByZXNzaW9uO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJZiBydW5hd2F5IHF1b3RlXG4gICAgICAgIGlmICggaW5RdW90ZSApIHtcbiAgICAgICAgICAgIHRocm93ICdTeW50YXggZXJyb3I6IHJ1bmF3YXkgcXVvdGF0aW9uOiAnICsgZXhwcmVzc2lvbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaXRlcmF0b3IgPSBtYWtlSXRlcmF0b3IoIGRlbGltaXRlcnMgKTtcbiAgICB9KCk7XG4gICAgXG4gICAgdmFyIGhhc01vcmVUb2tlbnMgPSBmdW5jdGlvbiggKSB7XG4gICAgICAgIHJldHVybiBjdXJySW5kZXggPCBleHByZXNzaW9uLmxlbmd0aDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBuZXh0VG9rZW4gPSBmdW5jdGlvbiggKSB7XG4gICAgICAgIHZhciB0b2tlbjtcbiAgICAgICAgXG4gICAgICAgIGlmICggaXRlcmF0b3IuaGFzTmV4dCgpICkge1xuICAgICAgICAgICAgdmFyIG5leHQgPSBpdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICB2YXIgZGVsaW0gPSBwYXJzZUludCggbmV4dCApO1xuICAgICAgICAgICAgdG9rZW4gPSBleHByZXNzaW9uLnN1YnN0cmluZyggY3VyckluZGV4LCBkZWxpbSApLnRyaW0oKTtcbiAgICAgICAgICAgIGN1cnJJbmRleCA9IGRlbGltICsgMTtcbiAgICAgICAgICAgIGRlbGltaXRlckNvdW50LS07XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHJldHVybiByZW1vdmVQYXJlbnRoZXNpc0lmQW55KCB0b2tlbiApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0b2tlbiA9IGV4cHJlc3Npb24uc3Vic3RyaW5nKCBjdXJySW5kZXggKS50cmltKCk7XG4gICAgICAgIGN1cnJJbmRleCA9IGV4cHJlc3Npb24ubGVuZ3RoO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlbW92ZVBhcmVudGhlc2lzSWZBbnkoIHRva2VuICk7XG4gICAgfTtcbiAgICAgICAgXG4gICAgdmFyIGNvdW50VG9rZW5zID0gZnVuY3Rpb24oICkge1xuICAgICAgICBpZiAoIGhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgICAgIHJldHVybiBkZWxpbWl0ZXJDb3VudCArIDE7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgbmV4dFRva2VuSWZBbnkgPSBmdW5jdGlvbiggZGVmYXVsdFZhbHVlICkge1xuICAgICAgICByZXR1cm4gaGFzTW9yZVRva2VucygpPyBuZXh0VG9rZW4oKTogZGVmYXVsdFZhbHVlO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgaGFzTW9yZVRva2VuczogaGFzTW9yZVRva2VucyxcbiAgICAgICAgbmV4dFRva2VuOiBuZXh0VG9rZW4sXG4gICAgICAgIGNvdW50VG9rZW5zOiBjb3VudFRva2VucyxcbiAgICAgICAgbmV4dFRva2VuSWZBbnk6IG5leHRUb2tlbklmQW55XG4gICAgfTtcbn07XG4iLCIvKiBcbiAgICBleHByZXNzaW9uc1V0aWxzIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBEZXBzRGF0YUl0ZW0gPSByZXF1aXJlKCAnLi4vcGFyc2Vycy9kZXBzRGF0YUl0ZW0uanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHZhciBidWlsZExpdGVyYWwgPSBmdW5jdGlvbiggdmFsdWUgKSB7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZUhlbHBlci5pc051bWJlciggdmFsdWUgKT8gXCJcIiArIHZhbHVlOiBcIidcIiArIHZhbHVlICsgXCInXCI7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbGRMaXN0ID0gZnVuY3Rpb24oIGl0ZW1zLCBhc1N0cmluZ3MgKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gJ1snO1xuICAgICAgICB2YXIgc2VwYXJhdG9yID0gYXNTdHJpbmdzPyBcIidcIjogXCJcIjtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGl0ZW1zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgcmVzdWx0ICs9IHNlcGFyYXRvciArIGl0ZW1zWyBpIF0gKyBzZXBhcmF0b3IgKyBcIiBcIjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmVzdWx0ICs9ICddJztcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZERlcGVuZHNPbkxpc3QgPSBmdW5jdGlvbigpe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgdmFyIGRlcHNEYXRhSXRlbSA9IGFyZ3VtZW50c1sgMCBdO1xuICAgICAgICBpZiAoICEgZGVwc0RhdGFJdGVtICl7XG4gICAgICAgICAgICBkZXBzRGF0YUl0ZW0gPSBuZXcgRGVwc0RhdGFJdGVtKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBzY29wZSA9IGFyZ3VtZW50c1sgMSBdO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGFyZ0NvdW50ZXIgPSAyOyBhcmdDb3VudGVyIDwgYXJndW1lbnRzLmxlbmd0aDsgYXJnQ291bnRlcisrICl7XG4gICAgICAgICAgICB2YXIgbGlzdCA9IGFyZ3VtZW50c1sgYXJnQ291bnRlciBdO1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggXG4gICAgICAgICAgICAgICAgZ2V0RGVwZW5kc09uRnJvbUxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGxpc3QgKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXREZXBlbmRzT25Gcm9tTGlzdCA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBhcmcgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBhcmcgKXtcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggISBBcnJheS5pc0FycmF5KCBhcmcgKSApe1xuICAgICAgICAgICAgcmV0dXJuIGdldERlcGVuZHNPbkZyb21Ob25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBhcmcgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIGxpc3QgPSBhcmc7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgaXRlbSA9IGxpc3RbIGkgXTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoIFxuICAgICAgICAgICAgICAgIEFycmF5LmlzQXJyYXkoIGl0ZW0gKT8gZ2V0RGVwZW5kc09uRnJvbUxpc3QoIHNjb3BlLCBpdGVtICk6IGdldERlcGVuZHNPbkZyb21Ob25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBpdGVtIClcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldERlcGVuZHNPbkZyb21Ob25MaXN0ID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGl0ZW0gKXtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiAhIHV0aWxzLmlzRnVuY3Rpb24oIGl0ZW0uZGVwZW5kc09uICkgfHwgKCB1dGlscy5pc0Z1bmN0aW9uKCBpdGVtLmdldFZhck5hbWUgKSAmJiBkZXBzRGF0YUl0ZW0gPT09IGl0ZW0uZ2V0VmFyTmFtZSgpICk/IFxuICAgICAgICAgICAgW106IFxuICAgICAgICAgICAgaXRlbS5kZXBlbmRzT24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGJ1aWxkTGl0ZXJhbDogYnVpbGRMaXRlcmFsLFxuICAgICAgICBidWlsZExpc3Q6IGJ1aWxkTGlzdCxcbiAgICAgICAgYnVpbGREZXBlbmRzT25MaXN0OiBidWlsZERlcGVuZHNPbkxpc3RcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgRm9ybWF0RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vdXRpbHMuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG5cbnZhciBGb3JtYXRFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGZvcm1hdHRlckV4cHJlc3Npb25Ub0FwcGx5LCBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBmb3JtYXR0ZXJFeHByZXNzaW9uID0gZm9ybWF0dGVyRXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIGFyZ3NFeHByZXNzaW9ucyA9IGFyZ3NFeHByZXNzaW9uc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgZm9ybWF0dGVyXG4gICAgICAgIHZhciBmb3JtYXR0ZXIgPSBldmFsdWF0ZUZvcm1hdHRlciggc2NvcGUsIGZvcm1hdHRlckV4cHJlc3Npb24gKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBhcmd1bWVudHNcbiAgICAgICAgdmFyIGFyZ3MgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZUV4cHJlc3Npb25MaXN0KCBhcmdzRXhwcmVzc2lvbnMsIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZm9ybWF0dGVyLmFwcGx5KCBmb3JtYXR0ZXIsIGFyZ3MgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZUZvcm1hdHRlciA9IGZ1bmN0aW9uKCBzY29wZSwgZXhwcmVzc2lvbiApIHtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgYSBidWlsdC1pbiBmb3JtYXR0ZXJcbiAgICAgICAgdmFyIGZvcm1hdHRlciA9IGNvbnRleHQuZ2V0Rm9ybWF0dGVyKCBleHByZXNzaW9uICk7XG4gICAgICAgIFxuICAgICAgICAvLyBUcnkgdG8gZ2V0IGEgZnVuY3Rpb24gd2l0aCBhIG5hbWVcbiAgICAgICAgaWYgKCAhIGlzVmFsaWRGb3JtYXR0ZXIoIGZvcm1hdHRlciApICl7XG4gICAgICAgICAgICBmb3JtYXR0ZXIgPSBzY29wZS5nZXQoIGV4cHJlc3Npb24gKTtcbiAgICAgICAgfVxuICAgIFxuICAgICAgICAvLyBUcnkgdG8gZ2V0IGEgZnVuY3Rpb24gZXZhbHVhdGluZyB0aGUgZXhwcmVzc2lvblxuICAgICAgICBpZiAoICEgaXNWYWxpZEZvcm1hdHRlciggZm9ybWF0dGVyICkgKXtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgICAgICAgICAgICAgdmFyIGZvcm1hdHRlckV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggZXhwcmVzc2lvbiApO1xuICAgICAgICAgICAgICAgIHZhciB2YWx1ZSA9IGZvcm1hdHRlckV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgcmV0dXJuIGV2YWx1YXRlRm9ybWF0dGVyKCBzY29wZSwgdmFsdWUgKTtcblxuICAgICAgICAgICAgfSBjYXRjaCggZSApe1xuICAgICAgICAgICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUmV0dXJuIHRoZSBmb3JtYXR0ZXIgb25seSBpZiBpdCBpcyB2YWxpZFxuICAgICAgICBpZiAoIGlzVmFsaWRGb3JtYXR0ZXIoIGZvcm1hdHRlciApICl7XG4gICAgICAgICAgICByZXR1cm4gZm9ybWF0dGVyO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aHJvdyAnTm8gdmFsaWQgZm9ybWF0dGVyIGZvdW5kOiAnICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGlzVmFsaWRGb3JtYXR0ZXIgPSBmdW5jdGlvbiggZm9ybWF0dGVyICl7XG4gICAgICAgIHJldHVybiBmb3JtYXR0ZXIgJiYgdXRpbHMuaXNGdW5jdGlvbiggZm9ybWF0dGVyICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBmb3JtYXR0ZXJFeHByZXNzaW9uLCBhcmdzRXhwcmVzc2lvbnMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuRm9ybWF0RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuRm9ybWF0RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuZm9ybWF0RXhwcmVzc2lvbjtcbn07XG5Gb3JtYXRFeHByZXNzaW9uLmdldElkID0gRm9ybWF0RXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkZvcm1hdEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gcy50cmltKCk7XG4gICAgaWYgKCBzdHJpbmcubGVuZ3RoID09PSAwICkge1xuICAgICAgICB0aHJvdyAnRm9ybWF0IGV4cHJlc3Npb24gdm9pZC4nO1xuICAgIH1cblxuICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG4gICAgdmFyIG51bWJlck9mVG9rZW5zID0gc2VnbWVudHMuY291bnRUb2tlbnMoKTtcbiAgICBpZiAoIG51bWJlck9mVG9rZW5zID09PSAxICkge1xuICAgICAgICB0aHJvdyAnT25seSBvbmUgZWxlbWVudCBpbiBmb3JtYXQgZXhwcmVzc2lvbjogXCInICsgc3RyaW5nICsgJ1wiLiBQbGVhc2UgYWRkIGF0IGxlYXN0IG9uZSBtb3JlLic7XG4gICAgfVxuXG4gICAgLy8gR2V0IGZvcm1hdHRlclxuICAgIHZhciBmb3JtYXR0ZXIgPSBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCk7XG5cbiAgICAvLyBHZXQgYXJndW1lbnRzXG4gICAgdmFyIGFyZ3NFeHByZXNzaW9ucyA9IFtdO1xuICAgIHdoaWxlICggc2VnbWVudHMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB2YXIgYXJnRXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzZWdtZW50cy5uZXh0VG9rZW4oKSApO1xuICAgICAgICBhcmdzRXhwcmVzc2lvbnMucHVzaCggYXJnRXhwcmVzc2lvbiApO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgRm9ybWF0RXhwcmVzc2lvbiggc3RyaW5nLCBmb3JtYXR0ZXIsIGFyZ3NFeHByZXNzaW9ucyApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBGb3JtYXRFeHByZXNzaW9uO1xuIiwiLypcbiAgICBUckN1cnJlbmN5RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIHRySGVscGVyID0gcmVxdWlyZSggJy4vdHJIZWxwZXIuanMnICk7XG5cbnZhciBUckN1cnJlbmN5RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSwgYXJnc0V4cHJlc3Npb25zVG9BcHBseSwgc3ViZm9ybWF0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBhcmdzRXhwcmVzc2lvbnMgPSBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5O1xuICAgIHZhciBzdWJmb3JtYXQgPSBzdWJmb3JtYXRUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gdHJIZWxwZXIuZXZhbHVhdGUoIFxuICAgICAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uLCBcbiAgICAgICAgICAgICAgICBhcmdzRXhwcmVzc2lvbnMsIFxuICAgICAgICAgICAgICAgICdjdXJyZW5jeScsIFxuICAgICAgICAgICAgICAgIHN1YmZvcm1hdCApO1xuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiB0ckhlbHBlci5kZXBlbmRzT24oIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24sIGFyZ3NFeHByZXNzaW9ucyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5UckN1cnJlbmN5RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuVHJDdXJyZW5jeUV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLnRyQ3VycmVuY3lFeHByZXNzaW9uO1xufTtcblRyQ3VycmVuY3lFeHByZXNzaW9uLmdldElkID0gVHJDdXJyZW5jeUV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5UckN1cnJlbmN5RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIHRyRGF0YSA9IHRySGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIFRyQ3VycmVuY3lFeHByZXNzaW9uLmdldFByZWZpeCgpLCBcbiAgICAgICAgICAgIDIsIFxuICAgICAgICAgICAgMywgXG4gICAgICAgICAgICB0cnVlICk7XG5cbiAgICByZXR1cm4gbmV3IFRyQ3VycmVuY3lFeHByZXNzaW9uKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICB0ckRhdGEuZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICB0ckRhdGEuYXJnc0V4cHJlc3Npb25zLCBcbiAgICAgICAgICAgIHRyRGF0YS5zdWJmb3JtYXQgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJDdXJyZW5jeUV4cHJlc3Npb247XG4iLCIvKlxuICAgIFRyRGF0ZVRpbWVFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgdHJIZWxwZXIgPSByZXF1aXJlKCAnLi90ckhlbHBlci5qcycgKTtcblxudmFyIFRyRGF0ZVRpbWVFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5LCBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIGFyZ3NFeHByZXNzaW9ucyA9IGFyZ3NFeHByZXNzaW9uc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSB0ckhlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb24sIFxuICAgICAgICAgICAgICAgIGFyZ3NFeHByZXNzaW9ucywgXG4gICAgICAgICAgICAgICAgJ2RhdGV0aW1lJywgXG4gICAgICAgICAgICAgICAgbnVsbCApO1xuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIHRySGVscGVyLmRlcGVuZHNPbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiwgYXJnc0V4cHJlc3Npb25zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblRyRGF0ZVRpbWVFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5UckRhdGVUaW1lRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkudHJEYXRlVGltZUV4cHJlc3Npb247XG59O1xuVHJEYXRlVGltZUV4cHJlc3Npb24uZ2V0SWQgPSBUckRhdGVUaW1lRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cblRyRGF0ZVRpbWVFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgdHJEYXRhID0gdHJIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgVHJEYXRlVGltZUV4cHJlc3Npb24uZ2V0UHJlZml4KCksIFxuICAgICAgICAgICAgMSwgXG4gICAgICAgICAgICAyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG5cbiAgICByZXR1cm4gbmV3IFRyRGF0ZVRpbWVFeHByZXNzaW9uKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICB0ckRhdGEuZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICB0ckRhdGEuYXJnc0V4cHJlc3Npb25zICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyRGF0ZVRpbWVFeHByZXNzaW9uO1xuIiwiLyogXG4gICAgdHJIZWxwZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGkxOG5IZWxwZXIgPSByZXF1aXJlKCAnLi4vLi4vaTE4bi9pMThuSGVscGVyLmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBWYXJpYWJsZUV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi4vcGF0aC92YXJpYWJsZUV4cHJlc3Npb24uanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHRhZywgbWluRWxlbWVudHMsIG1heEVsZW1lbnRzLCB1c2VTdWJmb3JtYXQgKSB7XG4gICAgICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgICAgIHRocm93IHRhZyArICcgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc3RyaW5nLnRyaW0oKSwgXG4gICAgICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvbkRlbGltaXRlciwgXG4gICAgICAgICAgICAgICAgZmFsc2UgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIG51bWJlciBvZiB0b2tlbnNcbiAgICAgICAgdmFyIGNvdW50ID0gc2VnbWVudHMuY291bnRUb2tlbnMoKTtcbiAgICAgICAgaWYgKCBjb3VudCA8IG1pbkVsZW1lbnRzICkge1xuICAgICAgICAgICAgdGhyb3cgJ1RvbyBmZXcgZWxlbWVudHMgaW4gJyArIHRhZyArICcgZXhwcmVzc2lvbiAobWluaW11bSBpcyAnICsgbWluRWxlbWVudHMgXG4gICAgICAgICAgICAgICAgICAgICsgJywgJyArIGNvdW50ICsgJyBwcmVzZW50KTogJyArIHN0cmluZy50cmltKCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCBjb3VudCA+IG1heEVsZW1lbnRzICkge1xuICAgICAgICAgICAgdGhyb3cgJ1RvbyBtYW55IGVsZW1lbnRzIGluICcgKyB0YWcgKyAnIGV4cHJlc3Npb24gKG1heGltdW0gaXMgJyArIG1heEVsZW1lbnRzIFxuICAgICAgICAgICAgICAgICAgICArICcsICcgKyBjb3VudCArICcgcHJlc2VudCk6JyArIHN0cmluZy50cmltKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEdldCB0b2tlbnNcbiAgICAgICAgdmFyIHN1YmZvcm1hdCA9IHVzZVN1YmZvcm1hdD8gXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICk6IFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggXG4gICAgICAgICAgICAgICAgc2VnbWVudHMubmV4dFRva2VuKCkudHJpbSgpICk7XG4gICAgICAgIHZhciBhcmdzU2VnbWVudCA9IHNlZ21lbnRzLmhhc01vcmVUb2tlbnMoKT8gXG4gICAgICAgICAgICAgICAgc2VnbWVudHMubmV4dFRva2VuKCkudHJpbSgpOiBcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQ7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgZXhwcmVzc2lvbjogZXhwcmVzc2lvbixcbiAgICAgICAgICAgIGFyZ3NFeHByZXNzaW9uczogYnVpbGRJMThuQXJncyggYXJnc1NlZ21lbnQgKSxcbiAgICAgICAgICAgIHN1YmZvcm1hdDogc3ViZm9ybWF0XG4gICAgICAgIH07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbGRJMThuQXJncyA9IGZ1bmN0aW9uKCBzZWdtZW50ICl7XG4gICAgICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICAgICAgXG4gICAgICAgIHZhciBhcmdzID0ge307XG4gICAgICAgIGlmICggISBzZWdtZW50ICl7XG4gICAgICAgICAgICByZXR1cm4gYXJncztcbiAgICAgICAgfVxuICAgICAgICB2YXIgdG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgICAgIHNlZ21lbnQsIFxuICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5PcHRpb25zRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICB0cnVlXG4gICAgICAgICk7XG4gICAgICAgIHdoaWxlICggdG9rZW5zLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IHRva2Vucy5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgICAgICAgICB2YXIgYXJnc1Rva2VucyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgICAgICAgICAgdG9rZW4sIFxuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5pbkkxOG5PcHRpb25zRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICAgICAgdHJ1ZSBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoIGFyZ3NUb2tlbnMuY291bnRUb2tlbnMoKSAhPT0gMiApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAnMiBlbGVtZW50cyBhcmUgbmVlZGVkIGluIGkxOG4gZXhwcmVzc2lvbi4nO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgYXJnS2V5ID0gYXJnc1Rva2Vucy5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgICAgICAgICB2YXIgYXJnRXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBcbiAgICAgICAgICAgICAgICAgICAgYXJnc1Rva2Vucy5uZXh0VG9rZW4oKS50cmltKCkgKTtcbiAgICAgICAgICAgIGFyZ3NbIGFyZ0tleSBdID0gYXJnRXhwcmVzc2lvbjtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXJncztcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZUkxOG5BcmdzID0gZnVuY3Rpb24oIHNjb3BlLCBpMThuQXJncyApe1xuICAgICAgICB2YXIgdmFsdWVzID0ge307XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgYXJnS2V5IGluIGkxOG5BcmdzICkge1xuICAgICAgICAgICAgdmFyIGFyZ0V4cHJlc3Npb24gPSBpMThuQXJnc1sgYXJnS2V5IF07XG4gICAgICAgICAgICB2YXIgYXJnVmFsdWUgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZVRvTm90TnVsbCggc2NvcGUsIGFyZ0V4cHJlc3Npb24gKTtcbiAgICAgICAgICAgIHZhbHVlc1sgYXJnS2V5IF0gPSBhcmdWYWx1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHZhbHVlcztcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSwgdmFsdWVFeHByZXNzaW9uLCBhcmdzRXhwcmVzc2lvbnMsIGZvcm1hdCwgc3ViZm9ybWF0ICkge1xuICAgICAgICB2YXIgYXJnVmFsdWVzID0gZXZhbHVhdGVJMThuQXJncyggc2NvcGUsIGFyZ3NFeHByZXNzaW9ucyApO1xuICAgICAgICB2YXIgc3ViZm9ybWF0RXZhbHVhdGVkID0gXG4gICAgICAgICAgICAgICAgc3ViZm9ybWF0PyBcbiAgICAgICAgICAgICAgICBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZVRvTm90TnVsbCggc2NvcGUsIHN1YmZvcm1hdCApOiBcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQ7XG4gICAgICAgIHZhciB2YWx1ZUV2YWx1YXRlZCA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlVG9Ob3ROdWxsKCBzY29wZSwgdmFsdWVFeHByZXNzaW9uICk7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSB0cmFuc2xhdGUoIFxuICAgICAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgICAgICB2YWx1ZUV2YWx1YXRlZCwgXG4gICAgICAgICAgICAgICAgYXJnVmFsdWVzLCBcbiAgICAgICAgICAgICAgICBmb3JtYXQsIFxuICAgICAgICAgICAgICAgIHN1YmZvcm1hdEV2YWx1YXRlZCApO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlZDtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0cmFuc2xhdGUgPSBmdW5jdGlvbiggc2NvcGUsIGlkLCBpMThuQXJncywgZm9ybWF0LCBzdWJmb3JtYXQgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBpMThuTGlzdCA9IHNjb3BlLmdldCggY29udGV4dC5nZXRDb25mKCkuaTE4bkRvbWFpblZhck5hbWUgKTtcbiAgICAgICAgdmFyIGxhbmd1YWdlID0gc2NvcGUuZ2V0KCBjb250ZXh0LmdldENvbmYoKS5pMThuTGFuZ3VhZ2VWYXJOYW1lICk7XG4gICAgICAgIHJldHVybiBpMThuSGVscGVyLnRyKCBcbiAgICAgICAgICAgIGkxOG5MaXN0LCBcbiAgICAgICAgICAgIGlkLCBcbiAgICAgICAgICAgIGkxOG5BcmdzLCBcbiAgICAgICAgICAgIGZvcm1hdCwgXG4gICAgICAgICAgICBzdWJmb3JtYXQsXG4gICAgICAgICAgICBsYW5ndWFnZSBcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiwgYXJnc0V4cHJlc3Npb25zICl7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIFxuICAgICAgICAgICAgZGVwc0RhdGFJdGVtLCBcbiAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgIG5ldyBWYXJpYWJsZUV4cHJlc3Npb24oIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5Eb21haW5WYXJOYW1lICksXG4gICAgICAgICAgICBuZXcgVmFyaWFibGVFeHByZXNzaW9uKCBjb250ZXh0LmdldENvbmYoKS5pMThuTGFuZ3VhZ2VWYXJOYW1lICksXG4gICAgICAgICAgICBleHByZXNzaW9uLCBcbiAgICAgICAgICAgIGFyZ3NFeHByZXNzaW9uc1xuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGQ6IGJ1aWxkLFxuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uXG4gICAgfTtcbn0pKCk7XG4iLCIvKlxuICAgIFRyTnVtYmVyRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIHRySGVscGVyID0gcmVxdWlyZSggJy4vdHJIZWxwZXIuanMnICk7XG5cbnZhciBUck51bWJlckV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvblRvQXBwbHksIGFyZ3NFeHByZXNzaW9uc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uVG9BcHBseTtcbiAgICB2YXIgYXJnc0V4cHJlc3Npb25zID0gYXJnc0V4cHJlc3Npb25zVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIGV2YWx1YXRlZCA9IHRySGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgICAgICBzY29wZSwgXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICAgICAgYXJnc0V4cHJlc3Npb25zLCBcbiAgICAgICAgICAgICAgICAnbnVtYmVyJywgXG4gICAgICAgICAgICAgICAgbnVsbCBcbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlZDtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiB0ckhlbHBlci5kZXBlbmRzT24oIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24sIGFyZ3NFeHByZXNzaW9ucyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Uck51bWJlckV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblRyTnVtYmVyRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkudHJOdW1iZXJFeHByZXNzaW9uO1xufTtcblRyTnVtYmVyRXhwcmVzc2lvbi5nZXRJZCA9IFRyTnVtYmVyRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cblRyTnVtYmVyRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIHRyRGF0YSA9IHRySGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIFRyTnVtYmVyRXhwcmVzc2lvbi5nZXRQcmVmaXgoKSwgXG4gICAgICAgICAgICAxLCBcbiAgICAgICAgICAgIDIsIFxuICAgICAgICAgICAgZmFsc2UgXG4gICAgKTtcblxuICAgIHJldHVybiBuZXcgVHJOdW1iZXJFeHByZXNzaW9uKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICB0ckRhdGEuZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICB0ckRhdGEuYXJnc0V4cHJlc3Npb25zIFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyTnVtYmVyRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgVHJTdHJpbmdFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgdHJIZWxwZXIgPSByZXF1aXJlKCAnLi90ckhlbHBlci5qcycgKTtcblxudmFyIFRyU3RyaW5nRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSwgYXJnc0V4cHJlc3Npb25zVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBhcmdzRXhwcmVzc2lvbnMgPSBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gdHJIZWxwZXIuZXZhbHVhdGUoIFxuICAgICAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uLCBcbiAgICAgICAgICAgICAgICBhcmdzRXhwcmVzc2lvbnMsIFxuICAgICAgICAgICAgICAgICdzdHJpbmcnLCBcbiAgICAgICAgICAgICAgICBudWxsIFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiB0ckhlbHBlci5kZXBlbmRzT24oIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24sIGFyZ3NFeHByZXNzaW9ucyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5UclN0cmluZ0V4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblRyU3RyaW5nRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkudHJFeHByZXNzaW9uO1xufTtcblRyU3RyaW5nRXhwcmVzc2lvbi5nZXRJZCA9IFRyU3RyaW5nRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cblRyU3RyaW5nRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIHRyRGF0YSA9IHRySGVscGVyLmJ1aWxkKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIFRyU3RyaW5nRXhwcmVzc2lvbi5nZXRQcmVmaXgoKSwgXG4gICAgICAgICAgICAxLCBcbiAgICAgICAgICAgIDIsIFxuICAgICAgICAgICAgZmFsc2UgXG4gICAgKTtcblxuICAgIHJldHVybiBuZXcgVHJTdHJpbmdFeHByZXNzaW9uKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICB0ckRhdGEuZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICB0ckRhdGEuYXJnc0V4cHJlc3Npb25zIFxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRyU3RyaW5nRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgQXJyYXlFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBBcnJheUV4cHJlc3Npb24gPSBmdW5jdGlvbiggYXJyYXlCYXNlVG9BcHBseSwgaW5kZXhlc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIGFycmF5QmFzZSA9IGFycmF5QmFzZVRvQXBwbHk7XG4gICAgdmFyIGluZGV4ZXMgPSBpbmRleGVzVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEV2YWx1YXRlIGFuZCBjaGVjayBhcnJheSBiYXNlcyBhbmQgaW5kZXhlc1xuICAgICAgICB2YXIgZXZhbHVhdGVkQXJyYXlCYXNlID0gYXJyYXlCYXNlLmV2YWx1YXRlKCBzY29wZSApO1xuXG4gICAgICAgIC8vIEl0ZXJhdGUgaW5kZXhlc1xuICAgICAgICB2YXIgcmVzdWx0ID0gZXZhbHVhdGVkQXJyYXlCYXNlO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBpbmRleGVzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBHZXQgYW5kIGV2YWx1YXRlIGluZGV4IGFzIGludGVnZXJcbiAgICAgICAgICAgIHZhciBpbmRleEV4cHJlc3Npb24gPSBpbmRleGVzWyBpIF07XG5cbiAgICAgICAgICAgIC8vIEV2YWx1YXRlIGFycmF5IGFjY2Vzc1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0WyBpbmRleEV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICkgXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgdGhlIGFycmF5QmFzZURlcGVuZHNPblxuICAgICAgICB2YXIgYXJyYXlCYXNlRGVwZW5kc09uID0gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGFycmF5QmFzZSApO1xuICAgICAgICBcbiAgICAgICAgLy8gVGhpcyBtdXN0IGJlIHJhcmUhXG4gICAgICAgIGlmICggYXJyYXlCYXNlRGVwZW5kc09uLmxlbmd0aCA9PT0gMCApe1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9IGVsc2UgaWYgKCBhcnJheUJhc2VEZXBlbmRzT24ubGVuZ3RoID4gMSApe1xuICAgICAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBhcnJheUJhc2UsIGluZGV4ZXMgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSm9pbiBhbGwgdG9nZXRoZXJcbiAgICAgICAgdmFyIGRlcCA9IGFycmF5QmFzZURlcGVuZHNPblsgMCBdO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBpbmRleGVzLmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICB2YXIgaW5kZXhFeHByZXNzaW9uID0gaW5kZXhlc1sgaSBdO1xuICAgICAgICAgICAgdmFyIGluZGV4RXZhbHVhdGVkID0gaW5kZXhFeHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgZGVwICs9ICdbJyArIGluZGV4RXZhbHVhdGVkICsgJ10nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gWyBkZXAgXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBhcnJheUJhc2UgKyAnWycgKyBpbmRleGVzICsgJ10nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkFycmF5RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBhcnJheUJhc2UsIGFjY2Vzc29yICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgaW5kZXhlcyA9IFtdO1xuICAgIFxuICAgIHZhciBkb25lID0gZmFsc2U7XG4gICAgd2hpbGUgKCAhIGRvbmUgKXtcblxuICAgICAgICAvLyBBcnJheSBhY2Nlc3NvciBtdXN0IGJlZ2luIGFuZCBlbmQgd2l0aCBicmFja2V0c1xuICAgICAgICB2YXIgY2xvc2UgPSBhY2Nlc3Nvci5pbmRleE9mKCAnXScgKTtcbiAgICAgICAgaWYgKCBhY2Nlc3Nvci5jaGFyQXQoIDAgKSAhPT0gJ1snIHx8IGNsb3NlID09PSAtMSApIHtcbiAgICAgICAgICAgIHRocm93ICdCYWQgYXJyYXkgYWNjZXNzb3I6ICcgICsgYWNjZXNzb3I7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBHZXQgaW5kZXggYW5kIGFkZCB0byBpbmRleGVzXG4gICAgICAgIHZhciBpbmRleCA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBcbiAgICAgICAgICAgICAgICBhY2Nlc3Nvci5zdWJzdHJpbmcoIDEsIGNsb3NlICkgXG4gICAgICAgICk7XG4gICAgICAgIGluZGV4ZXMucHVzaCggaW5kZXggKTtcblxuICAgICAgICAvLyBjb250aW51ZSBwcm9jZXNzaW5nIGFycmF5IGFjY2VzcyBmb3IgbXVsdGlkaW1lbnNpb25hbCBhcnJheXNcbiAgICAgICAgY2xvc2UrKztcbiAgICAgICAgaWYgKCBhY2Nlc3Nvci5sZW5ndGggPiBjbG9zZSApIHtcbiAgICAgICAgICAgIGFjY2Vzc29yID0gYWNjZXNzb3Iuc3Vic3RyaW5nKCBjbG9zZSApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZG9uZSA9IHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG5ldyBBcnJheUV4cHJlc3Npb24oIGFycmF5QmFzZSwgaW5kZXhlcyApO1xufTtcblxuQXJyYXlFeHByZXNzaW9uLmJ1aWxkQXJyYXlEYXRhID0gZnVuY3Rpb24oIHRva2VuICkge1xuICAgIFxuICAgIHZhciBicmFja2V0ID0gQXJyYXlFeHByZXNzaW9uLmZpbmRBcnJheUFjY2Vzc29yKCB0b2tlbiApO1xuICAgIFxuICAgIGlmICggYnJhY2tldCA8PSAwICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBhcnJheUFjY2Vzc29yOiB0b2tlbi5zdWJzdHJpbmcoIGJyYWNrZXQgKS50cmltKCksXG4gICAgICAgIHRva2VuOiB0b2tlbi5zdWJzdHJpbmcoIDAsIGJyYWNrZXQgKS50cmltKClcbiAgICB9O1xufTtcblxuQXJyYXlFeHByZXNzaW9uLmZpbmRBcnJheUFjY2Vzc29yID0gZnVuY3Rpb24oIHRva2VuICkge1xuICAgIHZhciBTQ0FOTklORyA9IDA7XG4gICAgdmFyIElOX1BBUkVOID0gMTtcbiAgICB2YXIgSU5fUVVPVEUgPSAyO1xuXG4gICAgdmFyIGxlbmd0aCA9IHRva2VuLmxlbmd0aDtcbiAgICB2YXIgc3RhdGUgPSBTQ0FOTklORztcbiAgICB2YXIgcGFyZW5EZXB0aCA9IDA7XG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIHZhciBjaCA9IHRva2VuLmNoYXJBdCggaSApO1xuICAgICAgICBzd2l0Y2goIHN0YXRlICkge1xuICAgICAgICBjYXNlIElOX1BBUkVOOlxuICAgICAgICAgICAgaWYgKCBjaCA9PT0gJyknICkge1xuICAgICAgICAgICAgICAgIHBhcmVuRGVwdGgtLTtcbiAgICAgICAgICAgICAgICBpZiAoIHBhcmVuRGVwdGggPT09IDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlID0gU0NBTk5JTkc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICcoJyApIHtcbiAgICAgICAgICAgICAgICBwYXJlbkRlcHRoKys7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICBjYXNlIElOX1FVT1RFOlxuICAgICAgICAgICAgaWYgKCBjaCA9PT0gJ1xcJycgKSB7XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBTQ0FOTklORztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgU0NBTk5JTkc6XG4gICAgICAgICAgICBpZiAoIGNoID09PSAnXFwnJyApIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IElOX1FVT1RFO1xuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICcoJyApIHtcbiAgICAgICAgICAgICAgICBwYXJlbkRlcHRoKys7XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBJTl9QQVJFTjtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNoID09PSAnWycgKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gLTE7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgRnVuY3Rpb25FeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcblxudmFyIEZ1bmN0aW9uRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBuYW1lVG9BcHBseSwgYXJnc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICB2YXIgYXJncyA9IGFyZ3NUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkQXJncyA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlRXhwcmVzc2lvbkxpc3QoIGFyZ3MsIHNjb3BlICk7XG4gICAgICAgIHZhciBlbGVtZW50ID0gc2NvcGUuZ2V0KCBuYW1lICk7XG4gICAgICAgIHJldHVybiAhIGVsZW1lbnQ/IHVuZGVmaW5lZDogZWxlbWVudC5hcHBseSggZWxlbWVudCwgZXZhbHVhdGVkQXJncyApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5GdW5jdGlvbkV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgbGVmdFBhcmVudCA9IHN0cmluZy5pbmRleE9mKCAnKCcgKTtcbiAgICBpZiAoIGxlZnRQYXJlbnQgPT09IC0xICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICBpZiAoICEgZXhwcmVzc2lvbkJ1aWxkZXIuZW5kc1dpdGgoIHN0cmluZywgJyknICkgKSB7XG4gICAgICAgIHRocm93ICdTeW50YXggZXJyb3IuIEJhZCBmdW5jdGlvbiBjYWxsOiAnICsgc3RyaW5nO1xuICAgIH1cbiAgICB2YXIgZnVuY3Rpb25OYW1lID0gc3RyaW5nLnN1YnN0cmluZyggMCwgbGVmdFBhcmVudCApLnRyaW0oKTtcbiAgICB2YXIgYXJnc1N0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoIGxlZnRQYXJlbnQgKyAxLCBzdHJpbmcubGVuZ3RoIC0gMSApO1xuICAgIHZhciBhcmdzID0gZXhwcmVzc2lvbkJ1aWxkZXIuZ2V0QXJndW1lbnRzRnJvbVN0cmluZyggYXJnc1N0cmluZyApO1xuXG4gICAgcmV0dXJuIG5ldyBGdW5jdGlvbkV4cHJlc3Npb24oIHN0cmluZywgZnVuY3Rpb25OYW1lLCBhcmdzICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEZ1bmN0aW9uRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgSW5kaXJlY3Rpb25FeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBJbmRpcmVjdGlvbkV4cHJlc3Npb24gPSBmdW5jdGlvbiggbmFtZVRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUsIHBhcmVudCApe1xuICAgICAgICByZXR1cm4gcGFyZW50WyBzY29wZS5nZXQoIG5hbWUgKSBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiAnPycgKyBuYW1lO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkluZGlyZWN0aW9uRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgaWYgKCBzdHJpbmcuY2hhckF0KCAwICkgIT09ICc/JyApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG5ldyBJbmRpcmVjdGlvbkV4cHJlc3Npb24oIHN0cmluZy5zdWJzdHJpbmcoIDEgKSApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJbmRpcmVjdGlvbkV4cHJlc3Npb247XG4iLCIvKlxuICAgIExpc3RFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBSYW5nZUV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9yYW5nZUV4cHJlc3Npb24uanMnICk7XG5cbnZhciBMaXN0RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBpdGVtc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGl0ZW1zID0gaXRlbXNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGl0ZW1zWyBpIF07XG4gICAgICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCBldmFsdWF0ZWQgKSApeyBcbiAgICAgICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KCBldmFsdWF0ZWQgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgcmVzdWx0LnB1c2goIGV2YWx1YXRlZCApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGl0ZW1zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkxpc3RFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHMgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIGlmICggcy5jaGFyQXQoIDAgKSAhPT0gJ1snIHx8IHMuY2hhckF0KCBzLmxlbmd0aCAtIDEgKSAhPT0gICddJyApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHMuc3Vic3RyaW5nKCAxLCBzLmxlbmd0aCAtIDEgKTtcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvbkRlbGltaXRlciwgXG4gICAgICAgICAgICB0cnVlICk7XG5cbiAgICB3aGlsZSAoIHNlZ21lbnRzLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgdmFyIHNlZ21lbnQgPSBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgICAgIHZhciByYW5nZSA9IFJhbmdlRXhwcmVzc2lvbi5idWlsZCggc2VnbWVudCApO1xuXG4gICAgICAgIGl0ZW1zLnB1c2goXG4gICAgICAgICAgICByYW5nZT9cbiAgICAgICAgICAgIHJhbmdlOlxuICAgICAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnQgKVxuICAgICAgICApO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgTGlzdEV4cHJlc3Npb24oIHN0cmluZywgaXRlbXMgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTGlzdEV4cHJlc3Npb247XG4iLCIvKlxuICAgIEJvb2xlYW5MaXRlcmFsIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBCb29sZWFuTGl0ZXJhbCA9IGZ1bmN0aW9uKCBsaXRlcmFsVG9BcHBseSApIHtcblxuICAgIHZhciBsaXRlcmFsID0gbGl0ZXJhbFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBsaXRlcmFsO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiXCIgKyBsaXRlcmFsO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Cb29sZWFuTGl0ZXJhbC5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgaWYgKCAndHJ1ZScgPT09IHN0cmluZyApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCb29sZWFuTGl0ZXJhbCggdHJ1ZSApO1xuICAgIH1cbiAgICBpZiAoICdmYWxzZScgPT09IHN0cmluZyApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBCb29sZWFuTGl0ZXJhbCggZmFsc2UgKTtcbiAgICB9XG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQm9vbGVhbkxpdGVyYWw7XG4iLCIvKlxuICAgIE51bWVyaWNMaXRlcmFsIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBOdW1lcmljTGl0ZXJhbCA9IGZ1bmN0aW9uKCBsaXRlcmFsVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgbGl0ZXJhbCA9IGxpdGVyYWxUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gbGl0ZXJhbDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gbGl0ZXJhbDtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5OdW1lcmljTGl0ZXJhbC5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgaWYgKCBpc0Zpbml0ZSggc3RyaW5nICkgKXtcbiAgICAgICAgdmFyIGludGVnZXJWYWx1ZSA9IHBhcnNlSW50KCBzdHJpbmcgKTtcbiAgICAgICAgaWYgKCBpbnRlZ2VyVmFsdWUgPT0gc3RyaW5nICl7XG4gICAgICAgICAgICByZXR1cm4gbmV3IE51bWVyaWNMaXRlcmFsKCBpbnRlZ2VyVmFsdWUgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBmbG9hdFZhbHVlID0gcGFyc2VGbG9hdCggc3RyaW5nICk7XG4gICAgICAgIGlmICggZmxvYXRWYWx1ZSA9PSBzdHJpbmcgKXtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTnVtZXJpY0xpdGVyYWwoIGZsb2F0VmFsdWUgKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE51bWVyaWNMaXRlcmFsO1xuIiwiLypcbiAgICBTdHJpbmdMaXRlcmFsIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBTdHJpbmdMaXRlcmFsID0gZnVuY3Rpb24oIGxpdGVyYWxUb0FwcGx5ICkge1xuXG4gICAgdmFyIGxpdGVyYWwgPSBsaXRlcmFsVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGxpdGVyYWw7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGxpdGVyYWw7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuU3RyaW5nTGl0ZXJhbC5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgaWYgKCBzdHJpbmcuY2hhckF0KCAwICkgPT09IFwiJ1wiICYmIHN0cmluZy5jaGFyQXQoIHN0cmluZy5sZW5ndGggLSAxICkgPT09ICBcIidcIiApIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTdHJpbmdMaXRlcmFsKCBcbiAgICAgICAgICAgIHN0cmluZy5zdWJzdHJpbmcoIDEsIHN0cmluZy5sZW5ndGggLSAxICkgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBTdHJpbmdMaXRlcmFsO1xuIiwiLypcbiAgICBNZXRob2RFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcblxudmFyIE1ldGhvZEV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgbmFtZVRvQXBwbHksIGFyZ3NUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBuYW1lID0gbmFtZVRvQXBwbHk7XG4gICAgdmFyIGFyZ3MgPSBhcmdzVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUsIHBhcmVudCApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkQXJncyA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlRXhwcmVzc2lvbkxpc3QoIGFyZ3MsIHNjb3BlICk7XG4gICAgICAgIHJldHVybiBwYXJlbnRbIG5hbWUgXS5hcHBseSggcGFyZW50LCBldmFsdWF0ZWRBcmdzICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5NZXRob2RFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGxlZnRQYXJlbnQgPSBzdHJpbmcuaW5kZXhPZiggJygnICk7XG4gICAgaWYgKCBsZWZ0UGFyZW50ID09PSAtMSApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgaWYgKCAhIGV4cHJlc3Npb25CdWlsZGVyLmVuZHNXaXRoKCBzdHJpbmcsICcpJyApICkge1xuICAgICAgICB0aHJvdyAnU3ludGF4IGVycm9yLiBCYWQgbWV0aG9kIGNhbGw6ICcgKyBzdHJpbmc7XG4gICAgfVxuICAgIFxuICAgIHZhciBtZXRob2ROYW1lID0gc3RyaW5nLnN1YnN0cmluZyggMCwgbGVmdFBhcmVudCApLnRyaW0oKTtcbiAgICB2YXIgYXJnc1N0cmluZyA9IHN0cmluZy5zdWJzdHJpbmcoIGxlZnRQYXJlbnQgKyAxLCBzdHJpbmcubGVuZ3RoIC0gMSApO1xuICAgIHZhciBhcmdzID0gZXhwcmVzc2lvbkJ1aWxkZXIuZ2V0QXJndW1lbnRzRnJvbVN0cmluZyggYXJnc1N0cmluZyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgTWV0aG9kRXhwcmVzc2lvbiggc3RyaW5nLCBtZXRob2ROYW1lLCBhcmdzICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1ldGhvZEV4cHJlc3Npb247XG4iLCIvKlxuICAgIFBhdGhFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIFN0cmluZ0xpdGVyYWwgPSByZXF1aXJlKCAnLi9saXRlcmFscy9zdHJpbmdMaXRlcmFsLmpzJyApO1xudmFyIFBhdGhTZWdtZW50RXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL3BhdGhTZWdtZW50RXhwcmVzc2lvbi5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBQYXRoRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIHZhciBleGNlcHRpb24gPSB1bmRlZmluZWQ7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uTGlzdFsgaSBdO1xuICAgICAgICAgICAgICAgIHZhciByZXN1bHQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgICAgIGlmICggcmVzdWx0ICE9IG51bGwgKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoKCBlICkge1xuICAgICAgICAgICAgICAgIGV4Y2VwdGlvbiA9IGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggZXhjZXB0aW9uICkge1xuICAgICAgICAgICAgdGhyb3cgZXhjZXB0aW9uO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuUGF0aEV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gZmFsc2U7XG5QYXRoRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkucGF0aEV4cHJlc3Npb247XG59O1xuUGF0aEV4cHJlc3Npb24uZ2V0SWQgPSBmdW5jdGlvbigpIHsgXG4gICAgcmV0dXJuICdwYXRoJztcbn07XG5cblBhdGhFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHMgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICBcbiAgICAvLyBCbGFuayBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBibGFuayBzdHJpbmdcbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIHJldHVybiBTdHJpbmdMaXRlcmFsLmJ1aWxkKCAnJyApO1xuICAgIH1cbiAgICBcbiAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkucGF0aERlbGltaXRlciwgXG4gICAgICAgICAgICBmYWxzZSApO1xuXG4gICAgLy8gSWYgdGhlcmUgaXMgb25seSAxIG11c3QgYmUgYSBwYXRoIHNlZ21lbnRcbiAgICBpZiAoIHNlZ21lbnRzLmNvdW50VG9rZW5zKCkgPT09IDEgKSB7XG4gICAgICAgIHJldHVybiBQYXRoU2VnbWVudEV4cHJlc3Npb24uYnVpbGQoIHN0cmluZyApO1xuICAgIH1cblxuICAgIC8vIElmIHRoZXJlIGFyZSBtb3JlIHRoYW4gMSB0aGV5IGNhbiBiZSBhbnkgZXhwcmVzc2lvbiBpbnN0YW5jZVxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IFtdO1xuICAgIHdoaWxlICggc2VnbWVudHMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB2YXIgbmV4dFRva2VuID0gc2VnbWVudHMubmV4dFRva2VuKCk7XG4gICAgICAgIGlmICggISBuZXh0VG9rZW4gKXtcbiAgICAgICAgICAgIHRocm93ICdOdWxsIHRva2VuIGluc2lkZSBwYXRoIGV4cHJlc3Npb246ICcgKyBzdHJpbmc7XG4gICAgICAgIH1cbiAgICAgICAgZXhwcmVzc2lvbkxpc3QucHVzaCggXG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggXG4gICAgICAgICAgICAgICAgbmV4dFRva2VuXG4gICAgICAgICAgICApIFxuICAgICAgICApO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFBhdGhFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBhdGhFeHByZXNzaW9uO1xuIiwiLypcbiAgICBQYXRoU2VnbWVudEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIEFycmF5RXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL2FycmF5RXhwcmVzc2lvbi5qcycgKTtcbnZhciBTdHJpbmdMaXRlcmFsID0gcmVxdWlyZSggJy4vbGl0ZXJhbHMvc3RyaW5nTGl0ZXJhbC5qcycgKTtcbnZhciBOdW1lcmljTGl0ZXJhbCA9IHJlcXVpcmUoICcuL2xpdGVyYWxzL251bWVyaWNMaXRlcmFsLmpzJyApO1xudmFyIEJvb2xlYW5MaXRlcmFsID0gcmVxdWlyZSggJy4vbGl0ZXJhbHMvYm9vbGVhbkxpdGVyYWwuanMnICk7XG52YXIgTGlzdEV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9saXN0RXhwcmVzc2lvbi5qcycgKTtcbnZhciBGdW5jdGlvbkV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9mdW5jdGlvbkV4cHJlc3Npb24uanMnICk7XG52YXIgVmFyaWFibGVFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vdmFyaWFibGVFeHByZXNzaW9uLmpzJyApO1xudmFyIEluZGlyZWN0aW9uRXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL2luZGlyZWN0aW9uRXhwcmVzc2lvbi5qcycgKTtcbnZhciBNZXRob2RFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vbWV0aG9kRXhwcmVzc2lvbi5qcycgKTtcbnZhciBQcm9wZXJ0eUV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9wcm9wZXJ0eUV4cHJlc3Npb24uanMnICk7XG5cbnZhciBQYXRoU2VnbWVudEV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgaXRlbXNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBpdGVtcyA9IGl0ZW1zVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciB0b2tlbiA9IGl0ZW1zWyAwIF07XG4gICAgICAgIHZhciByZXN1bHQgPSB0b2tlbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgZm9yICggdmFyIGkgPSAxOyBpIDwgaXRlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICAvLyBPbmx5IGxhc3QgZWxlbWVudCBjYW4gYmUgbnVsbFxuICAgICAgICAgICAgaWYgKCByZXN1bHQgPT0gbnVsbCApIHtcbiAgICAgICAgICAgICAgICB0aHJvdyAnRXJyb3IgZXZhbHVhdGluZyBcIicgKyBzdHJpbmcgKyAnXCI6IFwiJyAgKyB0b2tlbiArICdcIiBpcyBudWxsJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRva2VuID0gaXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHJlc3VsdCA9IHRva2VuLmV2YWx1YXRlKCBzY29wZSwgcmVzdWx0ICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBmaXJzdFNlZ21lbnREZXBlbmRzT24gPSBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgaXRlbXNbIDAgXSApO1xuICAgICAgICBpZiAoIGZpcnN0U2VnbWVudERlcGVuZHNPbi5sZW5ndGggPT09IDAgKXtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfSBlbHNlIGlmICggZmlyc3RTZWdtZW50RGVwZW5kc09uLmxlbmd0aCA+IDEgKXtcbiAgICAgICAgICAgIHJldHVybiBmaXJzdFNlZ21lbnREZXBlbmRzT247XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciB0ZW1wID0gZmlyc3RTZWdtZW50RGVwZW5kc09uWyAwIF07XG4gICAgICAgIHZhciByZXN1bHQgPSBbIHRlbXAgXTtcbiAgICAgICAgZm9yICggdmFyIGkgPSAxOyBpIDwgaXRlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgdG9rZW4gPSBpdGVtc1sgaSBdO1xuICAgICAgICAgICAgdmFyIHRva2VuRGVwZW5kc09uID0gdG9rZW4uZGVwZW5kc09uKCB0ZW1wICk7XG4gICAgICAgICAgICBpZiAoICEgdG9rZW5EZXBlbmRzT24gKXtcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAvL3JldHVybiB0ZW1wO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB0ZW1wICs9IHRva2VuRGVwZW5kc09uO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goIHRlbXAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuUGF0aFNlZ21lbnRFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgaXRlbXMgPSBbXTtcbiAgICBcbiAgICAvLyBCbGFuayBleHByZXNzaW9uIGV2YWx1YXRlcyB0byBibGFuayBzdHJpbmdcbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIGl0ZW1zLnB1c2goIFxuICAgICAgICAgICAgU3RyaW5nTGl0ZXJhbC5idWlsZCggJycgKSApO1xuICAgICAgICByZXR1cm4gaXRlbXM7XG4gICAgfVxuXG4gICAgLy8gQnVpbGQgZmlyc3QgdG9rZW5cbiAgICB2YXIgcGF0aCA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5wYXRoU2VnbWVudERlbGltaXRlciwgXG4gICAgICAgICAgICBmYWxzZSApO1xuICAgIHZhciB0b2tlbiA9IHBhdGgubmV4dFRva2VuKCkudHJpbSgpO1xuICAgIGl0ZW1zLnB1c2goXG4gICAgICAgICAgICBQYXRoU2VnbWVudEV4cHJlc3Npb24uYnVpbGRGaXJzdFBhdGhUb2tlbiggdG9rZW4gKSApO1xuXG4gICAgLy8gVHJhdmVyc2UgdGhlIHBhdGhcbiAgICB3aGlsZSAoIHBhdGguaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB0b2tlbiA9IHBhdGgubmV4dFRva2VuKCkudHJpbSgpO1xuICAgICAgICBpdGVtcy5wdXNoKFxuICAgICAgICAgICAgUGF0aFNlZ21lbnRFeHByZXNzaW9uLmJ1aWxkTmV4dFBhdGhUb2tlbiggdG9rZW4gKSApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbmV3IFBhdGhTZWdtZW50RXhwcmVzc2lvbiggc3RyaW5nLCBpdGVtcyApO1xufTtcblxuUGF0aFNlZ21lbnRFeHByZXNzaW9uLmJ1aWxkRmlyc3RQYXRoVG9rZW4gPSBmdW5jdGlvbiggdCApe1xuXG4gICAgLy8gU2VwYXJhdGUgaWRlbnRpZmllciBmcm9tIGFueSBhcnJheSBhY2Nlc3NvcnNcbiAgICB2YXIgYXJyYXlEYXRhID0gQXJyYXlFeHByZXNzaW9uLmJ1aWxkQXJyYXlEYXRhKCB0ICk7XG4gICAgdmFyIGFycmF5QWNjZXNzb3IgPSBhcnJheURhdGE/IGFycmF5RGF0YS5hcnJheUFjY2Vzc29yOiB1bmRlZmluZWQ7XG4gICAgdmFyIHRva2VuID0gYXJyYXlEYXRhPyBhcnJheURhdGEudG9rZW46IHQ7XG5cbiAgICAvLyBGaXJzdCB0b2tlbiBtdXN0IGNvbWUgZnJvbSBkaWN0aW9uYXJ5IG9yIGJlIGEgbGl0ZXJhbFxuXG4gICAgLy8gRmlyc3Qgc2VlIGlmIGl0J3MgYSBzdHJpbmcgbGl0ZXJhbFxuICAgIHZhciByZXN1bHQgPSBTdHJpbmdMaXRlcmFsLmJ1aWxkKCB0b2tlbiApO1xuXG4gICAgLy8gSWYgaXQncyBub3QsIHRyeSB0byBzZWUgaWYgaXQncyBhIG51bWJlclxuICAgIGlmICggcmVzdWx0ID09PSB1bmRlZmluZWQgKSB7XG4gICAgICAgIHJlc3VsdCA9IE51bWVyaWNMaXRlcmFsLmJ1aWxkKCB0b2tlbiApO1xuXG4gICAgICAgIC8vIE1heWJlIGl0J3MgYSBib29sZWFuIGxpdGVyYWxcbiAgICAgICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IEJvb2xlYW5MaXRlcmFsLmJ1aWxkKCB0b2tlbiApO1xuXG4gICAgICAgICAgICAvLyBBIGxpc3Q/XG4gICAgICAgICAgICBpZiAoIHJlc3VsdCA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gTGlzdEV4cHJlc3Npb24uYnVpbGQoIHRva2VuICk7XG5cbiAgICAgICAgICAgICAgICAvLyBBIGZ1bmN0aW9uIGNhbGw/XG4gICAgICAgICAgICAgICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICAgICAgcmVzdWx0ID0gRnVuY3Rpb25FeHByZXNzaW9uLmJ1aWxkKCB0b2tlbiApO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIE11c3QgYmUgYW4gb2JqZWN0IGluIHNjb3BlXG4gICAgICAgICAgICAgICAgICAgIGlmICggcmVzdWx0ID09PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBWYXJpYWJsZUV4cHJlc3Npb24uYnVpbGQoIHRva2VuICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIE5vdCByZWNvZ25pemVkIGV4cHJlc3Npb25cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggcmVzdWx0ID09PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhyb3cgJ1Vua25vd24gZXhwcmVzc2lvbjogJyArIHRva2VuO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgaWYgKCBhcnJheUFjY2Vzc29yICE9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgIHJlc3VsdCA9IEFycmF5RXhwcmVzc2lvbi5idWlsZCggcmVzdWx0LCBhcnJheUFjY2Vzc29yICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblBhdGhTZWdtZW50RXhwcmVzc2lvbi5idWlsZE5leHRQYXRoVG9rZW4gPSBmdW5jdGlvbiggdCApe1xuICAgIFxuICAgIC8vIFNlcGFyYXRlIGlkZW50aWZpZXIgZnJvbSBhbnkgYXJyYXkgYWNjZXNzb3JzXG4gICAgdmFyIGFycmF5RGF0YSA9IEFycmF5RXhwcmVzc2lvbi5idWlsZEFycmF5RGF0YSggdCApO1xuICAgIHZhciBhcnJheUFjY2Vzc29yID0gYXJyYXlEYXRhPyBhcnJheURhdGEuYXJyYXlBY2Nlc3NvcjogdW5kZWZpbmVkO1xuICAgIHZhciB0b2tlbiA9IGFycmF5RGF0YT8gYXJyYXlEYXRhLnRva2VuOiB0O1xuXG4gICAgLy8gVGVzdCBmb3IgaW5kaXJlY3Rpb25cbiAgICB2YXIgcmVzdWx0ID0gSW5kaXJlY3Rpb25FeHByZXNzaW9uLmJ1aWxkKCB0b2tlbiApO1xuICAgIFxuICAgIC8vIEEgbWV0aG9kIGNhbGw/XG4gICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgcmVzdWx0ID0gTWV0aG9kRXhwcmVzc2lvbi5idWlsZCggdG9rZW4gKTtcblxuICAgICAgICAvLyBBIHByb3BlcnR5XG4gICAgICAgIGlmICggcmVzdWx0ID09PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICByZXN1bHQgPSBQcm9wZXJ0eUV4cHJlc3Npb24uYnVpbGQoIHRva2VuICk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIGFycmF5QWNjZXNzb3IgIT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgcmVzdWx0ID0gQXJyYXlFeHByZXNzaW9uLmJ1aWxkKCByZXN1bHQsIGFycmF5QWNjZXNzb3IgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQYXRoU2VnbWVudEV4cHJlc3Npb247XG4iLCIvKlxuICAgIFByb3BlcnR5RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgUHJvcGVydHlFeHByZXNzaW9uID0gZnVuY3Rpb24oIG5hbWVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBuYW1lID0gbmFtZVRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlLCBwYXJlbnQgKXtcbiAgICAgICAgcmV0dXJuIHBhcmVudFsgbmFtZSBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBwYXJlbnQgKXtcbiAgICAgICAgcmV0dXJuICcuJyArIG5hbWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Qcm9wZXJ0eUV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHJldHVybiBuZXcgUHJvcGVydHlFeHByZXNzaW9uKCBzdHJpbmcgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUHJvcGVydHlFeHByZXNzaW9uO1xuIiwiLypcbiAgICBSYW5nZUV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIE51bWVyaWNMaXRlcmFsID0gcmVxdWlyZSggJy4vbGl0ZXJhbHMvbnVtZXJpY0xpdGVyYWwuanMnICk7XG5cbnZhciBSYW5nZUV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgc3RhcnRFeHByZXNzaW9uVG9BcHBseSwgZW5kRXhwcmVzc2lvblRvQXBwbHksIHN0ZXBFeHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgc3RhcnRFeHByZXNzaW9uID0gc3RhcnRFeHByZXNzaW9uVG9BcHBseTtcbiAgICB2YXIgZW5kRXhwcmVzc2lvbiA9IGVuZEV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBzdGVwRXhwcmVzc2lvbiA9IHN0ZXBFeHByZXNzaW9uVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEV2YWx1YXRlIGFsbCBleHByZXNzaW9uc1xuICAgICAgICB2YXIgc3RhcnQgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZU51bWJlciggc2NvcGUsIHN0YXJ0RXhwcmVzc2lvbiApO1xuICAgICAgICB2YXIgZW5kID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVOdW1iZXIoIHNjb3BlLCBlbmRFeHByZXNzaW9uICk7XG4gICAgICAgIHZhciBzdGVwID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVOdW1iZXIoIHNjb3BlLCBzdGVwRXhwcmVzc2lvbiApO1xuICAgICAgICBcbiAgICAgICAgLy8gVGhlIHJhbmdlIGlzIHZhbGlkLCBldmFsdWF0ZSBpdFxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBmb3J3YXJkID0gc3RlcCA+IDA7IFxuICAgICAgICBcbiAgICAgICAgdmFyIGMgPSBzdGFydDtcbiAgICAgICAgd2hpbGUoIGZvcndhcmQ/IGMgPD0gZW5kOiBjID49IGVuZCApe1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goIGMgKTtcbiAgICAgICAgICAgIGMgKz0gc3RlcDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgc3RhcnRFeHByZXNzaW9uLCBlbmRFeHByZXNzaW9uLCBzdGVwRXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5SYW5nZUV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgaWYgKCAhIHMgKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgIFxuICAgIC8vIElmIGl0IGNvbnRhaW5zIHNwYWNlcyBpdCBpcyBub3QgYSB2YWxpZCByYW5nZVxuICAgIGlmICggc3RyaW5nLmluZGV4T2YoICcgJyApICE9PSAtMSApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG4gICAgXG4gICAgdmFyIHNlZ21lbnRzID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmludGVydmFsRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG5cbiAgICB2YXIgbnVtYmVyT2ZUb2tlbnMgPSBzZWdtZW50cy5jb3VudFRva2VucygpO1xuICAgIGlmICggbnVtYmVyT2ZUb2tlbnMgIT09IDIgJiYgbnVtYmVyT2ZUb2tlbnMgIT09IDMgKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuXG4gICAgdmFyIFJBTkdFX0RFRkFVTFRfU1RBUlQgPSAwO1xuICAgIHZhciBSQU5HRV9ERUZBVUxUX1NURVAgPSAxO1xuICAgIFxuICAgIC8vIEJ1aWxkIHN0YXJ0IGV4cHJlc3Npb25cbiAgICB2YXIgc3RhcnQgPSBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgdmFyIHN0YXJ0RXhwcmVzc2lvbiA9IHN0YXJ0ID09ICcnPyBcbiAgICAgICAgICAgIE51bWVyaWNMaXRlcmFsLmJ1aWxkKCBSQU5HRV9ERUZBVUxUX1NUQVJUICk6IFxuICAgICAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0YXJ0ICk7XG5cbiAgICAvLyBCdWlsZCBlbmQgZXhwcmVzc2lvblxuICAgIHZhciBlbmRFeHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICk7XG5cbiAgICAvLyBCdWlsZCBzdGVwIGV4cHJlc3Npb25cbiAgICB2YXIgc3RlcEV4cHJlc3Npb24gPSBudW1iZXJPZlRva2VucyA9PT0gMz8gXG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKTpcbiAgICAgICAgICAgIE51bWVyaWNMaXRlcmFsLmJ1aWxkKCBSQU5HRV9ERUZBVUxUX1NURVAgKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IFJhbmdlRXhwcmVzc2lvbiggc3RyaW5nLCBzdGFydEV4cHJlc3Npb24sIGVuZEV4cHJlc3Npb24sIHN0ZXBFeHByZXNzaW9uICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFJhbmdlRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgVmFyaWFibGVFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBWYXJpYWJsZUV4cHJlc3Npb24gPSBmdW5jdGlvbiggbmFtZVRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBzY29wZS5pc1ZhbGlkVmFyaWFibGUoIG5hbWUgKSApe1xuICAgICAgICAgICAgdGhyb3cgJ05vdCBkZWNsYXJlZCB2YXJpYWJsZSBmb3VuZCB1c2luZyBzdHJpY3QgbW9kZTonICsgbmFtZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHNjb3BlLmdldCggbmFtZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgZGVwc0RhdGFJdGVtLm11c3RBZGRWYXIoIG5hbWUgKSApe1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IHNjb3BlLmdldFZhckV4cHJlc3Npb24oIG5hbWUgKTtcbiAgICAgICAgaWYgKCAhIGV4cHJlc3Npb24gKXtcbiAgICAgICAgICAgIGRlcHNEYXRhSXRlbS5hZGQxTm9uRXhwcmVzc2lvblZhciggbmFtZSApO1xuICAgICAgICAgICAgcmV0dXJuIFsgbmFtZSBdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBkZXBzRGF0YUl0ZW0uYWRkMUV4cHJlc3Npb25WYXIoIG5hbWUgKTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IGV4cHJlc3Npb24uZGVwZW5kc09uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICk7XG4gICAgICAgIGRlcHNEYXRhSXRlbS5hZGRBbGxWYXJzKCByZXN1bHQsIHNjb3BlICk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0VmFyTmFtZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIGdldFZhck5hbWU6IGdldFZhck5hbWUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5WYXJpYWJsZUV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS52YXJpYWJsZU5hbWVSRS50ZXN0KCBzdHJpbmcgKT9cbiAgICAgICAgbmV3IFZhcmlhYmxlRXhwcmVzc2lvbiggc3RyaW5nICk6XG4gICAgICAgIHVuZGVmaW5lZDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVmFyaWFibGVFeHByZXNzaW9uO1xuIiwiLypcbiAgICBKYXZhc2NyaXB0RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBTdHJpbmdFeHByZXNzaW9uID0gcmVxdWlyZSggJy4uL3N0cmluZ0V4cHJlc3Npb24uanMnICk7XG5cbnZhciBKYXZhc2NyaXB0RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nRXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkU3RyaW5nID0gc3RyaW5nRXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgcmV0dXJuIGV2YWwoIGV2YWx1YXRlZFN0cmluZyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgc3RyaW5nRXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZ0V4cHJlc3Npb247XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuSmF2YXNjcmlwdEV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblxuSmF2YXNjcmlwdEV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKCBKYXZhc2NyaXB0RXhwcmVzc2lvbi5wcmVmaXggPT09IHVuZGVmaW5lZCApe1xuICAgICAgICBKYXZhc2NyaXB0RXhwcmVzc2lvbi5wcmVmaXggPSBjb250ZXh0LmdldENvbmYoKS5qYXZhU2NyaXB0RXhwcmVzc2lvbjtcbiAgICB9XG4gICAgcmV0dXJuIEphdmFzY3JpcHRFeHByZXNzaW9uLnByZWZpeDtcbn07XG5cbkphdmFzY3JpcHRFeHByZXNzaW9uLmdldElkID0gSmF2YXNjcmlwdEV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5KYXZhc2NyaXB0RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgcmV0dXJuIG5ldyBKYXZhc2NyaXB0RXhwcmVzc2lvbihcbiAgICAgICAgICAgIFN0cmluZ0V4cHJlc3Npb24uYnVpbGQoIHN0cmluZyApICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEphdmFzY3JpcHRFeHByZXNzaW9uO1xuIiwiLypcbiAgICBRdWVyeUV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBRdWVyeUV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvblRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgIHZhciBlbGVtZW50TGlzdCA9IHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBldmFsdWF0ZWQgKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZWxlbWVudExpc3Qgd2l0aCBsZW5ndGggMVxuICAgICAgICAgICAgaWYgKCBlbGVtZW50TGlzdC5sZW5ndGggPT09IDEgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudExpc3RbIDAgXS5pbm5lclRleHQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIGVsZW1lbnRMaXN0IHdpdGggbGVuZ3RoID4gMVxuICAgICAgICAgICAgdmFyIHRleHRzID0gW107XG4gICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBlbGVtZW50TGlzdC5sZW5ndGg7ICsraSApe1xuICAgICAgICAgICAgICAgIHRleHRzLnB1c2goIGVsZW1lbnRMaXN0WyBpIF0uaW5uZXJUZXh0ICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdGV4dHM7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoIGUgKXtcbiAgICAgICAgICAgIHJldHVybiAnUXVlcnkgZXhwcmVzc2lvbiBlcnJvciBpbiBcIicgKyBzdHJpbmcgKyAnXCI6ICcgKyBlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5RdWVyeUV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblF1ZXJ5RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkucXVlcnlFeHByZXNzaW9uO1xufTtcblF1ZXJ5RXhwcmVzc2lvbi5nZXRJZCA9IFF1ZXJ5RXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cblF1ZXJ5RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0cmluZyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgUXVlcnlFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb24gKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUXVlcnlFeHByZXNzaW9uO1xuIiwiLypcbiAgICBTdHJpbmdFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgU3RyaW5nTGl0ZXJhbCA9IHJlcXVpcmUoICcuL3BhdGgvbGl0ZXJhbHMvc3RyaW5nTGl0ZXJhbC5qcycgKTtcbnZhciBQYXRoRXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL3BhdGgvcGF0aEV4cHJlc3Npb24uanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBTdHJpbmdFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gJyc7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkxpc3RbIGkgXTtcbiAgICAgICAgICAgIHJlc3VsdCArPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5TdHJpbmdFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5TdHJpbmdFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5zdHJpbmdFeHByZXNzaW9uO1xufTtcblN0cmluZ0V4cHJlc3Npb24uZ2V0SWQgPSBTdHJpbmdFeHByZXNzaW9uLmdldFByZWZpeDtcblxuU3RyaW5nRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgdmFyIFNUQVRFX1NDQU5OSU5HID0gMDtcbiAgICB2YXIgU1RBVEVfQVRfRE9MTEFSID0gMTtcbiAgICB2YXIgU1RBVEVfSU5fRVhQUkVTU0lPTiA9IDI7XG4gICAgdmFyIFNUQVRFX0lOX0JSQUNLRVRFRF9FWFBSRVNTSU9OID0gMztcblxuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IFtdO1xuICAgIHZhciBsaXRlcmFsID0gJyc7XG4gICAgdmFyIHN1YmV4cHJlc3Npb24gPSAnJztcbiAgICB2YXIgc3RhdGUgPSBTVEFURV9TQ0FOTklORztcblxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHN0cmluZy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgdmFyIGNoID0gc3RyaW5nLmNoYXJBdCggaSApO1xuXG4gICAgICAgIHN3aXRjaCAoIHN0YXRlICkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAvLyBJbiB0aGUgc3RyaW5nIHBhcnQgb2YgdGhlIGV4cHJlc3Npb25cbiAgICAgICAgY2FzZSBTVEFURV9TQ0FOTklORzpcbiAgICAgICAgICAgIC8vIEZvdW5kIGEgZG9sbGFyIHNpZ25cbiAgICAgICAgICAgIGlmICggY2ggPT09ICckJyApIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFX0FUX0RPTExBUjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEp1c3Qga2VlcCBhcHBlbmRpbmcgdG8gYnVmZmVyXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGxpdGVyYWwgKz0gY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAvLyBOZXh0IGNoYXJhY3RlciBhZnRlciBkb2xsYXIgc2lnblxuICAgICAgICBjYXNlIFNUQVRFX0FUX0RPTExBUjpcbiAgICAgICAgICAgIC8vIEFuIGVzY2FwZWQgZG9sbGFyIHNpZ25cbiAgICAgICAgICAgIGlmICggY2ggPT09ICckJyApIHtcbiAgICAgICAgICAgICAgICBsaXRlcmFsICs9ICckJztcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFX1NDQU5OSU5HO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQmVnaW5uaW5nIG9mIGEgYnJhY2tldGVkIGV4cHJlc3Npb25cbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNoID09PSAneycgKSB7XG4gICAgICAgICAgICAgICAgLy8gUmVzZXQgc3ViZXhwcmVzc2lvbiBhbmQgY2hhbmdlIHN0YXRlXG4gICAgICAgICAgICAgICAgc3ViZXhwcmVzc2lvbiA9ICcnO1xuICAgICAgICAgICAgICAgIHN0YXRlID0gU1RBVEVfSU5fQlJBQ0tFVEVEX0VYUFJFU1NJT047XG5cbiAgICAgICAgICAgICAgICAvLyBBZGQgbGl0ZXJhbCBhbmQgcmVzZXQgaXQgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKCBsaXRlcmFsICl7XG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LnB1c2goIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBTdHJpbmdMaXRlcmFsKCBsaXRlcmFsICkgXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGxpdGVyYWwgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBCZWdpbm5pbmcgb2YgYSBub24gYnJhY2tldGVkIGV4cHJlc3Npb25cbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgc3ViZXhwcmVzc2lvbiArPSBjaDtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFX0lOX0VYUFJFU1NJT047XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgLy8gQWRkIGxpdGVyYWwgYW5kIHJlc2V0IGl0IGlmIG5lZWRlZFxuICAgICAgICAgICAgICAgIGlmICggbGl0ZXJhbCApe1xuICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uTGlzdC5wdXNoKCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgU3RyaW5nTGl0ZXJhbCggbGl0ZXJhbCApXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgICAgIGxpdGVyYWwgPSAnJztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcblxuICAgICAgICAvLyBJbiBzdWJleHByZXNzaW9uXG4gICAgICAgIGNhc2UgU1RBVEVfSU5fQlJBQ0tFVEVEX0VYUFJFU1NJT046XG4gICAgICAgIGNhc2UgU1RBVEVfSU5fRVhQUkVTU0lPTjpcbiAgICAgICAgICAgIC8vIENoZWNrIGZvciBlbmRcbiAgICAgICAgICAgIGlmICggKCBzdGF0ZSA9PT0gU1RBVEVfSU5fQlJBQ0tFVEVEX0VYUFJFU1NJT04gJiYgY2ggPT09ICd9JyApXG4gICAgICAgICAgICAgICAgICAgIHx8ICggc3RhdGUgPT09IFNUQVRFX0lOX0VYUFJFU1NJT04gJiYgY2ggPT0gJyAnICkgKSB7XG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QucHVzaCggXG4gICAgICAgICAgICAgICAgICAgICAgICBQYXRoRXhwcmVzc2lvbi5idWlsZCggc3ViZXhwcmVzc2lvbiApIFxuICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIHN0YXRlID09PSBTVEFURV9JTl9FWFBSRVNTSU9OICkge1xuICAgICAgICAgICAgICAgICAgICBsaXRlcmFsICs9IGNoO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNUQVRFX1NDQU5OSU5HO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gS2VlcCBhcHBlbmRpbmcgdG8gc3ViZXhwcmVzc2lvblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdWJleHByZXNzaW9uICs9IGNoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgLy8gRW5kZWQgaW4gdW5jbG9zZWQgYnJhY2tldFxuICAgIGlmICggc3RhdGUgPT09IFNUQVRFX0lOX0JSQUNLRVRFRF9FWFBSRVNTSU9OICkge1xuICAgICAgICB0aHJvdyAnVW5jbG9zZWQgbGVmdCBjdXJseSBicmFjZTogJyArIHN0cmluZztcbiAgICAgICAgXG4gICAgLy8gRW5kZWQgYXQgZXhwcmVzc2lvblxuICAgIH0gZWxzZSBpZiAoIHN0YXRlID09IFNUQVRFX0lOX0VYUFJFU1NJT04gKSB7XG4gICAgICAgIGV4cHJlc3Npb25MaXN0LnB1c2goIFxuICAgICAgICAgICAgICAgIFBhdGhFeHByZXNzaW9uLmJ1aWxkKCBzdWJleHByZXNzaW9uICkgXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgaWYgKCBsaXRlcmFsICl7XG4gICAgICAgIGV4cHJlc3Npb25MaXN0LnB1c2goIFxuICAgICAgICAgICAgICAgIG5ldyBTdHJpbmdMaXRlcmFsKCBsaXRlcmFsICkgXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBTdHJpbmdFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN0cmluZ0V4cHJlc3Npb247XG4iLCIvKiBcbiAgICBJMThuIGNsYXNzIFxuICAgIEV4dGVybmFsIGRlcGVuZGVuY2llczogSW50bCAoc3VwcG9ydGVkIGJ5IHJlY2VudCBicm93c2VycykgYW5kIE1lc3NhZ2VGb3JtYXRcbiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCBsYW5ndWFnZUlkLCByZXMgKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIE1lc3NhZ2VGb3JtYXQgPSByZXF1aXJlKCAnbWVzc2FnZWZvcm1hdCcgKTtcbiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuICAgIHZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbiAgICBcbiAgICB2YXIgcmVzb3VyY2VzID0gcmVzO1xuICAgIHZhciBtZiA9IG5ldyBNZXNzYWdlRm9ybWF0KCBsYW5ndWFnZUlkICk7XG4gICAgdmFyIGNhY2hlID0ge307XG4gICAgdmFyIG51bWJlckZvcm1hdENhY2hlID0ge307XG4gICAgdmFyIGRhdGVUaW1lRm9ybWF0Q2FjaGUgPSB7fTtcbiAgICAvKnZhciBDT05GX1JFU09VUkNFX0lEID0gJy9DT05GLyc7Ki9cbiAgICB2YXIgQ09ORl9SRVNPVVJDRV9JRCA9IGNvbnRleHQuZ2V0Q29uZigpLmkxOG5Db25mUmVzb3VyY2VJZDtcbiAgICBcbiAgICB2YXIgZ2V0TGFuZ3VhZ2UgPSBmdW5jdGlvbigpe1xuICAgICAgICAvL3JldHVybiByZXNvdXJjZXNbIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5Db25mUmVzb3VyY2VJZCBdLmxhbmd1YWdlO1xuICAgICAgICByZXR1cm4gcmVzb3VyY2VzWyBDT05GX1JFU09VUkNFX0lEIF0ubGFuZ3VhZ2U7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0TG9jYWxlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy9yZXR1cm4gcmVzb3VyY2VzWyBjb250ZXh0LmdldENvbmYoKS5pMThuQ29uZlJlc291cmNlSWQgXS5sb2NhbGU7XG4gICAgICAgIHJldHVybiByZXNvdXJjZXNbIENPTkZfUkVTT1VSQ0VfSUQgXS5sb2NhbGU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXhpc3RzID0gZnVuY3Rpb24oIGlkICkge1xuICAgICAgICByZXR1cm4gcmVzb3VyY2VzWyBpZCBdICE9PSB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHIgPSBmdW5jdGlvbiggaWQsIHBhcmFtcywgZm9ybWF0LCBzdWJmb3JtYXQgKSB7XG4gICAgICAgIFxuICAgICAgICBzd2l0Y2ggKCBmb3JtYXQgKSB7XG4gICAgICAgIGNhc2UgJ3N0cmluZyc6XG4gICAgICAgICAgICByZXR1cm4gdHJTdHJpbmcoIGlkLCBwYXJhbXMgKTtcbiAgICAgICAgY2FzZSAnbnVtYmVyJzpcbiAgICAgICAgICAgIHJldHVybiB0ck51bWJlciggaWQsIHBhcmFtcyApO1xuICAgICAgICBjYXNlICdjdXJyZW5jeSc6XG4gICAgICAgICAgICByZXR1cm4gdHJDdXJyZW5jeSggaWQsIHBhcmFtcywgc3ViZm9ybWF0ICk7XG4gICAgICAgIGNhc2UgJ2RhdGV0aW1lJzpcbiAgICAgICAgICAgIHJldHVybiB0ckRhdGVUaW1lKCBpZCwgcGFyYW1zICk7XG4gICAgICAgIH0gXG4gICAgICAgIFxuICAgICAgICB0aHJvdyAnSTE4biBmb3JtYXQgdHlwZSBub3Qgc3VwcG9ydGVkOiAnICsgZm9ybWF0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRyU3RyaW5nID0gZnVuY3Rpb24oIGlkLCBwYXJhbXMgKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgbWZ1bmMgPSBjYWNoZVsgaWQgXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBtZnVuYyApe1xuICAgICAgICAgICAgbWZ1bmMgPSBtZi5jb21waWxlKCByZXNvdXJjZXNbIGlkIF0gKTtcbiAgICAgICAgICAgIGNhY2hlWyBpZCBdID0gbWZ1bmM7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBtZnVuYyggcGFyYW1zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0U291cmNlID0gZnVuY3Rpb24oIHBhcmFtcyApe1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHBhcmFtcyAmJiB1dGlscy5pc0Z1bmN0aW9uKCBwYXJhbXMudG9Tb3VyY2UgKT9cbiAgICAgICAgICAgIHBhcmFtcy50b1NvdXJjZSgpOlxuICAgICAgICAgICAgJyc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHJOdW1iZXIgPSBmdW5jdGlvbiggdmFsdWUsIHBhcmFtcyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBzb3VyY2UgPSBnZXRTb3VyY2UoIHBhcmFtcyApO1xuICAgICAgICB2YXIgbnVtYmVyRm9ybWF0ID0gbnVtYmVyRm9ybWF0Q2FjaGVbIHNvdXJjZSBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIG51bWJlckZvcm1hdCApe1xuICAgICAgICAgICAgbnVtYmVyRm9ybWF0ID0gbmV3IEludGwuTnVtYmVyRm9ybWF0KCBnZXRMb2NhbGUoKSwgcGFyYW1zICk7XG4gICAgICAgICAgICBudW1iZXJGb3JtYXRDYWNoZVsgc291cmNlIF0gPSBudW1iZXJGb3JtYXQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudW1iZXJGb3JtYXQuZm9ybWF0KCB2YWx1ZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRyQ3VycmVuY3kgPSBmdW5jdGlvbiggdmFsdWUsIHBhcmFtcywgdGhlQ3VycmVuY3kgKSB7XG4gICAgICAgIFxuICAgICAgICBwYXJhbXMuc3R5bGUgPSAnY3VycmVuY3knO1xuICAgICAgICBwYXJhbXMuY3VycmVuY3kgPSB0aGVDdXJyZW5jeTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0ck51bWJlciggdmFsdWUsIHBhcmFtcyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRyRGF0ZVRpbWUgPSBmdW5jdGlvbiggdmFsdWUsIHBhcmFtcyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBzb3VyY2UgPSBnZXRTb3VyY2UoIHBhcmFtcyApO1xuICAgICAgICB2YXIgZGF0ZVRpbWVGb3JtYXQgPSBkYXRlVGltZUZvcm1hdENhY2hlWyBzb3VyY2UgXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBkYXRlVGltZUZvcm1hdCApe1xuICAgICAgICAgICAgZGF0ZVRpbWVGb3JtYXQgPSBuZXcgSW50bC5EYXRlVGltZUZvcm1hdCggZ2V0TG9jYWxlKCksIHBhcmFtcyApO1xuICAgICAgICAgICAgZGF0ZVRpbWVGb3JtYXRDYWNoZVsgc291cmNlIF0gPSBkYXRlVGltZUZvcm1hdDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGRhdGVUaW1lRm9ybWF0LmZvcm1hdCggdmFsdWUgKTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGdldExhbmd1YWdlOiBnZXRMYW5ndWFnZSxcbiAgICAgICAgZ2V0TG9jYWxlOiBnZXRMb2NhbGUsXG4gICAgICAgIGV4aXN0czogZXhpc3RzLFxuICAgICAgICB0cjogdHJcbiAgICB9O1xufTtcbiIsIi8qIFxuICAgIEkxOG5CdW5kbGUgY2xhc3MgXG4qL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiggKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGkxOG5MaXN0ID0ge307XG4gICAgdmFyIGZpcnN0ID0gdW5kZWZpbmVkO1xuXG4gICAgdmFyIGFkZCA9IGZ1bmN0aW9uKCBpMThuICl7XG4gICAgICAgIGkxOG5MaXN0WyBpMThuLmdldExhbmd1YWdlKCkgXSA9IGkxOG47XG4gICAgICAgIGlmICggISBmaXJzdCApe1xuICAgICAgICAgICAgZmlyc3QgPSBpMThuO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXhpc3RzID0gZnVuY3Rpb24oIGlkICl7XG4gICAgICAgIHJldHVybiBmaXJzdC5leGlzdHMoIGlkICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHIgPSBmdW5jdGlvbiggaWQsIHBhcmFtcywgZm9ybWF0LCBzdWJmb3JtYXQsIGxhbmd1YWdlICkge1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxhbmd1YWdlICl7XG4gICAgICAgICAgICB0aHJvdyAnTGFuZ3VhZ2Ugbm90IGRlZmluZWQhIFBsZWFzZSwgdXNlIGRhdGEtaUxhbmd1YWdlIHRvIGRlZmluZSBpdCBiZWZvcmUgdHJ5aW5nIHRvIHRyYW5zbGF0ZSBhbnl0aGluZyEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgaTE4biA9IGkxOG5MaXN0WyBsYW5ndWFnZSBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGkxOG4gKXtcbiAgICAgICAgICAgIHRocm93ICdMYW5ndWFnZSBcIicgKyBsYW5ndWFnZSArICdcIiBub3QgZm91bmQgaW4gSTE4bkJ1bmRsZSEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaTE4bi50ciggaWQsIHBhcmFtcywgZm9ybWF0LCBzdWJmb3JtYXQgKTtcbiAgICB9O1xuXG4gICAgLy8gSW5pdCFcbiAgICBmb3IgKCB2YXIgYyA9IDA7IGMgPCBhcmd1bWVudHMubGVuZ3RoOyBjKysgKSB7XG4gICAgICAgIGFkZCggYXJndW1lbnRzWyBjIF0gKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYWRkOiBhZGQsXG4gICAgICAgIGV4aXN0czogZXhpc3RzLFxuICAgICAgICB0cjogdHJcbiAgICB9O1xufTtcbiIsIi8qIFxuICAgIGkxOG5IZWxwZXIgc2luZ2xldG9uIGNsYXNzIFxuKi9cbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBJMThuID0gcmVxdWlyZSggJy4vaTE4bi5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciB0ciA9IGZ1bmN0aW9uICggaTE4bkxpc3QsIGlkLCBwYXJhbXMsIGZvcm1hdCwgc3ViZm9ybWF0LCBsYW5ndWFnZSApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGkxOG5MaXN0ICkge1xuICAgICAgICAgICAgcmV0dXJuICdObyBJMThuIGluc3RhbmNlIGRlZmluZWQhJztcbiAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIHZhciBsZW5ndGggPSBpMThuTGlzdC5sZW5ndGg7XG4gICAgICAgIGlmICggISBsZW5ndGggKXtcbiAgICAgICAgICAgIHJldHVybiAnVm9pZCBJMThuIGxpc3QhJztcbiAgICAgICAgfVxuXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGkxOG4gPSBpMThuTGlzdFsgaSBdO1xuICAgICAgICAgICAgaWYgKCBmb3JtYXQgIT09ICdzdHJpbmcnIHx8IGkxOG4uZXhpc3RzKCBpZCApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGkxOG4udHIoIGlkLCBwYXJhbXMsIGZvcm1hdCwgc3ViZm9ybWF0LCBsYW5ndWFnZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJ0kxOG4gcmVzb3VyY2UgXCInICsgaWQgKyAnXCIgbm90IGZvdW5kISc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgbG9hZEFzeW5jID0gZnVuY3Rpb24oIHJlbW90ZUxpc3QsIGNhbGxiYWNrLCBmYWlsQ2FsbGJhY2sgKXtcbiAgICAgICAgXG4gICAgICAgIGxvYWRBc3luY0l0ZW0oIFxuICAgICAgICAgICAge30sIFxuICAgICAgICAgICAgY2FsbGJhY2ssIFxuICAgICAgICAgICAgZmFpbENhbGxiYWNrLFxuICAgICAgICAgICAgcmVtb3RlTGlzdCwgXG4gICAgICAgICAgICByZW1vdGVMaXN0Lmxlbmd0aCAtIDEgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBsb2FkQXN5bmNJdGVtID0gZnVuY3Rpb24oIG1hcCwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaywgcmVtb3RlTGlzdCwgY3VycmVudEluZGV4ICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgdXJsID0gcmVtb3RlTGlzdFsgY3VycmVudEluZGV4IF07XG4gICAgICAgIHV0aWxzLmdldEpTT04oIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHVybDogdXJsLFxuICAgICAgICAgICAgICAgIGRvbmU6IGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBtYXBbIHVybCBdID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50SW5kZXggPiAwICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkQXN5bmNJdGVtKCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsQ2FsbGJhY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlTGlzdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLS1jdXJyZW50SW5kZXggKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBtYXAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24oIGpxeGhyLCB0ZXh0U3RhdHVzLCBlcnJvciApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5hc3luY0Vycm9yKCB1cmwsIGVycm9yLCBmYWlsQ2FsbGJhY2sgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfTtcbiAgICAvKlxuICAgIHZhciBsb2FkQXN5bmNJdGVtID0gZnVuY3Rpb24oIG1hcCwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjaywgcmVtb3RlTGlzdCwgY3VycmVudEluZGV4ICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgdXJsID0gcmVtb3RlTGlzdFsgY3VycmVudEluZGV4IF07XG4gICAgICAgICQuZ2V0SlNPTiggdXJsIClcbiAgICAgICAgICAgIC5kb25lKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCBkYXRhICkge1xuICAgICAgICAgICAgICAgICAgICBtYXBbIHVybCBdID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBjdXJyZW50SW5kZXggPiAwICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBsb2FkQXN5bmNJdGVtKCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtYXAsIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWlsQ2FsbGJhY2ssXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlTGlzdCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLS1jdXJyZW50SW5kZXggKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCBtYXAgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIClcbiAgICAgICAgICAgIC5mYWlsKFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCBqcXhociwgdGV4dFN0YXR1cywgZXJyb3IgKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuYXN5bmNFcnJvciggdXJsLCBlcnJvciwgZmFpbENhbGxiYWNrICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICB9O1xuICAgICovXG4gICAgXG4gICAgdmFyIGxvYWRBc3luY0F1dG8gPSBmdW5jdGlvbiggZGljdGlvbmFyeSwgaTE4biwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayApe1xuICAgICAgICBcbiAgICAgICAgLy8gUmV0dXJuIGlmIGl0IGlzIG5vdGhpbmcgdG8gZG9cbiAgICAgICAgaWYgKCAhIGkxOG4gfHwgISBpMThuLmZpbGVzIHx8ICEgT2JqZWN0LmtleXMoIGkxOG4uZmlsZXMgKS5sZW5ndGggKXtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEJ1aWxkIGpzb25GaWxlcyBhcnJheVxuICAgICAgICB2YXIgbnVtYmVyT2ZMYW5ndWFnZXMgPSBPYmplY3Qua2V5cyggaTE4bi5maWxlcyApLmxlbmd0aDtcbiAgICAgICAgdmFyIGpzb25GaWxlcyA9IFtdO1xuICAgICAgICB2YXIgdXJsUHJlZml4ID0gaTE4bi51cmxQcmVmaXggfHwgJyc7XG4gICAgICAgIGZvciAoIHZhciBsYW5nIGluIGkxOG4uZmlsZXMgKXtcbiAgICAgICAgICAgIHZhciBsYW5nRmlsZXMgPSBpMThuLmZpbGVzWyBsYW5nIF07XG4gICAgICAgICAgICBmb3IgKCB2YXIgaW5kZXggaW4gbGFuZ0ZpbGVzICl7XG4gICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBsYW5nRmlsZXNbIGluZGV4IF07XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHVybFByZWZpeCArIGZpbGU7XG4gICAgICAgICAgICAgICAganNvbkZpbGVzLnB1c2goIHVybCApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBVc2UgbG9hZEFzeW5jIG1ldGhvZCB0byBsb2FkIGFsbCBqc29uRmlsZXM7IHRoZW4gcmVnaXN0ZXIgSTE4biBpbnN0YW5jZXMgYW5kIGFycmF5c1xuICAgICAgICBsb2FkQXN5bmMoIFxuICAgICAgICAgICAganNvbkZpbGVzLCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCBpMThuTWFwICl7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgZm9yICggdmFyIGxhbmcgaW4gaTE4bi5maWxlcyApe1xuICAgICAgICAgICAgICAgICAgICB2YXIgbGFuZ0ZpbGVzID0gaTE4bi5maWxlc1sgbGFuZyBdO1xuICAgICAgICAgICAgICAgICAgICB2YXIgaTE4bkluc3RhbmNlQXJyYXkgPSBbXTtcbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIC8vIFJlZ2lzdGVyIGFycmF5IHZhcnNcbiAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyeVsgYnVpbGRJMThuSW5zdGFuY2VBcnJheU5hbWUoIGxhbmcgKSBdID0gaTE4bkluc3RhbmNlQXJyYXk7XG4gICAgICAgICAgICAgICAgICAgIGlmICggbnVtYmVyT2ZMYW5ndWFnZXMgPT09IDEgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlbICdpMThuQXJyYXknIF0gPSBpMThuSW5zdGFuY2VBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgZm9yICggdmFyIGluZGV4IGluIGxhbmdGaWxlcyApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGUgPSBsYW5nRmlsZXNbIGluZGV4IF07XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgdXJsID0gdXJsUHJlZml4ICsgZmlsZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBpMThuSW5zdGFuY2UgPSBuZXcgSTE4biggbGFuZywgaTE4bk1hcFsgdXJsIF0gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgaTE4biBpbnN0YW5jZXNcbiAgICAgICAgICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlbIGJ1aWxkSTE4bkluc3RhbmNlTmFtZSggZmlsZSApIF0gPSBpMThuSW5zdGFuY2U7XG4gICAgICAgICAgICAgICAgICAgICAgICBpMThuSW5zdGFuY2VBcnJheS51bnNoaWZ0KCBpMThuSW5zdGFuY2UgKTsgLy8gQWRkIHRvIHRoZSBiZWdpbm5pbmcgb2YgdGhlIGFycmF5XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBmYWlsQ2FsbGJhY2sgXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbGRJMThuSW5zdGFuY2VBcnJheU5hbWUgPSBmdW5jdGlvbiggbGFuZyApe1xuICAgICAgICByZXR1cm4gJ2kxOG4nICsgbGFuZy50b1VwcGVyQ2FzZSgpICsgJ0FycmF5JztcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZEkxOG5JbnN0YW5jZU5hbWUgPSBmdW5jdGlvbiggZmlsZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGZpbGVXaXRob3V0RXh0ZW5zaW9uID0gZmlsZS5zdWJzdHIoIDAsIGZpbGUubGFzdEluZGV4T2YoICcuJyApICk7XG4gICAgICAgIHJldHVybiAnaTE4bicgKyBmaWxlV2l0aG91dEV4dGVuc2lvbi50b1VwcGVyQ2FzZSgpO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICB0cjogdHIsXG4gICAgICAgIGxvYWRBc3luYzogbG9hZEFzeW5jLFxuICAgICAgICBsb2FkQXN5bmNBdXRvOiBsb2FkQXN5bmNBdXRvXG4gICAgfTtcbn0pKCk7XG4iLCIvKlxuICAgIGxvZ0hlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmUoICcuL2NvbnRleHQuanMnICk7XG4gICAgXG4gICAgdmFyIHRyYWNlID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbG9nZ2VyID0gY29udGV4dC5nZXRMb2dnZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBsb2dnZXIgKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbG9nZ2VyLnRyYWNlLmFwcGx5KCBsb2dnZXIsIGFyZ3VtZW50cyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlYnVnID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbG9nZ2VyID0gY29udGV4dC5nZXRMb2dnZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBsb2dnZXIgKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbG9nZ2VyLmRlYnVnLmFwcGx5KCBsb2dnZXIsIGFyZ3VtZW50cyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGluZm8gPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIuaW5mby5hcHBseSggbG9nZ2VyLCBhcmd1bWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB3YXJuID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbG9nZ2VyID0gY29udGV4dC5nZXRMb2dnZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBsb2dnZXIgKXtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgbG9nZ2VyLndhcm4uYXBwbHkoIGxvZ2dlciwgYXJndW1lbnRzICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXJyb3IgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIuZXJyb3IuYXBwbHkoIGxvZ2dlciwgYXJndW1lbnRzICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZmF0YWwgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIuZmF0YWwuYXBwbHkoIGxvZ2dlciwgYXJndW1lbnRzICk7XG4gICAgfTtcbiAgICBcbiAgICAvKlxuICAgIHZhciBmYXRhbEFuZFRocm93ID0gZnVuY3Rpb24gKCBtZXNzYWdlICl7XG4gICAgICAgIFxuICAgICAgICBmYXRhbC5hcHBseSggdGhpcywgYXJndW1lbnRzICk7XG4gICAgICAgIHRocm93IG1lc3NhZ2U7XG4gICAgfTsqL1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHRyYWNlOiB0cmFjZSxcbiAgICAgICAgZGVidWc6IGRlYnVnLFxuICAgICAgICBpbmZvOiBpbmZvLFxuICAgICAgICB3YXJuOiB3YXJuLFxuICAgICAgICBlcnJvcjogZXJyb3IsXG4gICAgICAgIGZhdGFsOiBmYXRhbFxuICAgICAgICAvL2ZhdGFsQW5kVGhyb3c6IGZhdGFsQW5kVGhyb3dcbiAgICB9O1xufSkoKTtcbiIsIi8qXHJcbiAgICBFeHBvcnRlZCBmdW5jdGlvbnNcclxuKi9cclxuZXhwb3J0cy5ydW4gPSBmdW5jdGlvbiggb3B0aW9ucyApe1xyXG4gICAgXHJcbiAgICB2YXIgcGFyc2VyID0gcmVxdWlyZSggJy4vcGFyc2Vycy9wYXJzZXIuanMnICk7XHJcbiAgICByZXR1cm4gcGFyc2VyLnJ1biggb3B0aW9ucyApO1xyXG59O1xyXG5cclxuLyogRGVjbGFyZSBleHBvcnRzICovXHJcbmV4cG9ydHMuSTE4biA9IHJlcXVpcmUoICcuL2kxOG4vaTE4bi5qcycgKTtcclxuZXhwb3J0cy5JMThuQnVuZGxlID0gcmVxdWlyZSggJy4vaTE4bi9pMThuQnVuZGxlLmpzJyApO1xyXG5leHBvcnRzLmkxOG5IZWxwZXIgPSByZXF1aXJlKCAnLi9pMThuL2kxOG5IZWxwZXIuanMnICk7XHJcbmV4cG9ydHMuY29udGV4dCA9IHJlcXVpcmUoICcuL2NvbnRleHQuanMnICk7XHJcbmV4cG9ydHMubG9nSGVscGVyID0gcmVxdWlyZSggJy4vbG9nSGVscGVyLmpzJyApO1xyXG5leHBvcnRzLmV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XHJcbmV4cG9ydHMuZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9ucy9ldmFsdWF0ZUhlbHBlci5qcycgKTtcclxuZXhwb3J0cy5FeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcclxuZXhwb3J0cy5SZWFjdGl2ZURpY3Rpb25hcnkgPSByZXF1aXJlKCAnLi9zY29wZXMvcmVhY3RpdmVEaWN0aW9uYXJ5LmpzJyApO1xyXG5leHBvcnRzLnZlcnNpb24gPSByZXF1aXJlKCAnLi92ZXJzaW9uLmpzJyApO1xyXG5cclxuLyogU3VwcG9ydCBSZXF1aXJlSlMgbW9kdWxlIHBhdHRlcm4gKi9cclxuaWYgKCB0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQgKSB7XHJcbiAgICBkZWZpbmUoICd6cHQucnVuJywgZXhwb3J0cy5ydW4gKTtcclxuICAgIGRlZmluZSggJ3pwdC5JMThuJywgZXhwb3J0cy5JMThuICk7XHJcbiAgICBkZWZpbmUoICd6cHQuSTE4bkJ1bmRsZScsIGV4cG9ydHMuSTE4bkJ1bmRsZSApO1xyXG4gICAgZGVmaW5lKCAnenB0LmkxOG5IZWxwZXInLCBleHBvcnRzLmkxOG5IZWxwZXIgKTtcclxuICAgIGRlZmluZSggJ3pwdC5jb250ZXh0JywgZXhwb3J0cy5jb250ZXh0ICk7XHJcbiAgICBkZWZpbmUoICd6cHQubG9nSGVscGVyJywgZXhwb3J0cy5sb2dIZWxwZXIgKTtcclxuICAgIGRlZmluZSggJ3pwdC5leHByZXNzaW9uQnVpbGRlcicsIGV4cG9ydHMuZXhwcmVzc2lvbkJ1aWxkZXIgKTtcclxuICAgIGRlZmluZSggJ3pwdC5ldmFsdWF0ZUhlbHBlcicsIGV4cG9ydHMuZXZhbHVhdGVIZWxwZXIgKTtcclxuICAgIGRlZmluZSggJ3pwdC5FeHByZXNzaW9uVG9rZW5pemVyJywgZXhwb3J0cy5FeHByZXNzaW9uVG9rZW5pemVyICk7XHJcbiAgICBkZWZpbmUoICd6cHQuUmVhY3RpdmVEaWN0aW9uYXJ5JywgZXhwb3J0cy5SZWFjdGl2ZURpY3Rpb25hcnkgKTtcclxuICAgIGRlZmluZSggJ3pwdC52ZXJzaW9uJywgZXhwb3J0cy52ZXJzaW9uICk7XHJcbn1cclxuIiwiLyogXG4gICAgQ2xhc3MgQXV0b0RlZmluZUhlbHBlciBcbiovXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xudmFyIFRBTERlZmluZSA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxEZWZpbmUuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCBub2RlICkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciBkZWZpbmVEZWxpbWl0ZXIgPSBjb250ZXh0LmdldENvbmYoKS5kZWZpbmVEZWxpbWl0ZXI7XG4gICAgdmFyIGluRGVmaW5lRGVsaW1pdGVyID0gY29udGV4dC5nZXRDb25mKCkuaW5EZWZpbmVEZWxpbWl0ZXI7XG4gICAgdmFyIG5vY2FsbEV4cHJlc3Npb25QcmVmaXggPSBjb250ZXh0LmdldENvbmYoKS5ub2NhbGxWYXJpYWJsZUV4cHJlc3Npb25QcmVmaXg7XG4gICAgdmFyIHRhbEF1dG9EZWZpbmUgPSBjb250ZXh0LmdldFRhZ3MoKS50YWxBdXRvRGVmaW5lO1xuXG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuICAgIGlmICggbm9kZSAmJiBub2RlLmdldEF0dHJpYnV0ZSggdGFsQXV0b0RlZmluZSApICl7XG4gICAgICAgIGJ1ZmZlciA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWxBdXRvRGVmaW5lICk7XG4gICAgfVxuICAgIFxuICAgIHZhciBwdXQgPSBmdW5jdGlvbiggbmFtZSwgc3RyaW5nLCBub2NhbGwgKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggYnVmZmVyICE9PSAnJyApe1xuICAgICAgICAgICAgYnVmZmVyICs9IGRlZmluZURlbGltaXRlcjtcbiAgICAgICAgfVxuICAgICAgICBidWZmZXIgKz0gKG5vY2FsbD8gbm9jYWxsRXhwcmVzc2lvblByZWZpeCArIGluRGVmaW5lRGVsaW1pdGVyOiAnJykgKyBuYW1lICsgaW5EZWZpbmVEZWxpbWl0ZXIgKyBzdHJpbmc7XG4gICAgfTtcblxuICAgIHZhciB1cGRhdGVOb2RlID0gZnVuY3Rpb24oIG5vZGUgKXtcblxuICAgICAgICBpZiAoIGJ1ZmZlciApe1xuICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIHRhbEF1dG9EZWZpbmUsIGJ1ZmZlciApO1xuICAgICAgICAgICAgcmV0dXJuIGJ1ZmZlcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHV0OiBwdXQsXG4gICAgICAgIHVwZGF0ZU5vZGU6IHVwZGF0ZU5vZGVcbiAgICB9O1xufTtcbiIsIi8qIFxuICAgIENsYXNzIERlcHNEYXRhSXRlbSBcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIERlcHNEYXRhSXRlbSA9IGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHRoaXMubm9uRXhwcmVzc2lvblZhcnMgPSB7fTtcbiAgICB0aGlzLmV4cHJlc3Npb25WYXJzID0ge307XG59O1xuXG5EZXBzRGF0YUl0ZW0ucHJvdG90eXBlLm11c3RBZGRWYXIgPSBmdW5jdGlvbiggdmFyTmFtZSApe1xuICAgIHJldHVybiB0aGlzLm5vbkV4cHJlc3Npb25WYXJzWyB2YXJOYW1lIF0gPT09IHVuZGVmaW5lZCAmJiB0aGlzLmV4cHJlc3Npb25WYXJzWyB2YXJOYW1lIF0gPT09IHVuZGVmaW5lZDtcbn07XG5cbkRlcHNEYXRhSXRlbS5wcm90b3R5cGUuYWRkQWxsVmFycyA9IGZ1bmN0aW9uKCB2YXJOYW1lcywgc2NvcGUgKXtcbiAgICBcbiAgICBmb3IgKCB2YXIgbmFtZSBpbiB2YXJOYW1lcyApe1xuICAgICAgICB0aGlzLmFkZDFWYXIoIHZhck5hbWVzWyBuYW1lIF0sIHNjb3BlICk7XG4gICAgfVxufTtcblxuRGVwc0RhdGFJdGVtLnByb3RvdHlwZS5hZGQxRXhwcmVzc2lvblZhciA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XG4gICAgdGhpcy5leHByZXNzaW9uVmFyc1sgdmFyTmFtZSBdID0gdHJ1ZTtcbn07XG5cbkRlcHNEYXRhSXRlbS5wcm90b3R5cGUuYWRkMU5vbkV4cHJlc3Npb25WYXIgPSBmdW5jdGlvbiggdmFyTmFtZSApe1xuICAgIHRoaXMubm9uRXhwcmVzc2lvblZhcnNbIHZhck5hbWUgXSA9IHRydWU7XG59O1xuXG5EZXBzRGF0YUl0ZW0ucHJvdG90eXBlLmFkZDFWYXIgPSBmdW5jdGlvbiggdmFyTmFtZSwgc2NvcGUgKXtcblxuICAgIHZhciBtYXAgPSBzY29wZS5pc0xvY2FsVmFyKCB2YXJOYW1lICk/IHRoaXMuZXhwcmVzc2lvblZhcnM6IHRoaXMubm9uRXhwcmVzc2lvblZhcnM7XG4gICAgbWFwWyB2YXJOYW1lIF0gPSB0cnVlO1xuXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IERlcHNEYXRhSXRlbTtcbiIsIi8qIFxuICAgIENsYXNzIEFic3RyYWN0QWN0aW9uXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi8uLi91dGlscy5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBBYnN0cmFjdEFjdGlvbiA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgXG4gICAgdGhpcy5pZCA9IG9iamVjdC5pZDtcbiAgICB0aGlzLnZhciA9IG9iamVjdC52YXI7XG4gICAgdGhpcy5jdXJyZW50RWxlbWVudCA9IG9iamVjdC5jdXJyZW50RWxlbWVudDtcbiAgICB0aGlzLmFuaW1hdGlvbiA9IG9iamVjdC5hbmltYXRpb247XG4gICAgdGhpcy5hbmltYXRpb25DYWxsYmFjayA9IG9iamVjdC5hbmltYXRpb25DYWxsYmFjaztcbiAgICBpZiAoIG9iamVjdC5zZWFyY2ggKXtcbiAgICAgICAgaWYgKCB0aGlzLmlkIHx8IHRoaXMudmFyICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgaW4gYWN0aW9uOiB5b3UgY2FuIG5vdCBzZXQgYSBzZWFyY2ggYW5kIHRoZW4gYW5kIGlkOiBpZiB5b3Ugc2V0IGEgc2VhcmNoIFpQVC1KUyB3aWxsIHNldCB0aGUgaWQgZm9yIHlvdSEnO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuaW5pdGlhbGl6ZVVzaW5nU2VhcmNoKCBvYmplY3Quc2VhcmNoLCBkaWN0aW9uYXJ5ICk7XG4gICAgfVxufTtcblxuQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlLmluaXRpYWxpemVVc2luZ1NlYXJjaCA9IGZ1bmN0aW9uKCBzZWFyY2gsIGRpY3Rpb25hcnkgKXtcblxuICAgIHRoaXMuaWQgPSAnJztcbiAgICB0aGlzLnZhciA9IGRpY3Rpb25hcnk7XG4gICAgXG4gICAgLy8gSXRlcmF0ZSBzZWFyY2ggaXRlbXMgYW5kIGJ1aWxkIGlkIGFuZCB2YXJcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBzZWFyY2gubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdmFyIGl0ZW0gPSBzZWFyY2hbIGkgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJlcGxhY2UgaXRlbSBpcyBpdCBhIHNlYXJjaCBvYmplY3QsICdfZmlyc3RfJyBvciAnX2xhc3RfJ1xuICAgICAgICBpZiAoIHV0aWxzLmlzUGxhaW5PYmplY3QoIGl0ZW0gKSApe1xuICAgICAgICAgICAgaXRlbSA9IHRoaXMuc2VhcmNoKCB0aGlzLnZhciwgaXRlbSApO1xuICAgICAgICB9IGVsc2UgaWYgKCBpdGVtID09PSBjb250ZXh0LmdldENvbmYoKS5maXJzdEluZGV4SWRlbnRpZmllciApe1xuICAgICAgICAgICAgaXRlbSA9IDA7XG4gICAgICAgIH0gZWxzZSBpZiAoIGl0ZW0gPT09IGNvbnRleHQuZ2V0Q29uZigpLmxhc3RJbmRleElkZW50aWZpZXIgKXtcbiAgICAgICAgICAgIGl0ZW0gPSB0aGlzLnZhci5sZW5ndGggLSAxO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCB0aGUgaWRcbiAgICAgICAgaWYgKCBOdW1iZXIuaXNJbnRlZ2VyKCBpdGVtICkgKXtcbiAgICAgICAgICAgIHRoaXMuaWQgKz0gJ1snICsgaXRlbSArICddJztcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHZhciBzZXBhcmF0b3IgPSBpID09PSAwPyAnJzogJy4nO1xuICAgICAgICAgICAgdGhpcy5pZCArPSBzZXBhcmF0b3IgKyBpdGVtO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCB0aGUgdmFyXG4gICAgICAgIHRoaXMudmFyID0gdGhpcy52YXJbIGl0ZW0gXTtcbiAgICB9XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUuc2VhcmNoID0gZnVuY3Rpb24oIGxpc3QsIGV4cHJlc3Npb25FbGVtZW50ICl7XG4gICAgXG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7ICsraSApe1xuICAgICAgICB2YXIgcmVjb3JkID0gbGlzdFsgaSBdO1xuICAgICAgICBpZiAoIEFic3RyYWN0QWN0aW9uLmVsZW1lbnRNYWNoZXMoIHJlY29yZCwgZXhwcmVzc2lvbkVsZW1lbnQgKSApe1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgJ05vIHJlY29yZCBmb3VuZCBtYXRjaGluZyB5b3VyIGNyaXRlcmlhISc7XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5lbGVtZW50TWFjaGVzID0gZnVuY3Rpb24oIGVsZW1lbnQsIGV4cHJlc3Npb25FbGVtZW50ICl7XG4gICAgXG4gICAgaWYgKCBleHByZXNzaW9uRWxlbWVudCA9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgdGhyb3cgJ0V4cHJlc3Npb24gdG8gbWF0Y2ggbXVzdCBub3QgYmUgbnVsbCEnO1xuICAgIH1cblxuICAgIGlmICggQXJyYXkuaXNBcnJheSggZXhwcmVzc2lvbkVsZW1lbnQgKSApe1xuICAgICAgICB0aHJvdyAnRXhwcmVzc2lvbiAnICsgdXRpbHMuZ2VuZXJpY1RvU3RyaW5nKCBleHByZXNzaW9uRWxlbWVudCApICsgJyB0byBtYXRjaCBtdXN0IG5vdCBiZSBhbiBhcnJheSEnO1xuICAgIH1cblxuICAgIGlmICggdXRpbHMuaXNQbGFpbk9iamVjdCggZXhwcmVzc2lvbkVsZW1lbnQgKSApe1xuICAgICAgICBmb3IgKCB2YXIgaSBpbiBleHByZXNzaW9uRWxlbWVudCApe1xuICAgICAgICAgICAgaWYgKCBleHByZXNzaW9uRWxlbWVudFsgaSBdICE9PSBlbGVtZW50WyBpIF0gKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuXG4gICAgLy8gTXVzdCBiZSBudW1lcmljIG9yIHN0cmluZ1xuICAgIHJldHVybiBlbGVtZW50ID09PSBleHByZXNzaW9uRWxlbWVudDtcbn07XG5cbkFic3RyYWN0QWN0aW9uLnByb3RvdHlwZS5nZXRWYWx1ZSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgcmV0dXJuIHRoaXMudmFyID09PSB1bmRlZmluZWQ/XG4gICAgICAgIGRpY3Rpb25hcnlbIHRoaXMuaWQgXTpcbiAgICAgICAgdGhpcy52YXI7XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUucmVzb2x2ZVRoaXNOb2RlID0gZnVuY3Rpb24oIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciApe1xuICAgIFxuICAgIC8vdmFyIGF0dHJpYnV0ZUluc3RhbmNlID0gaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlO1xuICAgIHZhciBub2RlID0gcGFyc2VyVXBkYXRlci5maW5kTm9kZUJ5SWQoIGluZGV4SXRlbS5ub2RlSWQgKTtcbiAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICAvLyBSZW1vdmVkIG5vZGUhXG4gICAgICAgIHBhcnNlclVwZGF0ZXIuYWRkUmVtb3ZlZFRvU3RhdGlzdGljcygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHBhcnNlclVwZGF0ZXIuYWRkVXBkYXRlZFRvU3RhdGlzdGljcygpO1xuICAgIFxuICAgIC8vIFJldHVybiB0aGUgbm9kZVxuICAgIHJldHVybiBub2RlO1xufTtcblxuQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlLmF0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkID0gZnVuY3Rpb24oIGF0dHJpYnV0ZUluc3RhbmNlICl7XG4gICAgdGhyb3cgJ0Vycm9yOiBhdHRyaWJ1dGVJbnN0YW5jZUlzUmVsYXRlZCBtdXN0IGJlIGltcGxlbWVudGVkISc7XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCl7XG4gICAgdGhyb3cgJ0Vycm9yOiB1cGRhdGVEaWN0aW9uYXJ5IG11c3QgYmUgaW1wbGVtZW50ZWQhJztcbn07XG5cbkFic3RyYWN0QWN0aW9uLnByb3RvdHlwZS51cGRhdGVIVE1MID0gZnVuY3Rpb24oKXtcbiAgICB0aHJvdyAnRXJyb3I6IHVwZGF0ZUhUTUwgbXVzdCBiZSBpbXBsZW1lbnRlZCEnO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBYnN0cmFjdEFjdGlvbjtcbiIsIi8qIFxuICAgIENsYXNzIEFic3RyYWN0QXJyYXlBY3Rpb25cbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0QWN0aW9uID0gcmVxdWlyZSggJy4vYWJzdHJhY3RBY3Rpb24uanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vdXRpbHMuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xuXG52YXIgQWJzdHJhY3RBcnJheUFjdGlvbiA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RBY3Rpb24uY2FsbCggdGhpcywgb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgXG4gICAgdGhpcy5pbmRleCA9IG9iamVjdC5pbmRleDtcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlICk7XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24uZ2V0SW5kZXhOdW1lcmljVmFsdWUgPSBmdW5jdGlvbiggaW5kZXggKXtcbiAgICBcbiAgICBpZiAoIGluZGV4ID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsgICBcbiAgICB9XG4gICAgXG4gICAgaWYgKCBpbmRleCA9PT0gY29udGV4dC5nZXRDb25mKCkuZmlyc3RJbmRleElkZW50aWZpZXIgKXtcbiAgICAgICAgcmV0dXJuIDA7XG4gICAgfSBlbHNlIGlmICggaW5kZXggPT09IGNvbnRleHQuZ2V0Q29uZigpLmxhc3RJbmRleElkZW50aWZpZXIgKXtcbiAgICAgICAgcmV0dXJuIC0xOyAvLyBUaGlzIG1lYW5zIGl0IGlzIHRoZSBsYXN0XG4gICAgfVxuICAgIHJldHVybiBpbmRleDtcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlLmdldEluZGV4TnVtZXJpY1ZhbHVlID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gQWJzdHJhY3RBcnJheUFjdGlvbi5nZXRJbmRleE51bWVyaWNWYWx1ZSggdGhpcy5pbmRleCApO1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUuZ2V0SW5kZXhUb1VzZSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG5cbiAgICBpZiAoIHRoaXMuaW5kZXggPT09IHVuZGVmaW5lZCAmJiB0aGlzLmN1cnJlbnRFbGVtZW50ID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgdGhyb3cgJ2luZGV4IG9yIGN1cnJlbnRFbGVtZW50IG11c3QgYmUgZGVmaW5lZCBpbiAnICsgdGhpcy5pZCArICcgYXJyYXkgYWN0aW9uISc7XG4gICAgfVxuICAgIFxuICAgIC8vIENoZWNrIGlmIGl0IHVzZXMgdGhlIGluZGV4XG4gICAgdmFyIGluZGV4TnVtZXJpY1ZhbHVlID0gdGhpcy5nZXRJbmRleE51bWVyaWNWYWx1ZSgpO1xuICAgIGlmICggaW5kZXhOdW1lcmljVmFsdWUgIT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gaW5kZXhOdW1lcmljVmFsdWU7XG4gICAgfVxuXG4gICAgLy8gTXVzdCB1c2UgY3VycmVudEVsZW1lbnRcbiAgICB2YXIgYXJyYXlWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhcnJheVZhbHVlLmxlbmd0aDsgKytpICl7XG4gICAgICAgIHZhciBlbGVtZW50ID0gYXJyYXlWYWx1ZVsgaSBdO1xuICAgICAgICBpZiAoIEFic3RyYWN0QWN0aW9uLmVsZW1lbnRNYWNoZXMoIGVsZW1lbnQsIHRoaXMuY3VycmVudEVsZW1lbnQgKSApe1xuICAgICAgICAgICAgcmV0dXJuIGk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgJ2N1cnJlbnRFbGVtZW50ICcgKyB1dGlscy5nZW5lcmljVG9TdHJpbmcoIHRoaXMuY3VycmVudEVsZW1lbnQgKSArICcgbm90IGZvdW5kIGluICcgKyB0aGlzLmlkICsgJyBhcnJheSBhY3Rpb24hJztcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlLmF0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkID0gZnVuY3Rpb24oIGF0dHJpYnV0ZUluc3RhbmNlICl7XG4gICAgcmV0dXJuIEFic3RyYWN0QXJyYXlBY3Rpb24uc3RhdGljQXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQoIGF0dHJpYnV0ZUluc3RhbmNlICk7XG59O1xuXG5BYnN0cmFjdEFycmF5QWN0aW9uLnN0YXRpY0F0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkID0gZnVuY3Rpb24oIGF0dHJpYnV0ZUluc3RhbmNlICl7XG4gICAgcmV0dXJuIGF0dHJpYnV0ZUluc3RhbmNlLnR5cGUgPT09ICd0YWw6cmVwZWF0Jztcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlLnVwZGF0ZURpY3Rpb25hcnkgPSBmdW5jdGlvbigpe1xuICAgIHRocm93ICdFcnJvcjogdXBkYXRlRGljdGlvbmFyeSBtdXN0IGJlIGltcGxlbWVudGVkISc7XG59O1xuXG5BYnN0cmFjdEFycmF5QWN0aW9uLnByb3RvdHlwZS51cGRhdGVIVE1MID0gZnVuY3Rpb24oKXtcbiAgICB0aHJvdyAnRXJyb3I6IHVwZGF0ZUhUTUwgbXVzdCBiZSBpbXBsZW1lbnRlZCEnO1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUucmVzb2x2ZUNoaWxkTm9kZSA9IGZ1bmN0aW9uKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIgKXtcbiAgICBcbiAgICAvL3ZhciBhdHRyaWJ1dGVJbnN0YW5jZSA9IGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZTtcbiAgICB2YXIgbm9kZSA9IHBhcnNlclVwZGF0ZXIuZmluZE5vZGVCeUlkKCBpbmRleEl0ZW0ubm9kZUlkICk7XG4gICAgaWYgKCAhIG5vZGUgKXtcbiAgICAgICAgLy8gUmVtb3ZlZCBub2RlIVxuICAgICAgICBwYXJzZXJVcGRhdGVyLmFkZFJlbW92ZWRUb1N0YXRpc3RpY3MoKTtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBwYXJzZXJVcGRhdGVyLmFkZFVwZGF0ZWRUb1N0YXRpc3RpY3MoKTtcbiAgICBcbiAgICAvLyBSZXR1cm4gdGhlIG5vZGVcbiAgICByZXR1cm4gdGhpcy5pbmRleFRvVXNlID09PSAtMT9cbiAgICAgICAgbnVsbDpcbiAgICAgICAgdGhpcy5nZXRJbmRleE9mTG9vcCggbm9kZS5wYXJlbnROb2RlLCBpbmRleEl0ZW0ubm9kZUlkLCB0aGlzLmluZGV4VG9Vc2UgKTtcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlLmdldEluZGV4T2ZMb29wID0gZnVuY3Rpb24oIHBhcmVudE5vZGUsIG5vZGVJZCwgaW5kZXhJbkxvb3AgKXtcbiAgICBcbiAgICB2YXIgbnVtYmVyT2ZDaGlsZHJlbiA9IHBhcmVudE5vZGUuY2hpbGRFbGVtZW50Q291bnQ7XG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbnVtYmVyT2ZDaGlsZHJlbjsgKytpICl7XG4gICAgICAgIHZhciBjaGlsZE5vZGUgPSBwYXJlbnROb2RlLmNoaWxkcmVuWyBpIF07XG4gICAgICAgIHZhciBjdXJyZW50Tm9kZUlkID0gY2hpbGROb2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKTtcbiAgICAgICAgaWYgKCBjdXJyZW50Tm9kZUlkID09PSBub2RlSWQgKXtcbiAgICAgICAgICAgIHJldHVybiBwYXJlbnROb2RlLmNoaWxkcmVuWyAxICsgaSArIGluZGV4SW5Mb29wIF07XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFic3RyYWN0QXJyYXlBY3Rpb247XG4iLCIvKiBcbiAgICBDbGFzcyBBYnN0cmFjdE9iamVjdEFjdGlvblxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQWJzdHJhY3RBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdEFjdGlvbi5qcycgKTtcblxudmFyIEFic3RyYWN0T2JqZWN0QWN0aW9uID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcbiAgICBBYnN0cmFjdEFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICB0aGlzLnByb3BlcnR5ID0gb2JqZWN0LnByb3BlcnR5O1xuICAgIHRoaXMuaWQgKz0gJy4nICsgb2JqZWN0LnByb3BlcnR5O1xufTtcblxuQWJzdHJhY3RPYmplY3RBY3Rpb24ucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlICk7XG5cbkFic3RyYWN0T2JqZWN0QWN0aW9uLnByb3RvdHlwZS5hdHRyaWJ1dGVJbnN0YW5jZUlzUmVsYXRlZCA9IGZ1bmN0aW9uKCBhdHRyaWJ1dGVJbnN0YW5jZSApe1xuICAgIHJldHVybiB0cnVlO1xufTtcblxuQWJzdHJhY3RPYmplY3RBY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUhUTUwgPSBmdW5jdGlvbiggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyLCBhY3Rpb25JbnN0YW5jZSApe1xuICAgIFxuICAgIC8vIE11c3QgZ2V0IHRoZSBub2RlXG4gICAgdmFyIG5vZGUgPSB0aGlzLnJlc29sdmVUaGlzTm9kZSggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyICk7XG4gICAgaWYgKCAhIG5vZGUgKXtcbiAgICAgICAgdGhyb3cgJ05vIG5vZGUgZm91bmQgdG8gdXBkYXRlJztcbiAgICB9XG4gICAgXG4gICAgLy8gVXBkYXRlIHRoZSBzZWxlY3RlZCBub2RlXG4gICAgcGFyc2VyVXBkYXRlci51cGRhdGVOb2RlKCBub2RlICk7XG4gICAgXG4gICAgLy8gUnVuIGFuaW1hdGlvblxuICAgIHBhcnNlclVwZGF0ZXIucnVuQW5pbWF0aW9uKCBhY3Rpb25JbnN0YW5jZSwgbm9kZSApO1xuICAgIFxuICAgIHJldHVybiB0cnVlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBYnN0cmFjdE9iamVjdEFjdGlvbjtcbiIsIi8qIFxuICAgIENsYXNzIEFycmF5Q3JlYXRlXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBBYnN0cmFjdEFycmF5QWN0aW9uID0gcmVxdWlyZSggJy4vYWJzdHJhY3RBcnJheUFjdGlvbi5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgUGFyc2VyTm9kZVJlbmRlcmVyID0gcmVxdWlyZSggJy4uLy4uL3BhcnNlcnMvcGFyc2VyTm9kZVJlbmRlcmVyLmpzJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uLy4uL3V0aWxzLmpzJyApO1xuXG52YXIgQXJyYXlDcmVhdGUgPSBmdW5jdGlvbiggb2JqZWN0LCBkaWN0aW9uYXJ5ICkge1xuICAgIEFic3RyYWN0QXJyYXlBY3Rpb24uY2FsbCggdGhpcywgb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgXG4gICAgdGhpcy5uZXdFbGVtZW50ID0gb2JqZWN0Lm5ld0VsZW1lbnQ7XG59O1xuXG5BcnJheUNyZWF0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBBYnN0cmFjdEFycmF5QWN0aW9uLnByb3RvdHlwZSApO1xuXG5BcnJheUNyZWF0ZS5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgXG4gICAgdGhpcy5pbmRleFRvVXNlID0gdGhpcy5nZXRJbmRleFRvVXNlKCBkaWN0aW9uYXJ5ICk7XG4gICAgdmFyIGFycmF5VmFsdWUgPSB0aGlzLmdldFZhbHVlKCBkaWN0aW9uYXJ5ICk7XG4gICAgXG4gICAgaWYgKCB0aGlzLmluZGV4VG9Vc2UgPT09IC0xICl7XG4gICAgICAgIHRoaXMucmVzb2x2ZWRJbmRleCA9IGFycmF5VmFsdWUubGVuZ3RoO1xuICAgICAgICBhcnJheVZhbHVlLnB1c2goIHRoaXMubmV3RWxlbWVudCApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMucmVzb2x2ZWRJbmRleCA9IHRoaXMuaW5kZXhUb1VzZTtcbiAgICAgICAgYXJyYXlWYWx1ZS5zcGxpY2UoIHRoaXMuaW5kZXhUb1VzZSwgMCwgdGhpcy5uZXdFbGVtZW50ICk7XG4gICAgfVxufTtcblxuQXJyYXlDcmVhdGUucHJvdG90eXBlLnVwZGF0ZUhUTUwgPSBmdW5jdGlvbiggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyLCBhY3Rpb25JbnN0YW5jZSApe1xuICAgIFxuICAgIC8vIE11c3QgZ2V0IHRoZSBub2RlVG9VcGRhdGVcbiAgICB2YXIgbm9kZSA9IHRoaXMucmVzb2x2ZVRoaXNOb2RlKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIgKTtcbiAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICB0aHJvdyAnTm8gbm9kZSBmb3VuZCB0byBjbG9uZSc7XG4gICAgfVxuICAgIFxuICAgIC8vIEluaXQgc29tZSB2YXJzXG4gICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcbiAgICB2YXIgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICBcbiAgICAvLyBDbG9uZSBhbmQgY29uZmlndXJlIHRoZSBub2RlXG4gICAgdmFyIHRtcE5vZGUgPSBQYXJzZXJOb2RlUmVuZGVyZXIuY2xvbmVBbmRDb25maWd1cmVOb2RlKCBcbiAgICAgICAgbm9kZSwgXG4gICAgICAgIHRydWUsIFxuICAgICAgICB0YWdzLCBcbiAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaWQgKSBcbiAgICApO1xuICAgIFBhcnNlck5vZGVSZW5kZXJlci5jb25maWd1cmVOb2RlRm9yTmV3SXRlbSggXG4gICAgICAgIHRtcE5vZGUsIFxuICAgICAgICB0YWdzLCBcbiAgICAgICAgcGFyZW50Tm9kZSwgXG4gICAgICAgIGluZGV4SXRlbSwgXG4gICAgICAgIHRoaXMucmVzb2x2ZWRJbmRleFxuICAgICk7XG4gICAgXG4gICAgLy8gSW5zZXJ0IGl0XG4gICAgdmFyIHNpYmxpbmcgPSB0aGlzLmluZGV4VG9Vc2UgPT09IC0xP1xuICAgICAgICBudWxsOlxuICAgICAgICBwYXJlbnROb2RlLmNoaWxkcmVuWyAxICsgdGhpcy5pbmRleFRvVXNlIF07XG4gICAgcGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIHRtcE5vZGUsIHNpYmxpbmcgKTtcbiAgICBcbiAgICAvLyBVcGRhdGUgdGhlIHNlbGVjdGVkIG5vZGVcbiAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIHRtcE5vZGUgKTtcbiAgICBcbiAgICAvLyBSdW4gYW5pbWF0aW9uXG4gICAgcGFyc2VyVXBkYXRlci5ydW5BbmltYXRpb24oIGFjdGlvbkluc3RhbmNlLCB0bXBOb2RlICk7XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5BcnJheUNyZWF0ZS5idWlsZE11bHRpcGxlID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApe1xuXG4gICAgdmFyIGFjdGlvbnMgPSBbXTtcbiAgICBcbiAgICAvLyBDb3B5IG5ld0VsZW1lbnRzIHRvIGEgbmV3IGFycmF5XG4gICAgdmFyIG5ld0VsZW1lbnRzID0gdXRpbHMuY29weUFycmF5KCBvYmplY3QubmV3RWxlbWVudCApO1xuICAgIFxuICAgIC8vIENvbmZpZ3VyZSB0aGUgb2JqZWN0LCBjcmVhdGUgdGhlIGZpcnN0IGluc3RhbmNlIGFuZCBhZGQgaXQgdG8gdGhlIGxpc3RcbiAgICBvYmplY3QubmV3RWxlbWVudCA9IG5ld0VsZW1lbnRzWyAwIF07XG4gICAgdmFyIGZpcnN0QWN0aW9uSW5zdGFuY2UgPSBuZXcgQXJyYXlDcmVhdGUoIG9iamVjdCwgZGljdGlvbmFyeSApO1xuICAgIGFjdGlvbnMucHVzaCggZmlyc3RBY3Rpb25JbnN0YW5jZSApO1xuICAgIFxuICAgIC8vIEdldCB0aGUgZmlyc3RJbmRleCBhbmQgaWYgdGhlIG5ldyBlbG1lbnRzIG11c3QgYmUgdGhlIGxhc3RcbiAgICB2YXIgZmlyc3RJbmRleCA9IGZpcnN0QWN0aW9uSW5zdGFuY2UuZ2V0SW5kZXhOdW1lcmljVmFsdWUoKTtcbiAgICB2YXIgaXNMYXN0ID0gLTEgPT09IGZpcnN0SW5kZXg7XG4gICAgICAgIFxuICAgIC8vIEJ1aWxkIGFjdGlvbnMgbGlzdFxuICAgIGZvciAoIHZhciBpID0gMTsgaSA8IG5ld0VsZW1lbnRzLmxlbmd0aDsgKytpICl7XG4gICAgICAgIHZhciBuZXdFbGVtZW50ID0gbmV3RWxlbWVudHNbIGkgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsb25lIHRoZSBvYmplY3QgYW5kIGNvbmZpZ3VyZSB0aGUgbmV3RWxlbWVudCBhbmQgdGhlIGluZGV4XG4gICAgICAgIHZhciBuZXdPYmplY3QgPSB1dGlscy5kZWVwRXh0ZW5kKCBvYmplY3QgKTtcbiAgICAgICAgbmV3T2JqZWN0Lm5ld0VsZW1lbnQgPSBuZXdFbGVtZW50O1xuICAgICAgICBuZXdPYmplY3QuaW5kZXggPSBpc0xhc3Q/XG4gICAgICAgICAgICAtMTpcbiAgICAgICAgICAgIGZpcnN0SW5kZXggKyBpO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5zdGFuY2UgdGhlIGFjdGlvbiBpbnN0YW5jZSBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0XG4gICAgICAgIHZhciBuZXdBY3Rpb25JbnN0YW5jZSA9IG5ldyBBcnJheUNyZWF0ZSggbmV3T2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgICAgIGFjdGlvbnMucHVzaCggbmV3QWN0aW9uSW5zdGFuY2UgKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGFjdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5Q3JlYXRlO1xuIiwiLyogXG4gICAgQ2xhc3MgQXJyYXlEZWxldGVcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0QXJyYXlBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdEFycmF5QWN0aW9uLmpzJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uLy4uL3V0aWxzLmpzJyApO1xudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uLy4uL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMnICk7XG52YXIgbm9kZVJlbW92ZXIgPSByZXF1aXJlKCAnLi4vbm9kZVJlbW92ZXIuanMnICk7XG5cbnZhciBBcnJheURlbGV0ZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RBcnJheUFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbn07XG5cbkFycmF5RGVsZXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlICk7XG5cbkFycmF5RGVsZXRlLnByb3RvdHlwZS51cGRhdGVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcblxuICAgIHRoaXMuaW5kZXhUb1VzZSA9IHRoaXMuZ2V0SW5kZXhUb1VzZSggZGljdGlvbmFyeSApO1xuICAgIHZhciBhcnJheVZhbHVlID0gdGhpcy5nZXRWYWx1ZSggZGljdGlvbmFyeSApO1xuICAgIGFycmF5VmFsdWUuc3BsaWNlKCB0aGlzLmluZGV4VG9Vc2UsIDEgKTtcbn07XG5cbkFycmF5RGVsZXRlLnByb3RvdHlwZS51cGRhdGVIVE1MID0gZnVuY3Rpb24oIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciwgYWN0aW9uSW5zdGFuY2UsIGNvbnRpbnVlRGF0YSApe1xuICAgIFxuICAgIC8vIE11c3QgZ2V0IHRoZSBub2RlVG9VcGRhdGVcbiAgICB2YXIgbm9kZVRvRGVsZXRlID0gdGhpcy5yZXNvbHZlQ2hpbGROb2RlKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIgKTtcbiAgICBpZiAoICEgbm9kZVRvRGVsZXRlICl7XG4gICAgICAgIHRocm93ICdObyBub2RlIGZvdW5kIHRvIGJlIGRlbGV0ZWQgYXQgdGhpcyBpbmRleDogJyArIHRoaXMuaW5kZXhUb1VzZTtcbiAgICB9XG4gICAgXG4gICAgLy8gUnVuIGFuaW1hdGlvblxuICAgIHBhcnNlclVwZGF0ZXIucnVuQW5pbWF0aW9uKCBcbiAgICAgICAgYWN0aW9uSW5zdGFuY2UsIFxuICAgICAgICBub2RlVG9EZWxldGUsIFxuICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBSZW1vdmUgdGhlIHNlbGVjdGVkIG5vZGUgZnJvbSB0aGUgaW5kZXggYW5kIGZyb20gSFRNTFxuICAgICAgICAgICAgLy9hdHRyaWJ1dGVJbmRleC5yZW1vdmVOb2RlKCBub2RlVG9EZWxldGUgKTsgXG4gICAgICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVOb2RlKCBub2RlVG9EZWxldGUgKTtcbiAgICAgICAgICAgIC8vVE9ETyB1cGRhdGUgbmV4dCBzaWJsaW5ncz9cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQ29udGludWVcbiAgICAgICAgICAgIHBhcnNlclVwZGF0ZXIuY29udGludWVVcGRhdGVIVE1MKCBjb250aW51ZURhdGEgKTtcbiAgICAgICAgfSBcbiAgICApO1xuICAgIFxuICAgIC8vcmV0dXJuIHRydWU7XG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuQXJyYXlEZWxldGUuYnVpbGRNdWx0aXBsZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKXtcblxuICAgIHZhciBhY3Rpb25zID0gW107XG4gICAgdmFyIHByb3BlcnR5ID0gb2JqZWN0LmluZGV4PyAnaW5kZXgnOiAnY3VycmVudEVsZW1lbnQnO1xuXG4gICAgLy8gQ29weSBpbmRleGVzIHRvIGEgbmV3IGFycmF5XG4gICAgdmFyIGFsbEl0ZW1zID0gdXRpbHMuY29weUFycmF5KCBvYmplY3RbIHByb3BlcnR5IF0gKTtcbiAgICBcbiAgICAvLyBCdWlsZCBhY3Rpb25zIGxpc3RcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBhbGxJdGVtcy5sZW5ndGg7ICsraSApe1xuICAgICAgICB2YXIgaXRlbSA9IGFsbEl0ZW1zWyBpIF07XG4gICAgICAgIFxuICAgICAgICAvLyBDbG9uZSB0aGUgb2JqZWN0IGFuZCBjb25maWd1cmUgdGhlIGluZGV4XG4gICAgICAgIHZhciBuZXdPYmplY3QgPSB1dGlscy5kZWVwRXh0ZW5kKCBvYmplY3QgKTtcbiAgICAgICAgbmV3T2JqZWN0WyBwcm9wZXJ0eSBdID0gaXRlbTtcbiAgICAgICAgXG4gICAgICAgIC8vIEluc3RhbmNlIHRoZSBhY3Rpb24gaW5zdGFuY2UgYW5kIGFkZCBpdCB0byB0aGUgbGlzdFxuICAgICAgICB2YXIgbmV3QWN0aW9uSW5zdGFuY2UgPSBuZXcgQXJyYXlEZWxldGUoIG5ld09iamVjdCwgZGljdGlvbmFyeSApO1xuICAgICAgICBuZXdBY3Rpb25JbnN0YW5jZS5pbmRleCA9IG5ld0FjdGlvbkluc3RhbmNlLmdldEluZGV4VG9Vc2UoIGRpY3Rpb25hcnkgKTtcbiAgICAgICAgYWN0aW9ucy5wdXNoKCBuZXdBY3Rpb25JbnN0YW5jZSApO1xuICAgIH1cbiAgICBcbiAgICAvLyBTb3J0IGFjdGlvbnNcbiAgICBhY3Rpb25zLnNvcnQoXG4gICAgICAgIGZ1bmN0aW9uKCBhLCBiICl7IHJldHVybiBiLmluZGV4IC0gYS5pbmRleDsgfVxuICAgICk7XG4gICAgXG4gICAgcmV0dXJuIGFjdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5RGVsZXRlO1xuIiwiLyogXG4gICAgQ2xhc3MgQXJyYXlVcGRhdGVcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0QXJyYXlBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdEFycmF5QWN0aW9uLmpzJyApO1xuXG52YXIgQXJyYXlVcGRhdGUgPSBmdW5jdGlvbiggb2JqZWN0LCBkaWN0aW9uYXJ5ICkge1xuICAgIEFic3RyYWN0QXJyYXlBY3Rpb24uY2FsbCggdGhpcywgb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgXG4gICAgdGhpcy5uZXdFbGVtZW50ID0gb2JqZWN0Lm5ld0VsZW1lbnQ7XG59O1xuXG5BcnJheVVwZGF0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBBYnN0cmFjdEFycmF5QWN0aW9uLnByb3RvdHlwZSApO1xuXG5BcnJheVVwZGF0ZS5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgXG4gICAgdGhpcy5pbmRleFRvVXNlID0gdGhpcy5nZXRJbmRleFRvVXNlKCBkaWN0aW9uYXJ5ICk7XG4gICAgdmFyIGFycmF5VmFsdWUgPSB0aGlzLmdldFZhbHVlKCBkaWN0aW9uYXJ5ICk7XG4gICAgYXJyYXlWYWx1ZVsgdGhpcy5pbmRleFRvVXNlIF0gPSB0aGlzLm5ld0VsZW1lbnQ7XG59O1xuXG5BcnJheVVwZGF0ZS5wcm90b3R5cGUudXBkYXRlSFRNTCA9IGZ1bmN0aW9uKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIsIGFjdGlvbkluc3RhbmNlICl7XG4gICAgXG4gICAgLy8gTXVzdCBnZXQgdGhlIG5vZGVUb1VwZGF0ZVxuICAgIHZhciBub2RlVG9VcGRhdGUgPSB0aGlzLnJlc29sdmVDaGlsZE5vZGUoIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciApO1xuICAgIGlmICggISBub2RlVG9VcGRhdGUgKXtcbiAgICAgICAgdGhyb3cgJ05vIG5vZGUgZm91bmQgdG8gYmUgdXBkYXRlZCBhdCB0aGlzIGluZGV4OiAnICsgdGhpcy5pbmRleFRvVXNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBVcGRhdGUgdGhlIHNlbGVjdGVkIG5vZGVcbiAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIG5vZGVUb1VwZGF0ZSwgdHJ1ZSApO1xuICAgIFxuICAgIC8vIFJ1biBhbmltYXRpb25cbiAgICBwYXJzZXJVcGRhdGVyLnJ1bkFuaW1hdGlvbiggYWN0aW9uSW5zdGFuY2UsIG5vZGVUb1VwZGF0ZSApO1xuICAgIFxuICAgIHJldHVybiB0cnVlO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBBcnJheVVwZGF0ZTtcbiIsIi8qIFxyXG4gICAgQ2xhc3MgQ1NTQW5pbWF0aW9uTWFuYWdlciBcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgdmFyIGFuaW1hdGUgPSBmdW5jdGlvbiggZGljdGlvbmFyeUFjdGlvbiwgbm9kZSwgY2FsbGJhY2sgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUnVuIGNhbGxiYWNrIGFuZCByZXR1cm4gaWYgdGhlcmUgaXMgbm8gYW5pbWF0aW9uXHJcbiAgICAgICAgaWYgKCAhIGRpY3Rpb25hcnlBY3Rpb24uYW5pbWF0aW9uICl7XHJcbiAgICAgICAgICAgIGlmICggY2FsbGJhY2sgKXtcclxuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gU2V0IHRoZSBhbmltYXRpb25cclxuICAgICAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9ICdub25lJztcclxuICAgICAgICBzZXRUaW1lb3V0KFxyXG4gICAgICAgICAgICBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIC8vIFNldCB0aGUgYW5pbWF0aW9uZW5kIGxpc3RlbmVyXHJcbiAgICAgICAgICAgICAgICB2YXIgYW5pbWF0aW9uZW5kQ2FsbGJhY2sgPSBmdW5jdGlvbiggZXZlbnQgKXtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoIGNhbGxiYWNrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgICAgIC8vbm9kZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgYW5pbWF0aW9uZW5kQ2FsbGJhY2sgKTtcclxuICAgICAgICAgICAgICAgIG5vZGUuYWRkRXZlbnRMaXN0ZW5lciggJ2FuaW1hdGlvbmVuZCcsIGFuaW1hdGlvbmVuZENhbGxiYWNrICk7XHJcblxyXG4gICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBhbmltYXRpb25cclxuICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gZGljdGlvbmFyeUFjdGlvbi5hbmltYXRpb247XHJcbiAgICAgICAgICAgIH0sIFxyXG4gICAgICAgICAgICAxMFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVzZXQgPSBmdW5jdGlvbiggbm9kZSApIHtcclxuICAgICAgICBub2RlLnN0eWxlLmFuaW1hdGlvbiA9ICdub25lJztcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIGFuaW1hdGU6IGFuaW1hdGUsXHJcbiAgICAgICAgcmVzZXQ6IHJlc2V0XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufSkoKTtcclxuIiwiLyogXHJcbiAgICBDbGFzcyBkaWN0aW9uYXJ5QWN0aW9uQnVpbGRlciBcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgQXJyYXlVcGRhdGUgPSByZXF1aXJlKCAnLi9hcnJheVVwZGF0ZS5qcycgKTtcclxudmFyIEFycmF5RGVsZXRlID0gcmVxdWlyZSggJy4vYXJyYXlEZWxldGUuanMnICk7XHJcbnZhciBBcnJheUNyZWF0ZSA9IHJlcXVpcmUoICcuL2FycmF5Q3JlYXRlLmpzJyApO1xyXG52YXIgT2JqZWN0VXBkYXRlID0gcmVxdWlyZSggJy4vb2JqZWN0VXBkYXRlLmpzJyApO1xyXG52YXIgT2JqZWN0RGVsZXRlID0gcmVxdWlyZSggJy4vb2JqZWN0RGVsZXRlLmpzJyApO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgc3dpdGNoICggb2JqZWN0LmFjdGlvbiApIHtcclxuICAgICAgICBjYXNlICd1cGRhdGVBcnJheSc6XHJcbiAgICAgICAgICAgIHJldHVybiBuZXcgQXJyYXlVcGRhdGUoIG9iamVjdCwgZGljdGlvbmFyeSApO1xyXG4gICAgICAgIGNhc2UgJ2RlbGV0ZUFycmF5JzpcclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoIG9iamVjdC5pbmRleCApIHx8IEFycmF5LmlzQXJyYXkoIG9iamVjdC5jdXJyZW50RWxlbWVudCApPyBcclxuICAgICAgICAgICAgICAgIEFycmF5RGVsZXRlLmJ1aWxkTXVsdGlwbGUoIG9iamVjdCwgZGljdGlvbmFyeSApOlxyXG4gICAgICAgICAgICAgICAgbmV3IEFycmF5RGVsZXRlKCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcclxuICAgICAgICBjYXNlICdjcmVhdGVBcnJheSc6XHJcbiAgICAgICAgICAgIHJldHVybiBBcnJheS5pc0FycmF5KCBvYmplY3QubmV3RWxlbWVudCApPyBcclxuICAgICAgICAgICAgICAgIEFycmF5Q3JlYXRlLmJ1aWxkTXVsdGlwbGUoIG9iamVjdCwgZGljdGlvbmFyeSApOlxyXG4gICAgICAgICAgICAgICAgbmV3IEFycmF5Q3JlYXRlKCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcclxuICAgICAgICBjYXNlICd1cGRhdGVPYmplY3QnOlxyXG4gICAgICAgICAgICByZXR1cm4gb2JqZWN0LmVkaXRlZFByb3BlcnRpZXMgfHwgb2JqZWN0LmRlbGV0ZWRQcm9wZXJ0aWVzP1xyXG4gICAgICAgICAgICAgICAgT2JqZWN0VXBkYXRlLmJ1aWxkTXVsdGlwbGUoIG9iamVjdCwgZGljdGlvbmFyeSApOlxyXG4gICAgICAgICAgICAgICAgbmV3IE9iamVjdFVwZGF0ZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XHJcbiAgICAgICAgY2FzZSAnZGVsZXRlT2JqZWN0JzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBPYmplY3REZWxldGUoIG9iamVjdCwgZGljdGlvbmFyeSApO1xyXG4gICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHRocm93ICdVbmtub3duIGRpY3Rpb25hcnkgYWN0aW9uOiAnICsgb2JqZWN0LmFjdGlvbjtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuICAgICAgICBidWlsZDogYnVpbGRcclxuICAgIH07XHJcbiAgICBcclxuICAgIHJldHVybiBzZWxmO1xyXG59KSgpO1xyXG4iLCIvKiBcbiAgICBDbGFzcyBPYmplY3REZWxldGVcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0T2JqZWN0QWN0aW9uID0gcmVxdWlyZSggJy4vYWJzdHJhY3RPYmplY3RBY3Rpb24uanMnICk7XG5cbnZhciBPYmplY3REZWxldGUgPSBmdW5jdGlvbiggb2JqZWN0LCBkaWN0aW9uYXJ5ICkge1xuICAgIEFic3RyYWN0T2JqZWN0QWN0aW9uLmNhbGwoIHRoaXMsIG9iamVjdCwgZGljdGlvbmFyeSApO1xufTtcblxuT2JqZWN0RGVsZXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEFic3RyYWN0T2JqZWN0QWN0aW9uLnByb3RvdHlwZSApO1xuXG5PYmplY3REZWxldGUucHJvdG90eXBlLnVwZGF0ZURpY3Rpb25hcnkgPSBmdW5jdGlvbiggZGljdGlvbmFyeSApe1xuICAgIFxuICAgIHZhciBvYmplY3RWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoIGRpY3Rpb25hcnkgKTtcbiAgICBkZWxldGUgb2JqZWN0VmFsdWVbIHRoaXMucHJvcGVydHkgXTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gT2JqZWN0RGVsZXRlO1xuIiwiLyogXG4gICAgQ2xhc3MgT2JqZWN0VXBkYXRlXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBBYnN0cmFjdE9iamVjdEFjdGlvbiA9IHJlcXVpcmUoICcuL2Fic3RyYWN0T2JqZWN0QWN0aW9uLmpzJyApO1xudmFyIE9iamVjdERlbGV0ZSA9IHJlcXVpcmUoICcuL29iamVjdERlbGV0ZS5qcycgKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi8uLi91dGlscy5qcycgKTtcblxudmFyIE9iamVjdFVwZGF0ZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RPYmplY3RBY3Rpb24uY2FsbCggdGhpcywgb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgXG4gICAgdGhpcy5uZXdFbGVtZW50ID0gb2JqZWN0Lm5ld0VsZW1lbnQ7XG59O1xuXG5PYmplY3RVcGRhdGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQWJzdHJhY3RPYmplY3RBY3Rpb24ucHJvdG90eXBlICk7XG5cbk9iamVjdFVwZGF0ZS5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgXG4gICAgdmFyIG9iamVjdFZhbHVlID0gdGhpcy5nZXRWYWx1ZSggZGljdGlvbmFyeSApO1xuICAgIG9iamVjdFZhbHVlWyB0aGlzLnByb3BlcnR5IF0gPSB0aGlzLm5ld0VsZW1lbnQ7XG59O1xuXG5PYmplY3RVcGRhdGUuYnVpbGRNdWx0aXBsZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKXtcblxuICAgIHZhciBhY3Rpb25zID0gW107XG4gICAgdmFyIGNsb25lZE9iamVjdCA9IHV0aWxzLmRlZXBFeHRlbmQoIG9iamVjdCApO1xuICAgIFxuICAgIC8vIENvcHkgZWRpdGVkUHJvcGVydGllcyBhbmQgZGVsZXRlZFByb3BlcnRpZXNcbiAgICB2YXIgZWRpdGVkUHJvcGVydGllcyA9IGNsb25lZE9iamVjdC5lZGl0ZWRQcm9wZXJ0aWVzO1xuICAgIHZhciBkZWxldGVkUHJvcGVydGllcyA9IGNsb25lZE9iamVjdC5kZWxldGVkUHJvcGVydGllcztcbiAgICBcbiAgICAvLyBEZWxldGUgdGhlbVxuICAgIGRlbGV0ZSBjbG9uZWRPYmplY3QuZWRpdGVkUHJvcGVydGllcztcbiAgICBkZWxldGUgY2xvbmVkT2JqZWN0LmRlbGV0ZWRQcm9wZXJ0aWVzO1xuICAgICAgICBcbiAgICAvLyBCdWlsZCBhY3Rpb25zIGxpc3QgZm9yIGVkaXRlZFByb3BlcnRpZXNcbiAgICBpZiAoIGVkaXRlZFByb3BlcnRpZXMgKXtcbiAgICAgICAgY2xvbmVkT2JqZWN0LmFjdGlvbiA9ICd1cGRhdGVPYmplY3QnO1xuICAgICAgICBmb3IgKCB2YXIgZWRpdGVkUHJvcGVydGllc0lkIGluIGVkaXRlZFByb3BlcnRpZXMgKXtcbiAgICAgICAgICAgIHZhciBlZGl0ZWRQcm9wZXJ0aWVzVmFsdWUgPSBlZGl0ZWRQcm9wZXJ0aWVzWyBlZGl0ZWRQcm9wZXJ0aWVzSWQgXTtcblxuICAgICAgICAgICAgLy8gQ2xvbmUgdGhlIG9iamVjdCBhbmQgY29uZmlndXJlIHByb3BlcnR5IGFuZCBuZXdFbGVtZW50XG4gICAgICAgICAgICB2YXIgbmV3T2JqZWN0ID0gdXRpbHMuZGVlcEV4dGVuZCggY2xvbmVkT2JqZWN0ICk7XG4gICAgICAgICAgICBuZXdPYmplY3QucHJvcGVydHkgPSBlZGl0ZWRQcm9wZXJ0aWVzSWQ7XG4gICAgICAgICAgICBuZXdPYmplY3QubmV3RWxlbWVudCA9IGVkaXRlZFByb3BlcnRpZXNWYWx1ZTtcblxuICAgICAgICAgICAgLy8gSW5zdGFuY2UgdGhlIGFjdGlvbiBpbnN0YW5jZSBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0XG4gICAgICAgICAgICB2YXIgbmV3QWN0aW9uSW5zdGFuY2UgPSBuZXcgT2JqZWN0VXBkYXRlKCBuZXdPYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICAgICAgICAgIGFjdGlvbnMucHVzaCggbmV3QWN0aW9uSW5zdGFuY2UgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBCdWlsZCBhY3Rpb25zIGxpc3QgZm9yIGRlbGV0ZWRQcm9wZXJ0aWVzXG4gICAgaWYgKCBkZWxldGVkUHJvcGVydGllcyApe1xuICAgICAgICBjbG9uZWRPYmplY3QuYWN0aW9uID0gJ2RlbGV0ZU9iamVjdCc7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGRlbGV0ZWRQcm9wZXJ0aWVzLmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICB2YXIgZGVsZXRlZFByb3BlcnRpZXNJdGVtID0gZGVsZXRlZFByb3BlcnRpZXNbIGkgXTtcblxuICAgICAgICAgICAgLy8gQ2xvbmUgdGhlIG9iamVjdCBhbmQgY29uZmlndXJlIHByb3BlcnR5XG4gICAgICAgICAgICBuZXdPYmplY3QgPSB1dGlscy5kZWVwRXh0ZW5kKCBjbG9uZWRPYmplY3QgKTtcbiAgICAgICAgICAgIG5ld09iamVjdC5wcm9wZXJ0eSA9IGRlbGV0ZWRQcm9wZXJ0aWVzSXRlbTtcblxuICAgICAgICAgICAgLy8gSW5zdGFuY2UgdGhlIGFjdGlvbiBpbnN0YW5jZSBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0XG4gICAgICAgICAgICBuZXdBY3Rpb25JbnN0YW5jZSA9IG5ldyBPYmplY3REZWxldGUoIG5ld09iamVjdCwgZGljdGlvbmFyeSApO1xuICAgICAgICAgICAgYWN0aW9ucy5wdXNoKCBuZXdBY3Rpb25JbnN0YW5jZSApO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBhY3Rpb25zO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3RVcGRhdGU7XG4iLCIvKiBcbiAgICBDbGFzcyBMb29wIFxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQXV0b0RlZmluZUhlbHBlciA9IHJlcXVpcmUoICcuL2F1dG9EZWZpbmVIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuXG52YXIgTG9vcCA9IGZ1bmN0aW9uICggX2l0ZW1WYXJpYWJsZU5hbWUsIF9leHByZXNzaW9uU3RyaW5nLCBzY29wZSApIHtcbiAgICBcbiAgICB2YXIgaXRlbVZhcmlhYmxlTmFtZSA9IF9pdGVtVmFyaWFibGVOYW1lO1xuICAgIHZhciBleHByZXNzaW9uU3RyaW5nID0gX2V4cHJlc3Npb25TdHJpbmc7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggZXhwcmVzc2lvblN0cmluZyApO1xuICAgIHZhciBnZXRFeHByZXNzaW9uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb247XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaXRlbXMgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgIHZhciBnZXRJdGVtcyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9O1xuICAgIFxuICAgIHZhciBjdXJyZW50SW5kZXggPSAtMTtcbiAgICB2YXIgbWF4SW5kZXggPSBpdGVtcz8gaXRlbXMubGVuZ3RoIC0gMTogLTE7XG4gICAgXG4gICAgdmFyIG9mZnNldCA9IDA7XG4gICAgdmFyIHNldE9mZnNldCA9IGZ1bmN0aW9uKCBfb2Zmc2V0ICl7XG4gICAgICAgIG9mZnNldCA9IF9vZmZzZXQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVwZWF0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggY3VycmVudEluZGV4KysgPCBtYXhJbmRleCApIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIExvb3AuYnVpbGRBdXRvRGVmaW5lSGVscGVyKCBcbiAgICAgICAgICAgICAgICBpdGVtVmFyaWFibGVOYW1lLCBcbiAgICAgICAgICAgICAgICBjdXJyZW50SW5kZXgsIFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb25TdHJpbmcsIFxuICAgICAgICAgICAgICAgIGl0ZW1zLmxlbmd0aCwgXG4gICAgICAgICAgICAgICAgb2Zmc2V0IFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBzZXRPZmZzZXQ6IHNldE9mZnNldCxcbiAgICAgICAgcmVwZWF0OnJlcGVhdCxcbiAgICAgICAgZ2V0SXRlbXM6IGdldEl0ZW1zLFxuICAgICAgICBnZXRFeHByZXNzaW9uOiBnZXRFeHByZXNzaW9uXG4gICAgfTtcbn07XG5cbkxvb3AuYnVpbGRBdXRvRGVmaW5lSGVscGVyID0gZnVuY3Rpb24oIGl0ZW1WYXJpYWJsZU5hbWUsIGl0ZW1JbmRleCwgZXhwcmVzc2lvblN0cmluZywgbnVtYmVyT2ZJdGVtcywgb2Zmc2V0ICl7XG4gICAgXG4gICAgdmFyIGF1dG9EZWZpbmVIZWxwZXIgPSBuZXcgQXV0b0RlZmluZUhlbHBlcigpO1xuXG4gICAgLy8gRGVjbGFyZSBpdGVtLWluZGV4LCBpdGVtLWFsbCwgaXRlbSBhbmQgaXRlbS1yZXBlYXQgdmFyaWFibGVzXG4gICAgYXV0b0RlZmluZUhlbHBlci5wdXQoXG4gICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLWluZGV4JyxcbiAgICAgICAgaXRlbUluZGV4XG4gICAgKTtcbiAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgaXRlbVZhcmlhYmxlTmFtZSArICctYWxsJyxcbiAgICAgICAgZXhwcmVzc2lvblN0cmluZ1xuICAgICk7XG4gICAgYXV0b0RlZmluZUhlbHBlci5wdXQoXG4gICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUsXG4gICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLWFsbCcgKyAnWycgKyBpdGVtVmFyaWFibGVOYW1lICsgJy1pbmRleCcgKyAnXSdcbiAgICApO1xuICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KFxuICAgICAgICBpdGVtVmFyaWFibGVOYW1lICsgJy1yZXBlYXQnLFxuICAgICAgICBcImNvbnRleHQvcmVwZWF0KFwiIFxuICAgICAgICAgICAgKyBpdGVtVmFyaWFibGVOYW1lICsgXCItaW5kZXhcIiArIFwiLFwiXG4gICAgICAgICAgICArIG51bWJlck9mSXRlbXMgKyBcIixcIlxuICAgICAgICAgICAgKyBvZmZzZXRcbiAgICAgICAgICAgICsgXCIpXCJcbiAgICApO1xuXG4gICAgcmV0dXJuIGF1dG9EZWZpbmVIZWxwZXI7XG59O1xuXG5Mb29wLnNldEF1dG9EZWZpbmVBdHRyaWJ1dGUgPSBmdW5jdGlvbiggbm9kZSwgaXRlbVZhcmlhYmxlTmFtZSwgaXRlbUluZGV4LCBleHByZXNzaW9uU3RyaW5nLCBudW1iZXJPZkl0ZW1zLCBvZmZzZXQgKXtcbiAgICBcbiAgICAvLyBTZXQgaXRlbS1pbmRleCwgaXRlbS1hbGwsIGl0ZW0gYW5kIGl0ZW0tcmVwZWF0IGF0dHJpYnV0ZXNcbiAgICBub2RlLnNldEF0dHJpYnV0ZSggXG4gICAgICAgIGNvbnRleHQuZ2V0VGFncygpLnRhbEF1dG9EZWZpbmUsXG4gICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLWluZGV4ICcgKyBpdGVtSW5kZXggKyAnOydcbiAgICAgICAgICAgICsgaXRlbVZhcmlhYmxlTmFtZSArICctYWxsICcgKyBleHByZXNzaW9uU3RyaW5nICsgJzsnXG4gICAgICAgICAgICArIGl0ZW1WYXJpYWJsZU5hbWUgKyAnICcgKyBpdGVtVmFyaWFibGVOYW1lICsnLWFsbFsnICsgaXRlbVZhcmlhYmxlTmFtZSArICctaW5kZXhdOydcbiAgICAgICAgICAgICsgaXRlbVZhcmlhYmxlTmFtZSArICctcmVwZWF0IGNvbnRleHQvcmVwZWF0KCcgKyBpdGVtVmFyaWFibGVOYW1lICsgJy1pbmRleCwnICsgbnVtYmVyT2ZJdGVtcyArICcsJyArIG9mZnNldCArICcpJ1xuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IExvb3A7XG4iLCIvKiBcbiAgICBDbGFzcyBMb29wSXRlbVxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgTG9vcEl0ZW0gPSBmdW5jdGlvbiAoIF9jdXJyZW50SW5kZXgsIF9pdGVtc0xlbmd0aCwgX29mZnNldCApIHtcbiAgICBcbiAgICB0aGlzLmN1cnJlbnRJbmRleCA9IF9jdXJyZW50SW5kZXg7XG4gICAgdGhpcy5pdGVtc0xlbmd0aCA9IF9pdGVtc0xlbmd0aDtcbiAgICB0aGlzLm9mZnNldCA9IF9vZmZzZXQ7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbiggKSB7XG4gICAgcmV0dXJuIHRoaXMub2Zmc2V0ICsgdGhpcy5jdXJyZW50SW5kZXg7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUubnVtYmVyID0gZnVuY3Rpb24oICkge1xuICAgIHJldHVybiB0aGlzLmluZGV4KCkgKyAxO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLmV2ZW4gPSBmdW5jdGlvbiggKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5kZXgoKSAlIDIgPT09IDA7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUub2RkID0gZnVuY3Rpb24gKCApIHtcbiAgICByZXR1cm4gdGhpcy5pbmRleCgpICUgMiA9PT0gMTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uICggKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5kZXgoKSA9PT0gMDtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5lbmQgPSBmdW5jdGlvbiAoICkge1xuICAgIHJldHVybiB0aGlzLmN1cnJlbnRJbmRleCA9PT0gdGhpcy5pdGVtc0xlbmd0aCAtIDE7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUubGVuZ3RoID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLm9mZnNldCArIHRoaXMuaXRlbXNMZW5ndGg7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUubGV0dGVyID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZvcm1hdExldHRlciggdGhpcy5pbmRleCgpLCAnYScgKTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5MZXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0TGV0dGVyKCB0aGlzLmluZGV4KCksICdBJyApO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLmZvcm1hdExldHRlciA9IGZ1bmN0aW9uICggaWksIHN0YXJ0Q2hhciApIHtcbiAgICB2YXIgaSA9IGlpO1xuICAgIHZhciBidWZmZXIgPSAnJztcbiAgICB2YXIgc3RhcnQgPSBzdGFydENoYXIuY2hhckNvZGVBdCggMCApOyBcbiAgICB2YXIgZGlnaXQgPSBpICUgMjY7XG4gICAgYnVmZmVyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoIHN0YXJ0ICsgZGlnaXQgKTtcblxuICAgIHdoaWxlKCBpID4gMjUgKSB7XG4gICAgICAgIGkgLz0gMjY7XG4gICAgICAgIGRpZ2l0ID0gKGkgLSAxICkgJSAyNjtcbiAgICAgICAgYnVmZmVyICs9IFN0cmluZy5mcm9tQ2hhckNvZGUoIHN0YXJ0ICsgZGlnaXQgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmZmVyLnNwbGl0KCcnKS5yZXZlcnNlKCkuam9pbignJyk7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUucm9tYW4gPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0Um9tYW4oIHRoaXMuaW5kZXgoKSArIDEsIDAgKTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5Sb21hbiA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtYXRSb21hbiggdGhpcy5pbmRleCgpICsgMSwgMSApO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLmZvcm1hdFJvbWFuID0gZnVuY3Rpb24gKCBubiwgY2FwaXRhbCApIHtcbiAgICB2YXIgbiA9IG5uO1xuXG4gICAgLy8gQ2FuJ3QgcmVwcmVzZW50IGFueSBudW1iZXIgNDAwMCBvciBncmVhdGVyXG4gICAgaWYgKCBuID49IDQwMDAgKSB7XG4gICAgICAgIHJldHVybiAnT3ZlcmZsb3cgZm9ybWF0dGluZyByb21hbiEnO1xuICAgIH1cblxuICAgIHZhciBidWYgPSAnJztcbiAgICBmb3IgKCB2YXIgZGVjYWRlID0gMDsgbiAhPT0gMDsgZGVjYWRlKysgKSB7XG4gICAgICAgIHZhciBkaWdpdCA9IG4gJSAxMDtcbiAgICAgICAgaWYgKCBkaWdpdCA+IDAgKSB7XG4gICAgICAgICAgICBkaWdpdC0tO1xuICAgICAgICAgICAgYnVmICs9IHRoaXMucm9tYW5BcnJheSBbIGRlY2FkZSBdWyBkaWdpdCBdWyBjYXBpdGFsIF07XG4gICAgICAgIH1cbiAgICAgICAgbiA9IChuIC8gMTApID4+IDA7XG4gICAgfVxuXG4gICAgcmV0dXJuIGJ1Zi5zcGxpdCggJycgKS5yZXZlcnNlKCkuam9pbiggJycgKTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5yb21hbkFycmF5ID0gW1xuICAgIC8qIE9uZSdzIHBsYWNlICovXG4gICAgW1xuICAgICAgICBbIFwiaVwiLCBcIklcIiBdLFxuICAgICAgICBbIFwiaWlcIiwgXCJJSVwiIF0sIFxuICAgICAgICBbIFwiaWlpXCIsIFwiSUlJXCIgXSxcbiAgICAgICAgWyBcInZpXCIsIFwiVklcIiBdLFxuICAgICAgICBbIFwidlwiLCBcIlZcIiBdLFxuICAgICAgICBbIFwiaXZcIiwgXCJJVlwiIF0sXG4gICAgICAgIFsgXCJpaXZcIiwgXCJJSVZcIiBdLFxuICAgICAgICBbIFwiaWlpdlwiLCBcIklJSVZcIiBdLFxuICAgICAgICBbIFwieGlcIiwgXCJYSVwiIF1cbiAgICBdLFxuXG4gICAgLyogMTAncyBwbGFjZSAqL1xuICAgIFtcbiAgICAgICAgWyBcInhcIiwgXCJYXCIgXSxcbiAgICAgICAgWyBcInh4XCIsIFwiWFhcIiBdLFxuICAgICAgICBbIFwieHh4XCIsIFwiWFhYXCIgXSxcbiAgICAgICAgWyBcImx4XCIsIFwiTFhcIiBdLFxuICAgICAgICBbIFwibFwiLCBcIkxcIiBdLFxuICAgICAgICBbIFwieGxcIiwgXCJYTFwiIF0sXG4gICAgICAgIFsgXCJ4eGxcIiwgXCJYWExcIiBdLFxuICAgICAgICBbIFwieHh4bFwiLCBcIlhYWExcIiBdLFxuICAgICAgICBbIFwiY3hcIiwgXCJDWFwiIF1cbiAgICBdLFxuXG4gICAgLyogMTAwJ3MgcGxhY2UgKi9cbiAgICBbXG4gICAgICAgIFsgXCJjXCIsIFwiQ1wiIF0sXG4gICAgICAgIFsgXCJjY1wiLCBcIkNDXCIgXSxcbiAgICAgICAgWyBcImNjY1wiLCBcIkNDQ1wiIF0sXG4gICAgICAgIFsgXCJkY1wiLCBcIkRDXCIgXSxcbiAgICAgICAgWyBcImRcIiwgXCJEXCIgXSxcbiAgICAgICAgWyBcImNkXCIsIFwiQ0RcIiBdLFxuICAgICAgICBbIFwiY2NkXCIsIFwiQ0NEXCIgXSxcbiAgICAgICAgWyBcImNjY2RcIiwgXCJDQ0NEXCIgXSxcbiAgICAgICAgWyBcIm1jXCIsIFwiTUNcIiBdXG4gICAgXSxcblxuICAgIC8qIDEwMDAncyBwbGFjZSAqL1xuICAgIFtcbiAgICAgICAgWyBcIm1cIiwgXCJNXCIgXSxcbiAgICAgICAgWyBcIm1tXCIsIFwiTU1cIiBdLFxuICAgICAgICBbIFwibW1tXCIsIFwiTU1NXCIgXVxuICAgIF1cbl07XG5cbm1vZHVsZS5leHBvcnRzID0gTG9vcEl0ZW07XG4iLCIvKiBcbiAgICBDbGFzcyBOb2RlQXR0cmlidXRlcyBcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcblxudmFyIE5vZGVBdHRyaWJ1dGVzID0gZnVuY3Rpb24oIG5vZGUsIGluZGV4RXhwcmVzc2lvbnMgKSB7XG4gICAgXG4gICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcbiAgICBcbiAgICAvLyB0YWwgbmFtZXNwYWNlXG4gICAgdGhpcy50YWxEZWZpbmUgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxEZWZpbmUgKTtcbiAgICB0aGlzLnRhbENvbmRpdGlvbiA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbENvbmRpdGlvbiApO1xuICAgIHRoaXMudGFsUmVwZWF0ID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsUmVwZWF0ICk7XG4gICAgdGhpcy50YWxDb250ZW50ID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsQ29udGVudCApO1xuICAgIHRoaXMudGFsQXR0cmlidXRlcyA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbEF0dHJpYnV0ZXMgKTtcbiAgICB0aGlzLnRhbE9taXRUYWcgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxPbWl0VGFnICk7XG4gICAgdGhpcy50YWxSZXBsYWNlID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsUmVwbGFjZSApO1xuICAgIHRoaXMudGFsT25FcnJvciA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbE9uRXJyb3IgKTtcbiAgICB0aGlzLnRhbERlY2xhcmUgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxEZWNsYXJlICk7XG4gICAgLy90aGlzLnRhbFRhZyA9IHVuZGVmaW5lZDtcbiAgICBcbiAgICAvLyBtZXRhbCBuYW1lc3BhY2VcbiAgICB0aGlzLm1ldGFsRGVmaW5lTWFjcm8gPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5tZXRhbERlZmluZU1hY3JvICk7XG4gICAgdGhpcy5tZXRhbFVzZU1hY3JvID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MubWV0YWxVc2VNYWNybyApO1xuICAgIHRoaXMubWV0YWxEZWZpbmVTbG90ID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MubWV0YWxEZWZpbmVTbG90ICk7XG4gICAgdGhpcy5tZXRhbEZpbGxTbG90ID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MubWV0YWxGaWxsU2xvdCApO1xuICAgIFxuICAgIC8vIGkxOG4gbmFtZXNwYWNlXG4gICAgdGhpcy5pMThuRG9tYWluID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaTE4bkRvbWFpbiApO1xuICAgIHRoaXMuaTE4bkxhbmd1YWdlID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaTE4bkxhbmd1YWdlICk7XG4gICAgXG4gICAgLy8gRm9yIGludGVybmFsIHVzZVxuICAgIHRoaXMucWR1cCA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnFkdXAgKTtcbiAgICBcbiAgICAvLyBJbml0IHRoaXMuaWQgYW5kIHNldCB0aGUgbm9kZSBpZCBpZiBpbmRleEV4cHJlc3Npb25zIGlzIHRydWUsIHNvbWUgYXR0cmlidXRlIGlzIHNldCBhbmQgaXQgaXMgdW5kZWZpbmVkXG4gICAgaWYgKCBpbmRleEV4cHJlc3Npb25zICYmIHRoaXMuaXNEeW5hbWljQ29udGVudE9uKCkgKXtcbiAgICAgICAgdGhpcy5pZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLmlkICk7XG4gICAgICAgIGlmICggISB0aGlzLmlkICl7XG4gICAgICAgICAgICAvL3RoaXMuaWQgPSB1dGlscy5nZW5lcmF0ZUlkKCA2ICk7XG4gICAgICAgICAgICB0aGlzLmlkID0gY29udGV4dC5uZXh0RXhwcmVzc2lvbkNvdW50ZXIoKTtcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCB0YWdzLmlkLCB0aGlzLmlkICk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5Ob2RlQXR0cmlidXRlcy5wcm90b3R5cGUuaXNEeW5hbWljQ29udGVudE9uID0gZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgcmV0dXJuIHRoaXMudGFsRGVmaW5lIFxuICAgICAgICB8fCB0aGlzLnRhbENvbmRpdGlvblxuICAgICAgICB8fCB0aGlzLnRhbFJlcGVhdFxuICAgICAgICB8fCB0aGlzLnRhbENvbnRlbnRcbiAgICAgICAgfHwgdGhpcy50YWxBdHRyaWJ1dGVzXG4gICAgICAgIHx8IHRoaXMudGFsT21pdFRhZyBcbiAgICAgICAgfHwgdGhpcy50YWxSZXBsYWNlXG4gICAgICAgIHx8IHRoaXMudGFsT25FcnJvclxuICAgICAgICB8fCB0aGlzLnRhbERlY2xhcmVcbiAgICAgICAgLy98fCB0aGlzLnRhbFRhZ1xuICAgICAgICAvL3x8IHRoaXMubWV0YWxEZWZpbmVNYWNybyBcbiAgICAgICAgfHwgdGhpcy5tZXRhbFVzZU1hY3JvIFxuICAgICAgICAvL3x8IHRoaXMubWV0YWxEZWZpbmVTbG90IFxuICAgICAgICB8fCB0aGlzLm1ldGFsRmlsbFNsb3QgXG4gICAgICAgIHx8IHRoaXMuaTE4bkRvbWFpblxuICAgICAgICB8fCB0aGlzLmkxOG5MYW5ndWFnZTtcbiAgICAgICAgLy98fCB0aGlzLnFkdXA7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE5vZGVBdHRyaWJ1dGVzO1xuIiwiLyogXHJcbiAgICBDbGFzcyBOb2RlUmVtb3ZlciBcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIHZhciB0YWdzID0gY29udGV4dC5nZXRUYWdzKCk7XHJcbiAgICBcclxuICAgIHZhciByZW1vdmVHZW5lcmF0ZWROb2RlcyA9IGZ1bmN0aW9uKCB0YXJnZXQgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSXMgbXVsdGlyb290P1xyXG4gICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggdGFyZ2V0ICkgKXsgXHJcbiAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBzZXZlcmFsIHJvb3RzXHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgICAgIGZvciAoIHZhciBjID0gMDsgYyA8IHRhcmdldC5sZW5ndGg7IGMrKyApIHtcclxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoIFxyXG4gICAgICAgICAgICAgICAgICAgIHJlbW92ZU5vZGVzKCB0YXJnZXRbIGMgXSApXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFRoZXJlIGlzIG9ubHkgb25lIHJvb3RcclxuICAgICAgICByZXR1cm4gcmVtb3ZlTm9kZXMoIHRhcmdldCApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHJlbW92ZU5vZGVzID0gZnVuY3Rpb24oIHRhcmdldCApIHtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggcmVtb3ZlTm9kZXNCeVRhZyggdGFyZ2V0LCB0YWdzLnFkdXAgKSApOyAgICAgICAvLyBSZW1vdmUgYWxsIGdlbmVyYXRlZCBub2RlcyAocmVwZWF0cylcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KCByZW1vdmVOb2Rlc0J5VGFnKCB0YXJnZXQsIHRhZ3MubWV0YWxNYWNybyApICk7IC8vIFJlbW92ZSBhbGwgZ2VuZXJhdGVkIG5vZGVzIChtYWNyb3MpXHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciByZW1vdmVOb2Rlc0J5VGFnID0gZnVuY3Rpb24oIHRhcmdldCwgdGFnICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGxpc3QgPSB0YXJnZXQucXVlcnlTZWxlY3RvckFsbCggXCIqW1wiICsgdGFnICsgXCJdXCIgKTtcclxuICAgICAgICByZXR1cm4gcmVtb3ZlTGlzdCggbGlzdCApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHJlbW92ZVJlbGF0ZWROb2RlcyA9IGZ1bmN0aW9uKCB0YXJnZXQgKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbGlzdCA9IHRhcmdldC5wYXJlbnROb2RlLnF1ZXJ5U2VsZWN0b3JBbGwoIFxyXG4gICAgICAgICAgICAnWycgKyBjb250ZXh0LmdldFRhZ3MoKS5yZWxhdGVkSWQgKyAnPVwiJyArIHRhcmdldC5nZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmlkICkgKyAnXCJdJyBcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiByZW1vdmVMaXN0KCBsaXN0ICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVtb3ZlTGlzdCA9IGZ1bmN0aW9uKCBsaXN0ICl7XHJcblxyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbm9kZTtcclxuICAgICAgICB2YXIgcG9zID0gMDtcclxuICAgICAgICB3aGlsZSAoIG5vZGUgPSBsaXN0WyBwb3MrKyBdICkge1xyXG4gICAgICAgICAgICAvLyBBZGQgbm9kZUlkIHRvIHJlc3VsdCBpZiBuZWVkZWRcclxuICAgICAgICAgICAgdmFyIG5vZGVJZCA9IGdldE5vZGVJZCggbm9kZSApO1xyXG4gICAgICAgICAgICBpZiAoIG5vZGVJZCAhPT0gdW5kZWZpbmVkICl7XHJcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCggbm9kZUlkICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEFkZCB0aGUgbm9kZUlkcyBvZiBpdHMgY2hpbGRyZW5cclxuICAgICAgICAgICAgYWRkTm9kZUlkc1RvTGlzdCggbm9kZSwgcmVzdWx0ICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBSZW1vdmUgbm9kZVxyXG4gICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5vZGUgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBhZGROb2RlSWRzVG9MaXN0ID0gZnVuY3Rpb24oIHRhcmdldCwgcmVzdWx0ICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IHRoZSBub2RlcyB3aXRoIGRhdGEtaWRcclxuICAgICAgICB2YXIgbm9kZUlkQXR0cmlidXRlTmFtZSA9IGNvbnRleHQuZ2V0VGFncygpLmlkO1xyXG4gICAgICAgIHZhciBsaXN0ID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoICdbJyArIG5vZGVJZEF0dHJpYnV0ZU5hbWUgKyAnXScgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJdGVyYXRlIHRoZSBsaXN0XHJcbiAgICAgICAgdmFyIG5vZGU7XHJcbiAgICAgICAgdmFyIHBvcyA9IDA7XHJcbiAgICAgICAgd2hpbGUgKCBub2RlID0gbGlzdFsgcG9zKysgXSApIHtcclxuICAgICAgICAgICAgcmVzdWx0LnB1c2goIFxyXG4gICAgICAgICAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoIG5vZGVJZEF0dHJpYnV0ZU5hbWUgKSBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgZ2V0Tm9kZUlkID0gZnVuY3Rpb24oIG5vZGUgKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbm9kZUlkQXR0cmlidXRlTmFtZSA9IGNvbnRleHQuZ2V0VGFncygpLmlkO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBub2RlLmhhc0F0dHJpYnV0ZSggbm9kZUlkQXR0cmlidXRlTmFtZSApP1xyXG4gICAgICAgICAgICBub2RlLmdldEF0dHJpYnV0ZSggbm9kZUlkQXR0cmlidXRlTmFtZSApOlxyXG4gICAgICAgICAgICB1bmRlZmluZWQ7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVtb3ZlTm9kZSA9IGZ1bmN0aW9uKCBub2RlICl7XHJcbiAgICAgICAgdmFyIG5vZGVJZCA9IGdldE5vZGVJZCggbm9kZSApO1xyXG4gICAgICAgIHZhciBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgIGlmICggcGFyZW50Tm9kZSApe1xyXG4gICAgICAgICAgICBwYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBub2RlICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiBub2RlSWQ7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVtb3ZlTXVsdGlwbGVOb2RlcyA9IGZ1bmN0aW9uKCBub2RlLCBtdXN0UmVtb3ZlR2VuZXJhdGVkTm9kZXMgKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgcmVzdWx0ID0gcmVtb3ZlUmVsYXRlZE5vZGVzKCBub2RlICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCBtdXN0UmVtb3ZlR2VuZXJhdGVkTm9kZXMgKXtcclxuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdChcclxuICAgICAgICAgICAgICAgIHJlbW92ZUdlbmVyYXRlZE5vZGVzKCBub2RlIClcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJlbW92ZUdlbmVyYXRlZE5vZGVzOiByZW1vdmVHZW5lcmF0ZWROb2RlcyxcclxuICAgICAgICAvL3JlbW92ZVJlbGF0ZWROb2RlczogcmVtb3ZlUmVsYXRlZE5vZGVzLFxyXG4gICAgICAgIHJlbW92ZU5vZGU6IHJlbW92ZU5vZGUsXHJcbiAgICAgICAgcmVtb3ZlTXVsdGlwbGVOb2RlczogcmVtb3ZlTXVsdGlwbGVOb2Rlc1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHNlbGY7XHJcbn0pKCk7XHJcbiIsIi8qIFxyXG4gICAgQ2xhc3MgUGFyc2VyIFxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XHJcbnZhciBQYXJzZXJSZW5kZXJlciA9IHJlcXVpcmUoICcuL3BhcnNlclJlbmRlcmVyLmpzJyApO1xyXG52YXIgUGFyc2VyVXBkYXRlciA9IHJlcXVpcmUoICcuL3BhcnNlclVwZGF0ZXIuanMnICk7XHJcbnZhciBQYXJzZXJQcmVsb2FkZXIgPSByZXF1aXJlKCAnLi9wYXJzZXJQcmVsb2FkZXIuanMnICk7XHJcbnZhciBSZWFjdGl2ZURpY3Rpb25hcnkgPSByZXF1aXJlKCAnLi4vc2NvcGVzL3JlYWN0aXZlRGljdGlvbmFyeS5qcycgKTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB2YXIgcGFyc2VyT3B0aW9ucyA9IHtcclxuICAgICAgICBjb21tYW5kOiB1bmRlZmluZWQsIC8vIHByZWxvYWQsIGZ1bGxSZW5kZXIgb3IgcGFydGlhbFJlbmRlclxyXG4gICAgICAgIHJvb3Q6IHVuZGVmaW5lZCxcclxuICAgICAgICBkaWN0aW9uYXJ5OiB7fSxcclxuICAgICAgICBpbmRleEV4cHJlc3Npb25zOiB0cnVlXHJcbiAgICAgICAgLy9ub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLFxyXG4gICAgICAgIC8vdGFyZ2V0LFxyXG4gICAgICAgIC8vZGVjbGFyZWRSZW1vdGVQYWdlVXJscyxcclxuICAgICAgICAvL2kxOG4sXHJcbiAgICAgICAgLy9jYWxsYmFjayxcclxuICAgICAgICAvL2ZhaWxDYWxsYmFjayxcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciB1cGRhdGVQYXJzZXJPcHRpb25zID0gZnVuY3Rpb24oIG9wdGlvbnMgKXtcclxuICAgICAgICBcclxuICAgICAgICBwYXJzZXJPcHRpb25zLmNvbW1hbmQgPSBvcHRpb25zLmNvbW1hbmQgfHwgJ2Z1bGxSZW5kZXInO1xyXG4gICAgICAgIHBhcnNlck9wdGlvbnMucm9vdCA9IG9wdGlvbnMucm9vdCA9PT0gdW5kZWZpbmVkPyBwYXJzZXJPcHRpb25zLnJvb3Q6IG9wdGlvbnMucm9vdDtcclxuICAgICAgICBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnkgPSAoIG9wdGlvbnMuZGljdGlvbmFyeSBpbnN0YW5jZW9mIFJlYWN0aXZlRGljdGlvbmFyeT9cclxuICAgICAgICAgICAgb3B0aW9ucy5kaWN0aW9uYXJ5Ll9nZXROb25SZWFjdGl2ZURpY3Rpb25hcnkoKTogXHJcbiAgICAgICAgICAgIG9wdGlvbnMuZGljdGlvbmFyeSApXHJcbiAgICAgICAgICAgIHx8IHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeTtcclxuICAgICAgICAvL3BhcnNlck9wdGlvbnMuZGljdGlvbmFyeSA9IG9wdGlvbnMuZGljdGlvbmFyeSB8fCBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnk7XHJcbiAgICAgICAgcGFyc2VyT3B0aW9ucy5pbmRleEV4cHJlc3Npb25zID0gb3B0aW9ucy5pbmRleEV4cHJlc3Npb25zID09PSB1bmRlZmluZWQ/IHBhcnNlck9wdGlvbnMuaW5kZXhFeHByZXNzaW9uczogb3B0aW9ucy5pbmRleEV4cHJlc3Npb25zO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uKCBfb3B0aW9ucyApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBvcHRpb25zID0gX29wdGlvbnMgfHwge307XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5pdCBwYXJzZXIgb3B0aW9uc1xyXG4gICAgICAgIHVwZGF0ZVBhcnNlck9wdGlvbnMoIG9wdGlvbnMgKTtcclxuICAgIFxyXG4gICAgICAgIHZhciBjb21tYW5kID0gb3B0aW9ucy5jb21tYW5kIHx8ICdmdWxsUmVuZGVyJztcclxuICAgICAgICBzd2l0Y2ggKCBjb21tYW5kICkge1xyXG4gICAgICAgICAgICBjYXNlICdwcmVsb2FkJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzUHJlbG9hZChcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmNhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZmFpbENhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGVjbGFyZWRSZW1vdGVQYWdlVXJscyB8fCBbXSxcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmkxOG4sXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5ub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubWF4Rm9sZGVyRGljdGlvbmFyaWVzXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjYXNlICdmdWxsUmVuZGVyJzpcclxuICAgICAgICAgICAgY2FzZSAncGFydGlhbFJlbmRlcic6XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gcHJvY2Vzc1JlbmRlcihcclxuICAgICAgICAgICAgICAgICAgICBjb21tYW5kID09PSAncGFydGlhbFJlbmRlcic/IG9wdGlvbnMudGFyZ2V0OiBwYXJzZXJPcHRpb25zLnJvb3QsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kaWN0aW9uYXJ5RXh0ZW5zaW9uLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMubm90UmVtb3ZlR2VuZXJhdGVkVGFncyxcclxuICAgICAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLmluZGV4RXhwcmVzc2lvbnMgJiYgY29tbWFuZCA9PT0gJ2Z1bGxSZW5kZXInLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZ29Ub1VSTEhhc2ggPT09IHVuZGVmaW5lZD8gY29udGV4dC5uZXh0UnVuQ291bnRlcigpID09PSAxOiBmYWxzZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgY2FzZSAndXBkYXRlJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzVXBkYXRlKCBcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRpY3Rpb25hcnlDaGFuZ2VzLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGljdGlvbmFyeUFjdGlvbnNcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICB0aHJvdyAnVW5rbm93biBjb21tYW5kOiAnICsgY29tbWFuZDtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc1ByZWxvYWQgPSBmdW5jdGlvbiggY2FsbGJhY2ssIGZhaWxDYWxsYmFjaywgZGVjbGFyZWRSZW1vdGVQYWdlVXJscywgaTE4biwgbm90UmVtb3ZlR2VuZXJhdGVkVGFncywgbWF4Rm9sZGVyRGljdGlvbmFyaWVzICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHBhcnNlclByZWxvYWRlciA9IG5ldyBQYXJzZXJQcmVsb2FkZXIoIFxyXG4gICAgICAgICAgICBwYXJzZXJPcHRpb25zLCBcclxuICAgICAgICAgICAgY2FsbGJhY2ssIFxyXG4gICAgICAgICAgICBmYWlsQ2FsbGJhY2ssIFxyXG4gICAgICAgICAgICBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLCBcclxuICAgICAgICAgICAgaTE4biwgXHJcbiAgICAgICAgICAgIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsIFxyXG4gICAgICAgICAgICBtYXhGb2xkZXJEaWN0aW9uYXJpZXNcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBwYXJzZXJQcmVsb2FkZXIucnVuKCk7XHJcblxyXG4gICAgICAgIHJldHVybiBwYXJzZXJQcmVsb2FkZXI7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc1JlbmRlciA9IGZ1bmN0aW9uKCB0YXJnZXQsIGRpY3Rpb25hcnlFeHRlbnNpb24sIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsIHJlc2V0SW5kZXgsIGdvVG9VUkxIYXNoICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHBhcnNlclJlbmRlcmVyID0gbmV3IFBhcnNlclJlbmRlcmVyKCBcclxuICAgICAgICAgICAgcGFyc2VyT3B0aW9ucywgXHJcbiAgICAgICAgICAgIHRhcmdldCwgXHJcbiAgICAgICAgICAgIGRpY3Rpb25hcnlFeHRlbnNpb24sIFxyXG4gICAgICAgICAgICBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLCBcclxuICAgICAgICAgICAgcmVzZXRJbmRleCxcclxuICAgICAgICAgICAgZ29Ub1VSTEhhc2hcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBwYXJzZXJSZW5kZXJlci5ydW4oKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcGFyc2VyUmVuZGVyZXI7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc1VwZGF0ZSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5Q2hhbmdlcywgZGljdGlvbmFyeUFjdGlvbnMgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHBhcnNlclVwZGF0ZXIgPSBuZXcgUGFyc2VyVXBkYXRlciggXHJcbiAgICAgICAgICAgIGRpY3Rpb25hcnlDaGFuZ2VzLFxyXG4gICAgICAgICAgICBkaWN0aW9uYXJ5QWN0aW9ucyxcclxuICAgICAgICAgICAgcGFyc2VyT3B0aW9uc1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHBhcnNlclVwZGF0ZXIucnVuKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlclVwZGF0ZXI7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgZ2V0T3B0aW9ucyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIHBhcnNlck9wdGlvbnM7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuICAgICAgICBydW46IHJ1bixcclxuICAgICAgICBnZXRPcHRpb25zOiBnZXRPcHRpb25zXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufSkoKTtcclxuIiwiLyogXHJcbiAgICBDbGFzcyBQYXJzZXJOb2RlUmVuZGVyZXJcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xyXG52YXIgbG9nID0gcmVxdWlyZSggJy4uL2xvZ0hlbHBlci5qcycgKTtcclxudmFyIE5vZGVBdHRyaWJ1dGVzID0gcmVxdWlyZSggJy4vbm9kZUF0dHJpYnV0ZXMuanMnICk7XHJcbnZhciBhdHRyaWJ1dGVDYWNoZSA9IHJlcXVpcmUoICcuLi9jYWNoZS9hdHRyaWJ1dGVDYWNoZS5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMnICk7XHJcbnZhciBBdXRvRGVmaW5lSGVscGVyID0gcmVxdWlyZSggJy4vYXV0b0RlZmluZUhlbHBlci5qcycgKTtcclxudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zL2V2YWx1YXRlSGVscGVyLmpzJyApO1xyXG52YXIgTG9vcCA9IHJlcXVpcmUoICcuL2xvb3AuanMnICk7XHJcblxyXG52YXIgSTE4TkRvbWFpbiA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL0kxOE4vaTE4bkRvbWFpbi5qcycgKTtcclxudmFyIEkxOE5MYW5ndWFnZSA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL0kxOE4vaTE4bkxhbmd1YWdlLmpzJyApO1xyXG52YXIgTUVUQUxEZWZpbmVNYWNybyA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL01FVEFML21ldGFsRGVmaW5lTWFjcm8uanMnICk7XHJcbnZhciBNRVRBTFVzZU1hY3JvID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvTUVUQUwvbWV0YWxVc2VNYWNyby5qcycgKTtcclxudmFyIFRBTEF0dHJpYnV0ZXMgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsQXR0cmlidXRlcy5qcycgKTtcclxudmFyIFRBTENvbmRpdGlvbiA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxDb25kaXRpb24uanMnICk7XHJcbnZhciBUQUxDb250ZW50ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbENvbnRlbnQuanMnICk7XHJcbnZhciBUQUxEZWZpbmUgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsRGVmaW5lLmpzJyApO1xyXG52YXIgVEFMT21pdFRhZyA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxPbWl0VGFnLmpzJyApO1xyXG52YXIgVEFMT25FcnJvciA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxPbkVycm9yLmpzJyApO1xyXG52YXIgVEFMUmVwZWF0ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbFJlcGVhdC5qcycgKTtcclxudmFyIFRBTFJlcGxhY2UgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsUmVwbGFjZS5qcycgKTtcclxudmFyIFRBTERlY2xhcmUgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsRGVjbGFyZS5qcycgKTtcclxudmFyIGNvbnRlbnRIZWxwZXIgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvY29udGVudEhlbHBlci5qcycgKTtcclxuXHJcbnZhciBQYXJzZXJOb2RlUmVuZGVyZXIgPSBmdW5jdGlvbiggX3RhcmdldCwgX3Njb3BlLCBfaW5kZXhFeHByZXNzaW9ucyApIHtcclxuICAgIFxyXG4gICAgdmFyIHRhcmdldCA9IF90YXJnZXQ7IFxyXG4gICAgdmFyIHNjb3BlID0gX3Njb3BlO1xyXG4gICAgdmFyIGluZGV4RXhwcmVzc2lvbnMgPSBfaW5kZXhFeHByZXNzaW9ucztcclxuICAgIFxyXG4gICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcclxuICAgIFxyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcHJvY2VzcyggdGFyZ2V0ICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBub2RlICkge1xyXG5cclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGF0dHJpYnV0ZXMgZnJvbSB0aGUgbm9kZVxyXG4gICAgICAgICAgICB2YXIgYXR0cmlidXRlcyA9IG5ldyBOb2RlQXR0cmlidXRlcyggbm9kZSwgaW5kZXhFeHByZXNzaW9ucyApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc2NvcGUuc3RhcnRFbGVtZW50KCk7XHJcblxyXG4gICAgICAgICAgICAvLyBQcm9jZXNzIGluc3RydWN0aW9uc1xyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbFJlcGVhdCAhPSBudWxsID8gXHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzTG9vcCggbm9kZSwgYXR0cmlidXRlcyApOlxyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0VsZW1lbnQoIG5vZGUsIGF0dHJpYnV0ZXMgKTtcclxuXHJcbiAgICAgICAgICAgIHNjb3BlLmVuZEVsZW1lbnQoKTtcclxuXHJcbiAgICAgICAgfSBjYXRjaCAoIGUgKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBUcnkgdG8gdHJlYXQgZXJyb3JcclxuICAgICAgICAgICAgaWYgKCAhIHRyZWF0RXJyb3IoIG5vZGUsIGUgKSApIHtcclxuICAgICAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc0xvb3BOZXh0U2libGluZyA9IGZ1bmN0aW9uKCBub2RlICl7XHJcblxyXG4gICAgICAgIHZhciBjb3VudGVyID0gLTE7XHJcbiAgICAgICAgdmFyIG5leHRTaWJsaW5nID0gbm9kZTtcclxuICAgICAgICBkbyB7XHJcbiAgICAgICAgICAgICsrY291bnRlcjtcclxuICAgICAgICAgICAgbmV4dFNpYmxpbmcgPSBuZXh0U2libGluZy5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgICAgIGlmICggISBuZXh0U2libGluZyApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICBuZXh0U2libGluZzogbnVsbCxcclxuICAgICAgICAgICAgICAgICAgICBjb3VudGVyOiBjb3VudGVyXHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSB3aGlsZSAoIG5leHRTaWJsaW5nLmhhc0F0dHJpYnV0ZSggdGFncy5xZHVwICkgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgbmV4dFNpYmxpbmc6IG5leHRTaWJsaW5nLFxyXG4gICAgICAgICAgICBjb3VudGVyOiBjb3VudGVyXHJcbiAgICAgICAgfTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzTG9vcCA9IGZ1bmN0aW9uKCBub2RlLCBhdHRyaWJ1dGVzICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFByb2Nlc3MgcmVwZWF0XHJcbiAgICAgICAgLy92YXIgdGFsUmVwZWF0ID0gVEFMUmVwZWF0LmJ1aWxkKCBhdHRyaWJ1dGVzLnRhbFJlcGVhdCApO1xyXG4gICAgICAgIHZhciB0YWxSZXBlYXQgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMUmVwZWF0LCBcclxuICAgICAgICAgICAgYXR0cmlidXRlcy50YWxSZXBlYXQsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgdmFyIGxvb3AgPSB0YWxSZXBlYXQucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuXHJcbiAgICAgICAgLy8gQ2hlY2sgZGVmYXVsdFxyXG4gICAgICAgIGlmICggZXZhbHVhdGVIZWxwZXIuaXNEZWZhdWx0KCBsb29wLmdldEl0ZW1zKCkgKSApe1xyXG4gICAgICAgICAgICBwcm9jZXNzRWxlbWVudCggbm9kZSwgYXR0cmlidXRlcyApO1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQ29uZmlndXJlIHRoZSBub2RlIHRvIGNsb25lIGl0IGxhdGVyXHJcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoIHRhZ3MudGFsUmVwZWF0ICk7XHJcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoICdzdHlsZScgKTtcclxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggdGFncy5xZHVwLCAxICk7XHJcbiAgICAgICAgdmFyIG5vZGVJZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCAnaWQnICk7XHJcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoICdpZCcgKTtcclxuICAgICAgICB2YXIgbm9kZURhdGFJZCA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLmlkICk7XHJcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoIHRhZ3MuaWQgKTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbmV4dFNpYmxpbmdEYXRhID0gcHJvY2Vzc0xvb3BOZXh0U2libGluZyggbm9kZSApO1xyXG4gICAgICAgIHZhciBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nRGF0YS5uZXh0U2libGluZztcclxuICAgICAgICBsb29wLnNldE9mZnNldCggbmV4dFNpYmxpbmdEYXRhLmNvdW50ZXIgKTtcclxuICAgICAgICAvL2xvZy53YXJuKCAnbG9vcCBjb3VudGVyOiAnICsgbmV4dFNpYmxpbmdEYXRhLmNvdW50ZXIgKTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgYXV0b0RlZmluZUhlbHBlcjtcclxuICAgICAgICB3aGlsZSAoIGF1dG9EZWZpbmVIZWxwZXIgPSBsb29wLnJlcGVhdCgpICkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc2NvcGUuc3RhcnRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBDbG9uZSBhbmQgY29uZmlndXJlIHRoZSBub2RlXHJcbiAgICAgICAgICAgIHZhciB0bXBOb2RlID0gUGFyc2VyTm9kZVJlbmRlcmVyLmNsb25lQW5kQ29uZmlndXJlTm9kZSggbm9kZSwgaW5kZXhFeHByZXNzaW9ucywgdGFncywgbm9kZURhdGFJZCApO1xyXG5cclxuICAgICAgICAgICAgLy8gSW5zZXJ0IGl0XHJcbiAgICAgICAgICAgIHZhciBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xyXG4gICAgICAgICAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZSggdG1wTm9kZSwgbmV4dFNpYmxpbmcgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFByb2Nlc3MgaXRcclxuICAgICAgICAgICAgaWYgKCAhIHByb2Nlc3NFbGVtZW50KCB0bXBOb2RlLCBhdHRyaWJ1dGVzLCBhdXRvRGVmaW5lSGVscGVyICkgKSB7XHJcbiAgICAgICAgICAgICAgICBzY29wZS5lbmRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHNjb3BlLmVuZEVsZW1lbnQoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIENvbmZpZ3VyZSByZXBlYXQgbm9kZSAodGhlIG9yaWdpbmFsKSB0byBlbmFibGUgZnV0dXJlIHJlZXZhbHVhdGlvblxyXG4gICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9ICdub25lJztcclxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggdGFncy50YWxSZXBlYXQsIGF0dHJpYnV0ZXMudGFsUmVwZWF0ICk7XHJcbiAgICAgICAgaWYgKCBub2RlSWQgIT09ICcnICYmIG5vZGVJZCAhPSBudWxsICl7XHJcbiAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCAnaWQnLCBub2RlSWQgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgaWYgKCBub2RlRGF0YUlkICE9PSAnJyAmJiBub2RlRGF0YUlkICE9IG51bGwgKXtcclxuICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIHRhZ3MuaWQsIG5vZGVEYXRhSWQgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoIHRhZ3MucWR1cCApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdHJlYXRFcnJvciA9IGZ1bmN0aW9uKCBub2RlLCBleGNlcHRpb24gKSB7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIFNldCB0aGUgZXJyb3IgdmFyaWFibGVcclxuICAgICAgICAgICAgdmFyIHRlbXBsYXRlRXJyb3IgPSB7XHJcbiAgICAgICAgICAgICAgICB0eXBlOiBleGNlcHRpb24ubmFtZSxcclxuICAgICAgICAgICAgICAgIHZhbHVlOiBleGNlcHRpb24ubWVzc2FnZSxcclxuICAgICAgICAgICAgICAgIHRyYWNlYmFjazogZXhjZXB0aW9uLnN0YWNrXHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIHNjb3BlLnNldCggXHJcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS50ZW1wbGF0ZUVycm9yVmFyTmFtZSwgXHJcbiAgICAgICAgICAgICAgICB0ZW1wbGF0ZUVycm9yIFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gRXhpdCBpZiB0aGVyZSBpcyBubyBvbi1lcnJvciBleHByZXNzaW9uIGRlZmluZWRcclxuICAgICAgICAgICAgdmFyIGNvbnRlbnQgPSBzY29wZS5nZXQoIGNvbnRleHQuZ2V0Q29uZigpLm9uRXJyb3JWYXJOYW1lICk7XHJcbiAgICAgICAgICAgIGlmICggY29udGVudCA9PSBudWxsICkge1xyXG4gICAgICAgICAgICAgICAgbG9nLmZhdGFsKCBleGNlcHRpb24gKTtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmVuZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgbG9nLmVycm9yKCBleGNlcHRpb24gKTtcclxuICAgICAgICAgICAgc2NvcGUuZW5kRWxlbWVudCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgY29udGVudEhlbHBlci51cGRhdGVOb2RlKCBcclxuICAgICAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICAgICAgc2NvcGUuZ2V0KCBjb250ZXh0LmdldENvbmYoKS5vbkVycm9yU3RydWN0dXJlVmFyTmFtZSApLCBcclxuICAgICAgICAgICAgICAgIGNvbnRlbnQgXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICByZXR1cm4gY29udGVudDtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBjYXRjaCAoIGUgKSB7XHJcbiAgICAgICAgICAgIGxvZy5mYXRhbCggZSApO1xyXG4gICAgICAgICAgICBzY29wZS5lbmRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NFbGVtZW50ID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZXMsIF9hdXRvRGVmaW5lSGVscGVyICkge1xyXG5cclxuICAgICAgICAvLyBJZiBpdCBpcyBkZWZpbmVkIGEgbWV0YWxGaWxsU2xvdCBvciBhIG1ldGFsRGVmaW5lTWFjcm8gZG8gbm90aGluZ1xyXG4gICAgICAgIGlmICggYXR0cmlidXRlcy5tZXRhbEZpbGxTbG90IHx8ICEgcHJvY2Vzc01FVEFMRGVmaW5lTWFjcm8oXHJcbiAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLm1ldGFsRGVmaW5lTWFjcm8gXHJcbiAgICAgICAgKSApIHtcclxuICAgICAgICAgICAgLy8gU3RvcCBwcm9jZXNzaW5nIHRoZSByZXN0IG9mIHRoaXMgbm9kZSBhcyBpdCBpcyBpbnZpc2libGVcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB2YXIgYXV0b0RlZmluZUhlbHBlciA9IF9hdXRvRGVmaW5lSGVscGVyIHx8IG5ldyBBdXRvRGVmaW5lSGVscGVyKCBub2RlICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHByb2Nlc3NEZWNsYXJlKCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlcy50YWxEZWNsYXJlLFxyXG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKSApIHtcclxuICAgICAgICAgICAgLy8gU3RvcCBwcm9jZXNzaW5nIHRoZSByZXN0IG9mIHRoaXMgbm9kZSBhcyBpdCBpcyBpbnZpc2libGVcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBwcm9jZXNzT25FcnJvciggXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsT25FcnJvcixcclxuICAgICAgICAgICAgYXV0b0RlZmluZUhlbHBlclxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvY2Vzc0kxOG5MYW5ndWFnZSggXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMuaTE4bkxhbmd1YWdlLFxyXG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBwcm9jZXNzSTE4bkRvbWFpbihcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlcy5pMThuRG9tYWluLCBcclxuICAgICAgICAgICAgYXV0b0RlZmluZUhlbHBlclxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcHJvY2Vzc0F1dG9EZWZpbmUoIFxyXG4gICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgYXV0b0RlZmluZUhlbHBlclxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgUGFyc2VyTm9kZVJlbmRlcmVyLnByb2Nlc3NEZWZpbmUoIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbERlZmluZSwgIFxyXG4gICAgICAgICAgICBmYWxzZSxcclxuICAgICAgICAgICAgc2NvcGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnNcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggISBwcm9jZXNzQ29uZGl0aW9uKFxyXG4gICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbENvbmRpdGlvbiBcclxuICAgICAgICApICkge1xyXG4gICAgICAgICAgICAvLyBTdG9wIHByb2Nlc3NpbmcgdGhlIHJlc3Qgb2YgdGhpcyBub2RlIGFzIGl0IGlzIGludmlzaWJsZVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgb21pdHRlZFRhZyA9IHByb2Nlc3NPbWl0VGFnKFxyXG4gICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbE9taXRUYWcgXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgdmFyIHJlcGxhY2VkID0gcHJvY2Vzc1JlcGxhY2UoXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsUmVwbGFjZSBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoICEgb21pdHRlZFRhZyAmJiAhIHJlcGxhY2VkICkge1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgcHJvY2Vzc0F0dHJpYnV0ZXMoXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy50YWxBdHRyaWJ1dGVzIFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgaWYgKCAhIHByb2Nlc3NDb250ZW50KFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsQ29udGVudCApICkge1xyXG5cclxuICAgICAgICAgICAgICAgIGRlZmF1bHRDb250ZW50KCBub2RlICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHByb2Nlc3NNRVRBTFVzZU1hY3JvKFxyXG4gICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLm1ldGFsVXNlTWFjcm8sIFxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy50YWxEZWZpbmUsXHJcbiAgICAgICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIGRlZmF1bHRDb250ZW50ID0gZnVuY3Rpb24oIG5vZGUgKSB7XHJcblxyXG4gICAgICAgIHZhciBjaGlsZE5vZGVzID0gbm9kZS5jaGlsZE5vZGVzO1xyXG4gICAgICAgIGlmICggISBjaGlsZE5vZGVzICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBjaGlsZE5vZGVzLmxlbmd0aDsgaSsrICkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudENoaWxkTm9kZSA9IGNoaWxkTm9kZXNbIGkgXTtcclxuXHJcbiAgICAgICAgICAgIC8vIENoZWNrIGlmIG5vZGUgaXMgRUxFTUVOVF9OT0RFIGFuZCBub3QgcGFyc2VkIHlldFxyXG4gICAgICAgICAgICBpZiAoIGN1cnJlbnRDaGlsZE5vZGUgJiYgY3VycmVudENoaWxkTm9kZS5ub2RlVHlwZSA9PT0gMVxyXG4gICAgICAgICAgICAgICAgICAgICYmICEgY3VycmVudENoaWxkTm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MucWR1cCApICkge1xyXG4gICAgICAgICAgICAgICAgcHJvY2VzcyggY3VycmVudENoaWxkTm9kZSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NPbkVycm9yID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZywgYXV0b0RlZmluZUhlbHBlciApIHtcclxuXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRhbE9uRXJyb3IgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMT25FcnJvciwgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdGFsT25FcnJvci5wdXRUb0F1dG9EZWZpbmVIZWxwZXIoIGF1dG9EZWZpbmVIZWxwZXIgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzQXV0b0RlZmluZSA9IGZ1bmN0aW9uKCBub2RlLCBhdXRvRGVmaW5lSGVscGVyICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBzdHJpbmcgPSBhdXRvRGVmaW5lSGVscGVyLnVwZGF0ZU5vZGUoIG5vZGUgKTtcclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB0YWxEZWZpbmUgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMRGVmaW5lLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxEZWZpbmUucHJvY2Vzcyggc2NvcGUsIGZhbHNlICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm9jZXNzSTE4bkRvbWFpbiA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcsIGF1dG9EZWZpbmVIZWxwZXIgKSB7XHJcblxyXG4gICAgICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpMThuRG9tYWluID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIEkxOE5Eb21haW4sIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIGkxOG5Eb21haW4ucHV0VG9BdXRvRGVmaW5lSGVscGVyKCBzY29wZSwgYXV0b0RlZmluZUhlbHBlciApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NJMThuTGFuZ3VhZ2UgPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nLCBhdXRvRGVmaW5lSGVscGVyICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgaTE4bkxhbmd1YWdlID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIEkxOE5MYW5ndWFnZSwgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gaTE4bkxhbmd1YWdlLnB1dFRvQXV0b0RlZmluZUhlbHBlciggYXV0b0RlZmluZUhlbHBlciApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NEZWNsYXJlID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZywgYXV0b0RlZmluZUhlbHBlciApIHtcclxuXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGFsRGVjbGFyZSA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxEZWNsYXJlLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxEZWNsYXJlLnByb2Nlc3MoIHNjb3BlLCBhdXRvRGVmaW5lSGVscGVyICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc01FVEFMRGVmaW5lTWFjcm8gPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIE5vIHNlbnNlIHRvIGNhY2hlIG1hY3JvIGRlZmluaXRpb25zIVxyXG4gICAgICAgIHZhciBtZXRhbERlZmluZU1hY3JvID0gTUVUQUxEZWZpbmVNYWNyby5idWlsZCggc3RyaW5nICk7XHJcbiAgICAgICAgcmV0dXJuIG1ldGFsRGVmaW5lTWFjcm8ucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NNRVRBTFVzZU1hY3JvID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZywgc3RyaW5nRGVmaW5lLCBhdXRvRGVmaW5lSGVscGVyICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIE5vIHNlbnNlIHRvIGNhY2hlIG1hY3JvIHVzZXMhXHJcbiAgICAgICAgdmFyIG1ldGFsVXNlTWFjcm8gPSBNRVRBTFVzZU1hY3JvLmJ1aWxkKCBzdHJpbmcsIHN0cmluZ0RlZmluZSwgc2NvcGUgKTtcclxuICAgICAgICB2YXIgbmV3Tm9kZSA9IG1ldGFsVXNlTWFjcm8ucHJvY2Vzcyggc2NvcGUsIG5vZGUsIGF1dG9EZWZpbmVIZWxwZXIsIGluZGV4RXhwcmVzc2lvbnMgKTtcclxuICAgICAgICBuZXdOb2RlLnNldEF0dHJpYnV0ZSggdGFncy5xZHVwLCAxICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5kZXggbm9kZVxyXG4gICAgICAgIGlmICggaW5kZXhFeHByZXNzaW9ucyApe1xyXG4gICAgICAgICAgICBhdHRyaWJ1dGVJbmRleC5hZGQoIG5vZGUsIG1ldGFsVXNlTWFjcm8sIHNjb3BlICk7XHJcbiAgICAgICAgfVxyXG4gICAgXHJcbiAgICAgICAgLy8gUHJvY2VzcyBuZXcgbm9kZVxyXG4gICAgICAgIHJldHVybiBwcm9jZXNzKCBuZXdOb2RlICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm9jZXNzQ29uZGl0aW9uID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZyApIHtcclxuXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGFsQ29uZGl0aW9uID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIFRBTENvbmRpdGlvbiwgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdGFsQ29uZGl0aW9uLnByb2Nlc3MoIHNjb3BlLCBub2RlICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc1JlcGxhY2UgPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggISBzdHJpbmcgKXtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICB2YXIgdGFsUmVwbGFjZSA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxSZXBsYWNlLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxSZXBsYWNlLnByb2Nlc3MoIHNjb3BlLCBub2RlICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm9jZXNzT21pdFRhZyA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcgKSB7XHJcblxyXG4gICAgICAgIGlmICggc3RyaW5nID09IG51bGwgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0YWxPbWl0VGFnID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIFRBTE9taXRUYWcsIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbE9taXRUYWcucHJvY2Vzcyggc2NvcGUsIG5vZGUsIHNlbGYgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzQ29udGVudCA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGFsQ29udGVudCA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxDb250ZW50LCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxDb250ZW50LnByb2Nlc3MoIHNjb3BlLCBub2RlICk7XHJcbiAgICB9O1xyXG4gIFxyXG4gICAgdmFyIHByb2Nlc3NBdHRyaWJ1dGVzID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZyApIHtcclxuXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRhbEF0dHJpYnV0ZXMgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMQXR0cmlidXRlcywgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlIFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbEF0dHJpYnV0ZXMucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJ1bjogcnVuLFxyXG4gICAgICAgIGRlZmF1bHRDb250ZW50OiBkZWZhdWx0Q29udGVudFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHNlbGY7XHJcbn07XHJcblxyXG5QYXJzZXJOb2RlUmVuZGVyZXIucHJvY2Vzc0RlZmluZSA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcsIGZvcmNlR2xvYmFsLCBzY29wZSwgaW5kZXhFeHByZXNzaW9ucyApIHtcclxuXHJcbiAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICB2YXIgdGFsRGVmaW5lID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgVEFMRGVmaW5lLCBcclxuICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgIG5vZGUsXHJcbiAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICBzY29wZVxyXG4gICAgKTtcclxuICAgIHJldHVybiB0YWxEZWZpbmUucHJvY2Vzcyggc2NvcGUsIGZvcmNlR2xvYmFsICk7XHJcbn07XHJcblxyXG5QYXJzZXJOb2RlUmVuZGVyZXIuY2xvbmVBbmRDb25maWd1cmVOb2RlID0gZnVuY3Rpb24oIG5vZGUsIGluZGV4RXhwcmVzc2lvbnMsIHRhZ3MsIG5vZGVEYXRhSWQgKSB7XHJcbiAgICBcclxuICAgIC8vIENsb25lIG5vZGVcclxuICAgIHZhciB0bXBOb2RlID0gbm9kZS5jbG9uZU5vZGUoIHRydWUgKTtcclxuICAgIGlmICggJ2Zvcm0nIGluIHRtcE5vZGUgKSB7XHJcbiAgICAgICAgdG1wTm9kZS5jaGVja2VkID0gZmFsc2U7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2V0IGlkIGFuZCByZWxhdGVkIGlkIGlmIG5lZWRlZFxyXG4gICAgaWYgKCBpbmRleEV4cHJlc3Npb25zICl7XHJcbiAgICAgICAgdG1wTm9kZS5zZXRBdHRyaWJ1dGUoIHRhZ3MuaWQsIGNvbnRleHQubmV4dEV4cHJlc3Npb25Db3VudGVyKCkgKTtcclxuICAgICAgICB0bXBOb2RlLnNldEF0dHJpYnV0ZSggdGFncy5yZWxhdGVkSWQsIG5vZGVEYXRhSWQgKTtcclxuICAgIH1cclxuICAgIFxyXG4gICAgcmV0dXJuIHRtcE5vZGU7XHJcbn07XHJcblxyXG5QYXJzZXJOb2RlUmVuZGVyZXIuY29uZmlndXJlTm9kZUZvck5ld0l0ZW0gPSBmdW5jdGlvbiggdG1wTm9kZSwgdGFncywgcGFyZW50Tm9kZSwgaW5kZXhJdGVtLCBpbmRleFRvVXNlICkge1xyXG4gICAgXHJcbiAgICAvLyBSZW1vdmUgYXR0cmlidXRlc1xyXG4gICAgdG1wTm9kZS5yZW1vdmVBdHRyaWJ1dGUoIHRhZ3MudGFsUmVwZWF0ICk7XHJcbiAgICB0bXBOb2RlLnJlbW92ZUF0dHJpYnV0ZSggJ3N0eWxlJyApO1xyXG4gICAgdG1wTm9kZS5zZXRBdHRyaWJ1dGUoIHRhZ3MucWR1cCwgMSApO1xyXG4gICAgXHJcbiAgICAvLyBDb25maWd1cmUgbG9vcCBhdHRyaWJ1dGVzXHJcbiAgICBMb29wLnNldEF1dG9EZWZpbmVBdHRyaWJ1dGUoIFxyXG4gICAgICAgIHRtcE5vZGUsIFxyXG4gICAgICAgIGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZS5nZXRWYXJOYW1lKCksIFxyXG4gICAgICAgIGluZGV4VG9Vc2UsXHJcbiAgICAgICAgaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlLmdldEV4cHJlc3Npb25TdHJpbmcoKSwgXHJcbiAgICAgICAgcGFyZW50Tm9kZS5jaGlsZEVsZW1lbnRDb3VudCwgXHJcbiAgICAgICAgMFxyXG4gICAgKTtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGFyc2VyTm9kZVJlbmRlcmVyO1xyXG4iLCIvKiBcclxuICAgIENsYXNzIFBhcnNlclByZWxvYWRlclxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XHJcbnZhciBsb2cgPSByZXF1aXJlKCAnLi4vbG9nSGVscGVyLmpzJyApO1xyXG52YXIgbm9kZVJlbW92ZXIgPSByZXF1aXJlKCAnLi9ub2RlUmVtb3Zlci5qcycgKTtcclxudmFyIFNjb3BlID0gcmVxdWlyZSggJy4uL3Njb3Blcy9zY29wZS5qcycgKTtcclxudmFyIGkxOG5IZWxwZXIgPSByZXF1aXJlKCAnLi4vaTE4bi9pMThuSGVscGVyLmpzJyApO1xyXG52YXIgcmVzb2x2ZXIgPSByZXF1aXJlKCAnLi4vcmVzb2x2ZXIuanMnICk7XHJcbnZhciBhdHRyaWJ1dGVJbmRleCA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZUluZGV4LmpzJyApO1xyXG5cclxudmFyIFBhcnNlclByZWxvYWRlciA9IGZ1bmN0aW9uKCBfcGFyc2VyT3B0aW9ucywgX2NhbGxiYWNrLCBfZmFpbENhbGxiYWNrLCBfZGVjbGFyZWRSZW1vdGVQYWdlVXJscywgX2kxOG4sIF9ub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLCBfbWF4Rm9sZGVyRGljdGlvbmFyaWVzICkge1xyXG4gICAgXHJcbiAgICB2YXIgcGFyc2VyT3B0aW9ucyA9IF9wYXJzZXJPcHRpb25zO1xyXG4gICAgdmFyIGNhbGxiYWNrID0gX2NhbGxiYWNrO1xyXG4gICAgdmFyIGZhaWxDYWxsYmFjayA9IF9mYWlsQ2FsbGJhY2s7XHJcbiAgICB2YXIgZGVjbGFyZWRSZW1vdGVQYWdlVXJscyA9IF9kZWNsYXJlZFJlbW90ZVBhZ2VVcmxzO1xyXG4gICAgdmFyIGkxOG4gPSBfaTE4bjtcclxuICAgIHZhciBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzID0gX25vdFJlbW92ZUdlbmVyYXRlZFRhZ3M7XHJcbiAgICB2YXIgbWF4Rm9sZGVyRGljdGlvbmFyaWVzID0gX21heEZvbGRlckRpY3Rpb25hcmllcztcclxuICAgIFxyXG4gICAgdmFyIHJ1biA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmICggISBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzICl7XHJcbiAgICAgICAgICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVHZW5lcmF0ZWROb2RlcyggcGFyc2VyT3B0aW9ucy5yb290ICk7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5kZXgucmVtb3ZlTXVsdGlwbGVOb2RlcyhcclxuICAgICAgICAgICAgICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVHZW5lcmF0ZWROb2RlcyggcGFyc2VyT3B0aW9ucy5yb290IClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICB2YXIgc2NvcGUgPSBuZXcgU2NvcGUoIFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5LCBcclxuICAgICAgICAgICAgICAgIHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeUV4dGVuc2lvbiwgXHJcbiAgICAgICAgICAgICAgICB0cnVlIFxyXG4gICAgICAgICAgICApO1xyXG5cclxuICAgICAgICAgICAgc2NvcGUubG9hZEZvbGRlckRpY3Rpb25hcmllc0FzeW5jKCBcclxuICAgICAgICAgICAgICAgIG1heEZvbGRlckRpY3Rpb25hcmllcywgXHJcbiAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24sXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuc2V0Rm9sZGVyRGljdGlvbmFyaWVzKCBzY29wZS5mb2xkZXJEaWN0aW9uYXJpZXMgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgaTE4bkhlbHBlci5sb2FkQXN5bmNBdXRvKCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpMThuLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzb2x2ZXIubG9hZFJlbW90ZVBhZ2VzKCBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzY29wZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxDYWxsYmFja1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgZmFpbENhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgIH0gXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgIH0gY2F0Y2goIGUgKXtcclxuICAgICAgICAgICAgbG9nLmZhdGFsKCAnRXhpdGluZyBpbml0IG1ldGhvZCBvZiBaUFQgd2l0aCBlcnJvcnM6ICcgKyBlICk7XHJcbiAgICAgICAgICAgIHRocm93IGU7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGFyc2VyUHJlbG9hZGVyO1xyXG4iLCIvKiBcclxuICAgIENsYXNzIFBhcnNlclJlbmRlcmVyXHJcbiovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcclxudmFyIGxvZyA9IHJlcXVpcmUoICcuLi9sb2dIZWxwZXIuanMnICk7XHJcbnZhciBhdHRyaWJ1dGVDYWNoZSA9IHJlcXVpcmUoICcuLi9jYWNoZS9hdHRyaWJ1dGVDYWNoZS5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMnICk7XHJcbnZhciBub2RlUmVtb3ZlciA9IHJlcXVpcmUoICcuL25vZGVSZW1vdmVyLmpzJyApO1xyXG52YXIgc2NvcGVCdWlsZGVyID0gcmVxdWlyZSggJy4uL3Njb3Blcy9zY29wZUJ1aWxkZXIuanMnICk7XHJcbnZhciBQYXJzZXJOb2RlUmVuZGVyZXIgPSByZXF1aXJlKCAnLi9wYXJzZXJOb2RlUmVuZGVyZXIuanMnICk7XHJcblxyXG52YXIgUGFyc2VyUmVuZGVyZXIgPSBmdW5jdGlvbiggX3BhcnNlck9wdGlvbnMsIF90YXJnZXQsIF9kaWN0aW9uYXJ5RXh0ZW5zaW9uLCBfbm90UmVtb3ZlR2VuZXJhdGVkVGFncywgX3Jlc2V0SW5kZXgsIF9nb1RvVVJMSGFzaCApIHtcclxuICAgIFxyXG4gICAgdmFyIHBhcnNlck9wdGlvbnMgPSBfcGFyc2VyT3B0aW9ucztcclxuICAgIHZhciB0YXJnZXQgPSBfdGFyZ2V0O1xyXG4gICAgdmFyIGRpY3Rpb25hcnlFeHRlbnNpb24gPSBfZGljdGlvbmFyeUV4dGVuc2lvbjtcclxuICAgIHZhciBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzID0gX25vdFJlbW92ZUdlbmVyYXRlZFRhZ3M7XHJcbiAgICB2YXIgcmVzZXRJbmRleCA9IF9yZXNldEluZGV4O1xyXG4gICAgdmFyIGdvVG9VUkxIYXNoID0gX2dvVG9VUkxIYXNoO1xyXG4gICAgXHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBwcm9jZXNzKCk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCl7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGlmICggISB0YXJnZXQgKXtcclxuICAgICAgICAgICAgICAgIHRocm93ICdVbmFibGUgdG8gcHJvY2VzcyBudWxsIHJvb3Qgb3IgdGFyZ2V0ISc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICggISBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzICl7XHJcbiAgICAgICAgICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVHZW5lcmF0ZWROb2RlcyggdGFyZ2V0ICk7XHJcbiAgICAgICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5kZXgucmVtb3ZlTXVsdGlwbGVOb2RlcyhcclxuICAgICAgICAgICAgICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVHZW5lcmF0ZWROb2RlcyggdGFyZ2V0IClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgICAgICAqL1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBpZiAoIHJlc2V0SW5kZXggKXtcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUluZGV4LnJlc2V0KCk7XHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVDYWNoZS5yZXNldCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICBwcm9jZXNzQWxsVGFyZ2V0RWxlbWVudHMoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIGlmICggZ29Ub1VSTEhhc2ggKXtcclxuICAgICAgICAgICAgICAgIHByb2Nlc3NHb1RvVVJMSGFzaCgpO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH0gY2F0Y2goIGUgKXtcclxuICAgICAgICAgICAgbG9nLmZhdGFsKCAnRXhpdGluZyBydW4gbWV0aG9kIG9mIFpQVCB3aXRoIGVycm9yczogJyArIGUgKTtcclxuICAgICAgICAgICAgY29udGV4dC5lcnJvckZ1bmN0aW9uKCBlICk7XHJcbiAgICAgICAgICAgIC8vdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm9jZXNzQWxsVGFyZ2V0RWxlbWVudHMgPSBmdW5jdGlvbigpIHtcclxuXHJcbiAgICAgICAgLy8gSXMgbXVsdGlyb290P1xyXG4gICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggdGFyZ2V0ICkgKXsgXHJcbiAgICAgICAgICAgIC8vIFRoZXJlIGFyZSBzZXZlcmFsIHJvb3RzXHJcbiAgICAgICAgICAgIGZvciAoIHZhciBjID0gMDsgYyA8IHRhcmdldC5sZW5ndGg7IGMrKyApIHtcclxuICAgICAgICAgICAgICAgIHByb2Nlc3MxVGFyZ2V0KCB0YXJnZXRbIGMgXSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgLy8gVGhlcmUgaXMgb25seSBvbmUgcm9vdFxyXG4gICAgICAgICAgICBwcm9jZXNzMVRhcmdldCggdGFyZ2V0ICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcHJvY2VzczFUYXJnZXQgPSBmdW5jdGlvbiggY3VycmVudFRhcmdldCApIHtcclxuXHJcbiAgICAgICAgdmFyIHBhcnNlck5vZGVSZW5kZXJlciA9IG5ldyBQYXJzZXJOb2RlUmVuZGVyZXIoIFxyXG4gICAgICAgICAgICBjdXJyZW50VGFyZ2V0LCBcclxuICAgICAgICAgICAgc2NvcGVCdWlsZGVyLmJ1aWxkKCBcclxuICAgICAgICAgICAgICAgIHBhcnNlck9wdGlvbnMsIFxyXG4gICAgICAgICAgICAgICAgY3VycmVudFRhcmdldCwgXHJcbiAgICAgICAgICAgICAgICBkaWN0aW9uYXJ5RXh0ZW5zaW9uLFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5jb21tYW5kID09PSAncGFydGlhbFJlbmRlcidcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5pbmRleEV4cHJlc3Npb25zXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcGFyc2VyTm9kZVJlbmRlcmVyLnJ1bigpO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NHb1RvVVJMSGFzaCA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGlkID0gZGVjb2RlVVJJKCB3aW5kb3cubG9jYXRpb24uaGFzaCApLnN1YnN0ciggMSApO1xyXG4gICAgICAgIGlmICggISBpZCApe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBlbGVtZW50ID0gd2luZG93LmRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBpZCApO1xyXG4gICAgICAgIGlmICggISBlbGVtZW50ICl7XHJcbiAgICAgICAgICAgIGxvZy53YXJuKCAnVW5hYmxlIHRvIGdvIHRvIFVSTCBoYXNoLiBFbGVtZW50IHdpdGggaWQgXCInICsgaWQgKyAnXCIgbm90IGZvdW5kIScgKTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gR28gdG8gaGFzaFxyXG4gICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJyMnICsgaWQ7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuICAgICAgICBydW46IHJ1blxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHNlbGY7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnNlclJlbmRlcmVyO1xyXG4iLCIvKiBcclxuICAgIENsYXNzIFBhcnNlclVwZGF0ZXJcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xyXG52YXIgbG9nID0gcmVxdWlyZSggJy4uL2xvZ0hlbHBlci5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMnICk7XHJcbnZhciBzY29wZUJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vc2NvcGVzL3Njb3BlQnVpbGRlci5qcycgKTtcclxudmFyIFBhcnNlck5vZGVSZW5kZXJlciA9IHJlcXVpcmUoICcuL3BhcnNlck5vZGVSZW5kZXJlci5qcycgKTtcclxudmFyIG5vZGVSZW1vdmVyID0gcmVxdWlyZSggJy4vbm9kZVJlbW92ZXIuanMnICk7XHJcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcclxudmFyIGRpY3Rpb25hcnlBY3Rpb25CdWlsZGVyID0gcmVxdWlyZSggJy4vZGljdGlvbmFyeUFjdGlvbnMvZGljdGlvbmFyeUFjdGlvbkJ1aWxkZXIuanMnICk7XHJcbnZhciBBYnN0cmFjdEFycmF5QWN0aW9uID0gcmVxdWlyZSggJy4vZGljdGlvbmFyeUFjdGlvbnMvYWJzdHJhY3RBcnJheUFjdGlvbi5qcycgKTtcclxuXHJcbnZhciBQYXJzZXJVcGRhdGVyID0gZnVuY3Rpb24oIF9kaWN0aW9uYXJ5Q2hhbmdlcywgX2RpY3Rpb25hcnlBY3Rpb25zLCBfcGFyc2VyT3B0aW9ucyApIHtcclxuICAgIFxyXG4gICAgdmFyIGRpY3Rpb25hcnlDaGFuZ2VzID0gX2RpY3Rpb25hcnlDaGFuZ2VzO1xyXG4gICAgdmFyIGRpY3Rpb25hcnlBY3Rpb25zID0gX2RpY3Rpb25hcnlBY3Rpb25zO1xyXG4gICAgdmFyIHBhcnNlck9wdGlvbnMgPSBfcGFyc2VyT3B0aW9ucztcclxuICAgIFxyXG4gICAgdmFyIHNjb3BlTWFwID0ge307XHJcbiAgICB2YXIgbm9kZUF0dHJpYnV0ZXMsIFxyXG4gICAgICAgIHN0YXRpc3RpY3M7XHJcbiAgICB2YXIgZGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXM7XHJcbiAgICBcclxuICAgIHZhciBpbml0aWFsaXplRGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGRpY3Rpb25hcnlBY3Rpb25zSW5zdGFuY2VzID0gW107XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIGRpY3Rpb25hcnlBY3Rpb25zICl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGljdGlvbmFyeUFjdGlvbnMubGVuZ3RoOyArK2kgKXtcclxuICAgICAgICAgICAgdmFyIGFjdGlvbiA9IGRpY3Rpb25hcnlBY3Rpb25zWyBpIF07XHJcbiAgICAgICAgICAgIHZhciBuZXdBY3Rpb25JbnN0YW5jZSA9IGRpY3Rpb25hcnlBY3Rpb25CdWlsZGVyLmJ1aWxkKCBhY3Rpb24sIHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeSApO1xyXG4gICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIG5ld0FjdGlvbkluc3RhbmNlICkgKXtcclxuICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlBY3Rpb25zSW5zdGFuY2VzID0gZGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMuY29uY2F0KCBuZXdBY3Rpb25JbnN0YW5jZSApO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMucHVzaCggbmV3QWN0aW9uSW5zdGFuY2UgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBpbml0aWFsaXplRGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMoKTtcclxuICAgIFxyXG4gICAgdmFyIGdldFN0YXRpc3RpY3MgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHJldHVybiBzdGF0aXN0aWNzO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgdXBkYXRlRGljdGlvbmFyeUZvckRpY3Rpb25hcnlDaGFuZ2VzID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIGRpY3Rpb25hcnlDaGFuZ2VzICl7XHJcbiAgICAgICAgICAgIHV0aWxzLmV4dGVuZCggcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5LCBkaWN0aW9uYXJ5Q2hhbmdlcyApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBhZGRVcGRhdGVkVG9TdGF0aXN0aWNzID0gZnVuY3Rpb24oKXtcclxuICAgICAgICArK3N0YXRpc3RpY3MudG90YWxVcGRhdGVzO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGFkZFJlbW92ZWRUb1N0YXRpc3RpY3MgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICsrc3RhdGlzdGljcy5yZW1vdmVkTm9kZVVwZGF0ZXM7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgICAvLyBDaGVjayB0aGUgaW5kZXggd2FzIGJ1aWx0XHJcbiAgICAgICAgICAgIGlmICggISBwYXJzZXJPcHRpb25zLmluZGV4RXhwcmVzc2lvbnMgKXtcclxuICAgICAgICAgICAgICAgIHRocm93ICdVbmFibGUgdG8gdXBkYXRlLCBubyBpbmRleCBidWlsdCEgU2V0IGluZGV4RXhwcmVzc2lvbnMgdG8gdHJ1ZSEnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBJbml0IHNvbWUgdmFyc1xyXG4gICAgICAgICAgICBub2RlQXR0cmlidXRlcyA9IHt9O1xyXG4gICAgICAgICAgICBzdGF0aXN0aWNzID0ge1xyXG4gICAgICAgICAgICAgICAgdG90YWxVcGRhdGVzOiAwLFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlZE5vZGVVcGRhdGVzOiAwXHJcbiAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAvLyBEbyBhbGwgcmVxdWlyZWQgSFRNTCB1cGRhdGVzXHJcbiAgICAgICAgICAgIHVwZGF0ZUhUTUwoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgfSBjYXRjaCggZSApe1xyXG4gICAgICAgICAgICBsb2cuZmF0YWwoICdFeGl0aW5nIHJ1biBtZXRob2Qgb2YgdXBkYXRlIGNvbW1hbmQgb2YgWlBUIHdpdGggZXJyb3JzOiAnICsgZSApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmVycm9yRnVuY3Rpb24oIGUgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB1cGRhdGVIVE1MID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgaWYgKCB1cGRhdGVIVE1MRnJvbUFjdGlvbnMoIDAgKSApe1xyXG4gICAgICAgICAgICB1cGRhdGVIVE1MRnJvbVZhckNoYW5nZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciB1cGRhdGVIVE1MRnJvbUFjdGlvbnMgPSBmdW5jdGlvbiggaW5pdGlhbCApe1xyXG5cclxuICAgICAgICBmb3IgKCB2YXIgaSA9IGluaXRpYWw7IGkgPCBkaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcy5sZW5ndGg7ICsraSApe1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uSW5zdGFuY2UgPSBkaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlc1sgaSBdO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gVXBkYXRlIGRpY3Rpb25hcnkgdXNpbmcgYWN0aW9uXHJcbiAgICAgICAgICAgIGFjdGlvbkluc3RhbmNlLnVwZGF0ZURpY3Rpb25hcnkoIHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeSApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gR2V0IHRoZSBsaXN0IG9mIGNoYW5nZXMgcmVsYXRlZCB0byB2YXJOYW1lXHJcbiAgICAgICAgICAgIHZhciBsaXN0ID0gYXR0cmlidXRlSW5kZXguZ2V0VmFyc0xpc3QoIGFjdGlvbkluc3RhbmNlLmlkICk7XHJcbiAgICAgICAgICAgIGlmICggISBsaXN0ICl7XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gSXRlcmF0ZSBsaXN0IGFuZCB1cGRhdGUgSFRNTCBpZiByZXF1aXJlZFxyXG4gICAgICAgICAgICBpZiAoICEgdXBkYXRlSFRNTEZyb21WYXJzTGlzdCggYWN0aW9uSW5zdGFuY2UsIGksIDAsIGxpc3QgKSApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIGZvciAoIHZhciBqID0gMDsgaiA8IGxpc3QubGVuZ3RoOyBqKysgKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaW5kZXhJdGVtID0gbGlzdFsgaiBdO1xyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGFjdGlvbkluc3RhbmNlLmF0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkKCBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UgKSApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggISB1dGlscy5pc0Z1bmN0aW9uKCBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UudXBkYXRhYmxlRnJvbUFjdGlvbiApIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfHwgaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlLnVwZGF0YWJsZUZyb21BY3Rpb24oIHNlbGYsIGZpbmROb2RlQnlJZCggaW5kZXhJdGVtLm5vZGVJZCApICkgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYnVpbGREYXRhRnJvbVZhckNoYW5nZUV4Y2x1ZGluZyggYWN0aW9uSW5zdGFuY2UuaWQgKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIGlmICggISBhY3Rpb25JbnN0YW5jZS51cGRhdGVIVE1MKCBcclxuICAgICAgICAgICAgICAgICAgICBpbmRleEl0ZW0sIFxyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYsIFxyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkluc3RhbmNlLCBcclxuICAgICAgICAgICAgICAgICAgICB7IFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBhY3Rpb25JbnN0YW5jZTogYWN0aW9uSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGk6IGksIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBsaXN0OiBsaXN0LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpbml0aWFsSjogaiBcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICApICl7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICovXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHVwZGF0ZUhUTUxGcm9tVmFyc0xpc3QgPSBmdW5jdGlvbiggYWN0aW9uSW5zdGFuY2UsIGksIGluaXRpYWxKLCBsaXN0ICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSXRlcmF0ZSBsaXN0IGFuZCB1cGRhdGUgSFRNTCBpZiByZXF1aXJlZFxyXG4gICAgICAgIGZvciAoIHZhciBqID0gaW5pdGlhbEo7IGogPCBsaXN0Lmxlbmd0aDsgaisrICkge1xyXG4gICAgICAgICAgICB2YXIgaW5kZXhJdGVtID0gbGlzdFsgaiBdO1xyXG4gICAgICAgICAgICBpZiAoICEgYWN0aW9uSW5zdGFuY2UuYXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQoIGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZSApICl7XHJcbiAgICAgICAgICAgICAgICBpZiAoICEgdXRpbHMuaXNGdW5jdGlvbiggaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlLnVwZGF0YWJsZUZyb21BY3Rpb24gKSBcclxuICAgICAgICAgICAgICAgICAgICAgICAgfHwgaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlLnVwZGF0YWJsZUZyb21BY3Rpb24oIHNlbGYsIGZpbmROb2RlQnlJZCggaW5kZXhJdGVtLm5vZGVJZCApICkgKXtcclxuICAgICAgICAgICAgICAgICAgICBidWlsZERhdGFGcm9tVmFyQ2hhbmdlRXhjbHVkaW5nKCBhY3Rpb25JbnN0YW5jZS5pZCApO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICggISBhY3Rpb25JbnN0YW5jZS51cGRhdGVIVE1MKCBcclxuICAgICAgICAgICAgICAgIGluZGV4SXRlbSwgXHJcbiAgICAgICAgICAgICAgICBzZWxmLCBcclxuICAgICAgICAgICAgICAgIGFjdGlvbkluc3RhbmNlLCBcclxuICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uSW5zdGFuY2U6IGFjdGlvbkluc3RhbmNlLFxyXG4gICAgICAgICAgICAgICAgICAgIGk6IGksIFxyXG4gICAgICAgICAgICAgICAgICAgIGluaXRpYWxKOiBqLFxyXG4gICAgICAgICAgICAgICAgICAgIGxpc3Q6IGxpc3RcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKSApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGNvbnRpbnVlVXBkYXRlSFRNTCA9IGZ1bmN0aW9uKCBjb250aW51ZURhdGEgKXtcclxuXHJcbiAgICAgICAgdXBkYXRlSFRNTEZyb21WYXJzTGlzdChcclxuICAgICAgICAgICAgY29udGludWVEYXRhLmFjdGlvbkluc3RhbmNlLCBcclxuICAgICAgICAgICAgY29udGludWVEYXRhLmksIFxyXG4gICAgICAgICAgICBjb250aW51ZURhdGEuaW5pdGlhbEogKyAxLCBcclxuICAgICAgICAgICAgY29udGludWVEYXRhLmxpc3RcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggdXBkYXRlSFRNTEZyb21BY3Rpb25zKCBjb250aW51ZURhdGEuaSArIDEgKSApe1xyXG4gICAgICAgICAgICB1cGRhdGVIVE1MRnJvbVZhckNoYW5nZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBydW5BbmltYXRpb24gPSBmdW5jdGlvbiggYWN0aW9uSW5zdGFuY2UsIG5vZGUsIGNhbGxiYWNrICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVpbGQgY29tYmluZWRDYWxsYmFjayBjb21iaW5pbmcgY2FsbGJhY2sgYW5kIGFjdGlvbkluc3RhbmNlLmFuaW1hdGlvbkNhbGxiYWNrXHJcbiAgICAgICAgdmFyIGNvbWJpbmVkQ2FsbGJhY2sgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICAgICAgICAgaWYgKCBjYWxsYmFjayApe1xyXG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0QW5pbWF0aW9uTWFuYWdlcigpLnJlc2V0KCBub2RlICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZiAoIGFjdGlvbkluc3RhbmNlLmFuaW1hdGlvbkNhbGxiYWNrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBHZXQgYW5pbWF0aW9uIG1hbmFnZXIgdG8gcnVuIGFuaW1hdGlvblxyXG4gICAgICAgIGNvbnRleHQuZ2V0QW5pbWF0aW9uTWFuYWdlcigpLmFuaW1hdGUoIGFjdGlvbkluc3RhbmNlLCBub2RlLCBjb21iaW5lZENhbGxiYWNrICk7XHJcbiAgICB9O1xyXG4gICAgLypcclxuICAgIHZhciBydW5BbmltYXRpb24gPSBmdW5jdGlvbiggYWN0aW9uSW5zdGFuY2UsIG5vZGUsIGNhbGxiYWNrICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVpbGQgY29tYmluZWRDYWxsYmFjayBjb21iaW5pbmcgY2FsbGJhY2sgYW5kIGFjdGlvbkluc3RhbmNlLmFuaW1hdGlvbkNhbGxiYWNrXHJcbiAgICAgICAgdmFyIGNvbWJpbmVkQ2FsbGJhY2sgPSAhIGNhbGxiYWNrICYmICEgYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2s/IFxyXG4gICAgICAgICAgICB1bmRlZmluZWQ6XHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBpZiAoIGNhbGxiYWNrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICggYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2sgKXtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25JbnN0YW5jZS5hbmltYXRpb25DYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdldCBhbmltYXRpb24gbWFuYWdlciB0byBydW4gYW5pbWF0aW9uXHJcbiAgICAgICAgY29udGV4dC5nZXRBbmltYXRpb25NYW5hZ2VyKCkuYW5pbWF0ZSggYWN0aW9uSW5zdGFuY2UsIG5vZGUsIGNvbWJpbmVkQ2FsbGJhY2sgKTtcclxuICAgIH07XHJcbiAgICAqL1xyXG4gICAgXHJcbiAgICB2YXIgdXBkYXRlSFRNTEZyb21WYXJDaGFuZ2UgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFVwZGF0ZSBkaWN0aW9uYXJ5XHJcbiAgICAgICAgdXBkYXRlRGljdGlvbmFyeUZvckRpY3Rpb25hcnlDaGFuZ2VzKCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVpbGQgZGF0YVxyXG4gICAgICAgIGZvciAoIHZhciB2YXJOYW1lIGluIGRpY3Rpb25hcnlDaGFuZ2VzICl7XHJcbiAgICAgICAgICAgIGJ1aWxkRGF0YUZyb21WYXJDaGFuZ2UoIHZhck5hbWUgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIGF0dHJpYnV0ZXNcclxuICAgICAgICBmb3IgKCB2YXIgaSBpbiBub2RlQXR0cmlidXRlcyApIHtcclxuICAgICAgICAgICAgdmFyIGN1cnJlbnROb2RlQXR0cmlidXRlTGlzdCA9IG5vZGVBdHRyaWJ1dGVzWyBpIF07XHJcbiAgICAgICAgICAgIGZvciAoIHZhciBqIGluIGN1cnJlbnROb2RlQXR0cmlidXRlTGlzdCApe1xyXG4gICAgICAgICAgICAgICAgdXBkYXRlQXR0cmlidXRlKCBjdXJyZW50Tm9kZUF0dHJpYnV0ZUxpc3RbIGogXSApOyAgIFxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGJ1aWxkRGF0YUZyb21WYXJDaGFuZ2UgPSBmdW5jdGlvbiggdmFyTmFtZSApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdldCB0aGUgbGlzdCBvZiBjaGFuZ2VzIHJlbGF0ZWQgdG8gdmFyTmFtZVxyXG4gICAgICAgIHZhciBsaXN0ID0gYXR0cmlidXRlSW5kZXguZ2V0VmFyc0xpc3QoIHZhck5hbWUgKTtcclxuICAgICAgICBidWlsZERhdGFGcm9tTGlzdCggdmFyTmFtZSwgbGlzdCApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGJ1aWxkRGF0YUZyb21WYXJDaGFuZ2VFeGNsdWRpbmcgPSBmdW5jdGlvbiggdmFyTmFtZSApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdldCB0aGUgbGlzdCBvZiBjaGFuZ2VzIHJlbGF0ZWQgdG8gdmFyTmFtZVxyXG4gICAgICAgIHZhciBsaXN0ID0gYXR0cmlidXRlSW5kZXguZ2V0VmFyc0xpc3QoIHZhck5hbWUgKTtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgZmlsdGVyZWQgPSBsaXN0LmZpbHRlcihcclxuICAgICAgICAgICAgZnVuY3Rpb24oIGluZGV4SXRlbSwgaW5kZXgsIGFyciApe1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICEgQWJzdHJhY3RBcnJheUFjdGlvbi5zdGF0aWNBdHRyaWJ1dGVJbnN0YW5jZUlzUmVsYXRlZChcclxuICAgICAgICAgICAgICAgICAgICBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2VcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGJ1aWxkRGF0YUZyb21MaXN0KCB2YXJOYW1lLCBmaWx0ZXJlZCApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGJ1aWxkRGF0YUZyb21MaXN0ID0gZnVuY3Rpb24oIHZhck5hbWUsIGxpc3QgKXtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoICEgbGlzdCApe1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEJ1aWxkIGRhdGEgYWJvdXQgYWxsIGNoYW5nZXNcclxuICAgICAgICB2YXIgbGVuZ3RoID0gbGlzdC5sZW5ndGg7XHJcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgIGFkZE5ld05vZGVBdHRyaWJ1dGUoIHZhck5hbWUsIGxpc3RbIGkgXSApO1xyXG4gICAgICAgICAgICAvKlxyXG4gICAgICAgICAgICBpZiAoICEgYWRkTmV3Tm9kZUF0dHJpYnV0ZSggdmFyTmFtZSwgbGlzdFsgaSBdICkgKXtcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUluZGV4LnJlbW92ZVZhciggdmFyTmFtZSwgbGlzdFsgaSBdLm5vZGVJZCApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICovXHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGZpbmROb2RlQnlJZCA9IGZ1bmN0aW9uICggbm9kZUlkICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB3aW5kb3cuZG9jdW1lbnQucXVlcnlTZWxlY3RvciggXHJcbiAgICAgICAgICAgICdbJyArIGNvbnRleHQuZ2V0VGFncygpLmlkICsgJz1cIicgKyBub2RlSWQgKyAnXCJdJyBcclxuICAgICAgICApO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgYWRkTmV3Tm9kZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKCB2YXJOYW1lLCBpbmRleEl0ZW0gKXtcclxuXHJcbiAgICAgICAgdmFyIGF0dHJpYnV0ZUluc3RhbmNlID0gaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlO1xyXG4gICAgICAgIHZhciBub2RlID0gZmluZE5vZGVCeUlkKCBpbmRleEl0ZW0ubm9kZUlkICk7XHJcbiAgICAgICAgaWYgKCAhIG5vZGUgKXtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlZCBub2RlIVxyXG4gICAgICAgICAgICArK3N0YXRpc3RpY3MucmVtb3ZlZE5vZGVVcGRhdGVzO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBBZGQgZGF0YSB0byBub2RlRGF0YVxyXG4gICAgICAgIHZhciB0aGlzTm9kZURhdGEgPSBub2RlQXR0cmlidXRlc1sgaW5kZXhJdGVtLm5vZGVJZCBdO1xyXG4gICAgICAgIGlmICggISB0aGlzTm9kZURhdGEgKXtcclxuICAgICAgICAgICAgdGhpc05vZGVEYXRhID0ge307XHJcbiAgICAgICAgICAgIG5vZGVBdHRyaWJ1dGVzWyBpbmRleEl0ZW0ubm9kZUlkIF0gPSB0aGlzTm9kZURhdGE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhciBlbGVtZW50SWQgPSBpbmRleEl0ZW0uZ3JvdXBJZD8gXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLnR5cGUgKyAnLycgKyBpbmRleEl0ZW0uZ3JvdXBJZDogXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLnR5cGU7XHJcbiAgICAgICAgdGhpc05vZGVEYXRhWyBlbGVtZW50SWQgXSA9IGluZGV4SXRlbTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgdXBkYXRlQXR0cmlidXRlID0gZnVuY3Rpb24oIGluZGV4SXRlbSApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBhdHRyaWJ1dGVJbnN0YW5jZSA9IGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZTtcclxuICAgICAgICB2YXIgbm9kZSA9IGZpbmROb2RlQnlJZCggaW5kZXhJdGVtLm5vZGVJZCApO1xyXG4gICAgICAgIGlmICggISBub2RlICl7XHJcbiAgICAgICAgICAgIC8vIFJlbW92ZWQgbm9kZSFcclxuICAgICAgICAgICAgKytzdGF0aXN0aWNzLnJlbW92ZWROb2RlVXBkYXRlcztcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICArK3N0YXRpc3RpY3MudG90YWxVcGRhdGVzO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBzY29wZSA9IGdldE5vZGVTY29wZSggbm9kZSwgaW5kZXhJdGVtLm5vZGVJZCApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLnVwZGF0ZSggc2VsZiwgbm9kZSwgc2NvcGUsIGluZGV4SXRlbSApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZ2V0Tm9kZVNjb3BlID0gZnVuY3Rpb24oIG5vZGUsIG5vZGVJZCApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggISBub2RlSWQgKXtcclxuICAgICAgICAgICAgbm9kZUlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmlkICk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB0aGlzU2NvcGUgPSBzY29wZU1hcFsgbm9kZUlkIF07XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHRoaXNTY29wZSApe1xyXG4gICAgICAgICAgICB0aGlzU2NvcGUgPSBzY29wZUJ1aWxkZXIuYnVpbGQoIFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucywgXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHRydWVcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgc2NvcGVNYXBbIG5vZGVJZCBdID0gdGhpc1Njb3BlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcmV0dXJuIHRoaXNTY29wZTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciB1cGRhdGVOb2RlID0gZnVuY3Rpb24oIG5vZGUsIG11c3RSZW1vdmVHZW5lcmF0ZWROb2RlcyApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIFJlbW92ZSByZWxhdGVkIHRvIG5vZGUgbm9kZXNcclxuICAgICAgICBub2RlUmVtb3Zlci5yZW1vdmVNdWx0aXBsZU5vZGVzKCBub2RlLCBtdXN0UmVtb3ZlR2VuZXJhdGVkTm9kZXMgKTtcclxuICAgICAgICAvKlxyXG4gICAgICAgIGF0dHJpYnV0ZUluZGV4LnJlbW92ZU11bHRpcGxlTm9kZXMoXHJcbiAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZU11bHRpcGxlTm9kZXMoIG5vZGUsIG11c3RSZW1vdmVHZW5lcmF0ZWROb2RlcyApXHJcbiAgICAgICAgKTtcclxuICAgICAgICAqL1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEluc3RhbmNlIGFuZCBpbnZva2UgcGFyc2VyTm9kZVJlbmRlcmVyIHRvIHVwZGF0ZSBub2RlXHJcbiAgICAgICAgdmFyIHBhcnNlck5vZGVSZW5kZXJlciA9IG5ldyBQYXJzZXJOb2RlUmVuZGVyZXIoIFxyXG4gICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgc2NvcGVCdWlsZGVyLmJ1aWxkKCBcclxuICAgICAgICAgICAgICAgIHBhcnNlck9wdGlvbnMsIFxyXG4gICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICB1bmRlZmluZWQsXHJcbiAgICAgICAgICAgICAgICB0cnVlXHJcbiAgICAgICAgICAgICksXHJcbiAgICAgICAgICAgIHRydWVcclxuICAgICAgICApO1xyXG4gICAgICAgIHBhcnNlck5vZGVSZW5kZXJlci5ydW4oKTtcclxuICAgIH07XHJcbiAgICAvKlxyXG4gICAgdmFyIGRlbGV0ZU5vZGUgPSBmdW5jdGlvbiggbm9kZSApe1xyXG4gICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggbm9kZSApO1xyXG4gICAgfTtcclxuICAgICovXHJcbiAgICB2YXIgc2VsZiA9IHtcclxuICAgICAgICBydW46IHJ1bixcclxuICAgICAgICB1cGRhdGVOb2RlOiB1cGRhdGVOb2RlLFxyXG4gICAgICAgIC8vZGVsZXRlTm9kZTogZGVsZXRlTm9kZSxcclxuICAgICAgICBmaW5kTm9kZUJ5SWQ6IGZpbmROb2RlQnlJZCxcclxuICAgICAgICBnZXROb2RlU2NvcGU6IGdldE5vZGVTY29wZSxcclxuICAgICAgICBnZXRTdGF0aXN0aWNzOiBnZXRTdGF0aXN0aWNzLFxyXG4gICAgICAgIGFkZFVwZGF0ZWRUb1N0YXRpc3RpY3M6IGFkZFVwZGF0ZWRUb1N0YXRpc3RpY3MsXHJcbiAgICAgICAgYWRkUmVtb3ZlZFRvU3RhdGlzdGljczogYWRkUmVtb3ZlZFRvU3RhdGlzdGljcyxcclxuICAgICAgICBydW5BbmltYXRpb246IHJ1bkFuaW1hdGlvbixcclxuICAgICAgICBjb250aW51ZVVwZGF0ZUhUTUw6IGNvbnRpbnVlVXBkYXRlSFRNTFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHNlbGY7XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IFBhcnNlclVwZGF0ZXI7XHJcbiIsIi8qIFxuICAgIHJlc29sdmVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cbnZhciB1dGlscyA9IHJlcXVpcmUoICcuL3V0aWxzLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi9jb250ZXh0LmpzJyApO1xudmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCApIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgbWFjcm9zID0ge307XG4gICAgdmFyIHJlbW90ZVBhZ2VzID0ge307XG4gICAgXG4gICAgdmFyIGdldE5vZGUgPSBmdW5jdGlvbiggbWFjcm9LZXksIHNjb3BlICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIG5vZGUgPSBtYWNyb3NbIG1hY3JvS2V5IF07XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICAgICAgbm9kZSA9IGxvYWROb2RlKCBtYWNyb0tleSwgc2NvcGUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG5vZGU/IG5vZGUuY2xvbmVOb2RlKCB0cnVlICk6IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIC8qXG4gICAgdmFyIGlzUmVtb3RlID0gZnVuY3Rpb24oIG1hY3JvS2V5ICl7XG4gICAgICAgIHJldHVybiAtMSAhPSBtYWNyb0tleS5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5tYWNyb0RlbGltaXRlciApO1xuICAgIH07Ki9cbiAgICBcbiAgICB2YXIgZ2V0TWFjcm9EYXRhVXNpbmdFeHByZXNzaW9uID0gZnVuY3Rpb24gKCBtYWNyb0tleUV4cHJlc3Npb24sIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbWFjcm9LZXkgPSBtYWNyb0tleUV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbWFjcm9LZXkgKXtcbiAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgbWFjcm9JZDogbnVsbCxcbiAgICAgICAgICAgICAgICB1cmw6IG51bGxcbiAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBnZXRNYWNyb0RhdGEoIG1hY3JvS2V5LCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldE1hY3JvRGF0YVVzaW5nRXhwcmVzc2lvblN0cmluZyA9IGZ1bmN0aW9uICggbWFjcm9LZXlFeHByZXNzaW9uU3RyaW5nLCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIG1hY3JvS2V5RXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBtYWNyb0tleUV4cHJlc3Npb25TdHJpbmcgKTtcbiAgICAgICAgcmV0dXJuIGdldE1hY3JvRGF0YVVzaW5nRXhwcmVzc2lvbiggbWFjcm9LZXlFeHByZXNzaW9uLCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldE1hY3JvRGF0YSA9IGZ1bmN0aW9uICggbWFjcm9LZXksIHNjb3BlICl7XG5cbiAgICAgICAgdmFyIGluZGV4ID0gbWFjcm9LZXkuaW5kZXhPZiggY29udGV4dC5nZXRDb25mKCkubWFjcm9EZWxpbWl0ZXIgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpbmRleCA9PT0gLTE/XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWFjcm9JZDogbWFjcm9LZXksXG4gICAgICAgICAgICAgICAgdXJsOiBudWxsXG4gICAgICAgICAgICB9OlxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIG1hY3JvSWQ6IG1hY3JvS2V5LnN1YnN0cmluZyggMCwgaW5kZXggKSxcbiAgICAgICAgICAgICAgICB1cmw6IGJ1aWxkVVJMICggbWFjcm9LZXkuc3Vic3RyaW5nKCAxICsgaW5kZXggKSApXG4gICAgICAgICAgICB9O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGJ1aWxEZWZpbmVNYWNyb1NlbGVjdG9yID0gZnVuY3Rpb24oIG1hY3JvSWQgKXtcbiAgICAgICAgcmV0dXJuIFwiW1wiICsgZmlsdGVyU2VsZWN0b3IoIGNvbnRleHQuZ2V0VGFncygpLm1ldGFsRGVmaW5lTWFjcm8gKSArIFwiPSdcIiArIG1hY3JvSWQgKyBcIiddXCI7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgbG9hZE5vZGUgPSBmdW5jdGlvbiggbWFjcm9LZXksIHNjb3BlICl7XG5cbiAgICAgICAgdmFyIG1hY3JvRGF0YSA9IGdldE1hY3JvRGF0YSggbWFjcm9LZXksIHNjb3BlICk7XG5cbiAgICAgICAgaWYgKCBtYWNyb0RhdGEudXJsICl7XG4gICAgICAgICAgICAvLyBOb2RlIGlzIGluIGFub3RoZXIgcGFnZVxuICAgICAgICAgICAgcmV0dXJuIGxvYWRSZW1vdGVOb2RlKCBtYWNyb0tleSwgbWFjcm9EYXRhICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE5vIHVybCBzZXRcbiAgICAgICAgdmFyIHVybEluU2NvcGUgPSBzY29wZS5nZXQoIGNvbnRleHQuZ2V0Q29uZigpLmV4dGVybmFsTWFjcm9VcmxWYXJOYW1lICk7XG4gICAgICAgIGlmICggdXJsSW5TY29wZSApe1xuICAgICAgICAgICAgLy8gVHJ5IHRvIGZpbmQgbm9kZSBpbiBhbm90aGVyIHBhZ2UgYnV0IHVzaW5nIGEgcHJldmlvdXNseSBkZWZpbmVkIHVybFxuICAgICAgICAgICAgbWFjcm9EYXRhLnVybCA9IHVybEluU2NvcGU7XG4gICAgICAgICAgICB2YXIgcmVtb3RlTm9kZSA9IGxvYWRSZW1vdGVOb2RlKCBtYWNyb0tleSwgbWFjcm9EYXRhICk7XG4gICAgICAgICAgICBpZiAoIHJlbW90ZU5vZGUgKXtcbiAgICAgICAgICAgICAgICAvLyBOb2RlIGlzIGZvdW5kIGluIGFub3RoZXIgcGFnZVxuICAgICAgICAgICAgICAgIHJldHVybiByZW1vdGVOb2RlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBOb2RlIGlzIGluIHRoaXMgcGFnZVxuICAgICAgICB2YXIgbWFjcm9JZCA9IG1hY3JvRGF0YS5tYWNyb0lkO1xuICAgICAgICB2YXIgc2VsZWN0b3IgPSBidWlsRGVmaW5lTWFjcm9TZWxlY3RvciggbWFjcm9JZCApO1xuICAgICAgICB2YXIgbm9kZSA9IHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzZWxlY3RvciApO1xuXG4gICAgICAgIGlmICggISBub2RlICl7XG4gICAgICAgICAgICB0aHJvdyBcIk5vZGUgdXNpbmcgc2VsZWN0b3IgJ1wiICsgc2VsZWN0b3IgKyBcIicgaXMgbnVsbCFcIjtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBjb25maWd1cmVOb2RlKCBcbiAgICAgICAgICAgIG5vZGUuY2xvbmVOb2RlKCB0cnVlICksIFxuICAgICAgICAgICAgbWFjcm9JZCxcbiAgICAgICAgICAgIG1hY3JvS2V5ICk7XG4gICAgICAgIFxuICAgIH07XG4gICAgdmFyIGxvYWRSZW1vdGVOb2RlID0gZnVuY3Rpb24oIG1hY3JvS2V5LCBtYWNyb0RhdGEgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBlbGVtZW50ID0gcmVtb3RlUGFnZXNbIG1hY3JvRGF0YS51cmwgXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBlbGVtZW50ICl7XG4gICAgICAgICAgICB0aHJvdyAnTWFjcm9zIGluIFVSTCAnICsgbWFjcm9EYXRhLnVybCArICcgbm90IHByZWxvYWRlZCEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgc2VsZWN0b3IgPSBidWlsRGVmaW5lTWFjcm9TZWxlY3RvciggbWFjcm9EYXRhLm1hY3JvSWQgKTtcbiAgICAgICAgdmFyIG5vZGUgPSBlbGVtZW50LnF1ZXJ5U2VsZWN0b3IoIHNlbGVjdG9yICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGNvbmZpZ3VyZU5vZGUoIFxuICAgICAgICAgICAgICAgICAgICBub2RlLmNsb25lTm9kZSggdHJ1ZSApLCBcbiAgICAgICAgICAgICAgICAgICAgbWFjcm9EYXRhLm1hY3JvSWQsXG4gICAgICAgICAgICAgICAgICAgIG1hY3JvS2V5ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbGRSZW1vdGVQYWdlVXJsTGlzdCA9IGZ1bmN0aW9uKCBzY29wZSwgZGVjbGFyZWRSZW1vdGVQYWdlVXJscyApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlbW90ZVBhZ2VVcmxzID0gZGVjbGFyZWRSZW1vdGVQYWdlVXJscy5zbGljZSgpO1xuICAgICAgICBcbiAgICAgICAgdmFyIGxpc3QgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCBcbiAgICAgICAgICAgIFwiW1wiICsgZmlsdGVyU2VsZWN0b3IoIGNvbnRleHQuZ2V0VGFncygpLm1ldGFsVXNlTWFjcm8gKSArIFwiXVwiXG4gICAgICAgICk7XG4gICAgICAgIHZhciBjdXJyZW50TWFjcm9Vc2U7XG4gICAgICAgIHZhciBwb3MgPSAwO1xuICAgICAgICB3aGlsZSAoIGN1cnJlbnRNYWNyb1VzZSA9IGxpc3RbIHBvcysrIF0gKSB7XG4gICAgICAgICAgICB2YXIgbWFjcm9LZXlFeHByZXNzaW9uU3RyaW5nID0gY3VycmVudE1hY3JvVXNlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkubWV0YWxVc2VNYWNybyApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIHZhciBtYWNyb0RhdGEgPSBnZXRNYWNyb0RhdGFVc2luZ0V4cHJlc3Npb25TdHJpbmcoIG1hY3JvS2V5RXhwcmVzc2lvblN0cmluZywgc2NvcGUgKTtcblxuICAgICAgICAgICAgICAgIHZhciB1cmwgPSBtYWNyb0RhdGEudXJsO1xuICAgICAgICAgICAgICAgIGlmICggdXJsICYmIHJlbW90ZVBhZ2VVcmxzLmluZGV4T2YoIHVybCApID09PSAtMSApe1xuICAgICAgICAgICAgICAgICAgICByZW1vdGVQYWdlVXJscy5wdXNoKCB1cmwgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGNhdGNoICggZXhjZXB0aW9uICl7XG4gICAgICAgICAgICAgICAgLy8gTWFjcm9kYXRhIGNvdWxkIG5vdCBiZSByZXNvbHZlZCwgZG8gbm90aGluZ1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICByZXR1cm4gcmVtb3RlUGFnZVVybHM7XG4gICAgfTtcbiAgICBcbiAgICAvLyBBZGQgcHJlZmZpeCBpZiB0aGUgVVJMIGlzIG5vdCBhYnNvbHV0ZVxuICAgIHZhciBidWlsZFVSTCA9IGZ1bmN0aW9uKCBVUkwgKXtcbiAgICAgICAgcmV0dXJuIFVSTC5zdGFydHNXaXRoKCAnLycgKT8gVVJMOiBjb250ZXh0LmdldENvbmYoKS5leHRlcm5hbE1hY3JvUHJlZml4VVJMICsgVVJMO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGxvYWRSZW1vdGVQYWdlcyA9IGZ1bmN0aW9uKCBzY29wZSwgZGVjbGFyZWRSZW1vdGVQYWdlVXJscywgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayApe1xuXG4gICAgICAgIHZhciByZW1vdGVQYWdlVXJscyA9IGJ1aWxkUmVtb3RlUGFnZVVybExpc3QoIHNjb3BlLCBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzICk7XG4gICAgICAgIHZhciBwZW5kaW5nID0gcmVtb3RlUGFnZVVybHMubGVuZ3RoO1xuICAgICAgICByZW1vdGVQYWdlcyA9IHt9O1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIHBlbmRpbmcgKXtcbiAgICAgICAgICAgIGlmICggY2FsbGJhY2sgJiYgdXRpbHMuaXNGdW5jdGlvbiggY2FsbGJhY2sgKSApe1xuICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7ICAgXG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBjID0gMDsgYyA8IHJlbW90ZVBhZ2VVcmxzLmxlbmd0aDsgYysrICkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRQYWdlVXJsID0gYnVpbGRVUkwoIHJlbW90ZVBhZ2VVcmxzWyBjIF0gKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLyoganNoaW50IGxvb3BmdW5jOiB0cnVlICovXG4gICAgICAgICAgICB1dGlscy5hamF4KFxuICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiBjdXJyZW50UGFnZVVybCxcbiAgICAgICAgICAgICAgICAgICAgLy9kYXRhVHlwZTogJ2h0bWwnLFxuICAgICAgICAgICAgICAgICAgICBkb25lOiBmdW5jdGlvbiggaHRtbCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggJ2RpdicgKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGVsZW1lbnQuaW5uZXJIVE1MID0gaHRtbDtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlbW90ZVBhZ2VzWyB0aGlzLnVybCBdID0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICggLS1wZW5kaW5nID09IDAgJiYgY2FsbGJhY2sgJiYgdXRpbHMuaXNGdW5jdGlvbiggY2FsbGJhY2sgKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGZhaWw6IGZ1bmN0aW9uKCBqcVhIUiwgdGV4dFN0YXR1cywgZXJyb3IgKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmFzeW5jRXJyb3IoIGN1cnJlbnRQYWdlVXJsLCBlcnJvciwgZmFpbENhbGxiYWNrICk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgICQuYWpheCh7XG4gICAgICAgICAgICAgICAgdXJsOiBjdXJyZW50UGFnZVVybCxcbiAgICAgICAgICAgICAgICBkYXRhVHlwZTogJ2h0bWwnXG4gICAgICAgICAgICB9KS5kb25lKCBmdW5jdGlvbiggaHRtbCApIHtcbiAgICAgICAgICAgICAgICB2YXIgZWxlbWVudCA9ICQoICc8ZGl2PjwvZGl2PicgKTtcbiAgICAgICAgICAgICAgICBlbGVtZW50Lmh0bWwoIGh0bWwgKTtcbiAgICAgICAgICAgICAgICByZW1vdGVQYWdlc1sgdGhpcy51cmwgXSA9IGVsZW1lbnQ7XG4gICAgICAgICAgICAgICAgaWYgKCAtLXBlbmRpbmcgPT0gMCAmJiBjYWxsYmFjayAmJiB1dGlscy5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICl7XG4gICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSkuZmFpbCggZnVuY3Rpb24oIGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvciApIHtcbiAgICAgICAgICAgICAgICBjb250ZXh0LmFzeW5jRXJyb3IoIGN1cnJlbnRQYWdlVXJsLCBlcnJvciwgZmFpbENhbGxiYWNrICk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICovXG4gICAgICAgIH1cbiAgICB9O1xuICAgICAgICAgICAgICAgICAgXG4gICAgdmFyIGNvbmZpZ3VyZU5vZGUgPSBmdW5jdGlvbiggbm9kZSwgbWFjcm9JZCwgbWFjcm9LZXkgKXtcbiAgICAgICAgbm9kZS5yZW1vdmVBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLm1ldGFsRGVmaW5lTWFjcm8gKTtcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLm1ldGFsTWFjcm8sIG1hY3JvSWQgKTtcbiAgICAgICAgXG4gICAgICAgIG1hY3Jvc1sgbWFjcm9LZXkgXSA9IG5vZGU7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbm9kZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRNYWNyb0tleSA9IGZ1bmN0aW9uKCBtYWNyb0tleUV4cHJlc3Npb24sIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbWFjcm9EYXRhID0gZ2V0TWFjcm9EYXRhVXNpbmdFeHByZXNzaW9uKCBtYWNyb0tleUV4cHJlc3Npb24sIHNjb3BlICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbWFjcm9EYXRhLnVybD8gbWFjcm9EYXRhLm1hY3JvSWQgKyBjb250ZXh0LmdldENvbmYoKS5tYWNyb0RlbGltaXRlciArIG1hY3JvRGF0YS51cmw6IG1hY3JvRGF0YS5tYWNyb0lkO1xuICAgIH07XG4gICAgXG4gICAgLy8gTXVzdCBmaWx0ZXIgdG8gcmVwbGFjZSA6IGJ5IFxcXFw6XG4gICAgdmFyIGZpbHRlclNlbGVjdG9yID0gZnVuY3Rpb24oIHNlbGVjdG9yICl7XG4gICAgICAgIHJldHVybiBzZWxlY3Rvci5yZXBsYWNlKCAvOi9naSwgJ1xcXFw6JyApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0Tm9kZTogZ2V0Tm9kZSxcbiAgICAgICAgLy9pc1JlbW90ZTogaXNSZW1vdGUsXG4gICAgICAgIGxvYWRSZW1vdGVQYWdlczogbG9hZFJlbW90ZVBhZ2VzLFxuICAgICAgICBnZXRNYWNyb0RhdGE6IGdldE1hY3JvRGF0YSxcbiAgICAgICAgZ2V0TWFjcm9LZXk6IGdldE1hY3JvS2V5LFxuICAgICAgICBmaWx0ZXJTZWxlY3RvcjogZmlsdGVyU2VsZWN0b3JcbiAgICB9O1xufSkoKTtcbiIsIi8qIFxuICAgIFJlYWN0aXZlRGljdGlvbmFyeSBjbGFzcyBcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHpwdCA9IHJlcXVpcmUoICcuLi9tYWluLmpzJyApO1xuXG52YXIgUmVhY3RpdmVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oIF9ub25SZWFjdGl2ZURpY3Rpb25hcnksIF9pbml0aWFsQXV0b0NvbW1pdCApIHtcbiAgICBcbiAgICAvLyBJbml0IHNvbWUgdmFyc1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB0aGlzLl9wcml2YXRlU2NvcGUgPSB7XG4gICAgICAgIG5vblJlYWN0aXZlRGljdGlvbmFyeTogX25vblJlYWN0aXZlRGljdGlvbmFyeSxcbiAgICAgICAgYXV0b0NvbW1pdDogdHJ1ZSxcbiAgICAgICAgZGljdGlvbmFyeUNoYW5nZXM6IHt9LFxuICAgICAgICBkaWN0aW9uYXJ5QWN0aW9uczogW10sXG4gICAgICAgIGNvbW1pdDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHpwdC5ydW4oe1xuICAgICAgICAgICAgICAgIGNvbW1hbmQ6ICd1cGRhdGUnLFxuICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlDaGFuZ2VzOiBzZWxmLl9wcml2YXRlU2NvcGUuZGljdGlvbmFyeUNoYW5nZXMsXG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeUFjdGlvbnM6IHNlbGYuX3ByaXZhdGVTY29wZS5kaWN0aW9uYXJ5QWN0aW9uc1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZWxmLl9wcml2YXRlU2NvcGUuZGljdGlvbmFyeUNoYW5nZXMgPSB7fTtcbiAgICAgICAgICAgIHNlbGYuX3ByaXZhdGVTY29wZS5kaWN0aW9uYXJ5QWN0aW9ucyA9IFtdO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIC8vIERlZmluZSBzb21lIG1ldGhvZHNcbiAgICB0aGlzLl9nZXROb25SZWFjdGl2ZURpY3Rpb25hcnkgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdGhpcy5fcHJpdmF0ZVNjb3BlLm5vblJlYWN0aXZlRGljdGlvbmFyeTtcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuX2lzQXV0b0NvbW1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcml2YXRlU2NvcGUuYXV0b0NvbW1pdDtcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuX3NldEF1dG9Db21taXQgPSBmdW5jdGlvbiggX2F1dG9Db21taXQgKXtcbiAgICAgICAgdGhpcy5fcHJpdmF0ZVNjb3BlLmF1dG9Db21taXQgPSBfYXV0b0NvbW1pdDtcbiAgICB9O1xuICAgIFxuICAgIHRoaXMuX2NvbW1pdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHRoaXMuX3ByaXZhdGVTY29wZS5jb21taXQoKTtcbiAgICB9O1xuXG4gICAgdGhpcy5fYWRkQWN0aW9ucyA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5QWN0aW9ucyApe1xuICAgICAgICBcbiAgICAgICAgLy8gUmVjb3JkIHRoaXMgYWN0aW9ucyB0byBjb21taXQgaXQgbGF0ZXJcbiAgICAgICAgc2VsZi5fcHJpdmF0ZVNjb3BlLmRpY3Rpb25hcnlBY3Rpb25zID0gc2VsZi5fcHJpdmF0ZVNjb3BlLmRpY3Rpb25hcnlBY3Rpb25zLmNvbmNhdCggZGljdGlvbmFyeUFjdGlvbnMgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENvbW1pdCB0aGUgY2hhbmdlIG9ubHkgaWYgYXV0b0NvbW1pdCBpcyBvblxuICAgICAgICBpZiAoIHNlbGYuX2lzQXV0b0NvbW1pdCgpICl7XG4gICAgICAgICAgICBzZWxmLl9wcml2YXRlU2NvcGUuY29tbWl0KCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHRoaXMuX2FkZFZhcmlhYmxlID0gZnVuY3Rpb24oIGtleSwgdmFsdWUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIFNldCB0aGUgdmFsdWUgaW4gbm9uUmVhY3RpdmVEaWN0aW9uYXJ5XG4gICAgICAgIHNlbGYuX3ByaXZhdGVTY29wZS5ub25SZWFjdGl2ZURpY3Rpb25hcnlbIGtleSBdID0gdmFsdWU7XG4gICAgICAgIFxuICAgICAgICAvLyBEZWZpbmUgZ2V0dGVyIGFuZCBzZXR0ZXJcbiAgICAgICAgdGhpcy5fZGVmaW5lUHJvcGVydHkoIFxuICAgICAgICAgICAgdGhpcy5fcHJpdmF0ZVNjb3BlLm5vblJlYWN0aXZlRGljdGlvbmFyeSwgXG4gICAgICAgICAgICBrZXkgXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHRoaXMuX2RlZmluZVByb3BlcnR5ID0gZnVuY3Rpb24oIGRpY3Rpb25hcnksIGtleSApe1xuXG4gICAgICAgIC8vIERlZmluZSBwcm9wZXJ0eSB0byBzZXQgZ2V0dGVyIGFuZCBzZXR0ZXJcbiAgICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxuICAgICAgICAgICAgc2VsZiwgXG4gICAgICAgICAgICBrZXksIFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY29uZmlndXJhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkgeyBcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGRpY3Rpb25hcnlbIGtleSBdO1xuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgc2V0OiBmdW5jdGlvbiAoIHZhbHVlICkge1xuICAgICAgICAgICAgICAgICAgICAvLyBSZWNvcmQgdGhpcyBjaGFuZ2UgdG8gY29tbWl0IGl0IGxhdGVyXG4gICAgICAgICAgICAgICAgICAgIHNlbGYuX3ByaXZhdGVTY29wZS5kaWN0aW9uYXJ5Q2hhbmdlc1sga2V5IF0gPSB2YWx1ZTtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDb21taXQgdGhlIGNoYW5nZSBvbmx5IGlmIGF1dG9Db21taXQgaXMgb25cbiAgICAgICAgICAgICAgICAgICAgaWYgKCBzZWxmLl9pc0F1dG9Db21taXQoKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fcHJpdmF0ZVNjb3BlLmNvbW1pdCgpO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgLy8gSW5pdGlhbGl6ZVxuICAgIHRoaXMuX2luaXRpYWxpemUgPSBmdW5jdGlvbiggZGljdGlvbmFyeSApe1xuICAgICAgICBcbiAgICAgICAgLy8gSW5pdGlhbGl6ZSBhdXRvQ29tbWl0XG4gICAgICAgIGlmICggX2luaXRpYWxBdXRvQ29tbWl0ICE9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgIHRoaXMuX3NldEF1dG9Db21taXQoIF9pbml0aWFsQXV0b0NvbW1pdCApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJdGVyYXRlIHByb3BlcnRpZXMgaW4gZGljdGlvbmFyeSB0byBkZWZpbmUgc2V0dGVycyBhbmQgZ2V0dGVyc1xuICAgICAgICB2YXIga2V5cyA9IE9iamVjdC5rZXlzKCBkaWN0aW9uYXJ5ICk7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKysgKXtcbiAgICAgICAgICAgIHZhciBrZXkgPSBrZXlzWyBpIF07XG4gICAgICAgICAgICB2YXIgcHJvcGVydHkgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKCBkaWN0aW9uYXJ5LCBrZXkgKTtcbiAgICAgICAgICAgIGlmICggcHJvcGVydHkgJiYgcHJvcGVydHkuY29uZmlndXJhYmxlID09PSBmYWxzZSApIHtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRGVmaW5lIGdldHRlciBhbmQgc2V0dGVyXG4gICAgICAgICAgICAoZnVuY3Rpb24oIGtleSApIHtcbiAgICAgICAgICAgICAgICBzZWxmLl9kZWZpbmVQcm9wZXJ0eSggZGljdGlvbmFyeSwga2V5ICk7XG4gICAgICAgICAgICB9KSgga2V5ICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIHRoaXMuX2luaXRpYWxpemUoIHRoaXMuX3ByaXZhdGVTY29wZS5ub25SZWFjdGl2ZURpY3Rpb25hcnkgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUmVhY3RpdmVEaWN0aW9uYXJ5O1xuIiwiLyogXG4gICAgQ2xhc3MgU2NvcGUgXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vdXRpbHMuanMnICk7XG52YXIgbG9hZGpzID0gcmVxdWlyZSggJ2xvYWRqcycgKTtcblxudmFyIFNjb3BlID0gZnVuY3Rpb24oIF9kaWN0aW9uYXJ5LCBfZGljdGlvbmFyeUV4dGVuc2lvbiwgYWRkQ29tbW9uVmFycywgX2ZvbGRlckRpY3Rpb25hcmllcyApIHtcbiAgICBcbiAgICB0aGlzLmRpY3Rpb25hcnkgPSBfZGljdGlvbmFyeSB8fCB7fTtcbiAgICB0aGlzLmRpY3Rpb25hcnlFeHRlbnNpb24gPSBfZGljdGlvbmFyeUV4dGVuc2lvbiB8fCB7fTtcbiAgICB0aGlzLnZhcnMgPSB7fTtcbiAgICB0aGlzLmNoYW5nZXNTdGFjayA9IFtdO1xuICAgIHRoaXMubm9jYWxsVmFycyA9IHt9O1xuICAgIHRoaXMuZm9sZGVyRGljdGlvbmFyaWVzID0gX2ZvbGRlckRpY3Rpb25hcmllcyB8fCBbXTtcbiAgICB0aGlzLmdsb2JhbFZhcnNFeHByZXNzaW9ucyA9IHt9O1xuICAgIFxuICAgIGlmICggYWRkQ29tbW9uVmFycyApe1xuICAgICAgICB0aGlzLnNldENvbW1vblZhcnMoKTtcbiAgICB9XG4gICAgdGhpcy5zZXRNYW5kYXRvcnlWYXJzKCk7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuc2V0TWFuZGF0b3J5VmFycyA9IGZ1bmN0aW9uKCl7XG5cbiAgICAvLyBSZWdpc3RlciBub3RoaW5nIHZhclxuICAgIHRoaXMuc2V0VmFyKCBcbiAgICAgICAgY29udGV4dC5nZXRDb25mKCkubm90aGluZ1Zhck5hbWUsIFxuICAgICAgICBjb250ZXh0LmdldENvbmYoKS5ub3RoaW5nVmFyVmFsdWUgXG4gICAgKTtcbiAgICBcbiAgICAvLyBSZWdpc3RlciBkZWZhdWx0IHZhclxuICAgIHRoaXMuc2V0VmFyKCBcbiAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZGVmYXVsdFZhck5hbWUsIFxuICAgICAgICBjb250ZXh0LmdldENvbmYoKS5kZWZhdWx0VmFyVmFsdWUgXG4gICAgKTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5zZXRDb21tb25WYXJzID0gZnVuY3Rpb24oKXtcbiAgICBcbiAgICAvLyBSZWdpc3RlciB3aW5kb3cgb2JqZWN0IGlmIGl0IGV4aXN0c1xuICAgIGlmICggd2luZG93ICl7XG4gICAgICAgIHRoaXMuc2V0VmFyKCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLndpbmRvd1Zhck5hbWUsIFxuICAgICAgICAgICAgd2luZG93IFxuICAgICAgICApO1xuICAgIH1cblxuICAgIC8vIFJlZ2lzdGVyIGNvbnRleHRcbiAgICB0aGlzLnNldFZhciggXG4gICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmNvbnRleHRWYXJOYW1lLCBcbiAgICAgICAgY29udGV4dCBcbiAgICApO1xufTtcblxuU2NvcGUucHJvdG90eXBlLnN0YXJ0RWxlbWVudCA9IGZ1bmN0aW9uKCl7XG4gICAgXG4gICAgdmFyIHZhcnMgPSB7XG4gICAgICAgIHZhcnNUb1Vuc2V0OiBbXSxcbiAgICAgICAgdmFyc1RvU2V0OiB7fSxcbiAgICAgICAgZXhwcmVzc2lvbnM6IHt9LFxuICAgICAgICBpbXBsaWVkRGVjbGFyZWRWYXJzOiBbXVxuICAgIH07XG5cbiAgICB0aGlzLmNoYW5nZXNTdGFjay5wdXNoKCB2YXJzICk7XG5cbiAgICByZXR1cm4gdmFycztcbn07XG5cblNjb3BlLnByb3RvdHlwZS5jdXJyZW50VmFycyA9IGZ1bmN0aW9uKCl7XG4gICAgcmV0dXJuIHRoaXMuY2hhbmdlc1N0YWNrWyB0aGlzLmNoYW5nZXNTdGFjay5sZW5ndGggLSAxIF07XG59O1xuXG5TY29wZS5wcm90b3R5cGUuc2V0VmFyID0gZnVuY3Rpb24oIG5hbWUsIHZhbHVlICkge1xuICAgIHRoaXMudmFyc1sgbmFtZSBdID0gdmFsdWU7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuZ2V0V2l0aG91dEV2YWx1YXRpbmcgPSBmdW5jdGlvbiggbmFtZSApIHtcbiAgICBcbiAgICB2YXIgdmFsdWU7XG4gICAgXG4gICAgdmFsdWUgPSB0aGlzLnZhcnNbIG5hbWUgXTtcbiAgICBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBcbiAgICB2YWx1ZSA9IHRoaXMuZGljdGlvbmFyeUV4dGVuc2lvblsgbmFtZSBdO1xuICAgIGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIFxuICAgIHZhbHVlID0gdGhpcy5kaWN0aW9uYXJ5WyBuYW1lIF07XG4gICAgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgXG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgdGhpcy5mb2xkZXJEaWN0aW9uYXJpZXMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdmFsdWUgPSB0aGlzLmZvbGRlckRpY3Rpb25hcmllc1sgaSBdWyBuYW1lIF07XG4gICAgICAgIGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApe1xuICAgICAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24oIG5hbWUgKSB7XG5cbiAgICB2YXIgdmFsdWUgPSB0aGlzLmdldFdpdGhvdXRFdmFsdWF0aW5nKCBuYW1lICk7XG4gICAgXG4gICAgaWYgKCAhIHRoaXMubm9jYWxsVmFyc1sgbmFtZSBdICl7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHZhbHVlICYmIHV0aWxzLmlzRnVuY3Rpb24oIHZhbHVlLmV2YWx1YXRlICk/XG4gICAgICAgIHZhbHVlLmV2YWx1YXRlKCB0aGlzICk6IFxuICAgICAgICAnRXJyb3IgZXZhbHVhdGluZyBwcm9wZXJ0eSBcIicgKyBuYW1lICsgJ1wiOiAnICsgdmFsdWU7XG59O1xuXG5TY29wZS5wcm90b3R5cGUudW5zZXQgPSBmdW5jdGlvbiggbmFtZSApIHtcbiAgICBkZWxldGUgdGhpcy52YXJzWyBuYW1lIF07XG59O1xuXG5TY29wZS5wcm90b3R5cGUuZW5kRWxlbWVudCA9IGZ1bmN0aW9uICggKSB7XG5cbiAgICB2YXIgdmFycyA9IHRoaXMuY2hhbmdlc1N0YWNrLnBvcCgpOyBcblxuICAgIHZhciB2YXJzVG9VbnNldCA9IHZhcnMudmFyc1RvVW5zZXQ7XG4gICAgdmFyIHZhcnNUb1NldCA9IHZhcnMudmFyc1RvU2V0OyBcblxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHZhcnNUb1Vuc2V0Lmxlbmd0aDsgKytpICl7XG4gICAgICAgIHRoaXMudW5zZXQoIHZhcnNUb1Vuc2V0WyBpIF0gKTtcbiAgICB9XG5cbiAgICBmb3IgKCB2YXIgbmFtZSBpbiB2YXJzVG9TZXQgKXtcbiAgICAgICAgdmFyIHZhbHVlID0gdmFyc1RvU2V0WyBuYW1lIF07XG4gICAgICAgIHRoaXMuc2V0VmFyKCBuYW1lLCB2YWx1ZSApO1xuICAgIH1cbn07XG5cblNjb3BlLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbiAoIG5hbWUsIHZhbHVlLCBpc0dsb2JhbCwgbm9jYWxsLCBfZXhwcmVzc2lvbiApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbiA9IF9leHByZXNzaW9uID09PSB1bmRlZmluZWQ/IG51bGw6IF9leHByZXNzaW9uO1xuICAgIFxuICAgIGlmICggISBpc0dsb2JhbCApe1xuXG4gICAgICAgIC8vIExvY2FsIHZhcnNcbiAgICAgICAgdmFyIHZhcnMgPSB0aGlzLmN1cnJlbnRWYXJzKCk7XG4gICAgICAgIHZhciBjdXJyZW50VmFsdWUgPSB0aGlzLmdldFdpdGhvdXRFdmFsdWF0aW5nKCBuYW1lICk7XG5cbiAgICAgICAgaWYgKCBjdXJyZW50VmFsdWUgIT0gbnVsbCApe1xuICAgICAgICAgICAgdmFycy52YXJzVG9TZXRbIG5hbWUgXSA9IGN1cnJlbnRWYWx1ZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFycy52YXJzVG9VbnNldC5wdXNoKCBuYW1lICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhcnMuZXhwcmVzc2lvbnNbIG5hbWUgXSA9IGV4cHJlc3Npb247XG4gICAgICAgIFxuICAgICAgICBpZiAoIHRoaXMuaXNTdHJpY3RNb2RlKCkgKXtcbiAgICAgICAgICAgIHZhcnMuaW1wbGllZERlY2xhcmVkVmFycy5wdXNoKCBuYW1lICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgfSBlbHNlIHtcbiAgICAgICAgXG4gICAgICAgIC8vIEdsb2JhbCB2YXJzXG4gICAgICAgIHRoaXMuZ2xvYmFsVmFyc0V4cHJlc3Npb25zWyBuYW1lIF0gPSBleHByZXNzaW9uOyBcbiAgICB9XG4gICAgXG4gICAgLy8gQ29tbW9uIHRvIGdsb2JhbCBhbmQgbG9jYWwgdmFyc1xuICAgIHRoaXMuc2V0VmFyKCBuYW1lLCB2YWx1ZSApO1xuICAgIFxuICAgIC8vIEFkZCB0byBub2NhbGxWYXJzIGlmIG5lZWRlZFxuICAgIGlmICggbm9jYWxsICl7XG4gICAgICAgIHRoaXMubm9jYWxsVmFyc1sgbmFtZSBdID0gdHJ1ZTtcbiAgICB9XG59O1xuXG5TY29wZS5wcm90b3R5cGUubG9hZEZvbGRlckRpY3Rpb25hcmllc0FzeW5jID0gZnVuY3Rpb24gKCBtYXhGb2xkZXJEaWN0aW9uYXJpZXMsIGxvY2F0aW9uLCBjYWxsYmFjayApIHtcbiAgICBcbiAgICBpZiAoICEgbWF4Rm9sZGVyRGljdGlvbmFyaWVzICkge1xuICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIHZhciB1cmxMaXN0ID0gdGhpcy5idWlsZFVybExpc3RPZkZvbGRlckRpY3Rpb25hcmllcyggbWF4Rm9sZGVyRGljdGlvbmFyaWVzLCBsb2NhdGlvbiApO1xuICAgIHRoaXMubG9hZEZvbGRlckRpY3Rpb25hcnkoXG4gICAgICAgIG1heEZvbGRlckRpY3Rpb25hcmllcyxcbiAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgIHVybExpc3QsIFxuICAgICAgICAwXG4gICAgKTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5sb2FkRm9sZGVyRGljdGlvbmFyeSA9IGZ1bmN0aW9uICggbWF4Rm9sZGVyRGljdGlvbmFyaWVzLCBjYWxsYmFjaywgdXJsTGlzdCwgaSApIHtcbiAgICBcbiAgICB2YXIgaW5zdGFuY2UgPSB0aGlzO1xuICAgIFxuICAgIHZhciBsb2FkanNDYWxsYmFjayA9IGZ1bmN0aW9uKCB1cmwsIHN1Y2Nlc3MgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyZWF0IGpzIGZpbGUgb25seSBpZiBsb2FkIGlzIHN1Y2Vzc2Z1bGxcbiAgICAgICAgaWYgKCBzdWNjZXNzICYmIHdpbmRvdy5mb2xkZXJEaWN0aW9uYXJ5ICl7XG4gICAgICAgICAgICBpbnN0YW5jZS5mb2xkZXJEaWN0aW9uYXJpZXMucHVzaCggd2luZG93LmZvbGRlckRpY3Rpb25hcnkgKTtcbiAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgIC8vIFJ1biBjYWxsYmFjayBhbmQgcmV0dXJuIGlmIHRoZSB1cmxMaXN0IGlzIG92ZXJcbiAgICAgICAgaWYgKCBpID09PSB1cmxMaXN0Lmxlbmd0aCl7XG4gICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ29udGludWUsIHRoZSB1cmxMaXN0IGlzIG5vdCBvdmVyXG4gICAgICAgIGluc3RhbmNlLmxvYWRGb2xkZXJEaWN0aW9uYXJ5KFxuICAgICAgICAgICAgbWF4Rm9sZGVyRGljdGlvbmFyaWVzLCBcbiAgICAgICAgICAgIGNhbGxiYWNrLFxuICAgICAgICAgICAgdXJsTGlzdCwgXG4gICAgICAgICAgICBpXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXJsID0gdXJsTGlzdFsgaSsrIF07XG4gICAgbG9hZGpzKFxuICAgICAgICB1cmwsIFxuICAgICAgICB7XG4gICAgICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbigpIHsgXG4gICAgICAgICAgICAgICAgbG9hZGpzQ2FsbGJhY2soIHVybCwgdHJ1ZSApO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGVycm9yOiBmdW5jdGlvbigpIHsgXG4gICAgICAgICAgICAgICAgbG9hZGpzQ2FsbGJhY2soIHVybCwgZmFsc2UgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICk7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuYnVpbGRVcmxMaXN0T2ZGb2xkZXJEaWN0aW9uYXJpZXMgPSBmdW5jdGlvbiAoIG1heEZvbGRlckRpY3Rpb25hcmllcywgbG9jYXRpb24gKSB7XG4gICAgXG4gICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgIFxuICAgIHZhciBjID0gMDtcbiAgICB2YXIgcGF0aCA9IGxvY2F0aW9uLnBhdGhuYW1lO1xuICAgIHZhciBsYXN0SW5kZXggPSBwYXRoLmxhc3RJbmRleE9mKCAnLycgKTtcbiAgICB3aGlsZSAoIGxhc3RJbmRleCAhPT0gLTEgJiYgKytjIDw9IG1heEZvbGRlckRpY3Rpb25hcmllcyApe1xuICAgICAgICB2YXIgcGFyZW50ID0gcGF0aC5zdWJzdHIoIDAsIGxhc3RJbmRleCApO1xuICAgICAgICByZXN1bHQucHVzaCggXG4gICAgICAgICAgICBsb2NhdGlvbi5vcmlnaW4gKyBwYXJlbnQgKyAnLycgKyAnZm9sZGVyRGljdGlvbmFyeS5qcycgXG4gICAgICAgICk7XG4gICAgICAgIGxhc3RJbmRleCA9IHBhcmVudC5sYXN0SW5kZXhPZiggJy8nICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuaXNTdHJpY3RNb2RlID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gY29udGV4dC5pc1N0cmljdE1vZGUoKSB8fCB0aGlzLmdldCggY29udGV4dC5nZXRDb25mKCkuc3RyaWN0TW9kZVZhck5hbWUgKTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5pc1ZhbGlkVmFyaWFibGUgPSBmdW5jdGlvbiggbmFtZSApe1xuICAgIFxuICAgIC8vIElmIHN0cmljdCBtb2RlIGlzIG9mZiBhbGwgdmFyaWFibGUgYXJlIHZhbGlkXG4gICAgaWYgKCAhIHRoaXMuaXNTdHJpY3RNb2RlKCkgKXtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIFxuICAgIC8vIElmIHRoZSB2YXJpYWJsZSBpcyBkZWNsYXJlZCByZXR1cm4gdHJ1ZVxuICAgIHZhciBkZWNsYXJlZCA9IHRoaXMuZ2V0KCBjb250ZXh0LmdldENvbmYoKS5kZWNsYXJlZFZhcnNWYXJOYW1lICk7XG4gICAgdmFyIGlzRGVjbGFyZWQgPSBkZWNsYXJlZCAmJiBkZWNsYXJlZC5pbmRleE9mPyBcbiAgICAgICAgZGVjbGFyZWQuaW5kZXhPZiggbmFtZSApICE9PSAtMTogXG4gICAgICAgIGZhbHNlO1xuICAgIGlmICggaXNEZWNsYXJlZCApe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgdGhlIHZhcmlhYmxlIGlzIGltcGxpY2l0bHkgZGVjbGFyZWRcbiAgICBmb3IgKCB2YXIgaSA9IHRoaXMuY2hhbmdlc1N0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pICl7XG4gICAgICAgIHZhciB2YXJzID0gdGhpcy5jaGFuZ2VzU3RhY2tbIGkgXTtcbiAgICAgICAgdmFyIGlzSW1wbGllZCA9IHZhcnMuaW1wbGllZERlY2xhcmVkVmFycy5pbmRleE9mKCBuYW1lICkgIT09IC0xO1xuICAgICAgICBpZiAoIGlzSW1wbGllZCApe1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmdldFZhckV4cHJlc3Npb24gPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb24gPSB0aGlzLmdldEV4cHJlc3Npb25Gcm9tTG9jYWwoIG5hbWUgKTtcbiAgICByZXR1cm4gZXhwcmVzc2lvbiAhPT0gdW5kZWZpbmVkPyBleHByZXNzaW9uOiB0aGlzLmdsb2JhbFZhcnNFeHByZXNzaW9uc1sgbmFtZSBdO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmdldEV4cHJlc3Npb25Gcm9tTG9jYWwgPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG5cbiAgICBmb3IgKCB2YXIgaSA9IHRoaXMuY2hhbmdlc1N0YWNrLmxlbmd0aCAtIDE7IGkgPj0gMDsgLS1pICl7XG4gICAgICAgIHZhciB2YXJzID0gdGhpcy5jaGFuZ2VzU3RhY2tbIGkgXTtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24gPSB2YXJzLmV4cHJlc3Npb25zWyBuYW1lIF07XG4gICAgICAgIGlmICggZXhwcmVzc2lvbiAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvbjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmlzTG9jYWxWYXIgPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG4gICAgcmV0dXJuIHRoaXMudmFyc1sgbmFtZSBdICE9PSB1bmRlZmluZWQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNjb3BlO1xuIiwiLyogXG4gICAgc2NvcGVCdWlsZGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xudmFyIFNjb3BlID0gcmVxdWlyZSggJy4vc2NvcGUuanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vdXRpbHMuanMnICk7XG52YXIgUGFyc2VyTm9kZVJlbmRlcmVyID0gcmVxdWlyZSggJy4uL3BhcnNlcnMvcGFyc2VyTm9kZVJlbmRlcmVyLmpzJyApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcbiAgICB2YXIga2V5TGVuZ3RoID0gNjtcbiAgICBcbiAgICB2YXIgYnVpbGQgPSBmdW5jdGlvbiggcGFyc2VyT3B0aW9ucywgdGFyZ2V0LCBkaWN0aW9uYXJ5RXh0ZW5zaW9uLCBtdXN0VXBkYXRlICkge1xuXG4gICAgICAgIHZhciBzY29wZSA9IG5ldyBTY29wZSggXG4gICAgICAgICAgICBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnksIFxuICAgICAgICAgICAgZGljdGlvbmFyeUV4dGVuc2lvbiwgXG4gICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgY29udGV4dC5nZXRGb2xkZXJEaWN0aW9uYXJpZXMoKVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBtdXN0VXBkYXRlICl7XG4gICAgICAgICAgICB1cGRhdGUoIHBhcnNlck9wdGlvbnMsIHRhcmdldCwgc2NvcGUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHNjb3BlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCBwYXJzZXJPcHRpb25zLCB0YXJnZXQsIHNjb3BlICkge1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHJvb3Qga2V5XG4gICAgICAgIHZhciByb290TWFwID0gbWFya0FsbFJvb3RzKCBwYXJzZXJPcHRpb25zICk7XG4gICAgICAgIHZhciByb290S2V5VGFnID0gZ2V0Um9vdEtleVRhZygpO1xuICAgICAgICB2YXIgcm9vdCA9IGdldFJvb3QoIHBhcnNlck9wdGlvbnMsIHRhcmdldCwgcm9vdE1hcCApO1xuICAgICAgICB2YXIgcm9vdEtleSA9ICByb290LmdldEF0dHJpYnV0ZSggcm9vdEtleVRhZyApO1xuICAgICAgICBcbiAgICAgICAgdmFyIHRhbERlZmluZVRhZyA9IGNvbnRleHQuZ2V0VGFncygpLnRhbERlZmluZTtcbiAgICAgICAgdmFyIHRhbEF1dG9EZWZpbmVUYWcgPSBjb250ZXh0LmdldFRhZ3MoKS50YWxBdXRvRGVmaW5lO1xuICAgICAgICBcbiAgICAgICAgdmFyIG5vZGUgPSB0YXJnZXQucGFyZW50Tm9kZTtcbiAgICAgICAgdmFyIGMgPSAwO1xuICAgICAgICB2YXIgaXRlbXNMaXN0ID0gW107XG4gICAgICAgIFxuICAgICAgICBkbyB7XG4gICAgICAgICAgICAvLyBBZGQgdGFsRGVmaW5lXG4gICAgICAgICAgICB2YXIgdGFsRGVmaW5lID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhbERlZmluZVRhZyApO1xuICAgICAgICAgICAgaWYgKCB0YWxEZWZpbmUgKXtcbiAgICAgICAgICAgICAgICBpdGVtc0xpc3QucHVzaCggdGFsRGVmaW5lICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEFkZCB0YWxBdXRvRGVmaW5lXG4gICAgICAgICAgICB2YXIgdGFsQXV0b0RlZmluZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWxBdXRvRGVmaW5lVGFnICk7XG4gICAgICAgICAgICBpZiAoIHRhbEF1dG9EZWZpbmUgKXtcbiAgICAgICAgICAgICAgICBpdGVtc0xpc3QucHVzaCggdGFsQXV0b0RlZmluZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgbm9kZUtleSA9IG5vZGUuZ2V0QXR0cmlidXRlKCByb290S2V5VGFnICk7XG4gICAgICAgICAgICBpZiAoIG5vZGVLZXkgJiYgbm9kZUtleSA9PT0gcm9vdEtleSApe1xuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzTGlzdE9mRGVmaW5lcyggXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgICAgICAgICAgaXRlbXNMaXN0LCBcbiAgICAgICAgICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5pbmRleEV4cHJlc3Npb25zXG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgbm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IHdoaWxlICggbm9kZS5ub2RlVHlwZSAhPT0gOSAmJiArK2MgPCAxMDAgKTtcbiAgICAgICAgXG4gICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gdXBkYXRlIHNjb3BlOiByb290IG5vdCBmb3VuZCEnO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHByb2Nlc3NMaXN0T2ZEZWZpbmVzID0gZnVuY3Rpb24oIHNjb3BlLCBpdGVtc0xpc3QsIG5vZGUsIGluZGV4RXhwcmVzc2lvbnMgKXtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBjID0gaXRlbXNMaXN0Lmxlbmd0aCAtIDE7IGMgPj0gMDsgYy0tICkge1xuICAgICAgICAgICAgdmFyIHRhbERlZmluZSA9IGl0ZW1zTGlzdFsgYyBdO1xuICAgICAgICAgICAgUGFyc2VyTm9kZVJlbmRlcmVyLnByb2Nlc3NEZWZpbmUoXG4gICAgICAgICAgICAgICAgbm9kZSwgXG4gICAgICAgICAgICAgICAgdGFsRGVmaW5lLCBcbiAgICAgICAgICAgICAgICB0cnVlLFxuICAgICAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnNcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRSb290ID0gZnVuY3Rpb24oIHBhcnNlck9wdGlvbnMsIHRhcmdldCwgcm9vdE1hcCApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIEFycmF5LmlzQXJyYXkoIHBhcnNlck9wdGlvbnMucm9vdCApICl7IFxuICAgICAgICAgICAgcmV0dXJuIHBhcnNlck9wdGlvbnMucm9vdDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIHJvb3RLZXlUYWcgPSBnZXRSb290S2V5VGFnKCk7XG4gICAgICAgIHZhciBub2RlID0gdGFyZ2V0O1xuICAgICAgICB2YXIgYyA9IDA7XG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIHZhciByb290S2V5ID0gIG5vZGUuZ2V0QXR0cmlidXRlKCByb290S2V5VGFnICk7XG4gICAgICAgICAgICBpZiAoIHJvb3RLZXkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gcm9vdE1hcFsgcm9vdEtleSBdO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuXG4gICAgICAgIH0gd2hpbGUgKCBub2RlLm5vZGVUeXBlICE9PSA5ICYmICsrYyA8IDEwMCApO1xuICAgICAgICBcbiAgICAgICAgdGhyb3cgJ0Vycm9yIHRyeWluZyB0byBnZXQgcm9vdDogbm90IGZvdW5kISc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgbWFya0FsbFJvb3RzID0gZnVuY3Rpb24oIHBhcnNlck9wdGlvbnMgKXtcblxuICAgICAgICB2YXIgcm9vdE1hcCA9IHt9O1xuICAgICAgICB2YXIgcm9vdCA9IHBhcnNlck9wdGlvbnMucm9vdDtcblxuICAgICAgICAvLyBJcyBtdWx0aXJvb3Q/XG4gICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggcm9vdCApICl7IFxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHNldmVyYWwgcm9vdHNcbiAgICAgICAgICAgIGZvciAoIHZhciBjID0gMDsgYyA8IHJvb3QubGVuZ3RoOyBjKysgKSB7XG4gICAgICAgICAgICAgICAgbWFya0FzUm9vdCggcm9vdFsgYyBdLCByb290TWFwICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAvLyBUaGVyZSBpcyBvbmx5IG9uZSByb290XG4gICAgICAgICAgICBtYXJrQXNSb290KCByb290LCByb290TWFwICk7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcm9vdE1hcDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBtYXJrQXNSb290ID0gZnVuY3Rpb24oIG5vZGUsIHJvb3RNYXAgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBrZXlcbiAgICAgICAgdmFyIGtleSA9IGJ1aWxkS2V5KCk7XG5cbiAgICAgICAgLy8gUHV0IGEgY29weSBvZiBzY29wZSBpbnRvIHRoZSBjYWNoZVxuICAgICAgICByb290TWFwWyBrZXkgXSA9IG5vZGU7XG5cbiAgICAgICAgLy8gU2F2ZSB0aGUga2V5IGFzIGFuIGF0dHJpYnV0ZSBvZiB0aGUgbm9kZVxuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggZ2V0Um9vdEtleVRhZygpLCBrZXkgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZEtleSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB1dGlscy5nZW5lcmF0ZUlkKCBrZXlMZW5ndGggKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRSb290S2V5VGFnID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGNvbnRleHQuZ2V0VGFncygpLnJvb3RLZXk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBidWlsZDogYnVpbGRcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgdXRpbHMgc2luZ2xldG9uIGNsYXNzXG4qL1xubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGdlbmVyYXRlSWQgPSBmdW5jdGlvbiAoIGxlbiwgX2NoYXJTZXQgKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgY2hhclNldCA9IF9jaGFyU2V0IHx8ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSc7XG4gICAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGVuOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgcG9zID0gTWF0aC5mbG9vciggTWF0aC5yYW5kb20oKSAqIGNoYXJTZXQubGVuZ3RoICk7XG4gICAgICAgICAgICByZXN1bHQgKz0gY2hhclNldC5zdWJzdHJpbmcoIHBvcywgcG9zICsgMSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICAvL3ZhciBpc0FycmF5ID0gQXJyYXkuaXNBcnJheTtcbiAgICBcbiAgICB2YXIgaXNGdW5jdGlvbiA9IGZ1bmN0aW9uIGlzRnVuY3Rpb24oIG9iaiApIHtcblxuICAgICAgICAvLyBTdXBwb3J0OiBDaHJvbWUgPD01NywgRmlyZWZveCA8PTUyXG4gICAgICAgIC8vIEluIHNvbWUgYnJvd3NlcnMsIHR5cGVvZiByZXR1cm5zIFwiZnVuY3Rpb25cIiBmb3IgSFRNTCA8b2JqZWN0PiBlbGVtZW50c1xuICAgICAgICAvLyAoaS5lLiwgYHR5cGVvZiBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCBcIm9iamVjdFwiICkgPT09IFwiZnVuY3Rpb25cImApLlxuICAgICAgICAvLyBXZSBkb24ndCB3YW50IHRvIGNsYXNzaWZ5ICphbnkqIERPTSBub2RlIGFzIGEgZnVuY3Rpb24uXG4gICAgICAgIHJldHVybiB0eXBlb2Ygb2JqID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIG9iai5ub2RlVHlwZSAhPT0gXCJudW1iZXJcIjtcbiAgICB9O1xuICAgIFxuICAgIHZhciBpc1BsYWluT2JqZWN0ID0gZnVuY3Rpb24oIG9iaiApIHtcbiAgICAgICAgdmFyIHByb3RvLCBDdG9yO1xuXG4gICAgICAgIC8vIERldGVjdCBvYnZpb3VzIG5lZ2F0aXZlc1xuICAgICAgICAvLyBVc2UgdG9TdHJpbmcgaW5zdGVhZCBvZiBqUXVlcnkudHlwZSB0byBjYXRjaCBob3N0IG9iamVjdHNcbiAgICAgICAgaWYgKCAhb2JqIHx8IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCggb2JqICkgIT09IFwiW29iamVjdCBPYmplY3RdXCIgKSB7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cblxuICAgICAgICBwcm90byA9IGdldFByb3RvKCBvYmogKTtcblxuICAgICAgICAvLyBPYmplY3RzIHdpdGggbm8gcHJvdG90eXBlIChlLmcuLCBgT2JqZWN0LmNyZWF0ZSggbnVsbCApYCkgYXJlIHBsYWluXG4gICAgICAgIGlmICggIXByb3RvICkge1xuICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgIH1cblxuICAgICAgICAvLyBPYmplY3RzIHdpdGggcHJvdG90eXBlIGFyZSBwbGFpbiBpZmYgdGhleSB3ZXJlIGNvbnN0cnVjdGVkIGJ5IGEgZ2xvYmFsIE9iamVjdCBmdW5jdGlvblxuICAgICAgICBDdG9yID0gaGFzT3duLmNhbGwoIHByb3RvLCBcImNvbnN0cnVjdG9yXCIgKSAmJiBwcm90by5jb25zdHJ1Y3RvcjtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiBDdG9yID09PSBcImZ1bmN0aW9uXCIgJiYgZm5Ub1N0cmluZy5jYWxsKCBDdG9yICkgPT09IE9iamVjdEZ1bmN0aW9uU3RyaW5nO1xuICAgIH07XG4gICAgdmFyIGdldFByb3RvID0gT2JqZWN0LmdldFByb3RvdHlwZU9mO1xuICAgIHZhciBjbGFzczJ0eXBlID0ge307XG4gICAgdmFyIGhhc093biA9IGNsYXNzMnR5cGUuaGFzT3duUHJvcGVydHk7XG4gICAgdmFyIGZuVG9TdHJpbmcgPSBoYXNPd24udG9TdHJpbmc7XG4gICAgdmFyIE9iamVjdEZ1bmN0aW9uU3RyaW5nID0gZm5Ub1N0cmluZy5jYWxsKCBPYmplY3QgKTtcbiAgICBcbiAgICB2YXIgZGVlcEV4dGVuZCA9IGZ1bmN0aW9uKCBvdXQgKSB7XG4gICAgICAgIG91dCA9IG91dCB8fCB7fTtcblxuICAgICAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgb2JqID0gYXJndW1lbnRzWyBpIF07XG5cbiAgICAgICAgICAgIGlmICggISBvYmogKXtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgZm9yICggdmFyIGtleSBpbiBvYmogKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBvYmouaGFzT3duUHJvcGVydHkoIGtleSApICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIHR5cGVvZiBvYmpbIGtleSBdID09PSAnb2JqZWN0JyApe1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0WyBrZXkgXSA9IGRlZXBFeHRlbmQoIG91dFsga2V5IF0sIG9ialsga2V5IF0gKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIG91dFsga2V5IF0gPSBvYmpbIGtleSBdO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBleHRlbmQgPSBmdW5jdGlvbihvdXQpIHtcbiAgICAgICAgb3V0ID0gb3V0IHx8IHt9O1xuXG4gICAgICAgIGZvciAoIHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIGlmICggISBhcmd1bWVudHNbIGkgXSApe1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmb3IgKCB2YXIga2V5IGluIGFyZ3VtZW50c1sgaSBdICkge1xuICAgICAgICAgICAgICAgIGlmICggYXJndW1lbnRzWyBpIF0uaGFzT3duUHJvcGVydHkoIGtleSApICl7XG4gICAgICAgICAgICAgICAgICAgIG91dFsga2V5IF0gPSBhcmd1bWVudHNbIGkgXVsga2V5IF07XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG91dDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBhamF4ID0gZnVuY3Rpb24oIGNvbmYgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGNvbmYgb2JqZWN0XG4gICAgICAgIGlmICggISBjb25mICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIHByb2Nlc3MgYWpheDogbm8gYXJndW1lbnRzISc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCAhIGNvbmYudXJsICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIHByb2Nlc3MgYWpheDogbm8gVVJMIGRlZmluZWQhJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoICEgY29uZi5kb25lICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIHByb2Nlc3MgYWpheDogbm8gZG9uZSBjYWxsYmFjayBkZWZpbmVkISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERvIGl0IVxuICAgICAgICB2YXIgb1JlcSA9IG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgb1JlcS5hZGRFdmVudExpc3RlbmVyKCBcbiAgICAgICAgICAgICdsb2FkJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCA0MDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3MhXG4gICAgICAgICAgICAgICAgICAgIGNvbmYuZG9uZSggXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25mLnBhcnNlSlNPTj9cbiAgICAgICAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2UoIG9SZXEucmVzcG9uc2VUZXh0ICk6XG4gICAgICAgICAgICAgICAgICAgICAgICBvUmVxLnJlc3BvbnNlVGV4dFxuICAgICAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFdlIHJlYWNoZWQgb3VyIHRhcmdldCBzZXJ2ZXIsIGJ1dCBpdCByZXR1cm5lZCBhbiBlcnJvclxuICAgICAgICAgICAgICAgICAgICBjb25mLmZhaWwoIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0aGlzLnN0YXR1c1RleHQgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICggY29uZi5mYWlsICl7XG4gICAgICAgICAgICBvUmVxLmFkZEV2ZW50TGlzdGVuZXIoICdlcnJvcicsIGNvbmYuZmFpbCApO1xuICAgICAgICB9XG4gICAgICAgIG9SZXEub3BlbiggJ0dFVCcsIGNvbmYudXJsICk7XG4gICAgICAgIG9SZXEuc2VuZCgpO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldEpTT04gPSBmdW5jdGlvbiggY29uZiApe1xuICAgICAgICBcbiAgICAgICAgY29uZi5wYXJzZUpTT04gPSB0cnVlO1xuICAgICAgICBhamF4KCBjb25mICk7XG4gICAgfTtcbiAgICBcbiAgICAvKlxuICAgIHZhciBnZXRKU09OID0gZnVuY3Rpb24oIGNvbmYgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGNvbmYgb2JqZWN0XG4gICAgICAgIGlmICggISBjb25mICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIGdldEpTT046IG5vIGFyZ3VtZW50cyEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICggISBjb25mLnVybCApe1xuICAgICAgICAgICAgdGhyb3cgJ0Vycm9yIHRyeWluZyB0byBnZXRKU09OOiBubyBVUkwgZGVmaW5lZCEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICggISBjb25mLmRvbmUgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gZ2V0SlNPTjogbm8gZG9uZSBjYWxsYmFjayBkZWZpbmVkISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIERvIGl0IVxuICAgICAgICB2YXIgb1JlcSA9IG5ldyB3aW5kb3cuWE1MSHR0cFJlcXVlc3QoKTtcbiAgICAgICAgb1JlcS5hZGRFdmVudExpc3RlbmVyKCBcbiAgICAgICAgICAgICdsb2FkJyxcbiAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCA0MDAgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFN1Y2Nlc3MhXG4gICAgICAgICAgICAgICAgICAgIGNvbmYuZG9uZSggXG4gICAgICAgICAgICAgICAgICAgICAgICBKU09OLnBhcnNlKCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvUmVxLnJlc3BvbnNlVGV4dCBcbiAgICAgICAgICAgICAgICAgICAgICAgICkgXG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgcmVhY2hlZCBvdXIgdGFyZ2V0IHNlcnZlciwgYnV0IGl0IHJldHVybmVkIGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIGNvbmYuZmFpbCggdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMuc3RhdHVzVGV4dCApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCBjb25mLmZhaWwgKXtcbiAgICAgICAgICAgIG9SZXEuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgY29uZi5mYWlsICk7XG4gICAgICAgIH1cbiAgICAgICAgb1JlcS5vcGVuKCAnR0VUJywgY29uZi51cmwgKTtcbiAgICAgICAgb1JlcS5zZW5kKCk7XG4gICAgfTtcbiAgICAqL1xuICAgIC8qXG4gICAgdmFyIGdldE5vZGVJZCA9IGZ1bmN0aW9uICggbm9kZSApe1xuICAgICAgICByZXR1cm4gbm9kZS5nZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmlkICk7XG4gICAgfTtcbiAgICAqL1xuICAgIHZhciBkZWVwRXF1YWwgPSBmdW5jdGlvbiggeCwgeSApIHtcbiAgICAgICAgcmV0dXJuICh4ICYmIHkgJiYgdHlwZW9mIHggPT09ICdvYmplY3QnICYmIHR5cGVvZiB5ID09PSAnb2JqZWN0JykgP1xuICAgICAgICAgICAgKE9iamVjdC5rZXlzKHgpLmxlbmd0aCA9PT0gT2JqZWN0LmtleXMoeSkubGVuZ3RoKSAmJiBPYmplY3Qua2V5cyh4KS5yZWR1Y2UoZnVuY3Rpb24oaXNFcXVhbCwga2V5KSB7cmV0dXJuIGlzRXF1YWwgJiYgZGVlcEVxdWFsKHhba2V5XSwgeVtrZXldKTt9LCB0cnVlKTpcbiAgICAgICAgICAgICh4ID09PSB5KTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBjb3B5QXJyYXkgPSBmdW5jdGlvbiggYXJyYXlUb0NvcHkgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGFycmF5VG9Db3B5Lmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICByZXN1bHQucHVzaCggYXJyYXlUb0NvcHlbIGkgXSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdlbmVyaWNUb1N0cmluZyA9IGZ1bmN0aW9uKCBlbGVtZW50ICl7XG4gICAgXG4gICAgICAgIGlmICggZWxlbWVudCA9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgIHJldHVybiAndW5kZWZpbmVkJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCBlbGVtZW50ICkgKXtcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSAnQXJyYXlbICc7XG4gICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBlbGVtZW50Lmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICAgICAgdmFyIHNlcGFyYXRvciA9IGkgPT09IDA/ICcnOiAnLCAnO1xuICAgICAgICAgICAgICAgIHJlc3VsdCArPSBzZXBhcmF0b3IgKyBnZW5lcmljVG9TdHJpbmcoIGVsZW1lbnRbIGkgXSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmVzdWx0ICs9ICcgXSc7XG4gICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIGlzUGxhaW5PYmplY3QoIGVsZW1lbnQgKSApe1xuICAgICAgICAgICAgcmV0dXJuIEpTT04uc3RyaW5naWZ5KCBlbGVtZW50ICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE11c3QgYmUgbnVtZXJpYyBvciBzdHJpbmdcbiAgICAgICAgcmV0dXJuIGVsZW1lbnQ7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkLFxuICAgICAgICAvL2lzQXJyYXk6IGlzQXJyYXksXG4gICAgICAgIGlzRnVuY3Rpb246IGlzRnVuY3Rpb24sXG4gICAgICAgIGlzUGxhaW5PYmplY3Q6IGlzUGxhaW5PYmplY3QsXG4gICAgICAgIGRlZXBFeHRlbmQ6IGRlZXBFeHRlbmQsXG4gICAgICAgIGV4dGVuZDogZXh0ZW5kLFxuICAgICAgICBnZXRKU09OOiBnZXRKU09OLFxuICAgICAgICBhamF4OiBhamF4LFxuICAgICAgICBkZWVwRXF1YWw6IGRlZXBFcXVhbCxcbiAgICAgICAgY29weUFycmF5OiBjb3B5QXJyYXksXG4gICAgICAgIGdlbmVyaWNUb1N0cmluZzogZ2VuZXJpY1RvU3RyaW5nXG4gICAgICAgIC8vZ2V0Tm9kZUlkOiBnZXROb2RlSWRcbiAgICB9O1xufSkoKTtcbiIsIi8vIGdlbmVyYXRlZCBieSBnZW52ZXJzaW9uXG5tb2R1bGUuZXhwb3J0cyA9ICcwLjQwLjMnXG4iLCIvKiEgenpkb20gLSB2MC4yLjAgLSAyMDIwLTExLTEyIDEzOjMyOjUxICovXG4vKipcbiAqIEEgbmFtZXNwYWNlLlxuICogQGNvbnN0XG4gKi9cbnZhciB6ekRPTSA9IHt9O1xuXG4vKlxuICAgIHp6IGZ1bmN0aW9uXG4gICAgXG4gICAgenooICcjJywgJ2lkJyApO1xuICAgIHp6KCAnLicsICdjbGFzc05hbWUnICk7XG4gICAgenooICd0JywgJ3RhZ05hbWUnICk7XG4gICAgenooICd0bicsICduYW1lc3BhY2UnLCAndGFnTmFtZScgKTtcbiAgICB6eiggJ24nLCAnbmFtZScgKTtcbiAgICB6eiggJ3MnLCAnc3RyaW5nIHNlbGVjdG9yJyApO1xuICAgIHp6KCBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggJ2lkJyApICk7IC8vIEVsZW1lbnRcbiAgICB6eiggZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggJ2NsYXNzTmFtZScgKSApOyAvLyBIVE1MQ29sbGVjdGlvblxuICAgIHp6KCBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSggJ25hbWUnICkgKTsgLy8gTm9kZUxpc3RcbiAgICB6eiggJ3RhYmxlLmNsYXNzTmFtZSB0ciB0ZCcgKTsgLy8gU3RyaW5nIHNlbGVjdG9yXG4gICAgenooICc8ZGl2Pk5ldyBkaXY8L2Rpdj4nICk7IC8vIEhUTUwgY29kZSBpbiBzdHJpbmdcbiovXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfEVsZW1lbnR8SFRNTENvbGxlY3Rpb258Tm9kZUxpc3R9IHhcbiAqIEBwYXJhbSB7c3RyaW5nPX0gczFcbiAqIEBwYXJhbSB7c3RyaW5nPX0gczIgXG4gKi9cbnp6RE9NLnp6ID0gZnVuY3Rpb24oIHgsIHMxLCBzMiApe1xuICAgIFxuICAgIC8vIFJlZGVmaW5lIHggaWYgYSBzZWxlY3RvciBpZCBpcyBmb3VuZFxuICAgIGlmICggczEgKXtcbiAgICAgICAgc3dpdGNoICggeCApe1xuICAgICAgICBjYXNlICcjJzpcbiAgICAgICAgICAgIHggPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCggczEgKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICcuJzpcbiAgICAgICAgICAgIHggPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCBzMSApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3QnOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCBzMSApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3RuJzpcbiAgICAgICAgICAgIHggPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZU5TKCBzMSwgczIgfHwgJycgKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICduJzpcbiAgICAgICAgICAgIHggPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5TmFtZSggczEgKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdzJzpcbiAgICAgICAgICAgIHggPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBzMSApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyAnVW5zdXBwb3J0ZWQgc2VsZWN0b3IgaWQgZm91bmQgcnVubmluZyB6eiBmdW5jdGlvbjogJyArIHg7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgLy8gSXMgaXQgYW4gRWxlbWVudD9cbiAgICBpZiAoIHggaW5zdGFuY2VvZiBFbGVtZW50ICl7XG4gICAgICAgIHJldHVybiBuZXcgenpET00uU1MoIHggKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSXMgaXQgYW4gSFRNTENvbGxlY3Rpb24gb3IgYSBOb2RlTGlzdD9cbiAgICBpZiAoIHggaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbiB8fCB4IGluc3RhbmNlb2YgTm9kZUxpc3QgKXtcbiAgICAgICAgcmV0dXJuIHp6RE9NLl9idWlsZCggeCApO1xuICAgIH1cbiAgICBcbiAgICBpZiAoIHR5cGVvZiB4ID09PSAnc3RyaW5nJyApe1xuICAgICAgICB4ID0geC50cmltKCk7XG4gICAgICAgIHJldHVybiB6ekRPTS5fYnVpbGQoXG4gICAgICAgICAgICB4LmNoYXJBdCggMCApID09PSAnPCc/IC8vIElzIGl0IEhUTUwgY29kZT9cbiAgICAgICAgICAgICAgICB6ekRPTS5faHRtbFRvRWxlbWVudCggeCApOlxuICAgICAgICAgICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIHggKSAvLyBNdXN0IGJlIGEgc3RhbmRhcmQgc2VsZWN0b3JcbiAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgdGhyb3cgJ1Vuc3VwcG9ydGVkIHNlbGVjdG9yIHR5cGUgZm91bmQgcnVubmluZyB6eiBmdW5jdGlvbi4nO1xufTtcblxuLy8gQnVpbGQgYXJncyBhcnJheSB3aXRoIHRvSW5zZXJ0IGFzIGZpcnN0IHBvc2l0aW9uIGFuZCB0aGVuIHRoZSBhcmd1bWVudHMgb2YgdGhpcyBmdW5jdGlvblxuenpET00uX2FyZ3MgPSBmdW5jdGlvbiggcHJldmlvdXNBcmdzLCB0b0luc2VydCApe1xuICAgIHZhciByZXN1bHQgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggcHJldmlvdXNBcmdzICk7XG4gICAgcmVzdWx0LnB1c2goIHRvSW5zZXJ0ICk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cbnp6RE9NLl9idWlsZCA9IGZ1bmN0aW9uICggeCApIHtcbiAgICBpZiAoIHggaW5zdGFuY2VvZiBFbGVtZW50ICl7XG4gICAgICAgIHJldHVybiBuZXcgenpET00uU1MoIHggKTtcbiAgICB9XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgSFRNTENvbGxlY3Rpb24gfHwgeCBpbnN0YW5jZW9mIE5vZGVMaXN0ICl7XG4gICAgICAgIHggPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggeCApO1xuICAgIH1cbiAgICByZXR1cm4geC5sZW5ndGggPT09IDE/IG5ldyB6ekRPTS5TUyggeFsgMCBdICk6IG5ldyB6ekRPTS5NTSggeCApO1xufTtcblxuenpET00uX2dldEVycm9yID0gZnVuY3Rpb24gKCBtZXRob2QgKSB7XG4gICAgcmV0dXJuICdNZXRob2QgXCInICsgbWV0aG9kICsgJ1wiIG5vdCByZWFkeSBmb3IgdGhhdCB0eXBlISc7XG59O1xuXG56ekRPTS5faHRtbFRvRWxlbWVudCA9IGZ1bmN0aW9uICggaHRtbCApIHtcbiAgICB2YXIgdGVtcGxhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAndGVtcGxhdGUnICk7XG4gICAgdGVtcGxhdGUuaW5uZXJIVE1MID0gaHRtbC50cmltKCk7XG4gICAgcmV0dXJuIHRlbXBsYXRlLmNvbnRlbnQuY2hpbGRFbGVtZW50Q291bnQgPT09IDE/XG4gICAgICAgIHRlbXBsYXRlLmNvbnRlbnQuZmlyc3RDaGlsZDpcbiAgICAgICAgdGVtcGxhdGUuY29udGVudC5jaGlsZE5vZGVzO1xufTtcblxuLy8gUmVnaXN0ZXIgenogZnVuY3Rpb25cbnZhciB6ejtcbihmdW5jdGlvbigpIHsgXG4gICAgenogPSB6ekRPTS56ejsgXG59KSgpO1xuXG56ekRPTS5fZXZlbnRzID0ge307XG5cbnp6RE9NLl9hZGRFdmVudExpc3RlbmVyID0gZnVuY3Rpb24oIHNzLCBldmVudE5hbWUsIGxpc3RlbmVyLCB1c2VDYXB0dXJlICl7XG4gICAgdmFyIGVsID0gc3MuZWw7XG4gICAgdmFyIGVsSWQgPSBzcy5fZ2V0RWxJZCgpO1xuICAgIHZhciB0aGlzRXZlbnRzID0genpET00uX2V2ZW50c1sgZWxJZCBdO1xuICAgIGlmICggISB0aGlzRXZlbnRzICl7XG4gICAgICAgIHRoaXNFdmVudHMgPSB7fTtcbiAgICAgICAgenpET00uX2V2ZW50c1sgZWxJZCBdID0gdGhpc0V2ZW50cztcbiAgICB9XG4gICAgdmFyIHRoaXNMaXN0ZW5lcnMgPSB0aGlzRXZlbnRzWyBldmVudE5hbWUgXTtcbiAgICBpZiAoICEgdGhpc0xpc3RlbmVycyApe1xuICAgICAgICB0aGlzTGlzdGVuZXJzID0gW107XG4gICAgICAgIHRoaXNFdmVudHNbIGV2ZW50TmFtZSBdID0gdGhpc0xpc3RlbmVycztcbiAgICB9XG4gICAgdGhpc0xpc3RlbmVycy5wdXNoKCBsaXN0ZW5lciApO1xuICAgIFxuICAgIC8vIGFkZEV2ZW50TGlzdGVuZXJcbiAgICBlbC5hZGRFdmVudExpc3RlbmVyKCBldmVudE5hbWUsIGxpc3RlbmVyLCB1c2VDYXB0dXJlICk7XG59O1xuXG4vL1RPRE8gbXVzdCByZW1vdmUgYWxsIGxpc3RlbmVycyB3aGVuIGFuIGVsZW1lbnQgaXMgcmVtb3ZlZFxuenpET00uX3JlbW92ZUV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiggc3MsIGV2ZW50TmFtZSwgbGlzdGVuZXIsIHVzZUNhcHR1cmUgKXtcbiAgICB2YXIgZWwgPSBzcy5lbDtcbiAgICB2YXIgZWxJZCA9IHNzLl9nZXRFbElkKCk7XG4gICAgdmFyIHRoaXNFdmVudHMgPSB6ekRPTS5fZXZlbnRzWyBlbElkIF07XG4gICAgaWYgKCAhIHRoaXNFdmVudHMgKXtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBcbiAgICBpZiAoICEgZXZlbnROYW1lICl7IFxuICAgICAgICAvLyBNdXN0IHJlbW92ZSBhbGwgZXZlbnRzXG4gICAgICAgIGZvciAoIHZhciBjdXJyZW50RXZlbnROYW1lIGluIHRoaXNFdmVudHMgKXtcbiAgICAgICAgICAgIHZhciBjdXJyZW50TGlzdGVuZXJzID0gdGhpc0V2ZW50c1sgY3VycmVudEV2ZW50TmFtZSBdO1xuICAgICAgICAgICAgenpET00uX3JlbW92ZUxpc3RlbmVycyggZWwsIGN1cnJlbnRMaXN0ZW5lcnMsIG51bGwsIHVzZUNhcHR1cmUsIGN1cnJlbnRFdmVudE5hbWUgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIC8vIE11c3QgcmVtb3ZlIGxpc3RlbmVycyBvZiBvbmx5IG9uZSBldmVudFxuICAgIHZhciB0aGlzTGlzdGVuZXJzID0gdGhpc0V2ZW50c1sgZXZlbnROYW1lIF07XG4gICAgenpET00uX3JlbW92ZUxpc3RlbmVycyggZWwsIHRoaXNMaXN0ZW5lcnMsIGxpc3RlbmVyLCB1c2VDYXB0dXJlLCBldmVudE5hbWUgKTtcbn07XG5cbi8vVE9ETyB0ZXN0IGFsbCB0aGUgbGlzdGVuZXJzIGFyZSByZW1vdmVkXG56ekRPTS5fcmVtb3ZlTGlzdGVuZXJzID0gZnVuY3Rpb24oIGVsLCB0aGlzTGlzdGVuZXJzLCBsaXN0ZW5lciwgdXNlQ2FwdHVyZSwgZXZlbnROYW1lICl7XG4gICAgaWYgKCAhIHRoaXNMaXN0ZW5lcnMgKXtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzTGlzdGVuZXJzLmxlbmd0aDsgKytpICl7XG4gICAgICAgIHZhciBjdXJyZW50TGlzdGVuZXIgPSB0aGlzTGlzdGVuZXJzWyBpIF07XG4gICAgICAgIGlmICggISBsaXN0ZW5lciB8fCBjdXJyZW50TGlzdGVuZXIgPT09IGxpc3RlbmVyICl7XG4gICAgICAgICAgICB0aGlzTGlzdGVuZXJzLnNwbGljZSggaSwgMSApOyAvLyBEZWxldGUgbGlzdGVuZXIgYXQgaSBwb3NpdGlvblxuICAgICAgICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lciggZXZlbnROYW1lLCBjdXJyZW50TGlzdGVuZXIsIHVzZUNhcHR1cmUgKTtcbiAgICAgICAgICAgIGlmICggbGlzdGVuZXIgKXtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9IFxufTtcbi8qIEVuZCBvZiBldmVudHMgKi9cblxuenpET00uX2RkID0ge307XG5cbnp6RE9NLl9nZXREZWZhdWx0RGlzcGxheSA9IGZ1bmN0aW9uKCBlbCApIHtcbiAgICB2YXIgbm9kZU5hbWUgPSBlbC5ub2RlTmFtZTtcbiAgICB2YXIgZGlzcGxheSA9IHp6RE9NLl9kZFsgbm9kZU5hbWUgXTtcblxuICAgIGlmICggZGlzcGxheSApIHtcbiAgICAgICAgcmV0dXJuIGRpc3BsYXk7XG4gICAgfVxuXG4gICAgdmFyIGRvYyA9IGVsLm93bmVyRG9jdW1lbnQ7XG4gICAgdmFyIHRlbXAgPSBkb2MuYm9keS5hcHBlbmRDaGlsZCggZG9jLmNyZWF0ZUVsZW1lbnQoIG5vZGVOYW1lICkgKTtcbiAgICBkaXNwbGF5ID0gZ2V0Q29tcHV0ZWRTdHlsZSggdGVtcCApWyAnZGlzcGxheScgXTtcblxuICAgIHRlbXAucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggdGVtcCApO1xuXG4gICAgaWYgKCBkaXNwbGF5ID09PSAnbm9uZScgKSB7XG4gICAgICAgIGRpc3BsYXkgPSAnYmxvY2snO1xuICAgIH1cbiAgICB6ekRPTS5fZGRbIG5vZGVOYW1lIF0gPSBkaXNwbGF5O1xuXG4gICAgcmV0dXJuIGRpc3BsYXk7XG59O1xuLyogRW5kIG9mIHZpc2libGUgKi9cblxuLyogSXQgZGVwZW5kcyBvbiBmb3JtcyBwbHVnaW4hICovXG4vLyBTZXJpYWxpemUgYSBzcyBpbnN0YW5jZSwgYSBtbSBpbnN0YW5jZSBvciBhbiBvYmplY3QgaW50byBhIHF1ZXJ5IHN0cmluZ1xuenpET00uX3BhcmFtSXRlbSA9IGZ1bmN0aW9uKCByLCBrZXksIHZhbHVlICkge1xuICAgIHIucHVzaCggXG4gICAgICAgIGVuY29kZVVSSUNvbXBvbmVudCgga2V5ICkgKyAnPScgKyBlbmNvZGVVUklDb21wb25lbnQoIHZhbHVlID09IG51bGw/ICcnOiB2YWx1ZSApXG4gICAgKTtcbn07XG4vKiogQG5vY29sbGFwc2UgKi9cbnp6RE9NLnBhcmFtID0gZnVuY3Rpb24oIHggKSB7XG5cdFxuICAgIGlmICggeCA9PSBudWxsICkge1xuICAgICAgICByZXR1cm4gJyc7XG4gICAgfVxuXG4gICAgdmFyIHIgPSBbXTtcbiAgICBcbiAgICBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5TUyApe1xuICAgICAgICB6ekRPTS5fcGFyYW1JdGVtKCByLCB4LmF0dHIoICduYW1lJyApLCB4LnZhbCgpICk7XG4gICAgfSBlbHNlIGlmICggeCBpbnN0YW5jZW9mIHp6RE9NLk1NICl7XG4gICAgICAgIGZvciAoIHZhciBjID0gMDsgYyA8IHgubGlzdC5sZW5ndGg7ICsrYyApe1xuICAgICAgICAgICAgdmFyIHNzID0geC5saXN0WyBjIF07XG4gICAgICAgICAgICB6ekRPTS5fcGFyYW1JdGVtKCByLCBzcy5hdHRyKCAnbmFtZScgKSwgc3MudmFsKCkgKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSBpZiAoIHR5cGVvZiB4ID09PSAnb2JqZWN0JyApeyAgXG4gICAgICAgIGZvciAoIHZhciBpIGluIHggKSB7XG4gICAgICAgICAgICB6ekRPTS5fcGFyYW1JdGVtKCByLCBpLCB4WyBpIF0gKTtcbiAgICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IHp6RE9NLl9nZXRFcnJvciggJ3BhcmFtJyApO1xuICAgIH1cblxuICAgIHJldHVybiByLmpvaW4oICcmJyApO1xufTtcbi8qIGVuZCBvZiB1dGlscyAqL1xuXG4vKiogQGNvbnN0cnVjdG9yICovXG56ekRPTS5TUyA9IGZ1bmN0aW9uICggX2VsICkge1xuICAgIHRoaXMuZWwgPSBfZWw7XG4gICAgdGhpcy5ub2RlcyA9IFsgX2VsIF07XG4gICAgXG4gICAgLy8gQXJyYXkgbGlrZVxuICAgIHRoaXMubGVuZ3RoID0gMTtcbiAgICB0aGlzWyAwIF0gPSBfZWw7XG59O1xuXG4vKiBNZXRob2RzIE5PVCBpbmNsdWRlZCBpbiBqcXVlcnkgKi9cbnp6RE9NLlNTLnByb3RvdHlwZS5fZ2NzID0gZnVuY3Rpb24gKCBzZWxmLCBwcm9wZXJ0eSApIHtcbiAgICB2YXIgeCA9IGdldENvbXB1dGVkU3R5bGUoIHNlbGYuZWwsIG51bGwgKVsgcHJvcGVydHkgXS5yZXBsYWNlKCAncHgnLCAnJyApO1xuICAgIHJldHVybiBpc05hTiggeCApPyB4OiBwYXJzZUZsb2F0KCB4ICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX2dldEVsSWQgPSBmdW5jdGlvbigpe1xuICAgIHZhciBlbElkID0gdGhpcy5lbC5nZXRBdHRyaWJ1dGUoICdkYXRhLWVsSWQnICk7XG4gICAgaWYgKCAhIGVsSWQgKXtcbiAgICAgICAgLy8gR2VuZXJhdGUgYSByYW5kb20gc3RyaW5nIHdpdGggNCBjaGFyc1xuICAgICAgICBlbElkID0gTWF0aC5mbG9vciggKCAxICsgTWF0aC5yYW5kb20oKSApICogMHgxMDAwMCApXG4gICAgICAgICAgICAudG9TdHJpbmcoIDE2IClcbiAgICAgICAgICAgIC5zdWJzdHJpbmcoIDEgKTtcbiAgICAgICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoICdkYXRhLWVsSWQnLCBlbElkICk7XG4gICAgfVxuICAgIHJldHVybiBlbElkO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLl9pbnNlcnRIZWxwZXIgPSBmdW5jdGlvbiAoIHBvc2l0aW9uLCB4ICkge1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEVsZW1lbnQgKXtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoIHBvc2l0aW9uLCB4ICk7XG4gICAgfSBlbHNlIGlmICggeCBpbnN0YW5jZW9mIHp6RE9NLlNTICl7XG4gICAgICAgIHRoaXMuZWwuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KCBwb3NpdGlvbiwgeC5lbCApO1xuICAgIH0gZWxzZSBpZiAoIHR5cGVvZiB4ID09PSAnc3RyaW5nJyApIHtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRBZGphY2VudEhUTUwoIHBvc2l0aW9uLCB4ICk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgJ0luc2VydCBvcGVyYXRpb24gbm90IHJlYWR5IGZvciB0aGF0IHR5cGUhJztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX2l0ZXJhdGUgPSBmdW5jdGlvbiggdmFsdWUsIGZuICl7XG4gICAgaWYgKCBBcnJheS5pc0FycmF5KCB2YWx1ZSApICl7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHZhbHVlLmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICBmbiggdGhpcywgdmFsdWVbIGkgXSApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgZm4oIHRoaXMsIHZhbHVlICk7ICAgXG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLl9vdXRlciA9IGZ1bmN0aW9uICggcHJvcGVydHksIGxpbmtlZDEsIGxpbmtlZDIsIHdpdGhNYXJnaW4gKSB7XG4gICAgaWYgKCB0aGlzLmVsWyAnb2Zmc2V0JyArIHByb3BlcnR5IF0gKSB7XG4gICAgICAgIHJldHVybiB6ekRPTS5TUy5fb3V0ZXJDYWxjKCB0aGlzLCBwcm9wZXJ0eSwgbGlua2VkMSwgbGlua2VkMiwgd2l0aE1hcmdpbiApO1xuICAgIH1cbiAgICBcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgcmV0dXJuIHRoaXMuX3N3YXAoIFxuICAgICAgICB0aGlzLmVsLCBcbiAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHJldHVybiB6ekRPTS5TUy5fb3V0ZXJDYWxjKCBzZWxmLCBwcm9wZXJ0eSwgbGlua2VkMSwgbGlua2VkMiwgd2l0aE1hcmdpbiApO1xuICAgICAgICB9IFxuICAgICk7XG59O1xuXG56ekRPTS5TUy5fb3V0ZXJDYWxjID0gZnVuY3Rpb24gKCBzcywgcHJvcGVydHksIGxpbmtlZDEsIGxpbmtlZDIsIHdpdGhNYXJnaW4gKSB7XG4gICAgdmFyIHZhbHVlID0gc3MuX2djcyggc3MsIHByb3BlcnR5LnRvTG93ZXJDYXNlKCkgKTtcbiAgICB2YXIgcGFkZGluZyA9IHNzLl9nY3MoIHNzLCAncGFkZGluZycgKyBsaW5rZWQxICkgKyBzcy5fZ2NzKCBzcywgJ3BhZGRpbmcnICsgbGlua2VkMiApO1xuICAgIHZhciBib3JkZXIgPSBzcy5fZ2NzKCBzcywgJ2JvcmRlcicgKyBsaW5rZWQxICsgJ1dpZHRoJyApICsgc3MuX2djcyggc3MsICdib3JkZXInICsgbGlua2VkMiArICdXaWR0aCcgKTtcbiAgICBcbiAgICB2YXIgdG90YWwgPSB2YWx1ZSArIHBhZGRpbmcgKyBib3JkZXI7XG4gICAgXG4gICAgLy8gTm8gbWFyZ2luXG4gICAgaWYgKCAhIHdpdGhNYXJnaW4gKXtcbiAgICAgICAgcmV0dXJuIHRvdGFsO1xuICAgIH1cbiAgICBcbiAgICB2YXIgbWFyZ2luID0gc3MuX2djcyggc3MsICdtYXJnaW4nICsgbGlua2VkMSApICsgc3MuX2djcyggc3MsICdtYXJnaW4nICsgbGlua2VkMiApO1xuICAgIHJldHVybiB0b3RhbCArIG1hcmdpbjtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5fc2V0Q3NzVXNpbmdLZXlWYWx1ZSA9IGZ1bmN0aW9uICgga2V5LCB2YWx1ZSApIHtcbiAgICBpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJyApIHtcbiAgICAgICAgdmFsdWUgPSB2YWx1ZS5jYWxsKCB0aGlzLmVsLCB0aGlzLl9pID09PSB1bmRlZmluZWQ/IDA6IHRoaXMuX2ksIHRoaXMgKTtcbiAgICB9XG4gICAgdGhpcy5lbC5zdHlsZVsga2V5IF0gPSBcbiAgICAgICAgdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyAmJiAhIC9eLT9cXGQrXFwuP1xcZCokLy50ZXN0KCB2YWx1ZSApPyAvLyBpZiBpdCBpcyBhIHN0cmluZyBhbmQgaXMgbm90IGEgZmxvYXQgbnVtYmVyXG4gICAgICAgICAgICB2YWx1ZTogXG4gICAgICAgICAgICB2YWx1ZSArICdweCc7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX3NldENzc1VzaW5nT2JqZWN0ID0gZnVuY3Rpb24gKCBvYmplY3QgKSB7XG4gICAgZm9yICggdmFyIGtleSBpbiBvYmplY3QgKSB7XG4gICAgICAgIHRoaXMuX3NldENzc1VzaW5nS2V5VmFsdWUoIGtleSwgb2JqZWN0WyBrZXkgXSApO1xuICAgIH1cbn07XG5cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd9IHByb3BlcnR5XG4gKiBAcGFyYW0ge3N0cmluZ3xGdW5jdGlvbj19IHZhbHVlXG4gKi9cbnp6RE9NLlNTLnByb3RvdHlwZS5fc3R5bGVQcm9wZXJ0eSA9IGZ1bmN0aW9uICggcHJvcGVydHksIHZhbHVlICkge1xuICAgIC8vIGdldFxuICAgIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApe1xuICAgICAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgICAgIHZhbHVlID0gdGhpcy5fZ2NzKCB0aGlzLCBwcm9wZXJ0eSApO1xuICAgICAgICByZXR1cm4gcGFyc2VGbG9hdCggXG4gICAgICAgICAgICB2YWx1ZSAhPT0gJ2F1dG8nPyBcbiAgICAgICAgICAgICAgICB2YWx1ZTogXG4gICAgICAgICAgICAgICAgdGhpcy5fc3dhcCggXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWwsIFxuICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHNlbGYuX2djcyggc2VsZiwgcHJvcGVydHkgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBcbiAgICAgICAgICAgICAgICApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gc2V0XG4gICAgdGhpcy5fc2V0Q3NzVXNpbmdLZXlWYWx1ZSggcHJvcGVydHksIHZhbHVlICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX3N3YXAgPSBmdW5jdGlvbiggX2VsLCBjYWxsYmFjayApIHtcbiAgICB2YXIgb2xkID0ge307XG4gICAgdmFyIG9wdGlvbnMgPSB7XG4gICAgICAgIGRpc3BsYXk6ICdibG9jaycsXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB2aXNpYmlsaXR5OiAnaGlkZGVuJ1xuICAgIH07XG5cbiAgICAvLyBSZW1lbWJlciB0aGUgb2xkIHZhbHVlcyBhbmQgaW5zZXJ0IHRoZSBuZXcgb25lc1xuICAgIGZvciAoIHZhciBuYW1lIGluIG9wdGlvbnMgKSB7XG4gICAgICAgIG9sZFsgbmFtZSBdID0gX2VsLnN0eWxlWyBuYW1lIF07XG4gICAgICAgIF9lbC5zdHlsZVsgbmFtZSBdID0gb3B0aW9uc1sgbmFtZSBdO1xuICAgIH1cblxuICAgIHZhciB2YWwgPSBjYWxsYmFjay5jYWxsKCBfZWwgKTtcblxuICAgIC8vIFJldmVydCB0aGUgb2xkIHZhbHVlc1xuICAgIGZvciAoIG5hbWUgaW4gb3B0aW9ucyApIHtcbiAgICAgICAgX2VsLnN0eWxlWyBuYW1lIF0gPSBvbGRbIG5hbWUgXTtcbiAgICB9XG5cbiAgICByZXR1cm4gdmFsO1xufTtcblxuLyogTWV0aG9kcyBpbmNsdWRlZCBpbiBqcXVlcnkgKi9cbnp6RE9NLlNTLnByb3RvdHlwZS5hZGRDbGFzcyA9IGZ1bmN0aW9uICggbmFtZSApIHtcbiAgICByZXR1cm4gdGhpcy5faXRlcmF0ZShcbiAgICAgICAgbmFtZSxcbiAgICAgICAgZnVuY3Rpb24oIHNlbGYsIHYgKXtcbiAgICAgICAgICAgIHNlbGYuZWwuY2xhc3NMaXN0LmFkZCggdiApOyBcbiAgICAgICAgfVxuICAgICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuYWZ0ZXIgPSBmdW5jdGlvbiAoIHggKSB7XG4gICAgcmV0dXJuIHRoaXMuX2luc2VydEhlbHBlciggJ2FmdGVyZW5kJywgeCApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmFwcGVuZCA9IGZ1bmN0aW9uICggeCApIHtcbiAgICBpZiAoIHggaW5zdGFuY2VvZiBFbGVtZW50ICl7XG4gICAgICAgIHRoaXMuZWwuYXBwZW5kQ2hpbGQoIHggKTtcbiAgICB9IGVsc2UgaWYgKCB4IGluc3RhbmNlb2YgenpET00uU1MgKXtcbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCggeC5lbCApO1xuICAgIH0gZWxzZSBpZiAoIHR5cGVvZiB4ID09PSAnc3RyaW5nJyApIHtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRBZGphY2VudEhUTUwoICdiZWZvcmVlbmQnLCB4ICk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgenpET00uX2dldEVycm9yKCAnYXBwZW5kJyApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5hcHBlbmRUbyA9IGZ1bmN0aW9uICggeCApIHtcbiAgICAvLyBEbyBub3RoaW5nIGFuZCByZXR1cm4gdGhpcyBpZiBpdCBpcyBudWxsXG4gICAgaWYgKCB4ID09IG51bGwgKXtcbiAgICAgICAgcmV0dXJuIHRoaXM7ICAgIFxuICAgIH1cbiAgICBcbiAgICAvLyBJcyBpdCBhIEVsZW1lbnQ/XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgRWxlbWVudCApe1xuICAgICAgICB4LmFwcGVuZENoaWxkKCB0aGlzLmVsICk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBcbiAgICAvLyBJcyBpdCBhIHN0cmluZz9cbiAgICBpZiAoIHR5cGVvZiB4ID09PSAnc3RyaW5nJyApe1xuICAgICAgICB4ID0genpET00uX2J1aWxkKFxuICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggeCApXG4gICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIC8vIElzIGl0IGEgenpET00uU1M/XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgenpET00uU1MgKSB7XG4gICAgICAgIHguZWwuYXBwZW5kQ2hpbGQoIHRoaXMuZWwgKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIFxuICAgIC8vIElzIGl0IGEgenpET00uTU0/XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgenpET00uTU0gKSB7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHgubm9kZXMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIHgubm9kZXNbIGkgXS5hcHBlbmRDaGlsZCggdGhpcy5lbC5jbG9uZU5vZGUoIHRydWUgKSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH0gXG4gICAgXG4gICAgdGhyb3cgenpET00uX2dldEVycm9yKCAnaXMnICk7XG59O1xuXG4vL1RPRE8gYWRkIHN1cHBvcnQgb2YgZnVuY3Rpb24gdHlwZSBpbiB2YWx1ZVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IHhcbiAqIEBwYXJhbSB7c3RyaW5nPX0gdmFsdWVcbiAqL1xuenpET00uU1MucHJvdG90eXBlLmF0dHIgPSBmdW5jdGlvbiAoIHgsIHZhbHVlICkge1xuICAgIC8vIHNldCB1c2luZyBvYmplY3RcbiAgICBpZiAoIHR5cGVvZiB4ID09PSAnb2JqZWN0JyApe1xuICAgICAgICBmb3IgKCB2YXIga2V5IGluIHggKSB7XG4gICAgICAgICAgICB0aGlzLmF0dHIoIGtleSwgeFsga2V5IF0gKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgXG4gICAgLy8gZ2V0XG4gICAgaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLmdldEF0dHJpYnV0ZSggeCApO1xuICAgIH1cbiAgICBcbiAgICAvLyByZW1vdmUgYXR0clxuICAgIGlmICggdmFsdWUgPT09IG51bGwgKXtcbiAgICAgICAgcmV0dXJuIHRoaXMucmVtb3ZlQXR0ciggeCApOyAgICBcbiAgICB9XG4gICAgXG4gICAgLy8gc2V0XG4gICAgdGhpcy5lbC5zZXRBdHRyaWJ1dGUoIHgsIHZhbHVlICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuYmVmb3JlID0gZnVuY3Rpb24gKCB4ICkge1xuICAgIHJldHVybiB0aGlzLl9pbnNlcnRIZWxwZXIoICdiZWZvcmViZWdpbicsIHggKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5jaGlsZHJlbiA9IGZ1bmN0aW9uICggc2VsZWN0b3IgKSB7XG4gICAgcmV0dXJuIHp6RE9NLl9idWlsZCggXG4gICAgICAgIHNlbGVjdG9yP1xuICAgICAgICAgICAgQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKFxuICAgICAgICAgICAgICAgIHRoaXMuZWwuY2hpbGRyZW4sIFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCBjaGlsZCApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQubWF0Y2hlcyggc2VsZWN0b3IgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApOlxuICAgICAgICAgICAgdGhpcy5lbC5jaGlsZHJlbiBcbiAgICApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24gKCAgKSB7XG4gICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggdGhpcy5lbC5jbG9uZU5vZGUoIHRydWUgKSApO1xufTtcblxuLy9UT0RPIGFkZCBzdXBwb3J0IG9mIGZ1bmN0aW9uIHR5cGUgaW4gdmFsdWVcbi8qKlxuICogQHBhcmFtIHtzdHJpbmd8T2JqZWN0fSB4MVxuICogQHBhcmFtIHtzdHJpbmd8bnVtYmVyPX0geDJcbiAqL1xuenpET00uU1MucHJvdG90eXBlLmNzcyA9IGZ1bmN0aW9uICggeDEsIHgyICkge1xuICAgIHZhciBudW1iZXIgPSBhcmd1bWVudHMubGVuZ3RoO1xuICAgIFxuICAgIGlmICggbnVtYmVyID09PSAxICl7XG4gICAgICAgIGlmICggISB4MSApe1xuICAgICAgICAgICAgdGhyb3cgJ051bGwgdmFsdWUgbm90IGFsbG93ZWQgaW4gY3NzIG1ldGhvZCEnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBnZXRcbiAgICAgICAgaWYgKCB0eXBlb2YgeDEgPT09ICdzdHJpbmcnICkge1xuICAgICAgICAgICAgcmV0dXJuIGdldENvbXB1dGVkU3R5bGUoIHRoaXMuZWwgKVsgeDEgXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gc2V0IHVzaW5nIG9iamVjdFxuICAgICAgICBpZiAoIHR5cGVvZiB4MSA9PT0gJ29iamVjdCcgKXtcbiAgICAgICAgICAgIHRoaXMuX3NldENzc1VzaW5nT2JqZWN0KCB4MSApO1xuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRocm93ICdXcm9uZyB0eXBlIG9yIGFyZ3VtZW50IGluIGNzcyBtZXRob2QhJztcbiAgICB9XG4gICAgXG4gICAgLy8gc2V0IHVzaW5nIGtleSB2YWx1ZSBwYWlyXG4gICAgaWYgKCBudW1iZXIgPT09IDIgKXtcbiAgICAgICAgdGhpcy5fc2V0Q3NzVXNpbmdLZXlWYWx1ZSggeDEsIHgyICk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBcbiAgICB0aHJvdyAnV3JvbmcgbnVtYmVyIG9mIGFyZ3VtZW50cyBpbiBjc3MgbWV0aG9kISc7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuZWFjaCA9IGZ1bmN0aW9uICggZWFjaEZuICkge1xuICAgIGVhY2hGbi5jYWxsKCB0aGlzLmVsLCAwLCB0aGlzLCB0aGlzLm5vZGVzICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuZW1wdHkgPSBmdW5jdGlvbiAoICApIHtcbiAgICB3aGlsZSggdGhpcy5lbC5maXJzdENoaWxkICl7XG4gICAgICAgIHRoaXMuZWwucmVtb3ZlQ2hpbGQoIHRoaXMuZWwuZmlyc3RDaGlsZCApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5maWx0ZXIgPSBmdW5jdGlvbiAoIHggKSB7XG4gICAgaWYgKCB0eXBlb2YgeCA9PT0gJ3N0cmluZycgKXsgLy8gSXMgYSBzdHJpbmcgc2VsZWN0b3JcbiAgICAgICAgcmV0dXJuIHp6RE9NLl9idWlsZCggXG4gICAgICAgICAgICB0aGlzLmVsLm1hdGNoZXMoIHggKT8gWyB0aGlzLmVsIF06IFtdXG4gICAgICAgICk7XG4gICAgfVxuICAgIFxuICAgIGlmICggdHlwZW9mIHggPT09ICdmdW5jdGlvbicgKXsgLy8gSXMgYSBmdW5jdGlvblxuICAgICAgICByZXR1cm4genpET00uX2J1aWxkKFxuICAgICAgICAgICAgeC5jYWxsKCB0aGlzLmVsLCB0aGlzLl9pID09PSB1bmRlZmluZWQ/IDA6IHRoaXMuX2ksIHRoaXMgKT8gWyB0aGlzLmVsIF06IFtdXG4gICAgICAgICk7XG4gICAgfSAgXG4gICAgXG4gICAgdGhyb3cgenpET00uX2dldEVycm9yKCAnZmlsdGVyJyApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmZpbmQgPSBmdW5jdGlvbiAoIHNlbGVjdG9yICkge1xuICAgIHJldHVybiB6ekRPTS5fYnVpbGQoIFxuICAgICAgICB0aGlzLmVsLnF1ZXJ5U2VsZWN0b3JBbGwoIHNlbGVjdG9yIClcbiAgICApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmhhc0NsYXNzID0gZnVuY3Rpb24gKCBuYW1lICkge1xuICAgIHJldHVybiB0aGlzLmVsLmNsYXNzTGlzdC5jb250YWlucyggbmFtZSApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmhlaWdodCA9IGZ1bmN0aW9uICggdmFsdWUgKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N0eWxlUHJvcGVydHkoICdoZWlnaHQnLCB2YWx1ZSApO1xufTtcblxuLy9UT0RPIGFkZCBzdXBwb3J0IG9mIGZ1bmN0aW9uIHR5cGUgaW4gdmFsdWVcbnp6RE9NLlNTLnByb3RvdHlwZS5odG1sID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICAvLyBnZXRcbiAgICBpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwuaW5uZXJIVE1MO1xuICAgIH1cblxuICAgIC8vIHNldFxuICAgIHRoaXMuZWwuaW5uZXJIVE1MID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaW5kZXggPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCAhIHRoaXMuZWwgKXtcbiAgICAgICAgcmV0dXJuIC0xO1xuICAgIH1cbiAgICBcbiAgICB2YXIgaSA9IDA7XG4gICAgdmFyIGN1cnJlbnRFbCA9IHRoaXMuZWw7XG4gICAgZG8ge1xuICAgICAgICBpKys7XG4gICAgfSB3aGlsZSAoIGN1cnJlbnRFbCA9IGN1cnJlbnRFbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nICk7XG4gICAgXG4gICAgcmV0dXJuIGk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaXMgPSBmdW5jdGlvbiAoIHggKSB7XG4gICAgaWYgKCB4ID09IG51bGwgKXtcbiAgICAgICAgcmV0dXJuIGZhbHNlOyAgICBcbiAgICB9XG4gICAgXG4gICAgaWYgKCB4IGluc3RhbmNlb2YgRWxlbWVudCApe1xuICAgICAgICByZXR1cm4gdGhpcy5lbCA9PT0geDtcbiAgICB9XG4gICAgXG4gICAgaWYgKCB4IGluc3RhbmNlb2YgenpET00uU1MgKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmVsID09PSB4LmVsO1xuICAgIH0gXG5cbiAgICBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5NTSApIHtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgeC5ub2Rlcy5sZW5ndGg7ICsraSApe1xuICAgICAgICAgICAgaWYgKCB0aGlzLmVsID09PSB4Lm5vZGVzWyBpIF0gKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfSBcblxuICAgIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICl7XG4gICAgICAgIHJldHVybiB0aGlzLmVsLm1hdGNoZXMoIHggKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGZhbHNlO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLm5leHQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggdGhpcy5lbC5uZXh0RWxlbWVudFNpYmxpbmcgKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5vZmZzZXQgPSBmdW5jdGlvbiAoIGMgKSB7XG4gICAgXG4gICAgLy8gc2V0IHRvcCBhbmQgbGVmdCB1c2luZyBjc3NcbiAgICBpZiAoIGMgKXtcbiAgICAgICAgdGhpcy5fc3R5bGVQcm9wZXJ0eSggJ3RvcCcsIGMudG9wICk7XG4gICAgICAgIHRoaXMuX3N0eWxlUHJvcGVydHkoICdsZWZ0JywgYy5sZWZ0ICk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBcbiAgICAvLyBnZXRcbiAgICB2YXIgcmVjdCA9IHRoaXMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XG4gICAgcmV0dXJuIHtcbiAgICAgICAgdG9wOiByZWN0LnRvcCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsVG9wLFxuICAgICAgICBsZWZ0OiByZWN0LmxlZnQgKyBkb2N1bWVudC5ib2R5LnNjcm9sbExlZnRcbiAgICB9O1xufTtcblxuenpET00uU1MucHJvdG90eXBlLm9mZnNldFBhcmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICB2YXIgb2Zmc2V0UGFyZW50ID0gdGhpcy5lbC5vZmZzZXRQYXJlbnQ7XG4gICAgcmV0dXJuIG9mZnNldFBhcmVudD8gbmV3IHp6RE9NLlNTKCBvZmZzZXRQYXJlbnQgKTogdGhpcztcbn07XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFuPX0gd2l0aE1hcmdpblxuICovXG56ekRPTS5TUy5wcm90b3R5cGUub3V0ZXJIZWlnaHQgPSBmdW5jdGlvbiAoIHdpdGhNYXJnaW4gKSB7XG4gICAgcmV0dXJuIHRoaXMuX291dGVyKCAnSGVpZ2h0JywgJ1RvcCcsICdCb3R0b20nLCB3aXRoTWFyZ2luICk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7Ym9vbGVhbj19IHdpdGhNYXJnaW5cbiAqL1xuenpET00uU1MucHJvdG90eXBlLm91dGVyV2lkdGggPSBmdW5jdGlvbiAoIHdpdGhNYXJnaW4gKSB7XG4gICAgcmV0dXJuIHRoaXMuX291dGVyKCAnV2lkdGgnLCAnTGVmdCcsICdSaWdodCcsIHdpdGhNYXJnaW4gKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5wYXJlbnQgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggdGhpcy5lbC5wYXJlbnROb2RlICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUucG9zaXRpb24gPSBmdW5jdGlvbiAoIHJlbGF0aXZlVG9WaWV3cG9ydCApIHtcbiAgICByZXR1cm4gcmVsYXRpdmVUb1ZpZXdwb3J0P1xuICAgICAgICB0aGlzLmVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOlxuICAgICAgICB7IFxuICAgICAgICAgICAgbGVmdDogdGhpcy5lbC5vZmZzZXRMZWZ0LCBcbiAgICAgICAgICAgIHRvcDogdGhpcy5lbC5vZmZzZXRUb3BcbiAgICAgICAgfTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5wcmVwZW5kID0gZnVuY3Rpb24gKCB4ICkge1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEVsZW1lbnQgKXtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRCZWZvcmUoIHgsIHRoaXMuZWwuZmlyc3RDaGlsZCApO1xuICAgIH0gZWxzZSBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5TUyApe1xuICAgICAgICB0aGlzLmVsLmluc2VydEJlZm9yZSggeC5lbCwgdGhpcy5lbC5maXJzdENoaWxkICk7XG4gICAgfSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICl7XG4gICAgICAgIHRoaXMuZWwuaW5zZXJ0QWRqYWNlbnRIVE1MKCAnYWZ0ZXJiZWdpbicsIHggKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICdwcmVwZW5kJyApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5wcmV2ID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiBuZXcgenpET00uU1MoIHRoaXMuZWwucHJldmlvdXNFbGVtZW50U2libGluZyApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnJlbW92ZSA9IGZ1bmN0aW9uICgpIHtcbiAgICB0aGlzLmVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIHRoaXMuZWwgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5yZW1vdmVBdHRyID0gZnVuY3Rpb24gKCBuYW1lICkge1xuICAgIHRoaXMuZWwucmVtb3ZlQXR0cmlidXRlKCBuYW1lICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUucmVtb3ZlQ2xhc3MgPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG4gICAgaWYgKCAhIG5hbWUgKXtcbiAgICAgICAgdGhpcy5lbC5jbGFzc05hbWUgPSAnJztcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzLl9pdGVyYXRlKFxuICAgICAgICBuYW1lLFxuICAgICAgICBmdW5jdGlvbiggc2VsZiwgdiApe1xuICAgICAgICAgICAgc2VsZi5lbC5jbGFzc0xpc3QucmVtb3ZlKCB2ICk7XG4gICAgICAgIH1cbiAgICApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnJlcGxhY2VXaXRoID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICB0aGlzLmVsLm91dGVySFRNTCA9IHZhbHVlO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnNpYmxpbmdzID0gZnVuY3Rpb24gKCBzZWxlY3RvciApIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgdmFyIG5vZGVzID0gQXJyYXkucHJvdG90eXBlLmZpbHRlci5jYWxsKCBcbiAgICAgICAgdGhpcy5lbC5wYXJlbnROb2RlLmNoaWxkcmVuLCBcbiAgICAgICAgc2VsZWN0b3I/XG4gICAgICAgICAgICBmdW5jdGlvbiggY2hpbGQgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQgIT09IHNlbGYuZWwgJiYgY2hpbGQubWF0Y2hlcyggc2VsZWN0b3IgKTtcbiAgICAgICAgICAgIH06XG4gICAgICAgICAgICBmdW5jdGlvbiggY2hpbGQgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gY2hpbGQgIT09IHNlbGYuZWw7XG4gICAgICAgICAgICB9XG4gICAgKTtcbiAgICByZXR1cm4genpET00uX2J1aWxkKCBub2RlcyApO1xufTtcblxuLy9UT0RPIGFkZCBzdXBwb3J0IG9mIGZ1bmN0aW9uIHR5cGUgaW4gdmFsdWVcbnp6RE9NLlNTLnByb3RvdHlwZS50ZXh0ID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICAvLyBnZXRcbiAgICBpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwudGV4dENvbnRlbnQ7XG4gICAgfVxuXG4gICAgLy8gc2V0XG4gICAgdGhpcy5lbC50ZXh0Q29udGVudCA9IHZhbHVlO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnRvZ2dsZUNsYXNzID0gZnVuY3Rpb24gKCBuYW1lLCBzdGF0ZSApIHtcbiAgICByZXR1cm4gdGhpcy5faXRlcmF0ZShcbiAgICAgICAgbmFtZSxcbiAgICAgICAgc3RhdGUgPT09IHVuZGVmaW5lZD9cbiAgICAgICAgICAgIGZ1bmN0aW9uKCBzZWxmLCB2ICl7XG4gICAgICAgICAgICAgICAgc2VsZi5lbC5jbGFzc0xpc3QudG9nZ2xlKCB2ICk7XG4gICAgICAgICAgICB9OlxuICAgICAgICAgICAgZnVuY3Rpb24oIHNlbGYsIHYgKXtcbiAgICAgICAgICAgICAgICBzZWxmLmVsLmNsYXNzTGlzdC50b2dnbGUoIHYsIHN0YXRlICk7XG4gICAgICAgICAgICB9XG4gICAgKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS53aWR0aCA9IGZ1bmN0aW9uICggdmFsdWUgKSB7XG4gICAgcmV0dXJuIHRoaXMuX3N0eWxlUHJvcGVydHkoICd3aWR0aCcsIHZhbHVlICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24gKCBldmVudE5hbWUsIGxpc3RlbmVyLCB1c2VDYXB0dXJlICkge1xuICAgIHp6RE9NLl9yZW1vdmVFdmVudExpc3RlbmVyKCB0aGlzLCBldmVudE5hbWUsIGxpc3RlbmVyLCB1c2VDYXB0dXJlICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUub24gPSBmdW5jdGlvbiAoIGV2ZW50TmFtZSwgbGlzdGVuZXIsIGRhdGEsIHVzZUNhcHR1cmUgKSB7XG4gICAgenpET00uX2FkZEV2ZW50TGlzdGVuZXIoIFxuICAgICAgICB0aGlzLCBcbiAgICAgICAgZXZlbnROYW1lLCBcbiAgICAgICAgZGF0YT8gXG4gICAgICAgICAgICBmdW5jdGlvbiggZSApe1xuICAgICAgICAgICAgICAgIGUuZGF0YSA9IGRhdGE7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGxpc3RlbmVyLmNhbGwoIGUuY3VycmVudFRhcmdldCwgZSApO1xuICAgICAgICAgICAgfTpcbiAgICAgICAgICAgIGxpc3RlbmVyLCBcbiAgICAgICAgdXNlQ2FwdHVyZSBcbiAgICApO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnRyaWdnZXIgPSBmdW5jdGlvbiAoIGV2ZW50TmFtZSApIHtcbiAgICB2YXIgZXZlbnQgPSBkb2N1bWVudC5jcmVhdGVFdmVudCggJ0hUTUxFdmVudHMnICk7XG4gICAgZXZlbnQuaW5pdEV2ZW50KCBldmVudE5hbWUsIHRydWUsIGZhbHNlICk7XG4gICAgdGhpcy5lbC5kaXNwYXRjaEV2ZW50KCBldmVudCApO1xuICAgIHJldHVybiB0aGlzO1xufTtcbi8qIEVuZCBvZiBldmVudHMgKi9cblxuenpET00uU1MucHJvdG90eXBlLmhpZGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCB0aGlzLmlzVmlzaWJsZSgpICl7XG4gICAgICAgIHRoaXMuYXR0ciggXG4gICAgICAgICAgICAnZGF0YS1kaXNwbGF5JywgXG4gICAgICAgICAgICBnZXRDb21wdXRlZFN0eWxlKCB0aGlzLmVsLCBudWxsIClbICdkaXNwbGF5JyBdXG4gICAgICAgICk7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuZGlzcGxheSA9ICdub25lJztcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaXNWaXNpYmxlID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiAhISB0aGlzLmVsLm9mZnNldFBhcmVudDtcbiAgICAvL3JldHVybiBnZXRDb21wdXRlZFN0eWxlKCB0aGlzLmVsLCBudWxsICkuZ2V0UHJvcGVydHlWYWx1ZSggJ2Rpc3BsYXknICkgIT09ICdub25lJztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5zaG93ID0gZnVuY3Rpb24gKCkge1xuICAgIGlmICggISB0aGlzLmlzVmlzaWJsZSgpICl7XG4gICAgICAgIHZhciBkaXNwbGF5ID0gdGhpcy5hdHRyKCAnZGF0YS1kaXNwbGF5JyApO1xuICAgICAgICB0aGlzLmVsLnN0eWxlLmRpc3BsYXkgPSBkaXNwbGF5PyBkaXNwbGF5OiB6ekRPTS5fZ2V0RGVmYXVsdERpc3BsYXkoIHRoaXMuZWwgKTtcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUudG9nZ2xlID0gZnVuY3Rpb24gKCBzdGF0ZSApIHtcbiAgICB2YXIgdmFsdWUgPSBzdGF0ZSAhPT0gdW5kZWZpbmVkPyAhIHN0YXRlOiB0aGlzLmlzVmlzaWJsZSgpO1xuICAgIHJldHVybiB2YWx1ZT8gdGhpcy5oaWRlKCk6IHRoaXMuc2hvdygpO1xufTtcbi8qIEVuZCBvZiB2aXNpYmxlICovXG5cbnp6RE9NLlNTLnByb3RvdHlwZS5jaGVja2VkID0gZnVuY3Rpb24gKCBjaGVjayApIHtcbiAgICBpZiAoIHRoaXMuZWwubm9kZU5hbWUgIT09ICdJTlBVVCcgfHwgKCB0aGlzLmVsLnR5cGUgIT09ICdjaGVja2JveCcgJiYgdGhpcy5lbC50eXBlICE9PSAncmFkaW8nKSApIHtcbiAgICAgICAgdGhyb3cgenpET00uX2dldEVycm9yKCAnY2hlY2tlZCcgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gZ2V0XG4gICAgaWYgKCBjaGVjayA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHJldHVybiAhISB0aGlzLmVsLmNoZWNrZWQ7XG4gICAgfVxuICAgIFxuICAgIC8vIHNldFxuICAgIHRoaXMuZWwuY2hlY2tlZCA9IGNoZWNrO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge0FycmF5PD8+fFN0cmluZz19IHZhbHVlXG4gKi9cbnp6RE9NLlNTLnByb3RvdHlwZS52YWwgPSBmdW5jdGlvbiAoIHZhbHVlICkge1xuICAgIC8vIGdldFxuICAgIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApe1xuICAgICAgICBzd2l0Y2ggKCB0aGlzLmVsLm5vZGVOYW1lICkge1xuICAgICAgICBjYXNlICdJTlBVVCc6XG4gICAgICAgIGNhc2UgJ1RFWFRBUkVBJzpcbiAgICAgICAgY2FzZSAnQlVUVE9OJzpcbiAgICAgICAgICAgIHJldHVybiB0aGlzLmVsLnZhbHVlO1xuICAgICAgICBjYXNlICdTRUxFQ1QnOlxuICAgICAgICAgICAgdmFyIHZhbHVlcyA9IFtdO1xuICAgICAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgdGhpcy5lbC5sZW5ndGg7ICsraSApIHtcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuZWxbIGkgXS5zZWxlY3RlZCApIHtcbiAgICAgICAgICAgICAgICAgICAgdmFsdWVzLnB1c2goIHRoaXMuZWxbIGkgXS52YWx1ZSApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB2YWx1ZXMubGVuZ3RoID4gMT8gdmFsdWVzOiB2YWx1ZXNbIDAgXTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IHp6RE9NLl9nZXRFcnJvciggJ3ZhbCcgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBzZXRcbiAgICBzd2l0Y2ggKCB0aGlzLmVsLm5vZGVOYW1lICkge1xuICAgIGNhc2UgJ0lOUFVUJzpcbiAgICBjYXNlICdURVhUQVJFQSc6XG4gICAgY2FzZSAnQlVUVE9OJzpcbiAgICAgICAgdGhpcy5lbC52YWx1ZSA9IHZhbHVlO1xuICAgICAgICBicmVhaztcbiAgICBjYXNlICdTRUxFQ1QnOlxuICAgICAgICBpZiAoIHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycgfHwgdHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyApIHtcbiAgICAgICAgICAgIHZhbHVlID0gWyB2YWx1ZSBdO1xuICAgICAgICB9XG4gICAgICAgIGZvciAoIGkgPSAwOyBpIDwgdGhpcy5lbC5sZW5ndGg7ICsraSApIHtcbiAgICAgICAgICAgIGZvciAoIHZhciBqID0gMDsgaiA8IHZhbHVlLmxlbmd0aDsgKytqICkge1xuICAgICAgICAgICAgICAgIHRoaXMuZWxbIGkgXS5zZWxlY3RlZCA9ICcnO1xuICAgICAgICAgICAgICAgIGlmICggdGhpcy5lbFsgaSBdLnZhbHVlID09PSB2YWx1ZVsgaiBdICkge1xuICAgICAgICAgICAgICAgICAgICB0aGlzLmVsWyBpIF0uc2VsZWN0ZWQgPSAnc2VsZWN0ZWQnO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYnJlYWs7XG4gICAgZGVmYXVsdDpcbiAgICAgICAgdGhyb3cgenpET00uX2dldEVycm9yKCAndmFsJyApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdGhpcztcbn07XG4vKiBFbmQgb2YgZm9ybXMgKi9cblxuenpET00uU1MucHJvdG90eXBlLmdldFhDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50V2lkdGggLSB0aGlzLm91dGVyV2lkdGgoKSApIC8gMjtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5nZXRZQ2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuICggZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmNsaWVudEhlaWdodCAtIHRoaXMub3V0ZXJIZWlnaHQoKSApIC8gMjtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5nZXRDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBsZWZ0OiB0aGlzLmdldFhDZW50ZXIoKSxcbiAgICAgICAgdG9wOiB0aGlzLmdldFlDZW50ZXIoKVxuICAgIH07XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuY2VudGVyID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5vZmZzZXQoIFxuICAgICAgICB0aGlzLmdldENlbnRlcigpIFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuY2VudGVyWCA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY3NzKCAnbGVmdCcsIHRoaXMuZ2V0WENlbnRlcigpICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuY2VudGVyWSA9IGZ1bmN0aW9uKCkge1xuICAgIHRoaXMuY3NzKCAndG9wJywgdGhpcy5nZXRZQ2VudGVyKCkgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG4vKiBFbmQgb2YgY2VudGVyICovXG5cbi8qKiBAY29uc3RydWN0b3IgKi9cbnp6RE9NLk1NID0gZnVuY3Rpb24gKCBfbm9kZXMgKSB7ICAgIFxuICAgIHRoaXMubGlzdCA9IFtdO1xuICAgIHRoaXMubm9kZXMgPSBfbm9kZXM7XG4gICAgdGhpcy5sZW5ndGggPSBfbm9kZXMubGVuZ3RoO1xuICAgIFxuICAgIC8vIEluaXQgbm9kZXNcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICB2YXIgZWwgPSB0aGlzLm5vZGVzWyBpIF07XG4gICAgICAgIHRoaXNbIGkgXSA9IGVsOyAvLyBmb3IgYXJyYXkgbGlrZVxuICAgICAgICB2YXIgc3MgPSBuZXcgenpET00uU1MoIGVsICk7XG4gICAgICAgIHRoaXMubGlzdC5wdXNoKCBzcyApO1xuICAgICAgICBzcy5faSA9IGk7IC8vIGZvciBpbmRleCBpbiBmdW5jdGlvbnNcbiAgICB9XG59O1xuXG4vKlxuVW5pZnkgdGhlIGRlZmluaXRpb24gb2YgYSBmdW5jdGlvbiBvZiB6ekRPTS5TUy5wcm90b3R5cGUgYW5kIGEgZGVmaW5pdGlvbiBvZiB6ekRPTS5NTS5wcm90b3R5cGUuIEV4YW1wbGU6XG5cbiAgICB6ekRPTS5hZGQoIFxuICAgICAgICB6ekRPTS5TUy5wcm90b3R5cGUubXlDdXN0b21GdW5jdGlvbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAuLi5cbiAgICAgICAgICAgIHJldHVybiB0aGlzO1xuICAgICAgICB9LFxuICAgICAgICB6ekRPTS5NTS5jb25zdHJ1Y3RvcnMuY29uY2F0XG4gICAgKTtcbik7XG4qL1xuLyoqXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBzc1Byb3RvdHlwZVxuICogQHBhcmFtIHtGdW5jdGlvbj19IGNvbnN0cnVjdG9yXG4gKi9cbnp6RE9NLmFkZCA9IGZ1bmN0aW9uKCBzc1Byb3RvdHlwZSwgY29uc3RydWN0b3IgKXtcbiAgICBmb3IgKCB2YXIgaWQgaW4genpET00uU1MucHJvdG90eXBlICl7XG4gICAgICAgIHZhciBjdXJyZW50ID0genpET00uU1MucHJvdG90eXBlWyBpZCBdO1xuICAgICAgICBpZiAoIHNzUHJvdG90eXBlID09PSBjdXJyZW50ICl7XG4gICAgICAgICAgICB2YXIgY2xvc3VyZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgdmFyIGZ1bmN0aW9uSWQgPSBpZDtcbiAgICAgICAgICAgICAgICByZXR1cm4gY29uc3RydWN0b3I/IGNvbnN0cnVjdG9yKCBmdW5jdGlvbklkICk6IHp6RE9NLk1NLmNvbnN0cnVjdG9ycy5kZWZhdWx0KCBmdW5jdGlvbklkICk7XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgenpET00uTU0ucHJvdG90eXBlWyBpZCBdID0gY2xvc3VyZSgpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHRocm93ICdFcnJvciByZWdpc3RlcmluZyB6ekRPTS5NTTogenpET00uU1Mgbm90IGZvdW5kLic7XG59O1xuXG56ekRPTS5NTS5jb25zdHJ1Y3RvcnMgPSB7fTtcbnp6RE9NLk1NLmNvbnN0cnVjdG9ycy5ib29sZWFuT3IgPSBmdW5jdGlvbiggZnVuY3Rpb25JZCApe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgc3MgPSB0aGlzLmxpc3RbIGkgXTtcbiAgICAgICAgICAgIHZhciB4ID0gc3NbIGZ1bmN0aW9uSWQgXS5hcHBseSggc3MsIGFyZ3VtZW50cyApO1xuICAgICAgICAgICAgaWYgKCB4ICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG59O1xuenpET00uTU0uY29uc3RydWN0b3JzLmNvbmNhdCA9IGZ1bmN0aW9uKCBmdW5jdGlvbklkICl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgIHZhciBuZXdOb2RlcyA9IFtdO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgc3MgPSB0aGlzLmxpc3RbIGkgXTtcbiAgICAgICAgICAgIHZhciB4ID0gc3NbIGZ1bmN0aW9uSWQgXS5hcHBseSggc3MsIGFyZ3VtZW50cyApO1xuICAgICAgICAgICAgbmV3Tm9kZXMgPSBuZXdOb2Rlcy5jb25jYXQoIHgubm9kZXMgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4genpET00uX2J1aWxkKCBuZXdOb2RlcyApO1xuICAgIH07XG59O1xuenpET00uTU0uY29uc3RydWN0b3JzLmRlZmF1bHQgPSBmdW5jdGlvbiggZnVuY3Rpb25JZCApe1xuICAgIHJldHVybiBmdW5jdGlvbigpe1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmxpc3QubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgc3MgPSB0aGlzLmxpc3RbIGkgXTtcbiAgICAgICAgICAgIHZhciByID0gc3NbIGZ1bmN0aW9uSWQgXS5hcHBseSggc3MsIGFyZ3VtZW50cyApO1xuICAgICAgICAgICAgaWYgKCBpID09PSAwICYmICEgKCByIGluc3RhbmNlb2YgenpET00uU1MgKSApe1xuICAgICAgICAgICAgICAgIHJldHVybiByO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59O1xuXG4vLyBJbml0IHByb3RvdHlwZSBmdW5jdGlvbnMgZnJvbSB6ekRPTS5TU1xuenpET00uTU0uaW5pdCA9IGZ1bmN0aW9uKCl7XG4gICAgLy8gQ29uY2F0IGZ1bmN0aW9uc1xuICAgIHZhciBjb25jYXRGID0gW1xuICAgICAgICAnY2hpbGRyZW4nLFxuICAgICAgICAnY2xvbmUnLFxuICAgICAgICAnZmlsdGVyJyxcbiAgICAgICAgJ2ZpbmQnLFxuICAgICAgICAnbmV4dCcsXG4gICAgICAgICdvZmZzZXRQYXJlbnQnLFxuICAgICAgICAncGFyZW50JyxcbiAgICAgICAgJ3ByZXYnLFxuICAgICAgICAnc2libGluZ3MnXG4gICAgXTtcbiAgICAvLyBCb29sZWFuIGZ1bmN0aW9uc1xuICAgIHZhciBib29sZWFuT3JGID0gW1xuICAgICAgICAnaGFzQ2xhc3MnLFxuICAgICAgICAnaXMnXG4gICAgXTtcbiAgICBmb3IgKCB2YXIgaWQgaW4genpET00uU1MucHJvdG90eXBlICl7XG4gICAgICAgIHZhciBjbG9zdXJlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIHZhciBmdW5jdGlvbklkID0gaWQ7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICggY29uY2F0Ri5pbmRleE9mKCBmdW5jdGlvbklkICkgIT09IC0xICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHp6RE9NLk1NLmNvbnN0cnVjdG9ycy5jb25jYXQoIGZ1bmN0aW9uSWQgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmICggYm9vbGVhbk9yRi5pbmRleE9mKCBmdW5jdGlvbklkICkgIT09IC0xICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHp6RE9NLk1NLmNvbnN0cnVjdG9ycy5ib29sZWFuT3IoIGZ1bmN0aW9uSWQgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB6ekRPTS5NTS5jb25zdHJ1Y3RvcnMuZGVmYXVsdCggZnVuY3Rpb25JZCApO1xuICAgICAgICB9O1xuICAgICAgICB6ekRPTS5NTS5wcm90b3R5cGVbIGlkIF0gPSBjbG9zdXJlKCk7XG4gICAgfVxufSgpO1xuXG4vKiBNZXRob2RzIGluY2x1ZGVkIGluIGpxdWVyeSAqL1xuenpET00uTU0ucHJvdG90eXBlLmVhY2ggPSBmdW5jdGlvbiAoIGVhY2hGbiApIHtcbiAgICB2YXIgc2VsZiA9IHRoaXM7XG4gICAgQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbCggXG4gICAgICAgIHRoaXMubGlzdCwgXG4gICAgICAgIGZ1bmN0aW9uKCBjdXJyZW50VmFsdWUsIGluZGV4ICl7XG4gICAgICAgICAgICBlYWNoRm4uY2FsbCggY3VycmVudFZhbHVlLmVsLCBpbmRleCwgY3VycmVudFZhbHVlLCBzZWxmLm5vZGVzICk7XG4gICAgICAgIH1cbiAgICApO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuLy8gUmVnaXN0ZXIgenpET00gaWYgd2UgYXJlIHVzaW5nIE5vZGVcbmlmICggdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcgJiYgbW9kdWxlLmV4cG9ydHMgKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSB6ekRPTTtcbn1cbiIsInZhciB6ekRPTSA9IHJlcXVpcmUoJy4vYnVpbGQvenpET00tY2xvc3VyZXMtZnVsbC5qcycpO1xubW9kdWxlLmV4cG9ydHMgPSB6ekRPTS56ejtcbiIsInZhciBRdW5pdCA9IHJlcXVpcmUoICdxdW5pdCcgKTtcbnZhciB6eiA9IHJlcXVpcmUoICd6emRvbScgKTtcbnZhciB6cHQgPSByZXF1aXJlKCAnenB0JyApO1xudmFyIGJsdWVSb3V0ZXIgPSByZXF1aXJlKCAnLi4vLi4vYnVpbGQvYmx1ZVJvdXRlci5qcycgKTtcblxuLy8gSW5pdCByb3V0ZXJcbmNvbnN0IGluaXRSb3V0ZXIgPSAoKSA9PiB7XG4gICAgLy8gSW5pdGlhbGl6ZSBwYWdlc1xuICAgIGNvbnN0IHBhZ2VzID0ge307XG5cbiAgICAvLyBMb2FkIGpzIG9mIHBhZ2VzXG4gICAgY29uc3QgZGljdGlvbmFyeSA9IHt9O1xuICAgIHBhZ2VzWyAncmVuZGVyV2l0aG91dFdhaXRpbmcnIF0gPSByZXF1aXJlKCAnLi9wYWdlcy9yZW5kZXJXaXRob3V0V2FpdGluZy5qcycgKSggZGljdGlvbmFyeSApO1xuICAgIHBhZ2VzWyAncmVuZGVyV2FpdGluZ0ZvclNlcnZlcicgXSA9IHJlcXVpcmUoICcuL3BhZ2VzL3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXIuanMnICkoIGRpY3Rpb25hcnkgKTtcblxuICAgIC8vIEluaXRpYWxpemUgb3B0aW9uczogbm8gYW5pbWF0aW9uc1xuICAgIGxldCBpbml0aWFsaXplWlBUID0gdHJ1ZTtcbiAgICBsZXQgb3B0aW9ucyA9IHtcbiAgICAgICAgZXZlbnRzQnlQYWdlOiBwYWdlcyxcbiAgICAgICAgYW5pbWF0aW9uSW46IGZhbHNlLFxuICAgICAgICByb3V0ZXM6IHJlcXVpcmUoICcuL3JvdXRlc0lubGluZUZvclJlbmRlci5qcycgKVxuICAgIH07XG5cbiAgICAvLyBBZGQgcmVuZGVyRnVuY3Rpb25cbiAgICBvcHRpb25zLnJlbmRlckZ1bmN0aW9uID0gKCBwYWdlICkgPT4ge1xuICAgICAgICBpZiAoIGluaXRpYWxpemVaUFQgKXtcbiAgICAgICAgICAgIHpwdC5ydW4oe1xuICAgICAgICAgICAgICAgICdyb290JzogZG9jdW1lbnQuYm9keSxcbiAgICAgICAgICAgICAgICAnZGljdGlvbmFyeSc6IGRpY3Rpb25hcnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaW5pdGlhbGl6ZVpQVCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgenB0LnJ1bih7XG4gICAgICAgICAgICAgICAgJ2NvbW1hbmQnOiAncGFydGlhbFJlbmRlcicsXG4gICAgICAgICAgICAgICAgJ3RhcmdldCc6IHBhZ2VbICdlbCcgXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIG5ldyByb3V0ZXIgaW5zdGFuY2VcbiAgICByZXR1cm4gbmV3IGJsdWVSb3V0ZXIucm91dGVyKCBvcHRpb25zICk7XG59O1xuXG4vLyBJbml0IHJvdXRlclxuY29uc3Qgcm91dGVyID0gaW5pdFJvdXRlcigpO1xuXG4vLyBVbml0IHRlc3RzXG5yZXF1aXJlKCAnLi9yZW5kZXIuanMnICkoKTtcblxuIiwiLyogcmVuZGVyV2l0aG91dFdhaXRpbmcgcGFnZSAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoIGRpY3Rpb25hcnkgKSB7XG4gICAgXG4gICAgdmFyIHpwdCA9IHJlcXVpcmUoICd6cHQnICk7XG5cbiAgICBjb25zdCBwYWdlID0ge307XG5cbiAgICBwYWdlWyAncHJlSW5pdCcgXSA9IGZ1bmN0aW9uKCBldmVudCApe1xuXG4gICAgICAgIGRpY3Rpb25hcnlbICdzdWNjZXNzTWVzc2FnZUZyb21TZXJ2ZXInIF0gPSAnTG9hZGluZy4uLic7XG4gICAgfTtcblxuICAgIHBhZ2VbICdpbml0JyBdID0gZnVuY3Rpb24oIGV2ZW50ICl7XG5cbiAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeVsgJ3N1Y2Nlc3NNZXNzYWdlRnJvbVNlcnZlcicgXSA9ICdJdCB3b3JrcyEnO1xuICAgICAgICAgICAgICAgIHpwdC5ydW4oe1xuICAgICAgICAgICAgICAgICAgICAnY29tbWFuZCc6ICdwYXJ0aWFsUmVuZGVyJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RhcmdldCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAncmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlJyApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMzAwXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHJldHVybiBwYWdlO1xufTtcbiIsIi8qIHJlbmRlcldpdGhvdXRXYWl0aW5nIHBhZ2UgKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoIGRpY3Rpb25hcnkgKSB7XG5cbiAgICBjb25zdCBwYWdlID0ge307XG5cbiAgICBwYWdlWyAncHJlSW5pdCcgXSA9IGZ1bmN0aW9uKCBldmVudCApe1xuICAgICAgICAvL2FsZXJ0KCAnRVZFTlRfUFJFX0lOSVQnICk7XG5cbiAgICAgICAgZGljdGlvbmFyeVsgJ3N1Y2Nlc3NNZXNzYWdlJyBdID0gJ0l0IHdvcmtzISc7XG4gICAgfTtcblxuICAgIHJldHVybiBwYWdlO1xufTtcbiIsIi8vIFRlc3RzIGZvciBldmVudHNcblxudmFyIHp6ID0gcmVxdWlyZSggJ3p6ZG9tJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4vdXRpbHMuanMnICk7XG52YXIgUXVuaXQgPSByZXF1aXJlKCAncXVuaXQnICk7XG5cbi8vIFVuaXQgdGVzdHNcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gTm9uIHdhaXRpbmcgcmVuZGVyIHRlc3RcbiAgICBRVW5pdC50ZXN0KCBcIk5vbiB3YWl0aW5nIHJlbmRlciB0ZXN0XCIsIGFzeW5jIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYSByZWZlcmVuY2UgdG8gZmluaXNoIHRoZSBxdW5pdCB0ZXN0IGxhdGVyXG4gICAgICAgIHZhciBkb25lID0gYXNzZXJ0LmFzeW5jKCk7XG5cbiAgICAgICAgLy8gR28gdG8gcGFnZSByZW5kZXJXaXRob3V0V2FpdGluZ1xuICAgICAgICB6eignI2hvbWVfcmVuZGVyV2l0aG91dFdhaXRpbmdMaW5rJykuZWwuY2xpY2soKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG4gICAgICAgIGFzc2VydC5lcXVhbCggenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19wJykudGV4dCgpLnRyaW0oKSAsIFwiVGhpcyBpcyBQYWdlIHJlbmRlciB3aXRob3V0IHdhaXRpbmdcIiApO1xuXG4gICAgICAgIC8vIENoZWNrIHRoYXQgcmVuZGVyIGlzIG9rXG4gICAgICAgIGFzc2VydC5lcXVhbCggenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19tZXNzYWdlJykudGV4dCgpLnRyaW0oKSAsIFwiSXQgd29ya3MhXCIgKTtcblxuICAgICAgICAvLyBHbyB0byBob21lIHBhZ2VcbiAgICAgICAgenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19ob21lTGluaycpLmVsLmNsaWNrKCk7XG4gICAgICAgIGF3YWl0IHV0aWxzLndhaXRTaG9ydCgpO1xuXG4gICAgICAgIC8vIEZpbmlzaCBxdW5pdCB0ZXN0XG4gICAgICAgIGRvbmUoKTtcbiAgICB9KTtcblxuICAgIC8vIFdhaXRpbmcgZm9yIHNlcnZlciByZW5kZXIgdGVzdFxuICAgIFFVbml0LnRlc3QoIFwiV2FpdGluZyBmb3Igc2VydmVyIHJlbmRlciB0ZXN0XCIsIGFzeW5jIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYSByZWZlcmVuY2UgdG8gZmluaXNoIHRoZSBxdW5pdCB0ZXN0IGxhdGVyXG4gICAgICAgIHZhciBkb25lID0gYXNzZXJ0LmFzeW5jKCk7XG5cbiAgICAgICAgLy8gR28gdG8gcGFnZSByZW5kZXJXaXRob3V0V2FpdGluZ1xuICAgICAgICB6eignI2hvbWVfcmVuZGVyV2FpdGluZ0ZvclNlcnZlckxpbmsnKS5lbC5jbGljaygpO1xuICAgICAgICBhd2FpdCB1dGlscy53YWl0U2hvcnQoKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKCB6eignI3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXJfcCcpLnRleHQoKS50cmltKCkgLCBcIlRoaXMgaXMgUGFnZSByZW5kZXIgd2FpdGluZyBmb3Igc2VydmVyXCIgKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayB0aGF0IHJlbmRlciBpcyBva1xuICAgICAgICBhc3NlcnQuZXF1YWwoIHp6KCcjcmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlJykudGV4dCgpLnRyaW0oKSAsIFwiSXQgd29ya3MhXCIgKTtcblxuICAgICAgICAvLyBHbyB0byBob21lIHBhZ2VcbiAgICAgICAgenooJyNyZW5kZXJXYWl0aW5nRm9yU2VydmVyX2hvbWVMaW5rJykuZWwuY2xpY2soKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG5cbiAgICAgICAgLy8gRmluaXNoIHF1bml0IHRlc3RcbiAgICAgICAgZG9uZSgpO1xuICAgIH0pO1xuXG59O1xuIiwiLy8gUm91dGVzIGZvciBpbmxpbmUgY29udGVudCBmb3IgcmVuZGVyIHRlc3RzXG5cbmNvbnN0IHJvdXRlcyA9IFtcbiAgICAvLyBIb21lIHBhZ2VcbiAgICB7XG4gICAgICAgIGlkOiAnW2hvbWVdJyxcbiAgICAgICAgY29udGVudDogYFxuPGgxPkJsdWUgcm91dGVyIHRlc3Q8L2gxPlxuXG48ZGl2IGNsYXNzPVwicGFnZS1jb250ZW50XCI+XG48aDM+SG9tZSBwYWdlPC9oMz5cbjxwPlxuICAgIFRoaXMgaXMgSG9tZSBwYWdlXG48L3A+XG5cbjx1bCBpZD1cImhvbWVfbGlua3NcIj5cbiAgICA8bGk+XG4gICAgICAgIDxhIGhyZWY9XCIhcmVuZGVyV2l0aG91dFdhaXRpbmdcIiBpZD1cImhvbWVfcmVuZGVyV2l0aG91dFdhaXRpbmdMaW5rXCI+UGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nPC9hPi4gR28gdG8gcGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nLlxuICAgIDwvbGk+XG4gICAgPGxpPlxuICAgICAgICA8YSBocmVmPVwiIXJlbmRlcldhaXRpbmdGb3JTZXJ2ZXJcIiBpZD1cImhvbWVfcmVuZGVyV2FpdGluZ0ZvclNlcnZlckxpbmtcIj5QYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXI8L2E+LiBHbyB0byBwYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXIuXG4gICAgPC9saT5cbjwvdWw+XG48L2Rpdj5cbmBcbiAgICB9LFxuICAgIC8vIHBhZ2UgcmVuZGVyIHdpdGhvdXQgd2FpdGluZ1xuICAgIHtcbiAgICAgICAgaWQ6ICdyZW5kZXJXaXRob3V0V2FpdGluZycsXG4gICAgICAgIGNvbnRlbnQ6IGBcbjxoMT5CbHVlIHJvdXRlciB0ZXN0PC9oMT5cblxuPGRpdj5cbjxhIGhyZWY9XCIhXCIgaWQ9XCJyZW5kZXJXaXRob3V0V2FpdGluZ19ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPlBhZ2UgcmVuZGVyPC9oMz5cbjxwIGlkPVwicmVuZGVyV2l0aG91dFdhaXRpbmdfcFwiPlxuICAgIFRoaXMgaXMgUGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nXG48L3A+XG5cbjxoMiBpZD1cInJlbmRlcldpdGhvdXRXYWl0aW5nX21lc3NhZ2VcIiBkYXRhLWNvbnRlbnQ9XCJzdWNjZXNzTWVzc2FnZVwiPlxuICAgIE5vdCB3b3JraW5nIVxuPC9oMj5cbjwvZGl2PlxuYFxuICAgIH0sXG4gICAgLy8gcGFnZSByZW5kZXIgd2FpdGluZyBmb3Igc2VydmVyXG4gICAge1xuICAgICAgICBpZDogJ3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXInLFxuICAgICAgICBjb250ZW50OiBgXG48aDE+Qmx1ZSByb3V0ZXIgdGVzdDwvaDE+XG5cbjxkaXY+XG48YSBocmVmPVwiIVwiIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPlBhZ2UgcmVuZGVyPC9oMz5cbjxwIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9wXCI+XG4gICAgVGhpcyBpcyBQYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXJcbjwvcD5cblxuPGgyIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlXCIgZGF0YS1jb250ZW50PVwic3VjY2Vzc01lc3NhZ2VGcm9tU2VydmVyXCI+XG4gICAgTm90IHdvcmtpbmchXG48L2gyPlxuPC9kaXY+XG5gXG4gICAgfSxcbiAgICAvLyBEZWZhdWx0IHJvdXRlICg0MDQgcGFnZSlcbiAgICB7XG4gICAgICAgIGlkOiAnWzQwNF0nLFxuICAgICAgICBjb250ZW50OiBgXG48aDE+Qmx1ZSByb3V0ZXIgdGVzdDwvaDE+XG5cbjxkaXY+XG48YSBocmVmPVwiIVwiIGlkPVwiZTQwNF9ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPjQwNCBwYWdlPC9oMz5cbjxwPlxuICAgIFNvcnJ5XG48L3A+XG48cCBpZD1cImU0MDRfcFwiPlxuICAgIFJlcXVlc3RlZCBjb250ZW50IG5vdCBmb3VuZC5cbjwvcD5cbjwvZGl2PlxuYFxuICAgIH1cbl07XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVzO1xuXG5cbiIsImNvbnN0IHV0aWxzID0ge307XG5cbnV0aWxzLndhaXRTaG9ydCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB1dGlscy53YWl0KCAxMDAwICk7XG59O1xuXG51dGlscy53YWl0ID0gZnVuY3Rpb24oIHRpbWVvdXQgKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKCByZXNvbHZlID0+IHtcbiAgICAgICAgc2V0VGltZW91dCggcmVzb2x2ZSwgdGltZW91dCApO1xuICAgIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlscztcblxuIl19

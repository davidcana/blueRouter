(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
/*! bluerouter - v0.1.0 - 2025-01-16 13:31:28 */
/**
 * A namespace.
 * @const
 */
const blueRouter = {};


/** @constructor */
blueRouter.router = function ( userOptions ) {

    // Init options
    this.options = {};
    blueRouter.utils.extend( this.options, blueRouter.defaultOptions, userOptions );
    this.checkOptions();

    // Preload pages if needed
    if ( this.options.preloadPagesOnLoad ){
        let self = this;
        blueRouter.htmlFetcher.loadAllUrls(
            this,
            () => {
                self.init();
            }
        );
        return;
    }

    // Do not preload pages, run init
    this.init();
};

/* Methods */

/** @suppress {missingProperties} */
blueRouter.router.prototype.init = function() {

    // Init some other vars
    this.routesMap = this.createRoutesMap();
    this.stack = [];

    // Add event listeners
    this.addEventListenersForWindow();

    // Navigate to window.location.href or home
    this.navigateUrl(
        this.options.updateOnLoad? window.location.href: '',
        this.options.animateTransitionsOnLoad
    );
};

// Check that mandatory user defined properties are defined
/** @suppress {missingProperties} */
blueRouter.router.prototype.checkOptions = function() {

    let errors = 0;
    let errorMessages = '';

    if ( ! this.options.routes ){
        ++errors;
        errorMessages += 'routes must be defined. ';
    }

    if ( ! this.options.eventsByPage ){
        ++errors;
        errorMessages += 'eventsByPage must be defined. ';
    }

    if ( errors ){
        this.alertError( 'Unable to initalize Blue router. ' + errors + ' errors found: ' + errorMessages );
    }
};

blueRouter.router.prototype.alertError = function( message ){
    alert( message );
    throw message;
};

blueRouter.router.prototype.addEventListenersForWindow = function() {
    /*
    window.onload = () => {
        this.navigateUrl( this.options.updateOnLoad? window.location.href: '', true );
    }
    */
    window.onpopstate = ( e ) => {
        this.navigateUrl( window.location.href, true );
        //this.navigateUrl( e.state[ 'page' ], true );
    };
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.addEventListenersForLinks = function( pageId ) {
    
    let self = this;

    // Add event listeners for a elements
    blueRouter.utils.addEventListenerOnList(
        //document.getElementsByTagName( 'a' ),
        document.getElementById( pageId ).getElementsByTagName( 'a' ),
        'click', 
        (e) => {
            const href = e.target.getAttribute( 'href' );

            // Follow the link if it is external (if it is marked as external in the class list)
            /*
            if ( e.target.classList.contains ( self.options.externalClass ) ){
                return;
            }
            */
            // Follow the link if it is external (if it does not start by !)
            if ( ! href.startsWith( self.options.PAGE_PREFIX ) ){
                return;
            }

            e.preventDefault();
            history.pushState(
                {
                    'page': href
                },
                'page ' + href,
                '#' + href
            );
            self.navigateUrl( href, true );
        }
    );
};

// Create a map with the data in routes, using the path as the key
blueRouter.router.prototype.createRoutesMap = function() {

    const routerMap = {};
    const routes = this.options.routes || [];

    routes.map( routeItem => {
        routerMap[ routeItem.id ] = routeItem;
    });

    return routerMap;
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.getRouteItem = function( pageId ) {

    // Look for the route
    let routeItem = this.routesMap[ pageId ];
    if ( routeItem ){
        return routeItem;
    }

    // No route found, 404 error
    routeItem = this.routesMap[ this.options.PAGE_ID_404_ERROR ];
    if ( routeItem ){
        return routeItem;
    }

    // No 404 page, build a 404 route
    return {
        id: this.options.PAGE_ID_404_ERROR,
        content: '<h3>404 - Page not found: ' + pageId + '</h3>'
    };
    //this.alertError( 'No route found with id ' + pageId + ' and no 404 page found.' );
};

blueRouter.router.prototype.navigateUrl = function( url, mustAnimateByCode ) {
    //alert( 'navigateUrl\nurl: ' + url );

    // Create an url object to make it easy everything
    let urlObject = blueRouter.utils.analizeUrl( url, this.options );

    // Update stack and get currentPageId
    let currentPageId = this.updateStack( urlObject.page );

    // Exit if trying to navigate to current page
    if ( currentPageId == urlObject.page ){
        return;
    }

    // Get the content
    let content = this.getContentForPage( urlObject.page );
    
    // If content is a Promise wait and resolve it
    let self = this;
    if ( content instanceof Promise ){
        content.then( function( text ){
            // Update content of route
            let routeItem = self.getRouteItem( urlObject.page );
            routeItem.content = text;

            // Run doPageTransition
            self.doPageTransition( text, urlObject.page, currentPageId, urlObject, mustAnimateByCode );
        });
        return;
    }

    // content is NOT a Promise: update current page
    this.doPageTransition( content, urlObject.page, currentPageId, urlObject, mustAnimateByCode );
};

blueRouter.router.prototype.updateStack = function( pageId ) {
    
    // If the penultimate element is the pageId then we are going backwards; otherwise we are going forward
    let isBackward = this.stack[ this.stack.length - 2 ] == pageId;

    if ( isBackward ){
        // Is backward
        return this.stack.pop();
    }

    // Is forward
    var currentPageId = this.stack[ this.stack.length - 1 ];
    this.stack.push( pageId );
    return currentPageId;
};

blueRouter.router.prototype.getContentForPage = function( pageId ) {

    // Get the routeItem from the routesMap
    let routeItem = this.getRouteItem( pageId );

    // Get the content of that route
    return this.getContentForRoute( routeItem );
};

blueRouter.router.prototype.getContentForRoute = function( routeItem ) {
    
    // Check keepAlive
    if ( routeItem.keepAlive ){
        let alivePage = document.getElementById( routeItem.id );
        if ( alivePage ){
            return alivePage;
        }
    }

    // Check content
    let content = routeItem.content;
    if ( content ){
        return content;
    }

    // Check url
    let url = routeItem.url;
    if ( url ){
        return blueRouter.htmlFetcher.loadUrl( url );
    }

    return '<div id="error">No content found for route from path ' + routeItem.id + '</div>';
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.doPageTransition = function( content, nextPageId, currentPageId, urlObject, mustAnimateByCode ) {

    // Get mustAnimateOut and mustAnimateIn
    const mustAnimateOut = mustAnimateByCode && !!this.options.animationOut;
    const mustAnimateIn = mustAnimateByCode && !!this.options.animationIn;

    // Get the initEvent
    const initEvent = content instanceof HTMLElement? blueRouter.defaultOptions.EVENT_REINIT: blueRouter.defaultOptions.EVENT_INIT;

    // Run events
    this.runEvent( blueRouter.defaultOptions.EVENT_BEFORE_OUT, currentPageId, {} );

    // Get the currentPage and add next page
    let currentPage = document.getElementsByClassName( 'currentPage' )[0];
    let newPage = this.addNextPage( currentPage, content, nextPageId );

    // Render next page
    this.runRenderRelated( initEvent, nextPageId, urlObject );

    // Define currentPageAnimationendListener and newPageAnimationendListener
    let self = this;
    let currentPageAnimationendListener = () => {
        currentPage.removeEventListener( 'animationend', currentPageAnimationendListener );
        
        // Remove hidden class, add animationIn class
        newPage.classList.remove( 'hidden' );
        if ( mustAnimateIn ){
            newPage.classList.add( this.options.animationIn );
        }

        // Retire current page: save it as an alive page or remove it
        this.retireCurrentPage( currentPageId, currentPage );
        self.runEvent( blueRouter.defaultOptions.EVENT_AFTER_OUT, currentPageId, {} );

        //  Run newPageAnimationendListener if listener of amimationend on newPage was not added
        if ( ! mustAnimateIn ) {
            newPageAnimationendListener();
        }
    };

    let newPageAnimationendListener = () => {
        newPage.removeEventListener( 'animationend', newPageAnimationendListener );

        // Remove nextPage class, add currentPage class, remove animationIn class
        newPage.classList.remove( 'nextPage' );
        newPage.classList.add( 'currentPage' );
        if ( mustAnimateIn ){
            newPage.classList.remove( this.options.animationIn );
        }

        // Run EVENT_INIT or EVENT_REINIT
        self.runEvent( initEvent, nextPageId, urlObject );

        // Run EVENT_MOUNTED
        self.runEvent( blueRouter.defaultOptions.EVENT_MOUNTED, nextPageId, urlObject );
    };

    // Add event listeners
    if ( mustAnimateOut ){
        currentPage.addEventListener( 'animationend', currentPageAnimationendListener );
    }
    if ( mustAnimateIn ){
        newPage.addEventListener( 'animationend', newPageAnimationendListener );
    }

    // Animate!
    if ( mustAnimateOut ){
        currentPage.classList.add( this.options.animationOut );
    } else {
        currentPageAnimationendListener();
    }
};

/** @suppress {missingProperties} */
blueRouter.router.prototype.runRenderRelated = function( initEvent, nextPageId, urlObject ){

    // Run preEvent (EVENT_PRE_INIT or EVENT_PRE_REINIT)
    const preEvent = initEvent ===  this.options.EVENT_INIT?
        this.options.EVENT_PRE_INIT:
        this.options.EVENT_PRE_REINIT

    this.runEvent( preEvent, nextPageId, urlObject );

    // Run render if needed
    const routeItem = this.getRouteItem( nextPageId );
    const renderOption = initEvent ===  this.options.EVENT_INIT?
        this.options.RUN_RENDER_BEFORE_EVENT_INIT:
        this.options.RUN_RENDER_BEFORE_EVENT_REINIT;
    const routeProperty = initEvent ===  this.options.EVENT_INIT?
        'runRenderBeforeInit':
        'runRenderBeforeReinit';
    const mustRunRender = routeItem[ routeProperty ] === undefined?
        renderOption:
        routeItem[ routeProperty ];

    if ( mustRunRender && this.options.renderFunction && blueRouter.utils.isFunction( this.options.renderFunction ) ){
        this.options.renderFunction(
            this.buildPageInstance( nextPageId )
        );
    }
};

blueRouter.router.prototype.buildPageInstance = function( pageId ){

    return {
         'id': pageId,
         'el': document.getElementById( pageId )
    };
};

blueRouter.router.prototype.addNextPage = function( currentPage, content, nextPageId ){

    if ( content instanceof HTMLElement ){
        // content is HTMLElement
        currentPage.insertAdjacentElement(
            'afterend',
            content
        );
        content.classList.add( 'nextPage' );
        content.classList.add( 'hidden' );
        content.classList.remove( 'alive' );

    } else {
        // content must be text
        currentPage.insertAdjacentHTML(
            'afterend',
            '<div class="nextPage hidden page" id="' + nextPageId + '">'
            + content
            + '</div>'
        );
    }

    return document.getElementById( nextPageId );
};

// Retire current page: save it as an alive page or remove it
blueRouter.router.prototype.retireCurrentPage = function( currentPageId, currentPage ){

    let currentRoute = this.getRouteItem( currentPageId );

    // If must keep alive current page, set page and alive as classes removing the rest
    if ( currentRoute && currentRoute.keepAlive){
        currentPage.removeAttribute( 'class' );
        currentPage.classList.add( 'page' );
        currentPage.classList.add( 'alive' );
        return;
    }

    // Do not keep alive current page, so remove it
    currentPage.remove();
};

blueRouter.router.prototype.runEvent = function( eventId, pageId, urlObject ) {

    if ( eventId == blueRouter.defaultOptions.EVENT_INIT ){
        this.addEventListenersForLinks( pageId );
    }

    // Get the page object from options
    /** @suppress {missingProperties} */
    let page = this.options.eventsByPage[ pageId ];

    // If a page is found, run the event handler
    if ( page ){
        let event = {
            params: urlObject.params || {}
        };
        if ( page[ eventId ] && blueRouter.utils.isFunction( page[ eventId ] ) ){
            page[ eventId ]( event );
        }
    }
};


// Default options

blueRouter.defaultOptions = {
    updateOnLoad: true,
    preloadPagesOnLoad: false,

    // Animations
    animationOut: 'slide-out-top',
    //animationOut: false,
    animationIn: 'scale-in-center',
    //animationIn: false,
    animateTransitionsOnLoad: false,
    
    // Misc
    PAGE_PREFIX: '!',

    // Special pages ids
    PAGE_ID_HOME: '[home]',
    PAGE_ID_404_ERROR: '[404]',

    // Events
    EVENT_PRE_INIT: 'preInit',
    EVENT_INIT: 'init',
    EVENT_PRE_REINIT: 'preReinit',
    EVENT_REINIT: 'reinit',
    EVENT_MOUNTED: 'mounted',
    EVENT_BEFORE_OUT: 'beforeOut',
    EVENT_AFTER_OUT: 'afterOut',

    RUN_RENDER_BEFORE_EVENT_INIT: true,
    RUN_RENDER_BEFORE_EVENT_REINIT: false

};


blueRouter.htmlFetcher = {};

blueRouter.htmlFetcher.loadAllUrls = function( router, callback ){

    // Get the routes to use
    const routes = router.options.routes || [];

    // Init the number ot urls to get
    let pending = 0;

    // Iterate urlRoutes and load each routeItem if needed
    routes.map( routeItem => {
        let url = routeItem.url;
        if ( url ){
            ++pending;
            blueRouter.htmlFetcher.loadUrl( url ).then(
                function( text ){
                    // Update content of route
                    routeItem.content = text;

                    // Run callback when all files have been loaded
                    if ( --pending == 0 && callback && blueRouter.utils.isFunction( callback ) ){
                        callback();
                    }
                }
            );
        }
    });
};

/**
 * @param {string} url
 * 
 */
blueRouter.htmlFetcher.loadUrl = async function( url ){

    const response = await fetch( url );

    if ( ! response.ok ) {
        const message = `Error fetching ${url} has occured: ${response.status}`;
        alert ( message );
        throw new Error( message );
    }
  
    const text = await response.text();
    return text;
};

blueRouter.utils = {};

/*
    Builds an object with data about the url. An example:

    url : http://127.0.0.1:9000/samples/sample.html#!about?param1=a&param2=b"

    prepage: http://127.0.0.1:9000/samples/sample.html
    page: about
    params: {
        param1: a
        param2: b
    }
*/
blueRouter.utils.analizeUrl = function( url, options ) {
    
    let result = {};

    // Extract the parts before and after PAGE_PREFIX
    let urlParts = url.split( options.PAGE_PREFIX );
    result.prepage = urlParts[ 0 ];
    let postPath = urlParts[ 1 ] || '';

    // Remove # if present
    if ( result.prepage.endsWith( '#' ) ){
        result.prepage = result.prepage.slice( 0, -1 );
    }

    // Extract the parts before and after ?
    let pathParts = postPath.split( '?' );
    result.page = pathParts[ 0 ];

    // Fix home page
    if ( result.page == '') {
        result.page = options.PAGE_ID_HOME;
    }

    let paramsString = pathParts[ 1 ] || '';

    // Add params
    result.params = {};
    if ( paramsString == '' ){
        return result;
    }
    let vars = paramsString.split( '&' );
    for ( let i = 0; i < vars.length; i++ ) {
        let pair = vars[ i ].split( '=' );
        let paramName = pair[ 0 ];
        let paramValue = pair[ 1 ];
        result.params[ paramName ] = paramValue;
    }

    return result;
};

blueRouter.utils.addEventListenerOnList = function( list, event, fn ) {

    for ( let i = 0, len = list.length; i < len; i++ ) {
        list[ i ].addEventListener( event, fn, false );
    }
};

blueRouter.utils.extend = function( out, from1, from2 ) {
    out = out || {};

    for ( var i = 1; i < arguments.length; i++ ) {
        if ( ! arguments[ i ] ){
            continue;
        }

        for ( var key in arguments[ i ] ) {
            if ( arguments[ i ].hasOwnProperty( key ) ){
                out[ key ] = arguments[ i ][ key ];
            }
        }
    }

    return out;
};

/* formatString */
// Example: itils.formatString( '{0} is dead, but {1} is alive!', 'ASP', 'ASP.NET' )
/**
 * Takes 1 or more strings and do something cool with them.
 * @param {...string|number} format
 */
blueRouter.utils.formatString = function( format ) {
    
    var args = Array.prototype.slice.call( arguments, 1 );
    return format.replace(/{(\d+)}/g, function ( match, number ) {
        return typeof args[ number ] != 'undefined'? args[ number ] : match;
    });
};

blueRouter.utils.isFunction = function isFunction( obj ) {

    // Support: Chrome <=57, Firefox <=52
    // In some browsers, typeof returns "function" for HTML <object> elements
    // (i.e., `typeof document.createElement( "object" ) === "function"`).
    // We don't want to classify *any* DOM node as a function.
    return typeof obj === "function" && typeof obj.nodeType !== "number";
};
/* end of utils */

// Register blueRouter if we are using Node
if ( typeof module === 'object' && module.exports ) {
    module.exports = blueRouter;
}

},{}],2:[function(require,module,exports){
(function(root, factory) {
  if (typeof define === 'function' && define.amd) {
    define([], factory);
  } else if (typeof exports === 'object') {
    module.exports = factory();
  } else {
    root.loadjs = factory();
  }
}(this, function() {
/**
 * Global dependencies.
 * @global {Object} document - DOM
 */

var devnull = function() {},
    bundleIdCache = {},
    bundleResultCache = {},
    bundleCallbackQueue = {};


/**
 * Subscribe to bundle load event.
 * @param {string[]} bundleIds - Bundle ids
 * @param {Function} callbackFn - The callback function
 */
function subscribe(bundleIds, callbackFn) {
  // listify
  bundleIds = bundleIds.push ? bundleIds : [bundleIds];

  var depsNotFound = [],
      i = bundleIds.length,
      numWaiting = i,
      fn,
      bundleId,
      r,
      q;

  // define callback function
  fn = function (bundleId, pathsNotFound) {
    if (pathsNotFound.length) depsNotFound.push(bundleId);

    numWaiting--;
    if (!numWaiting) callbackFn(depsNotFound);
  };

  // register callback
  while (i--) {
    bundleId = bundleIds[i];

    // execute callback if in result cache
    r = bundleResultCache[bundleId];
    if (r) {
      fn(bundleId, r);
      continue;
    }

    // add to callback queue
    q = bundleCallbackQueue[bundleId] = bundleCallbackQueue[bundleId] || [];
    q.push(fn);
  }
}


/**
 * Publish bundle load event.
 * @param {string} bundleId - Bundle id
 * @param {string[]} pathsNotFound - List of files not found
 */
function publish(bundleId, pathsNotFound) {
  // exit if id isn't defined
  if (!bundleId) return;

  var q = bundleCallbackQueue[bundleId];

  // cache result
  bundleResultCache[bundleId] = pathsNotFound;

  // exit if queue is empty
  if (!q) return;

  // empty callback queue
  while (q.length) {
    q[0](bundleId, pathsNotFound);
    q.splice(0, 1);
  }
}


/**
 * Execute callbacks.
 * @param {Object or Function} args - The callback args
 * @param {string[]} depsNotFound - List of dependencies not found
 */
function executeCallbacks(args, depsNotFound) {
  // accept function as argument
  if (args.call) args = {success: args};

  // success and error callbacks
  if (depsNotFound.length) (args.error || devnull)(depsNotFound);
  else (args.success || devnull)(args);
}


/**
 * Load individual file.
 * @param {string} path - The file path
 * @param {Function} callbackFn - The callback function
 */
function loadFile(path, callbackFn, args, numTries) {
  var doc = document,
      async = args.async,
      maxTries = (args.numRetries || 0) + 1,
      beforeCallbackFn = args.before || devnull,
      pathname = path.replace(/[\?|#].*$/, ''),
      pathStripped = path.replace(/^(css|img|module|nomodule)!/, ''),
      isLegacyIECss,
      hasModuleSupport,
      e;

  numTries = numTries || 0;

  if (/(^css!|\.css$)/.test(pathname)) {
    // css
    e = doc.createElement('link');
    e.rel = 'stylesheet';
    e.href = pathStripped;

    // tag IE9+
    isLegacyIECss = 'hideFocus' in e;

    // use preload in IE Edge (to detect load errors)
    if (isLegacyIECss && e.relList) {
      isLegacyIECss = 0;
      e.rel = 'preload';
      e.as = 'style';
    }
  } else if (/(^img!|\.(png|gif|jpg|svg|webp)$)/.test(pathname)) {
    // image
    e = doc.createElement('img');
    e.src = pathStripped;    
  } else {
    // javascript
    e = doc.createElement('script');
    e.src = pathStripped;
    e.async = async === undefined ? true : async;

    // handle es modules
    // modern browsers:
    //   module: add to dom with type="module"
    //   nomodule: call success() callback without adding to dom
    // legacy browsers:
    //   module: call success() callback without adding to dom
    //   nomodule: add to dom with default type ("text/javascript")
    hasModuleSupport = 'noModule' in e;
    if (/^module!/.test(pathname)) {
      if (!hasModuleSupport) return callbackFn(path, 'l');
      e.type = "module";
    } else if (/^nomodule!/.test(pathname) && hasModuleSupport) return callbackFn(path, 'l');
  }

  e.onload = e.onerror = e.onbeforeload = function (ev) {
    var result = ev.type[0];

    // treat empty stylesheets as failures to get around lack of onerror
    // support in IE9-11
    if (isLegacyIECss) {
      try {
        if (!e.sheet.cssText.length) result = 'e';
      } catch (x) {
        // sheets objects created from load errors don't allow access to
        // `cssText` (unless error is Code:18 SecurityError)
        if (x.code != 18) result = 'e';
      }
    }

    // handle retries in case of load failure
    if (result == 'e') {
      // increment counter
      numTries += 1;

      // exit function and try again
      if (numTries < maxTries) {
        return loadFile(path, callbackFn, args, numTries);
      }
    } else if (e.rel == 'preload' && e.as == 'style') {
      // activate preloaded stylesheets
      return e.rel = 'stylesheet'; // jshint ignore:line
    }
    
    // execute callback
    callbackFn(path, result, ev.defaultPrevented);
  };

  // add to document (unless callback returns `false`)
  if (beforeCallbackFn(path, e) !== false) doc.head.appendChild(e);
}


/**
 * Load multiple files.
 * @param {string[]} paths - The file paths
 * @param {Function} callbackFn - The callback function
 */
function loadFiles(paths, callbackFn, args) {
  // listify paths
  paths = paths.push ? paths : [paths];

  var numWaiting = paths.length,
      x = numWaiting,
      pathsNotFound = [],
      fn,
      i;

  // define callback function
  fn = function(path, result, defaultPrevented) {
    // handle error
    if (result == 'e') pathsNotFound.push(path);

    // handle beforeload event. If defaultPrevented then that means the load
    // will be blocked (ex. Ghostery/ABP on Safari)
    if (result == 'b') {
      if (defaultPrevented) pathsNotFound.push(path);
      else return;
    }

    numWaiting--;
    if (!numWaiting) callbackFn(pathsNotFound);
  };

  // load scripts
  for (i=0; i < x; i++) loadFile(paths[i], fn, args);
}


/**
 * Initiate script load and register bundle.
 * @param {(string|string[])} paths - The file paths
 * @param {(string|Function|Object)} [arg1] - The (1) bundleId or (2) success
 *   callback or (3) object literal with success/error arguments, numRetries,
 *   etc.
 * @param {(Function|Object)} [arg2] - The (1) success callback or (2) object
 *   literal with success/error arguments, numRetries, etc.
 */
function loadjs(paths, arg1, arg2) {
  var bundleId,
      args;

  // bundleId (if string)
  if (arg1 && arg1.trim) bundleId = arg1;

  // args (default is {})
  args = (bundleId ? arg2 : arg1) || {};

  // throw error if bundle is already defined
  if (bundleId) {
    if (bundleId in bundleIdCache) {
      throw "LoadJS";
    } else {
      bundleIdCache[bundleId] = true;
    }
  }

  function loadFn(resolve, reject) {
    loadFiles(paths, function (pathsNotFound) {
      // execute callbacks
      executeCallbacks(args, pathsNotFound);
      
      // resolve Promise
      if (resolve) {
        executeCallbacks({success: resolve, error: reject}, pathsNotFound);
      }

      // publish bundle load event
      publish(bundleId, pathsNotFound);
    }, args);
  }
  
  if (args.returnPromise) return new Promise(loadFn);
  else loadFn();
}


/**
 * Execute callbacks when dependencies have been satisfied.
 * @param {(string|string[])} deps - List of bundle ids
 * @param {Object} args - success/error arguments
 */
loadjs.ready = function ready(deps, args) {
  // subscribe to bundle load event
  subscribe(deps, function (depsNotFound) {
    // execute callbacks
    executeCallbacks(args, depsNotFound);
  });

  return loadjs;
};


/**
 * Manually satisfy bundle dependencies.
 * @param {string} bundleId - The bundle id
 */
loadjs.done = function done(bundleId) {
  publish(bundleId, []);
};


/**
 * Reset loadjs dependencies statuses
 */
loadjs.reset = function reset() {
  bundleIdCache = {};
  bundleResultCache = {};
  bundleCallbackQueue = {};
};


/**
 * Determine if bundle has already been defined
 * @param String} bundleId - The bundle id
 */
loadjs.isDefined = function isDefined(bundleId) {
  return bundleId in bundleIdCache;
};


// export
return loadjs;

}));

},{}],3:[function(require,module,exports){
/**
 * Copyright 2015 Tim Down.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *      http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */


(function(factory,root){if(typeof define=="function"&&define.amd){define(factory);}else if(typeof module!="undefined"&&typeof exports=="object"){module.exports=factory();}else{root.log4javascript=factory();}})(function(){if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}
return this.length;};}
if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}
this.length=this.length-1;return firstItem;}};}
if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}
var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}
return itemsDeleted;};}
function isUndefined(obj){return typeof obj=="undefined";}
function EventSupport(){}
EventSupport.prototype={eventTypes:[],eventListeners:{},setEventTypes:function(eventTypesParam){if(eventTypesParam instanceof Array){this.eventTypes=eventTypesParam;this.eventListeners={};for(var i=0,len=this.eventTypes.length;i<len;i++){this.eventListeners[this.eventTypes[i]]=[];}}else{handleError("log4javascript.EventSupport ["+this+"]: setEventTypes: eventTypes parameter must be an Array");}},addEventListener:function(eventType,listener){if(typeof listener=="function"){if(!array_contains(this.eventTypes,eventType)){handleError("log4javascript.EventSupport ["+this+"]: addEventListener: no event called '"+eventType+"'");}
this.eventListeners[eventType].push(listener);}else{handleError("log4javascript.EventSupport ["+this+"]: addEventListener: listener must be a function");}},removeEventListener:function(eventType,listener){if(typeof listener=="function"){if(!array_contains(this.eventTypes,eventType)){handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: no event called '"+eventType+"'");}
array_remove(this.eventListeners[eventType],listener);}else{handleError("log4javascript.EventSupport ["+this+"]: removeEventListener: listener must be a function");}},dispatchEvent:function(eventType,eventArgs){if(array_contains(this.eventTypes,eventType)){var listeners=this.eventListeners[eventType];for(var i=0,len=listeners.length;i<len;i++){listeners[i](this,eventType,eventArgs);}}else{handleError("log4javascript.EventSupport ["+this+"]: dispatchEvent: no event called '"+eventType+"'");}}};var applicationStartDate=new Date();var uniqueId="log4javascript_"+applicationStartDate.getTime()+"_"+
Math.floor(Math.random()*100000000);var emptyFunction=function(){};var newLine="\r\n";var pageLoaded=false;function Log4JavaScript(){}
Log4JavaScript.prototype=new EventSupport();var log4javascript=new Log4JavaScript();log4javascript.version="1.4.13";log4javascript.edition="log4javascript";function toStr(obj){if(obj&&obj.toString){return obj.toString();}else{return String(obj);}}
function getExceptionMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}else{return toStr(ex);}}
function getUrlFileName(url){var lastSlashIndex=Math.max(url.lastIndexOf("/"),url.lastIndexOf("\\"));return url.substr(lastSlashIndex+1);}
function getExceptionStringRep(ex){if(ex){var exStr="Exception: "+getExceptionMessage(ex);try{if(ex.lineNumber){exStr+=" on line number "+ex.lineNumber;}
if(ex.fileName){exStr+=" in file "+getUrlFileName(ex.fileName);}}catch(localEx){logLog.warn("Unable to obtain file and line information for error");}
if(showStackTraces&&ex.stack){exStr+=newLine+"Stack trace:"+newLine+ex.stack;}
return exStr;}
return null;}
function bool(obj){return Boolean(obj);}
function trim(str){return str.replace(/^\s+/,"").replace(/\s+$/,"");}
function splitIntoLines(text){var text2=text.replace(/\r\n/g,"\n").replace(/\r/g,"\n");return text2.split("\n");}
var urlEncode=(typeof window.encodeURIComponent!="undefined")?function(str){return encodeURIComponent(str);}:function(str){return escape(str).replace(/\+/g,"%2B").replace(/"/g,"%22").replace(/'/g,"%27").replace(/\//g,"%2F").replace(/=/g,"%3D");};function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}
if(index>=0){arr.splice(index,1);return true;}else{return false;}}
function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}
return false;}
function extractBooleanFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{return bool(param);}}
function extractStringFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{return String(param);}}
function extractIntFromParam(param,defaultValue){if(isUndefined(param)){return defaultValue;}else{try{var value=parseInt(param,10);return isNaN(value)?defaultValue:value;}catch(ex){logLog.warn("Invalid int param "+param,ex);return defaultValue;}}}
function extractFunctionFromParam(param,defaultValue){if(typeof param=="function"){return param;}else{return defaultValue;}}
function isError(err){return(err instanceof Error);}
if(!Function.prototype.apply){Function.prototype.apply=function(obj,args){var methodName="__apply__";if(typeof obj[methodName]!="undefined"){methodName+=String(Math.random()).substr(2);}
obj[methodName]=this;var argsStrings=[];for(var i=0,len=args.length;i<len;i++){argsStrings[i]="args["+i+"]";}
var script="obj."+methodName+"("+argsStrings.join(",")+")";var returnValue=eval(script);delete obj[methodName];return returnValue;};}
if(!Function.prototype.call){Function.prototype.call=function(obj){var args=[];for(var i=1,len=arguments.length;i<len;i++){args[i-1]=arguments[i];}
return this.apply(obj,args);};}
var logLog={quietMode:false,debugMessages:[],setQuietMode:function(quietMode){this.quietMode=bool(quietMode);},numberOfErrors:0,alertAllErrors:false,setAlertAllErrors:function(alertAllErrors){this.alertAllErrors=alertAllErrors;},debug:function(message){this.debugMessages.push(message);},displayDebug:function(){alert(this.debugMessages.join(newLine));},warn:function(message,exception){},error:function(message,exception){if(++this.numberOfErrors==1||this.alertAllErrors){if(!this.quietMode){var alertMessage="log4javascript error: "+message;if(exception){alertMessage+=newLine+newLine+"Original error: "+getExceptionStringRep(exception);}
alert(alertMessage);}}}};log4javascript.logLog=logLog;log4javascript.setEventTypes(["load","error"]);function handleError(message,exception){logLog.error(message,exception);log4javascript.dispatchEvent("error",{"message":message,"exception":exception});}
log4javascript.handleError=handleError;var enabled=!((typeof log4javascript_disabled!="undefined")&&log4javascript_disabled);log4javascript.setEnabled=function(enable){enabled=bool(enable);};log4javascript.isEnabled=function(){return enabled;};var useTimeStampsInMilliseconds=true;log4javascript.setTimeStampsInMilliseconds=function(timeStampsInMilliseconds){useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds);};log4javascript.isTimeStampsInMilliseconds=function(){return useTimeStampsInMilliseconds;};log4javascript.evalInScope=function(expr){return eval(expr);};var showStackTraces=false;log4javascript.setShowStackTraces=function(show){showStackTraces=bool(show);};var Level=function(level,name){this.level=level;this.name=name;};Level.prototype={toString:function(){return this.name;},equals:function(level){return this.level==level.level;},isGreaterOrEqual:function(level){return this.level>=level.level;}};Level.ALL=new Level(Number.MIN_VALUE,"ALL");Level.TRACE=new Level(10000,"TRACE");Level.DEBUG=new Level(20000,"DEBUG");Level.INFO=new Level(30000,"INFO");Level.WARN=new Level(40000,"WARN");Level.ERROR=new Level(50000,"ERROR");Level.FATAL=new Level(60000,"FATAL");Level.OFF=new Level(Number.MAX_VALUE,"OFF");log4javascript.Level=Level;function Timer(name,level){this.name=name;this.level=isUndefined(level)?Level.INFO:level;this.start=new Date();}
Timer.prototype.getElapsedTime=function(){return new Date().getTime()-this.start.getTime();};var anonymousLoggerName="[anonymous]";var defaultLoggerName="[default]";var nullLoggerName="[null]";var rootLoggerName="root";function Logger(name){this.name=name;this.parent=null;this.children=[];var appenders=[];var loggerLevel=null;var isRoot=(this.name===rootLoggerName);var isNull=(this.name===nullLoggerName);var appenderCache=null;var appenderCacheInvalidated=false;this.addChild=function(childLogger){this.children.push(childLogger);childLogger.parent=this;childLogger.invalidateAppenderCache();};var additive=true;this.getAdditivity=function(){return additive;};this.setAdditivity=function(additivity){var valueChanged=(additive!=additivity);additive=additivity;if(valueChanged){this.invalidateAppenderCache();}};this.addAppender=function(appender){if(isNull){handleError("Logger.addAppender: you may not add an appender to the null logger");}else{if(appender instanceof log4javascript.Appender){if(!array_contains(appenders,appender)){appenders.push(appender);appender.setAddedToLogger(this);this.invalidateAppenderCache();}}else{handleError("Logger.addAppender: appender supplied ('"+
toStr(appender)+"') is not a subclass of Appender");}}};this.removeAppender=function(appender){array_remove(appenders,appender);appender.setRemovedFromLogger(this);this.invalidateAppenderCache();};this.removeAllAppenders=function(){var appenderCount=appenders.length;if(appenderCount>0){for(var i=0;i<appenderCount;i++){appenders[i].setRemovedFromLogger(this);}
appenders.length=0;this.invalidateAppenderCache();}};this.getEffectiveAppenders=function(){if(appenderCache===null||appenderCacheInvalidated){var parentEffectiveAppenders=(isRoot||!this.getAdditivity())?[]:this.parent.getEffectiveAppenders();appenderCache=parentEffectiveAppenders.concat(appenders);appenderCacheInvalidated=false;}
return appenderCache;};this.invalidateAppenderCache=function(){appenderCacheInvalidated=true;for(var i=0,len=this.children.length;i<len;i++){this.children[i].invalidateAppenderCache();}};this.log=function(level,params){if(enabled&&level.isGreaterOrEqual(this.getEffectiveLevel())){var exception;var finalParamIndex=params.length-1;var lastParam=params[finalParamIndex];if(params.length>1&&isError(lastParam)){exception=lastParam;finalParamIndex--;}
var messages=[];for(var i=0;i<=finalParamIndex;i++){messages[i]=params[i];}
var loggingEvent=new LoggingEvent(this,new Date(),level,messages,exception);this.callAppenders(loggingEvent);}};this.callAppenders=function(loggingEvent){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].doAppend(loggingEvent);}};this.setLevel=function(level){if(isRoot&&level===null){handleError("Logger.setLevel: you cannot set the level of the root logger to null");}else if(level instanceof Level){loggerLevel=level;}else{handleError("Logger.setLevel: level supplied to logger "+
this.name+" is not an instance of log4javascript.Level");}};this.getLevel=function(){return loggerLevel;};this.getEffectiveLevel=function(){for(var logger=this;logger!==null;logger=logger.parent){var level=logger.getLevel();if(level!==null){return level;}}};this.group=function(name,initiallyExpanded){if(enabled){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].group(name,initiallyExpanded);}}};this.groupEnd=function(){if(enabled){var effectiveAppenders=this.getEffectiveAppenders();for(var i=0,len=effectiveAppenders.length;i<len;i++){effectiveAppenders[i].groupEnd();}}};var timers={};this.time=function(name,level){if(enabled){if(isUndefined(name)){handleError("Logger.time: a name for the timer must be supplied");}else if(level&&!(level instanceof Level)){handleError("Logger.time: level supplied to timer "+
name+" is not an instance of log4javascript.Level");}else{timers[name]=new Timer(name,level);}}};this.timeEnd=function(name){if(enabled){if(isUndefined(name)){handleError("Logger.timeEnd: a name for the timer must be supplied");}else if(timers[name]){var timer=timers[name];var milliseconds=timer.getElapsedTime();this.log(timer.level,["Timer "+toStr(name)+" completed in "+milliseconds+"ms"]);delete timers[name];}else{logLog.warn("Logger.timeEnd: no timer found with name "+name);}}};this.assert=function(expr){if(enabled&&!expr){var args=[];for(var i=1,len=arguments.length;i<len;i++){args.push(arguments[i]);}
args=(args.length>0)?args:["Assertion Failure"];args.push(newLine);args.push(expr);this.log(Level.ERROR,args);}};this.toString=function(){return"Logger["+this.name+"]";};}
Logger.prototype={trace:function(){this.log(Level.TRACE,arguments);},debug:function(){this.log(Level.DEBUG,arguments);},info:function(){this.log(Level.INFO,arguments);},warn:function(){this.log(Level.WARN,arguments);},error:function(){this.log(Level.ERROR,arguments);},fatal:function(){this.log(Level.FATAL,arguments);},isEnabledFor:function(level){return level.isGreaterOrEqual(this.getEffectiveLevel());},isTraceEnabled:function(){return this.isEnabledFor(Level.TRACE);},isDebugEnabled:function(){return this.isEnabledFor(Level.DEBUG);},isInfoEnabled:function(){return this.isEnabledFor(Level.INFO);},isWarnEnabled:function(){return this.isEnabledFor(Level.WARN);},isErrorEnabled:function(){return this.isEnabledFor(Level.ERROR);},isFatalEnabled:function(){return this.isEnabledFor(Level.FATAL);}};Logger.prototype.trace.isEntryPoint=true;Logger.prototype.debug.isEntryPoint=true;Logger.prototype.info.isEntryPoint=true;Logger.prototype.warn.isEntryPoint=true;Logger.prototype.error.isEntryPoint=true;Logger.prototype.fatal.isEntryPoint=true;var loggers={};var loggerNames=[];var ROOT_LOGGER_DEFAULT_LEVEL=Level.DEBUG;var rootLogger=new Logger(rootLoggerName);rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL);log4javascript.getRootLogger=function(){return rootLogger;};log4javascript.getLogger=function(loggerName){if(typeof loggerName!="string"){loggerName=anonymousLoggerName;logLog.warn("log4javascript.getLogger: non-string logger name "+
toStr(loggerName)+" supplied, returning anonymous logger");}
if(loggerName==rootLoggerName){handleError("log4javascript.getLogger: root logger may not be obtained by name");}
if(!loggers[loggerName]){var logger=new Logger(loggerName);loggers[loggerName]=logger;loggerNames.push(loggerName);var lastDotIndex=loggerName.lastIndexOf(".");var parentLogger;if(lastDotIndex>-1){var parentLoggerName=loggerName.substring(0,lastDotIndex);parentLogger=log4javascript.getLogger(parentLoggerName);}else{parentLogger=rootLogger;}
parentLogger.addChild(logger);}
return loggers[loggerName];};var defaultLogger=null;log4javascript.getDefaultLogger=function(){if(!defaultLogger){defaultLogger=createDefaultLogger();}
return defaultLogger;};var nullLogger=null;log4javascript.getNullLogger=function(){if(!nullLogger){nullLogger=new Logger(nullLoggerName);nullLogger.setLevel(Level.OFF);}
return nullLogger;};log4javascript.resetConfiguration=function(){rootLogger.setLevel(ROOT_LOGGER_DEFAULT_LEVEL);loggers={};};var LoggingEvent=function(logger,timeStamp,level,messages,exception){this.logger=logger;this.timeStamp=timeStamp;this.timeStampInMilliseconds=timeStamp.getTime();this.timeStampInSeconds=Math.floor(this.timeStampInMilliseconds/1000);this.milliseconds=this.timeStamp.getMilliseconds();this.level=level;this.messages=messages;this.exception=exception;};LoggingEvent.prototype={getThrowableStrRep:function(){return this.exception?getExceptionStringRep(this.exception):"";},getCombinedMessages:function(){return(this.messages.length==1)?this.messages[0]:this.messages.join(newLine);},toString:function(){return"LoggingEvent["+this.level+"]";}};log4javascript.LoggingEvent=LoggingEvent;var Layout=function(){};Layout.prototype={defaults:{loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url"},loggerKey:"logger",timeStampKey:"timestamp",millisecondsKey:"milliseconds",levelKey:"level",messageKey:"message",exceptionKey:"exception",urlKey:"url",batchHeader:"",batchFooter:"",batchSeparator:"",returnsPostData:false,overrideTimeStampsSetting:false,useTimeStampsInMilliseconds:null,format:function(){handleError("Layout.format: layout supplied has no format() method");},ignoresThrowable:function(){handleError("Layout.ignoresThrowable: layout supplied has no ignoresThrowable() method");},getContentType:function(){return"text/plain";},allowBatching:function(){return true;},setTimeStampsInMilliseconds:function(timeStampsInMilliseconds){this.overrideTimeStampsSetting=true;this.useTimeStampsInMilliseconds=bool(timeStampsInMilliseconds);},isTimeStampsInMilliseconds:function(){return this.overrideTimeStampsSetting?this.useTimeStampsInMilliseconds:useTimeStampsInMilliseconds;},getTimeStampValue:function(loggingEvent){return this.isTimeStampsInMilliseconds()?loggingEvent.timeStampInMilliseconds:loggingEvent.timeStampInSeconds;},getDataValues:function(loggingEvent,combineMessages){var dataValues=[[this.loggerKey,loggingEvent.logger.name],[this.timeStampKey,this.getTimeStampValue(loggingEvent)],[this.levelKey,loggingEvent.level.name],[this.urlKey,window.location.href],[this.messageKey,combineMessages?loggingEvent.getCombinedMessages():loggingEvent.messages]];if(!this.isTimeStampsInMilliseconds()){dataValues.push([this.millisecondsKey,loggingEvent.milliseconds]);}
if(loggingEvent.exception){dataValues.push([this.exceptionKey,getExceptionStringRep(loggingEvent.exception)]);}
if(this.hasCustomFields()){for(var i=0,len=this.customFields.length;i<len;i++){var val=this.customFields[i].value;if(typeof val==="function"){val=val(this,loggingEvent);}
dataValues.push([this.customFields[i].name,val]);}}
return dataValues;},setKeys:function(loggerKey,timeStampKey,levelKey,messageKey,exceptionKey,urlKey,millisecondsKey){this.loggerKey=extractStringFromParam(loggerKey,this.defaults.loggerKey);this.timeStampKey=extractStringFromParam(timeStampKey,this.defaults.timeStampKey);this.levelKey=extractStringFromParam(levelKey,this.defaults.levelKey);this.messageKey=extractStringFromParam(messageKey,this.defaults.messageKey);this.exceptionKey=extractStringFromParam(exceptionKey,this.defaults.exceptionKey);this.urlKey=extractStringFromParam(urlKey,this.defaults.urlKey);this.millisecondsKey=extractStringFromParam(millisecondsKey,this.defaults.millisecondsKey);},setCustomField:function(name,value){var fieldUpdated=false;for(var i=0,len=this.customFields.length;i<len;i++){if(this.customFields[i].name===name){this.customFields[i].value=value;fieldUpdated=true;}}
if(!fieldUpdated){this.customFields.push({"name":name,"value":value});}},hasCustomFields:function(){return(this.customFields.length>0);},formatWithException:function(loggingEvent){var formatted=this.format(loggingEvent);if(loggingEvent.exception&&this.ignoresThrowable()){formatted+=loggingEvent.getThrowableStrRep();}
return formatted;},toString:function(){handleError("Layout.toString: all layouts must override this method");}};log4javascript.Layout=Layout;var Appender=function(){};Appender.prototype=new EventSupport();Appender.prototype.layout=new PatternLayout();Appender.prototype.threshold=Level.ALL;Appender.prototype.loggers=[];Appender.prototype.doAppend=function(loggingEvent){if(enabled&&loggingEvent.level.level>=this.threshold.level){this.append(loggingEvent);}};Appender.prototype.append=function(loggingEvent){};Appender.prototype.setLayout=function(layout){if(layout instanceof Layout){this.layout=layout;}else{handleError("Appender.setLayout: layout supplied to "+
this.toString()+" is not a subclass of Layout");}};Appender.prototype.getLayout=function(){return this.layout;};Appender.prototype.setThreshold=function(threshold){if(threshold instanceof Level){this.threshold=threshold;}else{handleError("Appender.setThreshold: threshold supplied to "+
this.toString()+" is not a subclass of Level");}};Appender.prototype.getThreshold=function(){return this.threshold;};Appender.prototype.setAddedToLogger=function(logger){this.loggers.push(logger);};Appender.prototype.setRemovedFromLogger=function(logger){array_remove(this.loggers,logger);};Appender.prototype.group=emptyFunction;Appender.prototype.groupEnd=emptyFunction;Appender.prototype.toString=function(){handleError("Appender.toString: all appenders must override this method");};log4javascript.Appender=Appender;function SimpleLayout(){this.customFields=[];}
SimpleLayout.prototype=new Layout();SimpleLayout.prototype.format=function(loggingEvent){return loggingEvent.level.name+" - "+loggingEvent.getCombinedMessages();};SimpleLayout.prototype.ignoresThrowable=function(){return true;};SimpleLayout.prototype.toString=function(){return"SimpleLayout";};log4javascript.SimpleLayout=SimpleLayout;function NullLayout(){this.customFields=[];}
NullLayout.prototype=new Layout();NullLayout.prototype.format=function(loggingEvent){return loggingEvent.messages;};NullLayout.prototype.ignoresThrowable=function(){return true;};NullLayout.prototype.formatWithException=function(loggingEvent){var messages=loggingEvent.messages,ex=loggingEvent.exception;return ex?messages.concat([ex]):messages;};NullLayout.prototype.toString=function(){return"NullLayout";};log4javascript.NullLayout=NullLayout;function XmlLayout(combineMessages){this.combineMessages=extractBooleanFromParam(combineMessages,true);this.customFields=[];}
XmlLayout.prototype=new Layout();XmlLayout.prototype.isCombinedMessages=function(){return this.combineMessages;};XmlLayout.prototype.getContentType=function(){return"text/xml";};XmlLayout.prototype.escapeCdata=function(str){return str.replace(/\]\]>/,"]]>]]&gt;<![CDATA[");};XmlLayout.prototype.format=function(loggingEvent){var layout=this;var i,len;function formatMessage(message){message=(typeof message==="string")?message:toStr(message);return"<log4javascript:message><![CDATA["+
layout.escapeCdata(message)+"]]></log4javascript:message>";}
var str="<log4javascript:event logger=\""+loggingEvent.logger.name+"\" timestamp=\""+this.getTimeStampValue(loggingEvent)+"\"";if(!this.isTimeStampsInMilliseconds()){str+=" milliseconds=\""+loggingEvent.milliseconds+"\"";}
str+=" level=\""+loggingEvent.level.name+"\">"+newLine;if(this.combineMessages){str+=formatMessage(loggingEvent.getCombinedMessages());}else{str+="<log4javascript:messages>"+newLine;for(i=0,len=loggingEvent.messages.length;i<len;i++){str+=formatMessage(loggingEvent.messages[i])+newLine;}
str+="</log4javascript:messages>"+newLine;}
if(this.hasCustomFields()){for(i=0,len=this.customFields.length;i<len;i++){str+="<log4javascript:customfield name=\""+
this.customFields[i].name+"\"><![CDATA["+
this.customFields[i].value.toString()+"]]></log4javascript:customfield>"+newLine;}}
if(loggingEvent.exception){str+="<log4javascript:exception><![CDATA["+
getExceptionStringRep(loggingEvent.exception)+"]]></log4javascript:exception>"+newLine;}
str+="</log4javascript:event>"+newLine+newLine;return str;};XmlLayout.prototype.ignoresThrowable=function(){return false;};XmlLayout.prototype.toString=function(){return"XmlLayout";};log4javascript.XmlLayout=XmlLayout;function escapeNewLines(str){return str.replace(/\r\n|\r|\n/g,"\\r\\n");}
function JsonLayout(readable,combineMessages){this.readable=extractBooleanFromParam(readable,false);this.combineMessages=extractBooleanFromParam(combineMessages,true);this.batchHeader=this.readable?"["+newLine:"[";this.batchFooter=this.readable?"]"+newLine:"]";this.batchSeparator=this.readable?","+newLine:",";this.setKeys();this.colon=this.readable?": ":":";this.tab=this.readable?"\t":"";this.lineBreak=this.readable?newLine:"";this.customFields=[];}
JsonLayout.prototype=new Layout();JsonLayout.prototype.isReadable=function(){return this.readable;};JsonLayout.prototype.isCombinedMessages=function(){return this.combineMessages;};JsonLayout.prototype.format=function(loggingEvent){var layout=this;var dataValues=this.getDataValues(loggingEvent,this.combineMessages);var str="{"+this.lineBreak;var i,len;function formatValue(val,prefix,expand){var formattedValue;var valType=typeof val;if(val instanceof Date){formattedValue=String(val.getTime());}else if(expand&&(val instanceof Array)){formattedValue="["+layout.lineBreak;for(var i=0,len=val.length;i<len;i++){var childPrefix=prefix+layout.tab;formattedValue+=childPrefix+formatValue(val[i],childPrefix,false);if(i<val.length-1){formattedValue+=",";}
formattedValue+=layout.lineBreak;}
formattedValue+=prefix+"]";}else if(valType!=="number"&&valType!=="boolean"){formattedValue="\""+escapeNewLines(toStr(val).replace(/\"/g,"\\\""))+"\"";}else{formattedValue=val;}
return formattedValue;}
for(i=0,len=dataValues.length-1;i<=len;i++){str+=this.tab+"\""+dataValues[i][0]+"\""+this.colon+formatValue(dataValues[i][1],this.tab,true);if(i<len){str+=",";}
str+=this.lineBreak;}
str+="}"+this.lineBreak;return str;};JsonLayout.prototype.ignoresThrowable=function(){return false;};JsonLayout.prototype.toString=function(){return"JsonLayout";};JsonLayout.prototype.getContentType=function(){return"application/json";};log4javascript.JsonLayout=JsonLayout;function HttpPostDataLayout(){this.setKeys();this.customFields=[];this.returnsPostData=true;}
HttpPostDataLayout.prototype=new Layout();HttpPostDataLayout.prototype.allowBatching=function(){return false;};HttpPostDataLayout.prototype.format=function(loggingEvent){var dataValues=this.getDataValues(loggingEvent);var queryBits=[];for(var i=0,len=dataValues.length;i<len;i++){var val=(dataValues[i][1]instanceof Date)?String(dataValues[i][1].getTime()):dataValues[i][1];queryBits.push(urlEncode(dataValues[i][0])+"="+urlEncode(val));}
return queryBits.join("&");};HttpPostDataLayout.prototype.ignoresThrowable=function(loggingEvent){return false;};HttpPostDataLayout.prototype.toString=function(){return"HttpPostDataLayout";};log4javascript.HttpPostDataLayout=HttpPostDataLayout;function formatObjectExpansion(obj,depth,indentation){var objectsExpanded=[];function doFormat(obj,depth,indentation){var i,len,childDepth,childIndentation,childLines,expansion,childExpansion;if(!indentation){indentation="";}
function formatString(text){var lines=splitIntoLines(text);for(var j=1,jLen=lines.length;j<jLen;j++){lines[j]=indentation+lines[j];}
return lines.join(newLine);}
if(obj===null){return"null";}else if(typeof obj=="undefined"){return"undefined";}else if(typeof obj=="string"){return formatString(obj);}else if(typeof obj=="object"&&array_contains(objectsExpanded,obj)){try{expansion=toStr(obj);}catch(ex){expansion="Error formatting property. Details: "+getExceptionStringRep(ex);}
return expansion+" [already expanded]";}else if((obj instanceof Array)&&depth>0){objectsExpanded.push(obj);expansion="["+newLine;childDepth=depth-1;childIndentation=indentation+"  ";childLines=[];for(i=0,len=obj.length;i<len;i++){try{childExpansion=doFormat(obj[i],childDepth,childIndentation);childLines.push(childIndentation+childExpansion);}catch(ex){childLines.push(childIndentation+"Error formatting array member. Details: "+
getExceptionStringRep(ex)+"");}}
expansion+=childLines.join(","+newLine)+newLine+indentation+"]";return expansion;}else if(Object.prototype.toString.call(obj)=="[object Date]"){return obj.toString();}else if(typeof obj=="object"&&depth>0){objectsExpanded.push(obj);expansion="{"+newLine;childDepth=depth-1;childIndentation=indentation+"  ";childLines=[];for(i in obj){try{childExpansion=doFormat(obj[i],childDepth,childIndentation);childLines.push(childIndentation+i+": "+childExpansion);}catch(ex){childLines.push(childIndentation+i+": Error formatting property. Details: "+
getExceptionStringRep(ex));}}
expansion+=childLines.join(","+newLine)+newLine+indentation+"}";return expansion;}else{return formatString(toStr(obj));}}
return doFormat(obj,depth,indentation);}
var SimpleDateFormat;(function(){var regex=/('[^']*')|(G+|y+|M+|w+|W+|D+|d+|F+|E+|a+|H+|k+|K+|h+|m+|s+|S+|Z+)|([a-zA-Z]+)|([^a-zA-Z']+)/;var monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];var dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];var TEXT2=0,TEXT3=1,NUMBER=2,YEAR=3,MONTH=4,TIMEZONE=5;var types={G:TEXT2,y:YEAR,M:MONTH,w:NUMBER,W:NUMBER,D:NUMBER,d:NUMBER,F:NUMBER,E:TEXT3,a:TEXT2,H:NUMBER,k:NUMBER,K:NUMBER,h:NUMBER,m:NUMBER,s:NUMBER,S:NUMBER,Z:TIMEZONE};var ONE_DAY=24*60*60*1000;var ONE_WEEK=7*ONE_DAY;var DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK=1;var newDateAtMidnight=function(year,month,day){var d=new Date(year,month,day,0,0,0);d.setMilliseconds(0);return d;};Date.prototype.getDifference=function(date){return this.getTime()-date.getTime();};Date.prototype.isBefore=function(d){return this.getTime()<d.getTime();};Date.prototype.getUTCTime=function(){return Date.UTC(this.getFullYear(),this.getMonth(),this.getDate(),this.getHours(),this.getMinutes(),this.getSeconds(),this.getMilliseconds());};Date.prototype.getTimeSince=function(d){return this.getUTCTime()-d.getUTCTime();};Date.prototype.getPreviousSunday=function(){var midday=new Date(this.getFullYear(),this.getMonth(),this.getDate(),12,0,0);var previousSunday=new Date(midday.getTime()-this.getDay()*ONE_DAY);return newDateAtMidnight(previousSunday.getFullYear(),previousSunday.getMonth(),previousSunday.getDate());};Date.prototype.getWeekInYear=function(minimalDaysInFirstWeek){if(isUndefined(this.minimalDaysInFirstWeek)){minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK;}
var previousSunday=this.getPreviousSunday();var startOfYear=newDateAtMidnight(this.getFullYear(),0,1);var numberOfSundays=previousSunday.isBefore(startOfYear)?0:1+Math.floor(previousSunday.getTimeSince(startOfYear)/ONE_WEEK);var numberOfDaysInFirstWeek=7-startOfYear.getDay();var weekInYear=numberOfSundays;if(numberOfDaysInFirstWeek<minimalDaysInFirstWeek){weekInYear--;}
return weekInYear;};Date.prototype.getWeekInMonth=function(minimalDaysInFirstWeek){if(isUndefined(this.minimalDaysInFirstWeek)){minimalDaysInFirstWeek=DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK;}
var previousSunday=this.getPreviousSunday();var startOfMonth=newDateAtMidnight(this.getFullYear(),this.getMonth(),1);var numberOfSundays=previousSunday.isBefore(startOfMonth)?0:1+Math.floor(previousSunday.getTimeSince(startOfMonth)/ONE_WEEK);var numberOfDaysInFirstWeek=7-startOfMonth.getDay();var weekInMonth=numberOfSundays;if(numberOfDaysInFirstWeek>=minimalDaysInFirstWeek){weekInMonth++;}
return weekInMonth;};Date.prototype.getDayInYear=function(){var startOfYear=newDateAtMidnight(this.getFullYear(),0,1);return 1+Math.floor(this.getTimeSince(startOfYear)/ONE_DAY);};SimpleDateFormat=function(formatString){this.formatString=formatString;};SimpleDateFormat.prototype.setMinimalDaysInFirstWeek=function(days){this.minimalDaysInFirstWeek=days;};SimpleDateFormat.prototype.getMinimalDaysInFirstWeek=function(){return isUndefined(this.minimalDaysInFirstWeek)?DEFAULT_MINIMAL_DAYS_IN_FIRST_WEEK:this.minimalDaysInFirstWeek;};var padWithZeroes=function(str,len){while(str.length<len){str="0"+str;}
return str;};var formatText=function(data,numberOfLetters,minLength){return(numberOfLetters>=4)?data:data.substr(0,Math.max(minLength,numberOfLetters));};var formatNumber=function(data,numberOfLetters){var dataString=""+data;return padWithZeroes(dataString,numberOfLetters);};SimpleDateFormat.prototype.format=function(date){var formattedString="";var result;var searchString=this.formatString;while((result=regex.exec(searchString))){var quotedString=result[1];var patternLetters=result[2];var otherLetters=result[3];var otherCharacters=result[4];if(quotedString){if(quotedString=="''"){formattedString+="'";}else{formattedString+=quotedString.substring(1,quotedString.length-1);}}else if(otherLetters){}else if(otherCharacters){formattedString+=otherCharacters;}else if(patternLetters){var patternLetter=patternLetters.charAt(0);var numberOfLetters=patternLetters.length;var rawData="";switch(patternLetter){case"G":rawData="AD";break;case"y":rawData=date.getFullYear();break;case"M":rawData=date.getMonth();break;case"w":rawData=date.getWeekInYear(this.getMinimalDaysInFirstWeek());break;case"W":rawData=date.getWeekInMonth(this.getMinimalDaysInFirstWeek());break;case"D":rawData=date.getDayInYear();break;case"d":rawData=date.getDate();break;case"F":rawData=1+Math.floor((date.getDate()-1)/7);break;case"E":rawData=dayNames[date.getDay()];break;case"a":rawData=(date.getHours()>=12)?"PM":"AM";break;case"H":rawData=date.getHours();break;case"k":rawData=date.getHours()||24;break;case"K":rawData=date.getHours()%12;break;case"h":rawData=(date.getHours()%12)||12;break;case"m":rawData=date.getMinutes();break;case"s":rawData=date.getSeconds();break;case"S":rawData=date.getMilliseconds();break;case"Z":rawData=date.getTimezoneOffset();break;}
switch(types[patternLetter]){case TEXT2:formattedString+=formatText(rawData,numberOfLetters,2);break;case TEXT3:formattedString+=formatText(rawData,numberOfLetters,3);break;case NUMBER:formattedString+=formatNumber(rawData,numberOfLetters);break;case YEAR:if(numberOfLetters<=3){var dataString=""+rawData;formattedString+=dataString.substr(2,2);}else{formattedString+=formatNumber(rawData,numberOfLetters);}
break;case MONTH:if(numberOfLetters>=3){formattedString+=formatText(monthNames[rawData],numberOfLetters,numberOfLetters);}else{formattedString+=formatNumber(rawData+1,numberOfLetters);}
break;case TIMEZONE:var isPositive=(rawData>0);var prefix=isPositive?"-":"+";var absData=Math.abs(rawData);var hours=""+Math.floor(absData/60);hours=padWithZeroes(hours,2);var minutes=""+(absData%60);minutes=padWithZeroes(minutes,2);formattedString+=prefix+hours+minutes;break;}}
searchString=searchString.substr(result.index+result[0].length);}
return formattedString;};})();log4javascript.SimpleDateFormat=SimpleDateFormat;function PatternLayout(pattern){if(pattern){this.pattern=pattern;}else{this.pattern=PatternLayout.DEFAULT_CONVERSION_PATTERN;}
this.customFields=[];}
PatternLayout.TTCC_CONVERSION_PATTERN="%r %p %c - %m%n";PatternLayout.DEFAULT_CONVERSION_PATTERN="%m%n";PatternLayout.ISO8601_DATEFORMAT="yyyy-MM-dd HH:mm:ss,SSS";PatternLayout.DATETIME_DATEFORMAT="dd MMM yyyy HH:mm:ss,SSS";PatternLayout.ABSOLUTETIME_DATEFORMAT="HH:mm:ss,SSS";PatternLayout.prototype=new Layout();PatternLayout.prototype.format=function(loggingEvent){var regex=/%(-?[0-9]+)?(\.?[0-9]+)?([acdfmMnpr%])(\{([^\}]+)\})?|([^%]+)/;var formattedString="";var result;var searchString=this.pattern;while((result=regex.exec(searchString))){var matchedString=result[0];var padding=result[1];var truncation=result[2];var conversionCharacter=result[3];var specifier=result[5];var text=result[6];if(text){formattedString+=""+text;}else{var replacement="";switch(conversionCharacter){case"a":case"m":var depth=0;if(specifier){depth=parseInt(specifier,10);if(isNaN(depth)){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character '"+conversionCharacter+"' - should be a number");depth=0;}}
var messages=(conversionCharacter==="a")?loggingEvent.messages[0]:loggingEvent.messages;for(var i=0,len=messages.length;i<len;i++){if(i>0&&(replacement.charAt(replacement.length-1)!==" ")){replacement+=" ";}
if(depth===0){replacement+=messages[i];}else{replacement+=formatObjectExpansion(messages[i],depth);}}
break;case"c":var loggerName=loggingEvent.logger.name;if(specifier){var precision=parseInt(specifier,10);var loggerNameBits=loggingEvent.logger.name.split(".");if(precision>=loggerNameBits.length){replacement=loggerName;}else{replacement=loggerNameBits.slice(loggerNameBits.length-precision).join(".");}}else{replacement=loggerName;}
break;case"d":var dateFormat=PatternLayout.ISO8601_DATEFORMAT;if(specifier){dateFormat=specifier;if(dateFormat=="ISO8601"){dateFormat=PatternLayout.ISO8601_DATEFORMAT;}else if(dateFormat=="ABSOLUTE"){dateFormat=PatternLayout.ABSOLUTETIME_DATEFORMAT;}else if(dateFormat=="DATE"){dateFormat=PatternLayout.DATETIME_DATEFORMAT;}}
replacement=(new SimpleDateFormat(dateFormat)).format(loggingEvent.timeStamp);break;case"f":if(this.hasCustomFields()){var fieldIndex=0;if(specifier){fieldIndex=parseInt(specifier,10);if(isNaN(fieldIndex)){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - should be a number");}else if(fieldIndex===0){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - must be greater than zero");}else if(fieldIndex>this.customFields.length){handleError("PatternLayout.format: invalid specifier '"+
specifier+"' for conversion character 'f' - there aren't that many custom fields");}else{fieldIndex=fieldIndex-1;}}
var val=this.customFields[fieldIndex].value;if(typeof val=="function"){val=val(this,loggingEvent);}
replacement=val;}
break;case"n":replacement=newLine;break;case"p":replacement=loggingEvent.level.name;break;case"r":replacement=""+loggingEvent.timeStamp.getDifference(applicationStartDate);break;case"%":replacement="%";break;default:replacement=matchedString;break;}
var l;if(truncation){l=parseInt(truncation.substr(1),10);var strLen=replacement.length;if(l<strLen){replacement=replacement.substring(strLen-l,strLen);}}
if(padding){if(padding.charAt(0)=="-"){l=parseInt(padding.substr(1),10);while(replacement.length<l){replacement+=" ";}}else{l=parseInt(padding,10);while(replacement.length<l){replacement=" "+replacement;}}}
formattedString+=replacement;}
searchString=searchString.substr(result.index+result[0].length);}
return formattedString;};PatternLayout.prototype.ignoresThrowable=function(){return true;};PatternLayout.prototype.toString=function(){return"PatternLayout";};log4javascript.PatternLayout=PatternLayout;function AlertAppender(){}
AlertAppender.prototype=new Appender();AlertAppender.prototype.layout=new SimpleLayout();AlertAppender.prototype.append=function(loggingEvent){alert(this.getLayout().formatWithException(loggingEvent));};AlertAppender.prototype.toString=function(){return"AlertAppender";};log4javascript.AlertAppender=AlertAppender;function BrowserConsoleAppender(){}
BrowserConsoleAppender.prototype=new log4javascript.Appender();BrowserConsoleAppender.prototype.layout=new NullLayout();BrowserConsoleAppender.prototype.threshold=Level.DEBUG;BrowserConsoleAppender.prototype.append=function(loggingEvent){var appender=this;var getFormattedMessage=function(concatenate){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);return(typeof formattedMessage=="string")?(concatenate?formattedMessage:[formattedMessage]):(concatenate?formattedMessage.join(" "):formattedMessage);};var console=window.console;if(console&&console.log){var consoleMethodName;if(console.debug&&Level.DEBUG.isGreaterOrEqual(loggingEvent.level)){consoleMethodName="debug";}else if(console.info&&Level.INFO.equals(loggingEvent.level)){consoleMethodName="info";}else if(console.warn&&Level.WARN.equals(loggingEvent.level)){consoleMethodName="warn";}else if(console.error&&loggingEvent.level.isGreaterOrEqual(Level.ERROR)){consoleMethodName="error";}else{consoleMethodName="log";}
if(typeof console[consoleMethodName].apply=="function"){console[consoleMethodName].apply(console,getFormattedMessage(false));}else{console[consoleMethodName](getFormattedMessage(true));}}else if((typeof opera!="undefined")&&opera.postError){opera.postError(getFormattedMessage(true));}};BrowserConsoleAppender.prototype.group=function(name){if(window.console&&window.console.group){window.console.group(name);}};BrowserConsoleAppender.prototype.groupEnd=function(){if(window.console&&window.console.groupEnd){window.console.groupEnd();}};BrowserConsoleAppender.prototype.toString=function(){return"BrowserConsoleAppender";};log4javascript.BrowserConsoleAppender=BrowserConsoleAppender;var xhrFactory=function(){return new XMLHttpRequest();};var xmlHttpFactories=[xhrFactory,function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}];var withCredentialsSupported=false;var getXmlHttp=function(errorHandler){var xmlHttp=null,factory;for(var i=0,len=xmlHttpFactories.length;i<len;i++){factory=xmlHttpFactories[i];try{xmlHttp=factory();withCredentialsSupported=(factory==xhrFactory&&("withCredentials"in xmlHttp));getXmlHttp=factory;return xmlHttp;}catch(e){}}
if(errorHandler){errorHandler();}else{handleError("getXmlHttp: unable to obtain XMLHttpRequest object");}};function isHttpRequestSuccessful(xmlHttp){return isUndefined(xmlHttp.status)||xmlHttp.status===0||(xmlHttp.status>=200&&xmlHttp.status<300)||xmlHttp.status==1223;}
function AjaxAppender(url,withCredentials){var appender=this;var isSupported=true;if(!url){handleError("AjaxAppender: URL must be specified in constructor");isSupported=false;}
var timed=this.defaults.timed;var waitForResponse=this.defaults.waitForResponse;var batchSize=this.defaults.batchSize;var timerInterval=this.defaults.timerInterval;var requestSuccessCallback=this.defaults.requestSuccessCallback;var failCallback=this.defaults.failCallback;var postVarName=this.defaults.postVarName;var sendAllOnUnload=this.defaults.sendAllOnUnload;var contentType=this.defaults.contentType;var sessionId=null;var queuedLoggingEvents=[];var queuedRequests=[];var headers=[];var sending=false;var initialized=false;function checkCanConfigure(configOptionName){if(initialized){handleError("AjaxAppender: configuration option '"+
configOptionName+"' may not be set after the appender has been initialized");return false;}
return true;}
this.getSessionId=function(){return sessionId;};this.setSessionId=function(sessionIdParam){sessionId=extractStringFromParam(sessionIdParam,null);this.layout.setCustomField("sessionid",sessionId);};this.setLayout=function(layoutParam){if(checkCanConfigure("layout")){this.layout=layoutParam;if(sessionId!==null){this.setSessionId(sessionId);}}};this.isTimed=function(){return timed;};this.setTimed=function(timedParam){if(checkCanConfigure("timed")){timed=bool(timedParam);}};this.getTimerInterval=function(){return timerInterval;};this.setTimerInterval=function(timerIntervalParam){if(checkCanConfigure("timerInterval")){timerInterval=extractIntFromParam(timerIntervalParam,timerInterval);}};this.isWaitForResponse=function(){return waitForResponse;};this.setWaitForResponse=function(waitForResponseParam){if(checkCanConfigure("waitForResponse")){waitForResponse=bool(waitForResponseParam);}};this.getBatchSize=function(){return batchSize;};this.setBatchSize=function(batchSizeParam){if(checkCanConfigure("batchSize")){batchSize=extractIntFromParam(batchSizeParam,batchSize);}};this.isSendAllOnUnload=function(){return sendAllOnUnload;};this.setSendAllOnUnload=function(sendAllOnUnloadParam){if(checkCanConfigure("sendAllOnUnload")){sendAllOnUnload=extractBooleanFromParam(sendAllOnUnloadParam,sendAllOnUnload);}};this.setRequestSuccessCallback=function(requestSuccessCallbackParam){requestSuccessCallback=extractFunctionFromParam(requestSuccessCallbackParam,requestSuccessCallback);};this.setFailCallback=function(failCallbackParam){failCallback=extractFunctionFromParam(failCallbackParam,failCallback);};this.getPostVarName=function(){return postVarName;};this.setPostVarName=function(postVarNameParam){if(checkCanConfigure("postVarName")){postVarName=extractStringFromParam(postVarNameParam,postVarName);}};this.getHeaders=function(){return headers;};this.addHeader=function(name,value){if(name.toLowerCase()=="content-type"){contentType=value;}else{headers.push({name:name,value:value});}};function sendAll(){if(isSupported&&enabled){sending=true;var currentRequestBatch;if(waitForResponse){if(queuedRequests.length>0){currentRequestBatch=queuedRequests.shift();sendRequest(preparePostData(currentRequestBatch),sendAll);}else{sending=false;if(timed){scheduleSending();}}}else{while((currentRequestBatch=queuedRequests.shift())){sendRequest(preparePostData(currentRequestBatch));}
sending=false;if(timed){scheduleSending();}}}}
this.sendAll=sendAll;function sendAllRemaining(){var sendingAnything=false;if(isSupported&&enabled){var actualBatchSize=appender.getLayout().allowBatching()?batchSize:1;var currentLoggingEvent;var batchedLoggingEvents=[];while((currentLoggingEvent=queuedLoggingEvents.shift())){batchedLoggingEvents.push(currentLoggingEvent);if(queuedLoggingEvents.length>=actualBatchSize){queuedRequests.push(batchedLoggingEvents);batchedLoggingEvents=[];}}
if(batchedLoggingEvents.length>0){queuedRequests.push(batchedLoggingEvents);}
sendingAnything=(queuedRequests.length>0);waitForResponse=false;timed=false;sendAll();}
return sendingAnything;}
this.sendAllRemaining=sendAllRemaining;function preparePostData(batchedLoggingEvents){var formattedMessages=[];var currentLoggingEvent;var postData="";while((currentLoggingEvent=batchedLoggingEvents.shift())){formattedMessages.push(appender.getLayout().formatWithException(currentLoggingEvent));}
if(batchedLoggingEvents.length==1){postData=formattedMessages.join("");}else{postData=appender.getLayout().batchHeader+
formattedMessages.join(appender.getLayout().batchSeparator)+
appender.getLayout().batchFooter;}
if(contentType==appender.defaults.contentType){postData=appender.getLayout().returnsPostData?postData:urlEncode(postVarName)+"="+urlEncode(postData);if(postData.length>0){postData+="&";}
postData+="layout="+urlEncode(appender.getLayout().toString());}
return postData;}
function scheduleSending(){window.setTimeout(sendAll,timerInterval);}
function xmlHttpErrorHandler(){var msg="AjaxAppender: could not create XMLHttpRequest object. AjaxAppender disabled";handleError(msg);isSupported=false;if(failCallback){failCallback(msg);}}
function sendRequest(postData,successCallback){try{var xmlHttp=getXmlHttp(xmlHttpErrorHandler);if(isSupported){xmlHttp.onreadystatechange=function(){if(xmlHttp.readyState==4){if(isHttpRequestSuccessful(xmlHttp)){if(requestSuccessCallback){requestSuccessCallback(xmlHttp);}
if(successCallback){successCallback(xmlHttp);}}else{var msg="AjaxAppender.append: XMLHttpRequest request to URL "+
url+" returned status code "+xmlHttp.status;handleError(msg);if(failCallback){failCallback(msg);}}
xmlHttp.onreadystatechange=emptyFunction;xmlHttp=null;}};xmlHttp.open("POST",url,true);if(withCredentials&&withCredentialsSupported){xmlHttp.withCredentials=true;}
try{for(var i=0,header;header=headers[i++];){xmlHttp.setRequestHeader(header.name,header.value);}
xmlHttp.setRequestHeader("Content-Type",contentType);}catch(headerEx){var msg="AjaxAppender.append: your browser's XMLHttpRequest implementation"+" does not support setRequestHeader, therefore cannot post data. AjaxAppender disabled";handleError(msg);isSupported=false;if(failCallback){failCallback(msg);}
return;}
xmlHttp.send(postData);}}catch(ex){var errMsg="AjaxAppender.append: error sending log message to "+url;handleError(errMsg,ex);isSupported=false;if(failCallback){failCallback(errMsg+". Details: "+getExceptionStringRep(ex));}}}
this.append=function(loggingEvent){if(isSupported){if(!initialized){init();}
queuedLoggingEvents.push(loggingEvent);var actualBatchSize=this.getLayout().allowBatching()?batchSize:1;if(queuedLoggingEvents.length>=actualBatchSize){var currentLoggingEvent;var batchedLoggingEvents=[];while((currentLoggingEvent=queuedLoggingEvents.shift())){batchedLoggingEvents.push(currentLoggingEvent);}
queuedRequests.push(batchedLoggingEvents);if(!timed&&(!waitForResponse||(waitForResponse&&!sending))){sendAll();}}}};function init(){initialized=true;if(sendAllOnUnload){var oldBeforeUnload=window.onbeforeunload;window.onbeforeunload=function(){if(oldBeforeUnload){oldBeforeUnload();}
sendAllRemaining();};}
if(timed){scheduleSending();}}}
AjaxAppender.prototype=new Appender();AjaxAppender.prototype.defaults={waitForResponse:false,timed:false,timerInterval:1000,batchSize:1,sendAllOnUnload:false,requestSuccessCallback:null,failCallback:null,postVarName:"data",contentType:"application/x-www-form-urlencoded"};AjaxAppender.prototype.layout=new HttpPostDataLayout();AjaxAppender.prototype.toString=function(){return"AjaxAppender";};log4javascript.AjaxAppender=AjaxAppender;function setCookie(name,value,days,path){var expires;path=path?"; path="+path:"";if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));expires="; expires="+date.toGMTString();}else{expires="";}
document.cookie=escape(name)+"="+escape(value)+expires+path;}
function getCookie(name){var nameEquals=escape(name)+"=";var ca=document.cookie.split(";");for(var i=0,len=ca.length;i<len;i++){var c=ca[i];while(c.charAt(0)===" "){c=c.substring(1,c.length);}
if(c.indexOf(nameEquals)===0){return unescape(c.substring(nameEquals.length,c.length));}}
return null;}
function getBaseUrl(){var scripts=document.getElementsByTagName("script");for(var i=0,len=scripts.length;i<len;++i){if(scripts[i].src.indexOf("log4javascript")!=-1){var lastSlash=scripts[i].src.lastIndexOf("/");return(lastSlash==-1)?"":scripts[i].src.substr(0,lastSlash+1);}}
return null;}
function isLoaded(win){try{return bool(win.loaded);}catch(ex){return false;}}
var ConsoleAppender;(function(){var getConsoleHtmlLines=function(){return['<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">','<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">','<head>','<title>log4javascript</title>','<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />','<!-- Make IE8 behave like IE7, having gone to all the trouble of making IE work -->','<meta http-equiv="X-UA-Compatible" content="IE=7" />','<script type="text/javascript">var isIe = false, isIePre7 = false;</script>','<!--[if IE]><script type="text/javascript">isIe = true</script><![endif]-->','<!--[if lt IE 7]><script type="text/javascript">isIePre7 = true</script><![endif]-->','<script type="text/javascript">','//<![CDATA[','var loggingEnabled=true;var logQueuedEventsTimer=null;var logEntries=[];var logEntriesAndSeparators=[];var logItems=[];var renderDelay=100;var unrenderedLogItemsExist=false;var rootGroup,currentGroup=null;var loaded=false;var currentLogItem=null;var logMainContainer;function copyProperties(obj,props){for(var i in props){obj[i]=props[i];}}','function LogItem(){}','LogItem.prototype={mainContainer:null,wrappedContainer:null,unwrappedContainer:null,group:null,appendToLog:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].appendToLog();}','this.group.update();},doRemove:function(doUpdate,removeFromGroup){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].remove();}','this.unwrappedElementContainer=null;this.wrappedElementContainer=null;this.mainElementContainer=null;}','if(this.group&&removeFromGroup){this.group.removeChild(this,doUpdate);}','if(this===currentLogItem){currentLogItem=null;}},remove:function(doUpdate,removeFromGroup){this.doRemove(doUpdate,removeFromGroup);},render:function(){},accept:function(visitor){visitor.visit(this);},getUnwrappedDomContainer:function(){return this.group.unwrappedElementContainer.contentDiv;},getWrappedDomContainer:function(){return this.group.wrappedElementContainer.contentDiv;},getMainDomContainer:function(){return this.group.mainElementContainer.contentDiv;}};LogItem.serializedItemKeys={LOG_ENTRY:0,GROUP_START:1,GROUP_END:2};function LogItemContainerElement(){}','LogItemContainerElement.prototype={appendToLog:function(){var insertBeforeFirst=(newestAtTop&&this.containerDomNode.hasChildNodes());if(insertBeforeFirst){this.containerDomNode.insertBefore(this.mainDiv,this.containerDomNode.firstChild);}else{this.containerDomNode.appendChild(this.mainDiv);}}};function SeparatorElementContainer(containerDomNode){this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="separator";this.mainDiv.innerHTML="&nbsp;";}','SeparatorElementContainer.prototype=new LogItemContainerElement();SeparatorElementContainer.prototype.remove=function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;};function Separator(){this.rendered=false;}','Separator.prototype=new LogItem();copyProperties(Separator.prototype,{render:function(){var containerDomNode=this.group.contentDiv;if(isIe){this.unwrappedElementContainer=new SeparatorElementContainer(this.getUnwrappedDomContainer());this.wrappedElementContainer=new SeparatorElementContainer(this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new SeparatorElementContainer(this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;}});function GroupElementContainer(group,containerDomNode,isRoot,isWrapped){this.group=group;this.containerDomNode=containerDomNode;this.isRoot=isRoot;this.isWrapped=isWrapped;this.expandable=false;if(this.isRoot){if(isIe){this.contentDiv=logMainContainer.appendChild(document.createElement("div"));this.contentDiv.id=this.isWrapped?"log_wrapped":"log_unwrapped";}else{this.contentDiv=logMainContainer;}}else{var groupElementContainer=this;this.mainDiv=document.createElement("div");this.mainDiv.className="group";this.headingDiv=this.mainDiv.appendChild(document.createElement("div"));this.headingDiv.className="groupheading";this.expander=this.headingDiv.appendChild(document.createElement("span"));this.expander.className="expander unselectable greyedout";this.expander.unselectable=true;var expanderText=this.group.expanded?"-":"+";this.expanderTextNode=this.expander.appendChild(document.createTextNode(expanderText));this.headingDiv.appendChild(document.createTextNode(" "+this.group.name));this.contentDiv=this.mainDiv.appendChild(document.createElement("div"));var contentCssClass=this.group.expanded?"expanded":"collapsed";this.contentDiv.className="groupcontent "+contentCssClass;this.expander.onclick=function(){if(groupElementContainer.group.expandable){groupElementContainer.group.toggleExpanded();}};}}','GroupElementContainer.prototype=new LogItemContainerElement();copyProperties(GroupElementContainer.prototype,{toggleExpanded:function(){if(!this.isRoot){var oldCssClass,newCssClass,expanderText;if(this.group.expanded){newCssClass="expanded";oldCssClass="collapsed";expanderText="-";}else{newCssClass="collapsed";oldCssClass="expanded";expanderText="+";}','replaceClass(this.contentDiv,newCssClass,oldCssClass);this.expanderTextNode.nodeValue=expanderText;}},remove:function(){if(!this.isRoot){this.headingDiv=null;this.expander.onclick=null;this.expander=null;this.expanderTextNode=null;this.contentDiv=null;this.containerDomNode=null;this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;}},reverseChildren:function(){var node=null;var childDomNodes=[];while((node=this.contentDiv.firstChild)){this.contentDiv.removeChild(node);childDomNodes.push(node);}','while((node=childDomNodes.pop())){this.contentDiv.appendChild(node);}},update:function(){if(!this.isRoot){if(this.group.expandable){removeClass(this.expander,"greyedout");}else{addClass(this.expander,"greyedout");}}},clear:function(){if(this.isRoot){this.contentDiv.innerHTML="";}}});function Group(name,isRoot,initiallyExpanded){this.name=name;this.group=null;this.isRoot=isRoot;this.initiallyExpanded=initiallyExpanded;this.elementContainers=[];this.children=[];this.expanded=initiallyExpanded;this.rendered=false;this.expandable=false;}','Group.prototype=new LogItem();copyProperties(Group.prototype,{addChild:function(logItem){this.children.push(logItem);logItem.group=this;},render:function(){if(isIe){var unwrappedDomContainer,wrappedDomContainer;if(this.isRoot){unwrappedDomContainer=logMainContainer;wrappedDomContainer=logMainContainer;}else{unwrappedDomContainer=this.getUnwrappedDomContainer();wrappedDomContainer=this.getWrappedDomContainer();}','this.unwrappedElementContainer=new GroupElementContainer(this,unwrappedDomContainer,this.isRoot,false);this.wrappedElementContainer=new GroupElementContainer(this,wrappedDomContainer,this.isRoot,true);this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{var mainDomContainer=this.isRoot?logMainContainer:this.getMainDomContainer();this.mainElementContainer=new GroupElementContainer(this,mainDomContainer,this.isRoot,false);this.elementContainers=[this.mainElementContainer];}','this.rendered=true;},toggleExpanded:function(){this.expanded=!this.expanded;for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].toggleExpanded();}},expand:function(){if(!this.expanded){this.toggleExpanded();}},accept:function(visitor){visitor.visitGroup(this);},reverseChildren:function(){if(this.rendered){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].reverseChildren();}}},update:function(){var previouslyExpandable=this.expandable;this.expandable=(this.children.length!==0);if(this.expandable!==previouslyExpandable){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].update();}}},flatten:function(){var visitor=new GroupFlattener();this.accept(visitor);return visitor.logEntriesAndSeparators;},removeChild:function(child,doUpdate){array_remove(this.children,child);child.group=null;if(doUpdate){this.update();}},remove:function(doUpdate,removeFromGroup){for(var i=0,len=this.children.length;i<len;i++){this.children[i].remove(false,false);}','this.children=[];this.update();if(this===currentGroup){currentGroup=this.group;}','this.doRemove(doUpdate,removeFromGroup);},serialize:function(items){items.push([LogItem.serializedItemKeys.GROUP_START,this.name]);for(var i=0,len=this.children.length;i<len;i++){this.children[i].serialize(items);}','if(this!==currentGroup){items.push([LogItem.serializedItemKeys.GROUP_END]);}},clear:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clear();}}});function LogEntryElementContainer(){}','LogEntryElementContainer.prototype=new LogItemContainerElement();copyProperties(LogEntryElementContainer.prototype,{remove:function(){this.doRemove();},doRemove:function(){this.mainDiv.parentNode.removeChild(this.mainDiv);this.mainDiv=null;this.contentElement=null;this.containerDomNode=null;},setContent:function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=content;}},setSearchMatch:function(isMatch){var oldCssClass=isMatch?"searchnonmatch":"searchmatch";var newCssClass=isMatch?"searchmatch":"searchnonmatch";replaceClass(this.mainDiv,newCssClass,oldCssClass);},clearSearch:function(){removeClass(this.mainDiv,"searchmatch");removeClass(this.mainDiv,"searchnonmatch");}});function LogEntryWrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.mainDiv.className="logentry wrapped "+this.logEntry.level;this.contentElement=this.mainDiv;}','LogEntryWrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryWrappedElementContainer.prototype.setContent=function(content,wrappedContent){if(content===this.formattedMessage){this.contentElement.innerHTML="";this.contentElement.appendChild(document.createTextNode(this.formattedMessage));}else{this.contentElement.innerHTML=wrappedContent;}};function LogEntryUnwrappedElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry unwrapped "+this.logEntry.level;this.pre=this.mainDiv.appendChild(document.createElement("pre"));this.pre.appendChild(document.createTextNode(this.logEntry.formattedMessage));this.pre.className="unwrapped";this.contentElement=this.pre;}','LogEntryUnwrappedElementContainer.prototype=new LogEntryElementContainer();LogEntryUnwrappedElementContainer.prototype.remove=function(){this.doRemove();this.pre=null;};function LogEntryMainElementContainer(logEntry,containerDomNode){this.logEntry=logEntry;this.containerDomNode=containerDomNode;this.mainDiv=document.createElement("div");this.mainDiv.className="logentry nonielogentry "+this.logEntry.level;this.contentElement=this.mainDiv.appendChild(document.createElement("span"));this.contentElement.appendChild(document.createTextNode(this.logEntry.formattedMessage));}','LogEntryMainElementContainer.prototype=new LogEntryElementContainer();function LogEntry(level,formattedMessage){this.level=level;this.formattedMessage=formattedMessage;this.rendered=false;}','LogEntry.prototype=new LogItem();copyProperties(LogEntry.prototype,{render:function(){var logEntry=this;var containerDomNode=this.group.contentDiv;if(isIe){this.formattedMessage=this.formattedMessage.replace(/\\r\\n/g,"\\r");this.unwrappedElementContainer=new LogEntryUnwrappedElementContainer(this,this.getUnwrappedDomContainer());this.wrappedElementContainer=new LogEntryWrappedElementContainer(this,this.getWrappedDomContainer());this.elementContainers=[this.unwrappedElementContainer,this.wrappedElementContainer];}else{this.mainElementContainer=new LogEntryMainElementContainer(this,this.getMainDomContainer());this.elementContainers=[this.mainElementContainer];}','this.content=this.formattedMessage;this.rendered=true;},setContent:function(content,wrappedContent){if(content!=this.content){if(isIe&&(content!==this.formattedMessage)){content=content.replace(/\\r\\n/g,"\\r");}','for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setContent(content,wrappedContent);}','this.content=content;}},getSearchMatches:function(){var matches=[];var i,len;if(isIe){var unwrappedEls=getElementsByClass(this.unwrappedElementContainer.mainDiv,"searchterm","span");var wrappedEls=getElementsByClass(this.wrappedElementContainer.mainDiv,"searchterm","span");for(i=0,len=unwrappedEls.length;i<len;i++){matches[i]=new Match(this.level,null,unwrappedEls[i],wrappedEls[i]);}}else{var els=getElementsByClass(this.mainElementContainer.mainDiv,"searchterm","span");for(i=0,len=els.length;i<len;i++){matches[i]=new Match(this.level,els[i]);}}','return matches;},setSearchMatch:function(isMatch){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].setSearchMatch(isMatch);}},clearSearch:function(){for(var i=0,len=this.elementContainers.length;i<len;i++){this.elementContainers[i].clearSearch();}},accept:function(visitor){visitor.visitLogEntry(this);},serialize:function(items){items.push([LogItem.serializedItemKeys.LOG_ENTRY,this.level,this.formattedMessage]);}});function LogItemVisitor(){}','LogItemVisitor.prototype={visit:function(logItem){},visitParent:function(logItem){if(logItem.group){logItem.group.accept(this);}},visitChildren:function(logItem){for(var i=0,len=logItem.children.length;i<len;i++){logItem.children[i].accept(this);}},visitLogEntry:function(logEntry){this.visit(logEntry);},visitSeparator:function(separator){this.visit(separator);},visitGroup:function(group){this.visit(group);}};function GroupFlattener(){this.logEntriesAndSeparators=[];}','GroupFlattener.prototype=new LogItemVisitor();GroupFlattener.prototype.visitGroup=function(group){this.visitChildren(group);};GroupFlattener.prototype.visitLogEntry=function(logEntry){this.logEntriesAndSeparators.push(logEntry);};GroupFlattener.prototype.visitSeparator=function(separator){this.logEntriesAndSeparators.push(separator);};window.onload=function(){if(location.search){var queryBits=unescape(location.search).substr(1).split("&"),nameValueBits;for(var i=0,len=queryBits.length;i<len;i++){nameValueBits=queryBits[i].split("=");if(nameValueBits[0]=="log4javascript_domain"){document.domain=nameValueBits[1];break;}}}','logMainContainer=$("log");if(isIePre7){addClass(logMainContainer,"oldIe");}','rootGroup=new Group("root",true);rootGroup.render();currentGroup=rootGroup;setCommandInputWidth();setLogContainerHeight();toggleLoggingEnabled();toggleSearchEnabled();toggleSearchFilter();toggleSearchHighlight();applyFilters();checkAllLevels();toggleWrap();toggleNewestAtTop();toggleScrollToLatest();renderQueuedLogItems();loaded=true;$("command").value="";$("command").autocomplete="off";$("command").onkeydown=function(evt){evt=getEvent(evt);if(evt.keyCode==10||evt.keyCode==13){evalCommandLine();stopPropagation(evt);}else if(evt.keyCode==27){this.value="";this.focus();}else if(evt.keyCode==38&&commandHistory.length>0){currentCommandIndex=Math.max(0,currentCommandIndex-1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}else if(evt.keyCode==40&&commandHistory.length>0){currentCommandIndex=Math.min(commandHistory.length-1,currentCommandIndex+1);this.value=commandHistory[currentCommandIndex];moveCaretToEnd(this);}};$("command").onkeypress=function(evt){evt=getEvent(evt);if(evt.keyCode==38&&commandHistory.length>0&&evt.preventDefault){evt.preventDefault();}};$("command").onkeyup=function(evt){evt=getEvent(evt);if(evt.keyCode==27&&evt.preventDefault){evt.preventDefault();this.focus();}};document.onkeydown=function keyEventHandler(evt){evt=getEvent(evt);switch(evt.keyCode){case 69:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){evalLastCommand();cancelKeyEvent(evt);return false;}','break;case 75:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusSearch();cancelKeyEvent(evt);return false;}','break;case 40:case 76:if(evt.shiftKey&&(evt.ctrlKey||evt.metaKey)){focusCommandLine();cancelKeyEvent(evt);return false;}','break;}};setTimeout(setLogContainerHeight,20);setShowCommandLine(showCommandLine);doSearch();};window.onunload=function(){if(mainWindowExists()){appender.unload();}','appender=null;};function toggleLoggingEnabled(){setLoggingEnabled($("enableLogging").checked);}','function setLoggingEnabled(enable){loggingEnabled=enable;}','var appender=null;function setAppender(appenderParam){appender=appenderParam;}','function setShowCloseButton(showCloseButton){$("closeButton").style.display=showCloseButton?"inline":"none";}','function setShowHideButton(showHideButton){$("hideButton").style.display=showHideButton?"inline":"none";}','var newestAtTop=false;function LogItemContentReverser(){}','LogItemContentReverser.prototype=new LogItemVisitor();LogItemContentReverser.prototype.visitGroup=function(group){group.reverseChildren();this.visitChildren(group);};function setNewestAtTop(isNewestAtTop){var oldNewestAtTop=newestAtTop;var i,iLen,j,jLen;newestAtTop=Boolean(isNewestAtTop);if(oldNewestAtTop!=newestAtTop){var visitor=new LogItemContentReverser();rootGroup.accept(visitor);if(currentSearch){var currentMatch=currentSearch.matches[currentMatchIndex];var matchIndex=0;var matches=[];var actOnLogEntry=function(logEntry){var logEntryMatches=logEntry.getSearchMatches();for(j=0,jLen=logEntryMatches.length;j<jLen;j++){matches[matchIndex]=logEntryMatches[j];if(currentMatch&&logEntryMatches[j].equals(currentMatch)){currentMatchIndex=matchIndex;}','matchIndex++;}};if(newestAtTop){for(i=logEntries.length-1;i>=0;i--){actOnLogEntry(logEntries[i]);}}else{for(i=0,iLen=logEntries.length;i<iLen;i++){actOnLogEntry(logEntries[i]);}}','currentSearch.matches=matches;if(currentMatch){currentMatch.setCurrent();}}else if(scrollToLatest){doScrollToLatest();}}','$("newestAtTop").checked=isNewestAtTop;}','function toggleNewestAtTop(){var isNewestAtTop=$("newestAtTop").checked;setNewestAtTop(isNewestAtTop);}','var scrollToLatest=true;function setScrollToLatest(isScrollToLatest){scrollToLatest=isScrollToLatest;if(scrollToLatest){doScrollToLatest();}','$("scrollToLatest").checked=isScrollToLatest;}','function toggleScrollToLatest(){var isScrollToLatest=$("scrollToLatest").checked;setScrollToLatest(isScrollToLatest);}','function doScrollToLatest(){var l=logMainContainer;if(typeof l.scrollTop!="undefined"){if(newestAtTop){l.scrollTop=0;}else{var latestLogEntry=l.lastChild;if(latestLogEntry){l.scrollTop=l.scrollHeight;}}}}','var closeIfOpenerCloses=true;function setCloseIfOpenerCloses(isCloseIfOpenerCloses){closeIfOpenerCloses=isCloseIfOpenerCloses;}','var maxMessages=null;function setMaxMessages(max){maxMessages=max;pruneLogEntries();}','var showCommandLine=false;function setShowCommandLine(isShowCommandLine){showCommandLine=isShowCommandLine;if(loaded){$("commandLine").style.display=showCommandLine?"block":"none";setCommandInputWidth();setLogContainerHeight();}}','function focusCommandLine(){if(loaded){$("command").focus();}}','function focusSearch(){if(loaded){$("searchBox").focus();}}','function getLogItems(){var items=[];for(var i=0,len=logItems.length;i<len;i++){logItems[i].serialize(items);}','return items;}','function setLogItems(items){var loggingReallyEnabled=loggingEnabled;loggingEnabled=true;for(var i=0,len=items.length;i<len;i++){switch(items[i][0]){case LogItem.serializedItemKeys.LOG_ENTRY:log(items[i][1],items[i][2]);break;case LogItem.serializedItemKeys.GROUP_START:group(items[i][1]);break;case LogItem.serializedItemKeys.GROUP_END:groupEnd();break;}}','loggingEnabled=loggingReallyEnabled;}','function log(logLevel,formattedMessage){if(loggingEnabled){var logEntry=new LogEntry(logLevel,formattedMessage);logEntries.push(logEntry);logEntriesAndSeparators.push(logEntry);logItems.push(logEntry);currentGroup.addChild(logEntry);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}','logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}','function renderQueuedLogItems(){logQueuedEventsTimer=null;var pruned=pruneLogEntries();var initiallyHasMatches=currentSearch?currentSearch.hasMatches():false;for(var i=0,len=logItems.length;i<len;i++){if(!logItems[i].rendered){logItems[i].render();logItems[i].appendToLog();if(currentSearch&&(logItems[i]instanceof LogEntry)){currentSearch.applyTo(logItems[i]);}}}','if(currentSearch){if(pruned){if(currentSearch.hasVisibleMatches()){if(currentMatchIndex===null){setCurrentMatchIndex(0);}','displayMatches();}else{displayNoMatches();}}else if(!initiallyHasMatches&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}}','if(scrollToLatest){doScrollToLatest();}','unrenderedLogItemsExist=false;}','function pruneLogEntries(){if((maxMessages!==null)&&(logEntriesAndSeparators.length>maxMessages)){var numberToDelete=logEntriesAndSeparators.length-maxMessages;var prunedLogEntries=logEntriesAndSeparators.slice(0,numberToDelete);if(currentSearch){currentSearch.removeMatches(prunedLogEntries);}','var group;for(var i=0;i<numberToDelete;i++){group=logEntriesAndSeparators[i].group;array_remove(logItems,logEntriesAndSeparators[i]);array_remove(logEntries,logEntriesAndSeparators[i]);logEntriesAndSeparators[i].remove(true,true);if(group.children.length===0&&group!==currentGroup&&group!==rootGroup){array_remove(logItems,group);group.remove(true,true);}}','logEntriesAndSeparators=array_removeFromStart(logEntriesAndSeparators,numberToDelete);return true;}','return false;}','function group(name,startExpanded){if(loggingEnabled){initiallyExpanded=(typeof startExpanded==="undefined")?true:Boolean(startExpanded);var newGroup=new Group(name,false,initiallyExpanded);currentGroup.addChild(newGroup);currentGroup=newGroup;logItems.push(newGroup);if(loaded){if(logQueuedEventsTimer!==null){clearTimeout(logQueuedEventsTimer);}','logQueuedEventsTimer=setTimeout(renderQueuedLogItems,renderDelay);unrenderedLogItemsExist=true;}}}','function groupEnd(){currentGroup=(currentGroup===rootGroup)?rootGroup:currentGroup.group;}','function mainPageReloaded(){currentGroup=rootGroup;var separator=new Separator();logEntriesAndSeparators.push(separator);logItems.push(separator);currentGroup.addChild(separator);}','function closeWindow(){if(appender&&mainWindowExists()){appender.close(true);}else{window.close();}}','function hide(){if(appender&&mainWindowExists()){appender.hide();}}','var mainWindow=window;var windowId="log4javascriptConsoleWindow_"+new Date().getTime()+"_"+(""+Math.random()).substr(2);function setMainWindow(win){mainWindow=win;mainWindow[windowId]=window;if(opener&&closeIfOpenerCloses){pollOpener();}}','function pollOpener(){if(closeIfOpenerCloses){if(mainWindowExists()){setTimeout(pollOpener,500);}else{closeWindow();}}}','function mainWindowExists(){try{return(mainWindow&&!mainWindow.closed&&mainWindow[windowId]==window);}catch(ex){}','return false;}','var logLevels=["TRACE","DEBUG","INFO","WARN","ERROR","FATAL"];function getCheckBox(logLevel){return $("switch_"+logLevel);}','function getIeWrappedLogContainer(){return $("log_wrapped");}','function getIeUnwrappedLogContainer(){return $("log_unwrapped");}','function applyFilters(){for(var i=0;i<logLevels.length;i++){if(getCheckBox(logLevels[i]).checked){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}','updateSearchFromFilters();}','function toggleAllLevels(){var turnOn=$("switch_ALL").checked;for(var i=0;i<logLevels.length;i++){getCheckBox(logLevels[i]).checked=turnOn;if(turnOn){addClass(logMainContainer,logLevels[i]);}else{removeClass(logMainContainer,logLevels[i]);}}}','function checkAllLevels(){for(var i=0;i<logLevels.length;i++){if(!getCheckBox(logLevels[i]).checked){getCheckBox("ALL").checked=false;return;}}','getCheckBox("ALL").checked=true;}','function clearLog(){rootGroup.clear();currentGroup=rootGroup;logEntries=[];logItems=[];logEntriesAndSeparators=[];doSearch();}','function toggleWrap(){var enable=$("wrap").checked;if(enable){addClass(logMainContainer,"wrap");}else{removeClass(logMainContainer,"wrap");}','refreshCurrentMatch();}','var searchTimer=null;function scheduleSearch(){try{clearTimeout(searchTimer);}catch(ex){}','searchTimer=setTimeout(doSearch,500);}','function Search(searchTerm,isRegex,searchRegex,isCaseSensitive){this.searchTerm=searchTerm;this.isRegex=isRegex;this.searchRegex=searchRegex;this.isCaseSensitive=isCaseSensitive;this.matches=[];}','Search.prototype={hasMatches:function(){return this.matches.length>0;},hasVisibleMatches:function(){if(this.hasMatches()){for(var i=0;i<this.matches.length;i++){if(this.matches[i].isVisible()){return true;}}}','return false;},match:function(logEntry){var entryText=String(logEntry.formattedMessage);var matchesSearch=false;if(this.isRegex){matchesSearch=this.searchRegex.test(entryText);}else if(this.isCaseSensitive){matchesSearch=(entryText.indexOf(this.searchTerm)>-1);}else{matchesSearch=(entryText.toLowerCase().indexOf(this.searchTerm.toLowerCase())>-1);}','return matchesSearch;},getNextVisibleMatchIndex:function(){for(var i=currentMatchIndex+1;i<this.matches.length;i++){if(this.matches[i].isVisible()){return i;}}','for(i=0;i<=currentMatchIndex;i++){if(this.matches[i].isVisible()){return i;}}','return-1;},getPreviousVisibleMatchIndex:function(){for(var i=currentMatchIndex-1;i>=0;i--){if(this.matches[i].isVisible()){return i;}}','for(var i=this.matches.length-1;i>=currentMatchIndex;i--){if(this.matches[i].isVisible()){return i;}}','return-1;},applyTo:function(logEntry){var doesMatch=this.match(logEntry);if(doesMatch){logEntry.group.expand();logEntry.setSearchMatch(true);var logEntryContent;var wrappedLogEntryContent;var searchTermReplacementStartTag="<span class=\\\"searchterm\\\">";var searchTermReplacementEndTag="<"+"/span>";var preTagName=isIe?"pre":"span";var preStartTag="<"+preTagName+" class=\\\"pre\\\">";var preEndTag="<"+"/"+preTagName+">";var startIndex=0;var searchIndex,matchedText,textBeforeMatch;if(this.isRegex){var flags=this.isCaseSensitive?"g":"gi";var capturingRegex=new RegExp("("+this.searchRegex.source+")",flags);var rnd=(""+Math.random()).substr(2);var startToken="%%s"+rnd+"%%";var endToken="%%e"+rnd+"%%";logEntryContent=logEntry.formattedMessage.replace(capturingRegex,startToken+"$1"+endToken);logEntryContent=escapeHtml(logEntryContent);var result;var searchString=logEntryContent;logEntryContent="";wrappedLogEntryContent="";while((searchIndex=searchString.indexOf(startToken,startIndex))>-1){var endTokenIndex=searchString.indexOf(endToken,searchIndex);matchedText=searchString.substring(searchIndex+startToken.length,endTokenIndex);textBeforeMatch=searchString.substring(startIndex,searchIndex);logEntryContent+=preStartTag+textBeforeMatch+preEndTag;logEntryContent+=searchTermReplacementStartTag+preStartTag+matchedText+','preEndTag+searchTermReplacementEndTag;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+','matchedText+searchTermReplacementEndTag;}','startIndex=endTokenIndex+endToken.length;}','logEntryContent+=preStartTag+searchString.substr(startIndex)+preEndTag;if(isIe){wrappedLogEntryContent+=searchString.substr(startIndex);}}else{logEntryContent="";wrappedLogEntryContent="";var searchTermReplacementLength=searchTermReplacementStartTag.length+','this.searchTerm.length+searchTermReplacementEndTag.length;var searchTermLength=this.searchTerm.length;var searchTermLowerCase=this.searchTerm.toLowerCase();var logTextLowerCase=logEntry.formattedMessage.toLowerCase();while((searchIndex=logTextLowerCase.indexOf(searchTermLowerCase,startIndex))>-1){matchedText=escapeHtml(logEntry.formattedMessage.substr(searchIndex,this.searchTerm.length));textBeforeMatch=escapeHtml(logEntry.formattedMessage.substring(startIndex,searchIndex));var searchTermReplacement=searchTermReplacementStartTag+','preStartTag+matchedText+preEndTag+searchTermReplacementEndTag;logEntryContent+=preStartTag+textBeforeMatch+preEndTag+searchTermReplacement;if(isIe){wrappedLogEntryContent+=textBeforeMatch+searchTermReplacementStartTag+','matchedText+searchTermReplacementEndTag;}','startIndex=searchIndex+searchTermLength;}','var textAfterLastMatch=escapeHtml(logEntry.formattedMessage.substr(startIndex));logEntryContent+=preStartTag+textAfterLastMatch+preEndTag;if(isIe){wrappedLogEntryContent+=textAfterLastMatch;}}','logEntry.setContent(logEntryContent,wrappedLogEntryContent);var logEntryMatches=logEntry.getSearchMatches();this.matches=this.matches.concat(logEntryMatches);}else{logEntry.setSearchMatch(false);logEntry.setContent(logEntry.formattedMessage,logEntry.formattedMessage);}','return doesMatch;},removeMatches:function(logEntries){var matchesToRemoveCount=0;var currentMatchRemoved=false;var matchesToRemove=[];var i,iLen,j,jLen;for(i=0,iLen=this.matches.length;i<iLen;i++){for(j=0,jLen=logEntries.length;j<jLen;j++){if(this.matches[i].belongsTo(logEntries[j])){matchesToRemove.push(this.matches[i]);if(i===currentMatchIndex){currentMatchRemoved=true;}}}}','var newMatch=currentMatchRemoved?null:this.matches[currentMatchIndex];if(currentMatchRemoved){for(i=currentMatchIndex,iLen=this.matches.length;i<iLen;i++){if(this.matches[i].isVisible()&&!array_contains(matchesToRemove,this.matches[i])){newMatch=this.matches[i];break;}}}','for(i=0,iLen=matchesToRemove.length;i<iLen;i++){array_remove(this.matches,matchesToRemove[i]);matchesToRemove[i].remove();}','if(this.hasVisibleMatches()){if(newMatch===null){setCurrentMatchIndex(0);}else{var newMatchIndex=0;for(i=0,iLen=this.matches.length;i<iLen;i++){if(newMatch===this.matches[i]){newMatchIndex=i;break;}}','setCurrentMatchIndex(newMatchIndex);}}else{currentMatchIndex=null;displayNoMatches();}}};function getPageOffsetTop(el,container){var currentEl=el;var y=0;while(currentEl&&currentEl!=container){y+=currentEl.offsetTop;currentEl=currentEl.offsetParent;}','return y;}','function scrollIntoView(el){var logContainer=logMainContainer;if(!$("wrap").checked){var logContainerLeft=logContainer.scrollLeft;var logContainerRight=logContainerLeft+logContainer.offsetWidth;var elLeft=el.offsetLeft;var elRight=elLeft+el.offsetWidth;if(elLeft<logContainerLeft||elRight>logContainerRight){logContainer.scrollLeft=elLeft-(logContainer.offsetWidth-el.offsetWidth)/2;}}','var logContainerTop=logContainer.scrollTop;var logContainerBottom=logContainerTop+logContainer.offsetHeight;var elTop=getPageOffsetTop(el)-getToolBarsHeight();var elBottom=elTop+el.offsetHeight;if(elTop<logContainerTop||elBottom>logContainerBottom){logContainer.scrollTop=elTop-(logContainer.offsetHeight-el.offsetHeight)/2;}}','function Match(logEntryLevel,spanInMainDiv,spanInUnwrappedPre,spanInWrappedDiv){this.logEntryLevel=logEntryLevel;this.spanInMainDiv=spanInMainDiv;if(isIe){this.spanInUnwrappedPre=spanInUnwrappedPre;this.spanInWrappedDiv=spanInWrappedDiv;}','this.mainSpan=isIe?spanInUnwrappedPre:spanInMainDiv;}','Match.prototype={equals:function(match){return this.mainSpan===match.mainSpan;},setCurrent:function(){if(isIe){addClass(this.spanInUnwrappedPre,"currentmatch");addClass(this.spanInWrappedDiv,"currentmatch");var elementToScroll=$("wrap").checked?this.spanInWrappedDiv:this.spanInUnwrappedPre;scrollIntoView(elementToScroll);}else{addClass(this.spanInMainDiv,"currentmatch");scrollIntoView(this.spanInMainDiv);}},belongsTo:function(logEntry){if(isIe){return isDescendant(this.spanInUnwrappedPre,logEntry.unwrappedPre);}else{return isDescendant(this.spanInMainDiv,logEntry.mainDiv);}},setNotCurrent:function(){if(isIe){removeClass(this.spanInUnwrappedPre,"currentmatch");removeClass(this.spanInWrappedDiv,"currentmatch");}else{removeClass(this.spanInMainDiv,"currentmatch");}},isOrphan:function(){return isOrphan(this.mainSpan);},isVisible:function(){return getCheckBox(this.logEntryLevel).checked;},remove:function(){if(isIe){this.spanInUnwrappedPre=null;this.spanInWrappedDiv=null;}else{this.spanInMainDiv=null;}}};var currentSearch=null;var currentMatchIndex=null;function doSearch(){var searchBox=$("searchBox");var searchTerm=searchBox.value;var isRegex=$("searchRegex").checked;var isCaseSensitive=$("searchCaseSensitive").checked;var i;if(searchTerm===""){$("searchReset").disabled=true;$("searchNav").style.display="none";removeClass(document.body,"searching");removeClass(searchBox,"hasmatches");removeClass(searchBox,"nomatches");for(i=0;i<logEntries.length;i++){logEntries[i].clearSearch();logEntries[i].setContent(logEntries[i].formattedMessage,logEntries[i].formattedMessage);}','currentSearch=null;setLogContainerHeight();}else{$("searchReset").disabled=false;$("searchNav").style.display="block";var searchRegex;var regexValid;if(isRegex){try{searchRegex=isCaseSensitive?new RegExp(searchTerm,"g"):new RegExp(searchTerm,"gi");regexValid=true;replaceClass(searchBox,"validregex","invalidregex");searchBox.title="Valid regex";}catch(ex){regexValid=false;replaceClass(searchBox,"invalidregex","validregex");searchBox.title="Invalid regex: "+(ex.message?ex.message:(ex.description?ex.description:"unknown error"));return;}}else{searchBox.title="";removeClass(searchBox,"validregex");removeClass(searchBox,"invalidregex");}','addClass(document.body,"searching");currentSearch=new Search(searchTerm,isRegex,searchRegex,isCaseSensitive);for(i=0;i<logEntries.length;i++){currentSearch.applyTo(logEntries[i]);}','setLogContainerHeight();if(currentSearch.hasVisibleMatches()){setCurrentMatchIndex(0);displayMatches();}else{displayNoMatches();}}}','function updateSearchFromFilters(){if(currentSearch){if(currentSearch.hasMatches()){if(currentMatchIndex===null){currentMatchIndex=0;}','var currentMatch=currentSearch.matches[currentMatchIndex];if(currentMatch.isVisible()){displayMatches();setCurrentMatchIndex(currentMatchIndex);}else{currentMatch.setNotCurrent();var nextVisibleMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextVisibleMatchIndex>-1){setCurrentMatchIndex(nextVisibleMatchIndex);displayMatches();}else{displayNoMatches();}}}else{displayNoMatches();}}}','function refreshCurrentMatch(){if(currentSearch&&currentSearch.hasVisibleMatches()){setCurrentMatchIndex(currentMatchIndex);}}','function displayMatches(){replaceClass($("searchBox"),"hasmatches","nomatches");$("searchBox").title=""+currentSearch.matches.length+" matches found";$("searchNav").style.display="block";setLogContainerHeight();}','function displayNoMatches(){replaceClass($("searchBox"),"nomatches","hasmatches");$("searchBox").title="No matches found";$("searchNav").style.display="none";setLogContainerHeight();}','function toggleSearchEnabled(enable){enable=(typeof enable=="undefined")?!$("searchDisable").checked:enable;$("searchBox").disabled=!enable;$("searchReset").disabled=!enable;$("searchRegex").disabled=!enable;$("searchNext").disabled=!enable;$("searchPrevious").disabled=!enable;$("searchCaseSensitive").disabled=!enable;$("searchNav").style.display=(enable&&($("searchBox").value!=="")&&currentSearch&&currentSearch.hasVisibleMatches())?"block":"none";if(enable){removeClass($("search"),"greyedout");addClass(document.body,"searching");if($("searchHighlight").checked){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}','if($("searchFilter").checked){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','$("searchDisable").checked=!enable;}else{addClass($("search"),"greyedout");removeClass(document.body,"searching");removeClass(logMainContainer,"searchhighlight");removeClass(logMainContainer,"searchfilter");}','setLogContainerHeight();}','function toggleSearchFilter(){var enable=$("searchFilter").checked;if(enable){addClass(logMainContainer,"searchfilter");}else{removeClass(logMainContainer,"searchfilter");}','refreshCurrentMatch();}','function toggleSearchHighlight(){var enable=$("searchHighlight").checked;if(enable){addClass(logMainContainer,"searchhighlight");}else{removeClass(logMainContainer,"searchhighlight");}}','function clearSearch(){$("searchBox").value="";doSearch();}','function searchNext(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var nextMatchIndex=currentSearch.getNextVisibleMatchIndex();if(nextMatchIndex>currentMatchIndex||confirm("Reached the end of the page. Start from the top?")){setCurrentMatchIndex(nextMatchIndex);}}}','function searchPrevious(){if(currentSearch!==null&&currentMatchIndex!==null){currentSearch.matches[currentMatchIndex].setNotCurrent();var previousMatchIndex=currentSearch.getPreviousVisibleMatchIndex();if(previousMatchIndex<currentMatchIndex||confirm("Reached the start of the page. Continue from the bottom?")){setCurrentMatchIndex(previousMatchIndex);}}}','function setCurrentMatchIndex(index){currentMatchIndex=index;currentSearch.matches[currentMatchIndex].setCurrent();}','function addClass(el,cssClass){if(!hasClass(el,cssClass)){if(el.className){el.className+=" "+cssClass;}else{el.className=cssClass;}}}','function hasClass(el,cssClass){if(el.className){var classNames=el.className.split(" ");return array_contains(classNames,cssClass);}','return false;}','function removeClass(el,cssClass){if(hasClass(el,cssClass)){var existingClasses=el.className.split(" ");var newClasses=[];for(var i=0,len=existingClasses.length;i<len;i++){if(existingClasses[i]!=cssClass){newClasses[newClasses.length]=existingClasses[i];}}','el.className=newClasses.join(" ");}}','function replaceClass(el,newCssClass,oldCssClass){removeClass(el,oldCssClass);addClass(el,newCssClass);}','function getElementsByClass(el,cssClass,tagName){var elements=el.getElementsByTagName(tagName);var matches=[];for(var i=0,len=elements.length;i<len;i++){if(hasClass(elements[i],cssClass)){matches.push(elements[i]);}}','return matches;}','function $(id){return document.getElementById(id);}','function isDescendant(node,ancestorNode){while(node!=null){if(node===ancestorNode){return true;}','node=node.parentNode;}','return false;}','function isOrphan(node){var currentNode=node;while(currentNode){if(currentNode==document.body){return false;}','currentNode=currentNode.parentNode;}','return true;}','function escapeHtml(str){return str.replace(/&/g,"&amp;").replace(/[<]/g,"&lt;").replace(/>/g,"&gt;");}','function getWindowWidth(){if(window.innerWidth){return window.innerWidth;}else if(document.documentElement&&document.documentElement.clientWidth){return document.documentElement.clientWidth;}else if(document.body){return document.body.clientWidth;}','return 0;}','function getWindowHeight(){if(window.innerHeight){return window.innerHeight;}else if(document.documentElement&&document.documentElement.clientHeight){return document.documentElement.clientHeight;}else if(document.body){return document.body.clientHeight;}','return 0;}','function getToolBarsHeight(){return $("switches").offsetHeight;}','function getChromeHeight(){var height=getToolBarsHeight();if(showCommandLine){height+=$("commandLine").offsetHeight;}','return height;}','function setLogContainerHeight(){if(logMainContainer){var windowHeight=getWindowHeight();$("body").style.height=getWindowHeight()+"px";logMainContainer.style.height=""+','Math.max(0,windowHeight-getChromeHeight())+"px";}}','function setCommandInputWidth(){if(showCommandLine){$("command").style.width=""+Math.max(0,$("commandLineContainer").offsetWidth-','($("evaluateButton").offsetWidth+13))+"px";}}','window.onresize=function(){setCommandInputWidth();setLogContainerHeight();};if(!Array.prototype.push){Array.prototype.push=function(){for(var i=0,len=arguments.length;i<len;i++){this[this.length]=arguments[i];}','return this.length;};}','if(!Array.prototype.pop){Array.prototype.pop=function(){if(this.length>0){var val=this[this.length-1];this.length=this.length-1;return val;}};}','if(!Array.prototype.shift){Array.prototype.shift=function(){if(this.length>0){var firstItem=this[0];for(var i=0,len=this.length-1;i<len;i++){this[i]=this[i+1];}','this.length=this.length-1;return firstItem;}};}','if(!Array.prototype.splice){Array.prototype.splice=function(startIndex,deleteCount){var itemsAfterDeleted=this.slice(startIndex+deleteCount);var itemsDeleted=this.slice(startIndex,startIndex+deleteCount);this.length=startIndex;var argumentsArray=[];for(var i=0,len=arguments.length;i<len;i++){argumentsArray[i]=arguments[i];}','var itemsToAppend=(argumentsArray.length>2)?itemsAfterDeleted=argumentsArray.slice(2).concat(itemsAfterDeleted):itemsAfterDeleted;for(i=0,len=itemsToAppend.length;i<len;i++){this.push(itemsToAppend[i]);}','return itemsDeleted;};}','function array_remove(arr,val){var index=-1;for(var i=0,len=arr.length;i<len;i++){if(arr[i]===val){index=i;break;}}','if(index>=0){arr.splice(index,1);return index;}else{return false;}}','function array_removeFromStart(array,numberToRemove){if(Array.prototype.splice){array.splice(0,numberToRemove);}else{for(var i=numberToRemove,len=array.length;i<len;i++){array[i-numberToRemove]=array[i];}','array.length=array.length-numberToRemove;}','return array;}','function array_contains(arr,val){for(var i=0,len=arr.length;i<len;i++){if(arr[i]==val){return true;}}','return false;}','function getErrorMessage(ex){if(ex.message){return ex.message;}else if(ex.description){return ex.description;}','return""+ex;}','function moveCaretToEnd(input){if(input.setSelectionRange){input.focus();var length=input.value.length;input.setSelectionRange(length,length);}else if(input.createTextRange){var range=input.createTextRange();range.collapse(false);range.select();}','input.focus();}','function stopPropagation(evt){if(evt.stopPropagation){evt.stopPropagation();}else if(typeof evt.cancelBubble!="undefined"){evt.cancelBubble=true;}}','function getEvent(evt){return evt?evt:event;}','function getTarget(evt){return evt.target?evt.target:evt.srcElement;}','function getRelatedTarget(evt){if(evt.relatedTarget){return evt.relatedTarget;}else if(evt.srcElement){switch(evt.type){case"mouseover":return evt.fromElement;case"mouseout":return evt.toElement;default:return evt.srcElement;}}}','function cancelKeyEvent(evt){evt.returnValue=false;stopPropagation(evt);}','function evalCommandLine(){var expr=$("command").value;evalCommand(expr);$("command").value="";}','function evalLastCommand(){if(lastCommand!=null){evalCommand(lastCommand);}}','var lastCommand=null;var commandHistory=[];var currentCommandIndex=0;function evalCommand(expr){if(appender){appender.evalCommandAndAppend(expr);}else{var prefix=">>> "+expr+"\\r\\n";try{log("INFO",prefix+eval(expr));}catch(ex){log("ERROR",prefix+"Error: "+getErrorMessage(ex));}}','if(expr!=commandHistory[commandHistory.length-1]){commandHistory.push(expr);if(appender){appender.storeCommandHistory(commandHistory);}}','currentCommandIndex=(expr==commandHistory[currentCommandIndex])?currentCommandIndex+1:commandHistory.length;lastCommand=expr;}','//]]>','</script>','<style type="text/css">','body{background-color:white;color:black;padding:0;margin:0;font-family:tahoma,verdana,arial,helvetica,sans-serif;overflow:hidden}div#switchesContainer input{margin-bottom:0}div.toolbar{border-top:solid #ffffff 1px;border-bottom:solid #aca899 1px;background-color:#f1efe7;padding:3px 5px;font-size:68.75%}div.toolbar,div#search input{font-family:tahoma,verdana,arial,helvetica,sans-serif}div.toolbar input.button{padding:0 5px;font-size:100%}div.toolbar input.hidden{display:none}div#switches input#clearButton{margin-left:20px}div#levels label{font-weight:bold}div#levels label,div#options label{margin-right:5px}div#levels label#wrapLabel{font-weight:normal}div#search label{margin-right:10px}div#search label.searchboxlabel{margin-right:0}div#search input{font-size:100%}div#search input.validregex{color:green}div#search input.invalidregex{color:red}div#search input.nomatches{color:white;background-color:#ff6666}div#search input.nomatches{color:white;background-color:#ff6666}div#searchNav{display:none}div#commandLine{display:none}div#commandLine input#command{font-size:100%;font-family:Courier New,Courier}div#commandLine input#evaluateButton{}*.greyedout{color:gray !important;border-color:gray !important}*.greyedout *.alwaysenabled{color:black}*.unselectable{-khtml-user-select:none;-moz-user-select:none;user-select:none}div#log{font-family:Courier New,Courier;font-size:75%;width:100%;overflow:auto;clear:both;position:relative}div.group{border-color:#cccccc;border-style:solid;border-width:1px 0 1px 1px;overflow:visible}div.oldIe div.group,div.oldIe div.group *,div.oldIe *.logentry{height:1%}div.group div.groupheading span.expander{border:solid black 1px;font-family:Courier New,Courier;font-size:0.833em;background-color:#eeeeee;position:relative;top:-1px;color:black;padding:0 2px;cursor:pointer;cursor:hand;height:1%}div.group div.groupcontent{margin-left:10px;padding-bottom:2px;overflow:visible}div.group div.expanded{display:block}div.group div.collapsed{display:none}*.logentry{overflow:visible;display:none;white-space:pre}span.pre{white-space:pre}pre.unwrapped{display:inline !important}pre.unwrapped pre.pre,div.wrapped pre.pre{display:inline}div.wrapped pre.pre{white-space:normal}div.wrapped{display:none}body.searching *.logentry span.currentmatch{color:white !important;background-color:green !important}body.searching div.searchhighlight *.logentry span.searchterm{color:black;background-color:yellow}div.wrap *.logentry{white-space:normal !important;border-width:0 0 1px 0;border-color:#dddddd;border-style:dotted}div.wrap #log_wrapped,#log_unwrapped{display:block}div.wrap #log_unwrapped,#log_wrapped{display:none}div.wrap *.logentry span.pre{overflow:visible;white-space:normal}div.wrap *.logentry pre.unwrapped{display:none}div.wrap *.logentry span.wrapped{display:inline}div.searchfilter *.searchnonmatch{display:none !important}div#log *.TRACE,label#label_TRACE{color:#666666}div#log *.DEBUG,label#label_DEBUG{color:green}div#log *.INFO,label#label_INFO{color:#000099}div#log *.WARN,label#label_WARN{color:#999900}div#log *.ERROR,label#label_ERROR{color:red}div#log *.FATAL,label#label_FATAL{color:#660066}div.TRACE#log *.TRACE,div.DEBUG#log *.DEBUG,div.INFO#log *.INFO,div.WARN#log *.WARN,div.ERROR#log *.ERROR,div.FATAL#log *.FATAL{display:block}div#log div.separator{background-color:#cccccc;margin:5px 0;line-height:1px}','</style>','</head>','<body id="body">','<div id="switchesContainer">','<div id="switches">','<div id="levels" class="toolbar">','Filters:','<input type="checkbox" id="switch_TRACE" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide trace messages" /><label for="switch_TRACE" id="label_TRACE">trace</label>','<input type="checkbox" id="switch_DEBUG" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide debug messages" /><label for="switch_DEBUG" id="label_DEBUG">debug</label>','<input type="checkbox" id="switch_INFO" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide info messages" /><label for="switch_INFO" id="label_INFO">info</label>','<input type="checkbox" id="switch_WARN" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide warn messages" /><label for="switch_WARN" id="label_WARN">warn</label>','<input type="checkbox" id="switch_ERROR" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide error messages" /><label for="switch_ERROR" id="label_ERROR">error</label>','<input type="checkbox" id="switch_FATAL" onclick="applyFilters(); checkAllLevels()" checked="checked" title="Show/hide fatal messages" /><label for="switch_FATAL" id="label_FATAL">fatal</label>','<input type="checkbox" id="switch_ALL" onclick="toggleAllLevels(); applyFilters()" checked="checked" title="Show/hide all messages" /><label for="switch_ALL" id="label_ALL">all</label>','</div>','<div id="search" class="toolbar">','<label for="searchBox" class="searchboxlabel">Search:</label> <input type="text" id="searchBox" onclick="toggleSearchEnabled(true)" onkeyup="scheduleSearch()" size="20" />','<input type="button" id="searchReset" disabled="disabled" value="Reset" onclick="clearSearch()" class="button" title="Reset the search" />','<input type="checkbox" id="searchRegex" onclick="doSearch()" title="If checked, search is treated as a regular expression" /><label for="searchRegex">Regex</label>','<input type="checkbox" id="searchCaseSensitive" onclick="doSearch()" title="If checked, search is case sensitive" /><label for="searchCaseSensitive">Match case</label>','<input type="checkbox" id="searchDisable" onclick="toggleSearchEnabled()" title="Enable/disable search" /><label for="searchDisable" class="alwaysenabled">Disable</label>','<div id="searchNav">','<input type="button" id="searchNext" disabled="disabled" value="Next" onclick="searchNext()" class="button" title="Go to the next matching log entry" />','<input type="button" id="searchPrevious" disabled="disabled" value="Previous" onclick="searchPrevious()" class="button" title="Go to the previous matching log entry" />','<input type="checkbox" id="searchFilter" onclick="toggleSearchFilter()" title="If checked, non-matching log entries are filtered out" /><label for="searchFilter">Filter</label>','<input type="checkbox" id="searchHighlight" onclick="toggleSearchHighlight()" title="Highlight matched search terms" /><label for="searchHighlight" class="alwaysenabled">Highlight all</label>','</div>','</div>','<div id="options" class="toolbar">','Options:','<input type="checkbox" id="enableLogging" onclick="toggleLoggingEnabled()" checked="checked" title="Enable/disable logging" /><label for="enableLogging" id="enableLoggingLabel">Log</label>','<input type="checkbox" id="wrap" onclick="toggleWrap()" title="Enable / disable word wrap" /><label for="wrap" id="wrapLabel">Wrap</label>','<input type="checkbox" id="newestAtTop" onclick="toggleNewestAtTop()" title="If checked, causes newest messages to appear at the top" /><label for="newestAtTop" id="newestAtTopLabel">Newest at the top</label>','<input type="checkbox" id="scrollToLatest" onclick="toggleScrollToLatest()" checked="checked" title="If checked, window automatically scrolls to a new message when it is added" /><label for="scrollToLatest" id="scrollToLatestLabel">Scroll to latest</label>','<input type="button" id="clearButton" value="Clear" onclick="clearLog()" class="button" title="Clear all log messages"  />','<input type="button" id="hideButton" value="Hide" onclick="hide()" class="hidden button" title="Hide the console" />','<input type="button" id="closeButton" value="Close" onclick="closeWindow()" class="hidden button" title="Close the window" />','</div>','</div>','</div>','<div id="log" class="TRACE DEBUG INFO WARN ERROR FATAL"></div>','<div id="commandLine" class="toolbar">','<div id="commandLineContainer">','<input type="text" id="command" title="Enter a JavaScript command here and hit return or press \'Evaluate\'" />','<input type="button" id="evaluateButton" value="Evaluate" class="button" title="Evaluate the command" onclick="evalCommandLine()" />','</div>','</div>','</body>','</html>',''];};var defaultCommandLineFunctions=[];ConsoleAppender=function(){};var consoleAppenderIdCounter=1;ConsoleAppender.prototype=new Appender();ConsoleAppender.prototype.create=function(inPage,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,focusConsoleWindow){var appender=this;var initialized=false;var consoleWindowCreated=false;var consoleWindowLoaded=false;var consoleClosed=false;var queuedLoggingEvents=[];var isSupported=true;var consoleAppenderId=consoleAppenderIdCounter++;initiallyMinimized=extractBooleanFromParam(initiallyMinimized,this.defaults.initiallyMinimized);lazyInit=extractBooleanFromParam(lazyInit,this.defaults.lazyInit);useDocumentWrite=extractBooleanFromParam(useDocumentWrite,this.defaults.useDocumentWrite);var newestMessageAtTop=this.defaults.newestMessageAtTop;var scrollToLatestMessage=this.defaults.scrollToLatestMessage;width=width?width:this.defaults.width;height=height?height:this.defaults.height;var maxMessages=this.defaults.maxMessages;var showCommandLine=this.defaults.showCommandLine;var commandLineObjectExpansionDepth=this.defaults.commandLineObjectExpansionDepth;var showHideButton=this.defaults.showHideButton;var showCloseButton=this.defaults.showCloseButton;this.setLayout(this.defaults.layout);var init,createWindow,safeToAppend,getConsoleWindow,open;var appenderName=inPage?"InPageAppender":"PopUpAppender";var checkCanConfigure=function(configOptionName){if(consoleWindowCreated){handleError(appenderName+": configuration option '"+configOptionName+"' may not be set after the appender has been initialized");return false;}
return true;};var consoleWindowExists=function(){return(consoleWindowLoaded&&isSupported&&!consoleClosed);};this.isNewestMessageAtTop=function(){return newestMessageAtTop;};this.setNewestMessageAtTop=function(newestMessageAtTopParam){newestMessageAtTop=bool(newestMessageAtTopParam);if(consoleWindowExists()){getConsoleWindow().setNewestAtTop(newestMessageAtTop);}};this.isScrollToLatestMessage=function(){return scrollToLatestMessage;};this.setScrollToLatestMessage=function(scrollToLatestMessageParam){scrollToLatestMessage=bool(scrollToLatestMessageParam);if(consoleWindowExists()){getConsoleWindow().setScrollToLatest(scrollToLatestMessage);}};this.getWidth=function(){return width;};this.setWidth=function(widthParam){if(checkCanConfigure("width")){width=extractStringFromParam(widthParam,width);}};this.getHeight=function(){return height;};this.setHeight=function(heightParam){if(checkCanConfigure("height")){height=extractStringFromParam(heightParam,height);}};this.getMaxMessages=function(){return maxMessages;};this.setMaxMessages=function(maxMessagesParam){maxMessages=extractIntFromParam(maxMessagesParam,maxMessages);if(consoleWindowExists()){getConsoleWindow().setMaxMessages(maxMessages);}};this.isShowCommandLine=function(){return showCommandLine;};this.setShowCommandLine=function(showCommandLineParam){showCommandLine=bool(showCommandLineParam);if(consoleWindowExists()){getConsoleWindow().setShowCommandLine(showCommandLine);}};this.isShowHideButton=function(){return showHideButton;};this.setShowHideButton=function(showHideButtonParam){showHideButton=bool(showHideButtonParam);if(consoleWindowExists()){getConsoleWindow().setShowHideButton(showHideButton);}};this.isShowCloseButton=function(){return showCloseButton;};this.setShowCloseButton=function(showCloseButtonParam){showCloseButton=bool(showCloseButtonParam);if(consoleWindowExists()){getConsoleWindow().setShowCloseButton(showCloseButton);}};this.getCommandLineObjectExpansionDepth=function(){return commandLineObjectExpansionDepth;};this.setCommandLineObjectExpansionDepth=function(commandLineObjectExpansionDepthParam){commandLineObjectExpansionDepth=extractIntFromParam(commandLineObjectExpansionDepthParam,commandLineObjectExpansionDepth);};var minimized=initiallyMinimized;this.isInitiallyMinimized=function(){return initiallyMinimized;};this.setInitiallyMinimized=function(initiallyMinimizedParam){if(checkCanConfigure("initiallyMinimized")){initiallyMinimized=bool(initiallyMinimizedParam);minimized=initiallyMinimized;}};this.isUseDocumentWrite=function(){return useDocumentWrite;};this.setUseDocumentWrite=function(useDocumentWriteParam){if(checkCanConfigure("useDocumentWrite")){useDocumentWrite=bool(useDocumentWriteParam);}};function QueuedLoggingEvent(loggingEvent,formattedMessage){this.loggingEvent=loggingEvent;this.levelName=loggingEvent.level.name;this.formattedMessage=formattedMessage;}
QueuedLoggingEvent.prototype.append=function(){getConsoleWindow().log(this.levelName,this.formattedMessage);};function QueuedGroup(name,initiallyExpanded){this.name=name;this.initiallyExpanded=initiallyExpanded;}
QueuedGroup.prototype.append=function(){getConsoleWindow().group(this.name,this.initiallyExpanded);};function QueuedGroupEnd(){}
QueuedGroupEnd.prototype.append=function(){getConsoleWindow().groupEnd();};var checkAndAppend=function(){safeToAppend();if(!initialized){init();}else if(consoleClosed&&reopenWhenClosed){createWindow();}
if(safeToAppend()){appendQueuedLoggingEvents();}};this.append=function(loggingEvent){if(isSupported){var formattedMessage=appender.getLayout().formatWithException(loggingEvent);queuedLoggingEvents.push(new QueuedLoggingEvent(loggingEvent,formattedMessage));checkAndAppend();}};this.group=function(name,initiallyExpanded){if(isSupported){queuedLoggingEvents.push(new QueuedGroup(name,initiallyExpanded));checkAndAppend();}};this.groupEnd=function(){if(isSupported){queuedLoggingEvents.push(new QueuedGroupEnd());checkAndAppend();}};var appendQueuedLoggingEvents=function(){while(queuedLoggingEvents.length>0){queuedLoggingEvents.shift().append();}
if(focusConsoleWindow){getConsoleWindow().focus();}};this.setAddedToLogger=function(logger){this.loggers.push(logger);if(enabled&&!lazyInit){init();}};this.clear=function(){if(consoleWindowExists()){getConsoleWindow().clearLog();}
queuedLoggingEvents.length=0;};this.focus=function(){if(consoleWindowExists()){getConsoleWindow().focus();}};this.focusCommandLine=function(){if(consoleWindowExists()){getConsoleWindow().focusCommandLine();}};this.focusSearch=function(){if(consoleWindowExists()){getConsoleWindow().focusSearch();}};var commandWindow=window;this.getCommandWindow=function(){return commandWindow;};this.setCommandWindow=function(commandWindowParam){commandWindow=commandWindowParam;};this.executeLastCommand=function(){if(consoleWindowExists()){getConsoleWindow().evalLastCommand();}};var commandLayout=new PatternLayout("%m");this.getCommandLayout=function(){return commandLayout;};this.setCommandLayout=function(commandLayoutParam){commandLayout=commandLayoutParam;};this.evalCommandAndAppend=function(expr){var commandReturnValue={appendResult:true,isError:false};var commandOutput="";try{var result,i;if(!commandWindow.eval&&commandWindow.execScript){commandWindow.execScript("null");}
var commandLineFunctionsHash={};for(i=0,len=commandLineFunctions.length;i<len;i++){commandLineFunctionsHash[commandLineFunctions[i][0]]=commandLineFunctions[i][1];}
var objectsToRestore=[];var addObjectToRestore=function(name){objectsToRestore.push([name,commandWindow[name]]);};addObjectToRestore("appender");commandWindow.appender=appender;addObjectToRestore("commandReturnValue");commandWindow.commandReturnValue=commandReturnValue;addObjectToRestore("commandLineFunctionsHash");commandWindow.commandLineFunctionsHash=commandLineFunctionsHash;var addFunctionToWindow=function(name){addObjectToRestore(name);commandWindow[name]=function(){return this.commandLineFunctionsHash[name](appender,arguments,commandReturnValue);};};for(i=0,len=commandLineFunctions.length;i<len;i++){addFunctionToWindow(commandLineFunctions[i][0]);}
if(commandWindow===window&&commandWindow.execScript){addObjectToRestore("evalExpr");addObjectToRestore("result");window.evalExpr=expr;commandWindow.execScript("window.result=eval(window.evalExpr);");result=window.result;}else{result=commandWindow.eval(expr);}
commandOutput=isUndefined(result)?result:formatObjectExpansion(result,commandLineObjectExpansionDepth);for(i=0,len=objectsToRestore.length;i<len;i++){commandWindow[objectsToRestore[i][0]]=objectsToRestore[i][1];}}catch(ex){commandOutput="Error evaluating command: "+getExceptionStringRep(ex);commandReturnValue.isError=true;}
if(commandReturnValue.appendResult){var message=">>> "+expr;if(!isUndefined(commandOutput)){message+=newLine+commandOutput;}
var level=commandReturnValue.isError?Level.ERROR:Level.INFO;var loggingEvent=new LoggingEvent(null,new Date(),level,[message],null);var mainLayout=this.getLayout();this.setLayout(commandLayout);this.append(loggingEvent);this.setLayout(mainLayout);}};var commandLineFunctions=defaultCommandLineFunctions.concat([]);this.addCommandLineFunction=function(functionName,commandLineFunction){commandLineFunctions.push([functionName,commandLineFunction]);};var commandHistoryCookieName="log4javascriptCommandHistory";this.storeCommandHistory=function(commandHistory){setCookie(commandHistoryCookieName,commandHistory.join(","));};var writeHtml=function(doc){var lines=getConsoleHtmlLines();doc.open();for(var i=0,len=lines.length;i<len;i++){doc.writeln(lines[i]);}
doc.close();};this.setEventTypes(["load","unload"]);var consoleWindowLoadHandler=function(){var win=getConsoleWindow();win.setAppender(appender);win.setNewestAtTop(newestMessageAtTop);win.setScrollToLatest(scrollToLatestMessage);win.setMaxMessages(maxMessages);win.setShowCommandLine(showCommandLine);win.setShowHideButton(showHideButton);win.setShowCloseButton(showCloseButton);win.setMainWindow(window);var storedValue=getCookie(commandHistoryCookieName);if(storedValue){win.commandHistory=storedValue.split(",");win.currentCommandIndex=win.commandHistory.length;}
appender.dispatchEvent("load",{"win":win});};this.unload=function(){logLog.debug("unload "+this+", caller: "+this.unload.caller);if(!consoleClosed){logLog.debug("really doing unload "+this);consoleClosed=true;consoleWindowLoaded=false;consoleWindowCreated=false;appender.dispatchEvent("unload",{});}};var pollConsoleWindow=function(windowTest,interval,successCallback,errorMessage){function doPoll(){try{if(consoleClosed){clearInterval(poll);}
if(windowTest(getConsoleWindow())){clearInterval(poll);successCallback();}}catch(ex){clearInterval(poll);isSupported=false;handleError(errorMessage,ex);}}
var poll=setInterval(doPoll,interval);};var getConsoleUrl=function(){var documentDomainSet=(document.domain!=location.hostname);return useDocumentWrite?"":getBaseUrl()+"console.html"+
(documentDomainSet?"?log4javascript_domain="+escape(document.domain):"");};if(inPage){var containerElement=null;var cssProperties=[];this.addCssProperty=function(name,value){if(checkCanConfigure("cssProperties")){cssProperties.push([name,value]);}};var windowCreationStarted=false;var iframeContainerDiv;var iframeId=uniqueId+"_InPageAppender_"+consoleAppenderId;this.hide=function(){if(initialized&&consoleWindowCreated){if(consoleWindowExists()){getConsoleWindow().$("command").blur();}
iframeContainerDiv.style.display="none";minimized=true;}};this.show=function(){if(initialized){if(consoleWindowCreated){iframeContainerDiv.style.display="block";this.setShowCommandLine(showCommandLine);minimized=false;}else if(!windowCreationStarted){createWindow(true);}}};this.isVisible=function(){return!minimized&&!consoleClosed;};this.close=function(fromButton){if(!consoleClosed&&(!fromButton||confirm("This will permanently remove the console from the page. No more messages will be logged. Do you wish to continue?"))){iframeContainerDiv.parentNode.removeChild(iframeContainerDiv);this.unload();}};open=function(){var initErrorMessage="InPageAppender.open: unable to create console iframe";function finalInit(){try{if(!initiallyMinimized){appender.show();}
consoleWindowLoadHandler();consoleWindowLoaded=true;appendQueuedLoggingEvents();}catch(ex){isSupported=false;handleError(initErrorMessage,ex);}}
function writeToDocument(){try{var windowTest=function(win){return isLoaded(win);};if(useDocumentWrite){writeHtml(getConsoleWindow().document);}
if(windowTest(getConsoleWindow())){finalInit();}else{pollConsoleWindow(windowTest,100,finalInit,initErrorMessage);}}catch(ex){isSupported=false;handleError(initErrorMessage,ex);}}
minimized=false;iframeContainerDiv=containerElement.appendChild(document.createElement("div"));iframeContainerDiv.style.width=width;iframeContainerDiv.style.height=height;iframeContainerDiv.style.border="solid gray 1px";for(var i=0,len=cssProperties.length;i<len;i++){iframeContainerDiv.style[cssProperties[i][0]]=cssProperties[i][1];}
var iframeSrc=useDocumentWrite?"":" src='"+getConsoleUrl()+"'";iframeContainerDiv.innerHTML="<iframe id='"+iframeId+"' name='"+iframeId+"' width='100%' height='100%' frameborder='0'"+iframeSrc+" scrolling='no'></iframe>";consoleClosed=false;var iframeDocumentExistsTest=function(win){try{return bool(win)&&bool(win.document);}catch(ex){return false;}};if(iframeDocumentExistsTest(getConsoleWindow())){writeToDocument();}else{pollConsoleWindow(iframeDocumentExistsTest,100,writeToDocument,initErrorMessage);}
consoleWindowCreated=true;};createWindow=function(show){if(show||!initiallyMinimized){var pageLoadHandler=function(){if(!container){containerElement=document.createElement("div");containerElement.style.position="fixed";containerElement.style.left="0";containerElement.style.right="0";containerElement.style.bottom="0";document.body.appendChild(containerElement);appender.addCssProperty("borderWidth","1px 0 0 0");appender.addCssProperty("zIndex",1000000);open();}else{try{var el=document.getElementById(container);if(el.nodeType==1){containerElement=el;}
open();}catch(ex){handleError("InPageAppender.init: invalid container element '"+container+"' supplied",ex);}}};if(pageLoaded&&container&&container.appendChild){containerElement=container;open();}else if(pageLoaded){pageLoadHandler();}else{log4javascript.addEventListener("load",pageLoadHandler);}
windowCreationStarted=true;}};init=function(){createWindow();initialized=true;};getConsoleWindow=function(){var iframe=window.frames[iframeId];if(iframe){return iframe;}};safeToAppend=function(){if(isSupported&&!consoleClosed){if(consoleWindowCreated&&!consoleWindowLoaded&&getConsoleWindow()&&isLoaded(getConsoleWindow())){consoleWindowLoaded=true;}
return consoleWindowLoaded;}
return false;};}else{var useOldPopUp=appender.defaults.useOldPopUp;var complainAboutPopUpBlocking=appender.defaults.complainAboutPopUpBlocking;var reopenWhenClosed=this.defaults.reopenWhenClosed;this.isUseOldPopUp=function(){return useOldPopUp;};this.setUseOldPopUp=function(useOldPopUpParam){if(checkCanConfigure("useOldPopUp")){useOldPopUp=bool(useOldPopUpParam);}};this.isComplainAboutPopUpBlocking=function(){return complainAboutPopUpBlocking;};this.setComplainAboutPopUpBlocking=function(complainAboutPopUpBlockingParam){if(checkCanConfigure("complainAboutPopUpBlocking")){complainAboutPopUpBlocking=bool(complainAboutPopUpBlockingParam);}};this.isFocusPopUp=function(){return focusConsoleWindow;};this.setFocusPopUp=function(focusPopUpParam){focusConsoleWindow=bool(focusPopUpParam);};this.isReopenWhenClosed=function(){return reopenWhenClosed;};this.setReopenWhenClosed=function(reopenWhenClosedParam){reopenWhenClosed=bool(reopenWhenClosedParam);};this.close=function(){logLog.debug("close "+this);try{popUp.close();this.unload();}catch(ex){}};this.hide=function(){logLog.debug("hide "+this);if(consoleWindowExists()){this.close();}};this.show=function(){logLog.debug("show "+this);if(!consoleWindowCreated){open();}};this.isVisible=function(){return safeToAppend();};var popUp;open=function(){var windowProperties="width="+width+",height="+height+",status,resizable";var frameInfo="";try{var frameEl=window.frameElement;if(frameEl){frameInfo="_"+frameEl.tagName+"_"+(frameEl.name||frameEl.id||"");}}catch(e){frameInfo="_inaccessibleParentFrame";}
var windowName="PopUp_"+location.host.replace(/[^a-z0-9]/gi,"_")+"_"+consoleAppenderId+frameInfo;if(!useOldPopUp||!useDocumentWrite){windowName=windowName+"_"+uniqueId;}
var checkPopUpClosed=function(win){if(consoleClosed){return true;}else{try{return bool(win)&&win.closed;}catch(ex){}}
return false;};var popUpClosedCallback=function(){if(!consoleClosed){appender.unload();}};function finalInit(){getConsoleWindow().setCloseIfOpenerCloses(!useOldPopUp||!useDocumentWrite);consoleWindowLoadHandler();consoleWindowLoaded=true;appendQueuedLoggingEvents();pollConsoleWindow(checkPopUpClosed,500,popUpClosedCallback,"PopUpAppender.checkPopUpClosed: error checking pop-up window");}
try{popUp=window.open(getConsoleUrl(),windowName,windowProperties);consoleClosed=false;consoleWindowCreated=true;if(popUp&&popUp.document){if(useDocumentWrite&&useOldPopUp&&isLoaded(popUp)){popUp.mainPageReloaded();finalInit();}else{if(useDocumentWrite){writeHtml(popUp.document);}
var popUpLoadedTest=function(win){return bool(win)&&isLoaded(win);};if(isLoaded(popUp)){finalInit();}else{pollConsoleWindow(popUpLoadedTest,100,finalInit,"PopUpAppender.init: unable to create console window");}}}else{isSupported=false;logLog.warn("PopUpAppender.init: pop-ups blocked, please unblock to use PopUpAppender");if(complainAboutPopUpBlocking){handleError("log4javascript: pop-up windows appear to be blocked. Please unblock them to use pop-up logging.");}}}catch(ex){handleError("PopUpAppender.init: error creating pop-up",ex);}};createWindow=function(){if(!initiallyMinimized){open();}};init=function(){createWindow();initialized=true;};getConsoleWindow=function(){return popUp;};safeToAppend=function(){if(isSupported&&!isUndefined(popUp)&&!consoleClosed){if(popUp.closed||(consoleWindowLoaded&&isUndefined(popUp.closed))){appender.unload();logLog.debug("PopUpAppender: pop-up closed");return false;}
if(!consoleWindowLoaded&&isLoaded(popUp)){consoleWindowLoaded=true;}}
return isSupported&&consoleWindowLoaded&&!consoleClosed;};}
this.getConsoleWindow=getConsoleWindow;};ConsoleAppender.addGlobalCommandLineFunction=function(functionName,commandLineFunction){defaultCommandLineFunctions.push([functionName,commandLineFunction]);};function PopUpAppender(lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(false,null,lazyInit,initiallyMinimized,useDocumentWrite,width,height,this.defaults.focusPopUp);}
PopUpAppender.prototype=new ConsoleAppender();PopUpAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:false,focusPopUp:false,lazyInit:true,useOldPopUp:true,complainAboutPopUpBlocking:true,newestMessageAtTop:false,scrollToLatestMessage:true,width:"600",height:"400",reopenWhenClosed:false,maxMessages:null,showCommandLine:true,commandLineObjectExpansionDepth:1,showHideButton:false,showCloseButton:true,useDocumentWrite:true};PopUpAppender.prototype.toString=function(){return"PopUpAppender";};log4javascript.PopUpAppender=PopUpAppender;function InPageAppender(container,lazyInit,initiallyMinimized,useDocumentWrite,width,height){this.create(true,container,lazyInit,initiallyMinimized,useDocumentWrite,width,height,false);}
InPageAppender.prototype=new ConsoleAppender();InPageAppender.prototype.defaults={layout:new PatternLayout("%d{HH:mm:ss} %-5p - %m{1}%n"),initiallyMinimized:false,lazyInit:true,newestMessageAtTop:false,scrollToLatestMessage:true,width:"100%",height:"220px",maxMessages:null,showCommandLine:true,commandLineObjectExpansionDepth:1,showHideButton:false,showCloseButton:false,showLogEntryDeleteButtons:true,useDocumentWrite:true};InPageAppender.prototype.toString=function(){return"InPageAppender";};log4javascript.InPageAppender=InPageAppender;log4javascript.InlineAppender=InPageAppender;})();function padWithSpaces(str,len){if(str.length<len){var spaces=[];var numberOfSpaces=Math.max(0,len-str.length);for(var i=0;i<numberOfSpaces;i++){spaces[i]=" ";}
str+=spaces.join("");}
return str;}
(function(){function dir(obj){var maxLen=0;for(var p in obj){maxLen=Math.max(toStr(p).length,maxLen);}
var propList=[];for(p in obj){var propNameStr="  "+padWithSpaces(toStr(p),maxLen+2);var propVal;try{propVal=splitIntoLines(toStr(obj[p])).join(padWithSpaces(newLine,maxLen+6));}catch(ex){propVal="[Error obtaining property. Details: "+getExceptionMessage(ex)+"]";}
propList.push(propNameStr+propVal);}
return propList.join(newLine);}
var nodeTypes={ELEMENT_NODE:1,ATTRIBUTE_NODE:2,TEXT_NODE:3,CDATA_SECTION_NODE:4,ENTITY_REFERENCE_NODE:5,ENTITY_NODE:6,PROCESSING_INSTRUCTION_NODE:7,COMMENT_NODE:8,DOCUMENT_NODE:9,DOCUMENT_TYPE_NODE:10,DOCUMENT_FRAGMENT_NODE:11,NOTATION_NODE:12};var preFormattedElements=["script","pre"];var emptyElements=["br","img","hr","param","link","area","input","col","base","meta"];var indentationUnit="  ";function getXhtml(rootNode,includeRootNode,indentation,startNewLine,preformatted){includeRootNode=(typeof includeRootNode=="undefined")?true:!!includeRootNode;if(typeof indentation!="string"){indentation="";}
startNewLine=!!startNewLine;preformatted=!!preformatted;var xhtml;function isWhitespace(node){return((node.nodeType==nodeTypes.TEXT_NODE)&&/^[ \t\r\n]*$/.test(node.nodeValue));}
function fixAttributeValue(attrValue){return attrValue.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;");}
function getStyleAttributeValue(el){var stylePairs=el.style.cssText.split(";");var styleValue="";for(var j=0,len=stylePairs.length;j<len;j++){var nameValueBits=stylePairs[j].split(":");var props=[];if(!/^\s*$/.test(nameValueBits[0])){props.push(trim(nameValueBits[0]).toLowerCase()+":"+trim(nameValueBits[1]));}
styleValue=props.join(";");}
return styleValue;}
function getNamespace(el){if(el.prefix){return el.prefix;}else if(el.outerHTML){var regex=new RegExp("<([^:]+):"+el.tagName+"[^>]*>","i");if(regex.test(el.outerHTML)){return RegExp.$1.toLowerCase();}}
return"";}
var lt="<";var gt=">";var i,len;if(includeRootNode&&rootNode.nodeType!=nodeTypes.DOCUMENT_FRAGMENT_NODE){switch(rootNode.nodeType){case nodeTypes.ELEMENT_NODE:var tagName=rootNode.tagName.toLowerCase();xhtml=startNewLine?newLine+indentation:"";xhtml+=lt;var prefix=getNamespace(rootNode);var hasPrefix=!!prefix;if(hasPrefix){xhtml+=prefix+":";}
xhtml+=tagName;for(i=0,len=rootNode.attributes.length;i<len;i++){var currentAttr=rootNode.attributes[i];if(!currentAttr.specified||currentAttr.nodeValue===null||currentAttr.nodeName.toLowerCase()==="style"||typeof currentAttr.nodeValue!=="string"||currentAttr.nodeName.indexOf("_moz")===0){continue;}
xhtml+=" "+currentAttr.nodeName.toLowerCase()+"=\"";xhtml+=fixAttributeValue(currentAttr.nodeValue);xhtml+="\"";}
if(rootNode.style.cssText){var styleValue=getStyleAttributeValue(rootNode);if(styleValue!==""){xhtml+=" style=\""+getStyleAttributeValue(rootNode)+"\"";}}
if(array_contains(emptyElements,tagName)||(hasPrefix&&!rootNode.hasChildNodes())){xhtml+="/"+gt;}else{xhtml+=gt;var childStartNewLine=!(rootNode.childNodes.length===1&&rootNode.childNodes[0].nodeType===nodeTypes.TEXT_NODE);var childPreformatted=array_contains(preFormattedElements,tagName);for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation+indentationUnit,childStartNewLine,childPreformatted);}
var endTag=lt+"/"+tagName+gt;xhtml+=childStartNewLine?newLine+indentation+endTag:endTag;}
return xhtml;case nodeTypes.TEXT_NODE:if(isWhitespace(rootNode)){xhtml="";}else{if(preformatted){xhtml=rootNode.nodeValue;}else{var lines=splitIntoLines(trim(rootNode.nodeValue));var trimmedLines=[];for(i=0,len=lines.length;i<len;i++){trimmedLines[i]=trim(lines[i]);}
xhtml=trimmedLines.join(newLine+indentation);}
if(startNewLine){xhtml=newLine+indentation+xhtml;}}
return xhtml;case nodeTypes.CDATA_SECTION_NODE:return"<![CDA"+"TA["+rootNode.nodeValue+"]"+"]>"+newLine;case nodeTypes.DOCUMENT_NODE:xhtml="";for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation);}
return xhtml;default:return"";}}else{xhtml="";for(i=0,len=rootNode.childNodes.length;i<len;i++){xhtml+=getXhtml(rootNode.childNodes[i],true,indentation+indentationUnit);}
return xhtml;}}
function createCommandLineFunctions(){ConsoleAppender.addGlobalCommandLineFunction("$",function(appender,args,returnValue){return document.getElementById(args[0]);});ConsoleAppender.addGlobalCommandLineFunction("dir",function(appender,args,returnValue){var lines=[];for(var i=0,len=args.length;i<len;i++){lines[i]=dir(args[i]);}
return lines.join(newLine+newLine);});ConsoleAppender.addGlobalCommandLineFunction("dirxml",function(appender,args,returnValue){var lines=[];for(var i=0,len=args.length;i<len;i++){lines[i]=getXhtml(args[i]);}
return lines.join(newLine+newLine);});ConsoleAppender.addGlobalCommandLineFunction("cd",function(appender,args,returnValue){var win,message;if(args.length===0||args[0]===""){win=window;message="Command line set to run in main window";}else{if(args[0].window==args[0]){win=args[0];message="Command line set to run in frame '"+args[0].name+"'";}else{win=window.frames[args[0]];if(win){message="Command line set to run in frame '"+args[0]+"'";}else{returnValue.isError=true;message="Frame '"+args[0]+"' does not exist";win=appender.getCommandWindow();}}}
appender.setCommandWindow(win);return message;});ConsoleAppender.addGlobalCommandLineFunction("clear",function(appender,args,returnValue){returnValue.appendResult=false;appender.clear();});ConsoleAppender.addGlobalCommandLineFunction("keys",function(appender,args,returnValue){var keys=[];for(var k in args[0]){keys.push(k);}
return keys;});ConsoleAppender.addGlobalCommandLineFunction("values",function(appender,args,returnValue){var values=[];for(var k in args[0]){try{values.push(args[0][k]);}catch(ex){logLog.warn("values(): Unable to obtain value for key "+k+". Details: "+getExceptionMessage(ex));}}
return values;});ConsoleAppender.addGlobalCommandLineFunction("expansionDepth",function(appender,args,returnValue){var expansionDepth=parseInt(args[0],10);if(isNaN(expansionDepth)||expansionDepth<0){returnValue.isError=true;return""+args[0]+" is not a valid expansion depth";}else{appender.setCommandLineObjectExpansionDepth(expansionDepth);return"Object expansion depth set to "+expansionDepth;}});}
function init(){createCommandLineFunctions();}
init();})();function createDefaultLogger(){var logger=log4javascript.getLogger(defaultLoggerName);var a=new log4javascript.PopUpAppender();logger.addAppender(a);return logger;}
log4javascript.setDocumentReady=function(){pageLoaded=true;log4javascript.dispatchEvent("load",{});};if(window.addEventListener){window.addEventListener("load",log4javascript.setDocumentReady,false);}else if(window.attachEvent){window.attachEvent("onload",log4javascript.setDocumentReady);}else{var oldOnload=window.onload;if(typeof window.onload!="function"){window.onload=log4javascript.setDocumentReady;}else{window.onload=function(evt){if(oldOnload){oldOnload(evt);}
log4javascript.setDocumentReady();};}}
return log4javascript;},this);

},{}],4:[function(require,module,exports){
!function(t,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):"object"==typeof exports?exports.MessageFormat=r():t.MessageFormat=r()}(this,function(){return function(t){var r={};function e(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=r,e.d=function(t,r,n){e.o(t,r)||Object.defineProperty(t,r,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,r){if(1&r&&(t=e(t)),8&r)return t;if(4&r&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&r&&"string"!=typeof t)for(var o in t)e.d(n,o,function(r){return t[r]}.bind(null,o));return n},e.n=function(t){var r=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(r,"a",r),r},e.o=function(t,r){return Object.prototype.hasOwnProperty.call(t,r)},e.p="",e(e.s=8)}([function(t,r,e){var n,o;void 0===(o="function"==typeof(n={af:function(t,r){return r?"other":1==t?"one":"other"},ak:function(t,r){return r?"other":0==t||1==t?"one":"other"},am:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ar:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":0==t?"zero":1==t?"one":2==t?"two":o>=3&&o<=10?"few":o>=11&&o<=99?"many":"other"},ars:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":0==t?"zero":1==t?"one":2==t?"two":o>=3&&o<=10?"few":o>=11&&o<=99?"many":"other"},as:function(t,r){return r?1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},asa:function(t,r){return r?"other":1==t?"one":"other"},ast:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},az:function(t,r){var e=String(t).split("."),n=e[0],o=n.slice(-1),i=n.slice(-2),u=n.slice(-3);return r?1==o||2==o||5==o||7==o||8==o||20==i||50==i||70==i||80==i?"one":3==o||4==o||100==u||200==u||300==u||400==u||500==u||600==u||700==u||800==u||900==u?"few":0==n||6==o||40==i||60==i||90==i?"many":"other":1==t?"one":"other"},be:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2);return r?2!=o&&3!=o||12==i||13==i?"other":"few":1==o&&11!=i?"one":o>=2&&o<=4&&(i<12||i>14)?"few":n&&0==o||o>=5&&o<=9||i>=11&&i<=14?"many":"other"},bem:function(t,r){return r?"other":1==t?"one":"other"},bez:function(t,r){return r?"other":1==t?"one":"other"},bg:function(t,r){return r?"other":1==t?"one":"other"},bh:function(t,r){return r?"other":0==t||1==t?"one":"other"},bm:function(t,r){return"other"},bn:function(t,r){return r?1==t||5==t||7==t||8==t||9==t||10==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},bo:function(t,r){return"other"},br:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2),u=n&&e[0].slice(-6);return r?"other":1==o&&11!=i&&71!=i&&91!=i?"one":2==o&&12!=i&&72!=i&&92!=i?"two":(3==o||4==o||9==o)&&(i<10||i>19)&&(i<70||i>79)&&(i<90||i>99)?"few":0!=t&&n&&0==u?"many":"other"},brx:function(t,r){return r?"other":1==t?"one":"other"},bs:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},ca:function(t,r){var e=String(t).split("."),n=!e[1];return r?1==t||3==t?"one":2==t?"two":4==t?"few":"other":1==t&&n?"one":"other"},ce:function(t,r){return r?"other":1==t?"one":"other"},cgg:function(t,r){return r?"other":1==t?"one":"other"},chr:function(t,r){return r?"other":1==t?"one":"other"},ckb:function(t,r){return r?"other":1==t?"one":"other"},cs:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1];return r?"other":1==t&&o?"one":n>=2&&n<=4&&o?"few":o?"other":"many"},cy:function(t,r){return r?0==t||7==t||8==t||9==t?"zero":1==t?"one":2==t?"two":3==t||4==t?"few":5==t||6==t?"many":"other":0==t?"zero":1==t?"one":2==t?"two":3==t?"few":6==t?"many":"other"},da:function(t,r){var e=String(t).split("."),n=e[0],o=Number(e[0])==t;return r?"other":1!=t&&(o||0!=n&&1!=n)?"other":"one"},de:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},dsb:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-2),a=o.slice(-2);return r?"other":i&&1==u||1==a?"one":i&&2==u||2==a?"two":i&&(3==u||4==u)||3==a||4==a?"few":"other"},dv:function(t,r){return r?"other":1==t?"one":"other"},dz:function(t,r){return"other"},ee:function(t,r){return r?"other":1==t?"one":"other"},el:function(t,r){return r?"other":1==t?"one":"other"},en:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?1==i&&11!=u?"one":2==i&&12!=u?"two":3==i&&13!=u?"few":"other":1==t&&n?"one":"other"},eo:function(t,r){return r?"other":1==t?"one":"other"},es:function(t,r){return r?"other":1==t?"one":"other"},et:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},eu:function(t,r){return r?"other":1==t?"one":"other"},fa:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ff:function(t,r){return r?"other":t>=0&&t<2?"one":"other"},fi:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},fil:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=o.slice(-1);return r?1==t?"one":"other":i&&(1==n||2==n||3==n)||i&&4!=u&&6!=u&&9!=u||!i&&4!=a&&6!=a&&9!=a?"one":"other"},fo:function(t,r){return r?"other":1==t?"one":"other"},fr:function(t,r){return r?1==t?"one":"other":t>=0&&t<2?"one":"other"},fur:function(t,r){return r?"other":1==t?"one":"other"},fy:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},ga:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t?"one":"other":1==t?"one":2==t?"two":n&&t>=3&&t<=6?"few":n&&t>=7&&t<=10?"many":"other"},gd:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t||11==t?"one":2==t||12==t?"two":3==t||13==t?"few":"other":1==t||11==t?"one":2==t||12==t?"two":n&&t>=3&&t<=10||n&&t>=13&&t<=19?"few":"other"},gl:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},gsw:function(t,r){return r?"other":1==t?"one":"other"},gu:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},guw:function(t,r){return r?"other":0==t||1==t?"one":"other"},gv:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i?"one":o&&2==i?"two":!o||0!=u&&20!=u&&40!=u&&60!=u&&80!=u?o?"other":"many":"few"},ha:function(t,r){return r?"other":1==t?"one":"other"},haw:function(t,r){return r?"other":1==t?"one":"other"},he:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1);return r?"other":1==t&&o?"one":2==n&&o?"two":o&&(t<0||t>10)&&i&&0==u?"many":"other"},hi:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":t>=0&&t<=1?"one":"other"},hr:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},hsb:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-2),a=o.slice(-2);return r?"other":i&&1==u||1==a?"one":i&&2==u||2==a?"two":i&&(3==u||4==u)||3==a||4==a?"few":"other"},hu:function(t,r){return r?1==t||5==t?"one":"other":1==t?"one":"other"},hy:function(t,r){return r?1==t?"one":"other":t>=0&&t<2?"one":"other"},ia:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},id:function(t,r){return"other"},ig:function(t,r){return"other"},ii:function(t,r){return"other"},in:function(t,r){return"other"},io:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},is:function(t,r){var e=String(t).split("."),n=e[0],o=Number(e[0])==t,i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i&&11!=u||!o?"one":"other"},it:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},iu:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},iw:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1);return r?"other":1==t&&o?"one":2==n&&o?"two":o&&(t<0||t>10)&&i&&0==u?"many":"other"},ja:function(t,r){return"other"},jbo:function(t,r){return"other"},jgo:function(t,r){return r?"other":1==t?"one":"other"},ji:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},jmc:function(t,r){return r?"other":1==t?"one":"other"},jv:function(t,r){return"other"},jw:function(t,r){return"other"},ka:function(t,r){var e=String(t).split("."),n=e[0],o=n.slice(-2);return r?1==n?"one":0==n||o>=2&&o<=20||40==o||60==o||80==o?"many":"other":1==t?"one":"other"},kab:function(t,r){return r?"other":t>=0&&t<2?"one":"other"},kaj:function(t,r){return r?"other":1==t?"one":"other"},kcg:function(t,r){return r?"other":1==t?"one":"other"},kde:function(t,r){return"other"},kea:function(t,r){return"other"},kk:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1);return r?6==o||9==o||n&&0==o&&0!=t?"many":"other":1==t?"one":"other"},kkj:function(t,r){return r?"other":1==t?"one":"other"},kl:function(t,r){return r?"other":1==t?"one":"other"},km:function(t,r){return"other"},kn:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"},ko:function(t,r){return"other"},ks:function(t,r){return r?"other":1==t?"one":"other"},ksb:function(t,r){return r?"other":1==t?"one":"other"},ksh:function(t,r){return r?"other":0==t?"zero":1==t?"one":"other"},ku:function(t,r){return r?"other":1==t?"one":"other"},kw:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},ky:function(t,r){return r?"other":1==t?"one":"other"},lag:function(t,r){var e=String(t).split("."),n=e[0];return r?"other":0==t?"zero":0!=n&&1!=n||0==t?"other":"one"},lb:function(t,r){return r?"other":1==t?"one":"other"},lg:function(t,r){return r?"other":1==t?"one":"other"},lkt:function(t,r){return"other"},ln:function(t,r){return r?"other":0==t||1==t?"one":"other"},lo:function(t,r){return r&&1==t?"one":"other"},lt:function(t,r){var e=String(t).split("."),n=e[1]||"",o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?"other":1==i&&(u<11||u>19)?"one":i>=2&&i<=9&&(u<11||u>19)?"few":0!=n?"many":"other"},lv:function(t,r){var e=String(t).split("."),n=e[1]||"",o=n.length,i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-2),h=n.slice(-1);return r?"other":i&&0==u||a>=11&&a<=19||2==o&&c>=11&&c<=19?"zero":1==u&&11!=a||2==o&&1==h&&11!=c||2!=o&&1==h?"one":"other"},mas:function(t,r){return r?"other":1==t?"one":"other"},mg:function(t,r){return r?"other":0==t||1==t?"one":"other"},mgo:function(t,r){return r?"other":1==t?"one":"other"},mk:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?1==u&&11!=a?"one":2==u&&12!=a?"two":7!=u&&8!=u||17==a||18==a?"other":"many":i&&1==u&&11!=a||1==c&&11!=h?"one":"other"},ml:function(t,r){return r?"other":1==t?"one":"other"},mn:function(t,r){return r?"other":1==t?"one":"other"},mo:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-2);return r?1==t?"one":"other":1==t&&n?"one":!n||0==t||1!=t&&i>=1&&i<=19?"few":"other"},mr:function(t,r){return r?1==t?"one":2==t||3==t?"two":4==t?"few":"other":t>=0&&t<=1?"one":"other"},ms:function(t,r){return r&&1==t?"one":"other"},mt:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-2);return r?"other":1==t?"one":0==t||o>=2&&o<=10?"few":o>=11&&o<=19?"many":"other"},my:function(t,r){return"other"},nah:function(t,r){return r?"other":1==t?"one":"other"},naq:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},nb:function(t,r){return r?"other":1==t?"one":"other"},nd:function(t,r){return r?"other":1==t?"one":"other"},ne:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?n&&t>=1&&t<=4?"one":"other":1==t?"one":"other"},nl:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},nn:function(t,r){return r?"other":1==t?"one":"other"},nnh:function(t,r){return r?"other":1==t?"one":"other"},no:function(t,r){return r?"other":1==t?"one":"other"},nqo:function(t,r){return"other"},nr:function(t,r){return r?"other":1==t?"one":"other"},nso:function(t,r){return r?"other":0==t||1==t?"one":"other"},ny:function(t,r){return r?"other":1==t?"one":"other"},nyn:function(t,r){return r?"other":1==t?"one":"other"},om:function(t,r){return r?"other":1==t?"one":"other"},or:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?1==t||5==t||n&&t>=7&&t<=9?"one":2==t||3==t?"two":4==t?"few":6==t?"many":"other":1==t?"one":"other"},os:function(t,r){return r?"other":1==t?"one":"other"},pa:function(t,r){return r?"other":0==t||1==t?"one":"other"},pap:function(t,r){return r?"other":1==t?"one":"other"},pl:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":1==t&&o?"one":o&&i>=2&&i<=4&&(u<12||u>14)?"few":o&&1!=n&&(0==i||1==i)||o&&i>=5&&i<=9||o&&u>=12&&u<=14?"many":"other"},prg:function(t,r){var e=String(t).split("."),n=e[1]||"",o=n.length,i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-2),h=n.slice(-1);return r?"other":i&&0==u||a>=11&&a<=19||2==o&&c>=11&&c<=19?"zero":1==u&&11!=a||2==o&&1==h&&11!=c||2!=o&&1==h?"one":"other"},ps:function(t,r){return r?"other":1==t?"one":"other"},pt:function(t,r){var e=String(t).split("."),n=e[0];return r?"other":0==n||1==n?"one":"other"},"pt-PT":function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},rm:function(t,r){return r?"other":1==t?"one":"other"},ro:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-2);return r?1==t?"one":"other":1==t&&n?"one":!n||0==t||1!=t&&i>=1&&i<=19?"few":"other"},rof:function(t,r){return r?"other":1==t?"one":"other"},root:function(t,r){return"other"},ru:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-1),u=n.slice(-2);return r?"other":o&&1==i&&11!=u?"one":o&&i>=2&&i<=4&&(u<12||u>14)?"few":o&&0==i||o&&i>=5&&i<=9||o&&u>=11&&u<=14?"many":"other"},rwk:function(t,r){return r?"other":1==t?"one":"other"},sah:function(t,r){return"other"},saq:function(t,r){return r?"other":1==t?"one":"other"},sc:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},scn:function(t,r){var e=String(t).split("."),n=!e[1];return r?11==t||8==t||80==t||800==t?"many":"other":1==t&&n?"one":"other"},sd:function(t,r){return r?"other":1==t?"one":"other"},sdh:function(t,r){return r?"other":1==t?"one":"other"},se:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},seh:function(t,r){return r?"other":1==t?"one":"other"},ses:function(t,r){return"other"},sg:function(t,r){return"other"},sh:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},shi:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?"other":t>=0&&t<=1?"one":n&&t>=2&&t<=10?"few":"other"},si:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"";return r?"other":0==t||1==t||0==n&&1==o?"one":"other"},sk:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1];return r?"other":1==t&&o?"one":n>=2&&n<=4&&o?"few":o?"other":"many"},sl:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=n.slice(-2);return r?"other":o&&1==i?"one":o&&2==i?"two":o&&(3==i||4==i)||!o?"few":"other"},sma:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smi:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smj:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},smn:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},sms:function(t,r){return r?"other":1==t?"one":2==t?"two":"other"},sn:function(t,r){return r?"other":1==t?"one":"other"},so:function(t,r){return r?"other":1==t?"one":"other"},sq:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1),i=n&&e[0].slice(-2);return r?1==t?"one":4==o&&14!=i?"many":"other":1==t?"one":"other"},sr:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=n.slice(-2),c=o.slice(-1),h=o.slice(-2);return r?"other":i&&1==u&&11!=a||1==c&&11!=h?"one":i&&u>=2&&u<=4&&(a<12||a>14)||c>=2&&c<=4&&(h<12||h>14)?"few":"other"},ss:function(t,r){return r?"other":1==t?"one":"other"},ssy:function(t,r){return r?"other":1==t?"one":"other"},st:function(t,r){return r?"other":1==t?"one":"other"},sv:function(t,r){var e=String(t).split("."),n=!e[1],o=Number(e[0])==t,i=o&&e[0].slice(-1),u=o&&e[0].slice(-2);return r?1!=i&&2!=i||11==u||12==u?"other":"one":1==t&&n?"one":"other"},sw:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},syr:function(t,r){return r?"other":1==t?"one":"other"},ta:function(t,r){return r?"other":1==t?"one":"other"},te:function(t,r){return r?"other":1==t?"one":"other"},teo:function(t,r){return r?"other":1==t?"one":"other"},th:function(t,r){return"other"},ti:function(t,r){return r?"other":0==t||1==t?"one":"other"},tig:function(t,r){return r?"other":1==t?"one":"other"},tk:function(t,r){var e=String(t).split("."),n=Number(e[0])==t,o=n&&e[0].slice(-1);return r?6==o||9==o||10==t?"few":"other":1==t?"one":"other"},tl:function(t,r){var e=String(t).split("."),n=e[0],o=e[1]||"",i=!e[1],u=n.slice(-1),a=o.slice(-1);return r?1==t?"one":"other":i&&(1==n||2==n||3==n)||i&&4!=u&&6!=u&&9!=u||!i&&4!=a&&6!=a&&9!=a?"one":"other"},tn:function(t,r){return r?"other":1==t?"one":"other"},to:function(t,r){return"other"},tr:function(t,r){return r?"other":1==t?"one":"other"},ts:function(t,r){return r?"other":1==t?"one":"other"},tzm:function(t,r){var e=String(t).split("."),n=Number(e[0])==t;return r?"other":0==t||1==t||n&&t>=11&&t<=99?"one":"other"},ug:function(t,r){return r?"other":1==t?"one":"other"},uk:function(t,r){var e=String(t).split("."),n=e[0],o=!e[1],i=Number(e[0])==t,u=i&&e[0].slice(-1),a=i&&e[0].slice(-2),c=n.slice(-1),h=n.slice(-2);return r?3==u&&13!=a?"few":"other":o&&1==c&&11!=h?"one":o&&c>=2&&c<=4&&(h<12||h>14)?"few":o&&0==c||o&&c>=5&&c<=9||o&&h>=11&&h<=14?"many":"other"},ur:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},uz:function(t,r){return r?"other":1==t?"one":"other"},ve:function(t,r){return r?"other":1==t?"one":"other"},vi:function(t,r){return r&&1==t?"one":"other"},vo:function(t,r){return r?"other":1==t?"one":"other"},vun:function(t,r){return r?"other":1==t?"one":"other"},wa:function(t,r){return r?"other":0==t||1==t?"one":"other"},wae:function(t,r){return r?"other":1==t?"one":"other"},wo:function(t,r){return"other"},xh:function(t,r){return r?"other":1==t?"one":"other"},xog:function(t,r){return r?"other":1==t?"one":"other"},yi:function(t,r){var e=String(t).split("."),n=!e[1];return r?"other":1==t&&n?"one":"other"},yo:function(t,r){return"other"},yue:function(t,r){return"other"},zh:function(t,r){return"other"},zu:function(t,r){return r?"other":t>=0&&t<=1?"one":"other"}})?n.call(r,e,r,t):n)||(t.exports=o)},function(t,r,e){t.exports={date:e(4),duration:e(5),number:e(6),time:e(7)}},function(t,r,e){"use strict";function n(t,r,e,o){this.message=t,this.expected=r,this.found=e,this.location=o,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,n)}!function(t,r){function e(){this.constructor=t}e.prototype=r.prototype,t.prototype=new e}(n,Error),n.buildMessage=function(t,r){var e={literal:function(t){return'"'+o(t.text)+'"'},class:function(t){var r,e="";for(r=0;r<t.parts.length;r++)e+=t.parts[r]instanceof Array?i(t.parts[r][0])+"-"+i(t.parts[r][1]):i(t.parts[r]);return"["+(t.inverted?"^":"")+e+"]"},any:function(t){return"any character"},end:function(t){return"end of input"},other:function(t){return t.description}};function n(t){return t.charCodeAt(0).toString(16).toUpperCase()}function o(t){return t.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}function i(t){return t.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(t){return"\\x0"+n(t)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(t){return"\\x"+n(t)})}return"Expected "+function(t){var r,n,o,i=new Array(t.length);for(r=0;r<t.length;r++)i[r]=(o=t[r],e[o.type](o));if(i.sort(),i.length>0){for(r=1,n=1;r<i.length;r++)i[r-1]!==i[r]&&(i[n]=i[r],n++);i.length=n}switch(i.length){case 1:return i[0];case 2:return i[0]+" or "+i[1];default:return i.slice(0,-1).join(", ")+", or "+i[i.length-1]}}(t)+" but "+function(t){return t?'"'+o(t)+'"':"end of input"}(r)+" found."},t.exports={SyntaxError:n,parse:function(t,r){r=void 0!==r?r:{};var e,o={},i={start:tr},u=tr,a="#",c=It("#",!1),h=function(){return pr[0]},f=function(){return{type:"octothorpe"}},s=function(t){return t.join("")},l="{",p=It("{",!1),m="}",d=It("}",!1),y=function(t){return{type:"argument",arg:t}},g=",",v=It(",",!1),w="select",b=It("select",!1),S=function(t,e){return r.strict&&pr.unshift(!1),e},k=function(t,e){return r.strict&&pr.shift(),{type:"select",arg:t,cases:e}},x="plural",A=It("plural",!1),j="selectordinal",N=It("selectordinal",!1),C=function(t,r){return pr.unshift(!0),r},F=function(t,e,n,o){var i=("selectordinal"===e?r.ordinal:r.cardinal)||["zero","one","two","few","many","other"];return i&&i.length&&o.forEach(function(r){if(isNaN(r.key)&&i.indexOf(r.key)<0)throw new Error("Invalid key `"+r.key+"` for argument `"+t+"`. Valid "+e+" keys for this locale are `"+i.join("`, `")+"`, and explicit keys like `=0`.")}),pr.shift(),{type:e,arg:t,offset:n||0,cases:o}},O=function(t,r,e){return{type:"function",arg:t,key:r,param:e}},E=Vt("identifier"),z=/^[^\t-\r \x85\u200E\u200F\u2028\u2029!-\/:-@[-\^`{-~\xA1-\xA7\xA9\xAB\xAC\xAE\xB0\xB1\xB6\xBB\xBF\xD7\xF7\u2010-\u2027\u2030-\u203E\u2041-\u2053\u2055-\u205E\u2190-\u245F\u2500-\u2775\u2794-\u2BFF\u2E00-\u2E7F\u3001-\u3003\u3008-\u3020\u3030\uFD3E\uFD3F\uFE45\uFE46]/,P=Yt([["\t","\r"]," ","","‎","‏","\u2028","\u2029",["!","/"],[":","@"],["[","^"],"`",["{","~"],["¡","§"],"©","«","¬","®","°","±","¶","»","¿","×","÷",["‐","‧"],["‰","‾"],["⁁","⁓"],["⁕","⁞"],["←","⑟"],["─","❵"],["➔","⯿"],["⸀","⹿"],["、","〃"],["〈","〠"],"〰","﴾","﴿","﹅","﹆"],!0,!1),L=function(t,r){return{key:t,tokens:r}},J=function(t){return t},D=Vt("plural offset"),M="offset",_=It("offset",!1),T=":",R=It(":",!1),B=function(t){return t},q="=",$=It("=",!1),K="number",G=It("number",!1),U="date",Z=It("date",!1),I="time",Y=It("time",!1),V="spellout",W=It("spellout",!1),H="ordinal",Q=It("ordinal",!1),X="duration",tt=It("duration",!1),rt=function(t){if(r.strict||/^\d/.test(t))return!1;switch(t.toLowerCase()){case"select":case"plural":case"selectordinal":return!1;default:return!0}},et=function(t){return t},nt=function(t){return!r.strict},ot=function(t){return{tokens:t}},it=function(t){return{tokens:[t.join("")]}},ut=Vt("a valid (strict) function parameter"),at=/^[^'{}]/,ct=Yt(["'","{","}"],!0,!1),ht=function(t){return t.join("")},ft="'",st=It("'",!1),lt=function(t){return t},pt=function(t){return"{"+t.join("")+"}"},mt=Vt("doubled apostrophe"),dt="''",yt=It("''",!1),gt=function(){return"'"},vt=/^[^']/,wt=Yt(["'"],!0,!1),bt="'{",St=It("'{",!1),kt=function(t){return"{"+t.join("")},xt="'}",At=It("'}",!1),jt=function(t){return"}"+t.join("")},Nt=Vt("escaped string"),Ct="'#",Ft=It("'#",!1),Ot=function(t){return"#"+t.join("")},Et=function(t){return t[0]},zt=Vt("plain char"),Pt=/^[^{}#\0-\x08\x0E-\x1F\x7F]/,Lt=Yt(["{","}","#",["\0","\b"],["",""],""],!0,!1),Jt=function(t){return!pr[0]},Dt=function(t){return t},Mt=Vt("integer"),_t=/^[0-9]/,Tt=Yt([["0","9"]],!1,!1),Rt=Vt("white space"),Bt=/^[\t-\r \x85\u200E\u200F\u2028\u2029]/,qt=Yt([["\t","\r"]," ","","‎","‏","\u2028","\u2029"],!1,!1),$t=0,Kt=[{line:1,column:1}],Gt=0,Ut=[],Zt=0;if("startRule"in r){if(!(r.startRule in i))throw new Error("Can't start parsing from rule \""+r.startRule+'".');u=i[r.startRule]}function It(t,r){return{type:"literal",text:t,ignoreCase:r}}function Yt(t,r,e){return{type:"class",parts:t,inverted:r,ignoreCase:e}}function Vt(t){return{type:"other",description:t}}function Wt(r){var e,n=Kt[r];if(n)return n;for(e=r-1;!Kt[e];)e--;for(n={line:(n=Kt[e]).line,column:n.column};e<r;)10===t.charCodeAt(e)?(n.line++,n.column=1):n.column++,e++;return Kt[r]=n,n}function Ht(t,r){var e=Wt(t),n=Wt(r);return{start:{offset:t,line:e.line,column:e.column},end:{offset:r,line:n.line,column:n.column}}}function Qt(t){$t<Gt||($t>Gt&&(Gt=$t,Ut=[]),Ut.push(t))}function Xt(t,r,e){return new n(n.buildMessage(t,r),t,r,e)}function tr(){var t,r;for(t=[],r=rr();r!==o;)t.push(r),r=rr();return t}function rr(){var r,e,n;if((r=function(){var r,e,n,i;return r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o&&lr()!==o&&(n=er())!==o&&lr()!==o?(125===t.charCodeAt($t)?(i=m,$t++):(i=o,0===Zt&&Qt(d)),i!==o?(e=y(n),r=e):($t=r,r=o)):($t=r,r=o),r}())===o&&(r=function(){var r,e,n,i,u,a,c,h,f;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(lr()!==o)if((n=er())!==o)if(lr()!==o)if(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o)if(lr()!==o)if($t,t.substr($t,6)===w?(u=w,$t+=6):(u=o,0===Zt&&Qt(b)),u!==o&&(u=S(n,u)),u!==o)if((u=lr())!==o)if(44===t.charCodeAt($t)?(a=g,$t++):(a=o,0===Zt&&Qt(v)),a!==o)if(lr()!==o){if(c=[],(h=nr())!==o)for(;h!==o;)c.push(h),h=nr();else c=o;c!==o&&(h=lr())!==o?(125===t.charCodeAt($t)?(f=m,$t++):(f=o,0===Zt&&Qt(d)),f!==o?(e=k(n,c),r=e):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;return r}())===o&&(r=function(){var r,e,n,i,u,a,c,h,f,s,y;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(lr()!==o)if((n=er())!==o)if(lr()!==o)if(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o)if(lr()!==o)if(u=$t,t.substr($t,6)===x?(a=x,$t+=6):(a=o,0===Zt&&Qt(A)),a===o&&(t.substr($t,13)===j?(a=j,$t+=13):(a=o,0===Zt&&Qt(N))),a!==o&&(a=C(n,a)),(u=a)!==o)if((a=lr())!==o)if(44===t.charCodeAt($t)?(c=g,$t++):(c=o,0===Zt&&Qt(v)),c!==o)if(lr()!==o)if((h=function(){var r,e,n,i,u;return Zt++,r=$t,(e=lr())!==o?(t.substr($t,6)===M?(n=M,$t+=6):(n=o,0===Zt&&Qt(_)),n!==o&&lr()!==o?(58===t.charCodeAt($t)?(i=T,$t++):(i=o,0===Zt&&Qt(R)),i!==o&&lr()!==o&&(u=sr())!==o&&lr()!==o?(e=B(u),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o),Zt--,r===o&&(e=o,0===Zt&&Qt(D)),r}())===o&&(h=null),h!==o){if(f=[],(s=or())!==o)for(;s!==o;)f.push(s),s=or();else f=o;f!==o&&(s=lr())!==o?(125===t.charCodeAt($t)?(y=m,$t++):(y=o,0===Zt&&Qt(d)),y!==o?(e=F(n,u,h,f),r=e):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;else $t=r,r=o;return r}())===o&&(r=function(){var r,e,n,i,u,a,c;return r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o&&lr()!==o&&(n=er())!==o&&lr()!==o?(44===t.charCodeAt($t)?(i=g,$t++):(i=o,0===Zt&&Qt(v)),i!==o&&lr()!==o&&(u=function(){var r,e,n,i,u;return t.substr($t,6)===K?(r=K,$t+=6):(r=o,0===Zt&&Qt(G)),r===o&&(t.substr($t,4)===U?(r=U,$t+=4):(r=o,0===Zt&&Qt(Z)),r===o&&(t.substr($t,4)===I?(r=I,$t+=4):(r=o,0===Zt&&Qt(Y)),r===o&&(t.substr($t,8)===V?(r=V,$t+=8):(r=o,0===Zt&&Qt(W)),r===o&&(t.substr($t,7)===H?(r=H,$t+=7):(r=o,0===Zt&&Qt(Q)),r===o&&(t.substr($t,8)===X?(r=X,$t+=8):(r=o,0===Zt&&Qt(tt)),r===o&&(r=$t,e=$t,Zt++,t.substr($t,6)===w?(n=w,$t+=6):(n=o,0===Zt&&Qt(b)),Zt--,n===o?e=void 0:($t=e,e=o),e!==o?(n=$t,Zt++,t.substr($t,6)===x?(i=x,$t+=6):(i=o,0===Zt&&Qt(A)),Zt--,i===o?n=void 0:($t=n,n=o),n!==o?(i=$t,Zt++,t.substr($t,13)===j?(u=j,$t+=13):(u=o,0===Zt&&Qt(N)),Zt--,u===o?i=void 0:($t=i,i=o),i!==o&&(u=er())!==o&&(rt(u)?void 0:o)!==o?(e=et(u),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o))))))),r}())!==o&&lr()!==o?((a=function(){var r,e,n,i,u;if(r=$t,(e=lr())!==o)if(44===t.charCodeAt($t)?(n=g,$t++):(n=o,0===Zt&&Qt(v)),n!==o){for(i=[],u=rr();u!==o;)i.push(u),u=rr();i!==o&&(u=(u=nt(i))?void 0:o)!==o?(e=ot(i),r=e):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;if(r===o)if(r=$t,(e=lr())!==o)if(44===t.charCodeAt($t)?(n=g,$t++):(n=o,0===Zt&&Qt(v)),n!==o){for(i=[],u=ur();u!==o;)i.push(u),u=ur();i!==o?(e=it(i),r=e):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;return r}())===o&&(a=null),a!==o?(125===t.charCodeAt($t)?(c=m,$t++):(c=o,0===Zt&&Qt(d)),c!==o?(e=O(n,u,a),r=e):($t=r,r=o)):($t=r,r=o)):($t=r,r=o)):($t=r,r=o),r}())===o&&(r=$t,35===t.charCodeAt($t)?(e=a,$t++):(e=o,0===Zt&&Qt(c)),e!==o&&(n=(n=h())?void 0:o)!==o?r=e=f():($t=r,r=o),r===o)){if(r=$t,e=[],(n=fr())!==o)for(;n!==o;)e.push(n),n=fr();else e=o;e!==o&&(e=s(e)),r=e}return r}function er(){var r,e,n;if(Zt++,r=$t,e=[],z.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(P)),n!==o)for(;n!==o;)e.push(n),z.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(P));else e=o;return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(E)),r}function nr(){var t,r,e;return t=$t,lr()!==o&&(r=er())!==o&&lr()!==o&&(e=ir())!==o?t=L(r,e):($t=t,t=o),t}function or(){var r,e,n;return r=$t,lr()!==o&&(e=function(){var r,e,n;return(r=er())===o&&(r=$t,61===t.charCodeAt($t)?(e=q,$t++):(e=o,0===Zt&&Qt($)),e!==o&&(n=sr())!==o?(e=B(n),r=e):($t=r,r=o)),r}())!==o&&lr()!==o&&(n=ir())!==o?r=L(e,n):($t=r,r=o),r}function ir(){var r,e,n,i,u,a;if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o)if(n=$t,(i=lr())!==o?(u=$t,Zt++,123===t.charCodeAt($t)?(a=l,$t++):(a=o,0===Zt&&Qt(p)),Zt--,a!==o?($t=u,u=void 0):u=o,u!==o?n=i=[i,u]:($t=n,n=o)):($t=n,n=o),n===o&&(n=null),n!==o){for(i=[],u=rr();u!==o;)i.push(u),u=rr();i!==o&&(u=lr())!==o?(125===t.charCodeAt($t)?(a=m,$t++):(a=o,0===Zt&&Qt(d)),a!==o?r=e=J(i):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;else $t=r,r=o;return r}function ur(){var r,e,n,i;if(Zt++,r=$t,e=[],at.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(ct)),n!==o)for(;n!==o;)e.push(n),at.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(ct));else e=o;if(e!==o&&(e=ht(e)),(r=e)===o&&(r=ar())===o&&(r=$t,39===t.charCodeAt($t)?(e=ft,$t++):(e=o,0===Zt&&Qt(st)),e!==o&&(n=cr())!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=lt(n):($t=r,r=o)):($t=r,r=o),r===o))if(r=$t,123===t.charCodeAt($t)?(e=l,$t++):(e=o,0===Zt&&Qt(p)),e!==o){for(n=[],i=ur();i!==o;)n.push(i),i=ur();n!==o?(125===t.charCodeAt($t)?(i=m,$t++):(i=o,0===Zt&&Qt(d)),i!==o?r=e=pt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;return Zt--,r===o&&(e=o,0===Zt&&Qt(ut)),r}function ar(){var r,e;return Zt++,r=$t,t.substr($t,2)===dt?(e=dt,$t+=2):(e=o,0===Zt&&Qt(yt)),e!==o&&(e=gt()),Zt--,(r=e)===o&&(e=o,0===Zt&&Qt(mt)),r}function cr(){var r,e,n;if((r=ar())===o){if(r=$t,e=[],vt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(wt)),n!==o)for(;n!==o;)e.push(n),vt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(wt));else e=o;e!==o&&(e=s(e)),r=e}return r}function hr(){var r,e,n,i,u,a;if(Zt++,(r=function(){var r,e,n,i;if(r=$t,t.substr($t,2)===bt?(e=bt,$t+=2):(e=o,0===Zt&&Qt(St)),e!==o){for(n=[],i=cr();i!==o;)n.push(i),i=cr();n!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=kt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;if(r===o)if(r=$t,t.substr($t,2)===xt?(e=xt,$t+=2):(e=o,0===Zt&&Qt(At)),e!==o){for(n=[],i=cr();i!==o;)n.push(i),i=cr();n!==o?(39===t.charCodeAt($t)?(i=ft,$t++):(i=o,0===Zt&&Qt(st)),i!==o?r=e=jt(n):($t=r,r=o)):($t=r,r=o)}else $t=r,r=o;return r}())===o){if(r=$t,e=$t,n=$t,t.substr($t,2)===Ct?(i=Ct,$t+=2):(i=o,0===Zt&&Qt(Ft)),i!==o){for(u=[],a=cr();a!==o;)u.push(a),a=cr();u!==o?(39===t.charCodeAt($t)?(a=ft,$t++):(a=o,0===Zt&&Qt(st)),a!==o?n=i=Ot(u):($t=n,n=o)):($t=n,n=o)}else $t=n,n=o;n!==o&&(i=(i=h())?void 0:o)!==o?e=n=[n,i]:($t=e,e=o),e!==o&&(e=Et(e)),(r=e)===o&&(39===t.charCodeAt($t)?(r=ft,$t++):(r=o,0===Zt&&Qt(st)))}return Zt--,r===o&&(e=o,0===Zt&&Qt(Nt)),r}function fr(){var r,e;return(r=ar())===o&&(r=hr())===o&&(r=$t,35===t.charCodeAt($t)?(e=a,$t++):(e=o,0===Zt&&Qt(c)),e!==o&&(Jt(e)?void 0:o)!==o?r=e=Dt(e):($t=r,r=o),r===o&&(r=function(){var r;return Zt++,Pt.test(t.charAt($t))?(r=t.charAt($t),$t++):(r=o,0===Zt&&Qt(Lt)),Zt--,r===o&&0===Zt&&Qt(zt),r}())),r}function sr(){var r,e,n;if(Zt++,r=$t,e=[],_t.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(Tt)),n!==o)for(;n!==o;)e.push(n),_t.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(Tt));else e=o;return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(Mt)),r}function lr(){var r,e,n;for(Zt++,r=$t,e=[],Bt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(qt));n!==o;)e.push(n),Bt.test(t.charAt($t))?(n=t.charAt($t),$t++):(n=o,0===Zt&&Qt(qt));return r=e!==o?t.substring(r,$t):e,Zt--,r===o&&(e=o,0===Zt&&Qt(Rt)),r}var pr=[!1];if((e=u())!==o&&$t===t.length)return e;throw e!==o&&$t<t.length&&Qt({type:"end"}),Xt(Ut,Gt<t.length?t.charAt(Gt):null,Gt<t.length?Ht(Gt,Gt+1):Ht(Gt,Gt))}}},function(t,r,e){var n,o,i=[{cardinal:["other"],ordinal:["other"]},{cardinal:["one","other"],ordinal:["other"]},{cardinal:["one","other"],ordinal:["one","other"]},{cardinal:["one","two","other"],ordinal:["other"]}];void 0===(o="function"==typeof(n={af:i[1],ak:i[1],am:i[1],ar:{cardinal:["zero","one","two","few","many","other"],ordinal:["other"]},ars:{cardinal:["zero","one","two","few","many","other"],ordinal:["other"]},as:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},asa:i[1],ast:i[1],az:{cardinal:["one","other"],ordinal:["one","few","many","other"]},be:{cardinal:["one","few","many","other"],ordinal:["few","other"]},bem:i[1],bez:i[1],bg:i[1],bh:i[1],bm:i[0],bn:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},bo:i[0],br:{cardinal:["one","two","few","many","other"],ordinal:["other"]},brx:i[1],bs:{cardinal:["one","few","other"],ordinal:["other"]},ca:{cardinal:["one","other"],ordinal:["one","two","few","other"]},ce:i[1],cgg:i[1],chr:i[1],ckb:i[1],cs:{cardinal:["one","few","many","other"],ordinal:["other"]},cy:{cardinal:["zero","one","two","few","many","other"],ordinal:["zero","one","two","few","many","other"]},da:i[1],de:i[1],dsb:{cardinal:["one","two","few","other"],ordinal:["other"]},dv:i[1],dz:i[0],ee:i[1],el:i[1],en:{cardinal:["one","other"],ordinal:["one","two","few","other"]},eo:i[1],es:i[1],et:i[1],eu:i[1],fa:i[1],ff:i[1],fi:i[1],fil:i[2],fo:i[1],fr:i[2],fur:i[1],fy:i[1],ga:{cardinal:["one","two","few","many","other"],ordinal:["one","other"]},gd:{cardinal:["one","two","few","other"],ordinal:["one","two","few","other"]},gl:i[1],gsw:i[1],gu:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},guw:i[1],gv:{cardinal:["one","two","few","many","other"],ordinal:["other"]},ha:i[1],haw:i[1],he:{cardinal:["one","two","many","other"],ordinal:["other"]},hi:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},hr:{cardinal:["one","few","other"],ordinal:["other"]},hsb:{cardinal:["one","two","few","other"],ordinal:["other"]},hu:i[2],hy:i[2],ia:i[1],id:i[0],ig:i[0],ii:i[0],in:i[0],io:i[1],is:i[1],it:{cardinal:["one","other"],ordinal:["many","other"]},iu:i[3],iw:{cardinal:["one","two","many","other"],ordinal:["other"]},ja:i[0],jbo:i[0],jgo:i[1],ji:i[1],jmc:i[1],jv:i[0],jw:i[0],ka:{cardinal:["one","other"],ordinal:["one","many","other"]},kab:i[1],kaj:i[1],kcg:i[1],kde:i[0],kea:i[0],kk:{cardinal:["one","other"],ordinal:["many","other"]},kkj:i[1],kl:i[1],km:i[0],kn:i[1],ko:i[0],ks:i[1],ksb:i[1],ksh:{cardinal:["zero","one","other"],ordinal:["other"]},ku:i[1],kw:i[3],ky:i[1],lag:{cardinal:["zero","one","other"],ordinal:["other"]},lb:i[1],lg:i[1],lkt:i[0],ln:i[1],lo:{cardinal:["other"],ordinal:["one","other"]},lt:{cardinal:["one","few","many","other"],ordinal:["other"]},lv:{cardinal:["zero","one","other"],ordinal:["other"]},mas:i[1],mg:i[1],mgo:i[1],mk:{cardinal:["one","other"],ordinal:["one","two","many","other"]},ml:i[1],mn:i[1],mo:{cardinal:["one","few","other"],ordinal:["one","other"]},mr:{cardinal:["one","other"],ordinal:["one","two","few","other"]},ms:{cardinal:["other"],ordinal:["one","other"]},mt:{cardinal:["one","few","many","other"],ordinal:["other"]},my:i[0],nah:i[1],naq:i[3],nb:i[1],nd:i[1],ne:i[2],nl:i[1],nn:i[1],nnh:i[1],no:i[1],nqo:i[0],nr:i[1],nso:i[1],ny:i[1],nyn:i[1],om:i[1],or:{cardinal:["one","other"],ordinal:["one","two","few","many","other"]},os:i[1],pa:i[1],pap:i[1],pl:{cardinal:["one","few","many","other"],ordinal:["other"]},prg:{cardinal:["zero","one","other"],ordinal:["other"]},ps:i[1],pt:i[1],"pt-PT":i[1],rm:i[1],ro:{cardinal:["one","few","other"],ordinal:["one","other"]},rof:i[1],root:i[0],ru:{cardinal:["one","few","many","other"],ordinal:["other"]},rwk:i[1],sah:i[0],saq:i[1],sc:{cardinal:["one","other"],ordinal:["many","other"]},scn:{cardinal:["one","other"],ordinal:["many","other"]},sd:i[1],sdh:i[1],se:i[3],seh:i[1],ses:i[0],sg:i[0],sh:{cardinal:["one","few","other"],ordinal:["other"]},shi:{cardinal:["one","few","other"],ordinal:["other"]},si:i[1],sk:{cardinal:["one","few","many","other"],ordinal:["other"]},sl:{cardinal:["one","two","few","other"],ordinal:["other"]},sma:i[3],smi:i[3],smj:i[3],smn:i[3],sms:i[3],sn:i[1],so:i[1],sq:{cardinal:["one","other"],ordinal:["one","many","other"]},sr:{cardinal:["one","few","other"],ordinal:["other"]},ss:i[1],ssy:i[1],st:i[1],sv:i[2],sw:i[1],syr:i[1],ta:i[1],te:i[1],teo:i[1],th:i[0],ti:i[1],tig:i[1],tk:{cardinal:["one","other"],ordinal:["few","other"]},tl:i[2],tn:i[1],to:i[0],tr:i[1],ts:i[1],tzm:i[1],ug:i[1],uk:{cardinal:["one","few","many","other"],ordinal:["few","other"]},ur:i[1],uz:i[1],ve:i[1],vi:{cardinal:["other"],ordinal:["one","other"]},vo:i[1],vun:i[1],wa:i[1],wae:i[1],wo:i[0],xh:i[1],xog:i[1],yi:i[1],yo:i[0],yue:i[0],zh:i[0],zu:i[1]})?n.call(r,e,r,t):n)||(t.exports=o)},function(t,r){function e(t,r,e){var n={day:"numeric",month:"short",year:"numeric"};switch(e){case"full":n.weekday="long";case"long":n.month="long";break;case"short":n.month="numeric"}return new Date(t).toLocaleDateString(r,n)}t.exports=function(){return e}},function(t,r){function e(t){if(!isFinite(t))return String(t);var r="";t<0?(r="-",t=Math.abs(t)):t=Number(t);var e=t%60,n=[Math.round(e)===e?e:e.toFixed(3)];return t<60?n.unshift(0):(t=Math.round((t-n[0])/60),n.unshift(t%60),t>=60&&(t=Math.round((t-n[0])/60),n.unshift(t))),r+n.shift()+":"+n.map(function(t){return t<10?"0"+String(t):String(t)}).join(":")}t.exports=function(){return e}},function(t,r){t.exports=function(t){var r=function(t,r,e){var n=e&&e.split(":")||[],o={integer:{maximumFractionDigits:0},percent:{style:"percent"},currency:{style:"currency",currency:n[1]&&n[1].trim()||CURRENCY,minimumFractionDigits:2,maximumFractionDigits:2}};return new Intl.NumberFormat(r,o[n[0]]||{}).format(t)}.toString().replace("CURRENCY",JSON.stringify(t.currency||"USD")).match(/\(([^)]*)\)[^{]*{([\s\S]*)}/);return new Function(r[1],r[2])}},function(t,r){function e(t,r,e){var n={second:"numeric",minute:"numeric",hour:"numeric"};switch(e){case"full":case"long":n.timeZoneName="short";break;case"short":delete n.second}return new Date(t).toLocaleTimeString(r,n)}t.exports=function(){return e}},function(t,r,e){"use strict";e.r(r);var n=e(1),o=e.n(n),i=e(2),u={break:!0,continue:!0,delete:!0,else:!0,for:!0,function:!0,if:!0,in:!0,new:!0,return:!0,this:!0,typeof:!0,var:!0,void:!0,while:!0,with:!0,case:!0,catch:!0,default:!0,do:!0,finally:!0,instanceof:!0,switch:!0,throw:!0,try:!0},a={debugger:!0,class:!0,enum:!0,extends:!0,super:!0,const:!0,export:!0,import:!0,null:!0,true:!0,false:!0,implements:!0,let:!0,private:!0,public:!0,yield:!0,interface:!0,package:!0,protected:!0,static:!0};function c(t,r){if(/^[A-Z_$][0-9A-Z_$]*$/i.test(t)&&!u[t])return r?"".concat(r,".").concat(t):t;var e=JSON.stringify(t);return r?r+"[".concat(e,"]"):e}function h(t){var r=t.trim().replace(/\W+/g,"_");return u[r]||a[r]||/^\d/.test(r)?"_"+r:r}var f=new RegExp("^"+["ar","ckb","fa","he","ks($|[^bfh])","lrc","mzn","pa-Arab","ps","ug","ur","uz-Arab","yi"].join("|^"));function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var p=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.mf=r,this.lc=null,this.locales={},this.runtime={},this.formatters={}}var r,e,n;return r=t,(e=[{key:"compile",value:function(t,r,e){var n=this;if("object"!=s(t)){this.lc=r;var o=e[r]||{cardinal:[],ordinal:[]};o.strict=!!this.mf.options.strictNumberSign;var u=Object(i.parse)(t,o).map(function(t){return n.token(t)});return"function(d) { return ".concat(u.join(" + ")||'""',"; }")}var a={};for(var c in t){var h=e.hasOwnProperty(c)?c:r;a[c]=this.compile(t[c],h,e)}return a}},{key:"cases",value:function(t,r){var e=this,n="select"===t.type||!this.mf.hasCustomPluralFuncs,o=t.cases.map(function(t){var o=t.key,i=t.tokens;"other"===o&&(n=!1);var u=i.map(function(t){return e.token(t,r)});return c(o)+": "+(u.join(" + ")||'""')});if(n)throw new Error("No 'other' form found in "+JSON.stringify(t));return"{ ".concat(o.join(", ")," }")}},{key:"token",value:function(t,r){var e,n=this;if("string"==typeof t)return JSON.stringify(t);var o,i,u,a,s=[c(t.arg,"d")];switch(t.type){case"argument":return this.mf.options.biDiSupport?(o=s[0],i=this.lc,u=f.test(i),a=JSON.stringify(u?"‏":"‎"),"".concat(a," + ").concat(o," + ").concat(a)):s[0];case"select":e="select",r&&this.mf.options.strictNumberSign&&(r=null),s.push(this.cases(t,r)),this.runtime.select=!0;break;case"selectordinal":e="plural",s.push(0,h(this.lc),this.cases(t,t),1),this.locales[this.lc]=!0,this.runtime.plural=!0;break;case"plural":e="plural",s.push(t.offset||0,h(this.lc),this.cases(t,t)),this.locales[this.lc]=!0,this.runtime.plural=!0;break;case"function":if(!(t.key in this.mf.fmt)&&t.key in this.mf.constructor.formatters){var l=this.mf.constructor.formatters[t.key];this.mf.fmt[t.key]=l(this.mf)}if(!this.mf.fmt[t.key])throw new Error("Formatting function ".concat(JSON.stringify(t.key)," not found!"));if(s.push(JSON.stringify(this.lc)),t.param){r&&this.mf.options.strictNumberSign&&(r=null);var p=t.param.tokens.map(function(t){return n.token(t,r)});s.push("("+(p.join(" + ")||'""')+").trim()")}e=c(t.key,"fmt"),this.formatters[t.key]=!0;break;case"octothorpe":if(!r)return'"#"';e="number",s=[c(r.arg,"d"),JSON.stringify(r.arg)],r.offset&&s.push(r.offset),this.runtime.number=!0}if(!e)throw new Error("Parser error for token "+JSON.stringify(t));return"".concat(e,"(").concat(s.join(", "),")")}}])&&l(r.prototype,e),n&&l(r,n),t}(),m=e(3),d=e.n(m),y=e(0),g=e.n(y);function v(t,r,e){var n=function(){return r.apply(this,arguments)};if(n.toString=function(){return r.toString()},e){var o=d.a[t]||{};n.cardinal=o.cardinal,n.ordinal=o.ordinal}else n.cardinal=[],n.ordinal=[];return n}function w(t,r){for(var e=r.pluralKeyChecks,n=String(t);n;n=n.replace(/[-_]?[^-_]*$/,"")){var o=g.a[n];if(o)return v(n,o,e)}throw new Error("Localisation function not found for locale "+JSON.stringify(t))}function b(t){return(b="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function S(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var k=function(){function t(r){!function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.plural=function(t,r,e,n,o){if({}.hasOwnProperty.call(n,t))return n[t];r&&(t-=r);var i=e(t,o);return i in n?n[i]:n.other},this.select=function(t,r){return{}.hasOwnProperty.call(r,t)?r[t]:r.other},this.mf=r,this.setStrictNumber(r.options.strictNumberSign)}var r,e,n;return r=t,(e=[{key:"setStrictNumber",value:function(r){this.number=r?t.strictNumber:t.defaultNumber}},{key:"toString",value:function(t,r){for(var e={},n=Object.keys(r.locales),o=0;o<n.length;++o){var i=n[o];e[h(i)]=t[i]}for(var u=Object.keys(r.runtime),a=0;a<u.length;++a){var f=u[a];e[f]=this[f]}var s=Object.keys(r.formatters);if(s.length>0){e.fmt={};for(var l=0;l<s.length;++l){var p=s[l];e.fmt[p]=this.mf.fmt[p]}}return function t(r,e){if("object"!=b(r)){var n=r.toString().replace(/^(function )\w*/,"$1"),o=/([ \t]*)\S.*$/.exec(n);return o?n.replace(new RegExp("^"+o[1],"mg"),""):n}var i=[];for(var u in r){var a=t(r[u],e+1);i.push(0===e?"var ".concat(u," = ").concat(a,";\n"):"".concat(c(u),": ").concat(a))}if(0===e)return i.join("");if(0===i.length)return"{}";for(var h="  ";--e;)h+="  ";var f=i.join(",\n").replace(/^/gm,h);return"{\n".concat(f,"\n}")}(e,0)}}])&&S(r.prototype,e),n&&S(r,n),t}();function x(t){return(x="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function A(t,r){for(var e=0;e<r.length;e++){var n=r[e];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function j(t,r,e){return r&&A(t.prototype,r),e&&A(t,e),t}k.defaultNumber=function(t,r,e){if(!e)return t;if(isNaN(t))throw new Error("Can't apply offset:"+e+" to argument `"+r+"` with non-numerical value "+JSON.stringify(t)+".");return t-e},k.strictNumber=function(t,r,e){if(isNaN(t))throw new Error("Argument `"+r+"` has non-numerical value "+JSON.stringify(t)+".");return t-(e||0)},e.d(r,"default",function(){return N});var N=function(){function t(r,e){var n=this;if(function(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}(this,t),this.options=Object.assign({biDiSupport:!1,customFormatters:null,pluralKeyChecks:!0,strictNumberSign:!1},e),this.pluralFuncs={},"string"==typeof r)this.pluralFuncs[r]=w(r,this.options),this.defaultLocale=r;else if(Array.isArray(r))r.forEach(function(t){n.pluralFuncs[t]=w(t,n.options)}),this.defaultLocale=r[0];else{if(r)for(var o=Object.keys(r),i=0;i<o.length;++i){var u=o[i];if("function"!=typeof r[u]){var a="Expected function value for locale "+String(u);throw new Error(a)}this.pluralFuncs[u]=r[u],this.defaultLocale||(this.defaultLocale=u)}this.defaultLocale?this.hasCustomPluralFuncs=!0:(this.defaultLocale=t.defaultLocale,this.hasCustomPluralFuncs=!1)}this.fmt=Object.assign({},this.options.customFormatters),this.runtime=new k(this)}return j(t,null,[{key:"escape",value:function(t,r){var e=r?/[#{}]/g:/[{}]/g;return String(t).replace(e,"'$&'")}}]),j(t,[{key:"addFormatters",value:function(t){for(var r=Object.keys(t),e=0;e<r.length;++e){var n=r[e];this.fmt[n]=t[n]}return this}},{key:"disablePluralKeyChecks",value:function(){for(var t in this.options.pluralKeyChecks=!1,this.pluralFuncs){var r=this.pluralFuncs[t];r&&(r.cardinal=[],r.ordinal=[])}return this}},{key:"setBiDiSupport",value:function(t){return this.options.biDiSupport=!!t||void 0===t,this}},{key:"setStrictNumberSign",value:function(t){return this.options.strictNumberSign=!!t||void 0===t,this.runtime.setStrictNumber(this.options.strictNumberSign),this}},{key:"compile",value:function(t,r){var e={};if(0===Object.keys(this.pluralFuncs).length)if(r){var n=w(r,this.options);if(!n){var o=JSON.stringify(r);throw new Error("Locale ".concat(o," not found!"))}e[r]=n}else r=this.defaultLocale,e=function(t){for(var r=t.pluralKeyChecks,e={},n=Object.keys(g.a),o=0;o<n.length;++o){var i=n[o];e[i]=v(i,g.a[i],r)}return e}(this.options);else if(r){var i=this.pluralFuncs[r];if(!i){var u=JSON.stringify(r),a=JSON.stringify(this.pluralFuncs);throw new Error("Locale ".concat(u," not found in ").concat(a,"!"))}e[r]=i}else r=this.defaultLocale,e=this.pluralFuncs;var f=new p(this),s=f.compile(t,r,e);if("object"!=x(t)){var l=new Function("number, plural, select, fmt",h(r),"return "+s),m=this.runtime;return l(m.number,m.plural,m.select,this.fmt,e[r])}var d=this.runtime.toString(e,f)+"\n",y=function t(r,e){if(e||(e=0),"object"!=x(r))return r;for(var n="",o=0;o<e;++o)n+="  ";var i=[];for(var u in r){var a=t(r[u],e+1);i.push("\n".concat(n,"  ").concat(c(u),": ").concat(a))}return"{".concat(i.join(","),"\n").concat(n,"}")}(s),b=new Function(d+"return "+y)();if(b.hasOwnProperty("toString"))throw new Error("The top-level message key `toString` is reserved");return b.toString=function(t){return t&&"export default"!==t?t.indexOf(".")>-1?d+t+" = "+y:d+["(function (root, G) {",'  if (typeof define === "function" && define.amd) { define(G); }','  else if (typeof exports === "object") { module.exports = G; }',"  else { "+c(t,"root")+" = G; }","})(this, "+y+");"].join("\n"):d+"export default "+y},b}}]),t}();N.defaultLocale="en",N.formatters=o.a}]).default});

},{}],5:[function(require,module,exports){
// shim for using process in browser
var process = module.exports = {};

// cached from whatever global is present so that test runners that stub it
// don't break things.  But we need to wrap it in a try catch in case it is
// wrapped in strict mode code which doesn't define any globals.  It's inside a
// function because try/catches deoptimize in certain engines.

var cachedSetTimeout;
var cachedClearTimeout;

function defaultSetTimout() {
    throw new Error('setTimeout has not been defined');
}
function defaultClearTimeout () {
    throw new Error('clearTimeout has not been defined');
}
(function () {
    try {
        if (typeof setTimeout === 'function') {
            cachedSetTimeout = setTimeout;
        } else {
            cachedSetTimeout = defaultSetTimout;
        }
    } catch (e) {
        cachedSetTimeout = defaultSetTimout;
    }
    try {
        if (typeof clearTimeout === 'function') {
            cachedClearTimeout = clearTimeout;
        } else {
            cachedClearTimeout = defaultClearTimeout;
        }
    } catch (e) {
        cachedClearTimeout = defaultClearTimeout;
    }
} ())
function runTimeout(fun) {
    if (cachedSetTimeout === setTimeout) {
        //normal enviroments in sane situations
        return setTimeout(fun, 0);
    }
    // if setTimeout wasn't available but was latter defined
    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {
        cachedSetTimeout = setTimeout;
        return setTimeout(fun, 0);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedSetTimeout(fun, 0);
    } catch(e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally
            return cachedSetTimeout.call(null, fun, 0);
        } catch(e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error
            return cachedSetTimeout.call(this, fun, 0);
        }
    }


}
function runClearTimeout(marker) {
    if (cachedClearTimeout === clearTimeout) {
        //normal enviroments in sane situations
        return clearTimeout(marker);
    }
    // if clearTimeout wasn't available but was latter defined
    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {
        cachedClearTimeout = clearTimeout;
        return clearTimeout(marker);
    }
    try {
        // when when somebody has screwed with setTimeout but no I.E. maddness
        return cachedClearTimeout(marker);
    } catch (e){
        try {
            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally
            return cachedClearTimeout.call(null, marker);
        } catch (e){
            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.
            // Some versions of I.E. have different rules for clearTimeout vs setTimeout
            return cachedClearTimeout.call(this, marker);
        }
    }



}
var queue = [];
var draining = false;
var currentQueue;
var queueIndex = -1;

function cleanUpNextTick() {
    if (!draining || !currentQueue) {
        return;
    }
    draining = false;
    if (currentQueue.length) {
        queue = currentQueue.concat(queue);
    } else {
        queueIndex = -1;
    }
    if (queue.length) {
        drainQueue();
    }
}

function drainQueue() {
    if (draining) {
        return;
    }
    var timeout = runTimeout(cleanUpNextTick);
    draining = true;

    var len = queue.length;
    while(len) {
        currentQueue = queue;
        queue = [];
        while (++queueIndex < len) {
            if (currentQueue) {
                currentQueue[queueIndex].run();
            }
        }
        queueIndex = -1;
        len = queue.length;
    }
    currentQueue = null;
    draining = false;
    runClearTimeout(timeout);
}

process.nextTick = function (fun) {
    var args = new Array(arguments.length - 1);
    if (arguments.length > 1) {
        for (var i = 1; i < arguments.length; i++) {
            args[i - 1] = arguments[i];
        }
    }
    queue.push(new Item(fun, args));
    if (queue.length === 1 && !draining) {
        runTimeout(drainQueue);
    }
};

// v8 likes predictible objects
function Item(fun, array) {
    this.fun = fun;
    this.array = array;
}
Item.prototype.run = function () {
    this.fun.apply(null, this.array);
};
process.title = 'browser';
process.browser = true;
process.env = {};
process.argv = [];
process.version = ''; // empty string to avoid regexp issues
process.versions = {};

function noop() {}

process.on = noop;
process.addListener = noop;
process.once = noop;
process.off = noop;
process.removeListener = noop;
process.removeAllListeners = noop;
process.emit = noop;
process.prependListener = noop;
process.prependOnceListener = noop;

process.listeners = function (name) { return [] }

process.binding = function (name) {
    throw new Error('process.binding is not supported');
};

process.cwd = function () { return '/' };
process.chdir = function (dir) {
    throw new Error('process.chdir is not supported');
};
process.umask = function() { return 0; };

},{}],6:[function(require,module,exports){
(function (process,global,setImmediate){(function (){
/*!
 * QUnit 2.11.3
 * https://qunitjs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2020-10-05T01:34Z
 */
(function (global$1) {
	'use strict';

	function _interopDefaultLegacy (e) { return e && typeof e === 'object' && 'default' in e ? e : { 'default': e }; }

	var global__default = /*#__PURE__*/_interopDefaultLegacy(global$1);

	var window$1 = global__default['default'].window;
	var self$1 = global__default['default'].self;
	var console = global__default['default'].console;
	var setTimeout$1 = global__default['default'].setTimeout;
	var clearTimeout = global__default['default'].clearTimeout;
	var document$1 = window$1 && window$1.document;
	var navigator = window$1 && window$1.navigator;
	var localSessionStorage = function () {
	  var x = "qunit-test-string";

	  try {
	    global__default['default'].sessionStorage.setItem(x, x);
	    global__default['default'].sessionStorage.removeItem(x);
	    return global__default['default'].sessionStorage;
	  } catch (e) {
	    return undefined;
	  }
	}(); // Support IE 9-10: Fallback for fuzzysort.js used by /reporter/html.js

	if (!global__default['default'].Map) {
	  global__default['default'].Map = function StringMap() {
	    var store = Object.create(null);

	    this.get = function (strKey) {
	      return store[strKey];
	    };

	    this.set = function (strKey, val) {
	      store[strKey] = val;
	      return this;
	    };

	    this.clear = function () {
	      store = Object.create(null);
	    };
	  };
	}

	function _typeof(obj) {
	  "@babel/helpers - typeof";

	  if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") {
	    _typeof = function (obj) {
	      return typeof obj;
	    };
	  } else {
	    _typeof = function (obj) {
	      return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj;
	    };
	  }

	  return _typeof(obj);
	}

	function _classCallCheck(instance, Constructor) {
	  if (!(instance instanceof Constructor)) {
	    throw new TypeError("Cannot call a class as a function");
	  }
	}

	function _defineProperties(target, props) {
	  for (var i = 0; i < props.length; i++) {
	    var descriptor = props[i];
	    descriptor.enumerable = descriptor.enumerable || false;
	    descriptor.configurable = true;
	    if ("value" in descriptor) descriptor.writable = true;
	    Object.defineProperty(target, descriptor.key, descriptor);
	  }
	}

	function _createClass(Constructor, protoProps, staticProps) {
	  if (protoProps) _defineProperties(Constructor.prototype, protoProps);
	  if (staticProps) _defineProperties(Constructor, staticProps);
	  return Constructor;
	}

	function _toConsumableArray(arr) {
	  return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread();
	}

	function _arrayWithoutHoles(arr) {
	  if (Array.isArray(arr)) return _arrayLikeToArray(arr);
	}

	function _iterableToArray(iter) {
	  if (typeof Symbol !== "undefined" && Symbol.iterator in Object(iter)) return Array.from(iter);
	}

	function _unsupportedIterableToArray(o, minLen) {
	  if (!o) return;
	  if (typeof o === "string") return _arrayLikeToArray(o, minLen);
	  var n = Object.prototype.toString.call(o).slice(8, -1);
	  if (n === "Object" && o.constructor) n = o.constructor.name;
	  if (n === "Map" || n === "Set") return Array.from(o);
	  if (n === "Arguments" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen);
	}

	function _arrayLikeToArray(arr, len) {
	  if (len == null || len > arr.length) len = arr.length;

	  for (var i = 0, arr2 = new Array(len); i < len; i++) arr2[i] = arr[i];

	  return arr2;
	}

	function _nonIterableSpread() {
	  throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
	}

	function _createForOfIteratorHelper(o, allowArrayLike) {
	  var it;

	  if (typeof Symbol === "undefined" || o[Symbol.iterator] == null) {
	    if (Array.isArray(o) || (it = _unsupportedIterableToArray(o)) || allowArrayLike && o && typeof o.length === "number") {
	      if (it) o = it;
	      var i = 0;

	      var F = function () {};

	      return {
	        s: F,
	        n: function () {
	          if (i >= o.length) return {
	            done: true
	          };
	          return {
	            done: false,
	            value: o[i++]
	          };
	        },
	        e: function (e) {
	          throw e;
	        },
	        f: F
	      };
	    }

	    throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");
	  }

	  var normalCompletion = true,
	      didErr = false,
	      err;
	  return {
	    s: function () {
	      it = o[Symbol.iterator]();
	    },
	    n: function () {
	      var step = it.next();
	      normalCompletion = step.done;
	      return step;
	    },
	    e: function (e) {
	      didErr = true;
	      err = e;
	    },
	    f: function () {
	      try {
	        if (!normalCompletion && it.return != null) it.return();
	      } finally {
	        if (didErr) throw err;
	      }
	    }
	  };
	}

	// This allows support for IE 9, which doesn't have a console
	// object if the developer tools are not open.

	var Logger = {
	  warn: console ? console.warn.bind(console) : function () {}
	};

	var toString = Object.prototype.toString;
	var hasOwn = Object.prototype.hasOwnProperty;
	var now = Date.now || function () {
	  return new Date().getTime();
	};
	var hasPerformanceApi = detectPerformanceApi();
	var performance = hasPerformanceApi ? window$1.performance : undefined;
	var performanceNow = hasPerformanceApi ? performance.now.bind(performance) : now;

	function detectPerformanceApi() {
	  return window$1 && typeof window$1.performance !== "undefined" && typeof window$1.performance.mark === "function" && typeof window$1.performance.measure === "function";
	}

	function measure(comment, startMark, endMark) {
	  // `performance.measure` may fail if the mark could not be found.
	  // reasons a specific mark could not be found include: outside code invoking `performance.clearMarks()`
	  try {
	    performance.measure(comment, startMark, endMark);
	  } catch (ex) {
	    Logger.warn("performance.measure could not be executed because of ", ex.message);
	  }
	}
	var defined = {
	  document: window$1 && window$1.document !== undefined,
	  setTimeout: setTimeout$1 !== undefined
	}; // Returns a new Array with the elements that are in a but not in b

	function diff(a, b) {
	  var i,
	      j,
	      result = a.slice();

	  for (i = 0; i < result.length; i++) {
	    for (j = 0; j < b.length; j++) {
	      if (result[i] === b[j]) {
	        result.splice(i, 1);
	        i--;
	        break;
	      }
	    }
	  }

	  return result;
	}
	/**
	 * Determines whether an element exists in a given array or not.
	 *
	 * @method inArray
	 * @param {Any} elem
	 * @param {Array} array
	 * @return {Boolean}
	 */

	function inArray(elem, array) {
	  return array.indexOf(elem) !== -1;
	}
	/**
	 * Makes a clone of an object using only Array or Object as base,
	 * and copies over the own enumerable properties.
	 *
	 * @param {Object} obj
	 * @return {Object} New object with only the own properties (recursively).
	 */

	function objectValues(obj) {
	  var key,
	      val,
	      vals = is("array", obj) ? [] : {};

	  for (key in obj) {
	    if (hasOwn.call(obj, key)) {
	      val = obj[key];
	      vals[key] = val === Object(val) ? objectValues(val) : val;
	    }
	  }

	  return vals;
	}
	function extend(a, b, undefOnly) {
	  for (var prop in b) {
	    if (hasOwn.call(b, prop)) {
	      if (b[prop] === undefined) {
	        delete a[prop];
	      } else if (!(undefOnly && typeof a[prop] !== "undefined")) {
	        a[prop] = b[prop];
	      }
	    }
	  }

	  return a;
	}
	function objectType(obj) {
	  if (typeof obj === "undefined") {
	    return "undefined";
	  } // Consider: typeof null === object


	  if (obj === null) {
	    return "null";
	  }

	  var match = toString.call(obj).match(/^\[object\s(.*)\]$/),
	      type = match && match[1];

	  switch (type) {
	    case "Number":
	      if (isNaN(obj)) {
	        return "nan";
	      }

	      return "number";

	    case "String":
	    case "Boolean":
	    case "Array":
	    case "Set":
	    case "Map":
	    case "Date":
	    case "RegExp":
	    case "Function":
	    case "Symbol":
	      return type.toLowerCase();

	    default:
	      return _typeof(obj);
	  }
	} // Safe object type checking

	function is(type, obj) {
	  return objectType(obj) === type;
	} // Based on Java's String.hashCode, a simple but not
	// rigorously collision resistant hashing function

	function generateHash(module, testName) {
	  var str = module + "\x1C" + testName;
	  var hash = 0;

	  for (var i = 0; i < str.length; i++) {
	    hash = (hash << 5) - hash + str.charCodeAt(i);
	    hash |= 0;
	  } // Convert the possibly negative integer hash code into an 8 character hex string, which isn't
	  // strictly necessary but increases user understanding that the id is a SHA-like hash


	  var hex = (0x100000000 + hash).toString(16);

	  if (hex.length < 8) {
	    hex = "0000000" + hex;
	  }

	  return hex.slice(-8);
	}

	// Authors: Philippe Rathé <prathe@gmail.com>, David Chan <david@troi.org>

	var equiv = (function () {
	  // Value pairs queued for comparison. Used for breadth-first processing order, recursion
	  // detection and avoiding repeated comparison (see below for details).
	  // Elements are { a: val, b: val }.
	  var pairs = [];

	  var getProto = Object.getPrototypeOf || function (obj) {
	    return obj.__proto__;
	  };

	  function useStrictEquality(a, b) {
	    // This only gets called if a and b are not strict equal, and is used to compare on
	    // the primitive values inside object wrappers. For example:
	    // `var i = 1;`
	    // `var j = new Number(1);`
	    // Neither a nor b can be null, as a !== b and they have the same type.
	    if (_typeof(a) === "object") {
	      a = a.valueOf();
	    }

	    if (_typeof(b) === "object") {
	      b = b.valueOf();
	    }

	    return a === b;
	  }

	  function compareConstructors(a, b) {
	    var protoA = getProto(a);
	    var protoB = getProto(b); // Comparing constructors is more strict than using `instanceof`

	    if (a.constructor === b.constructor) {
	      return true;
	    } // Ref #851
	    // If the obj prototype descends from a null constructor, treat it
	    // as a null prototype.


	    if (protoA && protoA.constructor === null) {
	      protoA = null;
	    }

	    if (protoB && protoB.constructor === null) {
	      protoB = null;
	    } // Allow objects with no prototype to be equivalent to
	    // objects with Object as their constructor.


	    if (protoA === null && protoB === Object.prototype || protoB === null && protoA === Object.prototype) {
	      return true;
	    }

	    return false;
	  }

	  function getRegExpFlags(regexp) {
	    return "flags" in regexp ? regexp.flags : regexp.toString().match(/[gimuy]*$/)[0];
	  }

	  function isContainer(val) {
	    return ["object", "array", "map", "set"].indexOf(objectType(val)) !== -1;
	  }

	  function breadthFirstCompareChild(a, b) {
	    // If a is a container not reference-equal to b, postpone the comparison to the
	    // end of the pairs queue -- unless (a, b) has been seen before, in which case skip
	    // over the pair.
	    if (a === b) {
	      return true;
	    }

	    if (!isContainer(a)) {
	      return typeEquiv(a, b);
	    }

	    if (pairs.every(function (pair) {
	      return pair.a !== a || pair.b !== b;
	    })) {
	      // Not yet started comparing this pair
	      pairs.push({
	        a: a,
	        b: b
	      });
	    }

	    return true;
	  }

	  var callbacks = {
	    "string": useStrictEquality,
	    "boolean": useStrictEquality,
	    "number": useStrictEquality,
	    "null": useStrictEquality,
	    "undefined": useStrictEquality,
	    "symbol": useStrictEquality,
	    "date": useStrictEquality,
	    "nan": function nan() {
	      return true;
	    },
	    "regexp": function regexp(a, b) {
	      return a.source === b.source && // Include flags in the comparison
	      getRegExpFlags(a) === getRegExpFlags(b);
	    },
	    // abort (identical references / instance methods were skipped earlier)
	    "function": function _function() {
	      return false;
	    },
	    "array": function array(a, b) {
	      var i, len;
	      len = a.length;

	      if (len !== b.length) {
	        // Safe and faster
	        return false;
	      }

	      for (i = 0; i < len; i++) {
	        // Compare non-containers; queue non-reference-equal containers
	        if (!breadthFirstCompareChild(a[i], b[i])) {
	          return false;
	        }
	      }

	      return true;
	    },
	    // Define sets a and b to be equivalent if for each element aVal in a, there
	    // is some element bVal in b such that aVal and bVal are equivalent. Element
	    // repetitions are not counted, so these are equivalent:
	    // a = new Set( [ {}, [], [] ] );
	    // b = new Set( [ {}, {}, [] ] );
	    "set": function set(a, b) {
	      var innerEq,
	          outerEq = true;

	      if (a.size !== b.size) {
	        // This optimization has certain quirks because of the lack of
	        // repetition counting. For instance, adding the same
	        // (reference-identical) element to two equivalent sets can
	        // make them non-equivalent.
	        return false;
	      }

	      a.forEach(function (aVal) {
	        // Short-circuit if the result is already known. (Using for...of
	        // with a break clause would be cleaner here, but it would cause
	        // a syntax error on older Javascript implementations even if
	        // Set is unused)
	        if (!outerEq) {
	          return;
	        }

	        innerEq = false;
	        b.forEach(function (bVal) {
	          var parentPairs; // Likewise, short-circuit if the result is already known

	          if (innerEq) {
	            return;
	          } // Swap out the global pairs list, as the nested call to
	          // innerEquiv will clobber its contents


	          parentPairs = pairs;

	          if (innerEquiv(bVal, aVal)) {
	            innerEq = true;
	          } // Replace the global pairs list


	          pairs = parentPairs;
	        });

	        if (!innerEq) {
	          outerEq = false;
	        }
	      });
	      return outerEq;
	    },
	    // Define maps a and b to be equivalent if for each key-value pair (aKey, aVal)
	    // in a, there is some key-value pair (bKey, bVal) in b such that
	    // [ aKey, aVal ] and [ bKey, bVal ] are equivalent. Key repetitions are not
	    // counted, so these are equivalent:
	    // a = new Map( [ [ {}, 1 ], [ {}, 1 ], [ [], 1 ] ] );
	    // b = new Map( [ [ {}, 1 ], [ [], 1 ], [ [], 1 ] ] );
	    "map": function map(a, b) {
	      var innerEq,
	          outerEq = true;

	      if (a.size !== b.size) {
	        // This optimization has certain quirks because of the lack of
	        // repetition counting. For instance, adding the same
	        // (reference-identical) key-value pair to two equivalent maps
	        // can make them non-equivalent.
	        return false;
	      }

	      a.forEach(function (aVal, aKey) {
	        // Short-circuit if the result is already known. (Using for...of
	        // with a break clause would be cleaner here, but it would cause
	        // a syntax error on older Javascript implementations even if
	        // Map is unused)
	        if (!outerEq) {
	          return;
	        }

	        innerEq = false;
	        b.forEach(function (bVal, bKey) {
	          var parentPairs; // Likewise, short-circuit if the result is already known

	          if (innerEq) {
	            return;
	          } // Swap out the global pairs list, as the nested call to
	          // innerEquiv will clobber its contents


	          parentPairs = pairs;

	          if (innerEquiv([bVal, bKey], [aVal, aKey])) {
	            innerEq = true;
	          } // Replace the global pairs list


	          pairs = parentPairs;
	        });

	        if (!innerEq) {
	          outerEq = false;
	        }
	      });
	      return outerEq;
	    },
	    "object": function object(a, b) {
	      var i,
	          aProperties = [],
	          bProperties = [];

	      if (compareConstructors(a, b) === false) {
	        return false;
	      } // Be strict: don't ensure hasOwnProperty and go deep


	      for (i in a) {
	        // Collect a's properties
	        aProperties.push(i); // Skip OOP methods that look the same

	        if (a.constructor !== Object && typeof a.constructor !== "undefined" && typeof a[i] === "function" && typeof b[i] === "function" && a[i].toString() === b[i].toString()) {
	          continue;
	        } // Compare non-containers; queue non-reference-equal containers


	        if (!breadthFirstCompareChild(a[i], b[i])) {
	          return false;
	        }
	      }

	      for (i in b) {
	        // Collect b's properties
	        bProperties.push(i);
	      } // Ensures identical properties name


	      return typeEquiv(aProperties.sort(), bProperties.sort());
	    }
	  };

	  function typeEquiv(a, b) {
	    var type = objectType(a); // Callbacks for containers will append to the pairs queue to achieve breadth-first
	    // search order. The pairs queue is also used to avoid reprocessing any pair of
	    // containers that are reference-equal to a previously visited pair (a special case
	    // this being recursion detection).
	    //
	    // Because of this approach, once typeEquiv returns a false value, it should not be
	    // called again without clearing the pair queue else it may wrongly report a visited
	    // pair as being equivalent.

	    return objectType(b) === type && callbacks[type](a, b);
	  }

	  function innerEquiv(a, b) {
	    var i, pair; // We're done when there's nothing more to compare

	    if (arguments.length < 2) {
	      return true;
	    } // Clear the global pair queue and add the top-level values being compared


	    pairs = [{
	      a: a,
	      b: b
	    }];

	    for (i = 0; i < pairs.length; i++) {
	      pair = pairs[i]; // Perform type-specific comparison on any pairs that are not strictly
	      // equal. For container types, that comparison will postpone comparison
	      // of any sub-container pair to the end of the pair queue. This gives
	      // breadth-first search order. It also avoids the reprocessing of
	      // reference-equal siblings, cousins etc, which can have a significant speed
	      // impact when comparing a container of small objects each of which has a
	      // reference to the same (singleton) large object.

	      if (pair.a !== pair.b && !typeEquiv(pair.a, pair.b)) {
	        return false;
	      }
	    } // ...across all consecutive argument pairs


	    return arguments.length === 2 || innerEquiv.apply(this, [].slice.call(arguments, 1));
	  }

	  return function () {
	    var result = innerEquiv.apply(void 0, arguments); // Release any retained objects

	    pairs.length = 0;
	    return result;
	  };
	})();

	/**
	 * Config object: Maintain internal state
	 * Later exposed as QUnit.config
	 * `config` initialized at top of scope
	 */

	var config = {
	  // The queue of tests to run
	  queue: [],
	  // Block until document ready
	  blocking: true,
	  // By default, run previously failed tests first
	  // very useful in combination with "Hide passed tests" checked
	  reorder: true,
	  // By default, modify document.title when suite is done
	  altertitle: true,
	  // HTML Reporter: collapse every test except the first failing test
	  // If false, all failing tests will be expanded
	  collapse: true,
	  // By default, scroll to top of the page when suite is done
	  scrolltop: true,
	  // Depth up-to which object will be dumped
	  maxDepth: 5,
	  // When enabled, all tests must call expect()
	  requireExpects: false,
	  // Placeholder for user-configurable form-exposed URL parameters
	  urlConfig: [],
	  // Set of all modules.
	  modules: [],
	  // The first unnamed module
	  currentModule: {
	    name: "",
	    tests: [],
	    childModules: [],
	    testsRun: 0,
	    unskippedTestsRun: 0,
	    hooks: {
	      before: [],
	      beforeEach: [],
	      afterEach: [],
	      after: []
	    }
	  },
	  callbacks: {},
	  // The storage module to use for reordering tests
	  storage: localSessionStorage
	}; // take a predefined QUnit.config and extend the defaults

	var globalConfig = window$1 && window$1.QUnit && window$1.QUnit.config; // only extend the global config if there is no QUnit overload

	if (window$1 && window$1.QUnit && !window$1.QUnit.version) {
	  extend(config, globalConfig);
	} // Push a loose unnamed module to the modules collection


	config.modules.push(config.currentModule);

	// https://flesler.blogspot.com/2008/05/jsdump-pretty-dump-of-any-javascript.html

	var dump = (function () {
	  function quote(str) {
	    return "\"" + str.toString().replace(/\\/g, "\\\\").replace(/"/g, "\\\"") + "\"";
	  }

	  function literal(o) {
	    return o + "";
	  }

	  function join(pre, arr, post) {
	    var s = dump.separator(),
	        base = dump.indent(),
	        inner = dump.indent(1);

	    if (arr.join) {
	      arr = arr.join("," + s + inner);
	    }

	    if (!arr) {
	      return pre + post;
	    }

	    return [pre, inner + arr, base + post].join(s);
	  }

	  function array(arr, stack) {
	    var i = arr.length,
	        ret = new Array(i);

	    if (dump.maxDepth && dump.depth > dump.maxDepth) {
	      return "[object Array]";
	    }

	    this.up();

	    while (i--) {
	      ret[i] = this.parse(arr[i], undefined, stack);
	    }

	    this.down();
	    return join("[", ret, "]");
	  }

	  function isArray(obj) {
	    return (//Native Arrays
	      toString.call(obj) === "[object Array]" || // NodeList objects
	      typeof obj.length === "number" && obj.item !== undefined && (obj.length ? obj.item(0) === obj[0] : obj.item(0) === null && obj[0] === undefined)
	    );
	  }

	  var reName = /^function (\w+)/,
	      dump = {
	    // The objType is used mostly internally, you can fix a (custom) type in advance
	    parse: function parse(obj, objType, stack) {
	      stack = stack || [];
	      var res,
	          parser,
	          parserType,
	          objIndex = stack.indexOf(obj);

	      if (objIndex !== -1) {
	        return "recursion(".concat(objIndex - stack.length, ")");
	      }

	      objType = objType || this.typeOf(obj);
	      parser = this.parsers[objType];
	      parserType = _typeof(parser);

	      if (parserType === "function") {
	        stack.push(obj);
	        res = parser.call(this, obj, stack);
	        stack.pop();
	        return res;
	      }

	      return parserType === "string" ? parser : this.parsers.error;
	    },
	    typeOf: function typeOf(obj) {
	      var type;

	      if (obj === null) {
	        type = "null";
	      } else if (typeof obj === "undefined") {
	        type = "undefined";
	      } else if (is("regexp", obj)) {
	        type = "regexp";
	      } else if (is("date", obj)) {
	        type = "date";
	      } else if (is("function", obj)) {
	        type = "function";
	      } else if (obj.setInterval !== undefined && obj.document !== undefined && obj.nodeType === undefined) {
	        type = "window";
	      } else if (obj.nodeType === 9) {
	        type = "document";
	      } else if (obj.nodeType) {
	        type = "node";
	      } else if (isArray(obj)) {
	        type = "array";
	      } else if (obj.constructor === Error.prototype.constructor) {
	        type = "error";
	      } else {
	        type = _typeof(obj);
	      }

	      return type;
	    },
	    separator: function separator() {
	      if (this.multiline) {
	        return this.HTML ? "<br />" : "\n";
	      } else {
	        return this.HTML ? "&#160;" : " ";
	      }
	    },
	    // Extra can be a number, shortcut for increasing-calling-decreasing
	    indent: function indent(extra) {
	      if (!this.multiline) {
	        return "";
	      }

	      var chr = this.indentChar;

	      if (this.HTML) {
	        chr = chr.replace(/\t/g, "   ").replace(/ /g, "&#160;");
	      }

	      return new Array(this.depth + (extra || 0)).join(chr);
	    },
	    up: function up(a) {
	      this.depth += a || 1;
	    },
	    down: function down(a) {
	      this.depth -= a || 1;
	    },
	    setParser: function setParser(name, parser) {
	      this.parsers[name] = parser;
	    },
	    // The next 3 are exposed so you can use them
	    quote: quote,
	    literal: literal,
	    join: join,
	    depth: 1,
	    maxDepth: config.maxDepth,
	    // This is the list of parsers, to modify them, use dump.setParser
	    parsers: {
	      window: "[Window]",
	      document: "[Document]",
	      error: function error(_error) {
	        return "Error(\"" + _error.message + "\")";
	      },
	      unknown: "[Unknown]",
	      "null": "null",
	      "undefined": "undefined",
	      "function": function _function(fn) {
	        var ret = "function",
	            // Functions never have name in IE
	        name = "name" in fn ? fn.name : (reName.exec(fn) || [])[1];

	        if (name) {
	          ret += " " + name;
	        }

	        ret += "(";
	        ret = [ret, dump.parse(fn, "functionArgs"), "){"].join("");
	        return join(ret, dump.parse(fn, "functionCode"), "}");
	      },
	      array: array,
	      nodelist: array,
	      "arguments": array,
	      object: function object(map, stack) {
	        var keys,
	            key,
	            val,
	            i,
	            nonEnumerableProperties,
	            ret = [];

	        if (dump.maxDepth && dump.depth > dump.maxDepth) {
	          return "[object Object]";
	        }

	        dump.up();
	        keys = [];

	        for (key in map) {
	          keys.push(key);
	        } // Some properties are not always enumerable on Error objects.


	        nonEnumerableProperties = ["message", "name"];

	        for (i in nonEnumerableProperties) {
	          key = nonEnumerableProperties[i];

	          if (key in map && !inArray(key, keys)) {
	            keys.push(key);
	          }
	        }

	        keys.sort();

	        for (i = 0; i < keys.length; i++) {
	          key = keys[i];
	          val = map[key];
	          ret.push(dump.parse(key, "key") + ": " + dump.parse(val, undefined, stack));
	        }

	        dump.down();
	        return join("{", ret, "}");
	      },
	      node: function node(_node) {
	        var len,
	            i,
	            val,
	            open = dump.HTML ? "&lt;" : "<",
	            close = dump.HTML ? "&gt;" : ">",
	            tag = _node.nodeName.toLowerCase(),
	            ret = open + tag,
	            attrs = _node.attributes;

	        if (attrs) {
	          for (i = 0, len = attrs.length; i < len; i++) {
	            val = attrs[i].nodeValue; // IE6 includes all attributes in .attributes, even ones not explicitly
	            // set. Those have values like undefined, null, 0, false, "" or
	            // "inherit".

	            if (val && val !== "inherit") {
	              ret += " " + attrs[i].nodeName + "=" + dump.parse(val, "attribute");
	            }
	          }
	        }

	        ret += close; // Show content of TextNode or CDATASection

	        if (_node.nodeType === 3 || _node.nodeType === 4) {
	          ret += _node.nodeValue;
	        }

	        return ret + open + "/" + tag + close;
	      },
	      // Function calls it internally, it's the arguments part of the function
	      functionArgs: function functionArgs(fn) {
	        var args,
	            l = fn.length;

	        if (!l) {
	          return "";
	        }

	        args = new Array(l);

	        while (l--) {
	          // 97 is 'a'
	          args[l] = String.fromCharCode(97 + l);
	        }

	        return " " + args.join(", ") + " ";
	      },
	      // Object calls it internally, the key part of an item in a map
	      key: quote,
	      // Function calls it internally, it's the content of the function
	      functionCode: "[code]",
	      // Node calls it internally, it's a html attribute value
	      attribute: quote,
	      string: quote,
	      date: quote,
	      regexp: literal,
	      number: literal,
	      "boolean": literal,
	      symbol: function symbol(sym) {
	        return sym.toString();
	      }
	    },
	    // If true, entities are escaped ( <, >, \t, space and \n )
	    HTML: false,
	    // Indentation unit
	    indentChar: "  ",
	    // If true, items in a collection, are separated by a \n, else just a space.
	    multiline: true
	  };
	  return dump;
	})();

	var SuiteReport = /*#__PURE__*/function () {
	  function SuiteReport(name, parentSuite) {
	    _classCallCheck(this, SuiteReport);

	    this.name = name;
	    this.fullName = parentSuite ? parentSuite.fullName.concat(name) : [];
	    this.tests = [];
	    this.childSuites = [];

	    if (parentSuite) {
	      parentSuite.pushChildSuite(this);
	    }
	  }

	  _createClass(SuiteReport, [{
	    key: "start",
	    value: function start(recordTime) {
	      if (recordTime) {
	        this._startTime = performanceNow();

	        if (performance) {
	          var suiteLevel = this.fullName.length;
	          performance.mark("qunit_suite_".concat(suiteLevel, "_start"));
	        }
	      }

	      return {
	        name: this.name,
	        fullName: this.fullName.slice(),
	        tests: this.tests.map(function (test) {
	          return test.start();
	        }),
	        childSuites: this.childSuites.map(function (suite) {
	          return suite.start();
	        }),
	        testCounts: {
	          total: this.getTestCounts().total
	        }
	      };
	    }
	  }, {
	    key: "end",
	    value: function end(recordTime) {
	      if (recordTime) {
	        this._endTime = performanceNow();

	        if (performance) {
	          var suiteLevel = this.fullName.length;
	          performance.mark("qunit_suite_".concat(suiteLevel, "_end"));
	          var suiteName = this.fullName.join(" – ");
	          measure(suiteLevel === 0 ? "QUnit Test Run" : "QUnit Test Suite: ".concat(suiteName), "qunit_suite_".concat(suiteLevel, "_start"), "qunit_suite_".concat(suiteLevel, "_end"));
	        }
	      }

	      return {
	        name: this.name,
	        fullName: this.fullName.slice(),
	        tests: this.tests.map(function (test) {
	          return test.end();
	        }),
	        childSuites: this.childSuites.map(function (suite) {
	          return suite.end();
	        }),
	        testCounts: this.getTestCounts(),
	        runtime: this.getRuntime(),
	        status: this.getStatus()
	      };
	    }
	  }, {
	    key: "pushChildSuite",
	    value: function pushChildSuite(suite) {
	      this.childSuites.push(suite);
	    }
	  }, {
	    key: "pushTest",
	    value: function pushTest(test) {
	      this.tests.push(test);
	    }
	  }, {
	    key: "getRuntime",
	    value: function getRuntime() {
	      return this._endTime - this._startTime;
	    }
	  }, {
	    key: "getTestCounts",
	    value: function getTestCounts() {
	      var counts = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {
	        passed: 0,
	        failed: 0,
	        skipped: 0,
	        todo: 0,
	        total: 0
	      };
	      counts = this.tests.reduce(function (counts, test) {
	        if (test.valid) {
	          counts[test.getStatus()]++;
	          counts.total++;
	        }

	        return counts;
	      }, counts);
	      return this.childSuites.reduce(function (counts, suite) {
	        return suite.getTestCounts(counts);
	      }, counts);
	    }
	  }, {
	    key: "getStatus",
	    value: function getStatus() {
	      var _this$getTestCounts = this.getTestCounts(),
	          total = _this$getTestCounts.total,
	          failed = _this$getTestCounts.failed,
	          skipped = _this$getTestCounts.skipped,
	          todo = _this$getTestCounts.todo;

	      if (failed) {
	        return "failed";
	      } else {
	        if (skipped === total) {
	          return "skipped";
	        } else if (todo === total) {
	          return "todo";
	        } else {
	          return "passed";
	        }
	      }
	    }
	  }]);

	  return SuiteReport;
	}();

	var focused = false;
	var moduleStack = [];

	function isParentModuleInQueue() {
	  var modulesInQueue = config.modules.map(function (module) {
	    return module.moduleId;
	  });
	  return moduleStack.some(function (module) {
	    return modulesInQueue.includes(module.moduleId);
	  });
	}

	function createModule(name, testEnvironment, modifiers) {
	  var parentModule = moduleStack.length ? moduleStack.slice(-1)[0] : null;
	  var moduleName = parentModule !== null ? [parentModule.name, name].join(" > ") : name;
	  var parentSuite = parentModule ? parentModule.suiteReport : globalSuite;
	  var skip = parentModule !== null && parentModule.skip || modifiers.skip;
	  var todo = parentModule !== null && parentModule.todo || modifiers.todo;
	  var module = {
	    name: moduleName,
	    parentModule: parentModule,
	    tests: [],
	    moduleId: generateHash(moduleName),
	    testsRun: 0,
	    unskippedTestsRun: 0,
	    childModules: [],
	    suiteReport: new SuiteReport(name, parentSuite),
	    // Pass along `skip` and `todo` properties from parent module, in case
	    // there is one, to childs. And use own otherwise.
	    // This property will be used to mark own tests and tests of child suites
	    // as either `skipped` or `todo`.
	    skip: skip,
	    todo: skip ? false : todo
	  };
	  var env = {};

	  if (parentModule) {
	    parentModule.childModules.push(module);
	    extend(env, parentModule.testEnvironment);
	  }

	  extend(env, testEnvironment);
	  module.testEnvironment = env;
	  config.modules.push(module);
	  return module;
	}

	function processModule(name, options, executeNow) {
	  var modifiers = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};

	  if (objectType(options) === "function") {
	    executeNow = options;
	    options = undefined;
	  }

	  var module = createModule(name, options, modifiers); // Move any hooks to a 'hooks' object

	  var testEnvironment = module.testEnvironment;
	  var hooks = module.hooks = {};
	  setHookFromEnvironment(hooks, testEnvironment, "before");
	  setHookFromEnvironment(hooks, testEnvironment, "beforeEach");
	  setHookFromEnvironment(hooks, testEnvironment, "afterEach");
	  setHookFromEnvironment(hooks, testEnvironment, "after");
	  var moduleFns = {
	    before: setHookFunction(module, "before"),
	    beforeEach: setHookFunction(module, "beforeEach"),
	    afterEach: setHookFunction(module, "afterEach"),
	    after: setHookFunction(module, "after")
	  };
	  var currentModule = config.currentModule;

	  if (objectType(executeNow) === "function") {
	    moduleStack.push(module);
	    config.currentModule = module;
	    executeNow.call(module.testEnvironment, moduleFns);
	    moduleStack.pop();
	    module = module.parentModule || currentModule;
	  }

	  config.currentModule = module;

	  function setHookFromEnvironment(hooks, environment, name) {
	    var potentialHook = environment[name];
	    hooks[name] = typeof potentialHook === "function" ? [potentialHook] : [];
	    delete environment[name];
	  }

	  function setHookFunction(module, hookName) {
	    return function setHook(callback) {
	      module.hooks[hookName].push(callback);
	    };
	  }
	}

	function module$1(name, options, executeNow) {
	  if (focused && !isParentModuleInQueue()) {
	    return;
	  }

	  processModule(name, options, executeNow);
	}

	module$1.only = function () {
	  if (!focused) {
	    config.modules.length = 0;
	    config.queue.length = 0;
	  }

	  processModule.apply(void 0, arguments);
	  focused = true;
	};

	module$1.skip = function (name, options, executeNow) {
	  if (focused) {
	    return;
	  }

	  processModule(name, options, executeNow, {
	    skip: true
	  });
	};

	module$1.todo = function (name, options, executeNow) {
	  if (focused) {
	    return;
	  }

	  processModule(name, options, executeNow, {
	    todo: true
	  });
	};

	var LISTENERS = Object.create(null);
	var SUPPORTED_EVENTS = ["runStart", "suiteStart", "testStart", "assertion", "testEnd", "suiteEnd", "runEnd"];
	/**
	 * Emits an event with the specified data to all currently registered listeners.
	 * Callbacks will fire in the order in which they are registered (FIFO). This
	 * function is not exposed publicly; it is used by QUnit internals to emit
	 * logging events.
	 *
	 * @private
	 * @method emit
	 * @param {String} eventName
	 * @param {Object} data
	 * @return {Void}
	 */

	function emit(eventName, data) {
	  if (objectType(eventName) !== "string") {
	    throw new TypeError("eventName must be a string when emitting an event");
	  } // Clone the callbacks in case one of them registers a new callback


	  var originalCallbacks = LISTENERS[eventName];
	  var callbacks = originalCallbacks ? _toConsumableArray(originalCallbacks) : [];

	  for (var i = 0; i < callbacks.length; i++) {
	    callbacks[i](data);
	  }
	}
	/**
	 * Registers a callback as a listener to the specified event.
	 *
	 * @public
	 * @method on
	 * @param {String} eventName
	 * @param {Function} callback
	 * @return {Void}
	 */

	function on(eventName, callback) {
	  if (objectType(eventName) !== "string") {
	    throw new TypeError("eventName must be a string when registering a listener");
	  } else if (!inArray(eventName, SUPPORTED_EVENTS)) {
	    var events = SUPPORTED_EVENTS.join(", ");
	    throw new Error("\"".concat(eventName, "\" is not a valid event; must be one of: ").concat(events, "."));
	  } else if (objectType(callback) !== "function") {
	    throw new TypeError("callback must be a function when registering a listener");
	  }

	  if (!LISTENERS[eventName]) {
	    LISTENERS[eventName] = [];
	  } // Don't register the same callback more than once


	  if (!inArray(callback, LISTENERS[eventName])) {
	    LISTENERS[eventName].push(callback);
	  }
	}

	var commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};

	function createCommonjsModule(fn, basedir, module) {
		return module = {
		  path: basedir,
		  exports: {},
		  require: function (path, base) {
	      return commonjsRequire(path, (base === undefined || base === null) ? module.path : base);
	    }
		}, fn(module, module.exports), module.exports;
	}

	function commonjsRequire () {
		throw new Error('Dynamic requires are not currently supported by @rollup/plugin-commonjs');
	}

	var es6Promise = createCommonjsModule(function (module, exports) {
	  /*!
	   * @overview es6-promise - a tiny implementation of Promises/A+.
	   * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
	   * @license   Licensed under MIT license
	   *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
	   * @version   v4.2.8+1e68dce6
	   */
	  (function (global, factory) {
	     module.exports = factory() ;
	  })(commonjsGlobal, function () {

	    function objectOrFunction(x) {
	      var type = typeof x;
	      return x !== null && (type === 'object' || type === 'function');
	    }

	    function isFunction(x) {
	      return typeof x === 'function';
	    }

	    var _isArray = void 0;

	    if (Array.isArray) {
	      _isArray = Array.isArray;
	    } else {
	      _isArray = function (x) {
	        return Object.prototype.toString.call(x) === '[object Array]';
	      };
	    }

	    var isArray = _isArray;
	    var len = 0;
	    var vertxNext = void 0;
	    var customSchedulerFn = void 0;

	    var asap = function asap(callback, arg) {
	      queue[len] = callback;
	      queue[len + 1] = arg;
	      len += 2;

	      if (len === 2) {
	        // If len is 2, that means that we need to schedule an async flush.
	        // If additional callbacks are queued before the queue is flushed, they
	        // will be processed by this flush that we are scheduling.
	        if (customSchedulerFn) {
	          customSchedulerFn(flush);
	        } else {
	          scheduleFlush();
	        }
	      }
	    };

	    function setScheduler(scheduleFn) {
	      customSchedulerFn = scheduleFn;
	    }

	    function setAsap(asapFn) {
	      asap = asapFn;
	    }

	    var browserWindow = typeof window !== 'undefined' ? window : undefined;
	    var browserGlobal = browserWindow || {};
	    var BrowserMutationObserver = browserGlobal.MutationObserver || browserGlobal.WebKitMutationObserver;
	    var isNode = typeof self === 'undefined' && typeof process !== 'undefined' && {}.toString.call(process) === '[object process]'; // test for web worker but not in IE10

	    var isWorker = typeof Uint8ClampedArray !== 'undefined' && typeof importScripts !== 'undefined' && typeof MessageChannel !== 'undefined'; // node

	    function useNextTick() {
	      // node version 0.10.x displays a deprecation warning when nextTick is used recursively
	      // see https://github.com/cujojs/when/issues/410 for details
	      return function () {
	        return process.nextTick(flush);
	      };
	    } // vertx


	    function useVertxTimer() {
	      if (typeof vertxNext !== 'undefined') {
	        return function () {
	          vertxNext(flush);
	        };
	      }

	      return useSetTimeout();
	    }

	    function useMutationObserver() {
	      var iterations = 0;
	      var observer = new BrowserMutationObserver(flush);
	      var node = document.createTextNode('');
	      observer.observe(node, {
	        characterData: true
	      });
	      return function () {
	        node.data = iterations = ++iterations % 2;
	      };
	    } // web worker


	    function useMessageChannel() {
	      var channel = new MessageChannel();
	      channel.port1.onmessage = flush;
	      return function () {
	        return channel.port2.postMessage(0);
	      };
	    }

	    function useSetTimeout() {
	      // Store setTimeout reference so es6-promise will be unaffected by
	      // other code modifying setTimeout (like sinon.useFakeTimers())
	      var globalSetTimeout = setTimeout;
	      return function () {
	        return globalSetTimeout(flush, 1);
	      };
	    }

	    var queue = new Array(1000);

	    function flush() {
	      for (var i = 0; i < len; i += 2) {
	        var callback = queue[i];
	        var arg = queue[i + 1];
	        callback(arg);
	        queue[i] = undefined;
	        queue[i + 1] = undefined;
	      }

	      len = 0;
	    }

	    function attemptVertx() {
	      try {
	        var vertx = Function('return this')().require('vertx');

	        vertxNext = vertx.runOnLoop || vertx.runOnContext;
	        return useVertxTimer();
	      } catch (e) {
	        return useSetTimeout();
	      }
	    }

	    var scheduleFlush = void 0; // Decide what async method to use to triggering processing of queued callbacks:

	    if (isNode) {
	      scheduleFlush = useNextTick();
	    } else if (BrowserMutationObserver) {
	      scheduleFlush = useMutationObserver();
	    } else if (isWorker) {
	      scheduleFlush = useMessageChannel();
	    } else if (browserWindow === undefined && typeof commonjsRequire === 'function') {
	      scheduleFlush = attemptVertx();
	    } else {
	      scheduleFlush = useSetTimeout();
	    }

	    function then(onFulfillment, onRejection) {
	      var parent = this;
	      var child = new this.constructor(noop);

	      if (child[PROMISE_ID] === undefined) {
	        makePromise(child);
	      }

	      var _state = parent._state;

	      if (_state) {
	        var callback = arguments[_state - 1];
	        asap(function () {
	          return invokeCallback(_state, child, callback, parent._result);
	        });
	      } else {
	        subscribe(parent, child, onFulfillment, onRejection);
	      }

	      return child;
	    }
	    /**
	      `Promise.resolve` returns a promise that will become resolved with the
	      passed `value`. It is shorthand for the following:
	    
	      ```javascript
	      let promise = new Promise(function(resolve, reject){
	        resolve(1);
	      });
	    
	      promise.then(function(value){
	        // value === 1
	      });
	      ```
	    
	      Instead of writing the above, your code now simply becomes the following:
	    
	      ```javascript
	      let promise = Promise.resolve(1);
	    
	      promise.then(function(value){
	        // value === 1
	      });
	      ```
	    
	      @method resolve
	      @static
	      @param {Any} value value that the returned promise will be resolved with
	      Useful for tooling.
	      @return {Promise} a promise that will become fulfilled with the given
	      `value`
	    */


	    function resolve$1(object) {
	      /*jshint validthis:true */
	      var Constructor = this;

	      if (object && typeof object === 'object' && object.constructor === Constructor) {
	        return object;
	      }

	      var promise = new Constructor(noop);
	      resolve(promise, object);
	      return promise;
	    }

	    var PROMISE_ID = Math.random().toString(36).substring(2);

	    function noop() {}

	    var PENDING = void 0;
	    var FULFILLED = 1;
	    var REJECTED = 2;

	    function selfFulfillment() {
	      return new TypeError("You cannot resolve a promise with itself");
	    }

	    function cannotReturnOwn() {
	      return new TypeError('A promises callback cannot return that same promise.');
	    }

	    function tryThen(then$$1, value, fulfillmentHandler, rejectionHandler) {
	      try {
	        then$$1.call(value, fulfillmentHandler, rejectionHandler);
	      } catch (e) {
	        return e;
	      }
	    }

	    function handleForeignThenable(promise, thenable, then$$1) {
	      asap(function (promise) {
	        var sealed = false;
	        var error = tryThen(then$$1, thenable, function (value) {
	          if (sealed) {
	            return;
	          }

	          sealed = true;

	          if (thenable !== value) {
	            resolve(promise, value);
	          } else {
	            fulfill(promise, value);
	          }
	        }, function (reason) {
	          if (sealed) {
	            return;
	          }

	          sealed = true;
	          reject(promise, reason);
	        }, 'Settle: ' + (promise._label || ' unknown promise'));

	        if (!sealed && error) {
	          sealed = true;
	          reject(promise, error);
	        }
	      }, promise);
	    }

	    function handleOwnThenable(promise, thenable) {
	      if (thenable._state === FULFILLED) {
	        fulfill(promise, thenable._result);
	      } else if (thenable._state === REJECTED) {
	        reject(promise, thenable._result);
	      } else {
	        subscribe(thenable, undefined, function (value) {
	          return resolve(promise, value);
	        }, function (reason) {
	          return reject(promise, reason);
	        });
	      }
	    }

	    function handleMaybeThenable(promise, maybeThenable, then$$1) {
	      if (maybeThenable.constructor === promise.constructor && then$$1 === then && maybeThenable.constructor.resolve === resolve$1) {
	        handleOwnThenable(promise, maybeThenable);
	      } else {
	        if (then$$1 === undefined) {
	          fulfill(promise, maybeThenable);
	        } else if (isFunction(then$$1)) {
	          handleForeignThenable(promise, maybeThenable, then$$1);
	        } else {
	          fulfill(promise, maybeThenable);
	        }
	      }
	    }

	    function resolve(promise, value) {
	      if (promise === value) {
	        reject(promise, selfFulfillment());
	      } else if (objectOrFunction(value)) {
	        var then$$1 = void 0;

	        try {
	          then$$1 = value.then;
	        } catch (error) {
	          reject(promise, error);
	          return;
	        }

	        handleMaybeThenable(promise, value, then$$1);
	      } else {
	        fulfill(promise, value);
	      }
	    }

	    function publishRejection(promise) {
	      if (promise._onerror) {
	        promise._onerror(promise._result);
	      }

	      publish(promise);
	    }

	    function fulfill(promise, value) {
	      if (promise._state !== PENDING) {
	        return;
	      }

	      promise._result = value;
	      promise._state = FULFILLED;

	      if (promise._subscribers.length !== 0) {
	        asap(publish, promise);
	      }
	    }

	    function reject(promise, reason) {
	      if (promise._state !== PENDING) {
	        return;
	      }

	      promise._state = REJECTED;
	      promise._result = reason;
	      asap(publishRejection, promise);
	    }

	    function subscribe(parent, child, onFulfillment, onRejection) {
	      var _subscribers = parent._subscribers;
	      var length = _subscribers.length;
	      parent._onerror = null;
	      _subscribers[length] = child;
	      _subscribers[length + FULFILLED] = onFulfillment;
	      _subscribers[length + REJECTED] = onRejection;

	      if (length === 0 && parent._state) {
	        asap(publish, parent);
	      }
	    }

	    function publish(promise) {
	      var subscribers = promise._subscribers;
	      var settled = promise._state;

	      if (subscribers.length === 0) {
	        return;
	      }

	      var child = void 0,
	          callback = void 0,
	          detail = promise._result;

	      for (var i = 0; i < subscribers.length; i += 3) {
	        child = subscribers[i];
	        callback = subscribers[i + settled];

	        if (child) {
	          invokeCallback(settled, child, callback, detail);
	        } else {
	          callback(detail);
	        }
	      }

	      promise._subscribers.length = 0;
	    }

	    function invokeCallback(settled, promise, callback, detail) {
	      var hasCallback = isFunction(callback),
	          value = void 0,
	          error = void 0,
	          succeeded = true;

	      if (hasCallback) {
	        try {
	          value = callback(detail);
	        } catch (e) {
	          succeeded = false;
	          error = e;
	        }

	        if (promise === value) {
	          reject(promise, cannotReturnOwn());
	          return;
	        }
	      } else {
	        value = detail;
	      }

	      if (promise._state !== PENDING) ; else if (hasCallback && succeeded) {
	        resolve(promise, value);
	      } else if (succeeded === false) {
	        reject(promise, error);
	      } else if (settled === FULFILLED) {
	        fulfill(promise, value);
	      } else if (settled === REJECTED) {
	        reject(promise, value);
	      }
	    }

	    function initializePromise(promise, resolver) {
	      try {
	        resolver(function resolvePromise(value) {
	          resolve(promise, value);
	        }, function rejectPromise(reason) {
	          reject(promise, reason);
	        });
	      } catch (e) {
	        reject(promise, e);
	      }
	    }

	    var id = 0;

	    function nextId() {
	      return id++;
	    }

	    function makePromise(promise) {
	      promise[PROMISE_ID] = id++;
	      promise._state = undefined;
	      promise._result = undefined;
	      promise._subscribers = [];
	    }

	    function validationError() {
	      return new Error('Array Methods must be provided an Array');
	    }

	    var Enumerator = function () {
	      function Enumerator(Constructor, input) {
	        this._instanceConstructor = Constructor;
	        this.promise = new Constructor(noop);

	        if (!this.promise[PROMISE_ID]) {
	          makePromise(this.promise);
	        }

	        if (isArray(input)) {
	          this.length = input.length;
	          this._remaining = input.length;
	          this._result = new Array(this.length);

	          if (this.length === 0) {
	            fulfill(this.promise, this._result);
	          } else {
	            this.length = this.length || 0;

	            this._enumerate(input);

	            if (this._remaining === 0) {
	              fulfill(this.promise, this._result);
	            }
	          }
	        } else {
	          reject(this.promise, validationError());
	        }
	      }

	      Enumerator.prototype._enumerate = function _enumerate(input) {
	        for (var i = 0; this._state === PENDING && i < input.length; i++) {
	          this._eachEntry(input[i], i);
	        }
	      };

	      Enumerator.prototype._eachEntry = function _eachEntry(entry, i) {
	        var c = this._instanceConstructor;
	        var resolve$$1 = c.resolve;

	        if (resolve$$1 === resolve$1) {
	          var _then = void 0;

	          var error = void 0;
	          var didError = false;

	          try {
	            _then = entry.then;
	          } catch (e) {
	            didError = true;
	            error = e;
	          }

	          if (_then === then && entry._state !== PENDING) {
	            this._settledAt(entry._state, i, entry._result);
	          } else if (typeof _then !== 'function') {
	            this._remaining--;
	            this._result[i] = entry;
	          } else if (c === Promise$1) {
	            var promise = new c(noop);

	            if (didError) {
	              reject(promise, error);
	            } else {
	              handleMaybeThenable(promise, entry, _then);
	            }

	            this._willSettleAt(promise, i);
	          } else {
	            this._willSettleAt(new c(function (resolve$$1) {
	              return resolve$$1(entry);
	            }), i);
	          }
	        } else {
	          this._willSettleAt(resolve$$1(entry), i);
	        }
	      };

	      Enumerator.prototype._settledAt = function _settledAt(state, i, value) {
	        var promise = this.promise;

	        if (promise._state === PENDING) {
	          this._remaining--;

	          if (state === REJECTED) {
	            reject(promise, value);
	          } else {
	            this._result[i] = value;
	          }
	        }

	        if (this._remaining === 0) {
	          fulfill(promise, this._result);
	        }
	      };

	      Enumerator.prototype._willSettleAt = function _willSettleAt(promise, i) {
	        var enumerator = this;
	        subscribe(promise, undefined, function (value) {
	          return enumerator._settledAt(FULFILLED, i, value);
	        }, function (reason) {
	          return enumerator._settledAt(REJECTED, i, reason);
	        });
	      };

	      return Enumerator;
	    }();
	    /**
	      `Promise.all` accepts an array of promises, and returns a new promise which
	      is fulfilled with an array of fulfillment values for the passed promises, or
	      rejected with the reason of the first passed promise to be rejected. It casts all
	      elements of the passed iterable to promises as it runs this algorithm.
	    
	      Example:
	    
	      ```javascript
	      let promise1 = resolve(1);
	      let promise2 = resolve(2);
	      let promise3 = resolve(3);
	      let promises = [ promise1, promise2, promise3 ];
	    
	      Promise.all(promises).then(function(array){
	        // The array here would be [ 1, 2, 3 ];
	      });
	      ```
	    
	      If any of the `promises` given to `all` are rejected, the first promise
	      that is rejected will be given as an argument to the returned promises's
	      rejection handler. For example:
	    
	      Example:
	    
	      ```javascript
	      let promise1 = resolve(1);
	      let promise2 = reject(new Error("2"));
	      let promise3 = reject(new Error("3"));
	      let promises = [ promise1, promise2, promise3 ];
	    
	      Promise.all(promises).then(function(array){
	        // Code here never runs because there are rejected promises!
	      }, function(error) {
	        // error.message === "2"
	      });
	      ```
	    
	      @method all
	      @static
	      @param {Array} entries array of promises
	      @param {String} label optional string for labeling the promise.
	      Useful for tooling.
	      @return {Promise} promise that is fulfilled when all `promises` have been
	      fulfilled, or rejected if any of them become rejected.
	      @static
	    */


	    function all(entries) {
	      return new Enumerator(this, entries).promise;
	    }
	    /**
	      `Promise.race` returns a new promise which is settled in the same way as the
	      first passed promise to settle.
	    
	      Example:
	    
	      ```javascript
	      let promise1 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 1');
	        }, 200);
	      });
	    
	      let promise2 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 2');
	        }, 100);
	      });
	    
	      Promise.race([promise1, promise2]).then(function(result){
	        // result === 'promise 2' because it was resolved before promise1
	        // was resolved.
	      });
	      ```
	    
	      `Promise.race` is deterministic in that only the state of the first
	      settled promise matters. For example, even if other promises given to the
	      `promises` array argument are resolved, but the first settled promise has
	      become rejected before the other promises became fulfilled, the returned
	      promise will become rejected:
	    
	      ```javascript
	      let promise1 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          resolve('promise 1');
	        }, 200);
	      });
	    
	      let promise2 = new Promise(function(resolve, reject){
	        setTimeout(function(){
	          reject(new Error('promise 2'));
	        }, 100);
	      });
	    
	      Promise.race([promise1, promise2]).then(function(result){
	        // Code here never runs
	      }, function(reason){
	        // reason.message === 'promise 2' because promise 2 became rejected before
	        // promise 1 became fulfilled
	      });
	      ```
	    
	      An example real-world use case is implementing timeouts:
	    
	      ```javascript
	      Promise.race([ajax('foo.json'), timeout(5000)])
	      ```
	    
	      @method race
	      @static
	      @param {Array} promises array of promises to observe
	      Useful for tooling.
	      @return {Promise} a promise which settles in the same way as the first passed
	      promise to settle.
	    */


	    function race(entries) {
	      /*jshint validthis:true */
	      var Constructor = this;

	      if (!isArray(entries)) {
	        return new Constructor(function (_, reject) {
	          return reject(new TypeError('You must pass an array to race.'));
	        });
	      } else {
	        return new Constructor(function (resolve, reject) {
	          var length = entries.length;

	          for (var i = 0; i < length; i++) {
	            Constructor.resolve(entries[i]).then(resolve, reject);
	          }
	        });
	      }
	    }
	    /**
	      `Promise.reject` returns a promise rejected with the passed `reason`.
	      It is shorthand for the following:
	    
	      ```javascript
	      let promise = new Promise(function(resolve, reject){
	        reject(new Error('WHOOPS'));
	      });
	    
	      promise.then(function(value){
	        // Code here doesn't run because the promise is rejected!
	      }, function(reason){
	        // reason.message === 'WHOOPS'
	      });
	      ```
	    
	      Instead of writing the above, your code now simply becomes the following:
	    
	      ```javascript
	      let promise = Promise.reject(new Error('WHOOPS'));
	    
	      promise.then(function(value){
	        // Code here doesn't run because the promise is rejected!
	      }, function(reason){
	        // reason.message === 'WHOOPS'
	      });
	      ```
	    
	      @method reject
	      @static
	      @param {Any} reason value that the returned promise will be rejected with.
	      Useful for tooling.
	      @return {Promise} a promise rejected with the given `reason`.
	    */


	    function reject$1(reason) {
	      /*jshint validthis:true */
	      var Constructor = this;
	      var promise = new Constructor(noop);
	      reject(promise, reason);
	      return promise;
	    }

	    function needsResolver() {
	      throw new TypeError('You must pass a resolver function as the first argument to the promise constructor');
	    }

	    function needsNew() {
	      throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
	    }
	    /**
	      Promise objects represent the eventual result of an asynchronous operation. The
	      primary way of interacting with a promise is through its `then` method, which
	      registers callbacks to receive either a promise's eventual value or the reason
	      why the promise cannot be fulfilled.
	    
	      Terminology
	      -----------
	    
	      - `promise` is an object or function with a `then` method whose behavior conforms to this specification.
	      - `thenable` is an object or function that defines a `then` method.
	      - `value` is any legal JavaScript value (including undefined, a thenable, or a promise).
	      - `exception` is a value that is thrown using the throw statement.
	      - `reason` is a value that indicates why a promise was rejected.
	      - `settled` the final resting state of a promise, fulfilled or rejected.
	    
	      A promise can be in one of three states: pending, fulfilled, or rejected.
	    
	      Promises that are fulfilled have a fulfillment value and are in the fulfilled
	      state.  Promises that are rejected have a rejection reason and are in the
	      rejected state.  A fulfillment value is never a thenable.
	    
	      Promises can also be said to *resolve* a value.  If this value is also a
	      promise, then the original promise's settled state will match the value's
	      settled state.  So a promise that *resolves* a promise that rejects will
	      itself reject, and a promise that *resolves* a promise that fulfills will
	      itself fulfill.
	    
	    
	      Basic Usage:
	      ------------
	    
	      ```js
	      let promise = new Promise(function(resolve, reject) {
	        // on success
	        resolve(value);
	    
	        // on failure
	        reject(reason);
	      });
	    
	      promise.then(function(value) {
	        // on fulfillment
	      }, function(reason) {
	        // on rejection
	      });
	      ```
	    
	      Advanced Usage:
	      ---------------
	    
	      Promises shine when abstracting away asynchronous interactions such as
	      `XMLHttpRequest`s.
	    
	      ```js
	      function getJSON(url) {
	        return new Promise(function(resolve, reject){
	          let xhr = new XMLHttpRequest();
	    
	          xhr.open('GET', url);
	          xhr.onreadystatechange = handler;
	          xhr.responseType = 'json';
	          xhr.setRequestHeader('Accept', 'application/json');
	          xhr.send();
	    
	          function handler() {
	            if (this.readyState === this.DONE) {
	              if (this.status === 200) {
	                resolve(this.response);
	              } else {
	                reject(new Error('getJSON: `' + url + '` failed with status: [' + this.status + ']'));
	              }
	            }
	          };
	        });
	      }
	    
	      getJSON('/posts.json').then(function(json) {
	        // on fulfillment
	      }, function(reason) {
	        // on rejection
	      });
	      ```
	    
	      Unlike callbacks, promises are great composable primitives.
	    
	      ```js
	      Promise.all([
	        getJSON('/posts'),
	        getJSON('/comments')
	      ]).then(function(values){
	        values[0] // => postsJSON
	        values[1] // => commentsJSON
	    
	        return values;
	      });
	      ```
	    
	      @class Promise
	      @param {Function} resolver
	      Useful for tooling.
	      @constructor
	    */


	    var Promise$1 = function () {
	      function Promise(resolver) {
	        this[PROMISE_ID] = nextId();
	        this._result = this._state = undefined;
	        this._subscribers = [];

	        if (noop !== resolver) {
	          typeof resolver !== 'function' && needsResolver();
	          this instanceof Promise ? initializePromise(this, resolver) : needsNew();
	        }
	      }
	      /**
	      The primary way of interacting with a promise is through its `then` method,
	      which registers callbacks to receive either a promise's eventual value or the
	      reason why the promise cannot be fulfilled.
	       ```js
	      findUser().then(function(user){
	        // user is available
	      }, function(reason){
	        // user is unavailable, and you are given the reason why
	      });
	      ```
	       Chaining
	      --------
	       The return value of `then` is itself a promise.  This second, 'downstream'
	      promise is resolved with the return value of the first promise's fulfillment
	      or rejection handler, or rejected if the handler throws an exception.
	       ```js
	      findUser().then(function (user) {
	        return user.name;
	      }, function (reason) {
	        return 'default name';
	      }).then(function (userName) {
	        // If `findUser` fulfilled, `userName` will be the user's name, otherwise it
	        // will be `'default name'`
	      });
	       findUser().then(function (user) {
	        throw new Error('Found user, but still unhappy');
	      }, function (reason) {
	        throw new Error('`findUser` rejected and we're unhappy');
	      }).then(function (value) {
	        // never reached
	      }, function (reason) {
	        // if `findUser` fulfilled, `reason` will be 'Found user, but still unhappy'.
	        // If `findUser` rejected, `reason` will be '`findUser` rejected and we're unhappy'.
	      });
	      ```
	      If the downstream promise does not specify a rejection handler, rejection reasons will be propagated further downstream.
	       ```js
	      findUser().then(function (user) {
	        throw new PedagogicalException('Upstream error');
	      }).then(function (value) {
	        // never reached
	      }).then(function (value) {
	        // never reached
	      }, function (reason) {
	        // The `PedgagocialException` is propagated all the way down to here
	      });
	      ```
	       Assimilation
	      ------------
	       Sometimes the value you want to propagate to a downstream promise can only be
	      retrieved asynchronously. This can be achieved by returning a promise in the
	      fulfillment or rejection handler. The downstream promise will then be pending
	      until the returned promise is settled. This is called *assimilation*.
	       ```js
	      findUser().then(function (user) {
	        return findCommentsByAuthor(user);
	      }).then(function (comments) {
	        // The user's comments are now available
	      });
	      ```
	       If the assimliated promise rejects, then the downstream promise will also reject.
	       ```js
	      findUser().then(function (user) {
	        return findCommentsByAuthor(user);
	      }).then(function (comments) {
	        // If `findCommentsByAuthor` fulfills, we'll have the value here
	      }, function (reason) {
	        // If `findCommentsByAuthor` rejects, we'll have the reason here
	      });
	      ```
	       Simple Example
	      --------------
	       Synchronous Example
	       ```javascript
	      let result;
	       try {
	        result = findResult();
	        // success
	      } catch(reason) {
	        // failure
	      }
	      ```
	       Errback Example
	       ```js
	      findResult(function(result, err){
	        if (err) {
	          // failure
	        } else {
	          // success
	        }
	      });
	      ```
	       Promise Example;
	       ```javascript
	      findResult().then(function(result){
	        // success
	      }, function(reason){
	        // failure
	      });
	      ```
	       Advanced Example
	      --------------
	       Synchronous Example
	       ```javascript
	      let author, books;
	       try {
	        author = findAuthor();
	        books  = findBooksByAuthor(author);
	        // success
	      } catch(reason) {
	        // failure
	      }
	      ```
	       Errback Example
	       ```js
	       function foundBooks(books) {
	       }
	       function failure(reason) {
	       }
	       findAuthor(function(author, err){
	        if (err) {
	          failure(err);
	          // failure
	        } else {
	          try {
	            findBoooksByAuthor(author, function(books, err) {
	              if (err) {
	                failure(err);
	              } else {
	                try {
	                  foundBooks(books);
	                } catch(reason) {
	                  failure(reason);
	                }
	              }
	            });
	          } catch(error) {
	            failure(err);
	          }
	          // success
	        }
	      });
	      ```
	       Promise Example;
	       ```javascript
	      findAuthor().
	        then(findBooksByAuthor).
	        then(function(books){
	          // found books
	      }).catch(function(reason){
	        // something went wrong
	      });
	      ```
	       @method then
	      @param {Function} onFulfilled
	      @param {Function} onRejected
	      Useful for tooling.
	      @return {Promise}
	      */

	      /**
	      `catch` is simply sugar for `then(undefined, onRejection)` which makes it the same
	      as the catch block of a try/catch statement.
	      ```js
	      function findAuthor(){
	      throw new Error('couldn't find that author');
	      }
	      // synchronous
	      try {
	      findAuthor();
	      } catch(reason) {
	      // something went wrong
	      }
	      // async with promises
	      findAuthor().catch(function(reason){
	      // something went wrong
	      });
	      ```
	      @method catch
	      @param {Function} onRejection
	      Useful for tooling.
	      @return {Promise}
	      */


	      Promise.prototype.catch = function _catch(onRejection) {
	        return this.then(null, onRejection);
	      };
	      /**
	        `finally` will be invoked regardless of the promise's fate just as native
	        try/catch/finally behaves
	      
	        Synchronous example:
	      
	        ```js
	        findAuthor() {
	          if (Math.random() > 0.5) {
	            throw new Error();
	          }
	          return new Author();
	        }
	      
	        try {
	          return findAuthor(); // succeed or fail
	        } catch(error) {
	          return findOtherAuther();
	        } finally {
	          // always runs
	          // doesn't affect the return value
	        }
	        ```
	      
	        Asynchronous example:
	      
	        ```js
	        findAuthor().catch(function(reason){
	          return findOtherAuther();
	        }).finally(function(){
	          // author was either found, or not
	        });
	        ```
	      
	        @method finally
	        @param {Function} callback
	        @return {Promise}
	      */


	      Promise.prototype.finally = function _finally(callback) {
	        var promise = this;
	        var constructor = promise.constructor;

	        if (isFunction(callback)) {
	          return promise.then(function (value) {
	            return constructor.resolve(callback()).then(function () {
	              return value;
	            });
	          }, function (reason) {
	            return constructor.resolve(callback()).then(function () {
	              throw reason;
	            });
	          });
	        }

	        return promise.then(callback, callback);
	      };

	      return Promise;
	    }();

	    Promise$1.prototype.then = then;
	    Promise$1.all = all;
	    Promise$1.race = race;
	    Promise$1.resolve = resolve$1;
	    Promise$1.reject = reject$1;
	    Promise$1._setScheduler = setScheduler;
	    Promise$1._setAsap = setAsap;
	    Promise$1._asap = asap;
	    /*global self*/

	    function polyfill() {
	      var local = void 0;

	      if (typeof commonjsGlobal !== 'undefined') {
	        local = commonjsGlobal;
	      } else if (typeof self !== 'undefined') {
	        local = self;
	      } else {
	        try {
	          local = Function('return this')();
	        } catch (e) {
	          throw new Error('polyfill failed because global object is unavailable in this environment');
	        }
	      }

	      var P = local.Promise;

	      if (P) {
	        var promiseToString = null;

	        try {
	          promiseToString = Object.prototype.toString.call(P.resolve());
	        } catch (e) {// silently ignored
	        }

	        if (promiseToString === '[object Promise]' && !P.cast) {
	          return;
	        }
	      }

	      local.Promise = Promise$1;
	    } // Strange compat..


	    Promise$1.polyfill = polyfill;
	    Promise$1.Promise = Promise$1;
	    return Promise$1;
	  });
	});

	var Promise$1 = typeof Promise !== "undefined" ? Promise : es6Promise;

	function registerLoggingCallbacks(obj) {
	  var i,
	      l,
	      key,
	      callbackNames = ["begin", "done", "log", "testStart", "testDone", "moduleStart", "moduleDone"];

	  function registerLoggingCallback(key) {
	    var loggingCallback = function loggingCallback(callback) {
	      if (objectType(callback) !== "function") {
	        throw new Error("QUnit logging methods require a callback function as their first parameters.");
	      }

	      config.callbacks[key].push(callback);
	    };

	    return loggingCallback;
	  }

	  for (i = 0, l = callbackNames.length; i < l; i++) {
	    key = callbackNames[i]; // Initialize key collection of logging callback

	    if (objectType(config.callbacks[key]) === "undefined") {
	      config.callbacks[key] = [];
	    }

	    obj[key] = registerLoggingCallback(key);
	  }
	}
	function runLoggingCallbacks(key, args) {
	  var callbacks = config.callbacks[key]; // Handling 'log' callbacks separately. Unlike the other callbacks,
	  // the log callback is not controlled by the processing queue,
	  // but rather used by asserts. Hence to promisfy the 'log' callback
	  // would mean promisfying each step of a test

	  if (key === "log") {
	    callbacks.map(function (callback) {
	      return callback(args);
	    });
	    return;
	  } // ensure that each callback is executed serially


	  return callbacks.reduce(function (promiseChain, callback) {
	    return promiseChain.then(function () {
	      return Promise$1.resolve(callback(args));
	    });
	  }, Promise$1.resolve([]));
	}

	// Doesn't support IE9, it will return undefined on these browsers
	// See also https://developer.mozilla.org/en/JavaScript/Reference/Global_Objects/Error/Stack
	var fileName = (sourceFromStacktrace(0) || "").replace(/(:\d+)+\)?/, "").replace(/.+\//, "");
	function extractStacktrace(e, offset) {
	  offset = offset === undefined ? 4 : offset;
	  var stack, include, i;

	  if (e && e.stack) {
	    stack = e.stack.split("\n");

	    if (/^error$/i.test(stack[0])) {
	      stack.shift();
	    }

	    if (fileName) {
	      include = [];

	      for (i = offset; i < stack.length; i++) {
	        if (stack[i].indexOf(fileName) !== -1) {
	          break;
	        }

	        include.push(stack[i]);
	      }

	      if (include.length) {
	        return include.join("\n");
	      }
	    }

	    return stack[offset];
	  }
	}
	function sourceFromStacktrace(offset) {
	  var error = new Error(); // Support: Safari <=7 only, IE <=10 - 11 only
	  // Not all browsers generate the `stack` property for `new Error()`, see also #636

	  if (!error.stack) {
	    try {
	      throw error;
	    } catch (err) {
	      error = err;
	    }
	  }

	  return extractStacktrace(error, offset);
	}

	var priorityCount = 0;
	var unitSampler; // This is a queue of functions that are tasks within a single test.
	// After tests are dequeued from config.queue they are expanded into
	// a set of tasks in this queue.

	var taskQueue = [];
	/**
	 * Advances the taskQueue to the next task. If the taskQueue is empty,
	 * process the testQueue
	 */

	function advance() {
	  advanceTaskQueue();

	  if (!taskQueue.length && !config.blocking && !config.current) {
	    advanceTestQueue();
	  }
	}
	/**
	 * Advances the taskQueue with an increased depth
	 */


	function advanceTaskQueue() {
	  var start = now();
	  config.depth = (config.depth || 0) + 1;
	  processTaskQueue(start);
	  config.depth--;
	}
	/**
	 * Process the first task on the taskQueue as a promise.
	 * Each task is a function returned by https://github.com/qunitjs/qunit/blob/master/src/test.js#L381
	 */


	function processTaskQueue(start) {
	  if (taskQueue.length && !config.blocking) {
	    var elapsedTime = now() - start;

	    if (!defined.setTimeout || config.updateRate <= 0 || elapsedTime < config.updateRate) {
	      var task = taskQueue.shift();
	      Promise$1.resolve(task()).then(function () {
	        if (!taskQueue.length) {
	          advance();
	        } else {
	          processTaskQueue(start);
	        }
	      });
	    } else {
	      setTimeout$1(advance);
	    }
	  }
	}
	/**
	 * Advance the testQueue to the next test to process. Call done() if testQueue completes.
	 */


	function advanceTestQueue() {
	  if (!config.blocking && !config.queue.length && config.depth === 0) {
	    done();
	    return;
	  }

	  var testTasks = config.queue.shift();
	  addToTaskQueue(testTasks());

	  if (priorityCount > 0) {
	    priorityCount--;
	  }

	  advance();
	}
	/**
	 * Enqueue the tasks for a test into the task queue.
	 * @param {Array} tasksArray
	 */


	function addToTaskQueue(tasksArray) {
	  taskQueue.push.apply(taskQueue, _toConsumableArray(tasksArray));
	}
	/**
	 * Return the number of tasks remaining in the task queue to be processed.
	 * @return {Number}
	 */


	function taskQueueLength() {
	  return taskQueue.length;
	}
	/**
	 * Adds a test to the TestQueue for execution.
	 * @param {Function} testTasksFunc
	 * @param {Boolean} prioritize
	 * @param {String} seed
	 */


	function addToTestQueue(testTasksFunc, prioritize, seed) {
	  if (prioritize) {
	    config.queue.splice(priorityCount++, 0, testTasksFunc);
	  } else if (seed) {
	    if (!unitSampler) {
	      unitSampler = unitSamplerGenerator(seed);
	    } // Insert into a random position after all prioritized items


	    var index = Math.floor(unitSampler() * (config.queue.length - priorityCount + 1));
	    config.queue.splice(priorityCount + index, 0, testTasksFunc);
	  } else {
	    config.queue.push(testTasksFunc);
	  }
	}
	/**
	 * Creates a seeded "sample" generator which is used for randomizing tests.
	 */


	function unitSamplerGenerator(seed) {
	  // 32-bit xorshift, requires only a nonzero seed
	  // https://excamera.com/sphinx/article-xorshift.html
	  var sample = parseInt(generateHash(seed), 16) || -1;
	  return function () {
	    sample ^= sample << 13;
	    sample ^= sample >>> 17;
	    sample ^= sample << 5; // ECMAScript has no unsigned number type

	    if (sample < 0) {
	      sample += 0x100000000;
	    }

	    return sample / 0x100000000;
	  };
	}
	/**
	 * This function is called when the ProcessingQueue is done processing all
	 * items. It handles emitting the final run events.
	 */


	function done() {
	  var storage = config.storage;
	  ProcessingQueue.finished = true;
	  var runtime = now() - config.started;
	  var passed = config.stats.all - config.stats.bad;

	  if (config.stats.testCount === 0) {
	    if (config.filter && config.filter.length) {
	      throw new Error("No tests matched the filter \"".concat(config.filter, "\"."));
	    }

	    if (config.module && config.module.length) {
	      throw new Error("No tests matched the module \"".concat(config.module, "\"."));
	    }

	    if (config.moduleId && config.moduleId.length) {
	      throw new Error("No tests matched the moduleId \"".concat(config.moduleId, "\"."));
	    }

	    if (config.testId && config.testId.length) {
	      throw new Error("No tests matched the testId \"".concat(config.testId, "\"."));
	    }

	    throw new Error("No tests were run.");
	  }

	  emit("runEnd", globalSuite.end(true));
	  runLoggingCallbacks("done", {
	    passed: passed,
	    failed: config.stats.bad,
	    total: config.stats.all,
	    runtime: runtime
	  }).then(function () {
	    // Clear own storage items if all tests passed
	    if (storage && config.stats.bad === 0) {
	      for (var i = storage.length - 1; i >= 0; i--) {
	        var key = storage.key(i);

	        if (key.indexOf("qunit-test-") === 0) {
	          storage.removeItem(key);
	        }
	      }
	    }
	  });
	}

	var ProcessingQueue = {
	  finished: false,
	  add: addToTestQueue,
	  advance: advance,
	  taskCount: taskQueueLength
	};

	var TestReport = /*#__PURE__*/function () {
	  function TestReport(name, suite, options) {
	    _classCallCheck(this, TestReport);

	    this.name = name;
	    this.suiteName = suite.name;
	    this.fullName = suite.fullName.concat(name);
	    this.runtime = 0;
	    this.assertions = [];
	    this.skipped = !!options.skip;
	    this.todo = !!options.todo;
	    this.valid = options.valid;
	    this._startTime = 0;
	    this._endTime = 0;
	    suite.pushTest(this);
	  }

	  _createClass(TestReport, [{
	    key: "start",
	    value: function start(recordTime) {
	      if (recordTime) {
	        this._startTime = performanceNow();

	        if (performance) {
	          performance.mark("qunit_test_start");
	        }
	      }

	      return {
	        name: this.name,
	        suiteName: this.suiteName,
	        fullName: this.fullName.slice()
	      };
	    }
	  }, {
	    key: "end",
	    value: function end(recordTime) {
	      if (recordTime) {
	        this._endTime = performanceNow();

	        if (performance) {
	          performance.mark("qunit_test_end");
	          var testName = this.fullName.join(" – ");
	          measure("QUnit Test: ".concat(testName), "qunit_test_start", "qunit_test_end");
	        }
	      }

	      return extend(this.start(), {
	        runtime: this.getRuntime(),
	        status: this.getStatus(),
	        errors: this.getFailedAssertions(),
	        assertions: this.getAssertions()
	      });
	    }
	  }, {
	    key: "pushAssertion",
	    value: function pushAssertion(assertion) {
	      this.assertions.push(assertion);
	    }
	  }, {
	    key: "getRuntime",
	    value: function getRuntime() {
	      return this._endTime - this._startTime;
	    }
	  }, {
	    key: "getStatus",
	    value: function getStatus() {
	      if (this.skipped) {
	        return "skipped";
	      }

	      var testPassed = this.getFailedAssertions().length > 0 ? this.todo : !this.todo;

	      if (!testPassed) {
	        return "failed";
	      } else if (this.todo) {
	        return "todo";
	      } else {
	        return "passed";
	      }
	    }
	  }, {
	    key: "getFailedAssertions",
	    value: function getFailedAssertions() {
	      return this.assertions.filter(function (assertion) {
	        return !assertion.passed;
	      });
	    }
	  }, {
	    key: "getAssertions",
	    value: function getAssertions() {
	      return this.assertions.slice();
	    } // Remove actual and expected values from assertions. This is to prevent
	    // leaking memory throughout a test suite.

	  }, {
	    key: "slimAssertions",
	    value: function slimAssertions() {
	      this.assertions = this.assertions.map(function (assertion) {
	        delete assertion.actual;
	        delete assertion.expected;
	        return assertion;
	      });
	    }
	  }]);

	  return TestReport;
	}();

	var focused$1 = false;
	function Test(settings) {
	  var i, l;
	  ++Test.count;
	  this.expected = null;
	  this.assertions = [];
	  this.semaphore = 0;
	  this.module = config.currentModule;
	  this.steps = [];
	  this.timeout = undefined;
	  this.errorForStack = new Error(); // If a module is skipped, all its tests and the tests of the child suites
	  // should be treated as skipped even if they are defined as `only` or `todo`.
	  // As for `todo` module, all its tests will be treated as `todo` except for
	  // tests defined as `skip` which will be left intact.
	  //
	  // So, if a test is defined as `todo` and is inside a skipped module, we should
	  // then treat that test as if was defined as `skip`.

	  if (this.module.skip) {
	    settings.skip = true;
	    settings.todo = false; // Skipped tests should be left intact
	  } else if (this.module.todo && !settings.skip) {
	    settings.todo = true;
	  }

	  extend(this, settings);
	  this.testReport = new TestReport(settings.testName, this.module.suiteReport, {
	    todo: settings.todo,
	    skip: settings.skip,
	    valid: this.valid()
	  }); // Register unique strings

	  for (i = 0, l = this.module.tests; i < l.length; i++) {
	    if (this.module.tests[i].name === this.testName) {
	      this.testName += " ";
	    }
	  }

	  this.testId = generateHash(this.module.name, this.testName);
	  this.module.tests.push({
	    name: this.testName,
	    testId: this.testId,
	    skip: !!settings.skip
	  });

	  if (settings.skip) {
	    // Skipped tests will fully ignore any sent callback
	    this.callback = function () {};

	    this.async = false;
	    this.expected = 0;
	  } else {
	    if (typeof this.callback !== "function") {
	      var method = this.todo ? "todo" : "test"; // eslint-disable-next-line max-len

	      throw new TypeError("You must provide a function as a test callback to QUnit.".concat(method, "(\"").concat(settings.testName, "\")"));
	    }

	    this.assert = new Assert(this);
	  }
	}
	Test.count = 0;

	function getNotStartedModules(startModule) {
	  var module = startModule,
	      modules = [];

	  while (module && module.testsRun === 0) {
	    modules.push(module);
	    module = module.parentModule;
	  } // The above push modules from the child to the parent
	  // return a reversed order with the top being the top most parent module


	  return modules.reverse();
	}

	Test.prototype = {
	  // generating a stack trace can be expensive, so using a getter defers this until we need it
	  get stack() {
	    return extractStacktrace(this.errorForStack, 2);
	  },

	  before: function before() {
	    var _this = this;

	    var module = this.module,
	        notStartedModules = getNotStartedModules(module); // ensure the callbacks are executed serially for each module

	    var callbackPromises = notStartedModules.reduce(function (promiseChain, startModule) {
	      return promiseChain.then(function () {
	        startModule.stats = {
	          all: 0,
	          bad: 0,
	          started: now()
	        };
	        emit("suiteStart", startModule.suiteReport.start(true));
	        return runLoggingCallbacks("moduleStart", {
	          name: startModule.name,
	          tests: startModule.tests
	        });
	      });
	    }, Promise$1.resolve([]));
	    return callbackPromises.then(function () {
	      config.current = _this;
	      _this.testEnvironment = extend({}, module.testEnvironment);
	      _this.started = now();
	      emit("testStart", _this.testReport.start(true));
	      return runLoggingCallbacks("testStart", {
	        name: _this.testName,
	        module: module.name,
	        testId: _this.testId,
	        previousFailure: _this.previousFailure
	      }).then(function () {
	        if (!config.pollution) {
	          saveGlobal();
	        }
	      });
	    });
	  },
	  run: function run() {
	    var promise;
	    config.current = this;
	    this.callbackStarted = now();

	    if (config.notrycatch) {
	      runTest(this);
	      return;
	    }

	    try {
	      runTest(this);
	    } catch (e) {
	      this.pushFailure("Died on test #" + (this.assertions.length + 1) + " " + this.stack + ": " + (e.message || e), extractStacktrace(e, 0)); // Else next test will carry the responsibility

	      saveGlobal(); // Restart the tests if they're blocking

	      if (config.blocking) {
	        internalRecover(this);
	      }
	    }

	    function runTest(test) {
	      promise = test.callback.call(test.testEnvironment, test.assert);
	      test.resolvePromise(promise); // If the test has a "lock" on it, but the timeout is 0, then we push a
	      // failure as the test should be synchronous.

	      if (test.timeout === 0 && test.semaphore !== 0) {
	        pushFailure("Test did not finish synchronously even though assert.timeout( 0 ) was used.", sourceFromStacktrace(2));
	      }
	    }
	  },
	  after: function after() {
	    checkPollution();
	  },
	  queueHook: function queueHook(hook, hookName, hookOwner) {
	    var _this2 = this;

	    var callHook = function callHook() {
	      var promise = hook.call(_this2.testEnvironment, _this2.assert);

	      _this2.resolvePromise(promise, hookName);
	    };

	    var runHook = function runHook() {
	      if (hookName === "before") {
	        if (hookOwner.unskippedTestsRun !== 0) {
	          return;
	        }

	        _this2.preserveEnvironment = true;
	      } // The 'after' hook should only execute when there are not tests left and
	      // when the 'after' and 'finish' tasks are the only tasks left to process


	      if (hookName === "after" && hookOwner.unskippedTestsRun !== numberOfUnskippedTests(hookOwner) - 1 && (config.queue.length > 0 || ProcessingQueue.taskCount() > 2)) {
	        return;
	      }

	      config.current = _this2;

	      if (config.notrycatch) {
	        callHook();
	        return;
	      }

	      try {
	        callHook();
	      } catch (error) {
	        _this2.pushFailure(hookName + " failed on " + _this2.testName + ": " + (error.message || error), extractStacktrace(error, 0));
	      }
	    };

	    return runHook;
	  },
	  // Currently only used for module level hooks, can be used to add global level ones
	  hooks: function hooks(handler) {
	    var hooks = [];

	    function processHooks(test, module) {
	      if (module.parentModule) {
	        processHooks(test, module.parentModule);
	      }

	      if (module.hooks[handler].length) {
	        for (var i = 0; i < module.hooks[handler].length; i++) {
	          hooks.push(test.queueHook(module.hooks[handler][i], handler, module));
	        }
	      }
	    } // Hooks are ignored on skipped tests


	    if (!this.skip) {
	      processHooks(this, this.module);
	    }

	    return hooks;
	  },
	  finish: function finish() {
	    config.current = this; // Release the test callback to ensure that anything referenced has been
	    // released to be garbage collected.

	    this.callback = undefined;

	    if (this.steps.length) {
	      var stepsList = this.steps.join(", ");
	      this.pushFailure("Expected assert.verifySteps() to be called before end of test " + "after using assert.step(). Unverified steps: ".concat(stepsList), this.stack);
	    }

	    if (config.requireExpects && this.expected === null) {
	      this.pushFailure("Expected number of assertions to be defined, but expect() was " + "not called.", this.stack);
	    } else if (this.expected !== null && this.expected !== this.assertions.length) {
	      this.pushFailure("Expected " + this.expected + " assertions, but " + this.assertions.length + " were run", this.stack);
	    } else if (this.expected === null && !this.assertions.length) {
	      this.pushFailure("Expected at least one assertion, but none were run - call " + "expect(0) to accept zero assertions.", this.stack);
	    }

	    var i,
	        module = this.module,
	        moduleName = module.name,
	        testName = this.testName,
	        skipped = !!this.skip,
	        todo = !!this.todo,
	        bad = 0,
	        storage = config.storage;
	    this.runtime = now() - this.started;
	    config.stats.all += this.assertions.length;
	    config.stats.testCount += 1;
	    module.stats.all += this.assertions.length;

	    for (i = 0; i < this.assertions.length; i++) {
	      if (!this.assertions[i].result) {
	        bad++;
	        config.stats.bad++;
	        module.stats.bad++;
	      }
	    }

	    notifyTestsRan(module, skipped); // Store result when possible

	    if (storage) {
	      if (bad) {
	        storage.setItem("qunit-test-" + moduleName + "-" + testName, bad);
	      } else {
	        storage.removeItem("qunit-test-" + moduleName + "-" + testName);
	      }
	    } // After emitting the js-reporters event we cleanup the assertion data to
	    // avoid leaking it. It is not used by the legacy testDone callbacks.


	    emit("testEnd", this.testReport.end(true));
	    this.testReport.slimAssertions();
	    var test = this;
	    return runLoggingCallbacks("testDone", {
	      name: testName,
	      module: moduleName,
	      skipped: skipped,
	      todo: todo,
	      failed: bad,
	      passed: this.assertions.length - bad,
	      total: this.assertions.length,
	      runtime: skipped ? 0 : this.runtime,
	      // HTML Reporter use
	      assertions: this.assertions,
	      testId: this.testId,

	      // Source of Test
	      // generating stack trace is expensive, so using a getter will help defer this until we need it
	      get source() {
	        return test.stack;
	      }

	    }).then(function () {
	      if (module.testsRun === numberOfTests(module)) {
	        var completedModules = [module]; // Check if the parent modules, iteratively, are done. If that the case,
	        // we emit the `suiteEnd` event and trigger `moduleDone` callback.

	        var parent = module.parentModule;

	        while (parent && parent.testsRun === numberOfTests(parent)) {
	          completedModules.push(parent);
	          parent = parent.parentModule;
	        }

	        return completedModules.reduce(function (promiseChain, completedModule) {
	          return promiseChain.then(function () {
	            return logSuiteEnd(completedModule);
	          });
	        }, Promise$1.resolve([]));
	      }
	    }).then(function () {
	      config.current = undefined;
	    });

	    function logSuiteEnd(module) {
	      // Reset `module.hooks` to ensure that anything referenced in these hooks
	      // has been released to be garbage collected.
	      module.hooks = {};
	      emit("suiteEnd", module.suiteReport.end(true));
	      return runLoggingCallbacks("moduleDone", {
	        name: module.name,
	        tests: module.tests,
	        failed: module.stats.bad,
	        passed: module.stats.all - module.stats.bad,
	        total: module.stats.all,
	        runtime: now() - module.stats.started
	      });
	    }
	  },
	  preserveTestEnvironment: function preserveTestEnvironment() {
	    if (this.preserveEnvironment) {
	      this.module.testEnvironment = this.testEnvironment;
	      this.testEnvironment = extend({}, this.module.testEnvironment);
	    }
	  },
	  queue: function queue() {
	    var test = this;

	    if (!this.valid()) {
	      return;
	    }

	    function runTest() {
	      return [function () {
	        return test.before();
	      }].concat(_toConsumableArray(test.hooks("before")), [function () {
	        test.preserveTestEnvironment();
	      }], _toConsumableArray(test.hooks("beforeEach")), [function () {
	        test.run();
	      }], _toConsumableArray(test.hooks("afterEach").reverse()), _toConsumableArray(test.hooks("after").reverse()), [function () {
	        test.after();
	      }, function () {
	        return test.finish();
	      }]);
	    }

	    var previousFailCount = config.storage && +config.storage.getItem("qunit-test-" + this.module.name + "-" + this.testName); // Prioritize previously failed tests, detected from storage

	    var prioritize = config.reorder && !!previousFailCount;
	    this.previousFailure = !!previousFailCount;
	    ProcessingQueue.add(runTest, prioritize, config.seed); // If the queue has already finished, we manually process the new test

	    if (ProcessingQueue.finished) {
	      ProcessingQueue.advance();
	    }
	  },
	  pushResult: function pushResult(resultInfo) {
	    if (this !== config.current) {
	      throw new Error("Assertion occurred after test had finished.");
	    } // Destructure of resultInfo = { result, actual, expected, message, negative }


	    var source,
	        details = {
	      module: this.module.name,
	      name: this.testName,
	      result: resultInfo.result,
	      message: resultInfo.message,
	      actual: resultInfo.actual,
	      testId: this.testId,
	      negative: resultInfo.negative || false,
	      runtime: now() - this.started,
	      todo: !!this.todo
	    };

	    if (hasOwn.call(resultInfo, "expected")) {
	      details.expected = resultInfo.expected;
	    }

	    if (!resultInfo.result) {
	      source = resultInfo.source || sourceFromStacktrace();

	      if (source) {
	        details.source = source;
	      }
	    }

	    this.logAssertion(details);
	    this.assertions.push({
	      result: !!resultInfo.result,
	      message: resultInfo.message
	    });
	  },
	  pushFailure: function pushFailure(message, source, actual) {
	    if (!(this instanceof Test)) {
	      throw new Error("pushFailure() assertion outside test context, was " + sourceFromStacktrace(2));
	    }

	    this.pushResult({
	      result: false,
	      message: message || "error",
	      actual: actual || null,
	      source: source
	    });
	  },

	  /**
	   * Log assertion details using both the old QUnit.log interface and
	   * QUnit.on( "assertion" ) interface.
	   *
	   * @private
	   */
	  logAssertion: function logAssertion(details) {
	    runLoggingCallbacks("log", details);
	    var assertion = {
	      passed: details.result,
	      actual: details.actual,
	      expected: details.expected,
	      message: details.message,
	      stack: details.source,
	      todo: details.todo
	    };
	    this.testReport.pushAssertion(assertion);
	    emit("assertion", assertion);
	  },
	  resolvePromise: function resolvePromise(promise, phase) {
	    var then,
	        resume,
	        message,
	        test = this;

	    if (promise != null) {
	      then = promise.then;

	      if (objectType(then) === "function") {
	        resume = internalStop(test);

	        if (config.notrycatch) {
	          then.call(promise, function () {
	            resume();
	          });
	        } else {
	          then.call(promise, function () {
	            resume();
	          }, function (error) {
	            message = "Promise rejected " + (!phase ? "during" : phase.replace(/Each$/, "")) + " \"" + test.testName + "\": " + (error && error.message || error);
	            test.pushFailure(message, extractStacktrace(error, 0)); // Else next test will carry the responsibility

	            saveGlobal(); // Unblock

	            internalRecover(test);
	          });
	        }
	      }
	    }
	  },
	  valid: function valid() {
	    var filter = config.filter,
	        regexFilter = /^(!?)\/([\w\W]*)\/(i?$)/.exec(filter),
	        module = config.module && config.module.toLowerCase(),
	        fullName = this.module.name + ": " + this.testName;

	    function moduleChainNameMatch(testModule) {
	      var testModuleName = testModule.name ? testModule.name.toLowerCase() : null;

	      if (testModuleName === module) {
	        return true;
	      } else if (testModule.parentModule) {
	        return moduleChainNameMatch(testModule.parentModule);
	      } else {
	        return false;
	      }
	    }

	    function moduleChainIdMatch(testModule) {
	      return inArray(testModule.moduleId, config.moduleId) || testModule.parentModule && moduleChainIdMatch(testModule.parentModule);
	    } // Internally-generated tests are always valid


	    if (this.callback && this.callback.validTest) {
	      return true;
	    }

	    if (config.moduleId && config.moduleId.length > 0 && !moduleChainIdMatch(this.module)) {
	      return false;
	    }

	    if (config.testId && config.testId.length > 0 && !inArray(this.testId, config.testId)) {
	      return false;
	    }

	    if (module && !moduleChainNameMatch(this.module)) {
	      return false;
	    }

	    if (!filter) {
	      return true;
	    }

	    return regexFilter ? this.regexFilter(!!regexFilter[1], regexFilter[2], regexFilter[3], fullName) : this.stringFilter(filter, fullName);
	  },
	  regexFilter: function regexFilter(exclude, pattern, flags, fullName) {
	    var regex = new RegExp(pattern, flags);
	    var match = regex.test(fullName);
	    return match !== exclude;
	  },
	  stringFilter: function stringFilter(filter, fullName) {
	    filter = filter.toLowerCase();
	    fullName = fullName.toLowerCase();
	    var include = filter.charAt(0) !== "!";

	    if (!include) {
	      filter = filter.slice(1);
	    } // If the filter matches, we need to honour include


	    if (fullName.indexOf(filter) !== -1) {
	      return include;
	    } // Otherwise, do the opposite


	    return !include;
	  }
	};
	function pushFailure() {
	  if (!config.current) {
	    throw new Error("pushFailure() assertion outside test context, in " + sourceFromStacktrace(2));
	  } // Gets current test obj


	  var currentTest = config.current;
	  return currentTest.pushFailure.apply(currentTest, arguments);
	}

	function saveGlobal() {
	  config.pollution = [];

	  if (config.noglobals) {
	    for (var key in global__default['default']) {
	      if (hasOwn.call(global__default['default'], key)) {
	        // In Opera sometimes DOM element ids show up here, ignore them
	        if (/^qunit-test-output/.test(key)) {
	          continue;
	        }

	        config.pollution.push(key);
	      }
	    }
	  }
	}

	function checkPollution() {
	  var newGlobals,
	      deletedGlobals,
	      old = config.pollution;
	  saveGlobal();
	  newGlobals = diff(config.pollution, old);

	  if (newGlobals.length > 0) {
	    pushFailure("Introduced global variable(s): " + newGlobals.join(", "));
	  }

	  deletedGlobals = diff(old, config.pollution);

	  if (deletedGlobals.length > 0) {
	    pushFailure("Deleted global variable(s): " + deletedGlobals.join(", "));
	  }
	} // Will be exposed as QUnit.test


	function test(testName, callback) {
	  if (focused$1) {
	    return;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback
	  });
	  newTest.queue();
	}
	function todo(testName, callback) {
	  if (focused$1) {
	    return;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback,
	    todo: true
	  });
	  newTest.queue();
	} // Will be exposed as QUnit.skip

	function skip(testName) {
	  if (focused$1) {
	    return;
	  }

	  var test = new Test({
	    testName: testName,
	    skip: true
	  });
	  test.queue();
	} // Will be exposed as QUnit.only

	function only(testName, callback) {
	  if (!focused$1) {
	    config.queue.length = 0;
	    focused$1 = true;
	  }

	  var newTest = new Test({
	    testName: testName,
	    callback: callback
	  });
	  newTest.queue();
	} // Resets config.timeout with a new timeout duration.

	function resetTestTimeout(timeoutDuration) {
	  clearTimeout(config.timeout);
	  config.timeout = setTimeout$1(config.timeoutHandler(timeoutDuration), timeoutDuration);
	} // Put a hold on processing and return a function that will release it.

	function internalStop(test) {
	  var released = false;
	  test.semaphore += 1;
	  config.blocking = true; // Set a recovery timeout, if so configured.

	  if (defined.setTimeout) {
	    var timeoutDuration;

	    if (typeof test.timeout === "number") {
	      timeoutDuration = test.timeout;
	    } else if (typeof config.testTimeout === "number") {
	      timeoutDuration = config.testTimeout;
	    }

	    if (typeof timeoutDuration === "number" && timeoutDuration > 0) {
	      clearTimeout(config.timeout);

	      config.timeoutHandler = function (timeout) {
	        return function () {
	          pushFailure("Test took longer than ".concat(timeout, "ms; test timed out."), sourceFromStacktrace(2));
	          released = true;
	          internalRecover(test);
	        };
	      };

	      config.timeout = setTimeout$1(config.timeoutHandler(timeoutDuration), timeoutDuration);
	    }
	  }

	  return function resume() {
	    if (released) {
	      return;
	    }

	    released = true;
	    test.semaphore -= 1;
	    internalStart(test);
	  };
	} // Forcefully release all processing holds.

	function internalRecover(test) {
	  test.semaphore = 0;
	  internalStart(test);
	} // Release a processing hold, scheduling a resumption attempt if no holds remain.


	function internalStart(test) {
	  // If semaphore is non-numeric, throw error
	  if (isNaN(test.semaphore)) {
	    test.semaphore = 0;
	    pushFailure("Invalid value on test.semaphore", sourceFromStacktrace(2));
	    return;
	  } // Don't start until equal number of stop-calls


	  if (test.semaphore > 0) {
	    return;
	  } // Throw an Error if start is called more often than stop


	  if (test.semaphore < 0) {
	    test.semaphore = 0;
	    pushFailure("Tried to restart test while already started (test's semaphore was 0 already)", sourceFromStacktrace(2));
	    return;
	  } // Add a slight delay to allow more assertions etc.


	  if (defined.setTimeout) {
	    if (config.timeout) {
	      clearTimeout(config.timeout);
	    }

	    config.timeout = setTimeout$1(function () {
	      if (test.semaphore > 0) {
	        return;
	      }

	      if (config.timeout) {
	        clearTimeout(config.timeout);
	      }

	      begin();
	    });
	  } else {
	    begin();
	  }
	}

	function collectTests(module) {
	  var tests = [].concat(module.tests);

	  var modules = _toConsumableArray(module.childModules); // Do a breadth-first traversal of the child modules


	  while (modules.length) {
	    var nextModule = modules.shift();
	    tests.push.apply(tests, nextModule.tests);
	    modules.push.apply(modules, _toConsumableArray(nextModule.childModules));
	  }

	  return tests;
	}

	function numberOfTests(module) {
	  return collectTests(module).length;
	}

	function numberOfUnskippedTests(module) {
	  return collectTests(module).filter(function (test) {
	    return !test.skip;
	  }).length;
	}

	function notifyTestsRan(module, skipped) {
	  module.testsRun++;

	  if (!skipped) {
	    module.unskippedTestsRun++;
	  }

	  while (module = module.parentModule) {
	    module.testsRun++;

	    if (!skipped) {
	      module.unskippedTestsRun++;
	    }
	  }
	}

	var Assert = /*#__PURE__*/function () {
	  function Assert(testContext) {
	    _classCallCheck(this, Assert);

	    this.test = testContext;
	  } // Assert helpers


	  _createClass(Assert, [{
	    key: "timeout",
	    value: function timeout(duration) {
	      if (typeof duration !== "number") {
	        throw new Error("You must pass a number as the duration to assert.timeout");
	      }

	      this.test.timeout = duration; // If a timeout has been set, clear it and reset with the new duration

	      if (config.timeout) {
	        clearTimeout(config.timeout);

	        if (config.timeoutHandler && this.test.timeout > 0) {
	          resetTestTimeout(this.test.timeout);
	        }
	      }
	    } // Documents a "step", which is a string value, in a test as a passing assertion

	  }, {
	    key: "step",
	    value: function step(message) {
	      var assertionMessage = message;
	      var result = !!message;
	      this.test.steps.push(message);

	      if (objectType(message) === "undefined" || message === "") {
	        assertionMessage = "You must provide a message to assert.step";
	      } else if (objectType(message) !== "string") {
	        assertionMessage = "You must provide a string value to assert.step";
	        result = false;
	      }

	      this.pushResult({
	        result: result,
	        message: assertionMessage
	      });
	    } // Verifies the steps in a test match a given array of string values

	  }, {
	    key: "verifySteps",
	    value: function verifySteps(steps, message) {
	      // Since the steps array is just string values, we can clone with slice
	      var actualStepsClone = this.test.steps.slice();
	      this.deepEqual(actualStepsClone, steps, message);
	      this.test.steps.length = 0;
	    } // Specify the number of expected assertions to guarantee that failed test
	    // (no assertions are run at all) don't slip through.

	  }, {
	    key: "expect",
	    value: function expect(asserts) {
	      if (arguments.length === 1) {
	        this.test.expected = asserts;
	      } else {
	        return this.test.expected;
	      }
	    } // Put a hold on processing and return a function that will release it a maximum of once.

	  }, {
	    key: "async",
	    value: function async(count) {
	      var test = this.test;
	      var popped = false,
	          acceptCallCount = count;

	      if (typeof acceptCallCount === "undefined") {
	        acceptCallCount = 1;
	      }

	      var resume = internalStop(test);
	      return function done() {
	        if (config.current !== test) {
	          throw Error("assert.async callback called after test finished.");
	        }

	        if (popped) {
	          test.pushFailure("Too many calls to the `assert.async` callback", sourceFromStacktrace(2));
	          return;
	        }

	        acceptCallCount -= 1;

	        if (acceptCallCount > 0) {
	          return;
	        }

	        popped = true;
	        resume();
	      };
	    } // Exports test.push() to the user API
	    // Alias of pushResult.

	  }, {
	    key: "push",
	    value: function push(result, actual, expected, message, negative) {
	      Logger.warn("assert.push is deprecated and will be removed in QUnit 3.0." + " Please use assert.pushResult instead (https://api.qunitjs.com/assert/pushResult).");
	      var currentAssert = this instanceof Assert ? this : config.current.assert;
	      return currentAssert.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: negative
	      });
	    }
	  }, {
	    key: "pushResult",
	    value: function pushResult(resultInfo) {
	      // Destructure of resultInfo = { result, actual, expected, message, negative }
	      var assert = this;
	      var currentTest = assert instanceof Assert && assert.test || config.current; // Backwards compatibility fix.
	      // Allows the direct use of global exported assertions and QUnit.assert.*
	      // Although, it's use is not recommended as it can leak assertions
	      // to other tests from async tests, because we only get a reference to the current test,
	      // not exactly the test where assertion were intended to be called.

	      if (!currentTest) {
	        throw new Error("assertion outside test context, in " + sourceFromStacktrace(2));
	      }

	      if (!(assert instanceof Assert)) {
	        assert = currentTest.assert;
	      }

	      return assert.test.pushResult(resultInfo);
	    }
	  }, {
	    key: "ok",
	    value: function ok(result, message) {
	      if (!message) {
	        message = result ? "okay" : "failed, expected argument to be truthy, was: ".concat(dump.parse(result));
	      }

	      this.pushResult({
	        result: !!result,
	        actual: result,
	        expected: true,
	        message: message
	      });
	    }
	  }, {
	    key: "notOk",
	    value: function notOk(result, message) {
	      if (!message) {
	        message = !result ? "okay" : "failed, expected argument to be falsy, was: ".concat(dump.parse(result));
	      }

	      this.pushResult({
	        result: !result,
	        actual: result,
	        expected: false,
	        message: message
	      });
	    }
	  }, {
	    key: "true",
	    value: function _true(result, message) {
	      this.pushResult({
	        result: result === true,
	        actual: result,
	        expected: true,
	        message: message
	      });
	    }
	  }, {
	    key: "false",
	    value: function _false(result, message) {
	      this.pushResult({
	        result: result === false,
	        actual: result,
	        expected: false,
	        message: message
	      });
	    }
	  }, {
	    key: "equal",
	    value: function equal(actual, expected, message) {
	      // eslint-disable-next-line eqeqeq
	      var result = expected == actual;
	      this.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notEqual",
	    value: function notEqual(actual, expected, message) {
	      // eslint-disable-next-line eqeqeq
	      var result = expected != actual;
	      this.pushResult({
	        result: result,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "propEqual",
	    value: function propEqual(actual, expected, message) {
	      actual = objectValues(actual);
	      expected = objectValues(expected);
	      this.pushResult({
	        result: equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notPropEqual",
	    value: function notPropEqual(actual, expected, message) {
	      actual = objectValues(actual);
	      expected = objectValues(expected);
	      this.pushResult({
	        result: !equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "deepEqual",
	    value: function deepEqual(actual, expected, message) {
	      this.pushResult({
	        result: equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notDeepEqual",
	    value: function notDeepEqual(actual, expected, message) {
	      this.pushResult({
	        result: !equiv(actual, expected),
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "strictEqual",
	    value: function strictEqual(actual, expected, message) {
	      this.pushResult({
	        result: expected === actual,
	        actual: actual,
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "notStrictEqual",
	    value: function notStrictEqual(actual, expected, message) {
	      this.pushResult({
	        result: expected !== actual,
	        actual: actual,
	        expected: expected,
	        message: message,
	        negative: true
	      });
	    }
	  }, {
	    key: "throws",
	    value: function throws(block, expected, message) {
	      var actual,
	          result = false;
	      var currentTest = this instanceof Assert && this.test || config.current; // 'expected' is optional unless doing string comparison

	      if (objectType(expected) === "string") {
	        if (message == null) {
	          message = expected;
	          expected = null;
	        } else {
	          throw new Error("throws/raises does not accept a string value for the expected argument.\n" + "Use a non-string object value (e.g. regExp) instead if it's necessary.");
	        }
	      }

	      currentTest.ignoreGlobalErrors = true;

	      try {
	        block.call(currentTest.testEnvironment);
	      } catch (e) {
	        actual = e;
	      }

	      currentTest.ignoreGlobalErrors = false;

	      if (actual) {
	        var expectedType = objectType(expected); // We don't want to validate thrown error

	        if (!expected) {
	          result = true; // Expected is a regexp
	        } else if (expectedType === "regexp") {
	          result = expected.test(errorString(actual)); // Log the string form of the regexp

	          expected = String(expected); // Expected is a constructor, maybe an Error constructor
	        } else if (expectedType === "function" && actual instanceof expected) {
	          result = true; // Expected is an Error object
	        } else if (expectedType === "object") {
	          result = actual instanceof expected.constructor && actual.name === expected.name && actual.message === expected.message; // Log the string form of the Error object

	          expected = errorString(expected); // Expected is a validation function which returns true if validation passed
	        } else if (expectedType === "function" && expected.call({}, actual) === true) {
	          expected = null;
	          result = true;
	        }
	      }

	      currentTest.assert.pushResult({
	        result: result,
	        // undefined if it didn't throw
	        actual: actual && errorString(actual),
	        expected: expected,
	        message: message
	      });
	    }
	  }, {
	    key: "rejects",
	    value: function rejects(promise, expected, message) {
	      var result = false;
	      var currentTest = this instanceof Assert && this.test || config.current; // 'expected' is optional unless doing string comparison

	      if (objectType(expected) === "string") {
	        if (message === undefined) {
	          message = expected;
	          expected = undefined;
	        } else {
	          message = "assert.rejects does not accept a string value for the expected " + "argument.\nUse a non-string object value (e.g. validator function) instead " + "if necessary.";
	          currentTest.assert.pushResult({
	            result: false,
	            message: message
	          });
	          return;
	        }
	      }

	      var then = promise && promise.then;

	      if (objectType(then) !== "function") {
	        var _message = "The value provided to `assert.rejects` in " + "\"" + currentTest.testName + "\" was not a promise.";

	        currentTest.assert.pushResult({
	          result: false,
	          message: _message,
	          actual: promise
	        });
	        return;
	      }

	      var done = this.async();
	      return then.call(promise, function handleFulfillment() {
	        var message = "The promise returned by the `assert.rejects` callback in " + "\"" + currentTest.testName + "\" did not reject.";
	        currentTest.assert.pushResult({
	          result: false,
	          message: message,
	          actual: promise
	        });
	        done();
	      }, function handleRejection(actual) {
	        var expectedType = objectType(expected); // We don't want to validate

	        if (expected === undefined) {
	          result = true; // Expected is a regexp
	        } else if (expectedType === "regexp") {
	          result = expected.test(errorString(actual)); // Log the string form of the regexp

	          expected = String(expected); // Expected is a constructor, maybe an Error constructor
	        } else if (expectedType === "function" && actual instanceof expected) {
	          result = true; // Expected is an Error object
	        } else if (expectedType === "object") {
	          result = actual instanceof expected.constructor && actual.name === expected.name && actual.message === expected.message; // Log the string form of the Error object

	          expected = errorString(expected); // Expected is a validation function which returns true if validation passed
	        } else {
	          if (expectedType === "function") {
	            result = expected.call({}, actual) === true;
	            expected = null; // Expected is some other invalid type
	          } else {
	            result = false;
	            message = "invalid expected value provided to `assert.rejects` " + "callback in \"" + currentTest.testName + "\": " + expectedType + ".";
	          }
	        }

	        currentTest.assert.pushResult({
	          result: result,
	          // leave rejection value of undefined as-is
	          actual: actual && errorString(actual),
	          expected: expected,
	          message: message
	        });
	        done();
	      });
	    }
	  }]);

	  return Assert;
	}(); // Provide an alternative to assert.throws(), for environments that consider throws a reserved word
	// Known to us are: Closure Compiler, Narwhal
	// eslint-disable-next-line dot-notation


	Assert.prototype.raises = Assert.prototype["throws"];
	/**
	 * Converts an error into a simple string for comparisons.
	 *
	 * @param {Error|Object} error
	 * @return {String}
	 */

	function errorString(error) {
	  var resultErrorString = error.toString(); // If the error wasn't a subclass of Error but something like
	  // an object literal with name and message properties...

	  if (resultErrorString.substring(0, 7) === "[object") {
	    var name = error.name ? error.name.toString() : "Error";
	    var message = error.message ? error.message.toString() : "";

	    if (name && message) {
	      return "".concat(name, ": ").concat(message);
	    } else if (name) {
	      return name;
	    } else if (message) {
	      return message;
	    } else {
	      return "Error";
	    }
	  } else {
	    return resultErrorString;
	  }
	}

	/* global module, exports, define */
	function exportQUnit(QUnit) {
	  if (defined.document) {
	    // QUnit may be defined when it is preconfigured but then only QUnit and QUnit.config may be defined.
	    if (window$1.QUnit && window$1.QUnit.version) {
	      throw new Error("QUnit has already been defined.");
	    }

	    window$1.QUnit = QUnit;
	  } // For nodejs


	  if (typeof module !== "undefined" && module && module.exports) {
	    module.exports = QUnit; // For consistency with CommonJS environments' exports

	    module.exports.QUnit = QUnit;
	  } // For CommonJS with exports, but without module.exports, like Rhino


	  if (typeof exports !== "undefined" && exports) {
	    exports.QUnit = QUnit;
	  }

	  if (typeof define === "function" && define.amd) {
	    define(function () {
	      return QUnit;
	    });
	    QUnit.config.autostart = false;
	  } // For Web/Service Workers


	  if (self$1 && self$1.WorkerGlobalScope && self$1 instanceof self$1.WorkerGlobalScope) {
	    self$1.QUnit = QUnit;
	  }
	}

	// error handling should be suppressed and false otherwise.
	// In this case, we will only suppress further error handling if the
	// "ignoreGlobalErrors" configuration option is enabled.

	function onError(error) {
	  for (var _len = arguments.length, args = new Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
	    args[_key - 1] = arguments[_key];
	  }

	  if (config.current) {
	    if (config.current.ignoreGlobalErrors) {
	      return true;
	    }

	    pushFailure.apply(void 0, [error.message, error.stacktrace || error.fileName + ":" + error.lineNumber].concat(args));
	  } else {
	    test("global failure", extend(function () {
	      pushFailure.apply(void 0, [error.message, error.stacktrace || error.fileName + ":" + error.lineNumber].concat(args));
	    }, {
	      validTest: true
	    }));
	  }

	  return false;
	}

	function onUnhandledRejection(reason) {
	  var resultInfo = {
	    result: false,
	    message: reason.message || "error",
	    actual: reason,
	    source: reason.stack || sourceFromStacktrace(3)
	  };
	  var currentTest = config.current;

	  if (currentTest) {
	    currentTest.assert.pushResult(resultInfo);
	  } else {
	    test("global failure", extend(function (assert) {
	      assert.pushResult(resultInfo);
	    }, {
	      validTest: true
	    }));
	  }
	}

	var QUnit = {};
	var globalSuite = new SuiteReport(); // The initial "currentModule" represents the global (or top-level) module that
	// is not explicitly defined by the user, therefore we add the "globalSuite" to
	// it since each module has a suiteReport associated with it.

	config.currentModule.suiteReport = globalSuite;
	var globalStartCalled = false;
	var runStarted = false; // Figure out if we're running the tests from a server or not

	QUnit.isLocal = !(defined.document && window$1.location.protocol !== "file:"); // Expose the current QUnit version

	QUnit.version = "2.11.3";
	extend(QUnit, {
	  on: on,
	  module: module$1,
	  test: test,
	  todo: todo,
	  skip: skip,
	  only: only,
	  start: function start(count) {
	    var globalStartAlreadyCalled = globalStartCalled;

	    if (!config.current) {
	      globalStartCalled = true;

	      if (runStarted) {
	        throw new Error("Called start() while test already started running");
	      } else if (globalStartAlreadyCalled || count > 1) {
	        throw new Error("Called start() outside of a test context too many times");
	      } else if (config.autostart) {
	        throw new Error("Called start() outside of a test context when " + "QUnit.config.autostart was true");
	      } else if (!config.pageLoaded) {
	        // The page isn't completely loaded yet, so we set autostart and then
	        // load if we're in Node or wait for the browser's load event.
	        config.autostart = true; // Starts from Node even if .load was not previously called. We still return
	        // early otherwise we'll wind up "beginning" twice.

	        if (!defined.document) {
	          QUnit.load();
	        }

	        return;
	      }
	    } else {
	      throw new Error("QUnit.start cannot be called inside a test context.");
	    }

	    scheduleBegin();
	  },
	  config: config,
	  is: is,
	  objectType: objectType,
	  extend: extend,
	  load: function load() {
	    config.pageLoaded = true; // Initialize the configuration options

	    extend(config, {
	      stats: {
	        all: 0,
	        bad: 0,
	        testCount: 0
	      },
	      started: 0,
	      updateRate: 1000,
	      autostart: true,
	      filter: ""
	    }, true);

	    if (!runStarted) {
	      config.blocking = false;

	      if (config.autostart) {
	        scheduleBegin();
	      }
	    }
	  },
	  stack: function stack(offset) {
	    offset = (offset || 0) + 2;
	    return sourceFromStacktrace(offset);
	  },
	  onError: onError,
	  onUnhandledRejection: onUnhandledRejection
	});
	QUnit.pushFailure = pushFailure;
	QUnit.assert = Assert.prototype;
	QUnit.equiv = equiv;
	QUnit.dump = dump;
	registerLoggingCallbacks(QUnit);

	function scheduleBegin() {
	  runStarted = true; // Add a slight delay to allow definition of more modules and tests.

	  if (defined.setTimeout) {
	    setTimeout$1(function () {
	      begin();
	    });
	  } else {
	    begin();
	  }
	}

	function unblockAndAdvanceQueue() {
	  config.blocking = false;
	  ProcessingQueue.advance();
	}

	function begin() {
	  var i,
	      l,
	      modulesLog = []; // If the test run hasn't officially begun yet

	  if (!config.started) {
	    // Record the time of the test run's beginning
	    config.started = now(); // Delete the loose unnamed module if unused.

	    if (config.modules[0].name === "" && config.modules[0].tests.length === 0) {
	      config.modules.shift();
	    } // Avoid unnecessary information by not logging modules' test environments


	    for (i = 0, l = config.modules.length; i < l; i++) {
	      modulesLog.push({
	        name: config.modules[i].name,
	        tests: config.modules[i].tests
	      });
	    } // The test run is officially beginning now


	    emit("runStart", globalSuite.start(true));
	    runLoggingCallbacks("begin", {
	      totalTests: Test.count,
	      modules: modulesLog
	    }).then(unblockAndAdvanceQueue);
	  } else {
	    unblockAndAdvanceQueue();
	  }
	}
	exportQUnit(QUnit);

	(function () {
	  if (typeof window$1 === "undefined" || typeof document$1 === "undefined") {
	    return;
	  }

	  var config = QUnit.config,
	      hasOwn = Object.prototype.hasOwnProperty; // Stores fixture HTML for resetting later

	  function storeFixture() {
	    // Avoid overwriting user-defined values
	    if (hasOwn.call(config, "fixture")) {
	      return;
	    }

	    var fixture = document$1.getElementById("qunit-fixture");

	    if (fixture) {
	      config.fixture = fixture.cloneNode(true);
	    }
	  }

	  QUnit.begin(storeFixture); // Resets the fixture DOM element if available.

	  function resetFixture() {
	    if (config.fixture == null) {
	      return;
	    }

	    var fixture = document$1.getElementById("qunit-fixture");

	    var resetFixtureType = _typeof(config.fixture);

	    if (resetFixtureType === "string") {
	      // support user defined values for `config.fixture`
	      var newFixture = document$1.createElement("div");
	      newFixture.setAttribute("id", "qunit-fixture");
	      newFixture.innerHTML = config.fixture;
	      fixture.parentNode.replaceChild(newFixture, fixture);
	    } else {
	      var clonedFixture = config.fixture.cloneNode(true);
	      fixture.parentNode.replaceChild(clonedFixture, fixture);
	    }
	  }

	  QUnit.testStart(resetFixture);
	})();

	(function () {
	  // Only interact with URLs via window.location
	  var location = typeof window$1 !== "undefined" && window$1.location;

	  if (!location) {
	    return;
	  }

	  var urlParams = getUrlParams();
	  QUnit.urlParams = urlParams; // Match module/test by inclusion in an array

	  QUnit.config.moduleId = [].concat(urlParams.moduleId || []);
	  QUnit.config.testId = [].concat(urlParams.testId || []); // Exact case-insensitive match of the module name

	  QUnit.config.module = urlParams.module; // Regular expression or case-insenstive substring match against "moduleName: testName"

	  QUnit.config.filter = urlParams.filter; // Test order randomization

	  if (urlParams.seed === true) {
	    // Generate a random seed if the option is specified without a value
	    QUnit.config.seed = Math.random().toString(36).slice(2);
	  } else if (urlParams.seed) {
	    QUnit.config.seed = urlParams.seed;
	  } // Add URL-parameter-mapped config values with UI form rendering data


	  QUnit.config.urlConfig.push({
	    id: "hidepassed",
	    label: "Hide passed tests",
	    tooltip: "Only show tests and assertions that fail. Stored as query-strings."
	  }, {
	    id: "noglobals",
	    label: "Check for Globals",
	    tooltip: "Enabling this will test if any test introduces new properties on the " + "global object (`window` in Browsers). Stored as query-strings."
	  }, {
	    id: "notrycatch",
	    label: "No try-catch",
	    tooltip: "Enabling this will run tests outside of a try-catch block. Makes debugging " + "exceptions in IE reasonable. Stored as query-strings."
	  });
	  QUnit.begin(function () {
	    var i,
	        option,
	        urlConfig = QUnit.config.urlConfig;

	    for (i = 0; i < urlConfig.length; i++) {
	      // Options can be either strings or objects with nonempty "id" properties
	      option = QUnit.config.urlConfig[i];

	      if (typeof option !== "string") {
	        option = option.id;
	      }

	      if (QUnit.config[option] === undefined) {
	        QUnit.config[option] = urlParams[option];
	      }
	    }
	  });

	  function getUrlParams() {
	    var i, param, name, value;
	    var urlParams = Object.create(null);
	    var params = location.search.slice(1).split("&");
	    var length = params.length;

	    for (i = 0; i < length; i++) {
	      if (params[i]) {
	        param = params[i].split("=");
	        name = decodeQueryParam(param[0]); // Allow just a key to turn on a flag, e.g., test.html?noglobals

	        value = param.length === 1 || decodeQueryParam(param.slice(1).join("="));

	        if (name in urlParams) {
	          urlParams[name] = [].concat(urlParams[name], value);
	        } else {
	          urlParams[name] = value;
	        }
	      }
	    }

	    return urlParams;
	  }

	  function decodeQueryParam(param) {
	    return decodeURIComponent(param.replace(/\+/g, "%20"));
	  }
	})();

	var fuzzysort = createCommonjsModule(function (module) {

	  (function (root, UMD) {
	    if ( module.exports) module.exports = UMD();else root.fuzzysort = UMD();
	  })(commonjsGlobal, function UMD() {
	    function fuzzysortNew(instanceOptions) {
	      var fuzzysort = {
	        single: function (search, target, options) {
	          if (!search) return null;
	          if (!isObj(search)) search = fuzzysort.getPreparedSearch(search);
	          if (!target) return null;
	          if (!isObj(target)) target = fuzzysort.getPrepared(target);
	          var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	          var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	          return algorithm(search, target, search[0]); // var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991
	          // var result = algorithm(search, target, search[0])
	          // if(result === null) return null
	          // if(result.score < threshold) return null
	          // return result
	        },
	        go: function (search, targets, options) {
	          if (!search) return noResults;
	          search = fuzzysort.prepareSearch(search);
	          var searchLowerCode = search[0];
	          var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991;
	          var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991;
	          var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	          var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	          var resultsLen = 0;
	          var limitedCount = 0;
	          var targetsLen = targets.length; // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]
	          // options.keys

	          if (options && options.keys) {
	            var scoreFn = options.scoreFn || defaultScoreFn;
	            var keys = options.keys;
	            var keysLen = keys.length;

	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var obj = targets[i];
	              var objResults = new Array(keysLen);

	              for (var keyI = keysLen - 1; keyI >= 0; --keyI) {
	                var key = keys[keyI];
	                var target = getValue(obj, key);

	                if (!target) {
	                  objResults[keyI] = null;
	                  continue;
	                }

	                if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                objResults[keyI] = algorithm(search, target, searchLowerCode);
	              }

	              objResults.obj = obj; // before scoreFn so scoreFn can use it

	              var score = scoreFn(objResults);
	              if (score === null) continue;
	              if (score < threshold) continue;
	              objResults.score = score;

	              if (resultsLen < limit) {
	                q.add(objResults);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (score > q.peek().score) q.replaceTop(objResults);
	              }
	            } // options.key

	          } else if (options && options.key) {
	            var key = options.key;

	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var obj = targets[i];
	              var target = getValue(obj, key);
	              if (!target) continue;
	              if (!isObj(target)) target = fuzzysort.getPrepared(target);
	              var result = algorithm(search, target, searchLowerCode);
	              if (result === null) continue;
	              if (result.score < threshold) continue; // have to clone result so duplicate targets from different obj can each reference the correct obj

	              result = {
	                target: result.target,
	                _targetLowerCodes: null,
	                _nextBeginningIndexes: null,
	                score: result.score,
	                indexes: result.indexes,
	                obj: obj
	              }; // hidden

	              if (resultsLen < limit) {
	                q.add(result);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (result.score > q.peek().score) q.replaceTop(result);
	              }
	            } // no keys

	          } else {
	            for (var i = targetsLen - 1; i >= 0; --i) {
	              var target = targets[i];
	              if (!target) continue;
	              if (!isObj(target)) target = fuzzysort.getPrepared(target);
	              var result = algorithm(search, target, searchLowerCode);
	              if (result === null) continue;
	              if (result.score < threshold) continue;

	              if (resultsLen < limit) {
	                q.add(result);
	                ++resultsLen;
	              } else {
	                ++limitedCount;
	                if (result.score > q.peek().score) q.replaceTop(result);
	              }
	            }
	          }

	          if (resultsLen === 0) return noResults;
	          var results = new Array(resultsLen);

	          for (var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll();

	          results.total = resultsLen + limitedCount;
	          return results;
	        },
	        goAsync: function (search, targets, options) {
	          var canceled = false;
	          var p = new Promise(function (resolve, reject) {
	            if (!search) return resolve(noResults);
	            search = fuzzysort.prepareSearch(search);
	            var searchLowerCode = search[0];
	            var q = fastpriorityqueue();
	            var iCurrent = targets.length - 1;
	            var threshold = options && options.threshold || instanceOptions && instanceOptions.threshold || -9007199254740991;
	            var limit = options && options.limit || instanceOptions && instanceOptions.limit || 9007199254740991;
	            var allowTypo = options && options.allowTypo !== undefined ? options.allowTypo : instanceOptions && instanceOptions.allowTypo !== undefined ? instanceOptions.allowTypo : true;
	            var algorithm = allowTypo ? fuzzysort.algorithm : fuzzysort.algorithmNoTypo;
	            var resultsLen = 0;
	            var limitedCount = 0;

	            function step() {
	              if (canceled) return reject('canceled');
	              var startMs = Date.now(); // This code is copy/pasted 3 times for performance reasons [options.keys, options.key, no keys]
	              // options.keys

	              if (options && options.keys) {
	                var scoreFn = options.scoreFn || defaultScoreFn;
	                var keys = options.keys;
	                var keysLen = keys.length;

	                for (; iCurrent >= 0; --iCurrent) {
	                  var obj = targets[iCurrent];
	                  var objResults = new Array(keysLen);

	                  for (var keyI = keysLen - 1; keyI >= 0; --keyI) {
	                    var key = keys[keyI];
	                    var target = getValue(obj, key);

	                    if (!target) {
	                      objResults[keyI] = null;
	                      continue;
	                    }

	                    if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                    objResults[keyI] = algorithm(search, target, searchLowerCode);
	                  }

	                  objResults.obj = obj; // before scoreFn so scoreFn can use it

	                  var score = scoreFn(objResults);
	                  if (score === null) continue;
	                  if (score < threshold) continue;
	                  objResults.score = score;

	                  if (resultsLen < limit) {
	                    q.add(objResults);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (score > q.peek().score) q.replaceTop(objResults);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                } // options.key

	              } else if (options && options.key) {
	                var key = options.key;

	                for (; iCurrent >= 0; --iCurrent) {
	                  var obj = targets[iCurrent];
	                  var target = getValue(obj, key);
	                  if (!target) continue;
	                  if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                  var result = algorithm(search, target, searchLowerCode);
	                  if (result === null) continue;
	                  if (result.score < threshold) continue; // have to clone result so duplicate targets from different obj can each reference the correct obj

	                  result = {
	                    target: result.target,
	                    _targetLowerCodes: null,
	                    _nextBeginningIndexes: null,
	                    score: result.score,
	                    indexes: result.indexes,
	                    obj: obj
	                  }; // hidden

	                  if (resultsLen < limit) {
	                    q.add(result);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (result.score > q.peek().score) q.replaceTop(result);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                } // no keys

	              } else {
	                for (; iCurrent >= 0; --iCurrent) {
	                  var target = targets[iCurrent];
	                  if (!target) continue;
	                  if (!isObj(target)) target = fuzzysort.getPrepared(target);
	                  var result = algorithm(search, target, searchLowerCode);
	                  if (result === null) continue;
	                  if (result.score < threshold) continue;

	                  if (resultsLen < limit) {
	                    q.add(result);
	                    ++resultsLen;
	                  } else {
	                    ++limitedCount;
	                    if (result.score > q.peek().score) q.replaceTop(result);
	                  }

	                  if (iCurrent % 1000
	                  /*itemsPerCheck*/
	                  === 0) {
	                    if (Date.now() - startMs >= 10
	                    /*asyncInterval*/
	                    ) {
	                        isNode ? setImmediate(step) : setTimeout(step);
	                        return;
	                      }
	                  }
	                }
	              }

	              if (resultsLen === 0) return resolve(noResults);
	              var results = new Array(resultsLen);

	              for (var i = resultsLen - 1; i >= 0; --i) results[i] = q.poll();

	              results.total = resultsLen + limitedCount;
	              resolve(results);
	            }

	            isNode ? setImmediate(step) : step();
	          });

	          p.cancel = function () {
	            canceled = true;
	          };

	          return p;
	        },
	        highlight: function (result, hOpen, hClose) {
	          if (result === null) return null;
	          if (hOpen === undefined) hOpen = '<b>';
	          if (hClose === undefined) hClose = '</b>';
	          var highlighted = '';
	          var matchesIndex = 0;
	          var opened = false;
	          var target = result.target;
	          var targetLen = target.length;
	          var matchesBest = result.indexes;

	          for (var i = 0; i < targetLen; ++i) {
	            var char = target[i];

	            if (matchesBest[matchesIndex] === i) {
	              ++matchesIndex;

	              if (!opened) {
	                opened = true;
	                highlighted += hOpen;
	              }

	              if (matchesIndex === matchesBest.length) {
	                highlighted += char + hClose + target.substr(i + 1);
	                break;
	              }
	            } else {
	              if (opened) {
	                opened = false;
	                highlighted += hClose;
	              }
	            }

	            highlighted += char;
	          }

	          return highlighted;
	        },
	        prepare: function (target) {
	          if (!target) return;
	          return {
	            target: target,
	            _targetLowerCodes: fuzzysort.prepareLowerCodes(target),
	            _nextBeginningIndexes: null,
	            score: null,
	            indexes: null,
	            obj: null
	          }; // hidden
	        },
	        prepareSlow: function (target) {
	          if (!target) return;
	          return {
	            target: target,
	            _targetLowerCodes: fuzzysort.prepareLowerCodes(target),
	            _nextBeginningIndexes: fuzzysort.prepareNextBeginningIndexes(target),
	            score: null,
	            indexes: null,
	            obj: null
	          }; // hidden
	        },
	        prepareSearch: function (search) {
	          if (!search) return;
	          return fuzzysort.prepareLowerCodes(search);
	        },
	        // Below this point is only internal code
	        // Below this point is only internal code
	        // Below this point is only internal code
	        // Below this point is only internal code
	        getPrepared: function (target) {
	          if (target.length > 999) return fuzzysort.prepare(target); // don't cache huge targets

	          var targetPrepared = preparedCache.get(target);
	          if (targetPrepared !== undefined) return targetPrepared;
	          targetPrepared = fuzzysort.prepare(target);
	          preparedCache.set(target, targetPrepared);
	          return targetPrepared;
	        },
	        getPreparedSearch: function (search) {
	          if (search.length > 999) return fuzzysort.prepareSearch(search); // don't cache huge searches

	          var searchPrepared = preparedSearchCache.get(search);
	          if (searchPrepared !== undefined) return searchPrepared;
	          searchPrepared = fuzzysort.prepareSearch(search);
	          preparedSearchCache.set(search, searchPrepared);
	          return searchPrepared;
	        },
	        algorithm: function (searchLowerCodes, prepared, searchLowerCode) {
	          var targetLowerCodes = prepared._targetLowerCodes;
	          var searchLen = searchLowerCodes.length;
	          var targetLen = targetLowerCodes.length;
	          var searchI = 0; // where we at

	          var targetI = 0; // where you at

	          var typoSimpleI = 0;
	          var matchesSimpleLen = 0; // very basic fuzzy match; to remove non-matching targets ASAP!
	          // walk through target. find sequential matches.
	          // if all chars aren't found then exit

	          for (;;) {
	            var isMatch = searchLowerCode === targetLowerCodes[targetI];

	            if (isMatch) {
	              matchesSimple[matchesSimpleLen++] = targetI;
	              ++searchI;
	              if (searchI === searchLen) break;
	              searchLowerCode = searchLowerCodes[typoSimpleI === 0 ? searchI : typoSimpleI === searchI ? searchI + 1 : typoSimpleI === searchI - 1 ? searchI - 1 : searchI];
	            }

	            ++targetI;

	            if (targetI >= targetLen) {
	              // Failed to find searchI
	              // Check for typo or exit
	              // we go as far as possible before trying to transpose
	              // then we transpose backwards until we reach the beginning
	              for (;;) {
	                if (searchI <= 1) return null; // not allowed to transpose first char

	                if (typoSimpleI === 0) {
	                  // we haven't tried to transpose yet
	                  --searchI;
	                  var searchLowerCodeNew = searchLowerCodes[searchI];
	                  if (searchLowerCode === searchLowerCodeNew) continue; // doesn't make sense to transpose a repeat char

	                  typoSimpleI = searchI;
	                } else {
	                  if (typoSimpleI === 1) return null; // reached the end of the line for transposing

	                  --typoSimpleI;
	                  searchI = typoSimpleI;
	                  searchLowerCode = searchLowerCodes[searchI + 1];
	                  var searchLowerCodeNew = searchLowerCodes[searchI];
	                  if (searchLowerCode === searchLowerCodeNew) continue; // doesn't make sense to transpose a repeat char
	                }

	                matchesSimpleLen = searchI;
	                targetI = matchesSimple[matchesSimpleLen - 1] + 1;
	                break;
	              }
	            }
	          }

	          var searchI = 0;
	          var typoStrictI = 0;
	          var successStrict = false;
	          var matchesStrictLen = 0;
	          var nextBeginningIndexes = prepared._nextBeginningIndexes;
	          if (nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target);
	          var firstPossibleI = targetI = matchesSimple[0] === 0 ? 0 : nextBeginningIndexes[matchesSimple[0] - 1]; // Our target string successfully matched all characters in sequence!
	          // Let's try a more advanced and strict test to improve the score
	          // only count it as a match if it's consecutive or a beginning character!

	          if (targetI !== targetLen) for (;;) {
	            if (targetI >= targetLen) {
	              // We failed to find a good spot for this search char, go back to the previous search char and force it forward
	              if (searchI <= 0) {
	                // We failed to push chars forward for a better match
	                // transpose, starting from the beginning
	                ++typoStrictI;
	                if (typoStrictI > searchLen - 2) break;
	                if (searchLowerCodes[typoStrictI] === searchLowerCodes[typoStrictI + 1]) continue; // doesn't make sense to transpose a repeat char

	                targetI = firstPossibleI;
	                continue;
	              }

	              --searchI;
	              var lastMatch = matchesStrict[--matchesStrictLen];
	              targetI = nextBeginningIndexes[lastMatch];
	            } else {
	              var isMatch = searchLowerCodes[typoStrictI === 0 ? searchI : typoStrictI === searchI ? searchI + 1 : typoStrictI === searchI - 1 ? searchI - 1 : searchI] === targetLowerCodes[targetI];

	              if (isMatch) {
	                matchesStrict[matchesStrictLen++] = targetI;
	                ++searchI;

	                if (searchI === searchLen) {
	                  successStrict = true;
	                  break;
	                }

	                ++targetI;
	              } else {
	                targetI = nextBeginningIndexes[targetI];
	              }
	            }
	          }
	          {
	            // tally up the score & keep track of matches for highlighting later
	            if (successStrict) {
	              var matchesBest = matchesStrict;
	              var matchesBestLen = matchesStrictLen;
	            } else {
	              var matchesBest = matchesSimple;
	              var matchesBestLen = matchesSimpleLen;
	            }

	            var score = 0;
	            var lastTargetI = -1;

	            for (var i = 0; i < searchLen; ++i) {
	              var targetI = matchesBest[i]; // score only goes down if they're not consecutive

	              if (lastTargetI !== targetI - 1) score -= targetI;
	              lastTargetI = targetI;
	            }

	            if (!successStrict) {
	              score *= 1000;
	              if (typoSimpleI !== 0) score += -20;
	              /*typoPenalty*/
	            } else {
	              if (typoStrictI !== 0) score += -20;
	              /*typoPenalty*/
	            }

	            score -= targetLen - searchLen;
	            prepared.score = score;
	            prepared.indexes = new Array(matchesBestLen);

	            for (var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i];

	            return prepared;
	          }
	        },
	        algorithmNoTypo: function (searchLowerCodes, prepared, searchLowerCode) {
	          var targetLowerCodes = prepared._targetLowerCodes;
	          var searchLen = searchLowerCodes.length;
	          var targetLen = targetLowerCodes.length;
	          var searchI = 0; // where we at

	          var targetI = 0; // where you at

	          var matchesSimpleLen = 0; // very basic fuzzy match; to remove non-matching targets ASAP!
	          // walk through target. find sequential matches.
	          // if all chars aren't found then exit

	          for (;;) {
	            var isMatch = searchLowerCode === targetLowerCodes[targetI];

	            if (isMatch) {
	              matchesSimple[matchesSimpleLen++] = targetI;
	              ++searchI;
	              if (searchI === searchLen) break;
	              searchLowerCode = searchLowerCodes[searchI];
	            }

	            ++targetI;
	            if (targetI >= targetLen) return null; // Failed to find searchI
	          }

	          var searchI = 0;
	          var successStrict = false;
	          var matchesStrictLen = 0;
	          var nextBeginningIndexes = prepared._nextBeginningIndexes;
	          if (nextBeginningIndexes === null) nextBeginningIndexes = prepared._nextBeginningIndexes = fuzzysort.prepareNextBeginningIndexes(prepared.target);
	          var firstPossibleI = targetI = matchesSimple[0] === 0 ? 0 : nextBeginningIndexes[matchesSimple[0] - 1]; // Our target string successfully matched all characters in sequence!
	          // Let's try a more advanced and strict test to improve the score
	          // only count it as a match if it's consecutive or a beginning character!

	          if (targetI !== targetLen) for (;;) {
	            if (targetI >= targetLen) {
	              // We failed to find a good spot for this search char, go back to the previous search char and force it forward
	              if (searchI <= 0) break; // We failed to push chars forward for a better match

	              --searchI;
	              var lastMatch = matchesStrict[--matchesStrictLen];
	              targetI = nextBeginningIndexes[lastMatch];
	            } else {
	              var isMatch = searchLowerCodes[searchI] === targetLowerCodes[targetI];

	              if (isMatch) {
	                matchesStrict[matchesStrictLen++] = targetI;
	                ++searchI;

	                if (searchI === searchLen) {
	                  successStrict = true;
	                  break;
	                }

	                ++targetI;
	              } else {
	                targetI = nextBeginningIndexes[targetI];
	              }
	            }
	          }
	          {
	            // tally up the score & keep track of matches for highlighting later
	            if (successStrict) {
	              var matchesBest = matchesStrict;
	              var matchesBestLen = matchesStrictLen;
	            } else {
	              var matchesBest = matchesSimple;
	              var matchesBestLen = matchesSimpleLen;
	            }

	            var score = 0;
	            var lastTargetI = -1;

	            for (var i = 0; i < searchLen; ++i) {
	              var targetI = matchesBest[i]; // score only goes down if they're not consecutive

	              if (lastTargetI !== targetI - 1) score -= targetI;
	              lastTargetI = targetI;
	            }

	            if (!successStrict) score *= 1000;
	            score -= targetLen - searchLen;
	            prepared.score = score;
	            prepared.indexes = new Array(matchesBestLen);

	            for (var i = matchesBestLen - 1; i >= 0; --i) prepared.indexes[i] = matchesBest[i];

	            return prepared;
	          }
	        },
	        prepareLowerCodes: function (str) {
	          var strLen = str.length;
	          var lowerCodes = []; // new Array(strLen)    sparse array is too slow

	          var lower = str.toLowerCase();

	          for (var i = 0; i < strLen; ++i) lowerCodes[i] = lower.charCodeAt(i);

	          return lowerCodes;
	        },
	        prepareBeginningIndexes: function (target) {
	          var targetLen = target.length;
	          var beginningIndexes = [];
	          var beginningIndexesLen = 0;
	          var wasUpper = false;
	          var wasAlphanum = false;

	          for (var i = 0; i < targetLen; ++i) {
	            var targetCode = target.charCodeAt(i);
	            var isUpper = targetCode >= 65 && targetCode <= 90;
	            var isAlphanum = isUpper || targetCode >= 97 && targetCode <= 122 || targetCode >= 48 && targetCode <= 57;
	            var isBeginning = isUpper && !wasUpper || !wasAlphanum || !isAlphanum;
	            wasUpper = isUpper;
	            wasAlphanum = isAlphanum;
	            if (isBeginning) beginningIndexes[beginningIndexesLen++] = i;
	          }

	          return beginningIndexes;
	        },
	        prepareNextBeginningIndexes: function (target) {
	          var targetLen = target.length;
	          var beginningIndexes = fuzzysort.prepareBeginningIndexes(target);
	          var nextBeginningIndexes = []; // new Array(targetLen)     sparse array is too slow

	          var lastIsBeginning = beginningIndexes[0];
	          var lastIsBeginningI = 0;

	          for (var i = 0; i < targetLen; ++i) {
	            if (lastIsBeginning > i) {
	              nextBeginningIndexes[i] = lastIsBeginning;
	            } else {
	              lastIsBeginning = beginningIndexes[++lastIsBeginningI];
	              nextBeginningIndexes[i] = lastIsBeginning === undefined ? targetLen : lastIsBeginning;
	            }
	          }

	          return nextBeginningIndexes;
	        },
	        cleanup: cleanup,
	        new: fuzzysortNew
	      };
	      return fuzzysort;
	    } // fuzzysortNew
	    // This stuff is outside fuzzysortNew, because it's shared with instances of fuzzysort.new()


	    var isNode = typeof commonjsRequire !== 'undefined' && typeof window === 'undefined'; // var MAX_INT = Number.MAX_SAFE_INTEGER
	    // var MIN_INT = Number.MIN_VALUE

	    var preparedCache = new Map();
	    var preparedSearchCache = new Map();
	    var noResults = [];
	    noResults.total = 0;
	    var matchesSimple = [];
	    var matchesStrict = [];

	    function cleanup() {
	      preparedCache.clear();
	      preparedSearchCache.clear();
	      matchesSimple = [];
	      matchesStrict = [];
	    }

	    function defaultScoreFn(a) {
	      var max = -9007199254740991;

	      for (var i = a.length - 1; i >= 0; --i) {
	        var result = a[i];
	        if (result === null) continue;
	        var score = result.score;
	        if (score > max) max = score;
	      }

	      if (max === -9007199254740991) return null;
	      return max;
	    } // prop = 'key'              2.5ms optimized for this case, seems to be about as fast as direct obj[prop]
	    // prop = 'key1.key2'        10ms
	    // prop = ['key1', 'key2']   27ms


	    function getValue(obj, prop) {
	      var tmp = obj[prop];
	      if (tmp !== undefined) return tmp;
	      var segs = prop;
	      if (!Array.isArray(prop)) segs = prop.split('.');
	      var len = segs.length;
	      var i = -1;

	      while (obj && ++i < len) obj = obj[segs[i]];

	      return obj;
	    }

	    function isObj(x) {
	      return typeof x === 'object';
	    } // faster as a function
	    // Hacked version of https://github.com/lemire/FastPriorityQueue.js


	    var fastpriorityqueue = function () {
	      var r = [],
	          o = 0,
	          e = {};

	      function n() {
	        for (var e = 0, n = r[e], c = 1; c < o;) {
	          var f = c + 1;
	          e = c, f < o && r[f].score < r[c].score && (e = f), r[e - 1 >> 1] = r[e], c = 1 + (e << 1);
	        }

	        for (var a = e - 1 >> 1; e > 0 && n.score < r[a].score; a = (e = a) - 1 >> 1) r[e] = r[a];

	        r[e] = n;
	      }

	      return e.add = function (e) {
	        var n = o;
	        r[o++] = e;

	        for (var c = n - 1 >> 1; n > 0 && e.score < r[c].score; c = (n = c) - 1 >> 1) r[n] = r[c];

	        r[n] = e;
	      }, e.poll = function () {
	        if (0 !== o) {
	          var e = r[0];
	          return r[0] = r[--o], n(), e;
	        }
	      }, e.peek = function (e) {
	        if (0 !== o) return r[0];
	      }, e.replaceTop = function (o) {
	        r[0] = o, n();
	      }, e;
	    };

	    var q = fastpriorityqueue(); // reuse this, except for async, it needs to make its own

	    return fuzzysortNew();
	  }); // UMD
	  // TODO: (performance) wasm version!?
	  // TODO: (performance) layout memory in an optimal way to go fast by avoiding cache misses
	  // TODO: (performance) preparedCache is a memory leak
	  // TODO: (like sublime) backslash === forwardslash
	  // TODO: (performance) i have no idea how well optizmied the allowing typos algorithm is

	});

	var stats = {
	  passedTests: 0,
	  failedTests: 0,
	  skippedTests: 0,
	  todoTests: 0
	}; // Escape text for attribute or text content.

	function escapeText(s) {
	  if (!s) {
	    return "";
	  }

	  s = s + ""; // Both single quotes and double quotes (for attributes)

	  return s.replace(/['"<>&]/g, function (s) {
	    switch (s) {
	      case "'":
	        return "&#039;";

	      case "\"":
	        return "&quot;";

	      case "<":
	        return "&lt;";

	      case ">":
	        return "&gt;";

	      case "&":
	        return "&amp;";
	    }
	  });
	}

	(function () {
	  // Don't load the HTML Reporter on non-browser environments
	  if (typeof window$1 === "undefined" || !window$1.document) {
	    return;
	  }

	  var config = QUnit.config,
	      hiddenTests = [],
	      document = window$1.document,
	      collapseNext = false,
	      hasOwn = Object.prototype.hasOwnProperty,
	      unfilteredUrl = setUrl({
	    filter: undefined,
	    module: undefined,
	    moduleId: undefined,
	    testId: undefined
	  }),
	      modulesList = [];

	  function addEvent(elem, type, fn) {
	    elem.addEventListener(type, fn, false);
	  }

	  function removeEvent(elem, type, fn) {
	    elem.removeEventListener(type, fn, false);
	  }

	  function addEvents(elems, type, fn) {
	    var i = elems.length;

	    while (i--) {
	      addEvent(elems[i], type, fn);
	    }
	  }

	  function hasClass(elem, name) {
	    return (" " + elem.className + " ").indexOf(" " + name + " ") >= 0;
	  }

	  function addClass(elem, name) {
	    if (!hasClass(elem, name)) {
	      elem.className += (elem.className ? " " : "") + name;
	    }
	  }

	  function toggleClass(elem, name, force) {
	    if (force || typeof force === "undefined" && !hasClass(elem, name)) {
	      addClass(elem, name);
	    } else {
	      removeClass(elem, name);
	    }
	  }

	  function removeClass(elem, name) {
	    var set = " " + elem.className + " "; // Class name may appear multiple times

	    while (set.indexOf(" " + name + " ") >= 0) {
	      set = set.replace(" " + name + " ", " ");
	    } // Trim for prettiness


	    elem.className = typeof set.trim === "function" ? set.trim() : set.replace(/^\s+|\s+$/g, "");
	  }

	  function id(name) {
	    return document.getElementById && document.getElementById(name);
	  }

	  function abortTests() {
	    var abortButton = id("qunit-abort-tests-button");

	    if (abortButton) {
	      abortButton.disabled = true;
	      abortButton.innerHTML = "Aborting...";
	    }

	    QUnit.config.queue.length = 0;
	    return false;
	  }

	  function interceptNavigation(ev) {
	    applyUrlParams();

	    if (ev && ev.preventDefault) {
	      ev.preventDefault();
	    }

	    return false;
	  }

	  function getUrlConfigHtml() {
	    var i,
	        j,
	        val,
	        escaped,
	        escapedTooltip,
	        selection = false,
	        urlConfig = config.urlConfig,
	        urlConfigHtml = "";

	    for (i = 0; i < urlConfig.length; i++) {
	      // Options can be either strings or objects with nonempty "id" properties
	      val = config.urlConfig[i];

	      if (typeof val === "string") {
	        val = {
	          id: val,
	          label: val
	        };
	      }

	      escaped = escapeText(val.id);
	      escapedTooltip = escapeText(val.tooltip);

	      if (!val.value || typeof val.value === "string") {
	        urlConfigHtml += "<label for='qunit-urlconfig-" + escaped + "' title='" + escapedTooltip + "'><input id='qunit-urlconfig-" + escaped + "' name='" + escaped + "' type='checkbox'" + (val.value ? " value='" + escapeText(val.value) + "'" : "") + (config[val.id] ? " checked='checked'" : "") + " title='" + escapedTooltip + "' />" + escapeText(val.label) + "</label>";
	      } else {
	        urlConfigHtml += "<label for='qunit-urlconfig-" + escaped + "' title='" + escapedTooltip + "'>" + val.label + ": </label><select id='qunit-urlconfig-" + escaped + "' name='" + escaped + "' title='" + escapedTooltip + "'><option></option>";

	        if (QUnit.is("array", val.value)) {
	          for (j = 0; j < val.value.length; j++) {
	            escaped = escapeText(val.value[j]);
	            urlConfigHtml += "<option value='" + escaped + "'" + (config[val.id] === val.value[j] ? (selection = true) && " selected='selected'" : "") + ">" + escaped + "</option>";
	          }
	        } else {
	          for (j in val.value) {
	            if (hasOwn.call(val.value, j)) {
	              urlConfigHtml += "<option value='" + escapeText(j) + "'" + (config[val.id] === j ? (selection = true) && " selected='selected'" : "") + ">" + escapeText(val.value[j]) + "</option>";
	            }
	          }
	        }

	        if (config[val.id] && !selection) {
	          escaped = escapeText(config[val.id]);
	          urlConfigHtml += "<option value='" + escaped + "' selected='selected' disabled='disabled'>" + escaped + "</option>";
	        }

	        urlConfigHtml += "</select>";
	      }
	    }

	    return urlConfigHtml;
	  } // Handle "click" events on toolbar checkboxes and "change" for select menus.
	  // Updates the URL with the new state of `config.urlConfig` values.


	  function toolbarChanged() {
	    var updatedUrl,
	        value,
	        tests,
	        field = this,
	        params = {}; // Detect if field is a select menu or a checkbox

	    if ("selectedIndex" in field) {
	      value = field.options[field.selectedIndex].value || undefined;
	    } else {
	      value = field.checked ? field.defaultValue || true : undefined;
	    }

	    params[field.name] = value;
	    updatedUrl = setUrl(params); // Check if we can apply the change without a page refresh

	    if ("hidepassed" === field.name && "replaceState" in window$1.history) {
	      QUnit.urlParams[field.name] = value;
	      config[field.name] = value || false;
	      tests = id("qunit-tests");

	      if (tests) {
	        var length = tests.children.length;
	        var children = tests.children;

	        if (field.checked) {
	          for (var i = 0; i < length; i++) {
	            var test = children[i];
	            var className = test ? test.className : "";
	            var classNameHasPass = className.indexOf("pass") > -1;
	            var classNameHasSkipped = className.indexOf("skipped") > -1;

	            if (classNameHasPass || classNameHasSkipped) {
	              hiddenTests.push(test);
	            }
	          }

	          var _iterator = _createForOfIteratorHelper(hiddenTests),
	              _step;

	          try {
	            for (_iterator.s(); !(_step = _iterator.n()).done;) {
	              var hiddenTest = _step.value;
	              tests.removeChild(hiddenTest);
	            }
	          } catch (err) {
	            _iterator.e(err);
	          } finally {
	            _iterator.f();
	          }
	        } else {
	          while ((test = hiddenTests.pop()) != null) {
	            tests.appendChild(test);
	          }
	        }
	      }

	      window$1.history.replaceState(null, "", updatedUrl);
	    } else {
	      window$1.location = updatedUrl;
	    }
	  }

	  function setUrl(params) {
	    var key,
	        arrValue,
	        i,
	        querystring = "?",
	        location = window$1.location;
	    params = QUnit.extend(QUnit.extend({}, QUnit.urlParams), params);

	    for (key in params) {
	      // Skip inherited or undefined properties
	      if (hasOwn.call(params, key) && params[key] !== undefined) {
	        // Output a parameter for each value of this key
	        // (but usually just one)
	        arrValue = [].concat(params[key]);

	        for (i = 0; i < arrValue.length; i++) {
	          querystring += encodeURIComponent(key);

	          if (arrValue[i] !== true) {
	            querystring += "=" + encodeURIComponent(arrValue[i]);
	          }

	          querystring += "&";
	        }
	      }
	    }

	    return location.protocol + "//" + location.host + location.pathname + querystring.slice(0, -1);
	  }

	  function applyUrlParams() {
	    var i,
	        selectedModules = [],
	        modulesList = id("qunit-modulefilter-dropdown-list").getElementsByTagName("input"),
	        filter = id("qunit-filter-input").value;

	    for (i = 0; i < modulesList.length; i++) {
	      if (modulesList[i].checked) {
	        selectedModules.push(modulesList[i].value);
	      }
	    }

	    window$1.location = setUrl({
	      filter: filter === "" ? undefined : filter,
	      moduleId: selectedModules.length === 0 ? undefined : selectedModules,
	      // Remove module and testId filter
	      module: undefined,
	      testId: undefined
	    });
	  }

	  function toolbarUrlConfigContainer() {
	    var urlConfigContainer = document.createElement("span");
	    urlConfigContainer.innerHTML = getUrlConfigHtml();
	    addClass(urlConfigContainer, "qunit-url-config");
	    addEvents(urlConfigContainer.getElementsByTagName("input"), "change", toolbarChanged);
	    addEvents(urlConfigContainer.getElementsByTagName("select"), "change", toolbarChanged);
	    return urlConfigContainer;
	  }

	  function abortTestsButton() {
	    var button = document.createElement("button");
	    button.id = "qunit-abort-tests-button";
	    button.innerHTML = "Abort";
	    addEvent(button, "click", abortTests);
	    return button;
	  }

	  function toolbarLooseFilter() {
	    var filter = document.createElement("form"),
	        label = document.createElement("label"),
	        input = document.createElement("input"),
	        button = document.createElement("button");
	    addClass(filter, "qunit-filter");
	    label.innerHTML = "Filter: ";
	    input.type = "text";
	    input.value = config.filter || "";
	    input.name = "filter";
	    input.id = "qunit-filter-input";
	    button.innerHTML = "Go";
	    label.appendChild(input);
	    filter.appendChild(label);
	    filter.appendChild(document.createTextNode(" "));
	    filter.appendChild(button);
	    addEvent(filter, "submit", interceptNavigation);
	    return filter;
	  }

	  function moduleListHtml(modules) {
	    var i,
	        checked,
	        html = "";

	    for (i = 0; i < modules.length; i++) {
	      if (modules[i].name !== "") {
	        checked = config.moduleId.indexOf(modules[i].moduleId) > -1;
	        html += "<li><label class='clickable" + (checked ? " checked" : "") + "'><input type='checkbox' " + "value='" + modules[i].moduleId + "'" + (checked ? " checked='checked'" : "") + " />" + escapeText(modules[i].name) + "</label></li>";
	      }
	    }

	    return html;
	  }

	  function toolbarModuleFilter() {
	    var commit,
	        reset,
	        moduleFilter = document.createElement("form"),
	        label = document.createElement("label"),
	        moduleSearch = document.createElement("input"),
	        dropDown = document.createElement("div"),
	        actions = document.createElement("span"),
	        applyButton = document.createElement("button"),
	        resetButton = document.createElement("button"),
	        allModulesLabel = document.createElement("label"),
	        allCheckbox = document.createElement("input"),
	        dropDownList = document.createElement("ul"),
	        dirty = false;
	    moduleSearch.id = "qunit-modulefilter-search";
	    moduleSearch.autocomplete = "off";
	    addEvent(moduleSearch, "input", searchInput);
	    addEvent(moduleSearch, "input", searchFocus);
	    addEvent(moduleSearch, "focus", searchFocus);
	    addEvent(moduleSearch, "click", searchFocus);
	    config.modules.forEach(function (module) {
	      return module.namePrepared = fuzzysort.prepare(module.name);
	    });
	    label.id = "qunit-modulefilter-search-container";
	    label.innerHTML = "Module: ";
	    label.appendChild(moduleSearch);
	    applyButton.textContent = "Apply";
	    applyButton.style.display = "none";
	    resetButton.textContent = "Reset";
	    resetButton.type = "reset";
	    resetButton.style.display = "none";
	    allCheckbox.type = "checkbox";
	    allCheckbox.checked = config.moduleId.length === 0;
	    allModulesLabel.className = "clickable";

	    if (config.moduleId.length) {
	      allModulesLabel.className = "checked";
	    }

	    allModulesLabel.appendChild(allCheckbox);
	    allModulesLabel.appendChild(document.createTextNode("All modules"));
	    actions.id = "qunit-modulefilter-actions";
	    actions.appendChild(applyButton);
	    actions.appendChild(resetButton);
	    actions.appendChild(allModulesLabel);
	    commit = actions.firstChild;
	    reset = commit.nextSibling;
	    addEvent(commit, "click", applyUrlParams);
	    dropDownList.id = "qunit-modulefilter-dropdown-list";
	    dropDownList.innerHTML = moduleListHtml(config.modules);
	    dropDown.id = "qunit-modulefilter-dropdown";
	    dropDown.style.display = "none";
	    dropDown.appendChild(actions);
	    dropDown.appendChild(dropDownList);
	    addEvent(dropDown, "change", selectionChange);
	    selectionChange();
	    moduleFilter.id = "qunit-modulefilter";
	    moduleFilter.appendChild(label);
	    moduleFilter.appendChild(dropDown);
	    addEvent(moduleFilter, "submit", interceptNavigation);
	    addEvent(moduleFilter, "reset", function () {
	      // Let the reset happen, then update styles
	      window$1.setTimeout(selectionChange);
	    }); // Enables show/hide for the dropdown

	    function searchFocus() {
	      if (dropDown.style.display !== "none") {
	        return;
	      }

	      dropDown.style.display = "block";
	      addEvent(document, "click", hideHandler);
	      addEvent(document, "keydown", hideHandler); // Hide on Escape keydown or outside-container click

	      function hideHandler(e) {
	        var inContainer = moduleFilter.contains(e.target);

	        if (e.keyCode === 27 || !inContainer) {
	          if (e.keyCode === 27 && inContainer) {
	            moduleSearch.focus();
	          }

	          dropDown.style.display = "none";
	          removeEvent(document, "click", hideHandler);
	          removeEvent(document, "keydown", hideHandler);
	          moduleSearch.value = "";
	          searchInput();
	        }
	      }
	    }

	    function filterModules(searchText) {
	      if (searchText === "") {
	        return config.modules;
	      }

	      return fuzzysort.go(searchText, config.modules, {
	        key: "namePrepared",
	        threshold: -10000
	      }).map(function (module) {
	        return module.obj;
	      });
	    } // Processes module search box input


	    var searchInputTimeout;

	    function searchInput() {
	      window$1.clearTimeout(searchInputTimeout);
	      searchInputTimeout = window$1.setTimeout(function () {
	        var searchText = moduleSearch.value.toLowerCase(),
	            filteredModules = filterModules(searchText);
	        dropDownList.innerHTML = moduleListHtml(filteredModules);
	      }, 200);
	    } // Processes selection changes


	    function selectionChange(evt) {
	      var i,
	          item,
	          checkbox = evt && evt.target || allCheckbox,
	          modulesList = dropDownList.getElementsByTagName("input"),
	          selectedNames = [];
	      toggleClass(checkbox.parentNode, "checked", checkbox.checked);
	      dirty = false;

	      if (checkbox.checked && checkbox !== allCheckbox) {
	        allCheckbox.checked = false;
	        removeClass(allCheckbox.parentNode, "checked");
	      }

	      for (i = 0; i < modulesList.length; i++) {
	        item = modulesList[i];

	        if (!evt) {
	          toggleClass(item.parentNode, "checked", item.checked);
	        } else if (checkbox === allCheckbox && checkbox.checked) {
	          item.checked = false;
	          removeClass(item.parentNode, "checked");
	        }

	        dirty = dirty || item.checked !== item.defaultChecked;

	        if (item.checked) {
	          selectedNames.push(item.parentNode.textContent);
	        }
	      }

	      commit.style.display = reset.style.display = dirty ? "" : "none";
	      moduleSearch.placeholder = selectedNames.join(", ") || allCheckbox.parentNode.textContent;
	      moduleSearch.title = "Type to filter list. Current selection:\n" + (selectedNames.join("\n") || allCheckbox.parentNode.textContent);
	    }

	    return moduleFilter;
	  }

	  function toolbarFilters() {
	    var toolbarFilters = document.createElement("span");
	    toolbarFilters.id = "qunit-toolbar-filters";
	    toolbarFilters.appendChild(toolbarLooseFilter());
	    toolbarFilters.appendChild(toolbarModuleFilter());
	    return toolbarFilters;
	  }

	  function appendToolbar() {
	    var toolbar = id("qunit-testrunner-toolbar");

	    if (toolbar) {
	      toolbar.appendChild(toolbarUrlConfigContainer());
	      toolbar.appendChild(toolbarFilters());
	      toolbar.appendChild(document.createElement("div")).className = "clearfix";
	    }
	  }

	  function appendHeader() {
	    var header = id("qunit-header");

	    if (header) {
	      header.innerHTML = "<a href='" + escapeText(unfilteredUrl) + "'>" + header.innerHTML + "</a> ";
	    }
	  }

	  function appendBanner() {
	    var banner = id("qunit-banner");

	    if (banner) {
	      banner.className = "";
	    }
	  }

	  function appendTestResults() {
	    var tests = id("qunit-tests"),
	        result = id("qunit-testresult"),
	        controls;

	    if (result) {
	      result.parentNode.removeChild(result);
	    }

	    if (tests) {
	      tests.innerHTML = "";
	      result = document.createElement("p");
	      result.id = "qunit-testresult";
	      result.className = "result";
	      tests.parentNode.insertBefore(result, tests);
	      result.innerHTML = "<div id=\"qunit-testresult-display\">Running...<br />&#160;</div>" + "<div id=\"qunit-testresult-controls\"></div>" + "<div class=\"clearfix\"></div>";
	      controls = id("qunit-testresult-controls");
	    }

	    if (controls) {
	      controls.appendChild(abortTestsButton());
	    }
	  }

	  function appendFilteredTest() {
	    var testId = QUnit.config.testId;

	    if (!testId || testId.length <= 0) {
	      return "";
	    }

	    return "<div id='qunit-filteredTest'>Rerunning selected tests: " + escapeText(testId.join(", ")) + " <a id='qunit-clearFilter' href='" + escapeText(unfilteredUrl) + "'>Run all tests</a></div>";
	  }

	  function appendUserAgent() {
	    var userAgent = id("qunit-userAgent");

	    if (userAgent) {
	      userAgent.innerHTML = "";
	      userAgent.appendChild(document.createTextNode("QUnit " + QUnit.version + "; " + navigator.userAgent));
	    }
	  }

	  function appendInterface() {
	    var qunit = id("qunit"); // For compat with QUnit 1.2, and to support fully custom theme HTML,
	    // we will use any existing elements if no id="qunit" element exists.
	    //
	    // Note that we don't fail or fallback to creating it ourselves,
	    // because not having id="qunit" (and not having the below elements)
	    // simply means QUnit acts headless, allowing users to use their own
	    // reporters, or for a test runner to listen for events directly without
	    // having the HTML reporter actively render anything.

	    if (qunit) {
	      // Since QUnit 1.3, these are created automatically if the page
	      // contains id="qunit".
	      qunit.innerHTML = "<h1 id='qunit-header'>" + escapeText(document.title) + "</h1>" + "<h2 id='qunit-banner'></h2>" + "<div id='qunit-testrunner-toolbar'></div>" + appendFilteredTest() + "<h2 id='qunit-userAgent'></h2>" + "<ol id='qunit-tests'></ol>";
	    }

	    appendHeader();
	    appendBanner();
	    appendTestResults();
	    appendUserAgent();
	    appendToolbar();
	  }

	  function appendTest(name, testId, moduleName) {
	    var title,
	        rerunTrigger,
	        testBlock,
	        assertList,
	        tests = id("qunit-tests");

	    if (!tests) {
	      return;
	    }

	    title = document.createElement("strong");
	    title.innerHTML = getNameHtml(name, moduleName);
	    rerunTrigger = document.createElement("a");
	    rerunTrigger.innerHTML = "Rerun";
	    rerunTrigger.href = setUrl({
	      testId: testId
	    });
	    testBlock = document.createElement("li");
	    testBlock.appendChild(title);
	    testBlock.appendChild(rerunTrigger);
	    testBlock.id = "qunit-test-output-" + testId;
	    assertList = document.createElement("ol");
	    assertList.className = "qunit-assert-list";
	    testBlock.appendChild(assertList);
	    tests.appendChild(testBlock);
	  } // HTML Reporter initialization and load


	  QUnit.begin(function (details) {
	    var i, moduleObj; // Sort modules by name for the picker

	    for (i = 0; i < details.modules.length; i++) {
	      moduleObj = details.modules[i];

	      if (moduleObj.name) {
	        modulesList.push(moduleObj.name);
	      }
	    }

	    modulesList.sort(function (a, b) {
	      return a.localeCompare(b);
	    }); // Initialize QUnit elements

	    appendInterface();
	  });
	  QUnit.done(function (details) {
	    var banner = id("qunit-banner"),
	        tests = id("qunit-tests"),
	        abortButton = id("qunit-abort-tests-button"),
	        totalTests = stats.passedTests + stats.skippedTests + stats.todoTests + stats.failedTests,
	        html = [totalTests, " tests completed in ", details.runtime, " milliseconds, with ", stats.failedTests, " failed, ", stats.skippedTests, " skipped, and ", stats.todoTests, " todo.<br />", "<span class='passed'>", details.passed, "</span> assertions of <span class='total'>", details.total, "</span> passed, <span class='failed'>", details.failed, "</span> failed."].join(""),
	        test,
	        assertLi,
	        assertList; // Update remaining tests to aborted

	    if (abortButton && abortButton.disabled) {
	      html = "Tests aborted after " + details.runtime + " milliseconds.";

	      for (var i = 0; i < tests.children.length; i++) {
	        test = tests.children[i];

	        if (test.className === "" || test.className === "running") {
	          test.className = "aborted";
	          assertList = test.getElementsByTagName("ol")[0];
	          assertLi = document.createElement("li");
	          assertLi.className = "fail";
	          assertLi.innerHTML = "Test aborted.";
	          assertList.appendChild(assertLi);
	        }
	      }
	    }

	    if (banner && (!abortButton || abortButton.disabled === false)) {
	      banner.className = stats.failedTests ? "qunit-fail" : "qunit-pass";
	    }

	    if (abortButton) {
	      abortButton.parentNode.removeChild(abortButton);
	    }

	    if (tests) {
	      id("qunit-testresult-display").innerHTML = html;
	    }

	    if (config.altertitle && document.title) {
	      // Show ✖ for good, ✔ for bad suite result in title
	      // use escape sequences in case file gets loaded with non-utf-8
	      // charset
	      document.title = [stats.failedTests ? "\u2716" : "\u2714", document.title.replace(/^[\u2714\u2716] /i, "")].join(" ");
	    } // Scroll back to top to show results


	    if (config.scrolltop && window$1.scrollTo) {
	      window$1.scrollTo(0, 0);
	    }
	  });

	  function getNameHtml(name, module) {
	    var nameHtml = "";

	    if (module) {
	      nameHtml = "<span class='module-name'>" + escapeText(module) + "</span>: ";
	    }

	    nameHtml += "<span class='test-name'>" + escapeText(name) + "</span>";
	    return nameHtml;
	  }

	  function getProgressHtml(runtime, stats, total) {
	    var completed = stats.passedTests + stats.skippedTests + stats.todoTests + stats.failedTests;
	    return ["<br />", completed, " / ", total, " tests completed in ", runtime, " milliseconds, with ", stats.failedTests, " failed, ", stats.skippedTests, " skipped, and ", stats.todoTests, " todo."].join("");
	  }

	  QUnit.testStart(function (details) {
	    var running, bad;
	    appendTest(details.name, details.testId, details.module);
	    running = id("qunit-testresult-display");

	    if (running) {
	      addClass(running, "running");
	      bad = QUnit.config.reorder && details.previousFailure;
	      running.innerHTML = [bad ? "Rerunning previously failed test: <br />" : "Running: <br />", getNameHtml(details.name, details.module), getProgressHtml(now() - config.started, stats, Test.count)].join("");
	    }
	  });

	  function stripHtml(string) {
	    // Strip tags, html entity and whitespaces
	    return string.replace(/<\/?[^>]+(>|$)/g, "").replace(/&quot;/g, "").replace(/\s+/g, "");
	  }

	  QUnit.log(function (details) {
	    var assertList,
	        assertLi,
	        message,
	        expected,
	        actual,
	        diff,
	        showDiff = false,
	        testItem = id("qunit-test-output-" + details.testId);

	    if (!testItem) {
	      return;
	    }

	    message = escapeText(details.message) || (details.result ? "okay" : "failed");
	    message = "<span class='test-message'>" + message + "</span>";
	    message += "<span class='runtime'>@ " + details.runtime + " ms</span>"; // The pushFailure doesn't provide details.expected
	    // when it calls, it's implicit to also not show expected and diff stuff
	    // Also, we need to check details.expected existence, as it can exist and be undefined

	    if (!details.result && hasOwn.call(details, "expected")) {
	      if (details.negative) {
	        expected = "NOT " + QUnit.dump.parse(details.expected);
	      } else {
	        expected = QUnit.dump.parse(details.expected);
	      }

	      actual = QUnit.dump.parse(details.actual);
	      message += "<table><tr class='test-expected'><th>Expected: </th><td><pre>" + escapeText(expected) + "</pre></td></tr>";

	      if (actual !== expected) {
	        message += "<tr class='test-actual'><th>Result: </th><td><pre>" + escapeText(actual) + "</pre></td></tr>";

	        if (typeof details.actual === "number" && typeof details.expected === "number") {
	          if (!isNaN(details.actual) && !isNaN(details.expected)) {
	            showDiff = true;
	            diff = details.actual - details.expected;
	            diff = (diff > 0 ? "+" : "") + diff;
	          }
	        } else if (typeof details.actual !== "boolean" && typeof details.expected !== "boolean") {
	          diff = QUnit.diff(expected, actual); // don't show diff if there is zero overlap

	          showDiff = stripHtml(diff).length !== stripHtml(expected).length + stripHtml(actual).length;
	        }

	        if (showDiff) {
	          message += "<tr class='test-diff'><th>Diff: </th><td><pre>" + diff + "</pre></td></tr>";
	        }
	      } else if (expected.indexOf("[object Array]") !== -1 || expected.indexOf("[object Object]") !== -1) {
	        message += "<tr class='test-message'><th>Message: </th><td>" + "Diff suppressed as the depth of object is more than current max depth (" + QUnit.config.maxDepth + ").<p>Hint: Use <code>QUnit.dump.maxDepth</code> to " + " run with a higher max depth or <a href='" + escapeText(setUrl({
	          maxDepth: -1
	        })) + "'>" + "Rerun</a> without max depth.</p></td></tr>";
	      } else {
	        message += "<tr class='test-message'><th>Message: </th><td>" + "Diff suppressed as the expected and actual results have an equivalent" + " serialization</td></tr>";
	      }

	      if (details.source) {
	        message += "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText(details.source) + "</pre></td></tr>";
	      }

	      message += "</table>"; // This occurs when pushFailure is set and we have an extracted stack trace
	    } else if (!details.result && details.source) {
	      message += "<table>" + "<tr class='test-source'><th>Source: </th><td><pre>" + escapeText(details.source) + "</pre></td></tr>" + "</table>";
	    }

	    assertList = testItem.getElementsByTagName("ol")[0];
	    assertLi = document.createElement("li");
	    assertLi.className = details.result ? "pass" : "fail";
	    assertLi.innerHTML = message;
	    assertList.appendChild(assertLi);
	  });
	  QUnit.testDone(function (details) {
	    var testTitle,
	        time,
	        testItem,
	        assertList,
	        status,
	        good,
	        bad,
	        testCounts,
	        skipped,
	        sourceName,
	        tests = id("qunit-tests");

	    if (!tests) {
	      return;
	    }

	    testItem = id("qunit-test-output-" + details.testId);
	    removeClass(testItem, "running");

	    if (details.failed > 0) {
	      status = "failed";
	    } else if (details.todo) {
	      status = "todo";
	    } else {
	      status = details.skipped ? "skipped" : "passed";
	    }

	    assertList = testItem.getElementsByTagName("ol")[0];
	    good = details.passed;
	    bad = details.failed; // This test passed if it has no unexpected failed assertions

	    var testPassed = details.failed > 0 ? details.todo : !details.todo;

	    if (testPassed) {
	      // Collapse the passing tests
	      addClass(assertList, "qunit-collapsed");
	    } else if (config.collapse) {
	      if (!collapseNext) {
	        // Skip collapsing the first failing test
	        collapseNext = true;
	      } else {
	        // Collapse remaining tests
	        addClass(assertList, "qunit-collapsed");
	      }
	    } // The testItem.firstChild is the test name


	    testTitle = testItem.firstChild;
	    testCounts = bad ? "<b class='failed'>" + bad + "</b>, " + "<b class='passed'>" + good + "</b>, " : "";
	    testTitle.innerHTML += " <b class='counts'>(" + testCounts + details.assertions.length + ")</b>";

	    if (details.skipped) {
	      stats.skippedTests++;
	      testItem.className = "skipped";
	      skipped = document.createElement("em");
	      skipped.className = "qunit-skipped-label";
	      skipped.innerHTML = "skipped";
	      testItem.insertBefore(skipped, testTitle);
	    } else {
	      addEvent(testTitle, "click", function () {
	        toggleClass(assertList, "qunit-collapsed");
	      });
	      testItem.className = testPassed ? "pass" : "fail";

	      if (details.todo) {
	        var todoLabel = document.createElement("em");
	        todoLabel.className = "qunit-todo-label";
	        todoLabel.innerHTML = "todo";
	        testItem.className += " todo";
	        testItem.insertBefore(todoLabel, testTitle);
	      }

	      time = document.createElement("span");
	      time.className = "runtime";
	      time.innerHTML = details.runtime + " ms";
	      testItem.insertBefore(time, assertList);

	      if (!testPassed) {
	        stats.failedTests++;
	      } else if (details.todo) {
	        stats.todoTests++;
	      } else {
	        stats.passedTests++;
	      }
	    } // Show the source of the test when showing assertions


	    if (details.source) {
	      sourceName = document.createElement("p");
	      sourceName.innerHTML = "<strong>Source: </strong>" + escapeText(details.source);
	      addClass(sourceName, "qunit-source");

	      if (testPassed) {
	        addClass(sourceName, "qunit-collapsed");
	      }

	      addEvent(testTitle, "click", function () {
	        toggleClass(sourceName, "qunit-collapsed");
	      });
	      testItem.appendChild(sourceName);
	    }

	    if (config.hidepassed && (status === "passed" || details.skipped)) {
	      // use removeChild instead of remove because of support
	      hiddenTests.push(testItem);
	      tests.removeChild(testItem);
	    }
	  }); // Avoid readyState issue with phantomjs
	  // Ref: #818

	  var notPhantom = function (p) {
	    return !(p && p.version && p.version.major > 0);
	  }(window$1.phantom);

	  if (notPhantom && document.readyState === "complete") {
	    QUnit.load();
	  } else {
	    addEvent(window$1, "load", QUnit.load);
	  } // Wrap window.onerror. We will call the original window.onerror to see if
	  // the existing handler fully handles the error; if not, we will call the
	  // QUnit.onError function.


	  var originalWindowOnError = window$1.onerror; // Cover uncaught exceptions
	  // Returning true will suppress the default browser handler,
	  // returning false will let it run.

	  window$1.onerror = function (message, fileName, lineNumber, columnNumber, errorObj) {
	    var ret = false;

	    if (originalWindowOnError) {
	      for (var _len = arguments.length, args = new Array(_len > 5 ? _len - 5 : 0), _key = 5; _key < _len; _key++) {
	        args[_key - 5] = arguments[_key];
	      }

	      ret = originalWindowOnError.call.apply(originalWindowOnError, [this, message, fileName, lineNumber, columnNumber, errorObj].concat(args));
	    } // Treat return value as window.onerror itself does,
	    // Only do our handling if not suppressed.


	    if (ret !== true) {
	      var error = {
	        message: message,
	        fileName: fileName,
	        lineNumber: lineNumber
	      }; // According to
	      // https://blog.sentry.io/2016/01/04/client-javascript-reporting-window-onerror,
	      // most modern browsers support an errorObj argument; use that to
	      // get a full stack trace if it's available.

	      if (errorObj && errorObj.stack) {
	        error.stacktrace = extractStacktrace(errorObj, 0);
	      }

	      ret = QUnit.onError(error);
	    }

	    return ret;
	  }; // Listen for unhandled rejections, and call QUnit.onUnhandledRejection


	  window$1.addEventListener("unhandledrejection", function (event) {
	    QUnit.onUnhandledRejection(event.reason);
	  });
	})();

	/*
	 * This file is a modified version of google-diff-match-patch's JavaScript implementation
	 * (https://code.google.com/p/google-diff-match-patch/source/browse/trunk/javascript/diff_match_patch_uncompressed.js),
	 * modifications are licensed as more fully set forth in LICENSE.txt.
	 *
	 * The original source of google-diff-match-patch is attributable and licensed as follows:
	 *
	 * Copyright 2006 Google Inc.
	 * https://code.google.com/p/google-diff-match-patch/
	 *
	 * Licensed under the Apache License, Version 2.0 (the "License");
	 * you may not use this file except in compliance with the License.
	 * You may obtain a copy of the License at
	 *
	 * https://www.apache.org/licenses/LICENSE-2.0
	 *
	 * Unless required by applicable law or agreed to in writing, software
	 * distributed under the License is distributed on an "AS IS" BASIS,
	 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
	 * See the License for the specific language governing permissions and
	 * limitations under the License.
	 *
	 * More Info:
	 *  https://code.google.com/p/google-diff-match-patch/
	 *
	 * Usage: QUnit.diff(expected, actual)
	 *
	 */

	QUnit.diff = function () {
	  function DiffMatchPatch() {} //  DIFF FUNCTIONS

	  /**
	   * The data structure representing a diff is an array of tuples:
	   * [[DIFF_DELETE, 'Hello'], [DIFF_INSERT, 'Goodbye'], [DIFF_EQUAL, ' world.']]
	   * which means: delete 'Hello', add 'Goodbye' and keep ' world.'
	   */


	  var DIFF_DELETE = -1,
	      DIFF_INSERT = 1,
	      DIFF_EQUAL = 0,
	      hasOwn = Object.prototype.hasOwnProperty;
	  /**
	   * Find the differences between two texts.  Simplifies the problem by stripping
	   * any common prefix or suffix off the texts before diffing.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {boolean=} optChecklines Optional speedup flag. If present and false,
	   *     then don't run a line-level diff first to identify the changed areas.
	   *     Defaults to true, which does a faster, slightly less optimal diff.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   */

	  DiffMatchPatch.prototype.DiffMain = function (text1, text2, optChecklines) {
	    var deadline, checklines, commonlength, commonprefix, commonsuffix, diffs; // The diff must be complete in up to 1 second.

	    deadline = new Date().getTime() + 1000; // Check for null inputs.

	    if (text1 === null || text2 === null) {
	      throw new Error("Null input. (DiffMain)");
	    } // Check for equality (speedup).


	    if (text1 === text2) {
	      if (text1) {
	        return [[DIFF_EQUAL, text1]];
	      }

	      return [];
	    }

	    if (typeof optChecklines === "undefined") {
	      optChecklines = true;
	    }

	    checklines = optChecklines; // Trim off common prefix (speedup).

	    commonlength = this.diffCommonPrefix(text1, text2);
	    commonprefix = text1.substring(0, commonlength);
	    text1 = text1.substring(commonlength);
	    text2 = text2.substring(commonlength); // Trim off common suffix (speedup).

	    commonlength = this.diffCommonSuffix(text1, text2);
	    commonsuffix = text1.substring(text1.length - commonlength);
	    text1 = text1.substring(0, text1.length - commonlength);
	    text2 = text2.substring(0, text2.length - commonlength); // Compute the diff on the middle block.

	    diffs = this.diffCompute(text1, text2, checklines, deadline); // Restore the prefix and suffix.

	    if (commonprefix) {
	      diffs.unshift([DIFF_EQUAL, commonprefix]);
	    }

	    if (commonsuffix) {
	      diffs.push([DIFF_EQUAL, commonsuffix]);
	    }

	    this.diffCleanupMerge(diffs);
	    return diffs;
	  };
	  /**
	   * Reduce the number of edits by eliminating operationally trivial equalities.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupEfficiency = function (diffs) {
	    var changes, equalities, equalitiesLength, lastequality, pointer, preIns, preDel, postIns, postDel;
	    changes = false;
	    equalities = []; // Stack of indices where equalities are found.

	    equalitiesLength = 0; // Keeping our own length var is faster in JS.

	    /** @type {?string} */

	    lastequality = null; // Always equal to diffs[equalities[equalitiesLength - 1]][1]

	    pointer = 0; // Index of current position.
	    // Is there an insertion operation before the last equality.

	    preIns = false; // Is there a deletion operation before the last equality.

	    preDel = false; // Is there an insertion operation after the last equality.

	    postIns = false; // Is there a deletion operation after the last equality.

	    postDel = false;

	    while (pointer < diffs.length) {
	      // Equality found.
	      if (diffs[pointer][0] === DIFF_EQUAL) {
	        if (diffs[pointer][1].length < 4 && (postIns || postDel)) {
	          // Candidate found.
	          equalities[equalitiesLength++] = pointer;
	          preIns = postIns;
	          preDel = postDel;
	          lastequality = diffs[pointer][1];
	        } else {
	          // Not a candidate, and can never become one.
	          equalitiesLength = 0;
	          lastequality = null;
	        }

	        postIns = postDel = false; // An insertion or deletion.
	      } else {
	        if (diffs[pointer][0] === DIFF_DELETE) {
	          postDel = true;
	        } else {
	          postIns = true;
	        }
	        /*
	         * Five types to be split:
	         * <ins>A</ins><del>B</del>XY<ins>C</ins><del>D</del>
	         * <ins>A</ins>X<ins>C</ins><del>D</del>
	         * <ins>A</ins><del>B</del>X<ins>C</ins>
	         * <ins>A</del>X<ins>C</ins><del>D</del>
	         * <ins>A</ins><del>B</del>X<del>C</del>
	         */


	        if (lastequality && (preIns && preDel && postIns && postDel || lastequality.length < 2 && preIns + preDel + postIns + postDel === 3)) {
	          // Duplicate record.
	          diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastequality]); // Change second copy to insert.

	          diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT;
	          equalitiesLength--; // Throw away the equality we just deleted;

	          lastequality = null;

	          if (preIns && preDel) {
	            // No changes made which could affect previous entry, keep going.
	            postIns = postDel = true;
	            equalitiesLength = 0;
	          } else {
	            equalitiesLength--; // Throw away the previous equality.

	            pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1;
	            postIns = postDel = false;
	          }

	          changes = true;
	        }
	      }

	      pointer++;
	    }

	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    }
	  };
	  /**
	   * Convert a diff array into a pretty HTML report.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   * @param {integer} string to be beautified.
	   * @return {string} HTML representation.
	   */


	  DiffMatchPatch.prototype.diffPrettyHtml = function (diffs) {
	    var op,
	        data,
	        x,
	        html = [];

	    for (x = 0; x < diffs.length; x++) {
	      op = diffs[x][0]; // Operation (insert, delete, equal)

	      data = diffs[x][1]; // Text of change.

	      switch (op) {
	        case DIFF_INSERT:
	          html[x] = "<ins>" + escapeText(data) + "</ins>";
	          break;

	        case DIFF_DELETE:
	          html[x] = "<del>" + escapeText(data) + "</del>";
	          break;

	        case DIFF_EQUAL:
	          html[x] = "<span>" + escapeText(data) + "</span>";
	          break;
	      }
	    }

	    return html.join("");
	  };
	  /**
	   * Determine the common prefix of two strings.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the start of each
	   *     string.
	   */


	  DiffMatchPatch.prototype.diffCommonPrefix = function (text1, text2) {
	    var pointermid, pointermax, pointermin, pointerstart; // Quick check for common null cases.

	    if (!text1 || !text2 || text1.charAt(0) !== text2.charAt(0)) {
	      return 0;
	    } // Binary search.
	    // Performance analysis: https://neil.fraser.name/news/2007/10/09/


	    pointermin = 0;
	    pointermax = Math.min(text1.length, text2.length);
	    pointermid = pointermax;
	    pointerstart = 0;

	    while (pointermin < pointermid) {
	      if (text1.substring(pointerstart, pointermid) === text2.substring(pointerstart, pointermid)) {
	        pointermin = pointermid;
	        pointerstart = pointermin;
	      } else {
	        pointermax = pointermid;
	      }

	      pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
	    }

	    return pointermid;
	  };
	  /**
	   * Determine the common suffix of two strings.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the end of each string.
	   */


	  DiffMatchPatch.prototype.diffCommonSuffix = function (text1, text2) {
	    var pointermid, pointermax, pointermin, pointerend; // Quick check for common null cases.

	    if (!text1 || !text2 || text1.charAt(text1.length - 1) !== text2.charAt(text2.length - 1)) {
	      return 0;
	    } // Binary search.
	    // Performance analysis: https://neil.fraser.name/news/2007/10/09/


	    pointermin = 0;
	    pointermax = Math.min(text1.length, text2.length);
	    pointermid = pointermax;
	    pointerend = 0;

	    while (pointermin < pointermid) {
	      if (text1.substring(text1.length - pointermid, text1.length - pointerend) === text2.substring(text2.length - pointermid, text2.length - pointerend)) {
	        pointermin = pointermid;
	        pointerend = pointermin;
	      } else {
	        pointermax = pointermid;
	      }

	      pointermid = Math.floor((pointermax - pointermin) / 2 + pointermin);
	    }

	    return pointermid;
	  };
	  /**
	   * Find the differences between two texts.  Assumes that the texts do not
	   * have any common prefix or suffix.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {boolean} checklines Speedup flag.  If false, then don't run a
	   *     line-level diff first to identify the changed areas.
	   *     If true, then run a faster, slightly less optimal diff.
	   * @param {number} deadline Time when the diff should be complete by.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCompute = function (text1, text2, checklines, deadline) {
	    var diffs, longtext, shorttext, i, hm, text1A, text2A, text1B, text2B, midCommon, diffsA, diffsB;

	    if (!text1) {
	      // Just add some text (speedup).
	      return [[DIFF_INSERT, text2]];
	    }

	    if (!text2) {
	      // Just delete some text (speedup).
	      return [[DIFF_DELETE, text1]];
	    }

	    longtext = text1.length > text2.length ? text1 : text2;
	    shorttext = text1.length > text2.length ? text2 : text1;
	    i = longtext.indexOf(shorttext);

	    if (i !== -1) {
	      // Shorter text is inside the longer text (speedup).
	      diffs = [[DIFF_INSERT, longtext.substring(0, i)], [DIFF_EQUAL, shorttext], [DIFF_INSERT, longtext.substring(i + shorttext.length)]]; // Swap insertions for deletions if diff is reversed.

	      if (text1.length > text2.length) {
	        diffs[0][0] = diffs[2][0] = DIFF_DELETE;
	      }

	      return diffs;
	    }

	    if (shorttext.length === 1) {
	      // Single character string.
	      // After the previous speedup, the character can't be an equality.
	      return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];
	    } // Check to see if the problem can be split in two.


	    hm = this.diffHalfMatch(text1, text2);

	    if (hm) {
	      // A half-match was found, sort out the return data.
	      text1A = hm[0];
	      text1B = hm[1];
	      text2A = hm[2];
	      text2B = hm[3];
	      midCommon = hm[4]; // Send both pairs off for separate processing.

	      diffsA = this.DiffMain(text1A, text2A, checklines, deadline);
	      diffsB = this.DiffMain(text1B, text2B, checklines, deadline); // Merge the results.

	      return diffsA.concat([[DIFF_EQUAL, midCommon]], diffsB);
	    }

	    if (checklines && text1.length > 100 && text2.length > 100) {
	      return this.diffLineMode(text1, text2, deadline);
	    }

	    return this.diffBisect(text1, text2, deadline);
	  };
	  /**
	   * Do the two texts share a substring which is at least half the length of the
	   * longer text?
	   * This speedup can produce non-minimal diffs.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {Array.<string>} Five element Array, containing the prefix of
	   *     text1, the suffix of text1, the prefix of text2, the suffix of
	   *     text2 and the common middle.  Or null if there was no match.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffHalfMatch = function (text1, text2) {
	    var longtext, shorttext, dmp, text1A, text2B, text2A, text1B, midCommon, hm1, hm2, hm;
	    longtext = text1.length > text2.length ? text1 : text2;
	    shorttext = text1.length > text2.length ? text2 : text1;

	    if (longtext.length < 4 || shorttext.length * 2 < longtext.length) {
	      return null; // Pointless.
	    }

	    dmp = this; // 'this' becomes 'window' in a closure.

	    /**
	     * Does a substring of shorttext exist within longtext such that the substring
	     * is at least half the length of longtext?
	     * Closure, but does not reference any external variables.
	     * @param {string} longtext Longer string.
	     * @param {string} shorttext Shorter string.
	     * @param {number} i Start index of quarter length substring within longtext.
	     * @return {Array.<string>} Five element Array, containing the prefix of
	     *     longtext, the suffix of longtext, the prefix of shorttext, the suffix
	     *     of shorttext and the common middle.  Or null if there was no match.
	     * @private
	     */

	    function diffHalfMatchI(longtext, shorttext, i) {
	      var seed, j, bestCommon, prefixLength, suffixLength, bestLongtextA, bestLongtextB, bestShorttextA, bestShorttextB; // Start with a 1/4 length substring at position i as a seed.

	      seed = longtext.substring(i, i + Math.floor(longtext.length / 4));
	      j = -1;
	      bestCommon = "";

	      while ((j = shorttext.indexOf(seed, j + 1)) !== -1) {
	        prefixLength = dmp.diffCommonPrefix(longtext.substring(i), shorttext.substring(j));
	        suffixLength = dmp.diffCommonSuffix(longtext.substring(0, i), shorttext.substring(0, j));

	        if (bestCommon.length < suffixLength + prefixLength) {
	          bestCommon = shorttext.substring(j - suffixLength, j) + shorttext.substring(j, j + prefixLength);
	          bestLongtextA = longtext.substring(0, i - suffixLength);
	          bestLongtextB = longtext.substring(i + prefixLength);
	          bestShorttextA = shorttext.substring(0, j - suffixLength);
	          bestShorttextB = shorttext.substring(j + prefixLength);
	        }
	      }

	      if (bestCommon.length * 2 >= longtext.length) {
	        return [bestLongtextA, bestLongtextB, bestShorttextA, bestShorttextB, bestCommon];
	      } else {
	        return null;
	      }
	    } // First check if the second quarter is the seed for a half-match.


	    hm1 = diffHalfMatchI(longtext, shorttext, Math.ceil(longtext.length / 4)); // Check again based on the third quarter.

	    hm2 = diffHalfMatchI(longtext, shorttext, Math.ceil(longtext.length / 2));

	    if (!hm1 && !hm2) {
	      return null;
	    } else if (!hm2) {
	      hm = hm1;
	    } else if (!hm1) {
	      hm = hm2;
	    } else {
	      // Both matched.  Select the longest.
	      hm = hm1[4].length > hm2[4].length ? hm1 : hm2;
	    } // A half-match was found, sort out the return data.


	    if (text1.length > text2.length) {
	      text1A = hm[0];
	      text1B = hm[1];
	      text2A = hm[2];
	      text2B = hm[3];
	    } else {
	      text2A = hm[0];
	      text2B = hm[1];
	      text1A = hm[2];
	      text1B = hm[3];
	    }

	    midCommon = hm[4];
	    return [text1A, text1B, text2A, text2B, midCommon];
	  };
	  /**
	   * Do a quick line-level diff on both strings, then rediff the parts for
	   * greater accuracy.
	   * This speedup can produce non-minimal diffs.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} deadline Time when the diff should be complete by.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffLineMode = function (text1, text2, deadline) {
	    var a, diffs, linearray, pointer, countInsert, countDelete, textInsert, textDelete, j; // Scan the text on a line-by-line basis first.

	    a = this.diffLinesToChars(text1, text2);
	    text1 = a.chars1;
	    text2 = a.chars2;
	    linearray = a.lineArray;
	    diffs = this.DiffMain(text1, text2, false, deadline); // Convert the diff back to original text.

	    this.diffCharsToLines(diffs, linearray); // Eliminate freak matches (e.g. blank lines)

	    this.diffCleanupSemantic(diffs); // Rediff any replacement blocks, this time character-by-character.
	    // Add a dummy entry at the end.

	    diffs.push([DIFF_EQUAL, ""]);
	    pointer = 0;
	    countDelete = 0;
	    countInsert = 0;
	    textDelete = "";
	    textInsert = "";

	    while (pointer < diffs.length) {
	      switch (diffs[pointer][0]) {
	        case DIFF_INSERT:
	          countInsert++;
	          textInsert += diffs[pointer][1];
	          break;

	        case DIFF_DELETE:
	          countDelete++;
	          textDelete += diffs[pointer][1];
	          break;

	        case DIFF_EQUAL:
	          // Upon reaching an equality, check for prior redundancies.
	          if (countDelete >= 1 && countInsert >= 1) {
	            // Delete the offending records and add the merged ones.
	            diffs.splice(pointer - countDelete - countInsert, countDelete + countInsert);
	            pointer = pointer - countDelete - countInsert;
	            a = this.DiffMain(textDelete, textInsert, false, deadline);

	            for (j = a.length - 1; j >= 0; j--) {
	              diffs.splice(pointer, 0, a[j]);
	            }

	            pointer = pointer + a.length;
	          }

	          countInsert = 0;
	          countDelete = 0;
	          textDelete = "";
	          textInsert = "";
	          break;
	      }

	      pointer++;
	    }

	    diffs.pop(); // Remove the dummy entry at the end.

	    return diffs;
	  };
	  /**
	   * Find the 'middle snake' of a diff, split the problem in two
	   * and return the recursively constructed diff.
	   * See Myers 1986 paper: An O(ND) Difference Algorithm and Its Variations.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} deadline Time at which to bail if not yet complete.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffBisect = function (text1, text2, deadline) {
	    var text1Length, text2Length, maxD, vOffset, vLength, v1, v2, x, delta, front, k1start, k1end, k2start, k2end, k2Offset, k1Offset, x1, x2, y1, y2, d, k1, k2; // Cache the text lengths to prevent multiple calls.

	    text1Length = text1.length;
	    text2Length = text2.length;
	    maxD = Math.ceil((text1Length + text2Length) / 2);
	    vOffset = maxD;
	    vLength = 2 * maxD;
	    v1 = new Array(vLength);
	    v2 = new Array(vLength); // Setting all elements to -1 is faster in Chrome & Firefox than mixing
	    // integers and undefined.

	    for (x = 0; x < vLength; x++) {
	      v1[x] = -1;
	      v2[x] = -1;
	    }

	    v1[vOffset + 1] = 0;
	    v2[vOffset + 1] = 0;
	    delta = text1Length - text2Length; // If the total number of characters is odd, then the front path will collide
	    // with the reverse path.

	    front = delta % 2 !== 0; // Offsets for start and end of k loop.
	    // Prevents mapping of space beyond the grid.

	    k1start = 0;
	    k1end = 0;
	    k2start = 0;
	    k2end = 0;

	    for (d = 0; d < maxD; d++) {
	      // Bail out if deadline is reached.
	      if (new Date().getTime() > deadline) {
	        break;
	      } // Walk the front path one step.


	      for (k1 = -d + k1start; k1 <= d - k1end; k1 += 2) {
	        k1Offset = vOffset + k1;

	        if (k1 === -d || k1 !== d && v1[k1Offset - 1] < v1[k1Offset + 1]) {
	          x1 = v1[k1Offset + 1];
	        } else {
	          x1 = v1[k1Offset - 1] + 1;
	        }

	        y1 = x1 - k1;

	        while (x1 < text1Length && y1 < text2Length && text1.charAt(x1) === text2.charAt(y1)) {
	          x1++;
	          y1++;
	        }

	        v1[k1Offset] = x1;

	        if (x1 > text1Length) {
	          // Ran off the right of the graph.
	          k1end += 2;
	        } else if (y1 > text2Length) {
	          // Ran off the bottom of the graph.
	          k1start += 2;
	        } else if (front) {
	          k2Offset = vOffset + delta - k1;

	          if (k2Offset >= 0 && k2Offset < vLength && v2[k2Offset] !== -1) {
	            // Mirror x2 onto top-left coordinate system.
	            x2 = text1Length - v2[k2Offset];

	            if (x1 >= x2) {
	              // Overlap detected.
	              return this.diffBisectSplit(text1, text2, x1, y1, deadline);
	            }
	          }
	        }
	      } // Walk the reverse path one step.


	      for (k2 = -d + k2start; k2 <= d - k2end; k2 += 2) {
	        k2Offset = vOffset + k2;

	        if (k2 === -d || k2 !== d && v2[k2Offset - 1] < v2[k2Offset + 1]) {
	          x2 = v2[k2Offset + 1];
	        } else {
	          x2 = v2[k2Offset - 1] + 1;
	        }

	        y2 = x2 - k2;

	        while (x2 < text1Length && y2 < text2Length && text1.charAt(text1Length - x2 - 1) === text2.charAt(text2Length - y2 - 1)) {
	          x2++;
	          y2++;
	        }

	        v2[k2Offset] = x2;

	        if (x2 > text1Length) {
	          // Ran off the left of the graph.
	          k2end += 2;
	        } else if (y2 > text2Length) {
	          // Ran off the top of the graph.
	          k2start += 2;
	        } else if (!front) {
	          k1Offset = vOffset + delta - k2;

	          if (k1Offset >= 0 && k1Offset < vLength && v1[k1Offset] !== -1) {
	            x1 = v1[k1Offset];
	            y1 = vOffset + x1 - k1Offset; // Mirror x2 onto top-left coordinate system.

	            x2 = text1Length - x2;

	            if (x1 >= x2) {
	              // Overlap detected.
	              return this.diffBisectSplit(text1, text2, x1, y1, deadline);
	            }
	          }
	        }
	      }
	    } // Diff took too long and hit the deadline or
	    // number of diffs equals number of characters, no commonality at all.


	    return [[DIFF_DELETE, text1], [DIFF_INSERT, text2]];
	  };
	  /**
	   * Given the location of the 'middle snake', split the diff in two parts
	   * and recurse.
	   * @param {string} text1 Old string to be diffed.
	   * @param {string} text2 New string to be diffed.
	   * @param {number} x Index of split point in text1.
	   * @param {number} y Index of split point in text2.
	   * @param {number} deadline Time at which to bail if not yet complete.
	   * @return {!Array.<!DiffMatchPatch.Diff>} Array of diff tuples.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffBisectSplit = function (text1, text2, x, y, deadline) {
	    var text1a, text1b, text2a, text2b, diffs, diffsb;
	    text1a = text1.substring(0, x);
	    text2a = text2.substring(0, y);
	    text1b = text1.substring(x);
	    text2b = text2.substring(y); // Compute both diffs serially.

	    diffs = this.DiffMain(text1a, text2a, false, deadline);
	    diffsb = this.DiffMain(text1b, text2b, false, deadline);
	    return diffs.concat(diffsb);
	  };
	  /**
	   * Reduce the number of edits by eliminating semantically trivial equalities.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupSemantic = function (diffs) {
	    var changes, equalities, equalitiesLength, lastequality, pointer, lengthInsertions2, lengthDeletions2, lengthInsertions1, lengthDeletions1, deletion, insertion, overlapLength1, overlapLength2;
	    changes = false;
	    equalities = []; // Stack of indices where equalities are found.

	    equalitiesLength = 0; // Keeping our own length var is faster in JS.

	    /** @type {?string} */

	    lastequality = null; // Always equal to diffs[equalities[equalitiesLength - 1]][1]

	    pointer = 0; // Index of current position.
	    // Number of characters that changed prior to the equality.

	    lengthInsertions1 = 0;
	    lengthDeletions1 = 0; // Number of characters that changed after the equality.

	    lengthInsertions2 = 0;
	    lengthDeletions2 = 0;

	    while (pointer < diffs.length) {
	      if (diffs[pointer][0] === DIFF_EQUAL) {
	        // Equality found.
	        equalities[equalitiesLength++] = pointer;
	        lengthInsertions1 = lengthInsertions2;
	        lengthDeletions1 = lengthDeletions2;
	        lengthInsertions2 = 0;
	        lengthDeletions2 = 0;
	        lastequality = diffs[pointer][1];
	      } else {
	        // An insertion or deletion.
	        if (diffs[pointer][0] === DIFF_INSERT) {
	          lengthInsertions2 += diffs[pointer][1].length;
	        } else {
	          lengthDeletions2 += diffs[pointer][1].length;
	        } // Eliminate an equality that is smaller or equal to the edits on both
	        // sides of it.


	        if (lastequality && lastequality.length <= Math.max(lengthInsertions1, lengthDeletions1) && lastequality.length <= Math.max(lengthInsertions2, lengthDeletions2)) {
	          // Duplicate record.
	          diffs.splice(equalities[equalitiesLength - 1], 0, [DIFF_DELETE, lastequality]); // Change second copy to insert.

	          diffs[equalities[equalitiesLength - 1] + 1][0] = DIFF_INSERT; // Throw away the equality we just deleted.

	          equalitiesLength--; // Throw away the previous equality (it needs to be reevaluated).

	          equalitiesLength--;
	          pointer = equalitiesLength > 0 ? equalities[equalitiesLength - 1] : -1; // Reset the counters.

	          lengthInsertions1 = 0;
	          lengthDeletions1 = 0;
	          lengthInsertions2 = 0;
	          lengthDeletions2 = 0;
	          lastequality = null;
	          changes = true;
	        }
	      }

	      pointer++;
	    } // Normalize the diff.


	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    } // Find any overlaps between deletions and insertions.
	    // e.g: <del>abcxxx</del><ins>xxxdef</ins>
	    //   -> <del>abc</del>xxx<ins>def</ins>
	    // e.g: <del>xxxabc</del><ins>defxxx</ins>
	    //   -> <ins>def</ins>xxx<del>abc</del>
	    // Only extract an overlap if it is as big as the edit ahead or behind it.


	    pointer = 1;

	    while (pointer < diffs.length) {
	      if (diffs[pointer - 1][0] === DIFF_DELETE && diffs[pointer][0] === DIFF_INSERT) {
	        deletion = diffs[pointer - 1][1];
	        insertion = diffs[pointer][1];
	        overlapLength1 = this.diffCommonOverlap(deletion, insertion);
	        overlapLength2 = this.diffCommonOverlap(insertion, deletion);

	        if (overlapLength1 >= overlapLength2) {
	          if (overlapLength1 >= deletion.length / 2 || overlapLength1 >= insertion.length / 2) {
	            // Overlap found.  Insert an equality and trim the surrounding edits.
	            diffs.splice(pointer, 0, [DIFF_EQUAL, insertion.substring(0, overlapLength1)]);
	            diffs[pointer - 1][1] = deletion.substring(0, deletion.length - overlapLength1);
	            diffs[pointer + 1][1] = insertion.substring(overlapLength1);
	            pointer++;
	          }
	        } else {
	          if (overlapLength2 >= deletion.length / 2 || overlapLength2 >= insertion.length / 2) {
	            // Reverse overlap found.
	            // Insert an equality and swap and trim the surrounding edits.
	            diffs.splice(pointer, 0, [DIFF_EQUAL, deletion.substring(0, overlapLength2)]);
	            diffs[pointer - 1][0] = DIFF_INSERT;
	            diffs[pointer - 1][1] = insertion.substring(0, insertion.length - overlapLength2);
	            diffs[pointer + 1][0] = DIFF_DELETE;
	            diffs[pointer + 1][1] = deletion.substring(overlapLength2);
	            pointer++;
	          }
	        }

	        pointer++;
	      }

	      pointer++;
	    }
	  };
	  /**
	   * Determine if the suffix of one string is the prefix of another.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {number} The number of characters common to the end of the first
	   *     string and the start of the second string.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCommonOverlap = function (text1, text2) {
	    var text1Length, text2Length, textLength, best, length, pattern, found; // Cache the text lengths to prevent multiple calls.

	    text1Length = text1.length;
	    text2Length = text2.length; // Eliminate the null case.

	    if (text1Length === 0 || text2Length === 0) {
	      return 0;
	    } // Truncate the longer string.


	    if (text1Length > text2Length) {
	      text1 = text1.substring(text1Length - text2Length);
	    } else if (text1Length < text2Length) {
	      text2 = text2.substring(0, text1Length);
	    }

	    textLength = Math.min(text1Length, text2Length); // Quick check for the worst case.

	    if (text1 === text2) {
	      return textLength;
	    } // Start by looking for a single character match
	    // and increase length until no match is found.
	    // Performance analysis: https://neil.fraser.name/news/2010/11/04/


	    best = 0;
	    length = 1;

	    while (true) {
	      pattern = text1.substring(textLength - length);
	      found = text2.indexOf(pattern);

	      if (found === -1) {
	        return best;
	      }

	      length += found;

	      if (found === 0 || text1.substring(textLength - length) === text2.substring(0, length)) {
	        best = length;
	        length++;
	      }
	    }
	  };
	  /**
	   * Split two texts into an array of strings.  Reduce the texts to a string of
	   * hashes where each Unicode character represents one line.
	   * @param {string} text1 First string.
	   * @param {string} text2 Second string.
	   * @return {{chars1: string, chars2: string, lineArray: !Array.<string>}}
	   *     An object containing the encoded text1, the encoded text2 and
	   *     the array of unique strings.
	   *     The zeroth element of the array of unique strings is intentionally blank.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffLinesToChars = function (text1, text2) {
	    var lineArray, lineHash, chars1, chars2;
	    lineArray = []; // E.g. lineArray[4] === 'Hello\n'

	    lineHash = {}; // E.g. lineHash['Hello\n'] === 4
	    // '\x00' is a valid character, but various debuggers don't like it.
	    // So we'll insert a junk entry to avoid generating a null character.

	    lineArray[0] = "";
	    /**
	     * Split a text into an array of strings.  Reduce the texts to a string of
	     * hashes where each Unicode character represents one line.
	     * Modifies linearray and linehash through being a closure.
	     * @param {string} text String to encode.
	     * @return {string} Encoded string.
	     * @private
	     */

	    function diffLinesToCharsMunge(text) {
	      var chars, lineStart, lineEnd, lineArrayLength, line;
	      chars = ""; // Walk the text, pulling out a substring for each line.
	      // text.split('\n') would would temporarily double our memory footprint.
	      // Modifying text would create many large strings to garbage collect.

	      lineStart = 0;
	      lineEnd = -1; // Keeping our own length variable is faster than looking it up.

	      lineArrayLength = lineArray.length;

	      while (lineEnd < text.length - 1) {
	        lineEnd = text.indexOf("\n", lineStart);

	        if (lineEnd === -1) {
	          lineEnd = text.length - 1;
	        }

	        line = text.substring(lineStart, lineEnd + 1);
	        lineStart = lineEnd + 1;

	        if (hasOwn.call(lineHash, line)) {
	          chars += String.fromCharCode(lineHash[line]);
	        } else {
	          chars += String.fromCharCode(lineArrayLength);
	          lineHash[line] = lineArrayLength;
	          lineArray[lineArrayLength++] = line;
	        }
	      }

	      return chars;
	    }

	    chars1 = diffLinesToCharsMunge(text1);
	    chars2 = diffLinesToCharsMunge(text2);
	    return {
	      chars1: chars1,
	      chars2: chars2,
	      lineArray: lineArray
	    };
	  };
	  /**
	   * Rehydrate the text in a diff from a string of line hashes to real lines of
	   * text.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   * @param {!Array.<string>} lineArray Array of unique strings.
	   * @private
	   */


	  DiffMatchPatch.prototype.diffCharsToLines = function (diffs, lineArray) {
	    var x, chars, text, y;

	    for (x = 0; x < diffs.length; x++) {
	      chars = diffs[x][1];
	      text = [];

	      for (y = 0; y < chars.length; y++) {
	        text[y] = lineArray[chars.charCodeAt(y)];
	      }

	      diffs[x][1] = text.join("");
	    }
	  };
	  /**
	   * Reorder and merge like edit sections.  Merge equalities.
	   * Any edit section can move as long as it doesn't cross an equality.
	   * @param {!Array.<!DiffMatchPatch.Diff>} diffs Array of diff tuples.
	   */


	  DiffMatchPatch.prototype.diffCleanupMerge = function (diffs) {
	    var pointer, countDelete, countInsert, textInsert, textDelete, commonlength, changes, diffPointer, position;
	    diffs.push([DIFF_EQUAL, ""]); // Add a dummy entry at the end.

	    pointer = 0;
	    countDelete = 0;
	    countInsert = 0;
	    textDelete = "";
	    textInsert = "";

	    while (pointer < diffs.length) {
	      switch (diffs[pointer][0]) {
	        case DIFF_INSERT:
	          countInsert++;
	          textInsert += diffs[pointer][1];
	          pointer++;
	          break;

	        case DIFF_DELETE:
	          countDelete++;
	          textDelete += diffs[pointer][1];
	          pointer++;
	          break;

	        case DIFF_EQUAL:
	          // Upon reaching an equality, check for prior redundancies.
	          if (countDelete + countInsert > 1) {
	            if (countDelete !== 0 && countInsert !== 0) {
	              // Factor out any common prefixes.
	              commonlength = this.diffCommonPrefix(textInsert, textDelete);

	              if (commonlength !== 0) {
	                if (pointer - countDelete - countInsert > 0 && diffs[pointer - countDelete - countInsert - 1][0] === DIFF_EQUAL) {
	                  diffs[pointer - countDelete - countInsert - 1][1] += textInsert.substring(0, commonlength);
	                } else {
	                  diffs.splice(0, 0, [DIFF_EQUAL, textInsert.substring(0, commonlength)]);
	                  pointer++;
	                }

	                textInsert = textInsert.substring(commonlength);
	                textDelete = textDelete.substring(commonlength);
	              } // Factor out any common suffixies.


	              commonlength = this.diffCommonSuffix(textInsert, textDelete);

	              if (commonlength !== 0) {
	                diffs[pointer][1] = textInsert.substring(textInsert.length - commonlength) + diffs[pointer][1];
	                textInsert = textInsert.substring(0, textInsert.length - commonlength);
	                textDelete = textDelete.substring(0, textDelete.length - commonlength);
	              }
	            } // Delete the offending records and add the merged ones.


	            if (countDelete === 0) {
	              diffs.splice(pointer - countInsert, countDelete + countInsert, [DIFF_INSERT, textInsert]);
	            } else if (countInsert === 0) {
	              diffs.splice(pointer - countDelete, countDelete + countInsert, [DIFF_DELETE, textDelete]);
	            } else {
	              diffs.splice(pointer - countDelete - countInsert, countDelete + countInsert, [DIFF_DELETE, textDelete], [DIFF_INSERT, textInsert]);
	            }

	            pointer = pointer - countDelete - countInsert + (countDelete ? 1 : 0) + (countInsert ? 1 : 0) + 1;
	          } else if (pointer !== 0 && diffs[pointer - 1][0] === DIFF_EQUAL) {
	            // Merge this equality with the previous one.
	            diffs[pointer - 1][1] += diffs[pointer][1];
	            diffs.splice(pointer, 1);
	          } else {
	            pointer++;
	          }

	          countInsert = 0;
	          countDelete = 0;
	          textDelete = "";
	          textInsert = "";
	          break;
	      }
	    }

	    if (diffs[diffs.length - 1][1] === "") {
	      diffs.pop(); // Remove the dummy entry at the end.
	    } // Second pass: look for single edits surrounded on both sides by equalities
	    // which can be shifted sideways to eliminate an equality.
	    // e.g: A<ins>BA</ins>C -> <ins>AB</ins>AC


	    changes = false;
	    pointer = 1; // Intentionally ignore the first and last element (don't need checking).

	    while (pointer < diffs.length - 1) {
	      if (diffs[pointer - 1][0] === DIFF_EQUAL && diffs[pointer + 1][0] === DIFF_EQUAL) {
	        diffPointer = diffs[pointer][1];
	        position = diffPointer.substring(diffPointer.length - diffs[pointer - 1][1].length); // This is a single edit surrounded by equalities.

	        if (position === diffs[pointer - 1][1]) {
	          // Shift the edit over the previous equality.
	          diffs[pointer][1] = diffs[pointer - 1][1] + diffs[pointer][1].substring(0, diffs[pointer][1].length - diffs[pointer - 1][1].length);
	          diffs[pointer + 1][1] = diffs[pointer - 1][1] + diffs[pointer + 1][1];
	          diffs.splice(pointer - 1, 1);
	          changes = true;
	        } else if (diffPointer.substring(0, diffs[pointer + 1][1].length) === diffs[pointer + 1][1]) {
	          // Shift the edit over the next equality.
	          diffs[pointer - 1][1] += diffs[pointer + 1][1];
	          diffs[pointer][1] = diffs[pointer][1].substring(diffs[pointer + 1][1].length) + diffs[pointer + 1][1];
	          diffs.splice(pointer + 1, 1);
	          changes = true;
	        }
	      }

	      pointer++;
	    } // If shifts were made, the diff needs reordering and another shift sweep.


	    if (changes) {
	      this.diffCleanupMerge(diffs);
	    }
	  };

	  return function (o, n) {
	    var diff, output, text;
	    diff = new DiffMatchPatch();
	    output = diff.DiffMain(o, n);
	    diff.diffCleanupEfficiency(output);
	    text = diff.diffPrettyHtml(output);
	    return text;
	  };
	}();

}((function() { return this; }())));

}).call(this)}).call(this,require('_process'),typeof global !== "undefined" ? global : typeof self !== "undefined" ? self : typeof window !== "undefined" ? window : {},require("timers").setImmediate)

},{"_process":5,"timers":7}],7:[function(require,module,exports){
(function (setImmediate,clearImmediate){(function (){
var nextTick = require('process/browser.js').nextTick;
var apply = Function.prototype.apply;
var slice = Array.prototype.slice;
var immediateIds = {};
var nextImmediateId = 0;

// DOM APIs, for completeness

exports.setTimeout = function() {
  return new Timeout(apply.call(setTimeout, window, arguments), clearTimeout);
};
exports.setInterval = function() {
  return new Timeout(apply.call(setInterval, window, arguments), clearInterval);
};
exports.clearTimeout =
exports.clearInterval = function(timeout) { timeout.close(); };

function Timeout(id, clearFn) {
  this._id = id;
  this._clearFn = clearFn;
}
Timeout.prototype.unref = Timeout.prototype.ref = function() {};
Timeout.prototype.close = function() {
  this._clearFn.call(window, this._id);
};

// Does not start the time, just sets up the members needed.
exports.enroll = function(item, msecs) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = msecs;
};

exports.unenroll = function(item) {
  clearTimeout(item._idleTimeoutId);
  item._idleTimeout = -1;
};

exports._unrefActive = exports.active = function(item) {
  clearTimeout(item._idleTimeoutId);

  var msecs = item._idleTimeout;
  if (msecs >= 0) {
    item._idleTimeoutId = setTimeout(function onTimeout() {
      if (item._onTimeout)
        item._onTimeout();
    }, msecs);
  }
};

// That's not how node.js implements it but the exposed api is the same.
exports.setImmediate = typeof setImmediate === "function" ? setImmediate : function(fn) {
  var id = nextImmediateId++;
  var args = arguments.length < 2 ? false : slice.call(arguments, 1);

  immediateIds[id] = true;

  nextTick(function onNextTick() {
    if (immediateIds[id]) {
      // fn.call() is faster so we optimize for the common use-case
      // @see http://jsperf.com/call-apply-segu
      if (args) {
        fn.apply(null, args);
      } else {
        fn.call(null);
      }
      // Prevent ids from leaking
      exports.clearImmediate(id);
    }
  });

  return id;
};

exports.clearImmediate = typeof clearImmediate === "function" ? clearImmediate : function(id) {
  delete immediateIds[id];
};
}).call(this)}).call(this,require("timers").setImmediate,require("timers").clearImmediate)

},{"process/browser.js":5,"timers":7}],8:[function(require,module,exports){
/*
    I18NDomain class
*/
"use strict";

var context = require( '../../context.js' );

var I18NDomain = function( stringToApply ) {
    
    var string = stringToApply;
    
    var putToAutoDefineHelper = function( scope, autoDefineHelper ){
        
        var newString = string;
        var conf = context.getConf();
        
        // Add the domains defined previously
        var previousValue = scope.get( conf.i18nDomainVarName );
        if ( previousValue ) {
            newString += conf.inDefineDelimiter + conf.i18nDomainVarName;
        }
        
        // Add brackets if not present
        if ( newString[ 0 ] !== '[' ){
            newString = '[' + newString + ']';
        }
        
        // Add i18nDomainVarName to the autoDefineHelper
        autoDefineHelper.put(
            conf.i18nDomainVarName,
            newString
        );
    };

    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: I18NDomain.id
    };
};

I18NDomain.id = 'i18n:domain';

I18NDomain.build = function( string ) {
    return string? new I18NDomain( string.trim() ): null;
};

module.exports = I18NDomain;

},{"../../context.js":27}],9:[function(require,module,exports){
/*
    I18nLanguage class
*/
"use strict";

var context = require( '../../context.js' );

var I18NLanguage = function( stringToApply ) {
    
    var string = stringToApply;
    
    var putToAutoDefineHelper = function( autoDefineHelper ){

        // Add i18nLanguageVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().i18nLanguageVarName,
            string
        );
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "I18NLanguage: " + string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: I18NLanguage.id
    };
};

I18NLanguage.id = 'i18n:language';

I18NLanguage.build = function( string ) {
    return string? new I18NLanguage( string.trim() ): null;
};

module.exports = I18NLanguage;

},{"../../context.js":27}],10:[function(require,module,exports){
/*
    METALDefineMacro class
*/
"use strict";

var METALDefineMacro = function( nameToApply ) {
    
    var name = nameToApply;
    
    var process = function( scope, node ){
        
        // Hide macro definitions
        node.style.display = 'none';

        return false;
    };

    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return "METALDefineMacro: " + name;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        toString: toString,
        type: METALDefineMacro.id
    };
};

METALDefineMacro.id = 'metal:define-macro';

METALDefineMacro.build = function( string ) {
    return new METALDefineMacro( string.trim() );
};

module.exports = METALDefineMacro;

},{}],11:[function(require,module,exports){
/*
    METALFillSlot class
*/
"use strict";

var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var METALFillSlot = function( _string, _expression, _useMacroNode ) {
    
    var string = _string;
    var expression = _expression;
    var useMacroNode = _useMacroNode;
    
    var process = function(){
        // Nothing to do
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater ){
        parserUpdater.updateNode( useMacroNode );
    };
    
    var toString = function(){
        return "METALFillSlot: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: METALFillSlot.id
    };
};

METALFillSlot.id = 'metal:fill-slot';

METALFillSlot.build = function( string, useMacroNode ) {
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new METALFillSlot( 
            string,
            expressionBuilder.build( string ),
            useMacroNode
    );
};

module.exports = METALFillSlot;

},{"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48}],12:[function(require,module,exports){
/*
    METALUseMacro class
*/
"use strict";

var context = require( '../../context.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var attributeIndex = require( '../attributeIndex.js' );
var attributeCache = require( '../../cache/attributeCache.js' );
var TALDefine = require( '../TAL/talDefine.js' );
var METALFillSlot = require( './metalFillSlot.js' );
var resolver = require( '../../resolver.js' );

var METALUseMacro = function( stringToApply, macroExpressionToApply, defineToApply ) {
    
    var string = stringToApply;
    var macroExpression = macroExpressionToApply;
    var define = defineToApply;
    
    var process = function( scope, node, autoDefineHelper, indexExpressions ){

        // Init some vars
        var macroKey = resolver.getMacroKey( macroExpression, scope );
        var tags = context.getTags();
        var newNode = resolver.getNode( macroKey, scope ); 
        
        // Hide use macro node
        node.style.display = 'none';

        // Remove style attribute to force showing the new node
        newNode.removeAttribute( 'style' );

        // Update define and autoDefine attributes of the new node
        updateNewNodeAttributes( macroKey, newNode, autoDefineHelper, tags, node, indexExpressions );
        
        // Fill slots
        fillSlots( scope, node, tags, newNode, indexExpressions );

        // Add the macro node
        node.parentNode.insertBefore( newNode, node.nextSibling );
        
        return newNode;
    };
    
    var updateNewNodeAttributes = function( macroKey, newNode, autoDefineHelper, tags, node, indexExpressions ){

        // Update the talDefine attribute
        TALDefine.updateAttribute( newNode, define );
        
        // Update the talAutoDefine attribute
        var macroData = resolver.getMacroData( macroKey );
        if ( macroData.url ){
            autoDefineHelper.put( 
                context.getConf().externalMacroUrlVarName, 
                "'" + macroData.url + "'"
            );
            autoDefineHelper.updateNode( newNode );
        }
        
        // Set related id attribute if needed
        if ( indexExpressions ){
            newNode.setAttribute( 
                tags.relatedId, 
                node.getAttribute( tags.id ) 
            );
        }
    };
    
    var fillSlots = function( scope, node, tags, newNode, indexExpressions ){
        
        var list = node.querySelectorAll( 
            "[" + resolver.filterSelector( tags.metalFillSlot ) + "]"
        );
        var element;
        var pos = 0;
        while ( element = list[ pos++ ] ) {
            var slotIdExpressionString = element.getAttribute( tags.metalFillSlot );
            var slotIdExpression = expressionBuilder.build( slotIdExpressionString );
            var slotId = slotIdExpression.evaluate( scope );

            // Index fill slot element
            if ( indexExpressions ){
                var metalFillSlot = attributeCache.getByAttributeClass( 
                    METALFillSlot, 
                    slotIdExpressionString, 
                    element,
                    indexExpressions,
                    scope,
                    function(){
                        return METALFillSlot.build( slotIdExpressionString, node );
                    }
                );
                attributeIndex.add( element, metalFillSlot, scope );   
            }

            // Do nothing if slotIdExpression evaluates to false
            if ( ! slotId ){
                return;
            }

            var slotContent = element.cloneNode( true );
            var currentNode = newNode.querySelector( 
                "[" + resolver.filterSelector( tags.metalDefineSlot ) + "='" + slotId + "']"
            );
            if ( ! currentNode ){
                throw 'Slot "' + slotId + '" in expression "' + slotIdExpressionString +'" not found!';
            }
            currentNode.parentNode.insertBefore( 
                slotContent, 
                currentNode.nextSibling
            );
            slotContent.removeAttribute( tags.metalFillSlot );
            slotContent.setAttribute( tags.id, context.nextExpressionCounter() ); // Set a new id attribute to avoid id conflicts
            currentNode.remove();
        }
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, macroExpression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node );
    };
    
    var toString = function(){
        return "METALUseMacro: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: METALUseMacro.id
    };
};

METALUseMacro.id = 'metal:use-macro';

METALUseMacro.build = function( string, stringDefine ) {
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new METALUseMacro( 
            string,
            expressionBuilder.build( string.trim() ),
            stringDefine? stringDefine.trim(): undefined
    );
};

module.exports = METALUseMacro;

},{"../../cache/attributeCache.js":24,"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../resolver.js":97,"../TAL/talDefine.js":18,"../attributeIndex.js":23,"./metalFillSlot.js":11}],13:[function(require,module,exports){
/* 
    contentHelper singleton class
*/
"use strict";

var context = require( '../../context.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var evaluateHelper = require( '../../expressions/evaluateHelper.js' );

module.exports = (function() {

    var formInputHasBody = {
        BUTTON: 1,
        LABEL: 1,
        LEGEND: 1,
        FIELDSET: 1,
        OPTION: 1
    };
    
    var build = function( tag, string, constructorFunction ) {

        // Process it
        var content = string.trim();

        // Check if is an HTML expression
        var structure = content.indexOf( context.getConf().htmlStructureExpressionPrefix + ' ' ) === 0;
        var expressionString = structure? 
            content.substr( 1 + context.getConf().htmlStructureExpressionPrefix.length ): 
            content;
        if ( ! expressionString ){
            throw tag + ' expression void.';
        }
        
        return constructorFunction(
            string,
            expressionBuilder.build( expressionString ),
            structure,
            expressionString
        );
    };
    
    var updateNode = function( node, structure, evaluated ){

        // Check default
        if ( evaluateHelper.isDefault( evaluated ) ){
            return true;
        }

        // Check nothing
        if ( evaluateHelper.isNothing( evaluated ) ){
            evaluated = "";
        }

        // Add it to node
        node.innerHTML = evaluated;
        if ( ! structure ) {
            node[ "form" in node && !formInputHasBody[ node.tagName ] ? "value": "innerText" ] = evaluated;
        }

        return true;
    };
    
    return {
        build: build,
        updateNode: updateNode
    };
})();

},{"../../context.js":27,"../../expressions/evaluateHelper.js":44,"../../expressions/expressionBuilder.js":46}],14:[function(require,module,exports){
/*
    TALAttributes class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var utils = require( '../../utils.js' );

var TALAttributes = function( stringToApply, attributeItemsToApply ) {
    
    var string = stringToApply;
    var attributeItems = attributeItemsToApply;
    
    var process = function( scope, node, attributeName ){
        
        for ( var i = 0; i < attributeItems.length; i++ ) {
            var attributeItem = attributeItems[ i ];
            var name = attributeItem.name;
            
            if ( ! attributeName || name === attributeName ){
                var value = attributeItem.expression.evaluate( scope );

                if ( name ){
                    processSimpleAttributeItem( node, name, value );
                } else {
                    processMapAttributeItem( node, value );
                }
            }
        }
    };

    var processMapAttributeItem = function( node, map ){
    
        // Do nothing if map is null
        if ( ! map ){
            return;
        }
        
        if ( ! utils.isPlainObject( map ) ){
            throw 'Invalid attribute value: "' + map + '". Object expected.';
        }
        
        for ( var name in map ){
            var value = map[ name ];
            processSimpleAttributeItem( node, name, value );
        }
    };
    
    var processSimpleAttributeItem = function( node, name, value ){
        
        // Boolean attributes
        if ( context.isBooleanAttribute( name ) ){
            if ( value ){
                node.setAttribute( name, '' );
            } else {
                node.removeAttribute( name );
            }
            return;
        }
        
        // If value is undefined don't parser the attribute
        if ( value == undefined ) {
            return;
        }
            
        // Alt attributes
        if ( context.isAltAttribute( name ) ) {
            switch ( name ) {
            case "innerHTML":
                throw node; // should use "qtext"
            case "style":
                node.style.cssText = value;
                break;
            /*
            case "text":
                node[ querySelectorAll ? name : innerText ] = value;
                break; // option.text unstable in IE
            */
            case "class":
                name = "className";
            default:
                node[ name ] = value;
            }
            return;
        } 

        // Regular attributes
        node.setAttribute( name, value );
    };

    var dependsOn = function( scope ){

        var result = [];
        var object = {};
        
        for ( var i = 0; i < attributeItems.length; i++ ) {
            var attributeItem = attributeItems[ i ];
            var dependsOnList = expressionsUtils.buildDependsOnList( undefined, scope, attributeItem.expression );
            if ( dependsOnList && dependsOnList.length > 0 ){
                object[ attributeItem.name ] = dependsOnList;
            }
        }
        
        if ( Object.keys( object ).length > 0 ){
            result.push( object );
        }
        
        return result;
    };
    
    var update = function( parserUpdater, node, scope, indexItem ){
        process( scope, node, indexItem.groupId );
    };
    
    var toString = function(){
        return "TALAttributes: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALAttributes.id
    };
};

TALAttributes.id = 'tal:attributes';

TALAttributes.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    var attributeItems = [];
    var expressionString = string.trim();
    var tokens = new ExpressionTokenizer( 
            expressionString, 
            context.getConf().attributeDelimiter, 
            true );

    while ( tokens.hasMoreTokens() ) {
        var attribute = tokens.nextToken().trim();
        var space = attribute.indexOf( context.getConf().inAttributeDelimiter );
        if ( space === -1 ) {
            attributeItems.push({
                name: undefined,
                expression: expressionBuilder.build( attribute )
            });
        }
        var name = attribute.substring( 0, space );
        var valueExpression = attribute.substring( space + 1 ).trim();

        attributeItems.push({
            name: name,
            expression: expressionBuilder.build( valueExpression )
        });
    }
    
    return new TALAttributes( string, attributeItems );
};

module.exports = TALAttributes;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47,"../../expressions/expressionsUtils.js":48,"../../utils.js":101}],15:[function(require,module,exports){
/*
    TALCondition class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var context = require( '../../context.js' );

var TALCondition = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var process = function( scope, node ){
        
        var result = evaluateHelper.evaluateBoolean( scope, expression );
        
        node.setAttribute( context.getTags().conditionResult, result );
        node.style.display = result ? '' : 'none';
        
        return result;
    };

    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node, true );
    };
    
    var updatableFromAction = function( parserUpdater, node ){
        
        var scope = parserUpdater.getNodeScope( node );
        var result = evaluateHelper.evaluateBoolean( scope, expression );
        var valueFromTag = 'true' === node.getAttribute( context.getTags().conditionResult );
        
        return result !== valueFromTag;
    };
    
    var toString = function(){
        return "TALCondition: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        updatableFromAction: updatableFromAction,
        toString: toString,
        type: TALCondition.id
    };
};

TALCondition.id = 'tal:condition';

TALCondition.build = function( string ) {
    
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    return new TALCondition( 
                string,
                expressionBuilder.build( string ) );
};

module.exports = TALCondition;

},{"../../context.js":27,"../../expressions/evaluateHelper.js":44,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48}],16:[function(require,module,exports){
/*
    TALContent class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var contentHelper = require( './contentHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALContent = function( stringToApply, expressionToApply, structureToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var structure = structureToApply;
    
    var process = function( scope, node ){
        
        return contentHelper.updateNode( 
            node, 
            structure, 
            evaluateHelper.evaluateToNotNull( scope, expression ) 
        );
    };

    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node, scope ){
        process( scope, node );
    };
    
    var toString = function(){
        return "TALContent: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALContent.id
    };
};

TALContent.id = 'tal:content';

TALContent.build = function( string ) {
    
    return contentHelper.build( 
        'TALContent',
        string,
        function( _string, _expression, _structure ){
            return new TALContent( _string, _expression, _structure );
        }
    );
};

module.exports = TALContent;

},{"../../expressions/evaluateHelper.js":44,"../../expressions/expressionsUtils.js":48,"./contentHelper.js":13}],17:[function(require,module,exports){
/*
    TALDeclare class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALDeclare = function( _string, _declareItems ) {
    
    var string = _string;
    var declareItems = _declareItems;
    
    var process = function( scope, autoDefineHelper ){

        putVariables( scope, autoDefineHelper );

        return processDeclareItems( scope );
    };
    
    var putVariables = function( scope, autoDefineHelper ) {
        
        // Add strictModeVarName to the autoDefineHelper if needed
        var strictModeVarName = context.getConf().strictModeVarName;
        if ( true !== scope.get( strictModeVarName ) ){
            autoDefineHelper.put( strictModeVarName, 'true' );
        }
        
        // Build declared and required
        var declaredVarsVarName = context.getConf().declaredVarsVarName;
        var declared = scope.get( declaredVarsVarName ) || [];
        for ( var i = 0; i < declareItems.length; i++ ) {
            var declareItem = declareItems[ i ];
            declared.push( declareItem.name );
        }
        
        // Add declaredVarsVarName to the autoDefineHelper
        autoDefineHelper.put( 
            declaredVarsVarName, 
            expressionsUtils.buildList( declared, true )
        );
    };
    
    var processDeclareItems = function( scope ) {
        
        var errorsArray = [];

        for ( var i = 0; i < declareItems.length; i++ ) {
            var declareItem = declareItems[ i ];
            var errors = checkDeclareItem(
                scope,
                declareItem.name,
                declareItem.type,
                declareItem.required,
                declareItem.defaultValueString,
                declareItem.defaultValueExpression
            );
            errorsArray = errorsArray.concat( errors );
        }

        processErrorsArray( errorsArray );

        return errorsArray.length === 0;
    };

    var checkDeclareItem = function( scope, name, type, required, defaultValueString, defaultValueExpression ) {
        
        var errorsArray = [];
        
        var value = scope.get( name );
        
        // Set default value if needed
        if ( value === undefined && defaultValueExpression !== undefined ){
            var setDefaultValueError = setDefaultValue( scope, name, type, defaultValueString, defaultValueExpression );
            if ( setDefaultValueError ){
                errorsArray.push( setDefaultValueError );
                return errorsArray;
            }
            value = scope.get( name );
        }
        
        // Check type
        var typeCheckError = checkType( name, type, value );
        if ( typeCheckError ){
            errorsArray.push( typeCheckError );
        }
        
        // Check required
        var requiredCheckError = checkRequired( name, required, value );
        if ( requiredCheckError ){
            errorsArray.push( requiredCheckError );
        }
        
        return errorsArray;
    };
    
    var checkType = function( name, expectedType, value ) {
        
        if ( ! expectedType ){
            return;
        }
        
        var realType = getTypeOf( value );
        return realType === expectedType.toLowerCase()? 
            false: 
            'Expected value type (' + expectedType.toLowerCase() + ') of ' + name + ' property does not match type (' + realType + '), value is "' + value + '".';
    };
    
    /*
        typeOf();                   // undefined
        typeOf(null);               // null
        typeOf(NaN);                // number
        typeOf(5);                  // number
        typeOf([]);                 // array
        typeOf('');                 // string
        typeOf(function () {});     // function
        typeOf(/a/)                 // regexp
        typeOf(new Date())          // date
        typeOf(new Error)           // error
        typeOf(Promise.resolve())   // promise
        typeOf(function *() {})     // generatorfunction
        typeOf(new WeakMap())       // weakmap
        typeOf(new Map())           // map
        typeOf({});                 // object
        typeOf(new MyConstructor()) // MyConstructor
    */
    var getTypeOf = function( value ){
        
        var temp = {}.toString.call( value ).split(' ')[ 1 ].slice( 0, -1 ).toLowerCase();
        return temp === 'object'? 
            value.constructor.name.toLowerCase(): 
            temp;
    };
    
    var checkRequired = function( name, required, value ) {
        
        return true === required && value === undefined? 
            'Required value must not be undefined: ' + name:
            false;
    };
    
    var setDefaultValue = function( scope, name, type, defaultValueString, defaultValueExpression ) {
        
        try {
            var defaultValue = defaultValueExpression.evaluate( scope );
            scope.set( name, defaultValue );
            return false;
            
        } catch ( e ) {
            return 'Error trying to evaluate default value of field ' + name + ', expression [' + defaultValueString + ']: ' + e;
        }
    };
    
    var processErrorsArray = function( errorsArray ) {

        if ( errorsArray.length === 0 ){
            return;
        }
        
        throw errorsArray;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALDeclare: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALDeclare.id
    };
};

TALDeclare.id = 'tal:declare';

TALDeclare.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );

    var declareItems = [];
    var omitTypes = [ 'undefined', 'null' ];
    
    var tokens = new ExpressionTokenizer( 
        string.trim(), 
        context.getConf().declareDelimiter, 
        true 
    );

    while ( tokens.hasMoreTokens() ) {
        
        var inPropTokens = new ExpressionTokenizer( 
            tokens.nextToken().trim(), 
            context.getConf().inDeclareDelimiter, 
            true 
        );
        
        var name = undefined;
        var type = undefined;
        var defaultValueString = undefined;
        var required = false;
        var state = 1;
        while ( inPropTokens.hasMoreTokens() ){
            var currentToken = inPropTokens.nextToken();
            if ( TALDeclare.tokenIsRequired( currentToken ) ){
                required = true;
                continue;
            }
            switch ( state ) {
                case 1:
                    name = currentToken;
                    break;
                case 2:
                    if ( -1 === omitTypes.indexOf( currentToken.toLowerCase() ) ){
                        type = currentToken;   
                    }
                    break;
                case 3:
                    defaultValueString = currentToken;
                    break;
                default:
                    throw 'Too many arguments in talDeclare item: ' + string.trim();
            }
            ++state;
        }
        
        // The name is the only required element
        if ( ! name ){
            continue;
        }
        
        declareItems.push({
            name: name,
            type: type,
            required: required,
            defaultValueString: defaultValueString,
            defaultValueExpression: defaultValueString == undefined? undefined: expressionBuilder.build( defaultValueString )
        });
    }

    return new TALDeclare( string, declareItems );
};

TALDeclare.tokenIsRequired = function( token ) {
    return "required" === token.toLowerCase();
};

module.exports = TALDeclare;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47,"../../expressions/expressionsUtils.js":48}],18:[function(require,module,exports){
/*
    TALDefine class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../../expressions/expressionTokenizer.js' );

var TALDefine = function( stringToApply, defineItemsToApply ) {
    
    var string = stringToApply;
    var defineItems = defineItemsToApply;
    
    var process = function( scope, forceGlobal ){
        
        // Update scope
        for ( var i = 0; i < defineItems.length; i++ ) {
            var defineItem = defineItems[ i ];
            scope.set( 
                    defineItem.name, 
                    defineItem.nocall? defineItem.expression: defineItem.expression.evaluate( scope ), 
                    forceGlobal || defineItem.global,
                    defineItem.nocall,
                    defineItem.expression
            );
        }
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALDefine: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALDefine.id
    };
};

TALDefine.id = 'tal:define';

TALDefine.build = function( string ) {

    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );

    var defineItems = [];
    var expressionString = string.trim();
    var tokens = new ExpressionTokenizer( 
        expressionString, 
        context.getConf().defineDelimiter, 
        true );

    while ( tokens.hasMoreTokens() ) {
        var variable = tokens.nextToken().trim();
        var space = variable.indexOf( context.getConf().inDefineDelimiter );
        if ( space === -1 ) {
            throw 'Bad variable definition: ' + variable;
        }

        var nocall = false;
        var global = false;
        var currentToken = variable.substring( 0, space );
        var nextTokens = variable.substring( space + 1 ).trim();
        var tokenDone = false;
        do {
            var specialToken = false;
            if ( context.getConf().globalVariableExpressionPrefix === currentToken ){
                global = true;
                specialToken = true;
            } else if ( context.getConf().nocallVariableExpressionPrefix === currentToken ){
                nocall = true;  
                specialToken = true;
            } 
            
            if ( specialToken ){
                space = nextTokens.indexOf( context.getConf().inDefineDelimiter );
                currentToken = nextTokens.substring( 0, space );
                nextTokens = nextTokens.substring( space + 1 ).trim();
                
            } else {
                defineItems.push({
                    name: currentToken,
                    expression: expressionBuilder.build( nextTokens ),
                    global: global,
                    nocall: nocall
                });
                tokenDone = true;
            }

        } while( ! tokenDone && space !== -1 );
    }

    return new TALDefine( string, defineItems );
};


TALDefine.appendStrings = function() {
    
    var result = arguments[ 0 ];
    
    for ( var c = 1; c < arguments.length; ++c ){
        var string = arguments[ c ];
        if ( string ){
            result = result? result + context.getConf().defineDelimiter + string: string;
        }
    }
    
    return result;
};

TALDefine.updateAttribute = function( node, defineToAdd ){

    var tags = context.getTags();
    var nodeDefine = node.getAttribute( tags.talDefine );
    var fullDefine = TALDefine.appendStrings( defineToAdd, nodeDefine );

    if ( fullDefine ){
        node.setAttribute( tags.talDefine, fullDefine );
    }
};

module.exports = TALDefine;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionTokenizer.js":47}],19:[function(require,module,exports){
/*
    TALOmitTag class
*/
"use strict";

var BooleanLiteral = require( '../../expressions/path/literals/booleanLiteral.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var context = require( '../../context.js' );

var TALOmitTag = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var process = function( scope, node, parserNodeRenderer ){
        
        var result = expression.evaluate( scope );
        if ( ! result ){
            return false;
        }
        
        // Process the contents
        parserNodeRenderer.defaultContent( node );
        
        // Move children from current node to its parent and then remove it
        var tags = context.getTags();
        var parentNode = node.parentNode;
        while ( node.firstChild ) {
            if ( node.firstChild.nodeType === 1 ){
                node.firstChild.setAttribute( tags.qdup, 1 );
            }
            parentNode.appendChild( node.firstChild );
        }
        parentNode.removeChild( node );

        return true;
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALOmitTag: " + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALOmitTag.id
    };
};

TALOmitTag.id = 'tal:omit-tag';

TALOmitTag.build = function( string ) {
    
    var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
    
    var expressionString = string.trim();
    var expression = expressionString == ''?
            new BooleanLiteral( true ):
            expressionBuilder.build( expressionString );
    
    return new TALOmitTag( string, expression );
};

module.exports = TALOmitTag;

},{"../../context.js":27,"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../expressions/path/literals/booleanLiteral.js":59}],20:[function(require,module,exports){
/*
    TALOnError class
*/
"use strict";

var context = require( '../../context.js' );
var contentHelper = require( './contentHelper.js' );

var TALOnError = function( stringToApply, structureToApply ) {
    
    var string = stringToApply;
    var structure = structureToApply;
    
    var putToAutoDefineHelper = function( autoDefineHelper ){

        // Add onErrorVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().onErrorVarName,
            string,
            true
        );
        
        // Add onErrorStructureVarName to the autoDefineHelper
        autoDefineHelper.put(
            context.getConf().onErrorStructureVarName,
            structure,
            false
        );
    };

    var dependsOn = function(){
        return [];
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return "TALOnError: " + string;
    };
    
    return {
        putToAutoDefineHelper: putToAutoDefineHelper,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALOnError.id
    };
};

TALOnError.id = 'tal:on-error';

TALOnError.build = function( string ) {

    return contentHelper.build( 
        'TALOnError',
        string,
        function( _string, _expression, _structure, _expressionString ){
            return new TALOnError( _expressionString, _structure );
        }
    );
};

module.exports = TALOnError;

},{"../../context.js":27,"./contentHelper.js":13}],21:[function(require,module,exports){
/*
    TALRepeat class
*/
"use strict";

var expressionsUtils = require( '../../expressions/expressionsUtils.js' );
var expressionBuilder = require( '../../expressions/expressionBuilder.js' );
var Loop = require( '../../parsers/loop.js' );

var TALRepeat = function( stringToApply, varNameToApply, expressionStringToApply ) {
    
    var string = stringToApply;
    var varName = varNameToApply;
    var expressionString = expressionStringToApply;
    var expression = expressionBuilder.build( expressionString );
    var loop;
    
    var process = function( scope ){
        loop = new Loop( varName, expressionString, scope );
        return loop;
    };
    
    var dependsOn = function( scope ){
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function( parserUpdater, node ){
        parserUpdater.updateNode( node );
    };
    
    var toString = function(){
        return "TALRepeat: " + string;
    };
    
    var getExpressionString = function(){
        return expressionString;
    };
    
    var getVarName = function(){
        return varName;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALRepeat.id,
        getExpressionString: getExpressionString,
        getVarName: getVarName
    };
};

TALRepeat.id = 'tal:repeat';

TALRepeat.build = function( string ) {
    
    var expressionString = string.trim();
    var space = expressionString.indexOf( ' ' );
    if ( space === -1 ) {
        throw 'Bad repeat expression: ' + expressionString;
    }
    var varName = expressionString.substring( 0, space );
    var loopExpression = expressionString.substring( space + 1 );
    
    return new TALRepeat( string, varName, loopExpression );
};

module.exports = TALRepeat;

},{"../../expressions/expressionBuilder.js":46,"../../expressions/expressionsUtils.js":48,"../../parsers/loop.js":88}],22:[function(require,module,exports){
/*
    TALReplace class
*/
"use strict";

var evaluateHelper = require( '../../expressions/evaluateHelper.js' );
var contentHelper = require( './contentHelper.js' );
var expressionsUtils = require( '../../expressions/expressionsUtils.js' );

var TALReplace = function( stringToApply, expressionToApply, structureToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var structure = structureToApply;
    
    var process = function( scope, node ){
        
        // Evaluate
        var evaluated = evaluateHelper.evaluateToNotNull( scope, expression );
        
        // Check default
        if ( evaluateHelper.isDefault( evaluated ) ){
            return true;
        }

        // Check nothing
        if ( evaluateHelper.isNothing( evaluated ) ){
            evaluated = "";
        }
        
        if ( structure ){
            // Replace HTML
            node.outerHTML = evaluated;
            
        } else {
            // Replace original node by new text node
            var textNode = node.ownerDocument.createTextNode( evaluated );
            node.parentNode.replaceChild( textNode, node );
        }
        
        return true;
    };
    
    var dependsOn = function( scope ){
        //return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
        return expressionsUtils.buildDependsOnList( undefined, scope, expression );
    };
    
    var update = function(){
        // Nothing to do
    };
    
    var toString = function(){
        return 'TALReplace: ' + string;
    };
    
    return {
        process: process,
        dependsOn: dependsOn,
        update: update,
        toString: toString,
        type: TALReplace.id
    };
};

TALReplace.id = 'tal:replace';

TALReplace.build = function( string ) {

    return contentHelper.build( 
        'TALReplace',
        string,
        function( _string, _expression, _structure ){
            return new TALReplace( _string, _expression, _structure );
        }
    );
};

module.exports = TALReplace;

},{"../../expressions/evaluateHelper.js":44,"../../expressions/expressionsUtils.js":48,"./contentHelper.js":13}],23:[function(require,module,exports){
/* 
    attributeIndex singleton class
*/
"use strict";

var utils = require( '../utils.js' );
var context = require( '../context.js' );

module.exports = (function() {
    
    var map;
    
    var reset = function(){
        map = {};
    };
    reset();
    
    var add = function( node, attributeInstance, scope ){
        
        addList(
            node,
            attributeInstance,
            attributeInstance.dependsOn( scope )
        );
    };
    
    var addList = function( node, attributeInstance, list, groupId ){
        
        for ( var i = 0; i < list.length; i++ ) {
            addAny( node, attributeInstance, list[ i ], groupId );
        }
    };
    var addObject = function( node, attributeInstance, item ){
        
        for ( var groupId in item ){
            addAny( node, attributeInstance, item[ groupId ], groupId );
        }
    };
    var addAny = function( node, attributeInstance, item, groupId ){
        
        if ( utils.isPlainObject( item ) ){
            addObject( node, attributeInstance, item );
        } else if ( Array.isArray( item ) ){
            addList( node, attributeInstance, item, groupId );
        } else {
            addVar( node, attributeInstance, item, groupId );
        }
    };
    /*
    var addVar = function( node, attributeInstance, varName, groupId  ){
        
        var list = map[ varName ];
        if ( ! list ){
            list = [];
            map[ varName ] = list;
        }

        list.push(
            {
                attributeInstance: attributeInstance,
                nodeId: node.getAttribute( context.getTags().id ),
                groupId: groupId
            }
        );
    };
    */
    var addVar = function( node, attributeInstance, varName, groupId  ){
        
        var list = map[ varName ];
        if ( ! list ){
            list = [];
            map[ varName ] = list;
        }
        
        var newItem = {
            attributeInstance: attributeInstance,
            nodeId: node.getAttribute( context.getTags().id ),
            groupId: groupId
        };
        
        //var index = list.findIndex( item => utils.deepEqual( item, newItem ) );
        var index = list.findIndex( 
            function( item ) { 
                return utils.deepEqual( item, newItem );
            }
        );
        if ( index === -1 ){
            list.push( newItem );
        } else {
            list[ index ] = newItem;
        }
    };
    
    var getVarsList = function( varName ){
        
        var items = map[ varName ];
        
        // Return an empty list if needed
        if ( items === undefined ){
            return [];
        }
        
        // Remove items with removed nodes
        cleanItems( items );
        
        // We must build another list to avoid sync errors
        var result = [];
        result = result.concat( items );
        return result;
    };
    
    //TODO findNodeById duplicated
    var findNodeById = function ( nodeId ) {
        
        return window.document.querySelector( 
            '[' + context.getTags().id + '="' + nodeId + '"]' 
        );
    };
    
    // Iterate through items and remove them when node does not exist in DOM
    var cleanItems = function( items ){
        
        var indexesToRemove = [];
        
        // Build list of items to remove
        for ( var i = 0; i < items.length; ++i ){
            var item = items[ i ];
            var node = findNodeById( item.nodeId );
            if ( ! node ){
                indexesToRemove.push( i );
            }
        }
        
        // Remove items
        for ( var j = indexesToRemove.length - 1; j >= 0 ; --j ){
            var indexToRemove = indexesToRemove[ j ];
            items.splice( indexToRemove, 1 );
        };
    };
    /*
    var removeVar = function( varName, nodeId ){
        
        var list = map[ varName ];

        var filtered = list.filter(
            function( value, index, arr ){
                return value.nodeId !== nodeId;
            }
        );

        map[ varName ] = filtered;
    };
    
    var removeVarFromNodes = function( varName, nodeIds ){
        
        var list = map[ varName ];

        var filtered = list.filter(
            function( value, index, arr ){
                return nodeIds.indexOf( value.nodeId ) === -1;
            }
        );

        if ( filtered.length === 0 ){
            delete map[ varName ];
        } else {
            map[ varName ] = filtered;
        }
        
    };
    
    var getAllNodeIds = function( target ){
        
        // Get the list
        var list = target.querySelectorAll( '[' + context.getTags().id + ']' );

        // Iterate the list
        var result = [];
        var nodeIdAttributeName = context.getTags().id;
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            result.push( 
                node.getAttribute( nodeIdAttributeName ) 
            );
        }
        
        return result;
    };
    
    var removeNode = function( node ){

        var nodeIds = getAllNodeIds( node );

        var nodeId = node.getAttribute( context.getTags().id );
        nodeIds.push( nodeId );
        
        for ( var varName in map ){
            removeVarFromNodes( varName, nodeIds );
        }
    };
    
    var removeMultipleNodes = function( nodeIds ){

        for ( var varName in map ){
            removeVarFromNodes( varName, nodeIds );
        }
    };
    */
    return {
        add: add,
        getVarsList: getVarsList,
        //removeVar: removeVar,
        //removeNode: removeNode,
        //removeMultipleNodes: removeMultipleNodes,
        reset: reset
    };
})();

},{"../context.js":27,"../utils.js":101}],24:[function(require,module,exports){
/*
    attributeCache singleton class
*/
"use strict";

var CacheHelper = require( './cacheHelper.js' );
var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );

module.exports = (function() {
    
    var map;
    
    var reset = function(){
        map = {};
    };
    reset();
    
    var get = function( attribute, string ) {
        
        var attributeMap = map[ attribute ];
        
        if ( ! attributeMap ){
            return null;
        }
         
        return attributeMap[ CacheHelper.hashCode( string ) ];
    };
    
    var put = function( attribute, string, value ){
        
        var attributeMap = map[ attribute ];
        
        if ( ! attributeMap ){
            attributeMap = {};
            map[ attribute ] = attributeMap;
        }
        
        attributeMap[ CacheHelper.hashCode( string ) ] = value;
    };
    
    var index = function( node, attribute, scope ){
        
        if ( node ){
            log.debug( 'Must index!' );
            attributeIndex.add( node, attribute, scope );
            
        } else {
            log.debug( 'Not indexed!' );
        }
        
        return attribute;
    };
    
    var getByDetails = function( attributeType, string, buildFunction, force, node, scope ) {
        
        log.debug( 
            'Request building of ZPT attribute "' + string + '", force "' + force + '"' );
        
        // Get from cache if possible
        if ( force || ! context.getConf().attributeCacheOn ){
            log.debug( 'Cache OFF!' );
            
        } else {
            log.debug( 'Cache ON!' );
            var fromCache = get( attributeType, string );
            if ( fromCache ){
                log.debug( 'Found in cache!' );
                //return fromCache;
                return index( node, fromCache, scope );
            } else {
                log.debug( 'NOT found in cache!' );
            }
        }
        
        // Force build and put into cache
        log.debug( 'Must build!' );
        var builded = buildFunction();
        put( attributeType, string, builded );
        //return builded;
        return index( node, builded, scope );
    };
    
    var getByAttributeClass = function( attributeInstance, string, node, indexExpressions, scope, constructor ) {
        
        return getByDetails( 
                attributeInstance.id, 
                string, 
                constructor || function(){
                    return attributeInstance.build( string );
                }, 
                false,
                indexExpressions? node: undefined,
                scope
        );
    };
    
    return {
        //getByDetails: getByDetails,
        getByAttributeClass: getByAttributeClass,
        reset: reset
    };
})();

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../logHelper.js":74,"./cacheHelper.js":25}],25:[function(require,module,exports){
/*
    cacheHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var hashCode = function( string ) {

        if ( Array.prototype.reduce ) {
            return string.split( "" ).reduce(
                function( a, b ){
                    a = ( ( a << 5 ) - a ) + b.charCodeAt( 0 );
                    return a&a
                },
                0 );
        }

        var hash = 0;
        if ( string.length === 0 ){
            return hash;
        }
        for ( var i = 0, len = string.length; i < len; i++ ) {
            var chr = string.charCodeAt( i );
            hash = ( ( hash << 5 ) - hash ) + chr;
            hash |= 0; // Convert to 32bit integer
        }
        
        return hash;
    };
    
    return {
        hashCode: hashCode
    };
})();

},{}],26:[function(require,module,exports){
/*
    expressionCache singleton class
*/
module.exports = (function() {
    "use strict";
    
    var CacheHelper = require( './cacheHelper.js' );
    var context = require( '../context.js' );
    var log = require( '../logHelper.js' );
    
    var map = {};
    
    var get = function( string ) {
        return map[ CacheHelper.hashCode( string ) ];
    };
    
    var put = function( string, value ){
        map[ CacheHelper.hashCode( string ) ] = value;
    };
    
    var process = function( string, buildFunction, force ) {
        
        log.debug( 
            'Request building of expression "' + string + '", force "' + force + '"' );
        
        // Get from cache if possible
        if ( ! force && context.getConf().expressionCacheOn ){
            log.debug( 'Cache ON!' );
            var fromCache = get( string );
            if ( fromCache ){
                log.debug( 'Found in cache!' );
                return fromCache;
            } 
            log.debug( 'NOT found in cache!' );
            
        } else {
            log.debug( 'Cache OFF!' );
        }
        
        // Force build and put into cache
        log.debug( 'Must build!' );
        var builded = buildFunction();
        put( string, builded );
        return builded;
    };
    
    var clean = function( ) {
        map = {};
    };
    
    return {
        get: process,
        clean: clean
    };
})();

},{"../context.js":27,"../logHelper.js":74,"./cacheHelper.js":25}],27:[function(require,module,exports){
/* 
    context singleton class
*/

var log4javascript = require( 'log4javascript' );
var utils = require( './utils.js' );
var LoopItem = require( './parsers/loopItem.js' );
var CSSAnimationManager = require( './parsers/dictionaryActions/cssAnimationManager.js' );

module.exports = (function() {
    "use strict";
    
    /* Tags */
    var defaultTags = {
        talCondition:     "data-condition",
        talRepeat:        "data-repeat",
        talAttributes:    "data-attributes",
        talContent:       "data-content",
        talDefine:        "data-define",
        talAutoDefine:    "data-tauto-define",
        talOmitTag:       "data-omit-tag",
        talReplace:       "data-replace",
        talOnError:       "data-on-error",
        talDeclare:         "data-declare",
        metalDefineMacro: "data-define-macro",
        metalUseMacro:    "data-use-macro",
        metalDefineSlot:  "data-define-slot",
        metalFillSlot:    "data-fill-slot",
        metalMacro:       "data-mmacro",
        i18nDomain:       "data-domain",
        i18nLanguage:     "data-language",
        //scopeKey:         "data-scope-key",
        rootKey:          "data-root-key",
        qdup:             "data-qdup",
        id:               "data-id",
        relatedId:        "data-related-id",
        conditionResult:  "data-condition-result"
    };
    var originalTags = {
        talCondition:     "tal:condition",
        talRepeat:        "tal:repeat",
        talAttributes:    "tal:attributes",
        talContent:       "tal:content",
        talDefine:        "tal:define",
        talAutoDefine:    "tal:auto-define",
        talOmitTag:       "tal:omit-tag",
        talReplace:       "tal:replace",
        talOnError:       "tal:on-error",
        talDeclare:       "tal:declare",
        metalDefineMacro: "metal:define-macro",
        metalUseMacro:    "metal:use-macro",
        metalDefineSlot:  "metal:define-slot",
        metalFillSlot:    "metal:fill-slot",
        metalMacro:       "data-mmacro",
        i18nDomain:       "i18n:domain",
        i18nLanguage:     "i18n:language",
        //scopeKey:         "data-scope-key",
        rootKey:          "data-root-key",
        qdup:             "data-qdup",
        id:               "data-id",
        relatedId:        "data-related-id",
        conditionResult:  "data-condition-result"
    };
    var tags = defaultTags;
    var tal = '';
    
    var getTags = function (){
        return tags;
    };
    
    var setTags = function ( tagsToSet ){
        tags = tagsToSet;
        tal = '';
    };
    
    var getTal = function (){
        if ( tal === '' ){
            var c = 0;
            var notInclude = tags.qdup;
            for ( var property in tags ) {
                if ( notInclude === tags[ property ] ){
                    continue;
                }
                if ( c++ > 0){
                    tal += ",";
                }
                tal += "*[" + tags[ property ] + "]";
            }
        }
        
        return tal;
    };
    var useOriginalTags = function(){
        setTags( originalTags );
    };
    /* End Tags */
    
    /* Formatters */
    var formatters = {};
    formatters.lowerCase = function ( value ){
        return value.toLocaleLowerCase();
    };
    formatters.upperCase = function ( value ){
        return value.toLocaleUpperCase();
    };
    formatters.localeDate = function ( value ){
        return value.toLocaleDateString;
    };
    formatters.localeTime = function ( value ){
        return value.toLocaleTimeString;
    };
    formatters.localeString = function ( value, locale ){
        return locale? 
               value.toLocaleString( value, locale ): 
               value.toLocaleString( value );
    };
    formatters.fix = function ( number, fixTo ){
        return number.toFixed( fixTo );
    };
    
    var getFormatter = function ( id ){
        return formatters[ id ];
    };
    
    var registerFormatter = function ( id, formatter ){
        formatters[ id ] = formatter;
    };
    var unregisterFormatter = function ( id ){
        delete formatters[ id ];
    };
    /* End Formatters */
    
    /* Conf */
    var EXPRESSION_SUFFIX = ':';
    var PRIVATE_VARS_PREFIX = '_';
    var defaultConf = {
        pathDelimiter:          '|',
        pathSegmentDelimiter:   '/',
        expressionDelimiter:    ' ',
        intervalDelimiter:      ':',
        propertyDelimiter:      '/',
        defineDelimiter:        ';',
        inDefineDelimiter:      ' ',
        attributeDelimiter:     ';',
        inAttributeDelimiter:   ' ',
        domainDelimiter:        ' ',
        i18nOptionsDelimiter:   ';',
        inI18nOptionsDelimiter: ' ',
        argumentsDelimiter:     ',',
        macroDelimiter:         '@',
        declareDelimiter:         ';',
        inDeclareDelimiter:       ' ',
        
        i18nConfResourceId:      "/CONF/",
        
        htmlStructureExpressionPrefix:  "structure",
        globalVariableExpressionPrefix: "global",
        nocallVariableExpressionPrefix: "nocall",
        
        templateErrorVarName:    "error",
        onErrorVarName:          PRIVATE_VARS_PREFIX + "on-error",
        onErrorStructureVarName: PRIVATE_VARS_PREFIX + "on-error-structure",
        i18nDomainVarName:       PRIVATE_VARS_PREFIX + "i18nDomain",
        i18nLanguageVarName:     PRIVATE_VARS_PREFIX + "i18nLanguage",
        externalMacroUrlVarName: PRIVATE_VARS_PREFIX + "externalMacroUrl",
        strictModeVarName:       PRIVATE_VARS_PREFIX + "strictMode",
        declaredVarsVarName:     PRIVATE_VARS_PREFIX + "declaredVars",
        repeatVarName:           PRIVATE_VARS_PREFIX + "repeat",
        
        windowVarName:           "window",
        contextVarName:          "context",
        
        nothingVarName:          "nothing",
        defaultVarName:          "default",
        nothingVarValue:         "___nothing___",
        defaultVarValue:         "___default___",
        
        loggingOn:    false,
        loggingLevel: log4javascript.Level.ERROR,

        externalMacroPrefixURL: "",
        variableNameRE:         /^[A-Za-z0-9_/-]+$/,
        expressionCacheOn:      true,
        attributeCacheOn:       true,

        expressionSuffix:     EXPRESSION_SUFFIX,
        stringExpression:     "string" + EXPRESSION_SUFFIX,
        existsExpression:     "exists" + EXPRESSION_SUFFIX,
        notExpression:        "not" + EXPRESSION_SUFFIX,
        javaScriptExpression: "js" + EXPRESSION_SUFFIX,
        equalsExpression:     "eq" + EXPRESSION_SUFFIX,
        greaterExpression:    "gt" + EXPRESSION_SUFFIX,
        lowerExpression:      "lt" + EXPRESSION_SUFFIX,
        addExpression:        "+" + EXPRESSION_SUFFIX,
        subExpression:        "-" + EXPRESSION_SUFFIX,
        mulExpression:        "*" + EXPRESSION_SUFFIX,
        divExpression:        "/" + EXPRESSION_SUFFIX,
        modExpression:        "%" + EXPRESSION_SUFFIX,
        orExpression:         "or" + EXPRESSION_SUFFIX,
        andExpression:        "and" + EXPRESSION_SUFFIX,
        condExpression:       "cond" + EXPRESSION_SUFFIX,
        formatExpression:     "format" + EXPRESSION_SUFFIX,
        trExpression:         "tr" + EXPRESSION_SUFFIX,
        trNumberExpression:   "trNumber" + EXPRESSION_SUFFIX,
        trCurrencyExpression: "trCurrency" + EXPRESSION_SUFFIX,
        trDateTimeExpression: "trDate" + EXPRESSION_SUFFIX,
        inExpression:         "in" + EXPRESSION_SUFFIX,
        queryExpression:      "query" + EXPRESSION_SUFFIX,
        pathExpression:       "",
        
        firstIndexIdentifier: "_first_",
        lastIndexIdentifier:  "_last_"
    };
    var conf = defaultConf;
    
    var getConf = function (){
        return conf;
    };
    
    var setConf = function ( confToSet ){
        conf = confToSet;
    };
    /* End conf */
    
    /* Logger */
    var logger;
    var getDefaultLogger = function (){
        
        var defaultLogger = log4javascript.getDefaultLogger();
        
        defaultLogger.setLevel( getConf().loggingLevel );
        //defaultLogger.removeAllAppenders();
        //defaultLogger.addAppender( new log4javascript.BrowserConsoleAppender( true ) );
        
        return defaultLogger;
    };
    var getLogger = function (){
        
        if ( ! logger && getConf().loggingOn ){
            logger = getDefaultLogger();
        }
        
        return logger;
    };
    var setLogger = function ( loggerToSet ){
        logger = loggerToSet;
    };
    /* End Logger */
    
    /* 
        Boolean attributes:
        The presence of a boolean attribute on an element represents the true value, and the absence of the attribute represents the false value.
    */
    var booleanAttributes = {
        checked: 1,
        compact: 1,
        declare: 1,
        defer: 1,
        disabled: 1,
        ismap: 1,
        multiple: 1,
        nohref: 1,
        noresize: 1,
        noshade: 1,
        nowrap: 1,
        readonly: 1,
        selected: 1
    };
    
    var getBooleanAttributes = function (){
        return booleanAttributes;
    };
    var setBooleanAttributes = function ( booleanAttributesToSet ){
        booleanAttributes = booleanAttributesToSet;
    };
    var isBooleanAttribute = function ( attribute ){
        return booleanAttributes[ attribute ] === 1;
    };
    /* End Boolean attributes */
    
    /* 
        Alt attributes:
        Attributes which don't support setAttribute().
    */
    var altAttributes = {
        className: 1,
        class: 1,
        href: 1,
        htmlFor: 1,
        id: 1,
        innerHTML: 1,
        label: 1,
        style: 1,
        src: 1,
        text: 1,
        title: 1,
        value: 1
    };
    // All booleanAttributes are also altAttributes
    utils.extend( altAttributes, booleanAttributes );
    
    var getAltAttributes = function (){
        return altAttributes;
    };
    var setAltAttributes = function ( altAttributesToSet ){
        altAttributes = altAttributesToSet;
    };
    var isAltAttribute = function ( attribute ){
        return altAttributes[ attribute ] === 1;
    };
    /* End Alt attributes */
    
    /* Errors */
    var defaultErrorFunction = function( error ) {
        
        var msg = Array.isArray( error )?
            error.join( '\n' ):
            error;
        
        window.alert( msg );
        
        throw msg;
    };
    var errorFunction = defaultErrorFunction;
    var setErrorFunction = function( _errorFunction ){
        self.errorFunction = _errorFunction;
    };
    var asyncError = function( url, errorMessage, failCallback ){

        var msg = 'Error trying to get ' + url + ': ' + errorMessage;
        if ( failCallback ){
            failCallback( msg );
        } else {
            errorFunction( msg );
        }
    };
    /* End errors */
    
    /* Repeat */
    var repeat = function( index, length, offset ){
        return new LoopItem( index, length, offset );
    };
    /* End repeat*/
    
    /* Folder dictionaries */
    var folderDictionaries = [];
    var setFolderDictionaries = function( _folderDictionaries ){
        folderDictionaries = _folderDictionaries;
    };
    var getFolderDictionaries = function(){
        return folderDictionaries;
    };
    /* End folder dictionaries */
    
    /* Strict mode  */
    var strictMode = false;
    var setStrictMode = function( _strictMode ){
        strictMode = _strictMode;
    };
    var isStrictMode = function(){
        return strictMode;
    };
    /* End strict mode  */
    
    /* Expression counter */
    var expressionCounter = 0;
    var nextExpressionCounter = function(){
        return ++expressionCounter;
    };
    var setExpressionCounter = function( _expressionCounter ){
        expressionCounter = _expressionCounter;
    };
    /* End expression counter */
    
    /* Run counter */
    var runCounter = 0;
    var nextRunCounter = function(){
        return ++runCounter;
    };
    /* End run counter */
    
    /* Animation managers */
    var defaultAnimationManager = CSSAnimationManager;
    var animationManager = defaultAnimationManager;
    var getAnimationManager = function(){
        return animationManager;
    };
    var setAnimationManager = function( _animationManager ){
        animationManager = _animationManager;
    };
    /* End animation managers*/
    
    var self = {
        getTags: getTags,
        setTags: setTags,
        getTal: getTal,
        getFormatter: getFormatter,
        registerFormatter: registerFormatter,
        unregisterFormatter: unregisterFormatter,
        getConf: getConf,
        setConf: setConf,
        getLogger: getLogger,
        setLogger: setLogger,
        useOriginalTags: useOriginalTags,
        getBooleanAttributes: getBooleanAttributes,
        setBooleanAttributes: setBooleanAttributes,
        isBooleanAttribute: isBooleanAttribute,
        getAltAttributes: getAltAttributes,
        setAltAttributes: setAltAttributes,
        isAltAttribute: isAltAttribute,
        errorFunction: errorFunction,
        setErrorFunction: setErrorFunction,
        asyncError: asyncError,
        repeat: repeat,
        setFolderDictionaries: setFolderDictionaries,
        getFolderDictionaries: getFolderDictionaries,
        setStrictMode: setStrictMode,
        isStrictMode: isStrictMode,
        nextExpressionCounter: nextExpressionCounter,
        setExpressionCounter: setExpressionCounter,
        nextRunCounter: nextRunCounter,
        getAnimationManager: getAnimationManager,
        setAnimationManager: setAnimationManager
    };
    
    return self;
})();

},{"./parsers/dictionaryActions/cssAnimationManager.js":84,"./parsers/loopItem.js":89,"./utils.js":101,"log4javascript":3}],28:[function(require,module,exports){
/*
    AddExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var AddExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            AddExpression.mathOperation, 
            function( total, value ){
                return total + value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

AddExpression.removePrefix = true;
AddExpression.getPrefix = function() {
    return context.getConf().addExpression;
};
AddExpression.mathOperation = 'add';
AddExpression.getId = AddExpression.mathOperation;

AddExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            AddExpression.mathOperation 
    );

    return new AddExpression( string, expressionList );
};

module.exports = AddExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],29:[function(require,module,exports){
/* 
    arithmethicHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var evaluateHelper = require( '../evaluateHelper.js' );
    
    var build = function( string, tag ) {
        var expressionBuilder = require( '../expressionBuilder.js' );

        if ( string.length === 0 ) {
            throw tag + " expression void.";
        }
        
        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false 
        );

        return expressionBuilder.buildList( segments );
    };
    
    var evaluate = function( string, scope, expressionList, mathOperation, arithmethicFunction ) {
        
        // Evaluate segments
        var result = 0;
        var c = 0;
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( ! Array.isArray( evaluated ) ){ 
                // Process numeric value
                result = processInteger( 
                    c++, 
                    evaluated, 
                    result, 
                    arithmethicFunction, 
                    mathOperation, 
                    expression );
                
            } else {
                // Process array of numeric
                for ( var j = 0; j < evaluated.length; j++ ) {
                    result = processInteger( 
                        c++, 
                        evaluated[ j ], 
                        result, 
                        arithmethicFunction, 
                        mathOperation, 
                        expression );
                }
            }
        }
        
        if ( c < 2 ) {
            throw 'Error in expression "' + string + '". Only one element in evaluation of "' + mathOperation 
                + '" expression, please add at least one more.';
        }
        
        return result;
    };
    
    var processInteger = function( c, value, result, arithmethicFunction, mathOperation, expression ){
        
        if ( ! evaluateHelper.isNumber( value ) ) {
            throw "Error trying doing math operation, value '" + value 
                    + "' is not a valid number in expression '" + mathOperation + ' ' + expression + "'";
        }

        return c == 0? Number( value ): arithmethicFunction( result, Number( value ) );
    };
    
    return {
        build: build,
        evaluate: evaluate
    };
})();

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],30:[function(require,module,exports){
/*
    DivideExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var DivideExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            DivideExpression.mathOperation, 
            function( total, value ){
                return total / value;
            } 
        );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

DivideExpression.removePrefix = true;
DivideExpression.getPrefix = function() {
    return context.getConf().divExpression;
};
DivideExpression.mathOperation = 'divide';
DivideExpression.getId = DivideExpression.mathOperation;

DivideExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            DivideExpression.mathOperation 
    );

    return new DivideExpression( string, expressionList );
};

module.exports = DivideExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],31:[function(require,module,exports){
/*
    ModExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var ModExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            ModExpression.mathOperation, 
            function( total, value ){
                return total % value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ModExpression.removePrefix = true;
ModExpression.getPrefix = function() {
    return context.getConf().modExpression;
};
ModExpression.mathOperation = 'mod';
ModExpression.getId = ModExpression.mathOperation;

ModExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            ModExpression.mathOperation 
    );

    return new ModExpression( string, expressionList );
};

module.exports = ModExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],32:[function(require,module,exports){
/*
    MultiplyExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var MultiplyExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            MultiplyExpression.mathOperation, 
            function( total, value ){
                return total * value;
            } 
        );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

MultiplyExpression.removePrefix = true;
MultiplyExpression.getPrefix = function() {
    return context.getConf().mulExpression;
};
MultiplyExpression.mathOperation = 'multiply';
MultiplyExpression.getId = MultiplyExpression.mathOperation;

MultiplyExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            MultiplyExpression.mathOperation 
    );

    return new MultiplyExpression( string, expressionList );
};

module.exports = MultiplyExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],33:[function(require,module,exports){
/*
    SubstractExpression class
*/
"use strict";

var context = require( '../../context.js' );
var arithmethicHelper = require( './arithmethicHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var SubstractExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        return arithmethicHelper.evaluate( 
            string,
            scope,
            expressionList, 
            SubstractExpression.mathOperation, 
            function( total, value ){
                return total - value;
            } 
        );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

SubstractExpression.removePrefix = true;
SubstractExpression.getPrefix = function() {
    return context.getConf().subExpression;
};
SubstractExpression.mathOperation = 'substract';
SubstractExpression.getId = SubstractExpression.mathOperation;

SubstractExpression.build = function( string ) {
    
    var expressionList = arithmethicHelper.build( 
            string,
            SubstractExpression.mathOperation 
    );

    return new SubstractExpression( string, expressionList );
};

module.exports = SubstractExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./arithmethicHelper.js":29}],34:[function(require,module,exports){
/*
    AndExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var AndExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            if ( ! evaluateHelper.evaluateBoolean( scope, expression ) ){
                return false;
            }
        }

        return true;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

AndExpression.removePrefix = true;
AndExpression.getPrefix = function() {
    return context.getConf().andExpression;
};
AndExpression.getId = AndExpression.getPrefix;

AndExpression.build = function( string ) {
    var boolHelper = require( './boolHelper.js' );
    
    var expressionList = boolHelper.build( string, 'And' );

    return new AndExpression( string, expressionList );
};

module.exports = AndExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionsUtils.js":48,"./boolHelper.js":35}],35:[function(require,module,exports){
/* 
    boolHelper singleton class
*/
"use strict";

module.exports = (function() {    
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var build = function( s, tag ) {
        
        var string = s.trim();
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false );
        if ( segments.countTokens() === 1 ) {
            throw 'Syntax error in expression "' + string + '". Only one element in ' + tag + ' expression, please add at least one more.';
        }
        
        return expressionBuilder.buildList( segments );
    };
    
    return {
        build: build
    };
})();

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],36:[function(require,module,exports){
/*
    CondExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var evaluateHelper = require( '../evaluateHelper.js' );

var CondExpression = function( stringToApply, expression1ToApply, expression2ToApply, expression3ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    var expression3 = expression3ToApply;
    
    var evaluate = function( scope ){
        
        return evaluateHelper.evaluateBoolean( scope, expression1 )?
            expression2.evaluate( scope ):
            expression3.evaluate( scope );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2, expression3 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

CondExpression.removePrefix = true;
CondExpression.getPrefix = function() {
    return context.getConf().condExpression;
};
CondExpression.getId = CondExpression.getPrefix;

CondExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();

    if ( string.length === 0 ) {
        throw 'Cond expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    if ( segments.countTokens() !== 3 ) {
        throw 'Syntax error in cond expression "' + string + '". 3 element are needed.';
    }

    return new CondExpression( 
        string,
        expressionBuilder.build( segments.nextToken() ), 
        expressionBuilder.build( segments.nextToken() ), 
        expressionBuilder.build( segments.nextToken() ) 
    );
};

module.exports = CondExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],37:[function(require,module,exports){
/*
    NotExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var NotExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        return ! evaluateHelper.evaluateBoolean( scope, expression );
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

NotExpression.removePrefix = true;
NotExpression.getPrefix = function() {
    return context.getConf().notExpression;
};
NotExpression.getId = NotExpression.getPrefix;

NotExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    
    return new NotExpression( string, expression );
};

module.exports = NotExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionsUtils.js":48}],38:[function(require,module,exports){
/*
    OrExpression class
*/
"use strict";

var context = require( '../../context.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var OrExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            if ( evaluateHelper.evaluateBoolean( scope, expression ) ){
                return true;
            }
        }

        return false;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

OrExpression.removePrefix = true;
OrExpression.getPrefix = function() {
    return context.getConf().orExpression;
};
OrExpression.getId = OrExpression.getPrefix;

OrExpression.build = function( string ) {
    var boolHelper = require( './boolHelper.js' );
    
    var expressionList = boolHelper.build( string, 'Or' );

    return new OrExpression( string, expressionList );
};

module.exports = OrExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionsUtils.js":48,"./boolHelper.js":35}],39:[function(require,module,exports){
/* 
    comparisonHelper singleton class
*/
"use strict";

module.exports = (function() {
    var context = require( '../../context.js' );
    var ExpressionTokenizer = require( '../expressionTokenizer.js' );
    var evaluateHelper = require( '../evaluateHelper.js' );
    
    var build = function( s, tag ) {
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        var string = s.trim();
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string, 
                context.getConf().expressionDelimiter, 
                false );
        if ( segments.countTokens() !== 2 ) {
            throw 'Wrong number of elements in expression "' + string + '", ' + tag + ' expressions only support two.';
        }

        var expression1 = expressionBuilder.build( segments.nextToken() );
        var expression2 = expressionBuilder.build( segments.nextToken() );
        
        return {
            expression1: expression1,
            expression2: expression2
        };
    };
    
    var evaluate = function( scope, valueExpression1, valueExpression2 ) {
        
        return {
            number1: evaluateHelper.evaluateNumber( scope, valueExpression1 ),
            number2: evaluateHelper.evaluateNumber( scope, valueExpression2 )
        };
    };
    
    return {
        build: build,
        evaluate: evaluate
    };
})();

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47}],40:[function(require,module,exports){
/*
    EqualsExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var EqualsExpression = function( stringToApply, argsToApply ) {
    
    var string = stringToApply;
    var args = argsToApply;
    
    var evaluate = function( scope ){
        var arg0 = args[ 0 ];
        var result0 = arg0.evaluate( scope );
        
        for ( var i = 1; i < args.length; i++ ) {
            var arg = args[ i ];
            var result = arg.evaluate( scope );
            if ( result0 != result ){
                return false;
            }
        }
        
        return true;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, args );
    };
    
    var toString = function(){
        return string;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

EqualsExpression.removePrefix = true;
EqualsExpression.getPrefix = function() {
    return context.getConf().equalsExpression;
};
EqualsExpression.getId = EqualsExpression.getPrefix;

EqualsExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    if ( string.length === 0 ) {
        throw 'Equals expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    if ( segments.countTokens() === 1 ) {
        throw 'Only one element in equals expression "' + string + '", please add at least one more.';
    }

    return new EqualsExpression( 
        string,
        expressionBuilder.buildList( segments ) 
    );
};

module.exports = EqualsExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],41:[function(require,module,exports){
/*
    GreaterExpression class
*/
"use strict";

var context = require( '../../context.js' );
var comparisonHelper = require( './comparisonHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var GreaterExpression = function( stringToApply, expression1ToApply, expression2ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    
    var evaluate = function( scope ){
        var numbers = comparisonHelper.evaluate( scope, expression1, expression2 );
        return numbers.number1 > numbers.number2;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

GreaterExpression.removePrefix = true;
GreaterExpression.getPrefix = function() {
    return context.getConf().greaterExpression;
};
GreaterExpression.getId = GreaterExpression.getPrefix;

GreaterExpression.build = function( string ) {
    
    var data = comparisonHelper.build( string, 'greater' );

    return new GreaterExpression( string, data.expression1, data.expression2 );
};

module.exports = GreaterExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./comparisonHelper.js":39}],42:[function(require,module,exports){
/*
    InExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var InExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){
        var expression0 = expressionList[ 0 ];
        var evaluated0 = expression0.evaluate( scope );
        
        for ( var i = 1; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( Array.isArray( evaluated ) ){ 
                for ( var j = 0; j < evaluated.length; j++ ) {
                    if ( evaluated0 == evaluated[ j ] ){
                        return true;
                    }
                }
                continue;
            }
            
            if ( evaluated0 == evaluated ){
                return true;
            }
        }
        
        return false;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

InExpression.removePrefix = true;
InExpression.getPrefix = function() {
    return context.getConf().inExpression;
};
InExpression.getId = InExpression.getPrefix;

InExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    if ( string.length === 0 ) {
        throw 'In expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false 
    );
    if ( segments.countTokens() === 1 ) {
        throw 'Only one element in in expression "' + string + '", please add at least one more.';
    }

    return new InExpression( 
        string,
        expressionBuilder.buildList( segments ) 
    );
};

module.exports = InExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48}],43:[function(require,module,exports){
/*
    LowerExpression class
*/
"use strict";

var context = require( '../../context.js' );
var comparisonHelper = require( './comparisonHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var LowerExpression = function( stringToApply, expression1ToApply, expression2ToApply ) {
    
    var string = stringToApply;
    var expression1 = expression1ToApply;
    var expression2 = expression2ToApply;
    
    var evaluate = function( scope ){
        var numbers = comparisonHelper.evaluate( scope, expression1, expression2 );
        return numbers.number1 < numbers.number2;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression1, expression2 );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

LowerExpression.removePrefix = true;
LowerExpression.getPrefix = function() {
    return context.getConf().lowerExpression;
};
LowerExpression.getId = LowerExpression.getPrefix;

LowerExpression.build = function( string ) {
    
    var data = comparisonHelper.build( string, 'lower' );

    return new LowerExpression( string, data.expression1, data.expression2 );
};

module.exports = LowerExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"./comparisonHelper.js":39}],44:[function(require,module,exports){
/* 
    evaluateHelper singleton class
*/
"use strict";

var context = require( '../context.js' );

module.exports = (function() {
    
    var evaluateToNotNull = function( scope, expression ) {
        var evaluated = expression.evaluate( scope );
        return evaluated == undefined? 'undefined': evaluated;
    };
    
    var evaluateBoolean = function( scope, expression ) {
        var evaluated = expression.evaluate( scope );
        
        if ( evaluated === undefined
            || evaluated == null
            || evaluated == 'false' 
            || evaluated == false 
            || evaluated == 0 ){
            return false;
        }
        
        return true;
    };
    
    var evaluateNumber = function( scope, expression, errorMessageToApply ) {
        var evaluated = expression.evaluate( scope );
        
        if ( ! isNumber( evaluated ) ){
            var errorMessage = 
                errorMessageToApply? 
                errorMessageToApply: 
                'Expression "' + expression + '" is not a valid number.';
            throw errorMessage;
        }
        
        return evaluated;
    };
    
    var isNumber = function( string ){
        return ! isNaN( parseFloat( string ) ) || ! isFinite( string );
    };
    /*
    var evaluateInteger = function( scope, expression, errorMessageToApply ) {
        var evaluated = expression.evaluate( scope );
        
        if ( ! isInteger( evaluated ) ){
            var errorMessage = 
                errorMessageToApply? 
                errorMessageToApply: 
                'Expression "' + expression + '" is not a valid integer.'
            throw errorMessage;
        }
        
        return evaluated;
    };*/
    /*
    var isInteger = function( string ){
        return ! isNaN( parseInt( string ) ) || ! isFinite( string );
    };*/
    
    var evaluateExpressionList = function ( list, scope ){
        
        var result = [];
        
        for ( var i = 0; i < list.length; i++ ) {
            var expression = list[ i ];
            result.push( expression.evaluate( scope ) );
        }
        
        return result;
    };
    
    var isDefault = function( value ){
        return value === context.getConf().defaultVarValue;
    };
    var isNothing = function( value ){
        return value === context.getConf().nothingVarValue;
    };
    
    return {
        evaluateToNotNull: evaluateToNotNull,
        evaluateBoolean: evaluateBoolean,
        evaluateNumber: evaluateNumber,
        //evaluateInteger: evaluateInteger,
        isNumber: isNumber,
        //isInteger: isInteger,
        evaluateExpressionList: evaluateExpressionList,
        isDefault: isDefault,
        isNothing: isNothing
    };
})();

},{"../context.js":27}],45:[function(require,module,exports){
/*
    ExistsExpression class
*/
"use strict";

var context = require( '../context.js' );
var expressionsUtils = require( './expressionsUtils.js' );

var ExistsExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        
        try {
            return undefined !== expression.evaluate( scope );
            
        } catch ( e ){
            return false;
        }
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ExistsExpression.removePrefix = true;
ExistsExpression.getPrefix = function() {
    return context.getConf().existsExpression;
};
ExistsExpression.getId = ExistsExpression.getPrefix;

ExistsExpression.build = function( string ) {
    var expressionBuilder = require( './expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    return new ExistsExpression( string, expression );
};

module.exports = ExistsExpression;

},{"../context.js":27,"./expressionBuilder.js":46,"./expressionsUtils.js":48}],46:[function(require,module,exports){
/* 
    expressionBuilder singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( '../context.js' );
    var ExpressionTokenizer = require( './expressionTokenizer.js' );
    var PathExpression = require( './path/pathExpression.js' );
    var expressionCache = require( '../cache/expressionCache.js' );
    /*var log = require( '../logHelper.js' );*/
    
    var expressionManagers = {};
    var withoutPrefixExpressionManagers = {};
    var DEFAULT_ID = PathExpression.getId();
    
    /* Register expression managers */
    var register = function( expressionsManager, id ) {
        expressionManagers[ id || expressionsManager.getPrefix() || expressionsManager.getId() ] = expressionsManager;
        
        if ( ! expressionsManager.removePrefix && expressionsManager.getPrefix() ){
            withoutPrefixExpressionManagers[ expressionsManager.getPrefix() ] = expressionsManager;
        }
    };
    
    var unregister = function( expressionsManager, id ) {
        delete expressionManagers[ id || expressionsManager.getPrefix() || expressionsManager.getId() ];
    };
    
    var registerGeneralPurpose = function(){
        register( require( './existsExpression.js' ) );
        register( require( './formatExpression.js' ) );
        register( require( './stringExpression.js' ) );
        register( require( './path/pathExpression.js' ) );
    };
    var registerComparison = function(){
        register( require( './comparison/equalsExpression.js' ) );
        register( require( './comparison/greaterExpression.js' ) );
        register( require( './comparison/lowerExpression.js' ) );
        register( require( './comparison/inExpression.js' ) );
    };
    var registerArithmetic = function(){
        register( require( './arithmethic/addExpression.js' ) );
        register( require( './arithmethic/substractExpression.js' ) );
        register( require( './arithmethic/multiplyExpression.js' ) );
        register( require( './arithmethic/divideExpression.js' ) );
        register( require( './arithmethic/modExpression.js' ) );
    };
    var registerLogical = function(){
        register( require( './bool/andExpression.js' ) );
        register( require( './bool/condExpression.js' ) );
        register( require( './bool/notExpression.js' ) );
        register( require( './bool/orExpression.js' ) );
    };
    var registerI18n = function(){
        register( require( './i18n/trCurrencyExpression.js' ) );
        register( require( './i18n/trDateTimeExpression.js' ) );
        register( require( './i18n/trNumberExpression.js' ) );
        register( require( './i18n/trStringExpression.js' ) );
    };
    var registerScripting = function(){
        register( require( './scripting/javascriptExpression.js' ) );
        register( require( './scripting/queryExpression.js' ) );
    };
    
    var registerAll = function(){
        registerGeneralPurpose();
        registerComparison();
        registerArithmetic();
        registerLogical();
        registerI18n();
        registerScripting();
    }();
    /* End Register expression managers */
    
    var build = function( string, force ) {
        return expressionCache.get(
                string, 
                function(){
                    return forceBuild( string );
                }, 
                force
        );
    };
    
    var forceBuild = function( string ) {
        var effectiveString = removeParenthesisIfAny( string.trim() );
        var index = effectiveString.indexOf( context.getConf().expressionSuffix );
        var id = undefined;
        var isDefault = false;
        
        // Is the default expression type? Is registered?
        if ( index !== -1 ){
            id = effectiveString.substring( 0, index )  + ':';
            
            // If the id is not resistered must be a path
            isDefault = ! expressionManagers.hasOwnProperty( id );
        } else {
            isDefault = true;
        }
        
        // Remove prefix and set id if it is default expression type
        var removePrefix = false;
        var expressionManager = undefined;
        if ( isDefault ){
            /*id = DEFAULT_ID;*/
            expressionManager = getWithoutPrefixExpressionManager( effectiveString );
        } else {
            removePrefix = true;
        }
        
        // Get the expression manager and build the expression
        expressionManager = expressionManager || expressionManagers[ id ];
        var finalString = undefined;
        if ( removePrefix && expressionManager.removePrefix ){
            finalString = effectiveString.substr( id.length );
        } else {
            finalString = effectiveString;
        }
        return expressionManager.build( finalString );
    };
    
    var getWithoutPrefixExpressionManager = function( string ){
        
        for ( var prefix in withoutPrefixExpressionManagers ) {
            if ( string.indexOf( prefix ) === 0 ) {
                return withoutPrefixExpressionManagers[ prefix ];
            }
        }
        
        return expressionManagers[ DEFAULT_ID ];
    };
    
    var buildList = function( segments ) {
        var list = [];
        
        while ( segments.hasMoreTokens() ) {
            list.push(
                build( 
                    segments.nextToken().trim()  ) );
        }

        return list;
    };
    
    var removePrefix = function( string, prefix ) {
        return string.substr( prefix.length );
    };
    
    var removePrefixAndBuild = function( string, prefix ) {
        return build(
                string.substr( prefix.length ));
    };
    
    var removeParenthesisIfAny = function( token ){
        var effectiveToken = token.trim();
        
        if ( effectiveToken == '' ){
            return effectiveToken;
        }
        
        if ( effectiveToken.charAt( 0 ) === '(' ){
            return removeParenthesisIfAny( 
                        effectiveToken.substring( 1, effectiveToken.lastIndexOf( ')' ) ).trim() );
        }
        
        return effectiveToken;
    };
    
    var endsWith = function( str, suffix ) {
        return str.indexOf( suffix, str.length - suffix.length ) !== -1;
    };
    
    var getArgumentsFromString = function( string ) {
        
        // Parse and evaluate arguments; then push them to an array
        var tokens = new ExpressionTokenizer( 
                string, 
                context.getConf().argumentsDelimiter, 
                true );
        var args = [];
        while ( tokens.hasMoreTokens() ) {
            var currentString = tokens.nextToken().trim();
            args.push( 
                    build( currentString ) );
        }
        
        return args;
    };
    
    return {
        register: register,
        unregister: unregister,
        registerAll: registerAll,
        build: build,
        buildList: buildList,
        removePrefix: removePrefix,
        removePrefixAndBuild: removePrefixAndBuild,
        removeParenthesisIfAny: removeParenthesisIfAny,
        endsWith: endsWith,
        getArgumentsFromString: getArgumentsFromString
    };
})();

},{"../cache/expressionCache.js":26,"../context.js":27,"./arithmethic/addExpression.js":28,"./arithmethic/divideExpression.js":30,"./arithmethic/modExpression.js":31,"./arithmethic/multiplyExpression.js":32,"./arithmethic/substractExpression.js":33,"./bool/andExpression.js":34,"./bool/condExpression.js":36,"./bool/notExpression.js":37,"./bool/orExpression.js":38,"./comparison/equalsExpression.js":40,"./comparison/greaterExpression.js":41,"./comparison/inExpression.js":42,"./comparison/lowerExpression.js":43,"./existsExpression.js":45,"./expressionTokenizer.js":47,"./formatExpression.js":49,"./i18n/trCurrencyExpression.js":50,"./i18n/trDateTimeExpression.js":51,"./i18n/trNumberExpression.js":53,"./i18n/trStringExpression.js":54,"./path/pathExpression.js":63,"./scripting/javascriptExpression.js":68,"./scripting/queryExpression.js":69,"./stringExpression.js":70}],47:[function(require,module,exports){
/* 
    Class ExpressionTokenizer 
*/
module.exports = function( exp, delimiter, escape ) {
    "use strict";
    
    var expressionBuilder = require( './expressionBuilder.js' );
    var removeParenthesisIfAny = expressionBuilder.removeParenthesisIfAny;
    
    var expression = exp.trim();

    var iterator;
    var currIndex = 0;
    var delimiterCount = 0;
    var delimiters = [];
    
    var makeIterator = function( array ){
        var nextIndex = 0;
        
        return {
            next: function(){
                return nextIndex < array.length ?
                   array [ nextIndex++ ] :
                   undefined;
            },
            hasNext: function(){
                return nextIndex < array.length;
            }
        };
    };
    
    var analyze = function(){
        var avoidRepeatedSeparators = delimiter === ' ';
        
        // Go ahead and find delimiters, if any, at construction time
        var parentLevel = 0;
        var inQuote = false;
        var previousCh = '';
        
        // Scan for delimiters
        var length = expression.length;
        for ( var i = 0; i < length; i++ ) {
            var ch = expression.charAt( i );
            
            if ( ch === delimiter ) {
                // If delimiter is not buried in parentheses or a quote
                if ( parentLevel === 0 && ! inQuote  ) {
                    
                    if ( avoidRepeatedSeparators && ( previousCh === delimiter || previousCh === '\n' ) ) {
                        continue;
                    }
                    
                    var nextCh = ( i + 1 < length ) ? expression.charAt( i + 1 ) : '';
                    
                    // And if delimiter is not escaped
                    if ( ! ( escape && nextCh === delimiter ) ) {
                        delimiterCount++;
                        delimiters.push( i );
                    } else {
                        // Somewhat inefficient way to pare the
                        // escaped delimiter down to a single
                        // character without breaking our stride
                        expression = expression.substring( 0, i + 1 ) + expression.substring( i + 2 );
                        length--;
                    }
                }
            // Increment parenthesis level
            } else if ( ch === '(' || ch === '[' ) {
                parentLevel++;
                
            // Decrement parenthesis level
            } else if ( ch === ')' || ch === ']' ) {
                parentLevel--;
                // If unmatched right parenthesis
                if ( parentLevel < 0 ) {
                    throw 'Syntax error. Unmatched right parenthesis: ' + expression;
                }
                
            // Start or end quote
            } else if ( ch === '\'' ) {
                inQuote = ! inQuote;
            }
            
            previousCh = ch;
        }
        
        // If unmatched left parenthesis
        if ( parentLevel > 0 ) {
            throw 'Syntax error: unmatched left parenthesis: ' + expression;
        }
        
        // If runaway quote
        if ( inQuote ) {
            throw 'Syntax error: runaway quotation: ' + expression;
        }
        
        iterator = makeIterator( delimiters );
    }();
    
    var hasMoreTokens = function( ) {
        return currIndex < expression.length;
    };
    
    var nextToken = function( ) {
        var token;
        
        if ( iterator.hasNext() ) {
            var next = iterator.next();
            var delim = parseInt( next );
            token = expression.substring( currIndex, delim ).trim();
            currIndex = delim + 1;
            delimiterCount--;
            
            return removeParenthesisIfAny( token );
        }
        
        token = expression.substring( currIndex ).trim();
        currIndex = expression.length;
        
        return removeParenthesisIfAny( token );
    };
        
    var countTokens = function( ) {
        if ( hasMoreTokens() ) {
            return delimiterCount + 1;
        }
        return 0;
    };
    
    var nextTokenIfAny = function( defaultValue ) {
        return hasMoreTokens()? nextToken(): defaultValue;
    };
    
    return {
        hasMoreTokens: hasMoreTokens,
        nextToken: nextToken,
        countTokens: countTokens,
        nextTokenIfAny: nextTokenIfAny
    };
};

},{"./expressionBuilder.js":46}],48:[function(require,module,exports){
/* 
    expressionsUtils singleton class
*/
"use strict";

var evaluateHelper = require( './evaluateHelper.js' );
var utils = require( '../utils.js' );
var DepsDataItem = require( '../parsers/depsDataItem.js' );

module.exports = (function() {
    
    var buildLiteral = function( value ) {
        return evaluateHelper.isNumber( value )? "" + value: "'" + value + "'";
    };
    
    var buildList = function( items, asStrings ) {
        
        var result = '[';
        var separator = asStrings? "'": "";
        
        for ( var i = 0; i < items.length; i++ ) {
            result += separator + items[ i ] + separator + " ";
        }
        
        result += ']';
        return result;
    };
    
    var buildDependsOnList = function(){
        
        var result = [];
        
        var depsDataItem = arguments[ 0 ];
        if ( ! depsDataItem ){
            depsDataItem = new DepsDataItem();
        }
        
        var scope = arguments[ 1 ];
        
        for ( var argCounter = 2; argCounter < arguments.length; argCounter++ ){
            var list = arguments[ argCounter ];
            result = result.concat( 
                getDependsOnFromList( depsDataItem, scope, list )
            );
        }
        
        return result;
    };
    
    var getDependsOnFromList = function( depsDataItem, scope, arg ){
        
        var result = [];
        
        if ( ! arg ){
            return result;
        }
        
        if ( ! Array.isArray( arg ) ){
            return getDependsOnFromNonList( depsDataItem, scope, arg );
        }
        
        var list = arg;
        for ( var i = 0; i < list.length; i++ ) {
            var item = list[ i ];
            result = result.concat( 
                Array.isArray( item )? getDependsOnFromList( scope, item ): getDependsOnFromNonList( depsDataItem, scope, item )
            );
        }

        return result;
    };
    
    var getDependsOnFromNonList = function( depsDataItem, scope, item ){
        
        return ! utils.isFunction( item.dependsOn ) || ( utils.isFunction( item.getVarName ) && depsDataItem === item.getVarName() )? 
            []: 
            item.dependsOn( depsDataItem, scope );
    };
    
    return {
        buildLiteral: buildLiteral,
        buildList: buildList,
        buildDependsOnList: buildDependsOnList
    };
})();

},{"../parsers/depsDataItem.js":77,"../utils.js":101,"./evaluateHelper.js":44}],49:[function(require,module,exports){
/*
    FormatExpression class
*/
"use strict";

var utils = require( '../utils.js' );
var context = require( '../context.js' );
var ExpressionTokenizer = require( './expressionTokenizer.js' );
var expressionsUtils = require( './expressionsUtils.js' );
var evaluateHelper = require( './evaluateHelper.js' );

var FormatExpression = function( stringToApply, formatterExpressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var formatterExpression = formatterExpressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        
        // Get formatter
        var formatter = evaluateFormatter( scope, formatterExpression );
        
        // Get arguments
        var args = evaluateHelper.evaluateExpressionList( argsExpressions, scope );
        
        return formatter.apply( formatter, args );
    };
    
    var evaluateFormatter = function( scope, expression ) {
        
        // Try to get a built-in formatter
        var formatter = context.getFormatter( expression );
        
        // Try to get a function with a name
        if ( ! isValidFormatter( formatter ) ){
            formatter = scope.get( expression );
        }
    
        // Try to get a function evaluating the expression
        if ( ! isValidFormatter( formatter ) ){
            try {
                var expressionBuilder = require( './expressionBuilder.js' );
                var formatterExpression = expressionBuilder.build( expression );
                var value = formatterExpression.evaluate( scope );
                
                return evaluateFormatter( scope, value );

            } catch( e ){
                // Nothing to do
            }
        }
        
        // Return the formatter only if it is valid
        if ( isValidFormatter( formatter ) ){
            return formatter;
        }
        
        throw 'No valid formatter found: ' + string;
    };
    
    var isValidFormatter = function( formatter ){
        return formatter && utils.isFunction( formatter );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, formatterExpression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

FormatExpression.removePrefix = true;
FormatExpression.getPrefix = function() {
    return context.getConf().formatExpression;
};
FormatExpression.getId = FormatExpression.getPrefix;

FormatExpression.build = function( s ) {
    var expressionBuilder = require( './expressionBuilder.js' );
    
    var string = s.trim();
    if ( string.length === 0 ) {
        throw 'Format expression void.';
    }

    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            false );
    var numberOfTokens = segments.countTokens();
    if ( numberOfTokens === 1 ) {
        throw 'Only one element in format expression: "' + string + '". Please add at least one more.';
    }

    // Get formatter
    var formatter = segments.nextToken().trim();

    // Get arguments
    var argsExpressions = [];
    while ( segments.hasMoreTokens() ) {
        var argExpression = expressionBuilder.build( segments.nextToken() );
        argsExpressions.push( argExpression );
    }

    return new FormatExpression( string, formatter, argsExpressions );
};

module.exports = FormatExpression;

},{"../context.js":27,"../utils.js":101,"./evaluateHelper.js":44,"./expressionBuilder.js":46,"./expressionTokenizer.js":47,"./expressionsUtils.js":48}],50:[function(require,module,exports){
/*
    TrCurrencyExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrCurrencyExpression = function( stringToApply, expressionToApply, argsExpressionsToApply, subformatToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    var subformat = subformatToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'currency', 
                subformat );
        return evaluated;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrCurrencyExpression.removePrefix = true;
TrCurrencyExpression.getPrefix = function() {
    return context.getConf().trCurrencyExpression;
};
TrCurrencyExpression.getId = TrCurrencyExpression.getPrefix;

TrCurrencyExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrCurrencyExpression.getPrefix(), 
            2, 
            3, 
            true );

    return new TrCurrencyExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions, 
            trData.subformat );
};

module.exports = TrCurrencyExpression;

},{"../../context.js":27,"./trHelper.js":52}],51:[function(require,module,exports){
/*
    TrDateTimeExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrDateTimeExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'datetime', 
                null );
        return evaluated;
    };

    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrDateTimeExpression.removePrefix = true;
TrDateTimeExpression.getPrefix = function() {
    return context.getConf().trDateTimeExpression;
};
TrDateTimeExpression.getId = TrDateTimeExpression.getPrefix;

TrDateTimeExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrDateTimeExpression.getPrefix(), 
            1, 
            2, 
            false );

    return new TrDateTimeExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions );
};

module.exports = TrDateTimeExpression;

},{"../../context.js":27,"./trHelper.js":52}],52:[function(require,module,exports){
/* 
    trHelper singleton class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var i18nHelper = require( '../../i18n/i18nHelper.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var VariableExpression = require( '../path/variableExpression.js' );

module.exports = (function() {
    
    var build = function( string, tag, minElements, maxElements, useSubformat ) {
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        if ( string.length === 0 ) {
            throw tag + ' expression void.';
        }

        var segments = new ExpressionTokenizer( 
                string.trim(), 
                context.getConf().expressionDelimiter, 
                false );
        
        // Check number of tokens
        var count = segments.countTokens();
        if ( count < minElements ) {
            throw 'Too few elements in ' + tag + ' expression (minimum is ' + minElements 
                    + ', ' + count + ' present): ' + string.trim();
        }
        if ( count > maxElements ) {
            throw 'Too many elements in ' + tag + ' expression (maximum is ' + maxElements 
                    + ', ' + count + ' present):' + string.trim();
        }
        
        // Get tokens
        var subformat = useSubformat? 
                expressionBuilder.build( segments.nextToken() ): 
                undefined;
        var expression = expressionBuilder.build( 
                segments.nextToken().trim() );
        var argsSegment = segments.hasMoreTokens()? 
                segments.nextToken().trim(): 
                undefined;
        
        return {
            expression: expression,
            argsExpressions: buildI18nArgs( argsSegment ),
            subformat: subformat
        };
    };
    
    var buildI18nArgs = function( segment ){
        var expressionBuilder = require( '../expressionBuilder.js' );
        
        var args = {};
        if ( ! segment ){
            return args;
        }
        var tokens = new ExpressionTokenizer( 
                segment, 
                context.getConf().i18nOptionsDelimiter, 
                true
        );
        while ( tokens.hasMoreTokens() ) {
            var token = tokens.nextToken().trim();
            var argsTokens = new ExpressionTokenizer( 
                    token, 
                    context.getConf().inI18nOptionsDelimiter, 
                    true 
            );
            if ( argsTokens.countTokens() !== 2 ) {
                throw '2 elements are needed in i18n expression.';
            }
            
            var argKey = argsTokens.nextToken().trim();
            var argExpression = expressionBuilder.build( 
                    argsTokens.nextToken().trim() );
            args[ argKey ] = argExpression;
        }
        return args;
    };
    
    var evaluateI18nArgs = function( scope, i18nArgs ){
        var values = {};
        
        for ( var argKey in i18nArgs ) {
            var argExpression = i18nArgs[ argKey ];
            var argValue = evaluateHelper.evaluateToNotNull( scope, argExpression );
            values[ argKey ] = argValue;
        }
        
        return values;
    };
    
    var evaluate = function( scope, valueExpression, argsExpressions, format, subformat ) {
        var argValues = evaluateI18nArgs( scope, argsExpressions );
        var subformatEvaluated = 
                subformat? 
                evaluateHelper.evaluateToNotNull( scope, subformat ): 
                undefined;
        var valueEvaluated = evaluateHelper.evaluateToNotNull( scope, valueExpression );
        var evaluated = translate( 
                scope, 
                valueEvaluated, 
                argValues, 
                format, 
                subformatEvaluated );
        
        return evaluated;
    };
    
    var translate = function( scope, id, i18nArgs, format, subformat ){
        
        var i18nList = scope.get( context.getConf().i18nDomainVarName );
        var language = scope.get( context.getConf().i18nLanguageVarName );
        return i18nHelper.tr( 
            i18nList, 
            id, 
            i18nArgs, 
            format, 
            subformat,
            language 
        );
    };
    
    var dependsOn = function( depsDataItem, scope, expression, argsExpressions ){
        
        return expressionsUtils.buildDependsOnList( 
            depsDataItem, 
            scope, 
            new VariableExpression( context.getConf().i18nDomainVarName ),
            new VariableExpression( context.getConf().i18nLanguageVarName ),
            expression, 
            argsExpressions
        );
    };
    
    return {
        build: build,
        evaluate: evaluate,
        dependsOn: dependsOn
    };
})();

},{"../../context.js":27,"../../i18n/i18nHelper.js":73,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"../path/variableExpression.js":67}],53:[function(require,module,exports){
/*
    TrNumberExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrNumberExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'number', 
                null 
        );
        return evaluated;
    };

    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrNumberExpression.removePrefix = true;
TrNumberExpression.getPrefix = function() {
    return context.getConf().trNumberExpression;
};
TrNumberExpression.getId = TrNumberExpression.getPrefix;

TrNumberExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrNumberExpression.getPrefix(), 
            1, 
            2, 
            false 
    );

    return new TrNumberExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions 
    );
};

module.exports = TrNumberExpression;

},{"../../context.js":27,"./trHelper.js":52}],54:[function(require,module,exports){
/*
    TrStringExpression class
*/
"use strict";

var context = require( '../../context.js' );
var trHelper = require( './trHelper.js' );

var TrStringExpression = function( stringToApply, expressionToApply, argsExpressionsToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    var argsExpressions = argsExpressionsToApply;
    
    var evaluate = function( scope ){
        var evaluated = trHelper.evaluate( 
                scope, 
                expression, 
                argsExpressions, 
                'string', 
                null 
        );
        return evaluated;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return trHelper.dependsOn( depsDataItem, scope, expression, argsExpressions );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

TrStringExpression.removePrefix = true;
TrStringExpression.getPrefix = function() {
    return context.getConf().trExpression;
};
TrStringExpression.getId = TrStringExpression.getPrefix;

TrStringExpression.build = function( string ) {
    
    var trData = trHelper.build( 
            string,
            TrStringExpression.getPrefix(), 
            1, 
            2, 
            false 
    );

    return new TrStringExpression( 
            string, 
            trData.expression, 
            trData.argsExpressions 
    );
};

module.exports = TrStringExpression;

},{"../../context.js":27,"./trHelper.js":52}],55:[function(require,module,exports){
/*
    ArrayExpression class
*/
"use strict";

var expressionsUtils = require( '../expressionsUtils.js' );

var ArrayExpression = function( arrayBaseToApply, indexesToApply ) {
    
    var arrayBase = arrayBaseToApply;
    var indexes = indexesToApply;
    
    var evaluate = function( scope ){
        
        // Evaluate and check array bases and indexes
        var evaluatedArrayBase = arrayBase.evaluate( scope );

        // Iterate indexes
        var result = evaluatedArrayBase;
        for ( var i = 0; i < indexes.length; i++ ) {
            
            // Get and evaluate index as integer
            var indexExpression = indexes[ i ];

            // Evaluate array access
            result = result[ indexExpression.evaluate( scope ) ];
        }
        
        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        // Build the arrayBaseDependsOn
        var arrayBaseDependsOn = expressionsUtils.buildDependsOnList( depsDataItem, scope, arrayBase );
        
        // This must be rare!
        if ( arrayBaseDependsOn.length === 0 ){
            return [];
        } else if ( arrayBaseDependsOn.length > 1 ){
            return expressionsUtils.buildDependsOnList( depsDataItem, scope, arrayBase, indexes );
        }
        
        // Join all together
        var dep = arrayBaseDependsOn[ 0 ];
        for ( var i = 0; i < indexes.length; ++i ){
            var indexExpression = indexes[ i ];
            var indexEvaluated = indexExpression.evaluate( scope );
            dep += '[' + indexEvaluated + ']';
        }
        
        return [ dep ];
    };
    
    var toString = function(){
        return arrayBase + '[' + indexes + ']';
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ArrayExpression.build = function( arrayBase, accessor ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var indexes = [];
    
    var done = false;
    while ( ! done ){

        // Array accessor must begin and end with brackets
        var close = accessor.indexOf( ']' );
        if ( accessor.charAt( 0 ) !== '[' || close === -1 ) {
            throw 'Bad array accessor: '  + accessor;
        }

        // Get index and add to indexes
        var index = expressionBuilder.build( 
                accessor.substring( 1, close ) 
        );
        indexes.push( index );

        // continue processing array access for multidimensional arrays
        close++;
        if ( accessor.length > close ) {
            accessor = accessor.substring( close );
        } else {
            done = true;
        }
    }
    
    return new ArrayExpression( arrayBase, indexes );
};

ArrayExpression.buildArrayData = function( token ) {
    
    var bracket = ArrayExpression.findArrayAccessor( token );
    
    if ( bracket <= 0 ) {
        return undefined;
    }
    
    return {
        arrayAccessor: token.substring( bracket ).trim(),
        token: token.substring( 0, bracket ).trim()
    };
};

ArrayExpression.findArrayAccessor = function( token ) {
    var SCANNING = 0;
    var IN_PAREN = 1;
    var IN_QUOTE = 2;

    var length = token.length;
    var state = SCANNING;
    var parenDepth = 0;
    for ( var i = 0; i < length; i++ ) {
        var ch = token.charAt( i );
        switch( state ) {
        case IN_PAREN:
            if ( ch === ')' ) {
                parenDepth--;
                if ( parenDepth === 0 ) {
                    state = SCANNING;
                }
            } else if ( ch === '(' ) {
                parenDepth++;
            }
            break;

        case IN_QUOTE:
            if ( ch === '\'' ) {
                state = SCANNING;
            }
            break;

        case SCANNING:
            if ( ch === '\'' ) {
                state = IN_QUOTE;
            } else if ( ch === '(' ) {
                parenDepth++;
                state = IN_PAREN;
            } else if ( ch === '[' ) {
                return i;
            }
        }
    }

    return -1;
};

module.exports = ArrayExpression;

},{"../expressionBuilder.js":46,"../expressionsUtils.js":48}],56:[function(require,module,exports){
/*
    FunctionExpression class
*/
"use strict";

var evaluateHelper = require( '../evaluateHelper.js' );

var FunctionExpression = function( stringToApply, nameToApply, argsToApply ) {
    
    var string = stringToApply;
    var name = nameToApply;
    var args = argsToApply;
    
    var evaluate = function( scope ){
        var evaluatedArgs = evaluateHelper.evaluateExpressionList( args, scope );
        var element = scope.get( name );
        return ! element? undefined: element.apply( element, evaluatedArgs );
    };

    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

FunctionExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var leftParent = string.indexOf( '(' );
    if ( leftParent === -1 ) {
        return undefined;
    }
    
    if ( ! expressionBuilder.endsWith( string, ')' ) ) {
        throw 'Syntax error. Bad function call: ' + string;
    }
    var functionName = string.substring( 0, leftParent ).trim();
    var argsString = string.substring( leftParent + 1, string.length - 1 );
    var args = expressionBuilder.getArgumentsFromString( argsString );

    return new FunctionExpression( string, functionName, args );
};

module.exports = FunctionExpression;

},{"../evaluateHelper.js":44,"../expressionBuilder.js":46}],57:[function(require,module,exports){
/*
    IndirectionExpression class
*/
"use strict";

var IndirectionExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope, parent ){
        return parent[ scope.get( name ) ];
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return '?' + name;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

IndirectionExpression.build = function( string ) {
    
    if ( string.charAt( 0 ) !== '?' ) {
        return undefined;
    }
    
    return new IndirectionExpression( string.substring( 1 ) );
};

module.exports = IndirectionExpression;

},{}],58:[function(require,module,exports){
/*
    ListExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var RangeExpression = require( './rangeExpression.js' );

var ListExpression = function( stringToApply, itemsToApply ) {
    
    var string = stringToApply;
    var items = itemsToApply;
    
    var evaluate = function( scope ){
        
        var result = [];
        
        for ( var i = 0; i < items.length; i++ ) {
            var expression = items[ i ];
            var evaluated = expression.evaluate( scope );
            
            if ( Array.isArray( evaluated ) ){ 
                result = result.concat( evaluated );
            } else {
                result.push( evaluated );
            }
        }

        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, items );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

ListExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    if ( s.charAt( 0 ) !== '[' || s.charAt( s.length - 1 ) !==  ']' ) {
        return undefined;
    }
    
    var string = s.substring( 1, s.length - 1 );
    var items = [];
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().expressionDelimiter, 
            true );

    while ( segments.hasMoreTokens() ) {
        var segment = segments.nextToken().trim();
        var range = RangeExpression.build( segment );

        items.push(
            range?
            range:
            expressionBuilder.build( segment )
        );
    }

    return new ListExpression( string, items );
};

module.exports = ListExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./rangeExpression.js":66}],59:[function(require,module,exports){
/*
    BooleanLiteral class
*/
"use strict";

var BooleanLiteral = function( literalToApply ) {

    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var toString = function(){
        return "" + literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

BooleanLiteral.build = function( string ) {
    
    if ( 'true' === string ) {
        return new BooleanLiteral( true );
    }
    if ( 'false' === string ) {
        return new BooleanLiteral( false );
    }
    return undefined;
};

module.exports = BooleanLiteral;

},{}],60:[function(require,module,exports){
/*
    NumericLiteral class
*/
"use strict";

var NumericLiteral = function( literalToApply ) {
    
    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return literal;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

NumericLiteral.build = function( string ) {
    
    if ( isFinite( string ) ){
        var integerValue = parseInt( string );
        if ( integerValue == string ){
            return new NumericLiteral( integerValue );
        }

        var floatValue = parseFloat( string );
        if ( floatValue == string ){
            return new NumericLiteral( floatValue );
        }
    }

    return undefined;
};

module.exports = NumericLiteral;

},{}],61:[function(require,module,exports){
/*
    StringLiteral class
*/
"use strict";

var StringLiteral = function( literalToApply ) {

    var literal = literalToApply;
    
    var evaluate = function( scope ){
        return literal;
    };
    
    var dependsOn = function(){
        return [];
    };
    
    var toString = function(){
        return literal;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

StringLiteral.build = function( string ) {
    
    if ( string.charAt( 0 ) === "'" && string.charAt( string.length - 1 ) ===  "'" ) {
        return new StringLiteral( 
            string.substring( 1, string.length - 1 ) );
    }

    return undefined;
};

module.exports = StringLiteral;

},{}],62:[function(require,module,exports){
/*
    MethodExpression class
*/
"use strict";

var evaluateHelper = require( '../evaluateHelper.js' );

var MethodExpression = function( stringToApply, nameToApply, argsToApply ) {
    
    var string = stringToApply;
    var name = nameToApply;
    var args = argsToApply;
    
    var evaluate = function( scope, parent ){
        var evaluatedArgs = evaluateHelper.evaluateExpressionList( args, scope );
        return parent[ name ].apply( parent, evaluatedArgs );
    };

    var dependsOn = function(){
        return undefined;
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

MethodExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var leftParent = string.indexOf( '(' );
    if ( leftParent === -1 ) {
        return undefined;
    }
    
    if ( ! expressionBuilder.endsWith( string, ')' ) ) {
        throw 'Syntax error. Bad method call: ' + string;
    }
    
    var methodName = string.substring( 0, leftParent ).trim();
    var argsString = string.substring( leftParent + 1, string.length - 1 );
    var args = expressionBuilder.getArgumentsFromString( argsString );
    
    return new MethodExpression( string, methodName, args );
};

module.exports = MethodExpression;

},{"../evaluateHelper.js":44,"../expressionBuilder.js":46}],63:[function(require,module,exports){
/*
    PathExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var StringLiteral = require( './literals/stringLiteral.js' );
var PathSegmentExpression = require( './pathSegmentExpression.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var PathExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){

        var exception = undefined;
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            try {
                var expression = expressionList[ i ];
                var result = expression.evaluate( scope );
                if ( result != null ){
                    return result;
                }
            } catch( e ) {
                exception = e;
            }
        }
        
        if ( exception ) {
            throw exception;
        }
        
        return null;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PathExpression.removePrefix = false;
PathExpression.getPrefix = function() {
    return context.getConf().pathExpression;
};
PathExpression.getId = function() { 
    return 'path';
};

PathExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var string = s.trim();
    
    // Blank expression evaluates to blank string
    if ( string.length === 0 ) {
        return StringLiteral.build( '' );
    }
    
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().pathDelimiter, 
            false );

    // If there is only 1 must be a path segment
    if ( segments.countTokens() === 1 ) {
        return PathSegmentExpression.build( string );
    }

    // If there are more than 1 they can be any expression instance
    var expressionList = [];
    while ( segments.hasMoreTokens() ) {
        var nextToken = segments.nextToken();
        if ( ! nextToken ){
            throw 'Null token inside path expression: ' + string;
        }
        expressionList.push( 
            expressionBuilder.build( 
                nextToken
            ) 
        );
    }
    return new PathExpression( string, expressionList );
};

module.exports = PathExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./literals/stringLiteral.js":61,"./pathSegmentExpression.js":64}],64:[function(require,module,exports){
/*
    PathSegmentExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var ArrayExpression = require( './arrayExpression.js' );
var StringLiteral = require( './literals/stringLiteral.js' );
var NumericLiteral = require( './literals/numericLiteral.js' );
var BooleanLiteral = require( './literals/booleanLiteral.js' );
var ListExpression = require( './listExpression.js' );
var FunctionExpression = require( './functionExpression.js' );
var VariableExpression = require( './variableExpression.js' );
var IndirectionExpression = require( './indirectionExpression.js' );
var MethodExpression = require( './methodExpression.js' );
var PropertyExpression = require( './propertyExpression.js' );

var PathSegmentExpression = function( stringToApply, itemsToApply ) {
    
    var string = stringToApply;
    var items = itemsToApply;
    
    var evaluate = function( scope ){
        
        var token = items[ 0 ];
        var result = token.evaluate( scope );
        for ( var i = 1; i < items.length; i++ ) {
            // Only last element can be null
            if ( result == null ) {
                throw 'Error evaluating "' + string + '": "'  + token + '" is null';
            }
            token = items[ i ];
            result = token.evaluate( scope, result );
        }
        
        return result;
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        var firstSegmentDependsOn = expressionsUtils.buildDependsOnList( depsDataItem, scope, items[ 0 ] );
        if ( firstSegmentDependsOn.length === 0 ){
            return [];
        } else if ( firstSegmentDependsOn.length > 1 ){
            return firstSegmentDependsOn;
        }
        
        var temp = firstSegmentDependsOn[ 0 ];
        var result = [ temp ];
        for ( var i = 1; i < items.length; i++ ) {
            var token = items[ i ];
            var tokenDependsOn = token.dependsOn( temp );
            if ( ! tokenDependsOn ){
                break;
                //return temp;
            }
            
            temp += tokenDependsOn;
            result.push( temp );
        }
        
        return result;
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PathSegmentExpression.build = function( string ) {
    
    var items = [];
    
    // Blank expression evaluates to blank string
    if ( string.length === 0 ) {
        items.push( 
            StringLiteral.build( '' ) );
        return items;
    }

    // Build first token
    var path = new ExpressionTokenizer( 
            string, 
            context.getConf().pathSegmentDelimiter, 
            false );
    var token = path.nextToken().trim();
    items.push(
            PathSegmentExpression.buildFirstPathToken( token ) );

    // Traverse the path
    while ( path.hasMoreTokens() ) {
        token = path.nextToken().trim();
        items.push(
            PathSegmentExpression.buildNextPathToken( token ) );
    }
    
    return new PathSegmentExpression( string, items );
};

PathSegmentExpression.buildFirstPathToken = function( t ){

    // Separate identifier from any array accessors
    var arrayData = ArrayExpression.buildArrayData( t );
    var arrayAccessor = arrayData? arrayData.arrayAccessor: undefined;
    var token = arrayData? arrayData.token: t;

    // First token must come from dictionary or be a literal

    // First see if it's a string literal
    var result = StringLiteral.build( token );

    // If it's not, try to see if it's a number
    if ( result === undefined ) {
        result = NumericLiteral.build( token );

        // Maybe it's a boolean literal
        if ( result === undefined ) {
            result = BooleanLiteral.build( token );

            // A list?
            if ( result === undefined ){
                result = ListExpression.build( token );

                // A function call?
                if ( result === undefined ) {
                    result = FunctionExpression.build( token );

                    // Must be an object in scope
                    if ( result === undefined ) {
                        result = VariableExpression.build( token );
                        
                        // Not recognized expression
                        if ( result === undefined ) {
                            throw 'Unknown expression: ' + token;
                        }
                    }
                }
            }
        }
    }

    if ( arrayAccessor !== undefined ) {
        result = ArrayExpression.build( result, arrayAccessor );
    }

    return result;
};

PathSegmentExpression.buildNextPathToken = function( t ){
    
    // Separate identifier from any array accessors
    var arrayData = ArrayExpression.buildArrayData( t );
    var arrayAccessor = arrayData? arrayData.arrayAccessor: undefined;
    var token = arrayData? arrayData.token: t;

    // Test for indirection
    var result = IndirectionExpression.build( token );
    
    // A method call?
    if ( result === undefined ) {
        result = MethodExpression.build( token );

        // A property
        if ( result === undefined ) {
            result = PropertyExpression.build( token );
        }
    }

    if ( arrayAccessor !== undefined ) {
        result = ArrayExpression.build( result, arrayAccessor );
    }

    return result;
};

module.exports = PathSegmentExpression;

},{"../../context.js":27,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./arrayExpression.js":55,"./functionExpression.js":56,"./indirectionExpression.js":57,"./listExpression.js":58,"./literals/booleanLiteral.js":59,"./literals/numericLiteral.js":60,"./literals/stringLiteral.js":61,"./methodExpression.js":62,"./propertyExpression.js":65,"./variableExpression.js":67}],65:[function(require,module,exports){
/*
    PropertyExpression class
*/
"use strict";

var PropertyExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope, parent ){
        return parent[ name ];
    };
    
    var dependsOn = function( parent ){
        return '.' + name;
    };
    
    var toString = function(){
        return name;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

PropertyExpression.build = function( string ) {
    return new PropertyExpression( string );
};

module.exports = PropertyExpression;

},{}],66:[function(require,module,exports){
/*
    RangeExpression class
*/
"use strict";

var context = require( '../../context.js' );
var ExpressionTokenizer = require( '../expressionTokenizer.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var evaluateHelper = require( '../evaluateHelper.js' );
var NumericLiteral = require( './literals/numericLiteral.js' );

var RangeExpression = function( stringToApply, startExpressionToApply, endExpressionToApply, stepExpressionToApply ) {
    
    var string = stringToApply;
    var startExpression = startExpressionToApply;
    var endExpression = endExpressionToApply;
    var stepExpression = stepExpressionToApply;
    
    var evaluate = function( scope ){
        
        // Evaluate all expressions
        var start = evaluateHelper.evaluateNumber( scope, startExpression );
        var end = evaluateHelper.evaluateNumber( scope, endExpression );
        var step = evaluateHelper.evaluateNumber( scope, stepExpression );
        
        // The range is valid, evaluate it
        var result = [];
        var forward = step > 0; 
        
        var c = start;
        while( forward? c <= end: c >= end ){
            result.push( c );
            c += step;
        }
        
        return result;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, startExpression, endExpression, stepExpression );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

RangeExpression.build = function( s ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    if ( ! s ) {
        return undefined;
    }

    var string = s.trim();
    
    // If it contains spaces it is not a valid range
    if ( string.indexOf( ' ' ) !== -1 ) {
        return undefined;
    }
    
    var segments = new ExpressionTokenizer( 
            string, 
            context.getConf().intervalDelimiter, 
            false );

    var numberOfTokens = segments.countTokens();
    if ( numberOfTokens !== 2 && numberOfTokens !== 3 ) {
        return undefined;
    }

    var RANGE_DEFAULT_START = 0;
    var RANGE_DEFAULT_STEP = 1;
    
    // Build start expression
    var start = segments.nextToken().trim();
    var startExpression = start == ''? 
            NumericLiteral.build( RANGE_DEFAULT_START ): 
            expressionBuilder.build( start );

    // Build end expression
    var endExpression = expressionBuilder.build( segments.nextToken() );

    // Build step expression
    var stepExpression = numberOfTokens === 3? 
            expressionBuilder.build( segments.nextToken() ):
            NumericLiteral.build( RANGE_DEFAULT_STEP );
    
    return new RangeExpression( string, startExpression, endExpression, stepExpression );
};

module.exports = RangeExpression;

},{"../../context.js":27,"../evaluateHelper.js":44,"../expressionBuilder.js":46,"../expressionTokenizer.js":47,"../expressionsUtils.js":48,"./literals/numericLiteral.js":60}],67:[function(require,module,exports){
/*
    VariableExpression class
*/
"use strict";

var context = require( '../../context.js' );

var VariableExpression = function( nameToApply ) {
    
    var name = nameToApply;
    
    var evaluate = function( scope ){
        
        if ( ! scope.isValidVariable( name ) ){
            throw 'Not declared variable found using strict mode:' + name;
        }
        
        return scope.get( name );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        
        if ( ! depsDataItem.mustAddVar( name ) ){
            return [];
        }
        
        var expression = scope.getVarExpression( name );
        if ( ! expression ){
            depsDataItem.add1NonExpressionVar( name );
            return [ name ];
        }
        
        depsDataItem.add1ExpressionVar( name );
        var result = expression.dependsOn( depsDataItem, scope );
        depsDataItem.addAllVars( result, scope );
        return result;
    };
    
    var getVarName = function(){
        return name;
    };
    
    var toString = function(){
        return name;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        getVarName: getVarName,
        toString: toString
    };
};

VariableExpression.build = function( string ) {
    
    return context.getConf().variableNameRE.test( string )?
        new VariableExpression( string ):
        undefined;
};

module.exports = VariableExpression;

},{"../../context.js":27}],68:[function(require,module,exports){
/*
    JavascriptExpression class
*/
"use strict";

var context = require( '../../context.js' );
var expressionsUtils = require( '../expressionsUtils.js' );
var StringExpression = require( '../stringExpression.js' );

var JavascriptExpression = function( expressionToApply ) {
    
    var stringExpression = expressionToApply;
    
    var evaluate = function( scope ){
        var evaluatedString = stringExpression.evaluate( scope );
        return eval( evaluatedString );
    };
    
    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, stringExpression );
    };
    
    var toString = function(){
        return stringExpression;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

JavascriptExpression.removePrefix = true;

JavascriptExpression.getPrefix = function() {
    if ( JavascriptExpression.prefix === undefined ){
        JavascriptExpression.prefix = context.getConf().javaScriptExpression;
    }
    return JavascriptExpression.prefix;
};

JavascriptExpression.getId = JavascriptExpression.getPrefix;

JavascriptExpression.build = function( string ) {
    return new JavascriptExpression(
            StringExpression.build( string ) );
};

module.exports = JavascriptExpression;

},{"../../context.js":27,"../expressionsUtils.js":48,"../stringExpression.js":70}],69:[function(require,module,exports){
/*
    QueryExpression class
*/
"use strict";

var context = require( '../../context.js' );
var expressionsUtils = require( '../expressionsUtils.js' );

var QueryExpression = function( stringToApply, expressionToApply ) {
    
    var string = stringToApply;
    var expression = expressionToApply;
    
    var evaluate = function( scope ){
        
        try {
            var evaluated = expression.evaluate( scope );
            var elementList = window.document.querySelectorAll( evaluated );
            
            // elementList with length 1
            if ( elementList.length === 1 ){
                return elementList[ 0 ].innerText;
            }
            
            // elementList with length > 1
            var texts = [];
            for ( var i = 0; i < elementList.length; ++i ){
                texts.push( elementList[ i ].innerText );
            }
            return texts;
            
        } catch ( e ){
            return 'Query expression error in "' + string + '": ' + e;
        }
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expression );
    };
    
    var toString = function(){
        return string;
    };

    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

QueryExpression.removePrefix = true;
QueryExpression.getPrefix = function() {
    return context.getConf().queryExpression;
};
QueryExpression.getId = QueryExpression.getPrefix;

QueryExpression.build = function( string ) {
    var expressionBuilder = require( '../expressionBuilder.js' );
    
    var expression = expressionBuilder.build( string );
    
    return new QueryExpression( string, expression );
};

module.exports = QueryExpression;

},{"../../context.js":27,"../expressionBuilder.js":46,"../expressionsUtils.js":48}],70:[function(require,module,exports){
/*
    StringExpression class
*/
"use strict";

var context = require( '../context.js' );
var StringLiteral = require( './path/literals/stringLiteral.js' );
var PathExpression = require( './path/pathExpression.js' );
var expressionsUtils = require( './expressionsUtils.js' );

var StringExpression = function( stringToApply, expressionListToApply ) {
    
    var string = stringToApply;
    var expressionList = expressionListToApply;
    
    var evaluate = function( scope ){
        
        var result = '';
        
        for ( var i = 0; i < expressionList.length; i++ ) {
            var expression = expressionList[ i ];
            result += expression.evaluate( scope );
        }
        
        return result;
    };

    var dependsOn = function( depsDataItem, scope ){
        return expressionsUtils.buildDependsOnList( depsDataItem, scope, expressionList );
    };
    
    var toString = function(){
        return string;
    };
    
    return {
        evaluate: evaluate,
        dependsOn: dependsOn,
        toString: toString
    };
};

StringExpression.removePrefix = true;
StringExpression.getPrefix = function() {
    return context.getConf().stringExpression;
};
StringExpression.getId = StringExpression.getPrefix;

StringExpression.build = function( string ) {
    var STATE_SCANNING = 0;
    var STATE_AT_DOLLAR = 1;
    var STATE_IN_EXPRESSION = 2;
    var STATE_IN_BRACKETED_EXPRESSION = 3;

    var expressionList = [];
    var literal = '';
    var subexpression = '';
    var state = STATE_SCANNING;

    for ( var i = 0; i < string.length; i++ ) {
        var ch = string.charAt( i );

        switch ( state ) {
                
        // In the string part of the expression
        case STATE_SCANNING:
            // Found a dollar sign
            if ( ch === '$' ) {
                state = STATE_AT_DOLLAR;
                
            // Just keep appending to buffer
            } else {
                literal += ch;
            }
            break;

        // Next character after dollar sign
        case STATE_AT_DOLLAR:
            // An escaped dollar sign
            if ( ch === '$' ) {
                literal += '$';
                state = STATE_SCANNING;
                
            // Beginning of a bracketed expression
            } else if ( ch === '{' ) {
                // Reset subexpression and change state
                subexpression = '';
                state = STATE_IN_BRACKETED_EXPRESSION;

                // Add literal and reset it if needed
                if ( literal ){
                    expressionList.push( 
                            new StringLiteral( literal ) 
                    );
                    literal = '';
                }
                
            // Beginning of a non bracketed expression
            } else {
                subexpression += ch;
                state = STATE_IN_EXPRESSION;
                
                // Add literal and reset it if needed
                if ( literal ){
                    expressionList.push( 
                            new StringLiteral( literal )
                    );
                    literal = '';
                }
            }
            break;

        // In subexpression
        case STATE_IN_BRACKETED_EXPRESSION:
        case STATE_IN_EXPRESSION:
            // Check for end
            if ( ( state === STATE_IN_BRACKETED_EXPRESSION && ch === '}' )
                    || ( state === STATE_IN_EXPRESSION && ch == ' ' ) ) {
                expressionList.push( 
                        PathExpression.build( subexpression ) 
                );

                if ( state === STATE_IN_EXPRESSION ) {
                    literal += ch;
                }
                state = STATE_SCANNING;
                
            // Keep appending to subexpression
            } else {
                subexpression += ch;
            }
        }
    }

    // Ended in unclosed bracket
    if ( state === STATE_IN_BRACKETED_EXPRESSION ) {
        throw 'Unclosed left curly brace: ' + string;
        
    // Ended at expression
    } else if ( state == STATE_IN_EXPRESSION ) {
        expressionList.push( 
                PathExpression.build( subexpression ) 
        );
    }

    if ( literal ){
        expressionList.push( 
                new StringLiteral( literal ) 
        );
    }

    return new StringExpression( string, expressionList );
};

module.exports = StringExpression;

},{"../context.js":27,"./expressionsUtils.js":48,"./path/literals/stringLiteral.js":61,"./path/pathExpression.js":63}],71:[function(require,module,exports){
/* 
    I18n class 
    External dependencies: Intl (supported by recent browsers) and MessageFormat
*/
module.exports = function( languageId, res ) {
    "use strict";
    
    var MessageFormat = require( 'messageformat' );
    var context = require( '../context.js' );
    var utils = require( '../utils.js' );
    
    var resources = res;
    var mf = new MessageFormat( languageId );
    var cache = {};
    var numberFormatCache = {};
    var dateTimeFormatCache = {};
    /*var CONF_RESOURCE_ID = '/CONF/';*/
    var CONF_RESOURCE_ID = context.getConf().i18nConfResourceId;
    
    var getLanguage = function(){
        //return resources[ context.getConf().i18nConfResourceId ].language;
        return resources[ CONF_RESOURCE_ID ].language;
    };
    
    var getLocale = function(){
        //return resources[ context.getConf().i18nConfResourceId ].locale;
        return resources[ CONF_RESOURCE_ID ].locale;
    };
    
    var exists = function( id ) {
        return resources[ id ] !== undefined;
    };
    
    var tr = function( id, params, format, subformat ) {
        
        switch ( format ) {
        case 'string':
            return trString( id, params );
        case 'number':
            return trNumber( id, params );
        case 'currency':
            return trCurrency( id, params, subformat );
        case 'datetime':
            return trDateTime( id, params );
        } 
        
        throw 'I18n format type not supported: ' + format;
    };
    
    var trString = function( id, params ) {
        
        var mfunc = cache[ id ];
        
        if ( ! mfunc ){
            mfunc = mf.compile( resources[ id ] );
            cache[ id ] = mfunc;
        }
        
        return mfunc( params );
    };
    
    var getSource = function( params ){
        
        return params && utils.isFunction( params.toSource )?
            params.toSource():
            '';
    };
    
    var trNumber = function( value, params ) {
        
        var source = getSource( params );
        var numberFormat = numberFormatCache[ source ];
        
        if ( ! numberFormat ){
            numberFormat = new Intl.NumberFormat( getLocale(), params );
            numberFormatCache[ source ] = numberFormat;
        }
        
        return numberFormat.format( value );
    };
    
    var trCurrency = function( value, params, theCurrency ) {
        
        params.style = 'currency';
        params.currency = theCurrency;
        
        return trNumber( value, params );
    };
    
    var trDateTime = function( value, params ) {
        
        var source = getSource( params );
        var dateTimeFormat = dateTimeFormatCache[ source ];
        
        if ( ! dateTimeFormat ){
            dateTimeFormat = new Intl.DateTimeFormat( getLocale(), params );
            dateTimeFormatCache[ source ] = dateTimeFormat;
        }
        
        return dateTimeFormat.format( value );
    };
    
    return {
        getLanguage: getLanguage,
        getLocale: getLocale,
        exists: exists,
        tr: tr
    };
};

},{"../context.js":27,"../utils.js":101,"messageformat":4}],72:[function(require,module,exports){
/* 
    I18nBundle class 
*/
module.exports = function( ) {
    "use strict";
    
    var i18nList = {};
    var first = undefined;

    var add = function( i18n ){
        i18nList[ i18n.getLanguage() ] = i18n;
        if ( ! first ){
            first = i18n;
        }
    };
    
    var exists = function( id ){
        return first.exists( id );
    };
    
    var tr = function( id, params, format, subformat, language ) {
        
        if ( ! language ){
            throw 'Language not defined! Please, use data-iLanguage to define it before trying to translate anything!';
        }
        
        var i18n = i18nList[ language ];
        
        if ( ! i18n ){
            throw 'Language "' + language + '" not found in I18nBundle!';
        }
        
        return i18n.tr( id, params, format, subformat );
    };

    // Init!
    for ( var c = 0; c < arguments.length; c++ ) {
        add( arguments[ c ] );
    }
    
    return {
        add: add,
        exists: exists,
        tr: tr
    };
};

},{}],73:[function(require,module,exports){
/* 
    i18nHelper singleton class 
*/
var utils = require( '../utils.js' );
var I18n = require( './i18n.js' );
var context = require( '../context.js' );

module.exports = (function() {
    "use strict";
    
    var tr = function ( i18nList, id, params, format, subformat, language ){
        
        if ( ! i18nList ) {
            return 'No I18n instance defined!';
        }
            
        var length = i18nList.length;
        if ( ! length ){
            return 'Void I18n list!';
        }

        for ( var i = 0; i < length; i++ ) {
            var i18n = i18nList[ i ];
            if ( format !== 'string' || i18n.exists( id ) ){
                return i18n.tr( id, params, format, subformat, language );
            }
        }
        
        return 'I18n resource "' + id + '" not found!';
    };
    
    var loadAsync = function( remoteList, callback, failCallback ){
        
        loadAsyncItem( 
            {}, 
            callback, 
            failCallback,
            remoteList, 
            remoteList.length - 1 );
    };
    
    var loadAsyncItem = function( map, callback, failCallback, remoteList, currentIndex ){
        
        var url = remoteList[ currentIndex ];
        utils.getJSON( 
            {
                url: url,
                done: function( data ) {
                    map[ url ] = data;
                    if ( currentIndex > 0 ){
                        loadAsyncItem( 
                            map, 
                            callback, 
                            failCallback,
                            remoteList, 
                            --currentIndex );
                    } else {
                        callback( map );
                    }
                },
                fail: function( jqxhr, textStatus, error ) {
                    context.asyncError( url, error, failCallback );
                }
            }
        );
    };
    /*
    var loadAsyncItem = function( map, callback, failCallback, remoteList, currentIndex ){
        
        var url = remoteList[ currentIndex ];
        $.getJSON( url )
            .done(
                function( data ) {
                    map[ url ] = data;
                    if ( currentIndex > 0 ){
                        loadAsyncItem( 
                            map, 
                            callback, 
                            failCallback,
                            remoteList, 
                            --currentIndex );
                    } else {
                        callback( map );
                    }
                }
            )
            .fail(
                function( jqxhr, textStatus, error ) {
                    context.asyncError( url, error, failCallback );
                }
            );
    };
    */
    
    var loadAsyncAuto = function( dictionary, i18n, callback, failCallback ){
        
        // Return if it is nothing to do
        if ( ! i18n || ! i18n.files || ! Object.keys( i18n.files ).length ){
            callback();
            return;
        }
        
        // Build jsonFiles array
        var numberOfLanguages = Object.keys( i18n.files ).length;
        var jsonFiles = [];
        var urlPrefix = i18n.urlPrefix || '';
        for ( var lang in i18n.files ){
            var langFiles = i18n.files[ lang ];
            for ( var index in langFiles ){
                var file = langFiles[ index ];
                var url = urlPrefix + file;
                jsonFiles.push( url );
            }
        }
        
        // Use loadAsync method to load all jsonFiles; then register I18n instances and arrays
        loadAsync( 
            jsonFiles, 
            function( i18nMap ){
                
                for ( var lang in i18n.files ){
                    var langFiles = i18n.files[ lang ];
                    var i18nInstanceArray = [];
                    
                    // Register array vars
                    dictionary[ buildI18nInstanceArrayName( lang ) ] = i18nInstanceArray;
                    if ( numberOfLanguages === 1 ){
                        dictionary[ 'i18nArray' ] = i18nInstanceArray;
                    }
                    
                    for ( var index in langFiles ){
                        var file = langFiles[ index ];
                        var url = urlPrefix + file;
                        var i18nInstance = new I18n( lang, i18nMap[ url ] );
                        
                        // Register i18n instances
                        dictionary[ buildI18nInstanceName( file ) ] = i18nInstance;
                        i18nInstanceArray.unshift( i18nInstance ); // Add to the beginning of the array
                    }
                }
                
                callback();
            },
            failCallback 
        );
    };
    
    var buildI18nInstanceArrayName = function( lang ){
        return 'i18n' + lang.toUpperCase() + 'Array';
    };
    
    var buildI18nInstanceName = function( file ){
        
        var fileWithoutExtension = file.substr( 0, file.lastIndexOf( '.' ) );
        return 'i18n' + fileWithoutExtension.toUpperCase();
    };

    return {
        tr: tr,
        loadAsync: loadAsync,
        loadAsyncAuto: loadAsyncAuto
    };
})();

},{"../context.js":27,"../utils.js":101,"./i18n.js":71}],74:[function(require,module,exports){
/*
    logHelper singleton class
*/
module.exports = (function() {
    "use strict";
    
    var context = require( './context.js' );
    
    var trace = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.trace.apply( logger, arguments );
    };
    
    var debug = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.debug.apply( logger, arguments );
    };
    
    var info = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.info.apply( logger, arguments );
    };
    
    var warn = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.warn.apply( logger, arguments );
    };
    
    var error = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.error.apply( logger, arguments );
    };
    
    var fatal = function (){
        
        var logger = context.getLogger();
        
        if ( ! logger ){
            return;
        }
        
        logger.fatal.apply( logger, arguments );
    };
    
    /*
    var fatalAndThrow = function ( message ){
        
        fatal.apply( this, arguments );
        throw message;
    };*/
    
    return {
        trace: trace,
        debug: debug,
        info: info,
        warn: warn,
        error: error,
        fatal: fatal
        //fatalAndThrow: fatalAndThrow
    };
})();

},{"./context.js":27}],75:[function(require,module,exports){
/*
    Exported functions
*/
exports.run = function( options ){
    
    var parser = require( './parsers/parser.js' );
    return parser.run( options );
};

/* Declare exports */
exports.I18n = require( './i18n/i18n.js' );
exports.I18nBundle = require( './i18n/i18nBundle.js' );
exports.i18nHelper = require( './i18n/i18nHelper.js' );
exports.context = require( './context.js' );
exports.logHelper = require( './logHelper.js' );
exports.expressionBuilder = require( './expressions/expressionBuilder.js' );
exports.evaluateHelper = require( './expressions/evaluateHelper.js' );
exports.ExpressionTokenizer = require( './expressions/expressionTokenizer.js' );
exports.ReactiveDictionary = require( './scopes/reactiveDictionary.js' );
exports.version = require( './version.js' );

/* Support RequireJS module pattern */
if ( typeof define === 'function' && define.amd ) {
    define( 'zpt.run', exports.run );
    define( 'zpt.I18n', exports.I18n );
    define( 'zpt.I18nBundle', exports.I18nBundle );
    define( 'zpt.i18nHelper', exports.i18nHelper );
    define( 'zpt.context', exports.context );
    define( 'zpt.logHelper', exports.logHelper );
    define( 'zpt.expressionBuilder', exports.expressionBuilder );
    define( 'zpt.evaluateHelper', exports.evaluateHelper );
    define( 'zpt.ExpressionTokenizer', exports.ExpressionTokenizer );
    define( 'zpt.ReactiveDictionary', exports.ReactiveDictionary );
    define( 'zpt.version', exports.version );
}

},{"./context.js":27,"./expressions/evaluateHelper.js":44,"./expressions/expressionBuilder.js":46,"./expressions/expressionTokenizer.js":47,"./i18n/i18n.js":71,"./i18n/i18nBundle.js":72,"./i18n/i18nHelper.js":73,"./logHelper.js":74,"./parsers/parser.js":92,"./scopes/reactiveDictionary.js":98,"./version.js":102}],76:[function(require,module,exports){
/* 
    Class AutoDefineHelper 
*/
var context = require( '../context.js' );
var TALDefine = require( '../attributes/TAL/talDefine.js' );

module.exports = function ( node ) {
    "use strict";
    
    var defineDelimiter = context.getConf().defineDelimiter;
    var inDefineDelimiter = context.getConf().inDefineDelimiter;
    var nocallExpressionPrefix = context.getConf().nocallVariableExpressionPrefix;
    var talAutoDefine = context.getTags().talAutoDefine;

    var buffer = '';
    if ( node && node.getAttribute( talAutoDefine ) ){
        buffer = node.getAttribute( talAutoDefine );
    }
    
    var put = function( name, string, nocall ){
        
        if ( buffer !== '' ){
            buffer += defineDelimiter;
        }
        buffer += (nocall? nocallExpressionPrefix + inDefineDelimiter: '') + name + inDefineDelimiter + string;
    };

    var updateNode = function( node ){

        if ( buffer ){
            node.setAttribute( talAutoDefine, buffer );
            return buffer;
        }
    };
    
    return {
        put: put,
        updateNode: updateNode
    };
};

},{"../attributes/TAL/talDefine.js":18,"../context.js":27}],77:[function(require,module,exports){
/* 
    Class DepsDataItem 
*/
"use strict";

var DepsDataItem = function() {
    
    this.nonExpressionVars = {};
    this.expressionVars = {};
};

DepsDataItem.prototype.mustAddVar = function( varName ){
    return this.nonExpressionVars[ varName ] === undefined && this.expressionVars[ varName ] === undefined;
};

DepsDataItem.prototype.addAllVars = function( varNames, scope ){
    
    for ( var name in varNames ){
        this.add1Var( varNames[ name ], scope );
    }
};

DepsDataItem.prototype.add1ExpressionVar = function( varName ){
    this.expressionVars[ varName ] = true;
};

DepsDataItem.prototype.add1NonExpressionVar = function( varName ){
    this.nonExpressionVars[ varName ] = true;
};

DepsDataItem.prototype.add1Var = function( varName, scope ){

    var map = scope.isLocalVar( varName )? this.expressionVars: this.nonExpressionVars;
    map[ varName ] = true;

    return true;
};

module.exports = DepsDataItem;

},{}],78:[function(require,module,exports){
/* 
    Class AbstractAction
*/
"use strict";

var utils = require( '../../utils.js' );
var context = require( '../../context.js' );

var AbstractAction = function( object, dictionary ) {
    
    this.id = object.id;
    this.var = object.var;
    this.currentElement = object.currentElement;
    this.animation = object.animation;
    this.animationCallback = object.animationCallback;
    if ( object.search ){
        if ( this.id || this.var ){
            throw 'Error in action: you can not set a search and then and id: if you set a search ZPT-JS will set the id for you!';
        }
        this.initializeUsingSearch( object.search, dictionary );
    }
};

AbstractAction.prototype.initializeUsingSearch = function( search, dictionary ){

    this.id = '';
    this.var = dictionary;
    
    // Iterate search items and build id and var
    for ( var i = 0; i < search.length; ++i ){
        var item = search[ i ];
        
        // Replace item is it a search object, '_first_' or '_last_'
        if ( utils.isPlainObject( item ) ){
            item = this.search( this.var, item );
        } else if ( item === context.getConf().firstIndexIdentifier ){
            item = 0;
        } else if ( item === context.getConf().lastIndexIdentifier ){
            item = this.var.length - 1;
        }
        
        // Build the id
        if ( Number.isInteger( item ) ){
            this.id += '[' + item + ']';
        } else {
            var separator = i === 0? '': '.';
            this.id += separator + item;
        }
        
        // Build the var
        this.var = this.var[ item ];
    }
};

AbstractAction.prototype.search = function( list, expressionElement ){
    
    for ( var i = 0; i < list.length; ++i ){
        var record = list[ i ];
        if ( AbstractAction.elementMaches( record, expressionElement ) ){
            return i;
        }
    }
    
    throw 'No record found matching your criteria!';
};

AbstractAction.elementMaches = function( element, expressionElement ){
    
    if ( expressionElement == undefined ){
        throw 'Expression to match must not be null!';
    }

    if ( Array.isArray( expressionElement ) ){
        throw 'Expression ' + utils.genericToString( expressionElement ) + ' to match must not be an array!';
    }

    if ( utils.isPlainObject( expressionElement ) ){
        for ( var i in expressionElement ){
            if ( expressionElement[ i ] !== element[ i ] ){
                return false;
            }
        }
        return true;
    }

    // Must be numeric or string
    return element === expressionElement;
};

AbstractAction.prototype.getValue = function( dictionary ){
    return this.var === undefined?
        dictionary[ this.id ]:
        this.var;
};

AbstractAction.prototype.resolveThisNode = function( indexItem, parserUpdater ){
    
    //var attributeInstance = indexItem.attributeInstance;
    var node = parserUpdater.findNodeById( indexItem.nodeId );
    if ( ! node ){
        // Removed node!
        parserUpdater.addRemovedToStatistics();
        return false;
    }
    parserUpdater.addUpdatedToStatistics();
    
    // Return the node
    return node;
};

AbstractAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    throw 'Error: attributeInstanceIsRelated must be implemented!';
};

AbstractAction.prototype.updateDictionary = function(){
    throw 'Error: updateDictionary must be implemented!';
};

AbstractAction.prototype.updateHTML = function(){
    throw 'Error: updateHTML must be implemented!';
};

module.exports = AbstractAction;

},{"../../context.js":27,"../../utils.js":101}],79:[function(require,module,exports){
/* 
    Class AbstractArrayAction
*/
"use strict";

var AbstractAction = require( './abstractAction.js' );
var utils = require( '../../utils.js' );
var context = require( '../../context.js' );

var AbstractArrayAction = function( object, dictionary ) {
    AbstractAction.call( this, object, dictionary );
    
    this.index = object.index;
};

AbstractArrayAction.prototype = Object.create( AbstractAction.prototype );

AbstractArrayAction.getIndexNumericValue = function( index ){
    
    if ( index === undefined ){
        return undefined;   
    }
    
    if ( index === context.getConf().firstIndexIdentifier ){
        return 0;
    } else if ( index === context.getConf().lastIndexIdentifier ){
        return -1; // This means it is the last
    }
    return index;
};

AbstractArrayAction.prototype.getIndexNumericValue = function(){
    return AbstractArrayAction.getIndexNumericValue( this.index );
};

AbstractArrayAction.prototype.getIndexToUse = function( dictionary ){

    if ( this.index === undefined && this.currentElement === undefined ){
        throw 'index or currentElement must be defined in ' + this.id + ' array action!';
    }
    
    // Check if it uses the index
    var indexNumericValue = this.getIndexNumericValue();
    if ( indexNumericValue !== undefined ){
        return indexNumericValue;
    }

    // Must use currentElement
    var arrayValue = this.getValue( dictionary );
    
    for ( var i = 0; i < arrayValue.length; ++i ){
        var element = arrayValue[ i ];
        if ( AbstractAction.elementMaches( element, this.currentElement ) ){
            return i;
        }
    }
    
    throw 'currentElement ' + utils.genericToString( this.currentElement ) + ' not found in ' + this.id + ' array action!';
};

AbstractArrayAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    return AbstractArrayAction.staticAttributeInstanceIsRelated( attributeInstance );
};

AbstractArrayAction.staticAttributeInstanceIsRelated = function( attributeInstance ){
    return attributeInstance.type === 'tal:repeat';
};

AbstractArrayAction.prototype.updateDictionary = function(){
    throw 'Error: updateDictionary must be implemented!';
};

AbstractArrayAction.prototype.updateHTML = function(){
    throw 'Error: updateHTML must be implemented!';
};

AbstractArrayAction.prototype.resolveChildNode = function( indexItem, parserUpdater ){
    
    //var attributeInstance = indexItem.attributeInstance;
    var node = parserUpdater.findNodeById( indexItem.nodeId );
    if ( ! node ){
        // Removed node!
        parserUpdater.addRemovedToStatistics();
        return false;
    }
    parserUpdater.addUpdatedToStatistics();
    
    // Return the node
    return this.indexToUse === -1?
        null:
        this.getIndexOfLoop( node.parentNode, indexItem.nodeId, this.indexToUse );
};

AbstractArrayAction.prototype.getIndexOfLoop = function( parentNode, nodeId, indexInLoop ){
    
    var numberOfChildren = parentNode.childElementCount;
    for ( var i = 0; i < numberOfChildren; ++i ){
        var childNode = parentNode.children[ i ];
        var currentNodeId = childNode.getAttribute( context.getTags().id );
        if ( currentNodeId === nodeId ){
            return parentNode.children[ 1 + i + indexInLoop ];
        }
    }
    
    return null;
};

module.exports = AbstractArrayAction;

},{"../../context.js":27,"../../utils.js":101,"./abstractAction.js":78}],80:[function(require,module,exports){
/* 
    Class AbstractObjectAction
*/
"use strict";

var AbstractAction = require( './abstractAction.js' );

var AbstractObjectAction = function( object, dictionary ) {
    AbstractAction.call( this, object, dictionary );
    
    this.property = object.property;
    this.id += '.' + object.property;
};

AbstractObjectAction.prototype = Object.create( AbstractAction.prototype );

AbstractObjectAction.prototype.attributeInstanceIsRelated = function( attributeInstance ){
    return true;
};

AbstractObjectAction.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the node
    var node = this.resolveThisNode( indexItem, parserUpdater );
    if ( ! node ){
        throw 'No node found to update';
    }
    
    // Update the selected node
    parserUpdater.updateNode( node );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, node );
    
    return true;
};

module.exports = AbstractObjectAction;

},{"./abstractAction.js":78}],81:[function(require,module,exports){
/* 
    Class ArrayCreate
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );
var context = require( '../../context.js' );
var ParserNodeRenderer = require( '../../parsers/parserNodeRenderer.js' );
var utils = require( '../../utils.js' );

var ArrayCreate = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ArrayCreate.prototype = Object.create( AbstractArrayAction.prototype );

ArrayCreate.prototype.updateDictionary = function( dictionary ){
    
    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    
    if ( this.indexToUse === -1 ){
        this.resolvedIndex = arrayValue.length;
        arrayValue.push( this.newElement );
    } else {
        this.resolvedIndex = this.indexToUse;
        arrayValue.splice( this.indexToUse, 0, this.newElement );
    }
};

ArrayCreate.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the nodeToUpdate
    var node = this.resolveThisNode( indexItem, parserUpdater );
    if ( ! node ){
        throw 'No node found to clone';
    }
    
    // Init some vars
    var tags = context.getTags();
    var parentNode = node.parentNode;
    
    // Clone and configure the node
    var tmpNode = ParserNodeRenderer.cloneAndConfigureNode( 
        node, 
        true, 
        tags, 
        node.getAttribute( tags.id ) 
    );
    ParserNodeRenderer.configureNodeForNewItem( 
        tmpNode, 
        tags, 
        parentNode, 
        indexItem, 
        this.resolvedIndex
    );
    
    // Insert it
    var sibling = this.indexToUse === -1?
        null:
        parentNode.children[ 1 + this.indexToUse ];
    parentNode.insertBefore( tmpNode, sibling );
    
    // Update the selected node
    parserUpdater.updateNode( tmpNode );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, tmpNode );
    
    return true;
};

ArrayCreate.buildMultiple = function( object, dictionary ){

    var actions = [];
    
    // Copy newElements to a new array
    var newElements = utils.copyArray( object.newElement );
    
    // Configure the object, create the first instance and add it to the list
    object.newElement = newElements[ 0 ];
    var firstActionInstance = new ArrayCreate( object, dictionary );
    actions.push( firstActionInstance );
    
    // Get the firstIndex and if the new elments must be the last
    var firstIndex = firstActionInstance.getIndexNumericValue();
    var isLast = -1 === firstIndex;
        
    // Build actions list
    for ( var i = 1; i < newElements.length; ++i ){
        var newElement = newElements[ i ];
        
        // Clone the object and configure the newElement and the index
        var newObject = utils.deepExtend( object );
        newObject.newElement = newElement;
        newObject.index = isLast?
            -1:
            firstIndex + i;
        
        // Instance the action instance and add it to the list
        var newActionInstance = new ArrayCreate( newObject, dictionary );
        actions.push( newActionInstance );
    }
    
    return actions;
};

module.exports = ArrayCreate;

},{"../../context.js":27,"../../parsers/parserNodeRenderer.js":93,"../../utils.js":101,"./abstractArrayAction.js":79}],82:[function(require,module,exports){
/* 
    Class ArrayDelete
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );
var utils = require( '../../utils.js' );
var attributeIndex = require( '../../attributes/attributeIndex.js' );
var nodeRemover = require( '../nodeRemover.js' );

var ArrayDelete = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
};

ArrayDelete.prototype = Object.create( AbstractArrayAction.prototype );

ArrayDelete.prototype.updateDictionary = function( dictionary ){

    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    arrayValue.splice( this.indexToUse, 1 );
};

ArrayDelete.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance, continueData ){
    
    // Must get the nodeToUpdate
    var nodeToDelete = this.resolveChildNode( indexItem, parserUpdater );
    if ( ! nodeToDelete ){
        throw 'No node found to be deleted at this index: ' + this.indexToUse;
    }
    
    // Run animation
    parserUpdater.runAnimation( 
        actionInstance, 
        nodeToDelete, 
        function(){
            
            // Remove the selected node from the index and from HTML
            //attributeIndex.removeNode( nodeToDelete ); 
            nodeRemover.removeNode( nodeToDelete );
            //TODO update next siblings?
            
            // Continue
            parserUpdater.continueUpdateHTML( continueData );
        } 
    );
    
    //return true;
    return false;
};

ArrayDelete.buildMultiple = function( object, dictionary ){

    var actions = [];
    var property = object.index? 'index': 'currentElement';

    // Copy indexes to a new array
    var allItems = utils.copyArray( object[ property ] );
    
    // Build actions list
    for ( var i = 0; i < allItems.length; ++i ){
        var item = allItems[ i ];
        
        // Clone the object and configure the index
        var newObject = utils.deepExtend( object );
        newObject[ property ] = item;
        
        // Instance the action instance and add it to the list
        var newActionInstance = new ArrayDelete( newObject, dictionary );
        newActionInstance.index = newActionInstance.getIndexToUse( dictionary );
        actions.push( newActionInstance );
    }
    
    // Sort actions
    actions.sort(
        function( a, b ){ return b.index - a.index; }
    );
    
    return actions;
};

module.exports = ArrayDelete;

},{"../../attributes/attributeIndex.js":23,"../../utils.js":101,"../nodeRemover.js":91,"./abstractArrayAction.js":79}],83:[function(require,module,exports){
/* 
    Class ArrayUpdate
*/
"use strict";

var AbstractArrayAction = require( './abstractArrayAction.js' );

var ArrayUpdate = function( object, dictionary ) {
    AbstractArrayAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ArrayUpdate.prototype = Object.create( AbstractArrayAction.prototype );

ArrayUpdate.prototype.updateDictionary = function( dictionary ){
    
    this.indexToUse = this.getIndexToUse( dictionary );
    var arrayValue = this.getValue( dictionary );
    arrayValue[ this.indexToUse ] = this.newElement;
};

ArrayUpdate.prototype.updateHTML = function( indexItem, parserUpdater, actionInstance ){
    
    // Must get the nodeToUpdate
    var nodeToUpdate = this.resolveChildNode( indexItem, parserUpdater );
    if ( ! nodeToUpdate ){
        throw 'No node found to be updated at this index: ' + this.indexToUse;
    }
    
    // Update the selected node
    parserUpdater.updateNode( nodeToUpdate, true );
    
    // Run animation
    parserUpdater.runAnimation( actionInstance, nodeToUpdate );
    
    return true;
};

module.exports = ArrayUpdate;

},{"./abstractArrayAction.js":79}],84:[function(require,module,exports){
/* 
    Class CSSAnimationManager 
*/
"use strict";

module.exports = (function() {
    
    var animate = function( dictionaryAction, node, callback ) {
        
        // Run callback and return if there is no animation
        if ( ! dictionaryAction.animation ){
            if ( callback ){
                callback();
            };
            return;
        }
        
        // Set the animation
        node.style.animation = 'none';
        setTimeout(
            function() {
                // Set the animationend listener
                var animationendCallback = function( event ){
                    if ( callback ){
                        callback();
                    }
                };
                //node.removeEventListener( 'animationend', animationendCallback );
                node.addEventListener( 'animationend', animationendCallback );

                // Set the animation
                node.style.animation = dictionaryAction.animation;
            }, 
            10
        );
    };
    
    var reset = function( node ) {
        node.style.animation = 'none';
    };
    
    var self = {
        animate: animate,
        reset: reset
    };
    
    return self;
})();

},{}],85:[function(require,module,exports){
/* 
    Class dictionaryActionBuilder 
*/
"use strict";

var ArrayUpdate = require( './arrayUpdate.js' );
var ArrayDelete = require( './arrayDelete.js' );
var ArrayCreate = require( './arrayCreate.js' );
var ObjectUpdate = require( './objectUpdate.js' );
var ObjectDelete = require( './objectDelete.js' );

module.exports = (function() {
    
    var build = function( object, dictionary ) {
        
        switch ( object.action ) {
        case 'updateArray':
            return new ArrayUpdate( object, dictionary );
        case 'deleteArray':
            return Array.isArray( object.index ) || Array.isArray( object.currentElement )? 
                ArrayDelete.buildMultiple( object, dictionary ):
                new ArrayDelete( object, dictionary );
        case 'createArray':
            return Array.isArray( object.newElement )? 
                ArrayCreate.buildMultiple( object, dictionary ):
                new ArrayCreate( object, dictionary );
        case 'updateObject':
            return object.editedProperties || object.deletedProperties?
                ObjectUpdate.buildMultiple( object, dictionary ):
                new ObjectUpdate( object, dictionary );
        case 'deleteObject':
            return new ObjectDelete( object, dictionary );
        default:
            throw 'Unknown dictionary action: ' + object.action;
        }
    };
    
    var self = {
        build: build
    };
    
    return self;
})();

},{"./arrayCreate.js":81,"./arrayDelete.js":82,"./arrayUpdate.js":83,"./objectDelete.js":86,"./objectUpdate.js":87}],86:[function(require,module,exports){
/* 
    Class ObjectDelete
*/
"use strict";

var AbstractObjectAction = require( './abstractObjectAction.js' );

var ObjectDelete = function( object, dictionary ) {
    AbstractObjectAction.call( this, object, dictionary );
};

ObjectDelete.prototype = Object.create( AbstractObjectAction.prototype );

ObjectDelete.prototype.updateDictionary = function( dictionary ){
    
    var objectValue = this.getValue( dictionary );
    delete objectValue[ this.property ];
};

module.exports = ObjectDelete;

},{"./abstractObjectAction.js":80}],87:[function(require,module,exports){
/* 
    Class ObjectUpdate
*/
"use strict";

var AbstractObjectAction = require( './abstractObjectAction.js' );
var ObjectDelete = require( './objectDelete.js' );
var utils = require( '../../utils.js' );

var ObjectUpdate = function( object, dictionary ) {
    AbstractObjectAction.call( this, object, dictionary );
    
    this.newElement = object.newElement;
};

ObjectUpdate.prototype = Object.create( AbstractObjectAction.prototype );

ObjectUpdate.prototype.updateDictionary = function( dictionary ){
    
    var objectValue = this.getValue( dictionary );
    objectValue[ this.property ] = this.newElement;
};

ObjectUpdate.buildMultiple = function( object, dictionary ){

    var actions = [];
    var clonedObject = utils.deepExtend( object );
    
    // Copy editedProperties and deletedProperties
    var editedProperties = clonedObject.editedProperties;
    var deletedProperties = clonedObject.deletedProperties;
    
    // Delete them
    delete clonedObject.editedProperties;
    delete clonedObject.deletedProperties;
        
    // Build actions list for editedProperties
    if ( editedProperties ){
        clonedObject.action = 'updateObject';
        for ( var editedPropertiesId in editedProperties ){
            var editedPropertiesValue = editedProperties[ editedPropertiesId ];

            // Clone the object and configure property and newElement
            var newObject = utils.deepExtend( clonedObject );
            newObject.property = editedPropertiesId;
            newObject.newElement = editedPropertiesValue;

            // Instance the action instance and add it to the list
            var newActionInstance = new ObjectUpdate( newObject, dictionary );
            actions.push( newActionInstance );
        }
    }
    
    // Build actions list for deletedProperties
    if ( deletedProperties ){
        clonedObject.action = 'deleteObject';
        for ( var i = 0; i < deletedProperties.length; ++i ){
            var deletedPropertiesItem = deletedProperties[ i ];

            // Clone the object and configure property
            newObject = utils.deepExtend( clonedObject );
            newObject.property = deletedPropertiesItem;

            // Instance the action instance and add it to the list
            newActionInstance = new ObjectDelete( newObject, dictionary );
            actions.push( newActionInstance );
        }
    }
    
    return actions;
};

module.exports = ObjectUpdate;

},{"../../utils.js":101,"./abstractObjectAction.js":80,"./objectDelete.js":86}],88:[function(require,module,exports){
/* 
    Class Loop 
*/
"use strict";

var AutoDefineHelper = require( './autoDefineHelper.js' );
var expressionBuilder = require( '../expressions/expressionBuilder.js' );
var context = require( '../context.js' );

var Loop = function ( _itemVariableName, _expressionString, scope ) {
    
    var itemVariableName = _itemVariableName;
    var expressionString = _expressionString;
    
    var expression = expressionBuilder.build( expressionString );
    var getExpression = function(){
        return expression;
    };
    
    var items = expression.evaluate( scope );
    var getItems = function(){
        return items;
    };
    
    var currentIndex = -1;
    var maxIndex = items? items.length - 1: -1;
    
    var offset = 0;
    var setOffset = function( _offset ){
        offset = _offset;
    };
    
    var repeat = function(){
        
        if ( currentIndex++ < maxIndex ) {
            
            return Loop.buildAutoDefineHelper( 
                itemVariableName, 
                currentIndex, 
                expressionString, 
                items.length, 
                offset 
            );
        }
        
        return null;
    };
    
    return {
        setOffset: setOffset,
        repeat:repeat,
        getItems: getItems,
        getExpression: getExpression
    };
};

Loop.buildAutoDefineHelper = function( itemVariableName, itemIndex, expressionString, numberOfItems, offset ){
    
    var autoDefineHelper = new AutoDefineHelper();

    // Declare item-index, item-all, item and item-repeat variables
    autoDefineHelper.put(
        itemVariableName + '-index',
        itemIndex
    );
    autoDefineHelper.put(
        itemVariableName + '-all',
        expressionString
    );
    autoDefineHelper.put(
        itemVariableName,
        itemVariableName + '-all' + '[' + itemVariableName + '-index' + ']'
    );
    autoDefineHelper.put(
        itemVariableName + '-repeat',
        "context/repeat(" 
            + itemVariableName + "-index" + ","
            + numberOfItems + ","
            + offset
            + ")"
    );

    return autoDefineHelper;
};

Loop.setAutoDefineAttribute = function( node, itemVariableName, itemIndex, expressionString, numberOfItems, offset ){
    
    // Set item-index, item-all, item and item-repeat attributes
    node.setAttribute( 
        context.getTags().talAutoDefine,
        itemVariableName + '-index ' + itemIndex + ';'
            + itemVariableName + '-all ' + expressionString + ';'
            + itemVariableName + ' ' + itemVariableName +'-all[' + itemVariableName + '-index];'
            + itemVariableName + '-repeat context/repeat(' + itemVariableName + '-index,' + numberOfItems + ',' + offset + ')'
    );
};

module.exports = Loop;

},{"../context.js":27,"../expressions/expressionBuilder.js":46,"./autoDefineHelper.js":76}],89:[function(require,module,exports){
/* 
    Class LoopItem
*/
"use strict";

var LoopItem = function ( _currentIndex, _itemsLength, _offset ) {
    
    this.currentIndex = _currentIndex;
    this.itemsLength = _itemsLength;
    this.offset = _offset;
};

LoopItem.prototype.index = function( ) {
    return this.offset + this.currentIndex;
};

LoopItem.prototype.number = function( ) {
    return this.index() + 1;
};

LoopItem.prototype.even = function( ) {
    return this.index() % 2 === 0;
};

LoopItem.prototype.odd = function ( ) {
    return this.index() % 2 === 1;
};

LoopItem.prototype.start = function ( ) {
    return this.index() === 0;
};

LoopItem.prototype.end = function ( ) {
    return this.currentIndex === this.itemsLength - 1;
};

LoopItem.prototype.length = function () {
    return this.offset + this.itemsLength;
};

LoopItem.prototype.letter = function () {
    return this.formatLetter( this.index(), 'a' );
};

LoopItem.prototype.Letter = function () {
    return this.formatLetter( this.index(), 'A' );
};

LoopItem.prototype.formatLetter = function ( ii, startChar ) {
    var i = ii;
    var buffer = '';
    var start = startChar.charCodeAt( 0 ); 
    var digit = i % 26;
    buffer += String.fromCharCode( start + digit );

    while( i > 25 ) {
        i /= 26;
        digit = (i - 1 ) % 26;
        buffer += String.fromCharCode( start + digit );
    }

    return buffer.split('').reverse().join('');
};

LoopItem.prototype.roman = function () {
    return this.formatRoman( this.index() + 1, 0 );
};

LoopItem.prototype.Roman = function () {
    return this.formatRoman( this.index() + 1, 1 );
};

LoopItem.prototype.formatRoman = function ( nn, capital ) {
    var n = nn;

    // Can't represent any number 4000 or greater
    if ( n >= 4000 ) {
        return 'Overflow formatting roman!';
    }

    var buf = '';
    for ( var decade = 0; n !== 0; decade++ ) {
        var digit = n % 10;
        if ( digit > 0 ) {
            digit--;
            buf += this.romanArray [ decade ][ digit ][ capital ];
        }
        n = (n / 10) >> 0;
    }

    return buf.split( '' ).reverse().join( '' );
};

LoopItem.prototype.romanArray = [
    /* One's place */
    [
        [ "i", "I" ],
        [ "ii", "II" ], 
        [ "iii", "III" ],
        [ "vi", "VI" ],
        [ "v", "V" ],
        [ "iv", "IV" ],
        [ "iiv", "IIV" ],
        [ "iiiv", "IIIV" ],
        [ "xi", "XI" ]
    ],

    /* 10's place */
    [
        [ "x", "X" ],
        [ "xx", "XX" ],
        [ "xxx", "XXX" ],
        [ "lx", "LX" ],
        [ "l", "L" ],
        [ "xl", "XL" ],
        [ "xxl", "XXL" ],
        [ "xxxl", "XXXL" ],
        [ "cx", "CX" ]
    ],

    /* 100's place */
    [
        [ "c", "C" ],
        [ "cc", "CC" ],
        [ "ccc", "CCC" ],
        [ "dc", "DC" ],
        [ "d", "D" ],
        [ "cd", "CD" ],
        [ "ccd", "CCD" ],
        [ "cccd", "CCCD" ],
        [ "mc", "MC" ]
    ],

    /* 1000's place */
    [
        [ "m", "M" ],
        [ "mm", "MM" ],
        [ "mmm", "MMM" ]
    ]
];

module.exports = LoopItem;

},{}],90:[function(require,module,exports){
/* 
    Class NodeAttributes 
*/
"use strict";

var context = require( '../context.js' );

var NodeAttributes = function( node, indexExpressions ) {
    
    var tags = context.getTags();
    
    // tal namespace
    this.talDefine = node.getAttribute( tags.talDefine );
    this.talCondition = node.getAttribute( tags.talCondition );
    this.talRepeat = node.getAttribute( tags.talRepeat );
    this.talContent = node.getAttribute( tags.talContent );
    this.talAttributes = node.getAttribute( tags.talAttributes );
    this.talOmitTag = node.getAttribute( tags.talOmitTag );
    this.talReplace = node.getAttribute( tags.talReplace );
    this.talOnError = node.getAttribute( tags.talOnError );
    this.talDeclare = node.getAttribute( tags.talDeclare );
    //this.talTag = undefined;
    
    // metal namespace
    this.metalDefineMacro = node.getAttribute( tags.metalDefineMacro );
    this.metalUseMacro = node.getAttribute( tags.metalUseMacro );
    this.metalDefineSlot = node.getAttribute( tags.metalDefineSlot );
    this.metalFillSlot = node.getAttribute( tags.metalFillSlot );
    
    // i18n namespace
    this.i18nDomain = node.getAttribute( tags.i18nDomain );
    this.i18nLanguage = node.getAttribute( tags.i18nLanguage );
    
    // For internal use
    this.qdup = node.getAttribute( tags.qdup );
    
    // Init this.id and set the node id if indexExpressions is true, some attribute is set and it is undefined
    if ( indexExpressions && this.isDynamicContentOn() ){
        this.id = node.getAttribute( tags.id );
        if ( ! this.id ){
            //this.id = utils.generateId( 6 );
            this.id = context.nextExpressionCounter();
            node.setAttribute( tags.id, this.id );
        }
    }
};

NodeAttributes.prototype.isDynamicContentOn = function() {
    
    return this.talDefine 
        || this.talCondition
        || this.talRepeat
        || this.talContent
        || this.talAttributes
        || this.talOmitTag 
        || this.talReplace
        || this.talOnError
        || this.talDeclare
        //|| this.talTag
        //|| this.metalDefineMacro 
        || this.metalUseMacro 
        //|| this.metalDefineSlot 
        || this.metalFillSlot 
        || this.i18nDomain
        || this.i18nLanguage;
        //|| this.qdup;
};

module.exports = NodeAttributes;

},{"../context.js":27}],91:[function(require,module,exports){
/* 
    Class NodeRemover 
*/
"use strict";

var context = require( '../context.js' );

module.exports = (function() {
    
    var tags = context.getTags();
    
    var removeGeneratedNodes = function( target ) {
        
        // Is multiroot?
        if ( Array.isArray( target ) ){ 
            // There are several roots
            
            var result = [];
            for ( var c = 0; c < target.length; c++ ) {
                result = result.concat( 
                    removeNodes( target[ c ] )
                );
            }
            return result;
        }
        
        // There is only one root
        return removeNodes( target );
    };
    
    var removeNodes = function( target ) {
        
        var result = [];
        
        result = result.concat( removeNodesByTag( target, tags.qdup ) );       // Remove all generated nodes (repeats)
        result = result.concat( removeNodesByTag( target, tags.metalMacro ) ); // Remove all generated nodes (macros)
        
        return result;
    };
    
    var removeNodesByTag = function( target, tag ){
        
        var list = target.querySelectorAll( "*[" + tag + "]" );
        return removeList( list );
    };
    
    var removeRelatedNodes = function( target ){
        
        var list = target.parentNode.querySelectorAll( 
            '[' + context.getTags().relatedId + '="' + target.getAttribute( context.getTags().id ) + '"]' 
        );
        return removeList( list );
    };
    
    var removeList = function( list ){

        var result = [];
        
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            // Add nodeId to result if needed
            var nodeId = getNodeId( node );
            if ( nodeId !== undefined ){
                result.push( nodeId );
            }
            
            // Add the nodeIds of its children
            addNodeIdsToList( node, result );
            
            // Remove node
            node.parentNode.removeChild( node );
        }
        
        return result;
    };
    
    var addNodeIdsToList = function( target, result ){
        
        // Get the nodes with data-id
        var nodeIdAttributeName = context.getTags().id;
        var list = target.querySelectorAll( '[' + nodeIdAttributeName + ']' );
        
        // Iterate the list
        var node;
        var pos = 0;
        while ( node = list[ pos++ ] ) {
            result.push( 
                node.getAttribute( nodeIdAttributeName ) 
            );
        }
    };
    
    var getNodeId = function( node ){
        
        var nodeIdAttributeName = context.getTags().id;
        
        return node.hasAttribute( nodeIdAttributeName )?
            node.getAttribute( nodeIdAttributeName ):
            undefined;
    };
    
    var removeNode = function( node ){
        var nodeId = getNodeId( node );
        var parentNode = node.parentNode;
        if ( parentNode ){
            parentNode.removeChild( node );
        }
        return nodeId;
    };
    
    var removeMultipleNodes = function( node, mustRemoveGeneratedNodes ){
        
        var result = removeRelatedNodes( node );
        
        if ( mustRemoveGeneratedNodes ){
            result = result.concat(
                removeGeneratedNodes( node )
            );
        }
        
        return result;
    };
    
    var self = {
        removeGeneratedNodes: removeGeneratedNodes,
        //removeRelatedNodes: removeRelatedNodes,
        removeNode: removeNode,
        removeMultipleNodes: removeMultipleNodes
    };
    
    return self;
})();

},{"../context.js":27}],92:[function(require,module,exports){
/* 
    Class Parser 
*/
"use strict";

var context = require( '../context.js' );
var ParserRenderer = require( './parserRenderer.js' );
var ParserUpdater = require( './parserUpdater.js' );
var ParserPreloader = require( './parserPreloader.js' );
var ReactiveDictionary = require( '../scopes/reactiveDictionary.js' );

module.exports = (function() {
    
    var parserOptions = {
        command: undefined, // preload, fullRender or partialRender
        root: undefined,
        dictionary: {},
        indexExpressions: true
        //notRemoveGeneratedTags,
        //target,
        //declaredRemotePageUrls,
        //i18n,
        //callback,
        //failCallback,
    };
    
    var updateParserOptions = function( options ){
        
        parserOptions.command = options.command || 'fullRender';
        parserOptions.root = options.root === undefined? parserOptions.root: options.root;
        parserOptions.dictionary = ( options.dictionary instanceof ReactiveDictionary?
            options.dictionary._getNonReactiveDictionary(): 
            options.dictionary )
            || parserOptions.dictionary;
        //parserOptions.dictionary = options.dictionary || parserOptions.dictionary;
        parserOptions.indexExpressions = options.indexExpressions === undefined? parserOptions.indexExpressions: options.indexExpressions;
    };
    
    var run = function( _options ){
        
        var options = _options || {};
        
        // Init parser options
        updateParserOptions( options );
    
        var command = options.command || 'fullRender';
        switch ( command ) {
            case 'preload':
                return processPreload(
                    options.callback,
                    options.failCallback,
                    options.declaredRemotePageUrls || [],
                    options.i18n,
                    options.notRemoveGeneratedTags,
                    options.maxFolderDictionaries
                );
            case 'fullRender':
            case 'partialRender':
                return processRender(
                    command === 'partialRender'? options.target: parserOptions.root,
                    options.dictionaryExtension,
                    options.notRemoveGeneratedTags,
                    parserOptions.indexExpressions && command === 'fullRender',
                    options.goToURLHash === undefined? context.nextRunCounter() === 1: false
                );
            case 'update':
                return processUpdate( 
                    options.dictionaryChanges,
                    options.dictionaryActions
                );
            default:
                throw 'Unknown command: ' + command;
        }
    };
    
    var processPreload = function( callback, failCallback, declaredRemotePageUrls, i18n, notRemoveGeneratedTags, maxFolderDictionaries ){
        
        var parserPreloader = new ParserPreloader( 
            parserOptions, 
            callback, 
            failCallback, 
            declaredRemotePageUrls, 
            i18n, 
            notRemoveGeneratedTags, 
            maxFolderDictionaries
        );

        parserPreloader.run();

        return parserPreloader;
    };
    
    var processRender = function( target, dictionaryExtension, notRemoveGeneratedTags, resetIndex, goToURLHash ){
        
        var parserRenderer = new ParserRenderer( 
            parserOptions, 
            target, 
            dictionaryExtension, 
            notRemoveGeneratedTags, 
            resetIndex,
            goToURLHash
        );

        parserRenderer.run();
        
        return parserRenderer;
    };
    
    var processUpdate = function( dictionaryChanges, dictionaryActions ) {
        
        var parserUpdater = new ParserUpdater( 
            dictionaryChanges,
            dictionaryActions,
            parserOptions
        );

        parserUpdater.run();
        
        return parserUpdater;
    };
    
    var getOptions = function(){
        return parserOptions;
    };
    
    var self = {
        run: run,
        getOptions: getOptions
    };
    
    return self;
})();

},{"../context.js":27,"../scopes/reactiveDictionary.js":98,"./parserPreloader.js":94,"./parserRenderer.js":95,"./parserUpdater.js":96}],93:[function(require,module,exports){
(function (process){(function (){
/* 
    Class ParserNodeRenderer
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var NodeAttributes = require( './nodeAttributes.js' );
var attributeCache = require( '../cache/attributeCache.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var AutoDefineHelper = require( './autoDefineHelper.js' );
var evaluateHelper = require( '../expressions/evaluateHelper.js' );
var Loop = require( './loop.js' );

var I18NDomain = require( '../attributes/I18N/i18nDomain.js' );
var I18NLanguage = require( '../attributes/I18N/i18nLanguage.js' );
var METALDefineMacro = require( '../attributes/METAL/metalDefineMacro.js' );
var METALUseMacro = require( '../attributes/METAL/metalUseMacro.js' );
var TALAttributes = require( '../attributes/TAL/talAttributes.js' );
var TALCondition = require( '../attributes/TAL/talCondition.js' );
var TALContent = require( '../attributes/TAL/talContent.js' );
var TALDefine = require( '../attributes/TAL/talDefine.js' );
var TALOmitTag = require( '../attributes/TAL/talOmitTag.js' );
var TALOnError = require( '../attributes/TAL/talOnError.js' );
var TALRepeat = require( '../attributes/TAL/talRepeat.js' );
var TALReplace = require( '../attributes/TAL/talReplace.js' );
var TALDeclare = require( '../attributes/TAL/talDeclare.js' );
var contentHelper = require( '../attributes/TAL/contentHelper.js' );

var ParserNodeRenderer = function( _target, _scope, _indexExpressions ) {
    
    var target = _target; 
    var scope = _scope;
    var indexExpressions = _indexExpressions;
    
    var tags = context.getTags();
    
    var run = function(){
        process( target );
    };
    
    var process = function( node ) {

        try {
            // Get the attributes from the node
            var attributes = new NodeAttributes( node, indexExpressions );
            
            scope.startElement();

            // Process instructions
            attributes.talRepeat != null ? 
                processLoop( node, attributes ):
                processElement( node, attributes );

            scope.endElement();

        } catch ( e ) {
            
            // Try to treat error
            if ( ! treatError( node, e ) ) {
                throw e;
            }
        }
    };
    
    var processLoopNextSibling = function( node ){

        var counter = -1;
        var nextSibling = node;
        do {
            ++counter;
            nextSibling = nextSibling.nextElementSibling;
            if ( ! nextSibling ){
                return {
                    nextSibling: null,
                    counter: counter
                };
            }
        } while ( nextSibling.hasAttribute( tags.qdup ) );

        return {
            nextSibling: nextSibling,
            counter: counter
        };
    };
    
    var processLoop = function( node, attributes ) {
        
        // Process repeat
        //var talRepeat = TALRepeat.build( attributes.talRepeat );
        var talRepeat = attributeCache.getByAttributeClass( 
            TALRepeat, 
            attributes.talRepeat, 
            node,
            indexExpressions,
            scope
        );
        var loop = talRepeat.process( scope, node );

        // Check default
        if ( evaluateHelper.isDefault( loop.getItems() ) ){
            processElement( node, attributes );
            return true;
        }
        
        // Configure the node to clone it later
        node.removeAttribute( tags.talRepeat );
        node.removeAttribute( 'style' );
        node.setAttribute( tags.qdup, 1 );
        var nodeId = node.getAttribute( 'id' );
        node.removeAttribute( 'id' );
        var nodeDataId = node.getAttribute( tags.id );
        node.removeAttribute( tags.id );
        
        var nextSiblingData = processLoopNextSibling( node );
        var nextSibling = nextSiblingData.nextSibling;
        loop.setOffset( nextSiblingData.counter );
        //log.warn( 'loop counter: ' + nextSiblingData.counter );
        
        var autoDefineHelper;
        while ( autoDefineHelper = loop.repeat() ) {
            
            scope.startElement();
            
            // Clone and configure the node
            var tmpNode = ParserNodeRenderer.cloneAndConfigureNode( node, indexExpressions, tags, nodeDataId );

            // Insert it
            var parentNode = node.parentNode;
            parentNode.insertBefore( tmpNode, nextSibling );
            
            // Process it
            if ( ! processElement( tmpNode, attributes, autoDefineHelper ) ) {
                scope.endElement();
                return false;
            }
            
            scope.endElement();
        }

        // Configure repeat node (the original) to enable future reevaluation
        node.style.display = 'none';
        node.setAttribute( tags.talRepeat, attributes.talRepeat );
        if ( nodeId !== '' && nodeId != null ){
            node.setAttribute( 'id', nodeId );
        }
        if ( nodeDataId !== '' && nodeDataId != null ){
            node.setAttribute( tags.id, nodeDataId );
        }
        node.removeAttribute( tags.qdup );
        
        return true;
    };

    var treatError = function( node, exception ) {

        try {
            // Set the error variable
            var templateError = {
                type: exception.name,
                value: exception.message,
                traceback: exception.stack
            };
            scope.set( 
                context.getConf().templateErrorVarName, 
                templateError 
            );
            
            // Exit if there is no on-error expression defined
            var content = scope.get( context.getConf().onErrorVarName );
            if ( content == null ) {
                log.fatal( exception );
                scope.endElement();
                return false;
            }
            
            log.error( exception );
            scope.endElement();
            
            contentHelper.updateNode( 
                node, 
                scope.get( context.getConf().onErrorStructureVarName ), 
                content 
            );
            
            return content;
            
        } catch ( e ) {
            log.fatal( e );
            scope.endElement();
            throw e;
        }
    };
    
    var processElement = function( node, attributes, _autoDefineHelper ) {

        // If it is defined a metalFillSlot or a metalDefineMacro do nothing
        if ( attributes.metalFillSlot || ! processMETALDefineMacro(
            node, 
            attributes.metalDefineMacro 
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }
        
        var autoDefineHelper = _autoDefineHelper || new AutoDefineHelper( node );
        
        if ( ! processDeclare( 
            node,
            attributes.talDeclare,
            autoDefineHelper
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }
        
        processOnError( 
            node,
            attributes.talOnError,
            autoDefineHelper
        );
        
        processI18nLanguage( 
            node,
            attributes.i18nLanguage,
            autoDefineHelper
        );
        
        processI18nDomain(
            node,
            attributes.i18nDomain, 
            autoDefineHelper
        );
        
        processAutoDefine( 
            node, 
            autoDefineHelper
        );
        
        ParserNodeRenderer.processDefine( 
            node,
            attributes.talDefine,  
            false,
            scope,
            indexExpressions
        );
        
        if ( ! processCondition(
                node, 
                attributes.talCondition 
        ) ) {
            // Stop processing the rest of this node as it is invisible
            return false;
        }

        var omittedTag = processOmitTag(
                node, 
                attributes.talOmitTag 
        );

        var replaced = processReplace(
                node, 
                attributes.talReplace 
        );

        if ( ! omittedTag && ! replaced ) {
            
            processAttributes(
                    node, 
                    attributes.talAttributes 
            );

            if ( ! processContent(
                    node, 
                    attributes.talContent ) ) {

                defaultContent( node );
            }
        }

        processMETALUseMacro(
                node, 
                attributes.metalUseMacro, 
                attributes.talDefine,
                autoDefineHelper
        );
        
        return true;
    };

    var defaultContent = function( node ) {

        var childNodes = node.childNodes;
        if ( ! childNodes ) {
            return;
        }

        for ( var i = 0; i < childNodes.length; i++ ) {
            var currentChildNode = childNodes[ i ];

            // Check if node is ELEMENT_NODE and not parsed yet
            if ( currentChildNode && currentChildNode.nodeType === 1
                    && ! currentChildNode.getAttribute( tags.qdup ) ) {
                process( currentChildNode );
            }
        }
    };
    
    var processOnError = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var talOnError = attributeCache.getByAttributeClass( 
            TALOnError, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talOnError.putToAutoDefineHelper( autoDefineHelper );
    };
    
    var processAutoDefine = function( node, autoDefineHelper ) {
        
        var string = autoDefineHelper.updateNode( node );
        if ( ! string ) {
            return;
        }
        
        var talDefine = attributeCache.getByAttributeClass( 
            TALDefine, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talDefine.process( scope, false );
    };

    var processI18nDomain = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var i18nDomain = attributeCache.getByAttributeClass( 
            I18NDomain, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return i18nDomain.putToAutoDefineHelper( scope, autoDefineHelper );
    };
    
    var processI18nLanguage = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }

        var i18nLanguage = attributeCache.getByAttributeClass( 
            I18NLanguage, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return i18nLanguage.putToAutoDefineHelper( autoDefineHelper );
    };
    
    var processDeclare = function( node, string, autoDefineHelper ) {

        if ( ! string ) {
            return true;
        }

        var talDeclare = attributeCache.getByAttributeClass( 
            TALDeclare, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talDeclare.process( scope, autoDefineHelper );
    };
    
    var processMETALDefineMacro = function( node, string ) {

        if ( ! string ) {
            return true;
        }

        // No sense to cache macro definitions!
        var metalDefineMacro = METALDefineMacro.build( string );
        return metalDefineMacro.process( scope, node );
    };

    var processMETALUseMacro = function( node, string, stringDefine, autoDefineHelper ) {

        if ( ! string ) {
            return;
        }
        
        // No sense to cache macro uses!
        var metalUseMacro = METALUseMacro.build( string, stringDefine, scope );
        var newNode = metalUseMacro.process( scope, node, autoDefineHelper, indexExpressions );
        newNode.setAttribute( tags.qdup, 1 );
        
        // Index node
        if ( indexExpressions ){
            attributeIndex.add( node, metalUseMacro, scope );
        }
    
        // Process new node
        return process( newNode );
    };

    var processCondition = function( node, string ) {

        if ( ! string ) {
            return true;
        }

        var talCondition = attributeCache.getByAttributeClass( 
            TALCondition, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talCondition.process( scope, node );
    };
    
    var processReplace = function( node, string ) {
        
        if ( ! string ){
            return false;
        }
        
        var talReplace = attributeCache.getByAttributeClass( 
            TALReplace, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talReplace.process( scope, node );
    };

    var processOmitTag = function( node, string ) {

        if ( string == null ) {
            return false;
        }

        var talOmitTag = attributeCache.getByAttributeClass( 
            TALOmitTag, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talOmitTag.process( scope, node, self );
    };
    
    var processContent = function( node, string ) {
        
        if ( ! string ){
            return false;
        }

        var talContent = attributeCache.getByAttributeClass( 
            TALContent, 
            string, 
            node,
            indexExpressions,
            scope
        );
        return talContent.process( scope, node );
    };
  
    var processAttributes = function( node, string ) {

        if ( ! string ) {
            return;
        }

        var talAttributes = attributeCache.getByAttributeClass( 
            TALAttributes, 
            string, 
            node,
            indexExpressions,
            scope 
        );
        return talAttributes.process( scope, node );
    };
    
    var self = {
        run: run,
        defaultContent: defaultContent
    };
    
    return self;
};

ParserNodeRenderer.processDefine = function( node, string, forceGlobal, scope, indexExpressions ) {

    if ( ! string ) {
        return;
    }

    var talDefine = attributeCache.getByAttributeClass( 
        TALDefine, 
        string, 
        node,
        indexExpressions,
        scope
    );
    return talDefine.process( scope, forceGlobal );
};

ParserNodeRenderer.cloneAndConfigureNode = function( node, indexExpressions, tags, nodeDataId ) {
    
    // Clone node
    var tmpNode = node.cloneNode( true );
    if ( 'form' in tmpNode ) {
        tmpNode.checked = false;
    }

    // Set id and related id if needed
    if ( indexExpressions ){
        tmpNode.setAttribute( tags.id, context.nextExpressionCounter() );
        tmpNode.setAttribute( tags.relatedId, nodeDataId );
    }
    
    return tmpNode;
};

ParserNodeRenderer.configureNodeForNewItem = function( tmpNode, tags, parentNode, indexItem, indexToUse ) {
    
    // Remove attributes
    tmpNode.removeAttribute( tags.talRepeat );
    tmpNode.removeAttribute( 'style' );
    tmpNode.setAttribute( tags.qdup, 1 );
    
    // Configure loop attributes
    Loop.setAutoDefineAttribute( 
        tmpNode, 
        indexItem.attributeInstance.getVarName(), 
        indexToUse,
        indexItem.attributeInstance.getExpressionString(), 
        parentNode.childElementCount, 
        0
    );
};

module.exports = ParserNodeRenderer;

}).call(this)}).call(this,require('_process'))

},{"../attributes/I18N/i18nDomain.js":8,"../attributes/I18N/i18nLanguage.js":9,"../attributes/METAL/metalDefineMacro.js":10,"../attributes/METAL/metalUseMacro.js":12,"../attributes/TAL/contentHelper.js":13,"../attributes/TAL/talAttributes.js":14,"../attributes/TAL/talCondition.js":15,"../attributes/TAL/talContent.js":16,"../attributes/TAL/talDeclare.js":17,"../attributes/TAL/talDefine.js":18,"../attributes/TAL/talOmitTag.js":19,"../attributes/TAL/talOnError.js":20,"../attributes/TAL/talRepeat.js":21,"../attributes/TAL/talReplace.js":22,"../attributes/attributeIndex.js":23,"../cache/attributeCache.js":24,"../context.js":27,"../expressions/evaluateHelper.js":44,"../logHelper.js":74,"./autoDefineHelper.js":76,"./loop.js":88,"./nodeAttributes.js":90,"_process":5}],94:[function(require,module,exports){
/* 
    Class ParserPreloader
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var nodeRemover = require( './nodeRemover.js' );
var Scope = require( '../scopes/scope.js' );
var i18nHelper = require( '../i18n/i18nHelper.js' );
var resolver = require( '../resolver.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );

var ParserPreloader = function( _parserOptions, _callback, _failCallback, _declaredRemotePageUrls, _i18n, _notRemoveGeneratedTags, _maxFolderDictionaries ) {
    
    var parserOptions = _parserOptions;
    var callback = _callback;
    var failCallback = _failCallback;
    var declaredRemotePageUrls = _declaredRemotePageUrls;
    var i18n = _i18n;
    var notRemoveGeneratedTags = _notRemoveGeneratedTags;
    var maxFolderDictionaries = _maxFolderDictionaries;
    
    var run = function(){

        try {
            if ( ! notRemoveGeneratedTags ){
                nodeRemover.removeGeneratedNodes( parserOptions.root );
                /*
                attributeIndex.removeMultipleNodes(
                    nodeRemover.removeGeneratedNodes( parserOptions.root )
                );
                */
            }

            var scope = new Scope( 
                parserOptions.dictionary, 
                parserOptions.dictionaryExtension, 
                true 
            );

            scope.loadFolderDictionariesAsync( 
                maxFolderDictionaries, 
                window.location,
                function(){
                    context.setFolderDictionaries( scope.folderDictionaries );

                    i18nHelper.loadAsyncAuto( 
                        parserOptions.dictionary,
                        i18n,
                        function(){
                            resolver.loadRemotePages( 
                                scope,
                                declaredRemotePageUrls,
                                callback,
                                failCallback
                            );
                        },
                        failCallback
                    );
                } 
            );

        } catch( e ){
            log.fatal( 'Exiting init method of ZPT with errors: ' + e );
            throw e;
        }
    };

    
    var self = {
        run: run
    };
    
    return self;
};

module.exports = ParserPreloader;

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../i18n/i18nHelper.js":73,"../logHelper.js":74,"../resolver.js":97,"../scopes/scope.js":99,"./nodeRemover.js":91}],95:[function(require,module,exports){
(function (process){(function (){
/* 
    Class ParserRenderer
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeCache = require( '../cache/attributeCache.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var nodeRemover = require( './nodeRemover.js' );
var scopeBuilder = require( '../scopes/scopeBuilder.js' );
var ParserNodeRenderer = require( './parserNodeRenderer.js' );

var ParserRenderer = function( _parserOptions, _target, _dictionaryExtension, _notRemoveGeneratedTags, _resetIndex, _goToURLHash ) {
    
    var parserOptions = _parserOptions;
    var target = _target;
    var dictionaryExtension = _dictionaryExtension;
    var notRemoveGeneratedTags = _notRemoveGeneratedTags;
    var resetIndex = _resetIndex;
    var goToURLHash = _goToURLHash;
    
    var run = function(){
        process();
    };
    
    var process = function(){

        try {
            if ( ! target ){
                throw 'Unable to process null root or target!';
            }

            if ( ! notRemoveGeneratedTags ){
                nodeRemover.removeGeneratedNodes( target );
                /*
                attributeIndex.removeMultipleNodes(
                    nodeRemover.removeGeneratedNodes( target )
                );
                */
            }

            if ( resetIndex ){
                attributeIndex.reset();
                attributeCache.reset();
            }

            processAllTargetElements();
            
            if ( goToURLHash ){
                processGoToURLHash();
            }

        } catch( e ){
            log.fatal( 'Exiting run method of ZPT with errors: ' + e );
            context.errorFunction( e );
            //throw e;
        }
    };

    var processAllTargetElements = function() {

        // Is multiroot?
        if ( Array.isArray( target ) ){ 
            // There are several roots
            for ( var c = 0; c < target.length; c++ ) {
                process1Target( target[ c ] );
            }
        } else {
            // There is only one root
            process1Target( target );
        }
    };

    var process1Target = function( currentTarget ) {

        var parserNodeRenderer = new ParserNodeRenderer( 
            currentTarget, 
            scopeBuilder.build( 
                parserOptions, 
                currentTarget, 
                dictionaryExtension,
                parserOptions.command === 'partialRender'
            ),
            parserOptions.indexExpressions
        );

        parserNodeRenderer.run();
    };
    
    var processGoToURLHash = function(){
        
        var id = decodeURI( window.location.hash ).substr( 1 );
        if ( ! id ){
            return;
        }
        
        var element = window.document.getElementById( id );
        if ( ! element ){
            log.warn( 'Unable to go to URL hash. Element with id "' + id + '" not found!' );
            return;
        }

        // Go to hash
        window.location.href = '#' + id;
    };
    
    var self = {
        run: run
    };
    
    return self;
};

module.exports = ParserRenderer;

}).call(this)}).call(this,require('_process'))

},{"../attributes/attributeIndex.js":23,"../cache/attributeCache.js":24,"../context.js":27,"../logHelper.js":74,"../scopes/scopeBuilder.js":100,"./nodeRemover.js":91,"./parserNodeRenderer.js":93,"_process":5}],96:[function(require,module,exports){
/* 
    Class ParserUpdater
*/
"use strict";

var context = require( '../context.js' );
var log = require( '../logHelper.js' );
var attributeIndex = require( '../attributes/attributeIndex.js' );
var scopeBuilder = require( '../scopes/scopeBuilder.js' );
var ParserNodeRenderer = require( './parserNodeRenderer.js' );
var nodeRemover = require( './nodeRemover.js' );
var utils = require( '../utils.js' );
var dictionaryActionBuilder = require( './dictionaryActions/dictionaryActionBuilder.js' );
var AbstractArrayAction = require( './dictionaryActions/abstractArrayAction.js' );

var ParserUpdater = function( _dictionaryChanges, _dictionaryActions, _parserOptions ) {
    
    var dictionaryChanges = _dictionaryChanges;
    var dictionaryActions = _dictionaryActions;
    var parserOptions = _parserOptions;
    
    var scopeMap = {};
    var nodeAttributes, 
        statistics;
    var dictionaryActionsInstances;
    
    var initializeDictionaryActionsInstances = function(){
        
        dictionaryActionsInstances = [];
        
        if ( ! dictionaryActions ){
            return;
        }
        
        for ( var i = 0; i < dictionaryActions.length; ++i ){
            var action = dictionaryActions[ i ];
            var newActionInstance = dictionaryActionBuilder.build( action, parserOptions.dictionary );
            if ( Array.isArray( newActionInstance ) ){
                dictionaryActionsInstances = dictionaryActionsInstances.concat( newActionInstance );
            } else {
                dictionaryActionsInstances.push( newActionInstance );
            }
        }
    };
    initializeDictionaryActionsInstances();
    
    var getStatistics = function(){
        return statistics;
    };

    var updateDictionaryForDictionaryChanges = function(){
        
        if ( dictionaryChanges ){
            utils.extend( parserOptions.dictionary, dictionaryChanges );
        }
    };
    
    var addUpdatedToStatistics = function(){
        ++statistics.totalUpdates;
    };
    
    var addRemovedToStatistics = function(){
        ++statistics.removedNodeUpdates;
    };
    
    var run = function(){
        
        try {
            // Check the index was built
            if ( ! parserOptions.indexExpressions ){
                throw 'Unable to update, no index built! Set indexExpressions to true!';
            }
            
            // Init some vars
            nodeAttributes = {};
            statistics = {
                totalUpdates: 0,
                removedNodeUpdates: 0
            };

            // Do all required HTML updates
            updateHTML();
            
        } catch( e ){
            log.fatal( 'Exiting run method of update command of ZPT with errors: ' + e );
            context.errorFunction( e );
        }
    };

    var updateHTML = function(){

        if ( updateHTMLFromActions( 0 ) ){
            updateHTMLFromVarChange();
        }
    };
    
    var updateHTMLFromActions = function( initial ){

        for ( var i = initial; i < dictionaryActionsInstances.length; ++i ){
            var actionInstance = dictionaryActionsInstances[ i ];
            
            // Update dictionary using action
            actionInstance.updateDictionary( parserOptions.dictionary );
            
            // Get the list of changes related to varName
            var list = attributeIndex.getVarsList( actionInstance.id );
            if ( ! list ){
                continue;
            }
            
            // Iterate list and update HTML if required
            if ( ! updateHTMLFromVarsList( actionInstance, i, 0, list ) ){
                return false;
            }
            /*
            for ( var j = 0; j < list.length; j++ ) {
                var indexItem = list[ j ];
                if ( ! actionInstance.attributeInstanceIsRelated( indexItem.attributeInstance ) ){
                    if ( ! utils.isFunction( indexItem.attributeInstance.updatableFromAction ) 
                            || indexItem.attributeInstance.updatableFromAction( self, findNodeById( indexItem.nodeId ) ) ){
                        buildDataFromVarChangeExcluding( actionInstance.id );
                    }
                    continue;
                }
                
                if ( ! actionInstance.updateHTML( 
                    indexItem, 
                    self, 
                    actionInstance, 
                    { 
                        actionInstance: actionInstance,
                        i: i, 
                        list: list,
                        initialJ: j 
                    }
                ) ){
                    return false;
                }
            }
            */
        }
        
        return true;
    };
    
    var updateHTMLFromVarsList = function( actionInstance, i, initialJ, list ){
        
        // Iterate list and update HTML if required
        for ( var j = initialJ; j < list.length; j++ ) {
            var indexItem = list[ j ];
            if ( ! actionInstance.attributeInstanceIsRelated( indexItem.attributeInstance ) ){
                if ( ! utils.isFunction( indexItem.attributeInstance.updatableFromAction ) 
                        || indexItem.attributeInstance.updatableFromAction( self, findNodeById( indexItem.nodeId ) ) ){
                    buildDataFromVarChangeExcluding( actionInstance.id );
                }
                continue;
            }

            if ( ! actionInstance.updateHTML( 
                indexItem, 
                self, 
                actionInstance, 
                { 
                    actionInstance: actionInstance,
                    i: i, 
                    initialJ: j,
                    list: list
                }
            ) ){
                return false;
            }
        }
        
        return true;
    };
    
    var continueUpdateHTML = function( continueData ){

        updateHTMLFromVarsList(
            continueData.actionInstance, 
            continueData.i, 
            continueData.initialJ + 1, 
            continueData.list
        );
        
        if ( updateHTMLFromActions( continueData.i + 1 ) ){
            updateHTMLFromVarChange();
        }
    };
    
    var runAnimation = function( actionInstance, node, callback ){
        
        // Build combinedCallback combining callback and actionInstance.animationCallback
        var combinedCallback = function(){
                if ( callback ){
                    callback();
                } else {
                    context.getAnimationManager().reset( node );
                }
                if ( actionInstance.animationCallback ){
                    actionInstance.animationCallback();
                }
            };
        
        // Get animation manager to run animation
        context.getAnimationManager().animate( actionInstance, node, combinedCallback );
    };
    /*
    var runAnimation = function( actionInstance, node, callback ){
        
        // Build combinedCallback combining callback and actionInstance.animationCallback
        var combinedCallback = ! callback && ! actionInstance.animationCallback? 
            undefined:
            function(){
                if ( callback ){
                    callback();
                }
                if ( actionInstance.animationCallback ){
                    actionInstance.animationCallback();
                }
            };
        
        // Get animation manager to run animation
        context.getAnimationManager().animate( actionInstance, node, combinedCallback );
    };
    */
    
    var updateHTMLFromVarChange = function(){
        
        // Update dictionary
        updateDictionaryForDictionaryChanges();
        
        // Build data
        for ( var varName in dictionaryChanges ){
            buildDataFromVarChange( varName );
        }
        
        // Update attributes
        for ( var i in nodeAttributes ) {
            var currentNodeAttributeList = nodeAttributes[ i ];
            for ( var j in currentNodeAttributeList ){
                updateAttribute( currentNodeAttributeList[ j ] );   
            }
        }
    };
    
    var buildDataFromVarChange = function( varName ){
        
        // Get the list of changes related to varName
        var list = attributeIndex.getVarsList( varName );
        buildDataFromList( varName, list );
    };
    
    var buildDataFromVarChangeExcluding = function( varName ){
        
        // Get the list of changes related to varName
        var list = attributeIndex.getVarsList( varName );
        
        var filtered = list.filter(
            function( indexItem, index, arr ){
                return ! AbstractArrayAction.staticAttributeInstanceIsRelated(
                    indexItem.attributeInstance
                );
            }
        );
        
        buildDataFromList( varName, filtered );
    };
    
    var buildDataFromList = function( varName, list ){
        
        if ( ! list ){
            return;
        }
        
        // Build data about all changes
        var length = list.length;
        for ( var i = 0; i < length; i++ ) {
            addNewNodeAttribute( varName, list[ i ] );
            /*
            if ( ! addNewNodeAttribute( varName, list[ i ] ) ){
                attributeIndex.removeVar( varName, list[ i ].nodeId );
            }
            */
        }
    };
    
    var findNodeById = function ( nodeId ) {
        
        return window.document.querySelector( 
            '[' + context.getTags().id + '="' + nodeId + '"]' 
        );
    };

    var addNewNodeAttribute = function( varName, indexItem ){

        var attributeInstance = indexItem.attributeInstance;
        var node = findNodeById( indexItem.nodeId );
        if ( ! node ){
            // Removed node!
            ++statistics.removedNodeUpdates;
            return false;
        }

        // Add data to nodeData
        var thisNodeData = nodeAttributes[ indexItem.nodeId ];
        if ( ! thisNodeData ){
            thisNodeData = {};
            nodeAttributes[ indexItem.nodeId ] = thisNodeData;
        }
        var elementId = indexItem.groupId? 
            attributeInstance.type + '/' + indexItem.groupId: 
            attributeInstance.type;
        thisNodeData[ elementId ] = indexItem;

        return true;
    };
    
    var updateAttribute = function( indexItem ){
        
        var attributeInstance = indexItem.attributeInstance;
        var node = findNodeById( indexItem.nodeId );
        if ( ! node ){
            // Removed node!
            ++statistics.removedNodeUpdates;
            return false;
        }
        
        ++statistics.totalUpdates;
        
        var scope = getNodeScope( node, indexItem.nodeId );
        
        attributeInstance.update( self, node, scope, indexItem );
        
        return true;
    };

    var getNodeScope = function( node, nodeId ){
        
        if ( ! nodeId ){
            nodeId = node.getAttribute( context.getTags().id );
        }
        
        var thisScope = scopeMap[ nodeId ];
        
        if ( ! thisScope ){
            thisScope = scopeBuilder.build( 
                parserOptions, 
                node, 
                undefined,
                true
            );
            scopeMap[ nodeId ] = thisScope;
        }

        return thisScope;
    };
    
    var updateNode = function( node, mustRemoveGeneratedNodes ){
        
        // Remove related to node nodes
        nodeRemover.removeMultipleNodes( node, mustRemoveGeneratedNodes );
        /*
        attributeIndex.removeMultipleNodes(
            nodeRemover.removeMultipleNodes( node, mustRemoveGeneratedNodes )
        );
        */
        
        // Instance and invoke parserNodeRenderer to update node
        var parserNodeRenderer = new ParserNodeRenderer( 
            node, 
            scopeBuilder.build( 
                parserOptions, 
                node, 
                undefined,
                true
            ),
            true
        );
        parserNodeRenderer.run();
    };
    /*
    var deleteNode = function( node ){
        node.parentNode.removeChild( node );
    };
    */
    var self = {
        run: run,
        updateNode: updateNode,
        //deleteNode: deleteNode,
        findNodeById: findNodeById,
        getNodeScope: getNodeScope,
        getStatistics: getStatistics,
        addUpdatedToStatistics: addUpdatedToStatistics,
        addRemovedToStatistics: addRemovedToStatistics,
        runAnimation: runAnimation,
        continueUpdateHTML: continueUpdateHTML
    };
    
    return self;
};

module.exports = ParserUpdater;

},{"../attributes/attributeIndex.js":23,"../context.js":27,"../logHelper.js":74,"../scopes/scopeBuilder.js":100,"../utils.js":101,"./dictionaryActions/abstractArrayAction.js":79,"./dictionaryActions/dictionaryActionBuilder.js":85,"./nodeRemover.js":91,"./parserNodeRenderer.js":93}],97:[function(require,module,exports){
/* 
    resolver singleton class
*/
var utils = require( './utils.js' );
var context = require( './context.js' );
var expressionBuilder = require( './expressions/expressionBuilder.js' );

module.exports = (function( ) {
    "use strict";
    
    var macros = {};
    var remotePages = {};
    
    var getNode = function( macroKey, scope ) {
        
        var node = macros[ macroKey ];
        
        if ( ! node ){
            node = loadNode( macroKey, scope );
        }
        
        return node? node.cloneNode( true ): undefined;
    };
    /*
    var isRemote = function( macroKey ){
        return -1 != macroKey.indexOf( context.getConf().macroDelimiter );
    };*/
    
    var getMacroDataUsingExpression = function ( macroKeyExpression, scope ){
        
        var macroKey = macroKeyExpression.evaluate( scope );
        
        if ( ! macroKey ){
            return {
                macroId: null,
                url: null
            };
        }
        
        return getMacroData( macroKey, scope );
    };
    
    var getMacroDataUsingExpressionString = function ( macroKeyExpressionString, scope ){
        
        var macroKeyExpression = expressionBuilder.build( macroKeyExpressionString );
        return getMacroDataUsingExpression( macroKeyExpression, scope );
    };
    
    var getMacroData = function ( macroKey, scope ){

        var index = macroKey.indexOf( context.getConf().macroDelimiter );
        
        return index === -1?
            {
                macroId: macroKey,
                url: null
            }:
            {
                macroId: macroKey.substring( 0, index ),
                url: buildURL ( macroKey.substring( 1 + index ) )
            };
    };
    
    var builDefineMacroSelector = function( macroId ){
        return "[" + filterSelector( context.getTags().metalDefineMacro ) + "='" + macroId + "']";
    };
    
    var loadNode = function( macroKey, scope ){

        var macroData = getMacroData( macroKey, scope );

        if ( macroData.url ){
            // Node is in another page
            return loadRemoteNode( macroKey, macroData );
        }
        
        // No url set
        var urlInScope = scope.get( context.getConf().externalMacroUrlVarName );
        if ( urlInScope ){
            // Try to find node in another page but using a previously defined url
            macroData.url = urlInScope;
            var remoteNode = loadRemoteNode( macroKey, macroData );
            if ( remoteNode ){
                // Node is found in another page
                return remoteNode;
            }
        }
        
        // Node is in this page
        var macroId = macroData.macroId;
        var selector = builDefineMacroSelector( macroId );
        var node = window.document.querySelector( selector );

        if ( ! node ){
            throw "Node using selector '" + selector + "' is null!";
        }

        return configureNode( 
            node.cloneNode( true ), 
            macroId,
            macroKey );
        
    };
    var loadRemoteNode = function( macroKey, macroData ){
        
        var element = remotePages[ macroData.url ];
        
        if ( ! element ){
            throw 'Macros in URL ' + macroData.url + ' not preloaded!';
        }
        
        var selector = builDefineMacroSelector( macroData.macroId );
        var node = element.querySelector( selector );
        
        if ( ! node ){
            return undefined;
        }
        
        return configureNode( 
                    node.cloneNode( true ), 
                    macroData.macroId,
                    macroKey );
    };
    
    var buildRemotePageUrlList = function( scope, declaredRemotePageUrls ){
        
        var remotePageUrls = declaredRemotePageUrls.slice();
        
        var list = document.querySelectorAll( 
            "[" + filterSelector( context.getTags().metalUseMacro ) + "]"
        );
        var currentMacroUse;
        var pos = 0;
        while ( currentMacroUse = list[ pos++ ] ) {
            var macroKeyExpressionString = currentMacroUse.getAttribute( context.getTags().metalUseMacro );
            
            try {
                var macroData = getMacroDataUsingExpressionString( macroKeyExpressionString, scope );

                var url = macroData.url;
                if ( url && remotePageUrls.indexOf( url ) === -1 ){
                    remotePageUrls.push( url );
                }
            } catch ( exception ){
                // Macrodata could not be resolved, do nothing
            }
        }
                                                              
        return remotePageUrls;
    };
    
    // Add preffix if the URL is not absolute
    var buildURL = function( URL ){
        return URL.startsWith( '/' )? URL: context.getConf().externalMacroPrefixURL + URL;
    };
    
    var loadRemotePages = function( scope, declaredRemotePageUrls, callback, failCallback ){

        var remotePageUrls = buildRemotePageUrlList( scope, declaredRemotePageUrls );
        var pending = remotePageUrls.length;
        remotePages = {};
        
        if ( ! pending ){
            if ( callback && utils.isFunction( callback ) ){
                callback();   
            }
            return;
        }
        
        for ( var c = 0; c < remotePageUrls.length; c++ ) {
            var currentPageUrl = buildURL( remotePageUrls[ c ] );
            
            /* jshint loopfunc: true */
            utils.ajax(
                {
                    url: currentPageUrl,
                    //dataType: 'html',
                    done: function( html ) {
                        var element = document.createElement( 'div' );
                        element.innerHTML = html;
                        remotePages[ this.url ] = element;
                        if ( --pending == 0 && callback && utils.isFunction( callback ) ){
                            callback();
                        }
                    },
                    fail: function( jqXHR, textStatus, error ) {
                        context.asyncError( currentPageUrl, error, failCallback );
                    }
                }
            );
            /*
            $.ajax({
                url: currentPageUrl,
                dataType: 'html'
            }).done( function( html ) {
                var element = $( '<div></div>' );
                element.html( html );
                remotePages[ this.url ] = element;
                if ( --pending == 0 && callback && utils.isFunction( callback ) ){
                    callback();
                }
            }).fail( function( jqXHR, textStatus, error ) {
                context.asyncError( currentPageUrl, error, failCallback );
            });
            */
        }
    };
                  
    var configureNode = function( node, macroId, macroKey ){
        node.removeAttribute( context.getTags().metalDefineMacro );
        node.setAttribute( context.getTags().metalMacro, macroId );
        
        macros[ macroKey ] = node;
        
        return node;
    };
    
    var getMacroKey = function( macroKeyExpression, scope ){
        
        var macroData = getMacroDataUsingExpression( macroKeyExpression, scope );
        
        return macroData.url? macroData.macroId + context.getConf().macroDelimiter + macroData.url: macroData.macroId;
    };
    
    // Must filter to replace : by \\:
    var filterSelector = function( selector ){
        return selector.replace( /:/gi, '\\:' );
    };
    
    return {
        getNode: getNode,
        //isRemote: isRemote,
        loadRemotePages: loadRemotePages,
        getMacroData: getMacroData,
        getMacroKey: getMacroKey,
        filterSelector: filterSelector
    };
})();

},{"./context.js":27,"./expressions/expressionBuilder.js":46,"./utils.js":101}],98:[function(require,module,exports){
/* 
    ReactiveDictionary class 
*/
"use strict";

var zpt = require( '../main.js' );

var ReactiveDictionary = function( _nonReactiveDictionary, _initialAutoCommit ) {
    
    // Init some vars
    var self = this;
    this._privateScope = {
        nonReactiveDictionary: _nonReactiveDictionary,
        autoCommit: true,
        dictionaryChanges: {},
        dictionaryActions: [],
        commit: function(){
            zpt.run({
                command: 'update',
                dictionaryChanges: self._privateScope.dictionaryChanges,
                dictionaryActions: self._privateScope.dictionaryActions
            });
            self._privateScope.dictionaryChanges = {};
            self._privateScope.dictionaryActions = [];
        }
    };

    // Define some methods
    this._getNonReactiveDictionary = function(){
        return this._privateScope.nonReactiveDictionary;
    };
    
    this._isAutoCommit = function(){
        return this._privateScope.autoCommit;
    };
    
    this._setAutoCommit = function( _autoCommit ){
        this._privateScope.autoCommit = _autoCommit;
    };
    
    this._commit = function(){
        this._privateScope.commit();
    };

    this._addActions = function( dictionaryActions ){
        
        // Record this actions to commit it later
        self._privateScope.dictionaryActions = self._privateScope.dictionaryActions.concat( dictionaryActions );
        
        // Commit the change only if autoCommit is on
        if ( self._isAutoCommit() ){
            self._privateScope.commit();
        }
    };
    
    this._addVariable = function( key, value ){
        
        // Set the value in nonReactiveDictionary
        self._privateScope.nonReactiveDictionary[ key ] = value;
        
        // Define getter and setter
        this._defineProperty( 
            this._privateScope.nonReactiveDictionary, 
            key 
        );
    };

    this._defineProperty = function( dictionary, key ){

        // Define property to set getter and setter
        Object.defineProperty(
            self, 
            key, 
            {
                enumerable: true,
                configurable: true,
                get: function () { 
                    return dictionary[ key ];
                },
                set: function ( value ) {
                    // Record this change to commit it later
                    self._privateScope.dictionaryChanges[ key ] = value;

                    // Commit the change only if autoCommit is on
                    if ( self._isAutoCommit() ){
                        self._privateScope.commit();
                    }
                }
            }
        );
    };
    
    // Initialize
    this._initialize = function( dictionary ){
        
        // Initialize autoCommit
        if ( _initialAutoCommit !== undefined ){
            this._setAutoCommit( _initialAutoCommit );
        }
        
        // Iterate properties in dictionary to define setters and getters
        var keys = Object.keys( dictionary );
        for ( var i = 0; i < keys.length; i++ ){
            var key = keys[ i ];
            var property = Object.getOwnPropertyDescriptor( dictionary, key );
            if ( property && property.configurable === false ) {
                continue;
            }
            
            // Define getter and setter
            (function( key ) {
                self._defineProperty( dictionary, key );
            })( key );
        }
    };
    this._initialize( this._privateScope.nonReactiveDictionary );
};

module.exports = ReactiveDictionary;

},{"../main.js":75}],99:[function(require,module,exports){
/* 
    Class Scope 
*/
"use strict";

var context = require( '../context.js' );
var utils = require( '../utils.js' );
var loadjs = require( 'loadjs' );

var Scope = function( _dictionary, _dictionaryExtension, addCommonVars, _folderDictionaries ) {
    
    this.dictionary = _dictionary || {};
    this.dictionaryExtension = _dictionaryExtension || {};
    this.vars = {};
    this.changesStack = [];
    this.nocallVars = {};
    this.folderDictionaries = _folderDictionaries || [];
    this.globalVarsExpressions = {};
    
    if ( addCommonVars ){
        this.setCommonVars();
    }
    this.setMandatoryVars();
};

Scope.prototype.setMandatoryVars = function(){

    // Register nothing var
    this.setVar( 
        context.getConf().nothingVarName, 
        context.getConf().nothingVarValue 
    );
    
    // Register default var
    this.setVar( 
        context.getConf().defaultVarName, 
        context.getConf().defaultVarValue 
    );
};

Scope.prototype.setCommonVars = function(){
    
    // Register window object if it exists
    if ( window ){
        this.setVar( 
            context.getConf().windowVarName, 
            window 
        );
    }

    // Register context
    this.setVar( 
        context.getConf().contextVarName, 
        context 
    );
};

Scope.prototype.startElement = function(){
    
    var vars = {
        varsToUnset: [],
        varsToSet: {},
        expressions: {},
        impliedDeclaredVars: []
    };

    this.changesStack.push( vars );

    return vars;
};

Scope.prototype.currentVars = function(){
    return this.changesStack[ this.changesStack.length - 1 ];
};

Scope.prototype.setVar = function( name, value ) {
    this.vars[ name ] = value;
};

Scope.prototype.getWithoutEvaluating = function( name ) {
    
    var value;
    
    value = this.vars[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    value = this.dictionaryExtension[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    value = this.dictionary[ name ];
    if ( value !== undefined ){
        return value;
    }
    
    for ( var i = 0; i < this.folderDictionaries.length; ++i ){
        value = this.folderDictionaries[ i ][ name ];
        if ( value !== undefined ){
            return value;
        }
    }
    
    return undefined;
};

Scope.prototype.get = function( name ) {

    var value = this.getWithoutEvaluating( name );
    
    if ( ! this.nocallVars[ name ] ){
        return value;
    }
    
    return value && utils.isFunction( value.evaluate )?
        value.evaluate( this ): 
        'Error evaluating property "' + name + '": ' + value;
};

Scope.prototype.unset = function( name ) {
    delete this.vars[ name ];
};

Scope.prototype.endElement = function ( ) {

    var vars = this.changesStack.pop(); 

    var varsToUnset = vars.varsToUnset;
    var varsToSet = vars.varsToSet; 

    for ( var i = 0; i < varsToUnset.length; ++i ){
        this.unset( varsToUnset[ i ] );
    }

    for ( var name in varsToSet ){
        var value = varsToSet[ name ];
        this.setVar( name, value );
    }
};

Scope.prototype.set = function ( name, value, isGlobal, nocall, _expression ) {
    
    var expression = _expression === undefined? null: _expression;
    
    if ( ! isGlobal ){

        // Local vars
        var vars = this.currentVars();
        var currentValue = this.getWithoutEvaluating( name );

        if ( currentValue != null ){
            vars.varsToSet[ name ] = currentValue;
            
        } else {
            vars.varsToUnset.push( name );
        }
        
        vars.expressions[ name ] = expression;
        
        if ( this.isStrictMode() ){
            vars.impliedDeclaredVars.push( name );
        }
        
    } else {
        
        // Global vars
        this.globalVarsExpressions[ name ] = expression; 
    }
    
    // Common to global and local vars
    this.setVar( name, value );
    
    // Add to nocallVars if needed
    if ( nocall ){
        this.nocallVars[ name ] = true;
    }
};

Scope.prototype.loadFolderDictionariesAsync = function ( maxFolderDictionaries, location, callback ) {
    
    if ( ! maxFolderDictionaries ) {
        callback();
        return;
    }
    
    var urlList = this.buildUrlListOfFolderDictionaries( maxFolderDictionaries, location );
    this.loadFolderDictionary(
        maxFolderDictionaries,
        callback,
        urlList, 
        0
    );
};

Scope.prototype.loadFolderDictionary = function ( maxFolderDictionaries, callback, urlList, i ) {
    
    var instance = this;
    
    var loadjsCallback = function( url, success ){
        
        // Treat js file only if load is sucessfull
        if ( success && window.folderDictionary ){
            instance.folderDictionaries.push( window.folderDictionary );
        }
            
        // Run callback and return if the urlList is over
        if ( i === urlList.length){
            callback();
            return;
        }

        // Continue, the urlList is not over
        instance.loadFolderDictionary(
            maxFolderDictionaries, 
            callback,
            urlList, 
            i
        );
    };
    
    var url = urlList[ i++ ];
    loadjs(
        url, 
        {
            success: function() { 
                loadjsCallback( url, true );
            },
            error: function() { 
                loadjsCallback( url, false );
            }
        }
    );
};

Scope.prototype.buildUrlListOfFolderDictionaries = function ( maxFolderDictionaries, location ) {
    
    var result = [];
    
    var c = 0;
    var path = location.pathname;
    var lastIndex = path.lastIndexOf( '/' );
    while ( lastIndex !== -1 && ++c <= maxFolderDictionaries ){
        var parent = path.substr( 0, lastIndex );
        result.push( 
            location.origin + parent + '/' + 'folderDictionary.js' 
        );
        lastIndex = parent.lastIndexOf( '/' );
    }
    
    return result;
};

Scope.prototype.isStrictMode = function(){
    return context.isStrictMode() || this.get( context.getConf().strictModeVarName );
};

Scope.prototype.isValidVariable = function( name ){
    
    // If strict mode is off all variable are valid
    if ( ! this.isStrictMode() ){
        return true;
    }
    
    // If the variable is declared return true
    var declared = this.get( context.getConf().declaredVarsVarName );
    var isDeclared = declared && declared.indexOf? 
        declared.indexOf( name ) !== -1: 
        false;
    if ( isDeclared ){
        return true;
    }
    
    // Check if the variable is implicitly declared
    for ( var i = this.changesStack.length - 1; i >= 0; --i ){
        var vars = this.changesStack[ i ];
        var isImplied = vars.impliedDeclaredVars.indexOf( name ) !== -1;
        if ( isImplied ){
            return true;
        }
    }
    
    return false;
};

Scope.prototype.getVarExpression = function ( name ) {
    
    var expression = this.getExpressionFromLocal( name );
    return expression !== undefined? expression: this.globalVarsExpressions[ name ];
};

Scope.prototype.getExpressionFromLocal = function ( name ) {

    for ( var i = this.changesStack.length - 1; i >= 0; --i ){
        var vars = this.changesStack[ i ];
        var expression = vars.expressions[ name ];
        if ( expression !== undefined ){
            return expression;
        }
    }
    
    return undefined;
};

Scope.prototype.isLocalVar = function ( name ) {
    return this.vars[ name ] !== undefined;
};

module.exports = Scope;

},{"../context.js":27,"../utils.js":101,"loadjs":2}],100:[function(require,module,exports){
/* 
    scopeBuilder singleton class
*/
"use strict";

var context = require( '../context.js' );
var Scope = require( './scope.js' );
var utils = require( '../utils.js' );
var ParserNodeRenderer = require( '../parsers/parserNodeRenderer.js' );

module.exports = (function() {
    
    var keyLength = 6;
    
    var build = function( parserOptions, target, dictionaryExtension, mustUpdate ) {

        var scope = new Scope( 
            parserOptions.dictionary, 
            dictionaryExtension, 
            true,
            context.getFolderDictionaries()
        );
        
        if ( mustUpdate ){
            update( parserOptions, target, scope );
        }
        
        return scope;
    };
    
    var update = function( parserOptions, target, scope ) {
        
        // Get root key
        var rootMap = markAllRoots( parserOptions );
        var rootKeyTag = getRootKeyTag();
        var root = getRoot( parserOptions, target, rootMap );
        var rootKey =  root.getAttribute( rootKeyTag );
        
        var talDefineTag = context.getTags().talDefine;
        var talAutoDefineTag = context.getTags().talAutoDefine;
        
        var node = target.parentNode;
        var c = 0;
        var itemsList = [];
        
        do {
            // Add talDefine
            var talDefine = node.getAttribute( talDefineTag );
            if ( talDefine ){
                itemsList.push( talDefine );
            }
            
            // Add talAutoDefine
            var talAutoDefine = node.getAttribute( talAutoDefineTag );
            if ( talAutoDefine ){
                itemsList.push( talAutoDefine );
            }
            
            var nodeKey = node.getAttribute( rootKeyTag );
            if ( nodeKey && nodeKey === rootKey ){
                return processListOfDefines( 
                    scope, 
                    itemsList, 
                    node,
                    parserOptions.indexExpressions
                );
            }
            
            node = node.parentNode;
            
        } while ( node.nodeType !== 9 && ++c < 100 );
        
        throw 'Error trying to update scope: root not found!';
    };
    
    var processListOfDefines = function( scope, itemsList, node, indexExpressions ){
        
        for ( var c = itemsList.length - 1; c >= 0; c-- ) {
            var talDefine = itemsList[ c ];
            ParserNodeRenderer.processDefine(
                node, 
                talDefine, 
                true,
                scope,
                indexExpressions
            );
        }
    };
    
    var getRoot = function( parserOptions, target, rootMap ){
        
        if ( ! Array.isArray( parserOptions.root ) ){ 
            return parserOptions.root;
        }
        
        var rootKeyTag = getRootKeyTag();
        var node = target;
        var c = 0;
        do {
            var rootKey =  node.getAttribute( rootKeyTag );
            if ( rootKey ){
                return rootMap[ rootKey ];
            }

            node = node.parentNode;

        } while ( node.nodeType !== 9 && ++c < 100 );
        
        throw 'Error trying to get root: not found!';
    };
    
    var markAllRoots = function( parserOptions ){

        var rootMap = {};
        var root = parserOptions.root;

        // Is multiroot?
        if ( Array.isArray( root ) ){ 
            // There are several roots
            for ( var c = 0; c < root.length; c++ ) {
                markAsRoot( root[ c ], rootMap );
            }
        } else {
            // There is only one root
            markAsRoot( root, rootMap );
        }

        return rootMap;
    };
    
    var markAsRoot = function( node, rootMap ){
        
        // Build the key
        var key = buildKey();

        // Put a copy of scope into the cache
        rootMap[ key ] = node;

        // Save the key as an attribute of the node
        node.setAttribute( getRootKeyTag(), key );
    };
    
    var buildKey = function(){
        return utils.generateId( keyLength );
    };
    
    var getRootKeyTag = function(){
        return context.getTags().rootKey;
    };
    
    return {
        build: build
    };
})();

},{"../context.js":27,"../parsers/parserNodeRenderer.js":93,"../utils.js":101,"./scope.js":99}],101:[function(require,module,exports){
/*
    utils singleton class
*/
module.exports = (function() {
    "use strict";
    
    var generateId = function ( len, _charSet ) {
        
        var charSet = _charSet || 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
        var result = '';
        for ( var i = 0; i < len; i++ ) {
            var pos = Math.floor( Math.random() * charSet.length );
            result += charSet.substring( pos, pos + 1 );
        }
        return result;
    };
    
    //var isArray = Array.isArray;
    
    var isFunction = function isFunction( obj ) {

        // Support: Chrome <=57, Firefox <=52
        // In some browsers, typeof returns "function" for HTML <object> elements
        // (i.e., `typeof document.createElement( "object" ) === "function"`).
        // We don't want to classify *any* DOM node as a function.
        return typeof obj === "function" && typeof obj.nodeType !== "number";
    };
    
    var isPlainObject = function( obj ) {
        var proto, Ctor;

        // Detect obvious negatives
        // Use toString instead of jQuery.type to catch host objects
        if ( !obj || Object.prototype.toString.call( obj ) !== "[object Object]" ) {
            return false;
        }

        proto = getProto( obj );

        // Objects with no prototype (e.g., `Object.create( null )`) are plain
        if ( !proto ) {
            return true;
        }

        // Objects with prototype are plain iff they were constructed by a global Object function
        Ctor = hasOwn.call( proto, "constructor" ) && proto.constructor;
        return typeof Ctor === "function" && fnToString.call( Ctor ) === ObjectFunctionString;
    };
    var getProto = Object.getPrototypeOf;
    var class2type = {};
    var hasOwn = class2type.hasOwnProperty;
    var fnToString = hasOwn.toString;
    var ObjectFunctionString = fnToString.call( Object );
    
    var deepExtend = function( out ) {
        out = out || {};

        for ( var i = 1; i < arguments.length; i++ ) {
            var obj = arguments[ i ];

            if ( ! obj ){
                continue;
            }
            
            for ( var key in obj ) {
                if ( obj.hasOwnProperty( key ) ) {
                    if ( typeof obj[ key ] === 'object' ){
                        out[ key ] = deepExtend( out[ key ], obj[ key ] );
                    } else {
                        out[ key ] = obj[ key ];
                    }
                }
            }
        }

        return out;
    };
    
    var extend = function(out) {
        out = out || {};

        for ( var i = 1; i < arguments.length; i++ ) {
            if ( ! arguments[ i ] ){
                continue;
            }

            for ( var key in arguments[ i ] ) {
                if ( arguments[ i ].hasOwnProperty( key ) ){
                    out[ key ] = arguments[ i ][ key ];
                }
            }
        }

        return out;
    };
    
    var ajax = function( conf ){
        
        // Check conf object
        if ( ! conf ){
            throw 'Error trying to process ajax: no arguments!';
        }
        if ( ! conf.url ){
            throw 'Error trying to process ajax: no URL defined!';
        }
        if ( ! conf.done ){
            throw 'Error trying to process ajax: no done callback defined!';
        }
        
        // Do it!
        var oReq = new window.XMLHttpRequest();
        oReq.addEventListener( 
            'load',
            function(){
                if ( this.status >= 200 && this.status < 400 ) {
                    // Success!
                    conf.done( 
                        conf.parseJSON?
                        JSON.parse( oReq.responseText ):
                        oReq.responseText
                    );
                } else {
                    // We reached our target server, but it returned an error
                    conf.fail( undefined, undefined, this.statusText );
                }
            }
        );
        if ( conf.fail ){
            oReq.addEventListener( 'error', conf.fail );
        }
        oReq.open( 'GET', conf.url );
        oReq.send();
    };
    
    var getJSON = function( conf ){
        
        conf.parseJSON = true;
        ajax( conf );
    };
    
    /*
    var getJSON = function( conf ){
        
        // Check conf object
        if ( ! conf ){
            throw 'Error trying to getJSON: no arguments!';
        }
        if ( ! conf.url ){
            throw 'Error trying to getJSON: no URL defined!';
        }
        if ( ! conf.done ){
            throw 'Error trying to getJSON: no done callback defined!';
        }
        
        // Do it!
        var oReq = new window.XMLHttpRequest();
        oReq.addEventListener( 
            'load',
            function(){
                if ( this.status >= 200 && this.status < 400 ) {
                    // Success!
                    conf.done( 
                        JSON.parse( 
                            oReq.responseText 
                        ) 
                    );
                } else {
                    // We reached our target server, but it returned an error
                    conf.fail( undefined, undefined, this.statusText );
                }
            }
        );
        if ( conf.fail ){
            oReq.addEventListener( 'error', conf.fail );
        }
        oReq.open( 'GET', conf.url );
        oReq.send();
    };
    */
    /*
    var getNodeId = function ( node ){
        return node.getAttribute( context.getTags().id );
    };
    */
    var deepEqual = function( x, y ) {
        return (x && y && typeof x === 'object' && typeof y === 'object') ?
            (Object.keys(x).length === Object.keys(y).length) && Object.keys(x).reduce(function(isEqual, key) {return isEqual && deepEqual(x[key], y[key]);}, true):
            (x === y);
    };
    
    var copyArray = function( arrayToCopy ){
        
        var result = [];
        
        for ( var i = 0; i < arrayToCopy.length; ++i ){
            result.push( arrayToCopy[ i ] );
        }
        
        return result;
    };
    
    var genericToString = function( element ){
    
        if ( element == undefined ){
            return 'undefined';
        }
        
        if ( Array.isArray( element ) ){
            var result = 'Array[ ';
            for ( var i = 0; i < element.length; ++i ){
                var separator = i === 0? '': ', ';
                result += separator + genericToString( element[ i ] );
            }
            result += ' ]';
            return result;
        }
        
        if ( isPlainObject( element ) ){
            return JSON.stringify( element );
        }
        
        // Must be numeric or string
        return element;
    };
    
    return {
        generateId: generateId,
        //isArray: isArray,
        isFunction: isFunction,
        isPlainObject: isPlainObject,
        deepExtend: deepExtend,
        extend: extend,
        getJSON: getJSON,
        ajax: ajax,
        deepEqual: deepEqual,
        copyArray: copyArray,
        genericToString: genericToString
        //getNodeId: getNodeId
    };
})();

},{}],102:[function(require,module,exports){
// generated by genversion
module.exports = '0.40.3'

},{}],103:[function(require,module,exports){
/*! zzdom - v0.2.0 - 2020-11-12 13:32:51 */
/**
 * A namespace.
 * @const
 */
var zzDOM = {};

/*
    zz function
    
    zz( '#', 'id' );
    zz( '.', 'className' );
    zz( 't', 'tagName' );
    zz( 'tn', 'namespace', 'tagName' );
    zz( 'n', 'name' );
    zz( 's', 'string selector' );
    zz( document.getElementById( 'id' ) ); // Element
    zz( document.getElementsByClassName( 'className' ) ); // HTMLCollection
    zz( document.getElementsByName( 'name' ) ); // NodeList
    zz( 'table.className tr td' ); // String selector
    zz( '<div>New div</div>' ); // HTML code in string
*/
/**
 * @param {string|Element|HTMLCollection|NodeList} x
 * @param {string=} s1
 * @param {string=} s2 
 */
zzDOM.zz = function( x, s1, s2 ){
    
    // Redefine x if a selector id is found
    if ( s1 ){
        switch ( x ){
        case '#':
            x = document.getElementById( s1 );
            break;
        case '.':
            x = document.getElementsByClassName( s1 );
            break;
        case 't':
            x = document.getElementsByTagName( s1 );
            break;
        case 'tn':
            x = document.getElementsByTagNameNS( s1, s2 || '' );
            break;
        case 'n':
            x = document.getElementsByName( s1 );
            break;
        case 's':
            x = document.querySelector( s1 );
            break;
        default:
            throw 'Unsupported selector id found running zz function: ' + x;
        }
    }
    
    // Is it an Element?
    if ( x instanceof Element ){
        return new zzDOM.SS( x );
    }
    
    // Is it an HTMLCollection or a NodeList?
    if ( x instanceof HTMLCollection || x instanceof NodeList ){
        return zzDOM._build( x );
    }
    
    if ( typeof x === 'string' ){
        x = x.trim();
        return zzDOM._build(
            x.charAt( 0 ) === '<'? // Is it HTML code?
                zzDOM._htmlToElement( x ):
                document.querySelectorAll( x ) // Must be a standard selector
        );
    }
    
    throw 'Unsupported selector type found running zz function.';
};

// Build args array with toInsert as first position and then the arguments of this function
zzDOM._args = function( previousArgs, toInsert ){
    var result = Array.prototype.slice.call( previousArgs );
    result.push( toInsert );
    return result;
};

zzDOM._build = function ( x ) {
    if ( x instanceof Element ){
        return new zzDOM.SS( x );
    }
    if ( x instanceof HTMLCollection || x instanceof NodeList ){
        x = Array.prototype.slice.call( x );
    }
    return x.length === 1? new zzDOM.SS( x[ 0 ] ): new zzDOM.MM( x );
};

zzDOM._getError = function ( method ) {
    return 'Method "' + method + '" not ready for that type!';
};

zzDOM._htmlToElement = function ( html ) {
    var template = document.createElement( 'template' );
    template.innerHTML = html.trim();
    return template.content.childElementCount === 1?
        template.content.firstChild:
        template.content.childNodes;
};

// Register zz function
var zz;
(function() { 
    zz = zzDOM.zz; 
})();

zzDOM._events = {};

zzDOM._addEventListener = function( ss, eventName, listener, useCapture ){
    var el = ss.el;
    var elId = ss._getElId();
    var thisEvents = zzDOM._events[ elId ];
    if ( ! thisEvents ){
        thisEvents = {};
        zzDOM._events[ elId ] = thisEvents;
    }
    var thisListeners = thisEvents[ eventName ];
    if ( ! thisListeners ){
        thisListeners = [];
        thisEvents[ eventName ] = thisListeners;
    }
    thisListeners.push( listener );
    
    // addEventListener
    el.addEventListener( eventName, listener, useCapture );
};

//TODO must remove all listeners when an element is removed
zzDOM._removeEventListener = function( ss, eventName, listener, useCapture ){
    var el = ss.el;
    var elId = ss._getElId();
    var thisEvents = zzDOM._events[ elId ];
    if ( ! thisEvents ){
        return;
    }
    
    if ( ! eventName ){ 
        // Must remove all events
        for ( var currentEventName in thisEvents ){
            var currentListeners = thisEvents[ currentEventName ];
            zzDOM._removeListeners( el, currentListeners, null, useCapture, currentEventName );
        }
        return;
    }
    
    // Must remove listeners of only one event
    var thisListeners = thisEvents[ eventName ];
    zzDOM._removeListeners( el, thisListeners, listener, useCapture, eventName );
};

//TODO test all the listeners are removed
zzDOM._removeListeners = function( el, thisListeners, listener, useCapture, eventName ){
    if ( ! thisListeners ){
        return;
    }
    for ( var i = 0; i < thisListeners.length; ++i ){
        var currentListener = thisListeners[ i ];
        if ( ! listener || currentListener === listener ){
            thisListeners.splice( i, 1 ); // Delete listener at i position
            el.removeEventListener( eventName, currentListener, useCapture );
            if ( listener ){
                return;
            }
        }
    } 
};
/* End of events */

zzDOM._dd = {};

zzDOM._getDefaultDisplay = function( el ) {
    var nodeName = el.nodeName;
    var display = zzDOM._dd[ nodeName ];

    if ( display ) {
        return display;
    }

    var doc = el.ownerDocument;
    var temp = doc.body.appendChild( doc.createElement( nodeName ) );
    display = getComputedStyle( temp )[ 'display' ];

    temp.parentNode.removeChild( temp );

    if ( display === 'none' ) {
        display = 'block';
    }
    zzDOM._dd[ nodeName ] = display;

    return display;
};
/* End of visible */

/* It depends on forms plugin! */
// Serialize a ss instance, a mm instance or an object into a query string
zzDOM._paramItem = function( r, key, value ) {
    r.push( 
        encodeURIComponent( key ) + '=' + encodeURIComponent( value == null? '': value )
    );
};
/** @nocollapse */
zzDOM.param = function( x ) {
	
    if ( x == null ) {
        return '';
    }

    var r = [];
    
    if ( x instanceof zzDOM.SS ){
        zzDOM._paramItem( r, x.attr( 'name' ), x.val() );
    } else if ( x instanceof zzDOM.MM ){
        for ( var c = 0; c < x.list.length; ++c ){
            var ss = x.list[ c ];
            zzDOM._paramItem( r, ss.attr( 'name' ), ss.val() );
        }
    } else if ( typeof x === 'object' ){  
        for ( var i in x ) {
            zzDOM._paramItem( r, i, x[ i ] );
        }
    } else {
        throw zzDOM._getError( 'param' );
    }

    return r.join( '&' );
};
/* end of utils */

/** @constructor */
zzDOM.SS = function ( _el ) {
    this.el = _el;
    this.nodes = [ _el ];
    
    // Array like
    this.length = 1;
    this[ 0 ] = _el;
};

/* Methods NOT included in jquery */
zzDOM.SS.prototype._gcs = function ( self, property ) {
    var x = getComputedStyle( self.el, null )[ property ].replace( 'px', '' );
    return isNaN( x )? x: parseFloat( x );
};

zzDOM.SS.prototype._getElId = function(){
    var elId = this.el.getAttribute( 'data-elId' );
    if ( ! elId ){
        // Generate a random string with 4 chars
        elId = Math.floor( ( 1 + Math.random() ) * 0x10000 )
            .toString( 16 )
            .substring( 1 );
        this.el.setAttribute( 'data-elId', elId );
    }
    return elId;
};

zzDOM.SS.prototype._insertHelper = function ( position, x ) {
    if ( x instanceof Element ){
        this.el.insertAdjacentElement( position, x );
    } else if ( x instanceof zzDOM.SS ){
        this.el.insertAdjacentElement( position, x.el );
    } else if ( typeof x === 'string' ) {
        this.el.insertAdjacentHTML( position, x );
    } else {
        throw 'Insert operation not ready for that type!';
    }
    return this;
};

zzDOM.SS.prototype._iterate = function( value, fn ){
    if ( Array.isArray( value ) ){
        for ( var i = 0; i < value.length; ++i ){
            fn( this, value[ i ] );
        }
    } else {
        fn( this, value );   
    }
    return this;
};

zzDOM.SS.prototype._outer = function ( property, linked1, linked2, withMargin ) {
    if ( this.el[ 'offset' + property ] ) {
        return zzDOM.SS._outerCalc( this, property, linked1, linked2, withMargin );
    }
    
    var self = this;
    return this._swap( 
        this.el, 
        function(){
            return zzDOM.SS._outerCalc( self, property, linked1, linked2, withMargin );
        } 
    );
};

zzDOM.SS._outerCalc = function ( ss, property, linked1, linked2, withMargin ) {
    var value = ss._gcs( ss, property.toLowerCase() );
    var padding = ss._gcs( ss, 'padding' + linked1 ) + ss._gcs( ss, 'padding' + linked2 );
    var border = ss._gcs( ss, 'border' + linked1 + 'Width' ) + ss._gcs( ss, 'border' + linked2 + 'Width' );
    
    var total = value + padding + border;
    
    // No margin
    if ( ! withMargin ){
        return total;
    }
    
    var margin = ss._gcs( ss, 'margin' + linked1 ) + ss._gcs( ss, 'margin' + linked2 );
    return total + margin;
};

zzDOM.SS.prototype._setCssUsingKeyValue = function ( key, value ) {
    if ( typeof value === 'function' ) {
        value = value.call( this.el, this._i === undefined? 0: this._i, this );
    }
    this.el.style[ key ] = 
        typeof value === 'string' && ! /^-?\d+\.?\d*$/.test( value )? // if it is a string and is not a float number
            value: 
            value + 'px';
};

zzDOM.SS.prototype._setCssUsingObject = function ( object ) {
    for ( var key in object ) {
        this._setCssUsingKeyValue( key, object[ key ] );
    }
};

/**
 * @param {string} property
 * @param {string|Function=} value
 */
zzDOM.SS.prototype._styleProperty = function ( property, value ) {
    // get
    if ( value === undefined ){
        var self = this;
        value = this._gcs( this, property );
        return parseFloat( 
            value !== 'auto'? 
                value: 
                this._swap( 
                    this.el, 
                    function(){
                        return self._gcs( self, property );
                    } 
                )
        );
    }

    // set
    this._setCssUsingKeyValue( property, value );
    return this;
};

zzDOM.SS.prototype._swap = function( _el, callback ) {
    var old = {};
    var options = {
        display: 'block',
        position: 'absolute',
        visibility: 'hidden'
    };

    // Remember the old values and insert the new ones
    for ( var name in options ) {
        old[ name ] = _el.style[ name ];
        _el.style[ name ] = options[ name ];
    }

    var val = callback.call( _el );

    // Revert the old values
    for ( name in options ) {
        _el.style[ name ] = old[ name ];
    }

    return val;
};

/* Methods included in jquery */
zzDOM.SS.prototype.addClass = function ( name ) {
    return this._iterate(
        name,
        function( self, v ){
            self.el.classList.add( v ); 
        }
    );
};

zzDOM.SS.prototype.after = function ( x ) {
    return this._insertHelper( 'afterend', x );
};

zzDOM.SS.prototype.append = function ( x ) {
    if ( x instanceof Element ){
        this.el.appendChild( x );
    } else if ( x instanceof zzDOM.SS ){
        this.el.appendChild( x.el );
    } else if ( typeof x === 'string' ) {
        this.el.insertAdjacentHTML( 'beforeend', x );
    } else {
        throw zzDOM._getError( 'append' );
    }
    return this;
};

zzDOM.SS.prototype.appendTo = function ( x ) {
    // Do nothing and return this if it is null
    if ( x == null ){
        return this;    
    }
    
    // Is it a Element?
    if ( x instanceof Element ){
        x.appendChild( this.el );
        return this;
    }
    
    // Is it a string?
    if ( typeof x === 'string' ){
        x = zzDOM._build(
            document.querySelectorAll( x )
        );
    }
    
    // Is it a zzDOM.SS?
    if ( x instanceof zzDOM.SS ) {
        x.el.appendChild( this.el );
        return this;
    }
    
    // Is it a zzDOM.MM?
    if ( x instanceof zzDOM.MM ) {
        for ( var i = 0; i < x.nodes.length; ++i ){
            x.nodes[ i ].appendChild( this.el.cloneNode( true ) );
        }
        return this;
    } 
    
    throw zzDOM._getError( 'is' );
};

//TODO add support of function type in value
/**
 * @param {string|Object} x
 * @param {string=} value
 */
zzDOM.SS.prototype.attr = function ( x, value ) {
    // set using object
    if ( typeof x === 'object' ){
        for ( var key in x ) {
            this.attr( key, x[ key ] );
        }
        return this;
    }
    
    // get
    if ( value === undefined ){
        return this.el.getAttribute( x );
    }
    
    // remove attr
    if ( value === null ){
        return this.removeAttr( x );    
    }
    
    // set
    this.el.setAttribute( x, value );
    return this;
};

zzDOM.SS.prototype.before = function ( x ) {
    return this._insertHelper( 'beforebegin', x );
};

zzDOM.SS.prototype.children = function ( selector ) {
    return zzDOM._build( 
        selector?
            Array.prototype.filter.call(
                this.el.children, 
                function( child ){
                    return child.matches( selector );
                }
            ):
            this.el.children 
    );
};

zzDOM.SS.prototype.clone = function (  ) {
    return new zzDOM.SS( this.el.cloneNode( true ) );
};

//TODO add support of function type in value
/**
 * @param {string|Object} x1
 * @param {string|number=} x2
 */
zzDOM.SS.prototype.css = function ( x1, x2 ) {
    var number = arguments.length;
    
    if ( number === 1 ){
        if ( ! x1 ){
            throw 'Null value not allowed in css method!';
        }
        
        // get
        if ( typeof x1 === 'string' ) {
            return getComputedStyle( this.el )[ x1 ];
        }
        
        // set using object
        if ( typeof x1 === 'object' ){
            this._setCssUsingObject( x1 );
            return this;
        }
        
        throw 'Wrong type or argument in css method!';
    }
    
    // set using key value pair
    if ( number === 2 ){
        this._setCssUsingKeyValue( x1, x2 );
        return this;
    }
    
    throw 'Wrong number of arguments in css method!';
};

zzDOM.SS.prototype.each = function ( eachFn ) {
    eachFn.call( this.el, 0, this, this.nodes );
    return this;
};

zzDOM.SS.prototype.empty = function (  ) {
    while( this.el.firstChild ){
        this.el.removeChild( this.el.firstChild );
    }
    return this;
};

zzDOM.SS.prototype.filter = function ( x ) {
    if ( typeof x === 'string' ){ // Is a string selector
        return zzDOM._build( 
            this.el.matches( x )? [ this.el ]: []
        );
    }
    
    if ( typeof x === 'function' ){ // Is a function
        return zzDOM._build(
            x.call( this.el, this._i === undefined? 0: this._i, this )? [ this.el ]: []
        );
    }  
    
    throw zzDOM._getError( 'filter' );
};

zzDOM.SS.prototype.find = function ( selector ) {
    return zzDOM._build( 
        this.el.querySelectorAll( selector )
    );
};

zzDOM.SS.prototype.hasClass = function ( name ) {
    return this.el.classList.contains( name );
};

zzDOM.SS.prototype.height = function ( value ) {
    return this._styleProperty( 'height', value );
};

//TODO add support of function type in value
zzDOM.SS.prototype.html = function ( value ) {
    // get
    if ( value === undefined ){
        return this.el.innerHTML;
    }

    // set
    this.el.innerHTML = value;
    return this;
};

zzDOM.SS.prototype.index = function () {
    if ( ! this.el ){
        return -1;
    }
    
    var i = 0;
    var currentEl = this.el;
    do {
        i++;
    } while ( currentEl = currentEl.previousElementSibling );
    
    return i;
};

zzDOM.SS.prototype.is = function ( x ) {
    if ( x == null ){
        return false;    
    }
    
    if ( x instanceof Element ){
        return this.el === x;
    }
    
    if ( x instanceof zzDOM.SS ) {
        return this.el === x.el;
    } 

    if ( x instanceof zzDOM.MM ) {
        for ( var i = 0; i < x.nodes.length; ++i ){
            if ( this.el === x.nodes[ i ] ){
                return true;
            }
        }
        return false;
    } 

    if ( typeof x === 'string' ){
        return this.el.matches( x );
    }
    
    return false;
};

zzDOM.SS.prototype.next = function () {
    return new zzDOM.SS( this.el.nextElementSibling );
};

zzDOM.SS.prototype.offset = function ( c ) {
    
    // set top and left using css
    if ( c ){
        this._styleProperty( 'top', c.top );
        this._styleProperty( 'left', c.left );
        return this;
    }
    
    // get
    var rect = this.el.getBoundingClientRect();
    return {
        top: rect.top + document.body.scrollTop,
        left: rect.left + document.body.scrollLeft
    };
};

zzDOM.SS.prototype.offsetParent = function () {
    var offsetParent = this.el.offsetParent;
    return offsetParent? new zzDOM.SS( offsetParent ): this;
};

/**
 * @param {boolean=} withMargin
 */
zzDOM.SS.prototype.outerHeight = function ( withMargin ) {
    return this._outer( 'Height', 'Top', 'Bottom', withMargin );
};

/**
 * @param {boolean=} withMargin
 */
zzDOM.SS.prototype.outerWidth = function ( withMargin ) {
    return this._outer( 'Width', 'Left', 'Right', withMargin );
};

zzDOM.SS.prototype.parent = function () {
    return new zzDOM.SS( this.el.parentNode );
};

zzDOM.SS.prototype.position = function ( relativeToViewport ) {
    return relativeToViewport?
        this.el.getBoundingClientRect():
        { 
            left: this.el.offsetLeft, 
            top: this.el.offsetTop
        };
};

zzDOM.SS.prototype.prepend = function ( x ) {
    if ( x instanceof Element ){
        this.el.insertBefore( x, this.el.firstChild );
    } else if ( x instanceof zzDOM.SS ){
        this.el.insertBefore( x.el, this.el.firstChild );
    } else if ( typeof x === 'string' ){
        this.el.insertAdjacentHTML( 'afterbegin', x );
    } else {
        throw zzDOM._getError( 'prepend' );
    }
    return this;
};

zzDOM.SS.prototype.prev = function () {
    return new zzDOM.SS( this.el.previousElementSibling );
};

zzDOM.SS.prototype.remove = function () {
    this.el.parentNode.removeChild( this.el );
    return this;
};

zzDOM.SS.prototype.removeAttr = function ( name ) {
    this.el.removeAttribute( name );
    return this;
};

zzDOM.SS.prototype.removeClass = function ( name ) {
    if ( ! name ){
        this.el.className = '';
        return this;
    }
    
    return this._iterate(
        name,
        function( self, v ){
            self.el.classList.remove( v );
        }
    );
};

zzDOM.SS.prototype.replaceWith = function ( value ) {
    this.el.outerHTML = value;
    return this;
};

zzDOM.SS.prototype.siblings = function ( selector ) {
    var self = this;
    var nodes = Array.prototype.filter.call( 
        this.el.parentNode.children, 
        selector?
            function( child ){
                return child !== self.el && child.matches( selector );
            }:
            function( child ){
                return child !== self.el;
            }
    );
    return zzDOM._build( nodes );
};

//TODO add support of function type in value
zzDOM.SS.prototype.text = function ( value ) {
    // get
    if ( value === undefined ){
        return this.el.textContent;
    }

    // set
    this.el.textContent = value;
    return this;
};

zzDOM.SS.prototype.toggleClass = function ( name, state ) {
    return this._iterate(
        name,
        state === undefined?
            function( self, v ){
                self.el.classList.toggle( v );
            }:
            function( self, v ){
                self.el.classList.toggle( v, state );
            }
    );
};

zzDOM.SS.prototype.width = function ( value ) {
    return this._styleProperty( 'width', value );
};

zzDOM.SS.prototype.off = function ( eventName, listener, useCapture ) {
    zzDOM._removeEventListener( this, eventName, listener, useCapture );
    return this;
};

zzDOM.SS.prototype.on = function ( eventName, listener, data, useCapture ) {
    zzDOM._addEventListener( 
        this, 
        eventName, 
        data? 
            function( e ){
                e.data = data;
                return listener.call( e.currentTarget, e );
            }:
            listener, 
        useCapture 
    );
    return this;
};

zzDOM.SS.prototype.trigger = function ( eventName ) {
    var event = document.createEvent( 'HTMLEvents' );
    event.initEvent( eventName, true, false );
    this.el.dispatchEvent( event );
    return this;
};
/* End of events */

zzDOM.SS.prototype.hide = function () {
    if ( this.isVisible() ){
        this.attr( 
            'data-display', 
            getComputedStyle( this.el, null )[ 'display' ]
        );
        this.el.style.display = 'none';
    }
    return this;
};

zzDOM.SS.prototype.isVisible = function () {
    return !! this.el.offsetParent;
    //return getComputedStyle( this.el, null ).getPropertyValue( 'display' ) !== 'none';
};

zzDOM.SS.prototype.show = function () {
    if ( ! this.isVisible() ){
        var display = this.attr( 'data-display' );
        this.el.style.display = display? display: zzDOM._getDefaultDisplay( this.el );
    }
    return this;
};

zzDOM.SS.prototype.toggle = function ( state ) {
    var value = state !== undefined? ! state: this.isVisible();
    return value? this.hide(): this.show();
};
/* End of visible */

zzDOM.SS.prototype.checked = function ( check ) {
    if ( this.el.nodeName !== 'INPUT' || ( this.el.type !== 'checkbox' && this.el.type !== 'radio') ) {
        throw zzDOM._getError( 'checked' );
    }
    
    // get
    if ( check === undefined ){
        return !! this.el.checked;
    }
    
    // set
    this.el.checked = check;
    return this;
};

/**
 * @param {Array<?>|String=} value
 */
zzDOM.SS.prototype.val = function ( value ) {
    // get
    if ( value === undefined ){
        switch ( this.el.nodeName ) {
        case 'INPUT':
        case 'TEXTAREA':
        case 'BUTTON':
            return this.el.value;
        case 'SELECT':
            var values = [];
            for ( var i = 0; i < this.el.length; ++i ) {
                if ( this.el[ i ].selected ) {
                    values.push( this.el[ i ].value );
                }
            }
            return values.length > 1? values: values[ 0 ];
        default:
            throw zzDOM._getError( 'val' );
        }
    }
    
    // set
    switch ( this.el.nodeName ) {
    case 'INPUT':
    case 'TEXTAREA':
    case 'BUTTON':
        this.el.value = value;
        break;
    case 'SELECT':
        if ( typeof value === 'string' || typeof value === 'number' ) {
            value = [ value ];
        }
        for ( i = 0; i < this.el.length; ++i ) {
            for ( var j = 0; j < value.length; ++j ) {
                this.el[ i ].selected = '';
                if ( this.el[ i ].value === value[ j ] ) {
                    this.el[ i ].selected = 'selected';
                    break;
                }
            }
        }
        break;
    default:
        throw zzDOM._getError( 'val' );
    }
    
    return this;
};
/* End of forms */

zzDOM.SS.prototype.getXCenter = function() {
    return ( document.documentElement.clientWidth - this.outerWidth() ) / 2;
};

zzDOM.SS.prototype.getYCenter = function() {
    return ( document.documentElement.clientHeight - this.outerHeight() ) / 2;
};

zzDOM.SS.prototype.getCenter = function() {
    return {
        left: this.getXCenter(),
        top: this.getYCenter()
    };
};

zzDOM.SS.prototype.center = function() {
    this.offset( 
        this.getCenter() 
    );
    return this;
};

zzDOM.SS.prototype.centerX = function() {
    this.css( 'left', this.getXCenter() );
    return this;
};

zzDOM.SS.prototype.centerY = function() {
    this.css( 'top', this.getYCenter() );
    return this;
};
/* End of center */

/** @constructor */
zzDOM.MM = function ( _nodes ) {    
    this.list = [];
    this.nodes = _nodes;
    this.length = _nodes.length;
    
    // Init nodes
    for ( var i = 0; i < this.length; i++ ) {
        var el = this.nodes[ i ];
        this[ i ] = el; // for array like
        var ss = new zzDOM.SS( el );
        this.list.push( ss );
        ss._i = i; // for index in functions
    }
};

/*
Unify the definition of a function of zzDOM.SS.prototype and a definition of zzDOM.MM.prototype. Example:

    zzDOM.add( 
        zzDOM.SS.prototype.myCustomFunction = function(){
            ...
            return this;
        },
        zzDOM.MM.constructors.concat
    );
);
*/
/**
 * @param {Function} ssPrototype
 * @param {Function=} constructor
 */
zzDOM.add = function( ssPrototype, constructor ){
    for ( var id in zzDOM.SS.prototype ){
        var current = zzDOM.SS.prototype[ id ];
        if ( ssPrototype === current ){
            var closure = function(){
                var functionId = id;
                return constructor? constructor( functionId ): zzDOM.MM.constructors.default( functionId );
            };
            zzDOM.MM.prototype[ id ] = closure();
            return;
        }
    }
    
    throw 'Error registering zzDOM.MM: zzDOM.SS not found.';
};

zzDOM.MM.constructors = {};
zzDOM.MM.constructors.booleanOr = function( functionId ){
    return function(){
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var x = ss[ functionId ].apply( ss, arguments );
            if ( x ){
                return true;
            }
        }
        return false;
    };
};
zzDOM.MM.constructors.concat = function( functionId ){
    return function(){
        var newNodes = [];
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var x = ss[ functionId ].apply( ss, arguments );
            newNodes = newNodes.concat( x.nodes );
        }
        return zzDOM._build( newNodes );
    };
};
zzDOM.MM.constructors.default = function( functionId ){
    return function(){
        for ( var i = 0; i < this.list.length; i++ ) {
            var ss = this.list[ i ];
            var r = ss[ functionId ].apply( ss, arguments );
            if ( i === 0 && ! ( r instanceof zzDOM.SS ) ){
                return r;
            }
        }
        return this;
    };
};

// Init prototype functions from zzDOM.SS
zzDOM.MM.init = function(){
    // Concat functions
    var concatF = [
        'children',
        'clone',
        'filter',
        'find',
        'next',
        'offsetParent',
        'parent',
        'prev',
        'siblings'
    ];
    // Boolean functions
    var booleanOrF = [
        'hasClass',
        'is'
    ];
    for ( var id in zzDOM.SS.prototype ){
        var closure = function(){
            var functionId = id;
            
            if ( concatF.indexOf( functionId ) !== -1 ){
                return zzDOM.MM.constructors.concat( functionId );
            }
            if ( booleanOrF.indexOf( functionId ) !== -1 ){
                return zzDOM.MM.constructors.booleanOr( functionId );
            }
            return zzDOM.MM.constructors.default( functionId );
        };
        zzDOM.MM.prototype[ id ] = closure();
    }
}();

/* Methods included in jquery */
zzDOM.MM.prototype.each = function ( eachFn ) {
    var self = this;
    Array.prototype.forEach.call( 
        this.list, 
        function( currentValue, index ){
            eachFn.call( currentValue.el, index, currentValue, self.nodes );
        }
    );
    return this;
};

// Register zzDOM if we are using Node
if ( typeof module === 'object' && module.exports ) {
    module.exports = zzDOM;
}

},{}],104:[function(require,module,exports){
var zzDOM = require('./build/zzDOM-closures-full.js');
module.exports = zzDOM.zz;

},{"./build/zzDOM-closures-full.js":103}],105:[function(require,module,exports){
var Qunit = require( 'qunit' );
var zz = require( 'zzdom' );
var zpt = require( 'zpt' );
var blueRouter = require( '../../build/blueRouter.js' );

// Init router
const initRouter = () => {
    // Initialize pages
    const pages = {};

    // Load js of pages
    const dictionary = {};
    pages[ 'renderWithoutWaiting' ] = require( './pages/renderWithoutWaiting.js' )( dictionary );
    pages[ 'renderWaitingForServer' ] = require( './pages/renderWaitingForServer.js' )( dictionary );

    // Initialize options: no animations
    let initializeZPT = true;
    let options = {
        eventsByPage: pages,
        routes: require( './routesInlineForRender.js' )
    };

    // Add renderFunction
    options.renderFunction = ( page ) => {
        if ( initializeZPT ){
            zpt.run({
                'root': document.body,
                'dictionary': dictionary
            });
            initializeZPT = false;
        } else {
            zpt.run({
                'command': 'partialRender',
                'target': page[ 'el' ]
            });
        }
    };

    // Create new router instance
    return new blueRouter.router( options );
};

// Init router
const router = initRouter();

// Unit tests
require( './render.js' )();


},{"../../build/blueRouter.js":1,"./pages/renderWaitingForServer.js":106,"./pages/renderWithoutWaiting.js":107,"./render.js":108,"./routesInlineForRender.js":109,"qunit":6,"zpt":75,"zzdom":104}],106:[function(require,module,exports){
/* renderWithoutWaiting page */
module.exports = function ( dictionary ) {
    
    var zpt = require( 'zpt' );

    const page = {};

    page[ 'preInit' ] = function( event ){

        dictionary[ 'successMessageFromServer' ] = 'Loading...';
    };

    page[ 'init' ] = function( event ){

        setTimeout(
            function(){
                dictionary[ 'successMessageFromServer' ] = 'It works!';
                zpt.run({
                    'command': 'partialRender',
                    'target': document.getElementById( 'renderWaitingForServer_message' )
                });
            },
            300
        );
    };

    return page;
};

},{"zpt":75}],107:[function(require,module,exports){
/* renderWithoutWaiting page */

module.exports = function ( dictionary ) {

    const page = {};

    page[ 'preInit' ] = function( event ){
        //alert( 'EVENT_PRE_INIT' );

        dictionary[ 'successMessage' ] = 'It works!';
    };

    return page;
};

},{}],108:[function(require,module,exports){
// Tests for events

var zz = require( 'zzdom' );
var utils = require( './utils.js' );
var Qunit = require( 'qunit' );

// Unit tests
module.exports = function () {

    // Non waiting render test
    QUnit.test( "Non waiting render test", async function( assert ) {
        
        // Get a reference to finish the qunit test later
        var done = assert.async();

        // Go to page renderWithoutWaiting
        zz('#home_renderWithoutWaitingLink').el.click();
        await utils.waitShort();
        assert.equal( zz('#renderWithoutWaiting_p').text().trim() , "This is Page render without waiting" );

        // Check that render is ok
        assert.equal( zz('#renderWithoutWaiting_message').text().trim() , "It works!" );

        // Go to home page
        zz('#renderWithoutWaiting_homeLink').el.click();
        await utils.waitShort();

        // Finish qunit test
        done();
    });

    // Waiting for server render test
    QUnit.test( "Waiting for server render test", async function( assert ) {
        
        // Get a reference to finish the qunit test later
        var done = assert.async();

        // Go to page renderWithoutWaiting
        zz('#home_renderWaitingForServerLink').el.click();
        await utils.waitShort();
        assert.equal( zz('#renderWaitingForServer_p').text().trim() , "This is Page render waiting for server" );
        await utils.waitShort();
        
        // Check that render is ok
        assert.equal( zz('#renderWaitingForServer_message').text().trim() , "It works!" );

        // Go to home page
        zz('#renderWaitingForServer_homeLink').el.click();
        await utils.waitShort();

        // Finish qunit test
        done();
    });

};

},{"./utils.js":110,"qunit":6,"zzdom":104}],109:[function(require,module,exports){
// Routes for inline content for render tests

const routes = [
    // Home page
    {
        id: '[home]',
        content: `
<h1>Blue router test</h1>

<div class="page-content">
<h3>Home page</h3>
<p>
    This is Home page
</p>

<ul id="home_links">
    <li>
        <a href="!renderWithoutWaiting" id="home_renderWithoutWaitingLink">Page render without waiting</a>. Go to page render without waiting.
    </li>
    <li>
        <a href="!renderWaitingForServer" id="home_renderWaitingForServerLink">Page render waiting for server</a>. Go to page render waiting for server.
    </li>
</ul>
</div>
`
    },
    // page render without waiting
    {
        id: 'renderWithoutWaiting',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="renderWithoutWaiting_homeLink">Home</a>
</div>

<div class="page-content">
<h3>Page render</h3>
<p id="renderWithoutWaiting_p">
    This is Page render without waiting
</p>

<h2 id="renderWithoutWaiting_message" data-content="successMessage">
    Not working!
</h2>
</div>
`
    },
    // page render waiting for server
    {
        id: 'renderWaitingForServer',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="renderWaitingForServer_homeLink">Home</a>
</div>

<div class="page-content">
<h3>Page render</h3>
<p id="renderWaitingForServer_p">
    This is Page render waiting for server
</p>

<h2 id="renderWaitingForServer_message" data-content="successMessageFromServer">
    Not working!
</h2>
</div>
`
    },
    // Default route (404 page)
    {
        id: '[404]',
        content: `
<h1>Blue router test</h1>

<div>
<a href="!" id="e404_homeLink">Home</a>
</div>

<div class="page-content">
<h3>404 page</h3>
<p>
    Sorry
</p>
<p id="e404_p">
    Requested content not found.
</p>
</div>
`
    }
];

module.exports = routes;



},{}],110:[function(require,module,exports){
const utils = {};

utils.waitShort = function() {
    return utils.wait( 1000 );
};

utils.wait = function( timeout ) {
    return new Promise( resolve => {
        setTimeout( resolve, timeout );
    });
};

module.exports = utils;


},{}]},{},[105])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJidWlsZC9ibHVlUm91dGVyLmpzIiwibm9kZV9tb2R1bGVzL2xvYWRqcy9kaXN0L2xvYWRqcy51bWQuanMiLCJub2RlX21vZHVsZXMvbG9nNGphdmFzY3JpcHQvbG9nNGphdmFzY3JpcHQuanMiLCJub2RlX21vZHVsZXMvbWVzc2FnZWZvcm1hdC9tZXNzYWdlZm9ybWF0LmpzIiwibm9kZV9tb2R1bGVzL3Byb2Nlc3MvYnJvd3Nlci5qcyIsIm5vZGVfbW9kdWxlcy9xdW5pdC9xdW5pdC9xdW5pdC5qcyIsIm5vZGVfbW9kdWxlcy90aW1lcnMtYnJvd3NlcmlmeS9tYWluLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9JMThOL2kxOG5Eb21haW4uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL0kxOE4vaTE4bkxhbmd1YWdlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbERlZmluZU1hY3JvLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbEZpbGxTbG90LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9NRVRBTC9tZXRhbFVzZU1hY3JvLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvY29udGVudEhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbEF0dHJpYnV0ZXMuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxDb25kaXRpb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxDb250ZW50LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsRGVjbGFyZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbERlZmluZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvVEFML3RhbE9taXRUYWcuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9hdHRyaWJ1dGVzL1RBTC90YWxPbkVycm9yLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsUmVwZWF0LmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvYXR0cmlidXRlcy9UQUwvdGFsUmVwbGFjZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9jYWNoZS9hdHRyaWJ1dGVDYWNoZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2NhY2hlL2NhY2hlSGVscGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvY2FjaGUvZXhwcmVzc2lvbkNhY2hlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvY29udGV4dC5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2FyaXRobWV0aGljL2FkZEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9hcml0aG1ldGhpYy9hcml0aG1ldGhpY0hlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2FyaXRobWV0aGljL2RpdmlkZUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9hcml0aG1ldGhpYy9tb2RFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvYXJpdGhtZXRoaWMvbXVsdGlwbHlFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvYXJpdGhtZXRoaWMvc3Vic3RyYWN0RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvYW5kRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvYm9vbEhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Jvb2wvY29uZEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9ib29sL25vdEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9ib29sL29yRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vY29tcGFyaXNvbkhlbHBlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vZXF1YWxzRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vZ3JlYXRlckV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9jb21wYXJpc29uL2luRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2NvbXBhcmlzb24vbG93ZXJFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9leGlzdHNFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9leHByZXNzaW9uVG9rZW5pemVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvZXhwcmVzc2lvbnNVdGlscy5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2Zvcm1hdEV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9pMThuL3RyQ3VycmVuY3lFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvaTE4bi90ckRhdGVUaW1lRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2kxOG4vdHJIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9pMThuL3RyTnVtYmVyRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL2kxOG4vdHJTdHJpbmdFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9hcnJheUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL2Z1bmN0aW9uRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvaW5kaXJlY3Rpb25FeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9saXN0RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvbGl0ZXJhbHMvYm9vbGVhbkxpdGVyYWwuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL2xpdGVyYWxzL251bWVyaWNMaXRlcmFsLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9saXRlcmFscy9zdHJpbmdMaXRlcmFsLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9tZXRob2RFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9wYXRoRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvcGF0aFNlZ21lbnRFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvcGF0aC9wcm9wZXJ0eUV4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9leHByZXNzaW9ucy9wYXRoL3JhbmdlRXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3BhdGgvdmFyaWFibGVFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvc2NyaXB0aW5nL2phdmFzY3JpcHRFeHByZXNzaW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvZXhwcmVzc2lvbnMvc2NyaXB0aW5nL3F1ZXJ5RXhwcmVzc2lvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL2V4cHJlc3Npb25zL3N0cmluZ0V4cHJlc3Npb24uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG4uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG5CdW5kbGUuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9pMThuL2kxOG5IZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9sb2dIZWxwZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9tYWluLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9hdXRvRGVmaW5lSGVscGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kZXBzRGF0YUl0ZW0uanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL2Fic3RyYWN0QWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hYnN0cmFjdEFycmF5QWN0aW9uLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hYnN0cmFjdE9iamVjdEFjdGlvbi5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvYXJyYXlDcmVhdGUuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL2FycmF5RGVsZXRlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9kaWN0aW9uYXJ5QWN0aW9ucy9hcnJheVVwZGF0ZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvY3NzQW5pbWF0aW9uTWFuYWdlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvZGljdGlvbmFyeUFjdGlvbkJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL2RpY3Rpb25hcnlBY3Rpb25zL29iamVjdERlbGV0ZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvb2JqZWN0VXBkYXRlLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9sb29wLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9sb29wSXRlbS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvbm9kZUF0dHJpYnV0ZXMuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL25vZGVSZW1vdmVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9wYXJzZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC9wYXJzZXJzL3BhcnNlck5vZGVSZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvcGFyc2VyUHJlbG9hZGVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvcGFyc2Vycy9wYXJzZXJSZW5kZXJlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3BhcnNlcnMvcGFyc2VyVXBkYXRlci5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Jlc29sdmVyLmpzIiwibm9kZV9tb2R1bGVzL3pwdC9qcy9hcHAvc2NvcGVzL3JlYWN0aXZlRGljdGlvbmFyeS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Njb3Blcy9zY29wZS5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3Njb3Blcy9zY29wZUJ1aWxkZXIuanMiLCJub2RlX21vZHVsZXMvenB0L2pzL2FwcC91dGlscy5qcyIsIm5vZGVfbW9kdWxlcy96cHQvanMvYXBwL3ZlcnNpb24uanMiLCJub2RlX21vZHVsZXMvenpkb20vYnVpbGQvenpET00tY2xvc3VyZXMtZnVsbC5qcyIsIm5vZGVfbW9kdWxlcy96emRvbS9pbmRleC5qcyIsInRlc3QvanMvYm90aFRyYW5zaXRpb25SZW5kZXIuanMiLCJ0ZXN0L2pzL3BhZ2VzL3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXIuanMiLCJ0ZXN0L2pzL3BhZ2VzL3JlbmRlcldpdGhvdXRXYWl0aW5nLmpzIiwidGVzdC9qcy9yZW5kZXIuanMiLCJ0ZXN0L2pzL3JvdXRlc0lubGluZUZvclJlbmRlci5qcyIsInRlc3QvanMvdXRpbHMuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdG1CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxVUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFRQTtBQUNBOztBQ0RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7Ozs7QUN0b09BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7O0FDM0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzNEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDcElBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzFOQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeEdBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM2FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbkZBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDNURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2pDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDakRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9GQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BEQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM01BO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1SUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3BIQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMvREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3REE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xKQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3RDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDN0VBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDeENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3ZDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDckRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25HQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNqQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDOURBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDbEVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzSkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM3R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNuS0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMzRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25DQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ3hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN2Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0hBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzVHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM5R0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNsRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN4Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDaERBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDM0NBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNwQkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUN6RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2xHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNyRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNySUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7OztBQ3BJQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNoakJBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUM5RUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7OztBQ25IQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ25aQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQzlPQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkhBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdFRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDMUpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hQQTtBQUNBO0FBQ0E7O0FDRkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUMxaUNBO0FBQ0E7QUFDQTs7QUNGQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUNoREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUM1QkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2RBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FDdkRBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQ2hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpe2Z1bmN0aW9uIHIoZSxuLHQpe2Z1bmN0aW9uIG8oaSxmKXtpZighbltpXSl7aWYoIWVbaV0pe3ZhciBjPVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmU7aWYoIWYmJmMpcmV0dXJuIGMoaSwhMCk7aWYodSlyZXR1cm4gdShpLCEwKTt2YXIgYT1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK2krXCInXCIpO3Rocm93IGEuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixhfXZhciBwPW5baV09e2V4cG9ydHM6e319O2VbaV1bMF0uY2FsbChwLmV4cG9ydHMsZnVuY3Rpb24ocil7dmFyIG49ZVtpXVsxXVtyXTtyZXR1cm4gbyhufHxyKX0scCxwLmV4cG9ydHMscixlLG4sdCl9cmV0dXJuIG5baV0uZXhwb3J0c31mb3IodmFyIHU9XCJmdW5jdGlvblwiPT10eXBlb2YgcmVxdWlyZSYmcmVxdWlyZSxpPTA7aTx0Lmxlbmd0aDtpKyspbyh0W2ldKTtyZXR1cm4gb31yZXR1cm4gcn0pKCkiLCIvKiEgYmx1ZXJvdXRlciAtIHYwLjEuMCAtIDIwMjUtMDEtMTYgMTM6MzE6MjggKi9cbi8qKlxuICogQSBuYW1lc3BhY2UuXG4gKiBAY29uc3RcbiAqL1xuY29uc3QgYmx1ZVJvdXRlciA9IHt9O1xuXG5cbi8qKiBAY29uc3RydWN0b3IgKi9cbmJsdWVSb3V0ZXIucm91dGVyID0gZnVuY3Rpb24gKCB1c2VyT3B0aW9ucyApIHtcblxuICAgIC8vIEluaXQgb3B0aW9uc1xuICAgIHRoaXMub3B0aW9ucyA9IHt9O1xuICAgIGJsdWVSb3V0ZXIudXRpbHMuZXh0ZW5kKCB0aGlzLm9wdGlvbnMsIGJsdWVSb3V0ZXIuZGVmYXVsdE9wdGlvbnMsIHVzZXJPcHRpb25zICk7XG4gICAgdGhpcy5jaGVja09wdGlvbnMoKTtcblxuICAgIC8vIFByZWxvYWQgcGFnZXMgaWYgbmVlZGVkXG4gICAgaWYgKCB0aGlzLm9wdGlvbnMucHJlbG9hZFBhZ2VzT25Mb2FkICl7XG4gICAgICAgIGxldCBzZWxmID0gdGhpcztcbiAgICAgICAgYmx1ZVJvdXRlci5odG1sRmV0Y2hlci5sb2FkQWxsVXJscyhcbiAgICAgICAgICAgIHRoaXMsXG4gICAgICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc2VsZi5pbml0KCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEbyBub3QgcHJlbG9hZCBwYWdlcywgcnVuIGluaXRcbiAgICB0aGlzLmluaXQoKTtcbn07XG5cbi8qIE1ldGhvZHMgKi9cblxuLyoqIEBzdXBwcmVzcyB7bWlzc2luZ1Byb3BlcnRpZXN9ICovXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuaW5pdCA9IGZ1bmN0aW9uKCkge1xuXG4gICAgLy8gSW5pdCBzb21lIG90aGVyIHZhcnNcbiAgICB0aGlzLnJvdXRlc01hcCA9IHRoaXMuY3JlYXRlUm91dGVzTWFwKCk7XG4gICAgdGhpcy5zdGFjayA9IFtdO1xuXG4gICAgLy8gQWRkIGV2ZW50IGxpc3RlbmVyc1xuICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcnNGb3JXaW5kb3coKTtcblxuICAgIC8vIE5hdmlnYXRlIHRvIHdpbmRvdy5sb2NhdGlvbi5ocmVmIG9yIGhvbWVcbiAgICB0aGlzLm5hdmlnYXRlVXJsKFxuICAgICAgICB0aGlzLm9wdGlvbnMudXBkYXRlT25Mb2FkPyB3aW5kb3cubG9jYXRpb24uaHJlZjogJycsXG4gICAgICAgIHRoaXMub3B0aW9ucy5hbmltYXRlVHJhbnNpdGlvbnNPbkxvYWRcbiAgICApO1xufTtcblxuLy8gQ2hlY2sgdGhhdCBtYW5kYXRvcnkgdXNlciBkZWZpbmVkIHByb3BlcnRpZXMgYXJlIGRlZmluZWRcbi8qKiBAc3VwcHJlc3Mge21pc3NpbmdQcm9wZXJ0aWVzfSAqL1xuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmNoZWNrT3B0aW9ucyA9IGZ1bmN0aW9uKCkge1xuXG4gICAgbGV0IGVycm9ycyA9IDA7XG4gICAgbGV0IGVycm9yTWVzc2FnZXMgPSAnJztcblxuICAgIGlmICggISB0aGlzLm9wdGlvbnMucm91dGVzICl7XG4gICAgICAgICsrZXJyb3JzO1xuICAgICAgICBlcnJvck1lc3NhZ2VzICs9ICdyb3V0ZXMgbXVzdCBiZSBkZWZpbmVkLiAnO1xuICAgIH1cblxuICAgIGlmICggISB0aGlzLm9wdGlvbnMuZXZlbnRzQnlQYWdlICl7XG4gICAgICAgICsrZXJyb3JzO1xuICAgICAgICBlcnJvck1lc3NhZ2VzICs9ICdldmVudHNCeVBhZ2UgbXVzdCBiZSBkZWZpbmVkLiAnO1xuICAgIH1cblxuICAgIGlmICggZXJyb3JzICl7XG4gICAgICAgIHRoaXMuYWxlcnRFcnJvciggJ1VuYWJsZSB0byBpbml0YWxpemUgQmx1ZSByb3V0ZXIuICcgKyBlcnJvcnMgKyAnIGVycm9ycyBmb3VuZDogJyArIGVycm9yTWVzc2FnZXMgKTtcbiAgICB9XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuYWxlcnRFcnJvciA9IGZ1bmN0aW9uKCBtZXNzYWdlICl7XG4gICAgYWxlcnQoIG1lc3NhZ2UgKTtcbiAgICB0aHJvdyBtZXNzYWdlO1xufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmFkZEV2ZW50TGlzdGVuZXJzRm9yV2luZG93ID0gZnVuY3Rpb24oKSB7XG4gICAgLypcbiAgICB3aW5kb3cub25sb2FkID0gKCkgPT4ge1xuICAgICAgICB0aGlzLm5hdmlnYXRlVXJsKCB0aGlzLm9wdGlvbnMudXBkYXRlT25Mb2FkPyB3aW5kb3cubG9jYXRpb24uaHJlZjogJycsIHRydWUgKTtcbiAgICB9XG4gICAgKi9cbiAgICB3aW5kb3cub25wb3BzdGF0ZSA9ICggZSApID0+IHtcbiAgICAgICAgdGhpcy5uYXZpZ2F0ZVVybCggd2luZG93LmxvY2F0aW9uLmhyZWYsIHRydWUgKTtcbiAgICAgICAgLy90aGlzLm5hdmlnYXRlVXJsKCBlLnN0YXRlWyAncGFnZScgXSwgdHJ1ZSApO1xuICAgIH07XG59O1xuXG4vKiogQHN1cHByZXNzIHttaXNzaW5nUHJvcGVydGllc30gKi9cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5hZGRFdmVudExpc3RlbmVyc0ZvckxpbmtzID0gZnVuY3Rpb24oIHBhZ2VJZCApIHtcbiAgICBcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG5cbiAgICAvLyBBZGQgZXZlbnQgbGlzdGVuZXJzIGZvciBhIGVsZW1lbnRzXG4gICAgYmx1ZVJvdXRlci51dGlscy5hZGRFdmVudExpc3RlbmVyT25MaXN0KFxuICAgICAgICAvL2RvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lKCAnYScgKSxcbiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIHBhZ2VJZCApLmdldEVsZW1lbnRzQnlUYWdOYW1lKCAnYScgKSxcbiAgICAgICAgJ2NsaWNrJywgXG4gICAgICAgIChlKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBocmVmID0gZS50YXJnZXQuZ2V0QXR0cmlidXRlKCAnaHJlZicgKTtcblxuICAgICAgICAgICAgLy8gRm9sbG93IHRoZSBsaW5rIGlmIGl0IGlzIGV4dGVybmFsIChpZiBpdCBpcyBtYXJrZWQgYXMgZXh0ZXJuYWwgaW4gdGhlIGNsYXNzIGxpc3QpXG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgaWYgKCBlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMgKCBzZWxmLm9wdGlvbnMuZXh0ZXJuYWxDbGFzcyApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIC8vIEZvbGxvdyB0aGUgbGluayBpZiBpdCBpcyBleHRlcm5hbCAoaWYgaXQgZG9lcyBub3Qgc3RhcnQgYnkgISlcbiAgICAgICAgICAgIGlmICggISBocmVmLnN0YXJ0c1dpdGgoIHNlbGYub3B0aW9ucy5QQUdFX1BSRUZJWCApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICBoaXN0b3J5LnB1c2hTdGF0ZShcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICdwYWdlJzogaHJlZlxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgJ3BhZ2UgJyArIGhyZWYsXG4gICAgICAgICAgICAgICAgJyMnICsgaHJlZlxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIHNlbGYubmF2aWdhdGVVcmwoIGhyZWYsIHRydWUgKTtcbiAgICAgICAgfVxuICAgICk7XG59O1xuXG4vLyBDcmVhdGUgYSBtYXAgd2l0aCB0aGUgZGF0YSBpbiByb3V0ZXMsIHVzaW5nIHRoZSBwYXRoIGFzIHRoZSBrZXlcbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5jcmVhdGVSb3V0ZXNNYXAgPSBmdW5jdGlvbigpIHtcblxuICAgIGNvbnN0IHJvdXRlck1hcCA9IHt9O1xuICAgIGNvbnN0IHJvdXRlcyA9IHRoaXMub3B0aW9ucy5yb3V0ZXMgfHwgW107XG5cbiAgICByb3V0ZXMubWFwKCByb3V0ZUl0ZW0gPT4ge1xuICAgICAgICByb3V0ZXJNYXBbIHJvdXRlSXRlbS5pZCBdID0gcm91dGVJdGVtO1xuICAgIH0pO1xuXG4gICAgcmV0dXJuIHJvdXRlck1hcDtcbn07XG5cbi8qKiBAc3VwcHJlc3Mge21pc3NpbmdQcm9wZXJ0aWVzfSAqL1xuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmdldFJvdXRlSXRlbSA9IGZ1bmN0aW9uKCBwYWdlSWQgKSB7XG5cbiAgICAvLyBMb29rIGZvciB0aGUgcm91dGVcbiAgICBsZXQgcm91dGVJdGVtID0gdGhpcy5yb3V0ZXNNYXBbIHBhZ2VJZCBdO1xuICAgIGlmICggcm91dGVJdGVtICl7XG4gICAgICAgIHJldHVybiByb3V0ZUl0ZW07XG4gICAgfVxuXG4gICAgLy8gTm8gcm91dGUgZm91bmQsIDQwNCBlcnJvclxuICAgIHJvdXRlSXRlbSA9IHRoaXMucm91dGVzTWFwWyB0aGlzLm9wdGlvbnMuUEFHRV9JRF80MDRfRVJST1IgXTtcbiAgICBpZiAoIHJvdXRlSXRlbSApe1xuICAgICAgICByZXR1cm4gcm91dGVJdGVtO1xuICAgIH1cblxuICAgIC8vIE5vIDQwNCBwYWdlLCBidWlsZCBhIDQwNCByb3V0ZVxuICAgIHJldHVybiB7XG4gICAgICAgIGlkOiB0aGlzLm9wdGlvbnMuUEFHRV9JRF80MDRfRVJST1IsXG4gICAgICAgIGNvbnRlbnQ6ICc8aDM+NDA0IC0gUGFnZSBub3QgZm91bmQ6ICcgKyBwYWdlSWQgKyAnPC9oMz4nXG4gICAgfTtcbiAgICAvL3RoaXMuYWxlcnRFcnJvciggJ05vIHJvdXRlIGZvdW5kIHdpdGggaWQgJyArIHBhZ2VJZCArICcgYW5kIG5vIDQwNCBwYWdlIGZvdW5kLicgKTtcbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5uYXZpZ2F0ZVVybCA9IGZ1bmN0aW9uKCB1cmwsIG11c3RBbmltYXRlQnlDb2RlICkge1xuICAgIC8vYWxlcnQoICduYXZpZ2F0ZVVybFxcbnVybDogJyArIHVybCApO1xuXG4gICAgLy8gQ3JlYXRlIGFuIHVybCBvYmplY3QgdG8gbWFrZSBpdCBlYXN5IGV2ZXJ5dGhpbmdcbiAgICBsZXQgdXJsT2JqZWN0ID0gYmx1ZVJvdXRlci51dGlscy5hbmFsaXplVXJsKCB1cmwsIHRoaXMub3B0aW9ucyApO1xuXG4gICAgLy8gVXBkYXRlIHN0YWNrIGFuZCBnZXQgY3VycmVudFBhZ2VJZFxuICAgIGxldCBjdXJyZW50UGFnZUlkID0gdGhpcy51cGRhdGVTdGFjayggdXJsT2JqZWN0LnBhZ2UgKTtcblxuICAgIC8vIEV4aXQgaWYgdHJ5aW5nIHRvIG5hdmlnYXRlIHRvIGN1cnJlbnQgcGFnZVxuICAgIGlmICggY3VycmVudFBhZ2VJZCA9PSB1cmxPYmplY3QucGFnZSApe1xuICAgICAgICByZXR1cm47XG4gICAgfVxuXG4gICAgLy8gR2V0IHRoZSBjb250ZW50XG4gICAgbGV0IGNvbnRlbnQgPSB0aGlzLmdldENvbnRlbnRGb3JQYWdlKCB1cmxPYmplY3QucGFnZSApO1xuICAgIFxuICAgIC8vIElmIGNvbnRlbnQgaXMgYSBQcm9taXNlIHdhaXQgYW5kIHJlc29sdmUgaXRcbiAgICBsZXQgc2VsZiA9IHRoaXM7XG4gICAgaWYgKCBjb250ZW50IGluc3RhbmNlb2YgUHJvbWlzZSApe1xuICAgICAgICBjb250ZW50LnRoZW4oIGZ1bmN0aW9uKCB0ZXh0ICl7XG4gICAgICAgICAgICAvLyBVcGRhdGUgY29udGVudCBvZiByb3V0ZVxuICAgICAgICAgICAgbGV0IHJvdXRlSXRlbSA9IHNlbGYuZ2V0Um91dGVJdGVtKCB1cmxPYmplY3QucGFnZSApO1xuICAgICAgICAgICAgcm91dGVJdGVtLmNvbnRlbnQgPSB0ZXh0O1xuXG4gICAgICAgICAgICAvLyBSdW4gZG9QYWdlVHJhbnNpdGlvblxuICAgICAgICAgICAgc2VsZi5kb1BhZ2VUcmFuc2l0aW9uKCB0ZXh0LCB1cmxPYmplY3QucGFnZSwgY3VycmVudFBhZ2VJZCwgdXJsT2JqZWN0LCBtdXN0QW5pbWF0ZUJ5Q29kZSApO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cblxuICAgIC8vIGNvbnRlbnQgaXMgTk9UIGEgUHJvbWlzZTogdXBkYXRlIGN1cnJlbnQgcGFnZVxuICAgIHRoaXMuZG9QYWdlVHJhbnNpdGlvbiggY29udGVudCwgdXJsT2JqZWN0LnBhZ2UsIGN1cnJlbnRQYWdlSWQsIHVybE9iamVjdCwgbXVzdEFuaW1hdGVCeUNvZGUgKTtcbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS51cGRhdGVTdGFjayA9IGZ1bmN0aW9uKCBwYWdlSWQgKSB7XG4gICAgXG4gICAgLy8gSWYgdGhlIHBlbnVsdGltYXRlIGVsZW1lbnQgaXMgdGhlIHBhZ2VJZCB0aGVuIHdlIGFyZSBnb2luZyBiYWNrd2FyZHM7IG90aGVyd2lzZSB3ZSBhcmUgZ29pbmcgZm9yd2FyZFxuICAgIGxldCBpc0JhY2t3YXJkID0gdGhpcy5zdGFja1sgdGhpcy5zdGFjay5sZW5ndGggLSAyIF0gPT0gcGFnZUlkO1xuXG4gICAgaWYgKCBpc0JhY2t3YXJkICl7XG4gICAgICAgIC8vIElzIGJhY2t3YXJkXG4gICAgICAgIHJldHVybiB0aGlzLnN0YWNrLnBvcCgpO1xuICAgIH1cblxuICAgIC8vIElzIGZvcndhcmRcbiAgICB2YXIgY3VycmVudFBhZ2VJZCA9IHRoaXMuc3RhY2tbIHRoaXMuc3RhY2subGVuZ3RoIC0gMSBdO1xuICAgIHRoaXMuc3RhY2sucHVzaCggcGFnZUlkICk7XG4gICAgcmV0dXJuIGN1cnJlbnRQYWdlSWQ7XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuZ2V0Q29udGVudEZvclBhZ2UgPSBmdW5jdGlvbiggcGFnZUlkICkge1xuXG4gICAgLy8gR2V0IHRoZSByb3V0ZUl0ZW0gZnJvbSB0aGUgcm91dGVzTWFwXG4gICAgbGV0IHJvdXRlSXRlbSA9IHRoaXMuZ2V0Um91dGVJdGVtKCBwYWdlSWQgKTtcblxuICAgIC8vIEdldCB0aGUgY29udGVudCBvZiB0aGF0IHJvdXRlXG4gICAgcmV0dXJuIHRoaXMuZ2V0Q29udGVudEZvclJvdXRlKCByb3V0ZUl0ZW0gKTtcbn07XG5cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5nZXRDb250ZW50Rm9yUm91dGUgPSBmdW5jdGlvbiggcm91dGVJdGVtICkge1xuICAgIFxuICAgIC8vIENoZWNrIGtlZXBBbGl2ZVxuICAgIGlmICggcm91dGVJdGVtLmtlZXBBbGl2ZSApe1xuICAgICAgICBsZXQgYWxpdmVQYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIHJvdXRlSXRlbS5pZCApO1xuICAgICAgICBpZiAoIGFsaXZlUGFnZSApe1xuICAgICAgICAgICAgcmV0dXJuIGFsaXZlUGFnZTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIC8vIENoZWNrIGNvbnRlbnRcbiAgICBsZXQgY29udGVudCA9IHJvdXRlSXRlbS5jb250ZW50O1xuICAgIGlmICggY29udGVudCApe1xuICAgICAgICByZXR1cm4gY29udGVudDtcbiAgICB9XG5cbiAgICAvLyBDaGVjayB1cmxcbiAgICBsZXQgdXJsID0gcm91dGVJdGVtLnVybDtcbiAgICBpZiAoIHVybCApe1xuICAgICAgICByZXR1cm4gYmx1ZVJvdXRlci5odG1sRmV0Y2hlci5sb2FkVXJsKCB1cmwgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gJzxkaXYgaWQ9XCJlcnJvclwiPk5vIGNvbnRlbnQgZm91bmQgZm9yIHJvdXRlIGZyb20gcGF0aCAnICsgcm91dGVJdGVtLmlkICsgJzwvZGl2Pic7XG59O1xuXG4vKiogQHN1cHByZXNzIHttaXNzaW5nUHJvcGVydGllc30gKi9cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5kb1BhZ2VUcmFuc2l0aW9uID0gZnVuY3Rpb24oIGNvbnRlbnQsIG5leHRQYWdlSWQsIGN1cnJlbnRQYWdlSWQsIHVybE9iamVjdCwgbXVzdEFuaW1hdGVCeUNvZGUgKSB7XG5cbiAgICAvLyBHZXQgbXVzdEFuaW1hdGVPdXQgYW5kIG11c3RBbmltYXRlSW5cbiAgICBjb25zdCBtdXN0QW5pbWF0ZU91dCA9IG11c3RBbmltYXRlQnlDb2RlICYmICEhdGhpcy5vcHRpb25zLmFuaW1hdGlvbk91dDtcbiAgICBjb25zdCBtdXN0QW5pbWF0ZUluID0gbXVzdEFuaW1hdGVCeUNvZGUgJiYgISF0aGlzLm9wdGlvbnMuYW5pbWF0aW9uSW47XG5cbiAgICAvLyBHZXQgdGhlIGluaXRFdmVudFxuICAgIGNvbnN0IGluaXRFdmVudCA9IGNvbnRlbnQgaW5zdGFuY2VvZiBIVE1MRWxlbWVudD8gYmx1ZVJvdXRlci5kZWZhdWx0T3B0aW9ucy5FVkVOVF9SRUlOSVQ6IGJsdWVSb3V0ZXIuZGVmYXVsdE9wdGlvbnMuRVZFTlRfSU5JVDtcblxuICAgIC8vIFJ1biBldmVudHNcbiAgICB0aGlzLnJ1bkV2ZW50KCBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLkVWRU5UX0JFRk9SRV9PVVQsIGN1cnJlbnRQYWdlSWQsIHt9ICk7XG5cbiAgICAvLyBHZXQgdGhlIGN1cnJlbnRQYWdlIGFuZCBhZGQgbmV4dCBwYWdlXG4gICAgbGV0IGN1cnJlbnRQYWdlID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZSggJ2N1cnJlbnRQYWdlJyApWzBdO1xuICAgIGxldCBuZXdQYWdlID0gdGhpcy5hZGROZXh0UGFnZSggY3VycmVudFBhZ2UsIGNvbnRlbnQsIG5leHRQYWdlSWQgKTtcblxuICAgIC8vIFJlbmRlciBuZXh0IHBhZ2VcbiAgICB0aGlzLnJ1blJlbmRlclJlbGF0ZWQoIGluaXRFdmVudCwgbmV4dFBhZ2VJZCwgdXJsT2JqZWN0ICk7XG5cbiAgICAvLyBEZWZpbmUgY3VycmVudFBhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciBhbmQgbmV3UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyXG4gICAgbGV0IHNlbGYgPSB0aGlzO1xuICAgIGxldCBjdXJyZW50UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyID0gKCkgPT4ge1xuICAgICAgICBjdXJyZW50UGFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgY3VycmVudFBhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciApO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGhpZGRlbiBjbGFzcywgYWRkIGFuaW1hdGlvbkluIGNsYXNzXG4gICAgICAgIG5ld1BhZ2UuY2xhc3NMaXN0LnJlbW92ZSggJ2hpZGRlbicgKTtcbiAgICAgICAgaWYgKCBtdXN0QW5pbWF0ZUluICl7XG4gICAgICAgICAgICBuZXdQYWdlLmNsYXNzTGlzdC5hZGQoIHRoaXMub3B0aW9ucy5hbmltYXRpb25JbiApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gUmV0aXJlIGN1cnJlbnQgcGFnZTogc2F2ZSBpdCBhcyBhbiBhbGl2ZSBwYWdlIG9yIHJlbW92ZSBpdFxuICAgICAgICB0aGlzLnJldGlyZUN1cnJlbnRQYWdlKCBjdXJyZW50UGFnZUlkLCBjdXJyZW50UGFnZSApO1xuICAgICAgICBzZWxmLnJ1bkV2ZW50KCBibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zLkVWRU5UX0FGVEVSX09VVCwgY3VycmVudFBhZ2VJZCwge30gKTtcblxuICAgICAgICAvLyAgUnVuIG5ld1BhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciBpZiBsaXN0ZW5lciBvZiBhbWltYXRpb25lbmQgb24gbmV3UGFnZSB3YXMgbm90IGFkZGVkXG4gICAgICAgIGlmICggISBtdXN0QW5pbWF0ZUluICkge1xuICAgICAgICAgICAgbmV3UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyKCk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgbGV0IG5ld1BhZ2VBbmltYXRpb25lbmRMaXN0ZW5lciA9ICgpID0+IHtcbiAgICAgICAgbmV3UGFnZS5yZW1vdmVFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgbmV3UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyICk7XG5cbiAgICAgICAgLy8gUmVtb3ZlIG5leHRQYWdlIGNsYXNzLCBhZGQgY3VycmVudFBhZ2UgY2xhc3MsIHJlbW92ZSBhbmltYXRpb25JbiBjbGFzc1xuICAgICAgICBuZXdQYWdlLmNsYXNzTGlzdC5yZW1vdmUoICduZXh0UGFnZScgKTtcbiAgICAgICAgbmV3UGFnZS5jbGFzc0xpc3QuYWRkKCAnY3VycmVudFBhZ2UnICk7XG4gICAgICAgIGlmICggbXVzdEFuaW1hdGVJbiApe1xuICAgICAgICAgICAgbmV3UGFnZS5jbGFzc0xpc3QucmVtb3ZlKCB0aGlzLm9wdGlvbnMuYW5pbWF0aW9uSW4gKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIFJ1biBFVkVOVF9JTklUIG9yIEVWRU5UX1JFSU5JVFxuICAgICAgICBzZWxmLnJ1bkV2ZW50KCBpbml0RXZlbnQsIG5leHRQYWdlSWQsIHVybE9iamVjdCApO1xuXG4gICAgICAgIC8vIFJ1biBFVkVOVF9NT1VOVEVEXG4gICAgICAgIHNlbGYucnVuRXZlbnQoIGJsdWVSb3V0ZXIuZGVmYXVsdE9wdGlvbnMuRVZFTlRfTU9VTlRFRCwgbmV4dFBhZ2VJZCwgdXJsT2JqZWN0ICk7XG4gICAgfTtcblxuICAgIC8vIEFkZCBldmVudCBsaXN0ZW5lcnNcbiAgICBpZiAoIG11c3RBbmltYXRlT3V0ICl7XG4gICAgICAgIGN1cnJlbnRQYWdlLmFkZEV2ZW50TGlzdGVuZXIoICdhbmltYXRpb25lbmQnLCBjdXJyZW50UGFnZUFuaW1hdGlvbmVuZExpc3RlbmVyICk7XG4gICAgfVxuICAgIGlmICggbXVzdEFuaW1hdGVJbiApe1xuICAgICAgICBuZXdQYWdlLmFkZEV2ZW50TGlzdGVuZXIoICdhbmltYXRpb25lbmQnLCBuZXdQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIgKTtcbiAgICB9XG5cbiAgICAvLyBBbmltYXRlIVxuICAgIGlmICggbXVzdEFuaW1hdGVPdXQgKXtcbiAgICAgICAgY3VycmVudFBhZ2UuY2xhc3NMaXN0LmFkZCggdGhpcy5vcHRpb25zLmFuaW1hdGlvbk91dCApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIGN1cnJlbnRQYWdlQW5pbWF0aW9uZW5kTGlzdGVuZXIoKTtcbiAgICB9XG59O1xuXG4vKiogQHN1cHByZXNzIHttaXNzaW5nUHJvcGVydGllc30gKi9cbmJsdWVSb3V0ZXIucm91dGVyLnByb3RvdHlwZS5ydW5SZW5kZXJSZWxhdGVkID0gZnVuY3Rpb24oIGluaXRFdmVudCwgbmV4dFBhZ2VJZCwgdXJsT2JqZWN0ICl7XG5cbiAgICAvLyBSdW4gcHJlRXZlbnQgKEVWRU5UX1BSRV9JTklUIG9yIEVWRU5UX1BSRV9SRUlOSVQpXG4gICAgY29uc3QgcHJlRXZlbnQgPSBpbml0RXZlbnQgPT09ICB0aGlzLm9wdGlvbnMuRVZFTlRfSU5JVD9cbiAgICAgICAgdGhpcy5vcHRpb25zLkVWRU5UX1BSRV9JTklUOlxuICAgICAgICB0aGlzLm9wdGlvbnMuRVZFTlRfUFJFX1JFSU5JVFxuXG4gICAgdGhpcy5ydW5FdmVudCggcHJlRXZlbnQsIG5leHRQYWdlSWQsIHVybE9iamVjdCApO1xuXG4gICAgLy8gUnVuIHJlbmRlciBpZiBuZWVkZWRcbiAgICBjb25zdCByb3V0ZUl0ZW0gPSB0aGlzLmdldFJvdXRlSXRlbSggbmV4dFBhZ2VJZCApO1xuICAgIGNvbnN0IHJlbmRlck9wdGlvbiA9IGluaXRFdmVudCA9PT0gIHRoaXMub3B0aW9ucy5FVkVOVF9JTklUP1xuICAgICAgICB0aGlzLm9wdGlvbnMuUlVOX1JFTkRFUl9CRUZPUkVfRVZFTlRfSU5JVDpcbiAgICAgICAgdGhpcy5vcHRpb25zLlJVTl9SRU5ERVJfQkVGT1JFX0VWRU5UX1JFSU5JVDtcbiAgICBjb25zdCByb3V0ZVByb3BlcnR5ID0gaW5pdEV2ZW50ID09PSAgdGhpcy5vcHRpb25zLkVWRU5UX0lOSVQ/XG4gICAgICAgICdydW5SZW5kZXJCZWZvcmVJbml0JzpcbiAgICAgICAgJ3J1blJlbmRlckJlZm9yZVJlaW5pdCc7XG4gICAgY29uc3QgbXVzdFJ1blJlbmRlciA9IHJvdXRlSXRlbVsgcm91dGVQcm9wZXJ0eSBdID09PSB1bmRlZmluZWQ/XG4gICAgICAgIHJlbmRlck9wdGlvbjpcbiAgICAgICAgcm91dGVJdGVtWyByb3V0ZVByb3BlcnR5IF07XG5cbiAgICBpZiAoIG11c3RSdW5SZW5kZXIgJiYgdGhpcy5vcHRpb25zLnJlbmRlckZ1bmN0aW9uICYmIGJsdWVSb3V0ZXIudXRpbHMuaXNGdW5jdGlvbiggdGhpcy5vcHRpb25zLnJlbmRlckZ1bmN0aW9uICkgKXtcbiAgICAgICAgdGhpcy5vcHRpb25zLnJlbmRlckZ1bmN0aW9uKFxuICAgICAgICAgICAgdGhpcy5idWlsZFBhZ2VJbnN0YW5jZSggbmV4dFBhZ2VJZCApXG4gICAgICAgICk7XG4gICAgfVxufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLmJ1aWxkUGFnZUluc3RhbmNlID0gZnVuY3Rpb24oIHBhZ2VJZCApe1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgICdpZCc6IHBhZ2VJZCxcbiAgICAgICAgICdlbCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBwYWdlSWQgKVxuICAgIH07XG59O1xuXG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUuYWRkTmV4dFBhZ2UgPSBmdW5jdGlvbiggY3VycmVudFBhZ2UsIGNvbnRlbnQsIG5leHRQYWdlSWQgKXtcblxuICAgIGlmICggY29udGVudCBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICl7XG4gICAgICAgIC8vIGNvbnRlbnQgaXMgSFRNTEVsZW1lbnRcbiAgICAgICAgY3VycmVudFBhZ2UuaW5zZXJ0QWRqYWNlbnRFbGVtZW50KFxuICAgICAgICAgICAgJ2FmdGVyZW5kJyxcbiAgICAgICAgICAgIGNvbnRlbnRcbiAgICAgICAgKTtcbiAgICAgICAgY29udGVudC5jbGFzc0xpc3QuYWRkKCAnbmV4dFBhZ2UnICk7XG4gICAgICAgIGNvbnRlbnQuY2xhc3NMaXN0LmFkZCggJ2hpZGRlbicgKTtcbiAgICAgICAgY29udGVudC5jbGFzc0xpc3QucmVtb3ZlKCAnYWxpdmUnICk7XG5cbiAgICB9IGVsc2Uge1xuICAgICAgICAvLyBjb250ZW50IG11c3QgYmUgdGV4dFxuICAgICAgICBjdXJyZW50UGFnZS5pbnNlcnRBZGphY2VudEhUTUwoXG4gICAgICAgICAgICAnYWZ0ZXJlbmQnLFxuICAgICAgICAgICAgJzxkaXYgY2xhc3M9XCJuZXh0UGFnZSBoaWRkZW4gcGFnZVwiIGlkPVwiJyArIG5leHRQYWdlSWQgKyAnXCI+J1xuICAgICAgICAgICAgKyBjb250ZW50XG4gICAgICAgICAgICArICc8L2Rpdj4nXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBuZXh0UGFnZUlkICk7XG59O1xuXG4vLyBSZXRpcmUgY3VycmVudCBwYWdlOiBzYXZlIGl0IGFzIGFuIGFsaXZlIHBhZ2Ugb3IgcmVtb3ZlIGl0XG5ibHVlUm91dGVyLnJvdXRlci5wcm90b3R5cGUucmV0aXJlQ3VycmVudFBhZ2UgPSBmdW5jdGlvbiggY3VycmVudFBhZ2VJZCwgY3VycmVudFBhZ2UgKXtcblxuICAgIGxldCBjdXJyZW50Um91dGUgPSB0aGlzLmdldFJvdXRlSXRlbSggY3VycmVudFBhZ2VJZCApO1xuXG4gICAgLy8gSWYgbXVzdCBrZWVwIGFsaXZlIGN1cnJlbnQgcGFnZSwgc2V0IHBhZ2UgYW5kIGFsaXZlIGFzIGNsYXNzZXMgcmVtb3ZpbmcgdGhlIHJlc3RcbiAgICBpZiAoIGN1cnJlbnRSb3V0ZSAmJiBjdXJyZW50Um91dGUua2VlcEFsaXZlKXtcbiAgICAgICAgY3VycmVudFBhZ2UucmVtb3ZlQXR0cmlidXRlKCAnY2xhc3MnICk7XG4gICAgICAgIGN1cnJlbnRQYWdlLmNsYXNzTGlzdC5hZGQoICdwYWdlJyApO1xuICAgICAgICBjdXJyZW50UGFnZS5jbGFzc0xpc3QuYWRkKCAnYWxpdmUnICk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICAvLyBEbyBub3Qga2VlcCBhbGl2ZSBjdXJyZW50IHBhZ2UsIHNvIHJlbW92ZSBpdFxuICAgIGN1cnJlbnRQYWdlLnJlbW92ZSgpO1xufTtcblxuYmx1ZVJvdXRlci5yb3V0ZXIucHJvdG90eXBlLnJ1bkV2ZW50ID0gZnVuY3Rpb24oIGV2ZW50SWQsIHBhZ2VJZCwgdXJsT2JqZWN0ICkge1xuXG4gICAgaWYgKCBldmVudElkID09IGJsdWVSb3V0ZXIuZGVmYXVsdE9wdGlvbnMuRVZFTlRfSU5JVCApe1xuICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXJzRm9yTGlua3MoIHBhZ2VJZCApO1xuICAgIH1cblxuICAgIC8vIEdldCB0aGUgcGFnZSBvYmplY3QgZnJvbSBvcHRpb25zXG4gICAgLyoqIEBzdXBwcmVzcyB7bWlzc2luZ1Byb3BlcnRpZXN9ICovXG4gICAgbGV0IHBhZ2UgPSB0aGlzLm9wdGlvbnMuZXZlbnRzQnlQYWdlWyBwYWdlSWQgXTtcblxuICAgIC8vIElmIGEgcGFnZSBpcyBmb3VuZCwgcnVuIHRoZSBldmVudCBoYW5kbGVyXG4gICAgaWYgKCBwYWdlICl7XG4gICAgICAgIGxldCBldmVudCA9IHtcbiAgICAgICAgICAgIHBhcmFtczogdXJsT2JqZWN0LnBhcmFtcyB8fCB7fVxuICAgICAgICB9O1xuICAgICAgICBpZiAoIHBhZ2VbIGV2ZW50SWQgXSAmJiBibHVlUm91dGVyLnV0aWxzLmlzRnVuY3Rpb24oIHBhZ2VbIGV2ZW50SWQgXSApICl7XG4gICAgICAgICAgICBwYWdlWyBldmVudElkIF0oIGV2ZW50ICk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuXG5cbi8vIERlZmF1bHQgb3B0aW9uc1xuXG5ibHVlUm91dGVyLmRlZmF1bHRPcHRpb25zID0ge1xuICAgIHVwZGF0ZU9uTG9hZDogdHJ1ZSxcbiAgICBwcmVsb2FkUGFnZXNPbkxvYWQ6IGZhbHNlLFxuXG4gICAgLy8gQW5pbWF0aW9uc1xuICAgIGFuaW1hdGlvbk91dDogJ3NsaWRlLW91dC10b3AnLFxuICAgIC8vYW5pbWF0aW9uT3V0OiBmYWxzZSxcbiAgICBhbmltYXRpb25JbjogJ3NjYWxlLWluLWNlbnRlcicsXG4gICAgLy9hbmltYXRpb25JbjogZmFsc2UsXG4gICAgYW5pbWF0ZVRyYW5zaXRpb25zT25Mb2FkOiBmYWxzZSxcbiAgICBcbiAgICAvLyBNaXNjXG4gICAgUEFHRV9QUkVGSVg6ICchJyxcblxuICAgIC8vIFNwZWNpYWwgcGFnZXMgaWRzXG4gICAgUEFHRV9JRF9IT01FOiAnW2hvbWVdJyxcbiAgICBQQUdFX0lEXzQwNF9FUlJPUjogJ1s0MDRdJyxcblxuICAgIC8vIEV2ZW50c1xuICAgIEVWRU5UX1BSRV9JTklUOiAncHJlSW5pdCcsXG4gICAgRVZFTlRfSU5JVDogJ2luaXQnLFxuICAgIEVWRU5UX1BSRV9SRUlOSVQ6ICdwcmVSZWluaXQnLFxuICAgIEVWRU5UX1JFSU5JVDogJ3JlaW5pdCcsXG4gICAgRVZFTlRfTU9VTlRFRDogJ21vdW50ZWQnLFxuICAgIEVWRU5UX0JFRk9SRV9PVVQ6ICdiZWZvcmVPdXQnLFxuICAgIEVWRU5UX0FGVEVSX09VVDogJ2FmdGVyT3V0JyxcblxuICAgIFJVTl9SRU5ERVJfQkVGT1JFX0VWRU5UX0lOSVQ6IHRydWUsXG4gICAgUlVOX1JFTkRFUl9CRUZPUkVfRVZFTlRfUkVJTklUOiBmYWxzZVxuXG59O1xuXG5cbmJsdWVSb3V0ZXIuaHRtbEZldGNoZXIgPSB7fTtcblxuYmx1ZVJvdXRlci5odG1sRmV0Y2hlci5sb2FkQWxsVXJscyA9IGZ1bmN0aW9uKCByb3V0ZXIsIGNhbGxiYWNrICl7XG5cbiAgICAvLyBHZXQgdGhlIHJvdXRlcyB0byB1c2VcbiAgICBjb25zdCByb3V0ZXMgPSByb3V0ZXIub3B0aW9ucy5yb3V0ZXMgfHwgW107XG5cbiAgICAvLyBJbml0IHRoZSBudW1iZXIgb3QgdXJscyB0byBnZXRcbiAgICBsZXQgcGVuZGluZyA9IDA7XG5cbiAgICAvLyBJdGVyYXRlIHVybFJvdXRlcyBhbmQgbG9hZCBlYWNoIHJvdXRlSXRlbSBpZiBuZWVkZWRcbiAgICByb3V0ZXMubWFwKCByb3V0ZUl0ZW0gPT4ge1xuICAgICAgICBsZXQgdXJsID0gcm91dGVJdGVtLnVybDtcbiAgICAgICAgaWYgKCB1cmwgKXtcbiAgICAgICAgICAgICsrcGVuZGluZztcbiAgICAgICAgICAgIGJsdWVSb3V0ZXIuaHRtbEZldGNoZXIubG9hZFVybCggdXJsICkudGhlbihcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiggdGV4dCApe1xuICAgICAgICAgICAgICAgICAgICAvLyBVcGRhdGUgY29udGVudCBvZiByb3V0ZVxuICAgICAgICAgICAgICAgICAgICByb3V0ZUl0ZW0uY29udGVudCA9IHRleHQ7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gUnVuIGNhbGxiYWNrIHdoZW4gYWxsIGZpbGVzIGhhdmUgYmVlbiBsb2FkZWRcbiAgICAgICAgICAgICAgICAgICAgaWYgKCAtLXBlbmRpbmcgPT0gMCAmJiBjYWxsYmFjayAmJiBibHVlUm91dGVyLnV0aWxzLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfSk7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfSB1cmxcbiAqIFxuICovXG5ibHVlUm91dGVyLmh0bWxGZXRjaGVyLmxvYWRVcmwgPSBhc3luYyBmdW5jdGlvbiggdXJsICl7XG5cbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKCB1cmwgKTtcblxuICAgIGlmICggISByZXNwb25zZS5vayApIHtcbiAgICAgICAgY29uc3QgbWVzc2FnZSA9IGBFcnJvciBmZXRjaGluZyAke3VybH0gaGFzIG9jY3VyZWQ6ICR7cmVzcG9uc2Uuc3RhdHVzfWA7XG4gICAgICAgIGFsZXJ0ICggbWVzc2FnZSApO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoIG1lc3NhZ2UgKTtcbiAgICB9XG4gIFxuICAgIGNvbnN0IHRleHQgPSBhd2FpdCByZXNwb25zZS50ZXh0KCk7XG4gICAgcmV0dXJuIHRleHQ7XG59O1xuXG5ibHVlUm91dGVyLnV0aWxzID0ge307XG5cbi8qXG4gICAgQnVpbGRzIGFuIG9iamVjdCB3aXRoIGRhdGEgYWJvdXQgdGhlIHVybC4gQW4gZXhhbXBsZTpcblxuICAgIHVybCA6IGh0dHA6Ly8xMjcuMC4wLjE6OTAwMC9zYW1wbGVzL3NhbXBsZS5odG1sIyFhYm91dD9wYXJhbTE9YSZwYXJhbTI9YlwiXG5cbiAgICBwcmVwYWdlOiBodHRwOi8vMTI3LjAuMC4xOjkwMDAvc2FtcGxlcy9zYW1wbGUuaHRtbFxuICAgIHBhZ2U6IGFib3V0XG4gICAgcGFyYW1zOiB7XG4gICAgICAgIHBhcmFtMTogYVxuICAgICAgICBwYXJhbTI6IGJcbiAgICB9XG4qL1xuYmx1ZVJvdXRlci51dGlscy5hbmFsaXplVXJsID0gZnVuY3Rpb24oIHVybCwgb3B0aW9ucyApIHtcbiAgICBcbiAgICBsZXQgcmVzdWx0ID0ge307XG5cbiAgICAvLyBFeHRyYWN0IHRoZSBwYXJ0cyBiZWZvcmUgYW5kIGFmdGVyIFBBR0VfUFJFRklYXG4gICAgbGV0IHVybFBhcnRzID0gdXJsLnNwbGl0KCBvcHRpb25zLlBBR0VfUFJFRklYICk7XG4gICAgcmVzdWx0LnByZXBhZ2UgPSB1cmxQYXJ0c1sgMCBdO1xuICAgIGxldCBwb3N0UGF0aCA9IHVybFBhcnRzWyAxIF0gfHwgJyc7XG5cbiAgICAvLyBSZW1vdmUgIyBpZiBwcmVzZW50XG4gICAgaWYgKCByZXN1bHQucHJlcGFnZS5lbmRzV2l0aCggJyMnICkgKXtcbiAgICAgICAgcmVzdWx0LnByZXBhZ2UgPSByZXN1bHQucHJlcGFnZS5zbGljZSggMCwgLTEgKTtcbiAgICB9XG5cbiAgICAvLyBFeHRyYWN0IHRoZSBwYXJ0cyBiZWZvcmUgYW5kIGFmdGVyID9cbiAgICBsZXQgcGF0aFBhcnRzID0gcG9zdFBhdGguc3BsaXQoICc/JyApO1xuICAgIHJlc3VsdC5wYWdlID0gcGF0aFBhcnRzWyAwIF07XG5cbiAgICAvLyBGaXggaG9tZSBwYWdlXG4gICAgaWYgKCByZXN1bHQucGFnZSA9PSAnJykge1xuICAgICAgICByZXN1bHQucGFnZSA9IG9wdGlvbnMuUEFHRV9JRF9IT01FO1xuICAgIH1cblxuICAgIGxldCBwYXJhbXNTdHJpbmcgPSBwYXRoUGFydHNbIDEgXSB8fCAnJztcblxuICAgIC8vIEFkZCBwYXJhbXNcbiAgICByZXN1bHQucGFyYW1zID0ge307XG4gICAgaWYgKCBwYXJhbXNTdHJpbmcgPT0gJycgKXtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgbGV0IHZhcnMgPSBwYXJhbXNTdHJpbmcuc3BsaXQoICcmJyApO1xuICAgIGZvciAoIGxldCBpID0gMDsgaSA8IHZhcnMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIGxldCBwYWlyID0gdmFyc1sgaSBdLnNwbGl0KCAnPScgKTtcbiAgICAgICAgbGV0IHBhcmFtTmFtZSA9IHBhaXJbIDAgXTtcbiAgICAgICAgbGV0IHBhcmFtVmFsdWUgPSBwYWlyWyAxIF07XG4gICAgICAgIHJlc3VsdC5wYXJhbXNbIHBhcmFtTmFtZSBdID0gcGFyYW1WYWx1ZTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuYmx1ZVJvdXRlci51dGlscy5hZGRFdmVudExpc3RlbmVyT25MaXN0ID0gZnVuY3Rpb24oIGxpc3QsIGV2ZW50LCBmbiApIHtcblxuICAgIGZvciAoIGxldCBpID0gMCwgbGVuID0gbGlzdC5sZW5ndGg7IGkgPCBsZW47IGkrKyApIHtcbiAgICAgICAgbGlzdFsgaSBdLmFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50LCBmbiwgZmFsc2UgKTtcbiAgICB9XG59O1xuXG5ibHVlUm91dGVyLnV0aWxzLmV4dGVuZCA9IGZ1bmN0aW9uKCBvdXQsIGZyb20xLCBmcm9tMiApIHtcbiAgICBvdXQgPSBvdXQgfHwge307XG5cbiAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBhcmd1bWVudHMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIGlmICggISBhcmd1bWVudHNbIGkgXSApe1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cblxuICAgICAgICBmb3IgKCB2YXIga2V5IGluIGFyZ3VtZW50c1sgaSBdICkge1xuICAgICAgICAgICAgaWYgKCBhcmd1bWVudHNbIGkgXS5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgKXtcbiAgICAgICAgICAgICAgICBvdXRbIGtleSBdID0gYXJndW1lbnRzWyBpIF1bIGtleSBdO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG91dDtcbn07XG5cbi8qIGZvcm1hdFN0cmluZyAqL1xuLy8gRXhhbXBsZTogaXRpbHMuZm9ybWF0U3RyaW5nKCAnezB9IGlzIGRlYWQsIGJ1dCB7MX0gaXMgYWxpdmUhJywgJ0FTUCcsICdBU1AuTkVUJyApXG4vKipcbiAqIFRha2VzIDEgb3IgbW9yZSBzdHJpbmdzIGFuZCBkbyBzb21ldGhpbmcgY29vbCB3aXRoIHRoZW0uXG4gKiBAcGFyYW0gey4uLnN0cmluZ3xudW1iZXJ9IGZvcm1hdFxuICovXG5ibHVlUm91dGVyLnV0aWxzLmZvcm1hdFN0cmluZyA9IGZ1bmN0aW9uKCBmb3JtYXQgKSB7XG4gICAgXG4gICAgdmFyIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbCggYXJndW1lbnRzLCAxICk7XG4gICAgcmV0dXJuIGZvcm1hdC5yZXBsYWNlKC97KFxcZCspfS9nLCBmdW5jdGlvbiAoIG1hdGNoLCBudW1iZXIgKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgYXJnc1sgbnVtYmVyIF0gIT0gJ3VuZGVmaW5lZCc/IGFyZ3NbIG51bWJlciBdIDogbWF0Y2g7XG4gICAgfSk7XG59O1xuXG5ibHVlUm91dGVyLnV0aWxzLmlzRnVuY3Rpb24gPSBmdW5jdGlvbiBpc0Z1bmN0aW9uKCBvYmogKSB7XG5cbiAgICAvLyBTdXBwb3J0OiBDaHJvbWUgPD01NywgRmlyZWZveCA8PTUyXG4gICAgLy8gSW4gc29tZSBicm93c2VycywgdHlwZW9mIHJldHVybnMgXCJmdW5jdGlvblwiIGZvciBIVE1MIDxvYmplY3Q+IGVsZW1lbnRzXG4gICAgLy8gKGkuZS4sIGB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRWxlbWVudCggXCJvYmplY3RcIiApID09PSBcImZ1bmN0aW9uXCJgKS5cbiAgICAvLyBXZSBkb24ndCB3YW50IHRvIGNsYXNzaWZ5ICphbnkqIERPTSBub2RlIGFzIGEgZnVuY3Rpb24uXG4gICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2Ygb2JqLm5vZGVUeXBlICE9PSBcIm51bWJlclwiO1xufTtcbi8qIGVuZCBvZiB1dGlscyAqL1xuXG4vLyBSZWdpc3RlciBibHVlUm91dGVyIGlmIHdlIGFyZSB1c2luZyBOb2RlXG5pZiAoIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnICYmIG1vZHVsZS5leHBvcnRzICkge1xuICAgIG1vZHVsZS5leHBvcnRzID0gYmx1ZVJvdXRlcjtcbn1cbiIsIihmdW5jdGlvbihyb290LCBmYWN0b3J5KSB7XG4gIGlmICh0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpIHtcbiAgICBkZWZpbmUoW10sIGZhY3RvcnkpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuICB9IGVsc2Uge1xuICAgIHJvb3QubG9hZGpzID0gZmFjdG9yeSgpO1xuICB9XG59KHRoaXMsIGZ1bmN0aW9uKCkge1xuLyoqXG4gKiBHbG9iYWwgZGVwZW5kZW5jaWVzLlxuICogQGdsb2JhbCB7T2JqZWN0fSBkb2N1bWVudCAtIERPTVxuICovXG5cbnZhciBkZXZudWxsID0gZnVuY3Rpb24oKSB7fSxcbiAgICBidW5kbGVJZENhY2hlID0ge30sXG4gICAgYnVuZGxlUmVzdWx0Q2FjaGUgPSB7fSxcbiAgICBidW5kbGVDYWxsYmFja1F1ZXVlID0ge307XG5cblxuLyoqXG4gKiBTdWJzY3JpYmUgdG8gYnVuZGxlIGxvYWQgZXZlbnQuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBidW5kbGVJZHMgLSBCdW5kbGUgaWRzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIHN1YnNjcmliZShidW5kbGVJZHMsIGNhbGxiYWNrRm4pIHtcbiAgLy8gbGlzdGlmeVxuICBidW5kbGVJZHMgPSBidW5kbGVJZHMucHVzaCA/IGJ1bmRsZUlkcyA6IFtidW5kbGVJZHNdO1xuXG4gIHZhciBkZXBzTm90Rm91bmQgPSBbXSxcbiAgICAgIGkgPSBidW5kbGVJZHMubGVuZ3RoLFxuICAgICAgbnVtV2FpdGluZyA9IGksXG4gICAgICBmbixcbiAgICAgIGJ1bmRsZUlkLFxuICAgICAgcixcbiAgICAgIHE7XG5cbiAgLy8gZGVmaW5lIGNhbGxiYWNrIGZ1bmN0aW9uXG4gIGZuID0gZnVuY3Rpb24gKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKSB7XG4gICAgaWYgKHBhdGhzTm90Rm91bmQubGVuZ3RoKSBkZXBzTm90Rm91bmQucHVzaChidW5kbGVJZCk7XG5cbiAgICBudW1XYWl0aW5nLS07XG4gICAgaWYgKCFudW1XYWl0aW5nKSBjYWxsYmFja0ZuKGRlcHNOb3RGb3VuZCk7XG4gIH07XG5cbiAgLy8gcmVnaXN0ZXIgY2FsbGJhY2tcbiAgd2hpbGUgKGktLSkge1xuICAgIGJ1bmRsZUlkID0gYnVuZGxlSWRzW2ldO1xuXG4gICAgLy8gZXhlY3V0ZSBjYWxsYmFjayBpZiBpbiByZXN1bHQgY2FjaGVcbiAgICByID0gYnVuZGxlUmVzdWx0Q2FjaGVbYnVuZGxlSWRdO1xuICAgIGlmIChyKSB7XG4gICAgICBmbihidW5kbGVJZCwgcik7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG5cbiAgICAvLyBhZGQgdG8gY2FsbGJhY2sgcXVldWVcbiAgICBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF0gPSBidW5kbGVDYWxsYmFja1F1ZXVlW2J1bmRsZUlkXSB8fCBbXTtcbiAgICBxLnB1c2goZm4pO1xuICB9XG59XG5cblxuLyoqXG4gKiBQdWJsaXNoIGJ1bmRsZSBsb2FkIGV2ZW50LlxuICogQHBhcmFtIHtzdHJpbmd9IGJ1bmRsZUlkIC0gQnVuZGxlIGlkXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBwYXRoc05vdEZvdW5kIC0gTGlzdCBvZiBmaWxlcyBub3QgZm91bmRcbiAqL1xuZnVuY3Rpb24gcHVibGlzaChidW5kbGVJZCwgcGF0aHNOb3RGb3VuZCkge1xuICAvLyBleGl0IGlmIGlkIGlzbid0IGRlZmluZWRcbiAgaWYgKCFidW5kbGVJZCkgcmV0dXJuO1xuXG4gIHZhciBxID0gYnVuZGxlQ2FsbGJhY2tRdWV1ZVtidW5kbGVJZF07XG5cbiAgLy8gY2FjaGUgcmVzdWx0XG4gIGJ1bmRsZVJlc3VsdENhY2hlW2J1bmRsZUlkXSA9IHBhdGhzTm90Rm91bmQ7XG5cbiAgLy8gZXhpdCBpZiBxdWV1ZSBpcyBlbXB0eVxuICBpZiAoIXEpIHJldHVybjtcblxuICAvLyBlbXB0eSBjYWxsYmFjayBxdWV1ZVxuICB3aGlsZSAocS5sZW5ndGgpIHtcbiAgICBxWzBdKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKTtcbiAgICBxLnNwbGljZSgwLCAxKTtcbiAgfVxufVxuXG5cbi8qKlxuICogRXhlY3V0ZSBjYWxsYmFja3MuXG4gKiBAcGFyYW0ge09iamVjdCBvciBGdW5jdGlvbn0gYXJncyAtIFRoZSBjYWxsYmFjayBhcmdzXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBkZXBzTm90Rm91bmQgLSBMaXN0IG9mIGRlcGVuZGVuY2llcyBub3QgZm91bmRcbiAqL1xuZnVuY3Rpb24gZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBkZXBzTm90Rm91bmQpIHtcbiAgLy8gYWNjZXB0IGZ1bmN0aW9uIGFzIGFyZ3VtZW50XG4gIGlmIChhcmdzLmNhbGwpIGFyZ3MgPSB7c3VjY2VzczogYXJnc307XG5cbiAgLy8gc3VjY2VzcyBhbmQgZXJyb3IgY2FsbGJhY2tzXG4gIGlmIChkZXBzTm90Rm91bmQubGVuZ3RoKSAoYXJncy5lcnJvciB8fCBkZXZudWxsKShkZXBzTm90Rm91bmQpO1xuICBlbHNlIChhcmdzLnN1Y2Nlc3MgfHwgZGV2bnVsbCkoYXJncyk7XG59XG5cblxuLyoqXG4gKiBMb2FkIGluZGl2aWR1YWwgZmlsZS5cbiAqIEBwYXJhbSB7c3RyaW5nfSBwYXRoIC0gVGhlIGZpbGUgcGF0aFxuICogQHBhcmFtIHtGdW5jdGlvbn0gY2FsbGJhY2tGbiAtIFRoZSBjYWxsYmFjayBmdW5jdGlvblxuICovXG5mdW5jdGlvbiBsb2FkRmlsZShwYXRoLCBjYWxsYmFja0ZuLCBhcmdzLCBudW1Ucmllcykge1xuICB2YXIgZG9jID0gZG9jdW1lbnQsXG4gICAgICBhc3luYyA9IGFyZ3MuYXN5bmMsXG4gICAgICBtYXhUcmllcyA9IChhcmdzLm51bVJldHJpZXMgfHwgMCkgKyAxLFxuICAgICAgYmVmb3JlQ2FsbGJhY2tGbiA9IGFyZ3MuYmVmb3JlIHx8IGRldm51bGwsXG4gICAgICBwYXRobmFtZSA9IHBhdGgucmVwbGFjZSgvW1xcP3wjXS4qJC8sICcnKSxcbiAgICAgIHBhdGhTdHJpcHBlZCA9IHBhdGgucmVwbGFjZSgvXihjc3N8aW1nfG1vZHVsZXxub21vZHVsZSkhLywgJycpLFxuICAgICAgaXNMZWdhY3lJRUNzcyxcbiAgICAgIGhhc01vZHVsZVN1cHBvcnQsXG4gICAgICBlO1xuXG4gIG51bVRyaWVzID0gbnVtVHJpZXMgfHwgMDtcblxuICBpZiAoLyheY3NzIXxcXC5jc3MkKS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAvLyBjc3NcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2xpbmsnKTtcbiAgICBlLnJlbCA9ICdzdHlsZXNoZWV0JztcbiAgICBlLmhyZWYgPSBwYXRoU3RyaXBwZWQ7XG5cbiAgICAvLyB0YWcgSUU5K1xuICAgIGlzTGVnYWN5SUVDc3MgPSAnaGlkZUZvY3VzJyBpbiBlO1xuXG4gICAgLy8gdXNlIHByZWxvYWQgaW4gSUUgRWRnZSAodG8gZGV0ZWN0IGxvYWQgZXJyb3JzKVxuICAgIGlmIChpc0xlZ2FjeUlFQ3NzICYmIGUucmVsTGlzdCkge1xuICAgICAgaXNMZWdhY3lJRUNzcyA9IDA7XG4gICAgICBlLnJlbCA9ICdwcmVsb2FkJztcbiAgICAgIGUuYXMgPSAnc3R5bGUnO1xuICAgIH1cbiAgfSBlbHNlIGlmICgvKF5pbWchfFxcLihwbmd8Z2lmfGpwZ3xzdmd8d2VicCkkKS8udGVzdChwYXRobmFtZSkpIHtcbiAgICAvLyBpbWFnZVxuICAgIGUgPSBkb2MuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gICAgZS5zcmMgPSBwYXRoU3RyaXBwZWQ7ICAgIFxuICB9IGVsc2Uge1xuICAgIC8vIGphdmFzY3JpcHRcbiAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuICAgIGUuc3JjID0gcGF0aFN0cmlwcGVkO1xuICAgIGUuYXN5bmMgPSBhc3luYyA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFzeW5jO1xuXG4gICAgLy8gaGFuZGxlIGVzIG1vZHVsZXNcbiAgICAvLyBtb2Rlcm4gYnJvd3NlcnM6XG4gICAgLy8gICBtb2R1bGU6IGFkZCB0byBkb20gd2l0aCB0eXBlPVwibW9kdWxlXCJcbiAgICAvLyAgIG5vbW9kdWxlOiBjYWxsIHN1Y2Nlc3MoKSBjYWxsYmFjayB3aXRob3V0IGFkZGluZyB0byBkb21cbiAgICAvLyBsZWdhY3kgYnJvd3NlcnM6XG4gICAgLy8gICBtb2R1bGU6IGNhbGwgc3VjY2VzcygpIGNhbGxiYWNrIHdpdGhvdXQgYWRkaW5nIHRvIGRvbVxuICAgIC8vICAgbm9tb2R1bGU6IGFkZCB0byBkb20gd2l0aCBkZWZhdWx0IHR5cGUgKFwidGV4dC9qYXZhc2NyaXB0XCIpXG4gICAgaGFzTW9kdWxlU3VwcG9ydCA9ICdub01vZHVsZScgaW4gZTtcbiAgICBpZiAoL15tb2R1bGUhLy50ZXN0KHBhdGhuYW1lKSkge1xuICAgICAgaWYgKCFoYXNNb2R1bGVTdXBwb3J0KSByZXR1cm4gY2FsbGJhY2tGbihwYXRoLCAnbCcpO1xuICAgICAgZS50eXBlID0gXCJtb2R1bGVcIjtcbiAgICB9IGVsc2UgaWYgKC9ebm9tb2R1bGUhLy50ZXN0KHBhdGhuYW1lKSAmJiBoYXNNb2R1bGVTdXBwb3J0KSByZXR1cm4gY2FsbGJhY2tGbihwYXRoLCAnbCcpO1xuICB9XG5cbiAgZS5vbmxvYWQgPSBlLm9uZXJyb3IgPSBlLm9uYmVmb3JlbG9hZCA9IGZ1bmN0aW9uIChldikge1xuICAgIHZhciByZXN1bHQgPSBldi50eXBlWzBdO1xuXG4gICAgLy8gdHJlYXQgZW1wdHkgc3R5bGVzaGVldHMgYXMgZmFpbHVyZXMgdG8gZ2V0IGFyb3VuZCBsYWNrIG9mIG9uZXJyb3JcbiAgICAvLyBzdXBwb3J0IGluIElFOS0xMVxuICAgIGlmIChpc0xlZ2FjeUlFQ3NzKSB7XG4gICAgICB0cnkge1xuICAgICAgICBpZiAoIWUuc2hlZXQuY3NzVGV4dC5sZW5ndGgpIHJlc3VsdCA9ICdlJztcbiAgICAgIH0gY2F0Y2ggKHgpIHtcbiAgICAgICAgLy8gc2hlZXRzIG9iamVjdHMgY3JlYXRlZCBmcm9tIGxvYWQgZXJyb3JzIGRvbid0IGFsbG93IGFjY2VzcyB0b1xuICAgICAgICAvLyBgY3NzVGV4dGAgKHVubGVzcyBlcnJvciBpcyBDb2RlOjE4IFNlY3VyaXR5RXJyb3IpXG4gICAgICAgIGlmICh4LmNvZGUgIT0gMTgpIHJlc3VsdCA9ICdlJztcbiAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBoYW5kbGUgcmV0cmllcyBpbiBjYXNlIG9mIGxvYWQgZmFpbHVyZVxuICAgIGlmIChyZXN1bHQgPT0gJ2UnKSB7XG4gICAgICAvLyBpbmNyZW1lbnQgY291bnRlclxuICAgICAgbnVtVHJpZXMgKz0gMTtcblxuICAgICAgLy8gZXhpdCBmdW5jdGlvbiBhbmQgdHJ5IGFnYWluXG4gICAgICBpZiAobnVtVHJpZXMgPCBtYXhUcmllcykge1xuICAgICAgICByZXR1cm4gbG9hZEZpbGUocGF0aCwgY2FsbGJhY2tGbiwgYXJncywgbnVtVHJpZXMpO1xuICAgICAgfVxuICAgIH0gZWxzZSBpZiAoZS5yZWwgPT0gJ3ByZWxvYWQnICYmIGUuYXMgPT0gJ3N0eWxlJykge1xuICAgICAgLy8gYWN0aXZhdGUgcHJlbG9hZGVkIHN0eWxlc2hlZXRzXG4gICAgICByZXR1cm4gZS5yZWwgPSAnc3R5bGVzaGVldCc7IC8vIGpzaGludCBpZ25vcmU6bGluZVxuICAgIH1cbiAgICBcbiAgICAvLyBleGVjdXRlIGNhbGxiYWNrXG4gICAgY2FsbGJhY2tGbihwYXRoLCByZXN1bHQsIGV2LmRlZmF1bHRQcmV2ZW50ZWQpO1xuICB9O1xuXG4gIC8vIGFkZCB0byBkb2N1bWVudCAodW5sZXNzIGNhbGxiYWNrIHJldHVybnMgYGZhbHNlYClcbiAgaWYgKGJlZm9yZUNhbGxiYWNrRm4ocGF0aCwgZSkgIT09IGZhbHNlKSBkb2MuaGVhZC5hcHBlbmRDaGlsZChlKTtcbn1cblxuXG4vKipcbiAqIExvYWQgbXVsdGlwbGUgZmlsZXMuXG4gKiBAcGFyYW0ge3N0cmluZ1tdfSBwYXRocyAtIFRoZSBmaWxlIHBhdGhzXG4gKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja0ZuIC0gVGhlIGNhbGxiYWNrIGZ1bmN0aW9uXG4gKi9cbmZ1bmN0aW9uIGxvYWRGaWxlcyhwYXRocywgY2FsbGJhY2tGbiwgYXJncykge1xuICAvLyBsaXN0aWZ5IHBhdGhzXG4gIHBhdGhzID0gcGF0aHMucHVzaCA/IHBhdGhzIDogW3BhdGhzXTtcblxuICB2YXIgbnVtV2FpdGluZyA9IHBhdGhzLmxlbmd0aCxcbiAgICAgIHggPSBudW1XYWl0aW5nLFxuICAgICAgcGF0aHNOb3RGb3VuZCA9IFtdLFxuICAgICAgZm4sXG4gICAgICBpO1xuXG4gIC8vIGRlZmluZSBjYWxsYmFjayBmdW5jdGlvblxuICBmbiA9IGZ1bmN0aW9uKHBhdGgsIHJlc3VsdCwgZGVmYXVsdFByZXZlbnRlZCkge1xuICAgIC8vIGhhbmRsZSBlcnJvclxuICAgIGlmIChyZXN1bHQgPT0gJ2UnKSBwYXRoc05vdEZvdW5kLnB1c2gocGF0aCk7XG5cbiAgICAvLyBoYW5kbGUgYmVmb3JlbG9hZCBldmVudC4gSWYgZGVmYXVsdFByZXZlbnRlZCB0aGVuIHRoYXQgbWVhbnMgdGhlIGxvYWRcbiAgICAvLyB3aWxsIGJlIGJsb2NrZWQgKGV4LiBHaG9zdGVyeS9BQlAgb24gU2FmYXJpKVxuICAgIGlmIChyZXN1bHQgPT0gJ2InKSB7XG4gICAgICBpZiAoZGVmYXVsdFByZXZlbnRlZCkgcGF0aHNOb3RGb3VuZC5wdXNoKHBhdGgpO1xuICAgICAgZWxzZSByZXR1cm47XG4gICAgfVxuXG4gICAgbnVtV2FpdGluZy0tO1xuICAgIGlmICghbnVtV2FpdGluZykgY2FsbGJhY2tGbihwYXRoc05vdEZvdW5kKTtcbiAgfTtcblxuICAvLyBsb2FkIHNjcmlwdHNcbiAgZm9yIChpPTA7IGkgPCB4OyBpKyspIGxvYWRGaWxlKHBhdGhzW2ldLCBmbiwgYXJncyk7XG59XG5cblxuLyoqXG4gKiBJbml0aWF0ZSBzY3JpcHQgbG9hZCBhbmQgcmVnaXN0ZXIgYnVuZGxlLlxuICogQHBhcmFtIHsoc3RyaW5nfHN0cmluZ1tdKX0gcGF0aHMgLSBUaGUgZmlsZSBwYXRoc1xuICogQHBhcmFtIHsoc3RyaW5nfEZ1bmN0aW9ufE9iamVjdCl9IFthcmcxXSAtIFRoZSAoMSkgYnVuZGxlSWQgb3IgKDIpIHN1Y2Nlc3NcbiAqICAgY2FsbGJhY2sgb3IgKDMpIG9iamVjdCBsaXRlcmFsIHdpdGggc3VjY2Vzcy9lcnJvciBhcmd1bWVudHMsIG51bVJldHJpZXMsXG4gKiAgIGV0Yy5cbiAqIEBwYXJhbSB7KEZ1bmN0aW9ufE9iamVjdCl9IFthcmcyXSAtIFRoZSAoMSkgc3VjY2VzcyBjYWxsYmFjayBvciAoMikgb2JqZWN0XG4gKiAgIGxpdGVyYWwgd2l0aCBzdWNjZXNzL2Vycm9yIGFyZ3VtZW50cywgbnVtUmV0cmllcywgZXRjLlxuICovXG5mdW5jdGlvbiBsb2FkanMocGF0aHMsIGFyZzEsIGFyZzIpIHtcbiAgdmFyIGJ1bmRsZUlkLFxuICAgICAgYXJncztcblxuICAvLyBidW5kbGVJZCAoaWYgc3RyaW5nKVxuICBpZiAoYXJnMSAmJiBhcmcxLnRyaW0pIGJ1bmRsZUlkID0gYXJnMTtcblxuICAvLyBhcmdzIChkZWZhdWx0IGlzIHt9KVxuICBhcmdzID0gKGJ1bmRsZUlkID8gYXJnMiA6IGFyZzEpIHx8IHt9O1xuXG4gIC8vIHRocm93IGVycm9yIGlmIGJ1bmRsZSBpcyBhbHJlYWR5IGRlZmluZWRcbiAgaWYgKGJ1bmRsZUlkKSB7XG4gICAgaWYgKGJ1bmRsZUlkIGluIGJ1bmRsZUlkQ2FjaGUpIHtcbiAgICAgIHRocm93IFwiTG9hZEpTXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIGJ1bmRsZUlkQ2FjaGVbYnVuZGxlSWRdID0gdHJ1ZTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBsb2FkRm4ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgbG9hZEZpbGVzKHBhdGhzLCBmdW5jdGlvbiAocGF0aHNOb3RGb3VuZCkge1xuICAgICAgLy8gZXhlY3V0ZSBjYWxsYmFja3NcbiAgICAgIGV4ZWN1dGVDYWxsYmFja3MoYXJncywgcGF0aHNOb3RGb3VuZCk7XG4gICAgICBcbiAgICAgIC8vIHJlc29sdmUgUHJvbWlzZVxuICAgICAgaWYgKHJlc29sdmUpIHtcbiAgICAgICAgZXhlY3V0ZUNhbGxiYWNrcyh7c3VjY2VzczogcmVzb2x2ZSwgZXJyb3I6IHJlamVjdH0sIHBhdGhzTm90Rm91bmQpO1xuICAgICAgfVxuXG4gICAgICAvLyBwdWJsaXNoIGJ1bmRsZSBsb2FkIGV2ZW50XG4gICAgICBwdWJsaXNoKGJ1bmRsZUlkLCBwYXRoc05vdEZvdW5kKTtcbiAgICB9LCBhcmdzKTtcbiAgfVxuICBcbiAgaWYgKGFyZ3MucmV0dXJuUHJvbWlzZSkgcmV0dXJuIG5ldyBQcm9taXNlKGxvYWRGbik7XG4gIGVsc2UgbG9hZEZuKCk7XG59XG5cblxuLyoqXG4gKiBFeGVjdXRlIGNhbGxiYWNrcyB3aGVuIGRlcGVuZGVuY2llcyBoYXZlIGJlZW4gc2F0aXNmaWVkLlxuICogQHBhcmFtIHsoc3RyaW5nfHN0cmluZ1tdKX0gZGVwcyAtIExpc3Qgb2YgYnVuZGxlIGlkc1xuICogQHBhcmFtIHtPYmplY3R9IGFyZ3MgLSBzdWNjZXNzL2Vycm9yIGFyZ3VtZW50c1xuICovXG5sb2FkanMucmVhZHkgPSBmdW5jdGlvbiByZWFkeShkZXBzLCBhcmdzKSB7XG4gIC8vIHN1YnNjcmliZSB0byBidW5kbGUgbG9hZCBldmVudFxuICBzdWJzY3JpYmUoZGVwcywgZnVuY3Rpb24gKGRlcHNOb3RGb3VuZCkge1xuICAgIC8vIGV4ZWN1dGUgY2FsbGJhY2tzXG4gICAgZXhlY3V0ZUNhbGxiYWNrcyhhcmdzLCBkZXBzTm90Rm91bmQpO1xuICB9KTtcblxuICByZXR1cm4gbG9hZGpzO1xufTtcblxuXG4vKipcbiAqIE1hbnVhbGx5IHNhdGlzZnkgYnVuZGxlIGRlcGVuZGVuY2llcy5cbiAqIEBwYXJhbSB7c3RyaW5nfSBidW5kbGVJZCAtIFRoZSBidW5kbGUgaWRcbiAqL1xubG9hZGpzLmRvbmUgPSBmdW5jdGlvbiBkb25lKGJ1bmRsZUlkKSB7XG4gIHB1Ymxpc2goYnVuZGxlSWQsIFtdKTtcbn07XG5cblxuLyoqXG4gKiBSZXNldCBsb2FkanMgZGVwZW5kZW5jaWVzIHN0YXR1c2VzXG4gKi9cbmxvYWRqcy5yZXNldCA9IGZ1bmN0aW9uIHJlc2V0KCkge1xuICBidW5kbGVJZENhY2hlID0ge307XG4gIGJ1bmRsZVJlc3VsdENhY2hlID0ge307XG4gIGJ1bmRsZUNhbGxiYWNrUXVldWUgPSB7fTtcbn07XG5cblxuLyoqXG4gKiBEZXRlcm1pbmUgaWYgYnVuZGxlIGhhcyBhbHJlYWR5IGJlZW4gZGVmaW5lZFxuICogQHBhcmFtIFN0cmluZ30gYnVuZGxlSWQgLSBUaGUgYnVuZGxlIGlkXG4gKi9cbmxvYWRqcy5pc0RlZmluZWQgPSBmdW5jdGlvbiBpc0RlZmluZWQoYnVuZGxlSWQpIHtcbiAgcmV0dXJuIGJ1bmRsZUlkIGluIGJ1bmRsZUlkQ2FjaGU7XG59O1xuXG5cbi8vIGV4cG9ydFxucmV0dXJuIGxvYWRqcztcblxufSkpO1xuIiwiLyoqXHJcbiAqIENvcHlyaWdodCAyMDE1IFRpbSBEb3duLlxyXG4gKlxyXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xyXG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXHJcbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxyXG4gKlxyXG4gKiAgICAgIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxyXG4gKlxyXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsIHNvZnR3YXJlXHJcbiAqIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcclxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXHJcbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcclxuICogbGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXHJcbiAqL1xyXG5cclxuXHJcbihmdW5jdGlvbihmYWN0b3J5LHJvb3Qpe2lmKHR5cGVvZiBkZWZpbmU9PVwiZnVuY3Rpb25cIiYmZGVmaW5lLmFtZCl7ZGVmaW5lKGZhY3RvcnkpO31lbHNlIGlmKHR5cGVvZiBtb2R1bGUhPVwidW5kZWZpbmVkXCImJnR5cGVvZiBleHBvcnRzPT1cIm9iamVjdFwiKXttb2R1bGUuZXhwb3J0cz1mYWN0b3J5KCk7fWVsc2V7cm9vdC5sb2c0amF2YXNjcmlwdD1mYWN0b3J5KCk7fX0pKGZ1bmN0aW9uKCl7aWYoIUFycmF5LnByb3RvdHlwZS5wdXNoKXtBcnJheS5wcm90b3R5cGUucHVzaD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj1hcmd1bWVudHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpc1t0aGlzLmxlbmd0aF09YXJndW1lbnRzW2ldO31cclxucmV0dXJuIHRoaXMubGVuZ3RoO307fVxyXG5pZighQXJyYXkucHJvdG90eXBlLnNoaWZ0KXtBcnJheS5wcm90b3R5cGUuc2hpZnQ9ZnVuY3Rpb24oKXtpZih0aGlzLmxlbmd0aD4wKXt2YXIgZmlyc3RJdGVtPXRoaXNbMF07Zm9yKHZhciBpPTAsbGVuPXRoaXMubGVuZ3RoLTE7aTxsZW47aSsrKXt0aGlzW2ldPXRoaXNbaSsxXTt9XHJcbnRoaXMubGVuZ3RoPXRoaXMubGVuZ3RoLTE7cmV0dXJuIGZpcnN0SXRlbTt9fTt9XHJcbmlmKCFBcnJheS5wcm90b3R5cGUuc3BsaWNlKXtBcnJheS5wcm90b3R5cGUuc3BsaWNlPWZ1bmN0aW9uKHN0YXJ0SW5kZXgsZGVsZXRlQ291bnQpe3ZhciBpdGVtc0FmdGVyRGVsZXRlZD10aGlzLnNsaWNlKHN0YXJ0SW5kZXgrZGVsZXRlQ291bnQpO3ZhciBpdGVtc0RlbGV0ZWQ9dGhpcy5zbGljZShzdGFydEluZGV4LHN0YXJ0SW5kZXgrZGVsZXRlQ291bnQpO3RoaXMubGVuZ3RoPXN0YXJ0SW5kZXg7dmFyIGFyZ3VtZW50c0FycmF5PVtdO2Zvcih2YXIgaT0wLGxlbj1hcmd1bWVudHMubGVuZ3RoO2k8bGVuO2krKyl7YXJndW1lbnRzQXJyYXlbaV09YXJndW1lbnRzW2ldO31cclxudmFyIGl0ZW1zVG9BcHBlbmQ9KGFyZ3VtZW50c0FycmF5Lmxlbmd0aD4yKT9pdGVtc0FmdGVyRGVsZXRlZD1hcmd1bWVudHNBcnJheS5zbGljZSgyKS5jb25jYXQoaXRlbXNBZnRlckRlbGV0ZWQpOml0ZW1zQWZ0ZXJEZWxldGVkO2ZvcihpPTAsbGVuPWl0ZW1zVG9BcHBlbmQubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wdXNoKGl0ZW1zVG9BcHBlbmRbaV0pO31cclxucmV0dXJuIGl0ZW1zRGVsZXRlZDt9O31cclxuZnVuY3Rpb24gaXNVbmRlZmluZWQob2JqKXtyZXR1cm4gdHlwZW9mIG9iaj09XCJ1bmRlZmluZWRcIjt9XHJcbmZ1bmN0aW9uIEV2ZW50U3VwcG9ydCgpe31cclxuRXZlbnRTdXBwb3J0LnByb3RvdHlwZT17ZXZlbnRUeXBlczpbXSxldmVudExpc3RlbmVyczp7fSxzZXRFdmVudFR5cGVzOmZ1bmN0aW9uKGV2ZW50VHlwZXNQYXJhbSl7aWYoZXZlbnRUeXBlc1BhcmFtIGluc3RhbmNlb2YgQXJyYXkpe3RoaXMuZXZlbnRUeXBlcz1ldmVudFR5cGVzUGFyYW07dGhpcy5ldmVudExpc3RlbmVycz17fTtmb3IodmFyIGk9MCxsZW49dGhpcy5ldmVudFR5cGVzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZXZlbnRMaXN0ZW5lcnNbdGhpcy5ldmVudFR5cGVzW2ldXT1bXTt9fWVsc2V7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiBzZXRFdmVudFR5cGVzOiBldmVudFR5cGVzIHBhcmFtZXRlciBtdXN0IGJlIGFuIEFycmF5XCIpO319LGFkZEV2ZW50TGlzdGVuZXI6ZnVuY3Rpb24oZXZlbnRUeXBlLGxpc3RlbmVyKXtpZih0eXBlb2YgbGlzdGVuZXI9PVwiZnVuY3Rpb25cIil7aWYoIWFycmF5X2NvbnRhaW5zKHRoaXMuZXZlbnRUeXBlcyxldmVudFR5cGUpKXtoYW5kbGVFcnJvcihcImxvZzRqYXZhc2NyaXB0LkV2ZW50U3VwcG9ydCBbXCIrdGhpcytcIl06IGFkZEV2ZW50TGlzdGVuZXI6IG5vIGV2ZW50IGNhbGxlZCAnXCIrZXZlbnRUeXBlK1wiJ1wiKTt9XHJcbnRoaXMuZXZlbnRMaXN0ZW5lcnNbZXZlbnRUeXBlXS5wdXNoKGxpc3RlbmVyKTt9ZWxzZXtoYW5kbGVFcnJvcihcImxvZzRqYXZhc2NyaXB0LkV2ZW50U3VwcG9ydCBbXCIrdGhpcytcIl06IGFkZEV2ZW50TGlzdGVuZXI6IGxpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvblwiKTt9fSxyZW1vdmVFdmVudExpc3RlbmVyOmZ1bmN0aW9uKGV2ZW50VHlwZSxsaXN0ZW5lcil7aWYodHlwZW9mIGxpc3RlbmVyPT1cImZ1bmN0aW9uXCIpe2lmKCFhcnJheV9jb250YWlucyh0aGlzLmV2ZW50VHlwZXMsZXZlbnRUeXBlKSl7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5FdmVudFN1cHBvcnQgW1wiK3RoaXMrXCJdOiByZW1vdmVFdmVudExpc3RlbmVyOiBubyBldmVudCBjYWxsZWQgJ1wiK2V2ZW50VHlwZStcIidcIik7fVxyXG5hcnJheV9yZW1vdmUodGhpcy5ldmVudExpc3RlbmVyc1tldmVudFR5cGVdLGxpc3RlbmVyKTt9ZWxzZXtoYW5kbGVFcnJvcihcImxvZzRqYXZhc2NyaXB0LkV2ZW50U3VwcG9ydCBbXCIrdGhpcytcIl06IHJlbW92ZUV2ZW50TGlzdGVuZXI6IGxpc3RlbmVyIG11c3QgYmUgYSBmdW5jdGlvblwiKTt9fSxkaXNwYXRjaEV2ZW50OmZ1bmN0aW9uKGV2ZW50VHlwZSxldmVudEFyZ3Mpe2lmKGFycmF5X2NvbnRhaW5zKHRoaXMuZXZlbnRUeXBlcyxldmVudFR5cGUpKXt2YXIgbGlzdGVuZXJzPXRoaXMuZXZlbnRMaXN0ZW5lcnNbZXZlbnRUeXBlXTtmb3IodmFyIGk9MCxsZW49bGlzdGVuZXJzLmxlbmd0aDtpPGxlbjtpKyspe2xpc3RlbmVyc1tpXSh0aGlzLGV2ZW50VHlwZSxldmVudEFyZ3MpO319ZWxzZXtoYW5kbGVFcnJvcihcImxvZzRqYXZhc2NyaXB0LkV2ZW50U3VwcG9ydCBbXCIrdGhpcytcIl06IGRpc3BhdGNoRXZlbnQ6IG5vIGV2ZW50IGNhbGxlZCAnXCIrZXZlbnRUeXBlK1wiJ1wiKTt9fX07dmFyIGFwcGxpY2F0aW9uU3RhcnREYXRlPW5ldyBEYXRlKCk7dmFyIHVuaXF1ZUlkPVwibG9nNGphdmFzY3JpcHRfXCIrYXBwbGljYXRpb25TdGFydERhdGUuZ2V0VGltZSgpK1wiX1wiK1xyXG5NYXRoLmZsb29yKE1hdGgucmFuZG9tKCkqMTAwMDAwMDAwKTt2YXIgZW1wdHlGdW5jdGlvbj1mdW5jdGlvbigpe307dmFyIG5ld0xpbmU9XCJcXHJcXG5cIjt2YXIgcGFnZUxvYWRlZD1mYWxzZTtmdW5jdGlvbiBMb2c0SmF2YVNjcmlwdCgpe31cclxuTG9nNEphdmFTY3JpcHQucHJvdG90eXBlPW5ldyBFdmVudFN1cHBvcnQoKTt2YXIgbG9nNGphdmFzY3JpcHQ9bmV3IExvZzRKYXZhU2NyaXB0KCk7bG9nNGphdmFzY3JpcHQudmVyc2lvbj1cIjEuNC4xM1wiO2xvZzRqYXZhc2NyaXB0LmVkaXRpb249XCJsb2c0amF2YXNjcmlwdFwiO2Z1bmN0aW9uIHRvU3RyKG9iail7aWYob2JqJiZvYmoudG9TdHJpbmcpe3JldHVybiBvYmoudG9TdHJpbmcoKTt9ZWxzZXtyZXR1cm4gU3RyaW5nKG9iaik7fX1cclxuZnVuY3Rpb24gZ2V0RXhjZXB0aW9uTWVzc2FnZShleCl7aWYoZXgubWVzc2FnZSl7cmV0dXJuIGV4Lm1lc3NhZ2U7fWVsc2UgaWYoZXguZGVzY3JpcHRpb24pe3JldHVybiBleC5kZXNjcmlwdGlvbjt9ZWxzZXtyZXR1cm4gdG9TdHIoZXgpO319XHJcbmZ1bmN0aW9uIGdldFVybEZpbGVOYW1lKHVybCl7dmFyIGxhc3RTbGFzaEluZGV4PU1hdGgubWF4KHVybC5sYXN0SW5kZXhPZihcIi9cIiksdXJsLmxhc3RJbmRleE9mKFwiXFxcXFwiKSk7cmV0dXJuIHVybC5zdWJzdHIobGFzdFNsYXNoSW5kZXgrMSk7fVxyXG5mdW5jdGlvbiBnZXRFeGNlcHRpb25TdHJpbmdSZXAoZXgpe2lmKGV4KXt2YXIgZXhTdHI9XCJFeGNlcHRpb246IFwiK2dldEV4Y2VwdGlvbk1lc3NhZ2UoZXgpO3RyeXtpZihleC5saW5lTnVtYmVyKXtleFN0cis9XCIgb24gbGluZSBudW1iZXIgXCIrZXgubGluZU51bWJlcjt9XHJcbmlmKGV4LmZpbGVOYW1lKXtleFN0cis9XCIgaW4gZmlsZSBcIitnZXRVcmxGaWxlTmFtZShleC5maWxlTmFtZSk7fX1jYXRjaChsb2NhbEV4KXtsb2dMb2cud2FybihcIlVuYWJsZSB0byBvYnRhaW4gZmlsZSBhbmQgbGluZSBpbmZvcm1hdGlvbiBmb3IgZXJyb3JcIik7fVxyXG5pZihzaG93U3RhY2tUcmFjZXMmJmV4LnN0YWNrKXtleFN0cis9bmV3TGluZStcIlN0YWNrIHRyYWNlOlwiK25ld0xpbmUrZXguc3RhY2s7fVxyXG5yZXR1cm4gZXhTdHI7fVxyXG5yZXR1cm4gbnVsbDt9XHJcbmZ1bmN0aW9uIGJvb2wob2JqKXtyZXR1cm4gQm9vbGVhbihvYmopO31cclxuZnVuY3Rpb24gdHJpbShzdHIpe3JldHVybiBzdHIucmVwbGFjZSgvXlxccysvLFwiXCIpLnJlcGxhY2UoL1xccyskLyxcIlwiKTt9XHJcbmZ1bmN0aW9uIHNwbGl0SW50b0xpbmVzKHRleHQpe3ZhciB0ZXh0Mj10ZXh0LnJlcGxhY2UoL1xcclxcbi9nLFwiXFxuXCIpLnJlcGxhY2UoL1xcci9nLFwiXFxuXCIpO3JldHVybiB0ZXh0Mi5zcGxpdChcIlxcblwiKTt9XHJcbnZhciB1cmxFbmNvZGU9KHR5cGVvZiB3aW5kb3cuZW5jb2RlVVJJQ29tcG9uZW50IT1cInVuZGVmaW5lZFwiKT9mdW5jdGlvbihzdHIpe3JldHVybiBlbmNvZGVVUklDb21wb25lbnQoc3RyKTt9OmZ1bmN0aW9uKHN0cil7cmV0dXJuIGVzY2FwZShzdHIpLnJlcGxhY2UoL1xcKy9nLFwiJTJCXCIpLnJlcGxhY2UoL1wiL2csXCIlMjJcIikucmVwbGFjZSgvJy9nLFwiJTI3XCIpLnJlcGxhY2UoL1xcLy9nLFwiJTJGXCIpLnJlcGxhY2UoLz0vZyxcIiUzRFwiKTt9O2Z1bmN0aW9uIGFycmF5X3JlbW92ZShhcnIsdmFsKXt2YXIgaW5kZXg9LTE7Zm9yKHZhciBpPTAsbGVuPWFyci5sZW5ndGg7aTxsZW47aSsrKXtpZihhcnJbaV09PT12YWwpe2luZGV4PWk7YnJlYWs7fX1cclxuaWYoaW5kZXg+PTApe2Fyci5zcGxpY2UoaW5kZXgsMSk7cmV0dXJuIHRydWU7fWVsc2V7cmV0dXJuIGZhbHNlO319XHJcbmZ1bmN0aW9uIGFycmF5X2NvbnRhaW5zKGFycix2YWwpe2Zvcih2YXIgaT0wLGxlbj1hcnIubGVuZ3RoO2k8bGVuO2krKyl7aWYoYXJyW2ldPT12YWwpe3JldHVybiB0cnVlO319XHJcbnJldHVybiBmYWxzZTt9XHJcbmZ1bmN0aW9uIGV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKHBhcmFtLGRlZmF1bHRWYWx1ZSl7aWYoaXNVbmRlZmluZWQocGFyYW0pKXtyZXR1cm4gZGVmYXVsdFZhbHVlO31lbHNle3JldHVybiBib29sKHBhcmFtKTt9fVxyXG5mdW5jdGlvbiBleHRyYWN0U3RyaW5nRnJvbVBhcmFtKHBhcmFtLGRlZmF1bHRWYWx1ZSl7aWYoaXNVbmRlZmluZWQocGFyYW0pKXtyZXR1cm4gZGVmYXVsdFZhbHVlO31lbHNle3JldHVybiBTdHJpbmcocGFyYW0pO319XHJcbmZ1bmN0aW9uIGV4dHJhY3RJbnRGcm9tUGFyYW0ocGFyYW0sZGVmYXVsdFZhbHVlKXtpZihpc1VuZGVmaW5lZChwYXJhbSkpe3JldHVybiBkZWZhdWx0VmFsdWU7fWVsc2V7dHJ5e3ZhciB2YWx1ZT1wYXJzZUludChwYXJhbSwxMCk7cmV0dXJuIGlzTmFOKHZhbHVlKT9kZWZhdWx0VmFsdWU6dmFsdWU7fWNhdGNoKGV4KXtsb2dMb2cud2FybihcIkludmFsaWQgaW50IHBhcmFtIFwiK3BhcmFtLGV4KTtyZXR1cm4gZGVmYXVsdFZhbHVlO319fVxyXG5mdW5jdGlvbiBleHRyYWN0RnVuY3Rpb25Gcm9tUGFyYW0ocGFyYW0sZGVmYXVsdFZhbHVlKXtpZih0eXBlb2YgcGFyYW09PVwiZnVuY3Rpb25cIil7cmV0dXJuIHBhcmFtO31lbHNle3JldHVybiBkZWZhdWx0VmFsdWU7fX1cclxuZnVuY3Rpb24gaXNFcnJvcihlcnIpe3JldHVybihlcnIgaW5zdGFuY2VvZiBFcnJvcik7fVxyXG5pZighRnVuY3Rpb24ucHJvdG90eXBlLmFwcGx5KXtGdW5jdGlvbi5wcm90b3R5cGUuYXBwbHk9ZnVuY3Rpb24ob2JqLGFyZ3Mpe3ZhciBtZXRob2ROYW1lPVwiX19hcHBseV9fXCI7aWYodHlwZW9mIG9ialttZXRob2ROYW1lXSE9XCJ1bmRlZmluZWRcIil7bWV0aG9kTmFtZSs9U3RyaW5nKE1hdGgucmFuZG9tKCkpLnN1YnN0cigyKTt9XHJcbm9ialttZXRob2ROYW1lXT10aGlzO3ZhciBhcmdzU3RyaW5ncz1bXTtmb3IodmFyIGk9MCxsZW49YXJncy5sZW5ndGg7aTxsZW47aSsrKXthcmdzU3RyaW5nc1tpXT1cImFyZ3NbXCIraStcIl1cIjt9XHJcbnZhciBzY3JpcHQ9XCJvYmouXCIrbWV0aG9kTmFtZStcIihcIithcmdzU3RyaW5ncy5qb2luKFwiLFwiKStcIilcIjt2YXIgcmV0dXJuVmFsdWU9ZXZhbChzY3JpcHQpO2RlbGV0ZSBvYmpbbWV0aG9kTmFtZV07cmV0dXJuIHJldHVyblZhbHVlO307fVxyXG5pZighRnVuY3Rpb24ucHJvdG90eXBlLmNhbGwpe0Z1bmN0aW9uLnByb3RvdHlwZS5jYWxsPWZ1bmN0aW9uKG9iail7dmFyIGFyZ3M9W107Zm9yKHZhciBpPTEsbGVuPWFyZ3VtZW50cy5sZW5ndGg7aTxsZW47aSsrKXthcmdzW2ktMV09YXJndW1lbnRzW2ldO31cclxucmV0dXJuIHRoaXMuYXBwbHkob2JqLGFyZ3MpO307fVxyXG52YXIgbG9nTG9nPXtxdWlldE1vZGU6ZmFsc2UsZGVidWdNZXNzYWdlczpbXSxzZXRRdWlldE1vZGU6ZnVuY3Rpb24ocXVpZXRNb2RlKXt0aGlzLnF1aWV0TW9kZT1ib29sKHF1aWV0TW9kZSk7fSxudW1iZXJPZkVycm9yczowLGFsZXJ0QWxsRXJyb3JzOmZhbHNlLHNldEFsZXJ0QWxsRXJyb3JzOmZ1bmN0aW9uKGFsZXJ0QWxsRXJyb3JzKXt0aGlzLmFsZXJ0QWxsRXJyb3JzPWFsZXJ0QWxsRXJyb3JzO30sZGVidWc6ZnVuY3Rpb24obWVzc2FnZSl7dGhpcy5kZWJ1Z01lc3NhZ2VzLnB1c2gobWVzc2FnZSk7fSxkaXNwbGF5RGVidWc6ZnVuY3Rpb24oKXthbGVydCh0aGlzLmRlYnVnTWVzc2FnZXMuam9pbihuZXdMaW5lKSk7fSx3YXJuOmZ1bmN0aW9uKG1lc3NhZ2UsZXhjZXB0aW9uKXt9LGVycm9yOmZ1bmN0aW9uKG1lc3NhZ2UsZXhjZXB0aW9uKXtpZigrK3RoaXMubnVtYmVyT2ZFcnJvcnM9PTF8fHRoaXMuYWxlcnRBbGxFcnJvcnMpe2lmKCF0aGlzLnF1aWV0TW9kZSl7dmFyIGFsZXJ0TWVzc2FnZT1cImxvZzRqYXZhc2NyaXB0IGVycm9yOiBcIittZXNzYWdlO2lmKGV4Y2VwdGlvbil7YWxlcnRNZXNzYWdlKz1uZXdMaW5lK25ld0xpbmUrXCJPcmlnaW5hbCBlcnJvcjogXCIrZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4Y2VwdGlvbik7fVxyXG5hbGVydChhbGVydE1lc3NhZ2UpO319fX07bG9nNGphdmFzY3JpcHQubG9nTG9nPWxvZ0xvZztsb2c0amF2YXNjcmlwdC5zZXRFdmVudFR5cGVzKFtcImxvYWRcIixcImVycm9yXCJdKTtmdW5jdGlvbiBoYW5kbGVFcnJvcihtZXNzYWdlLGV4Y2VwdGlvbil7bG9nTG9nLmVycm9yKG1lc3NhZ2UsZXhjZXB0aW9uKTtsb2c0amF2YXNjcmlwdC5kaXNwYXRjaEV2ZW50KFwiZXJyb3JcIix7XCJtZXNzYWdlXCI6bWVzc2FnZSxcImV4Y2VwdGlvblwiOmV4Y2VwdGlvbn0pO31cclxubG9nNGphdmFzY3JpcHQuaGFuZGxlRXJyb3I9aGFuZGxlRXJyb3I7dmFyIGVuYWJsZWQ9ISgodHlwZW9mIGxvZzRqYXZhc2NyaXB0X2Rpc2FibGVkIT1cInVuZGVmaW5lZFwiKSYmbG9nNGphdmFzY3JpcHRfZGlzYWJsZWQpO2xvZzRqYXZhc2NyaXB0LnNldEVuYWJsZWQ9ZnVuY3Rpb24oZW5hYmxlKXtlbmFibGVkPWJvb2woZW5hYmxlKTt9O2xvZzRqYXZhc2NyaXB0LmlzRW5hYmxlZD1mdW5jdGlvbigpe3JldHVybiBlbmFibGVkO307dmFyIHVzZVRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcz10cnVlO2xvZzRqYXZhc2NyaXB0LnNldFRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcz1mdW5jdGlvbih0aW1lU3RhbXBzSW5NaWxsaXNlY29uZHMpe3VzZVRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcz1ib29sKHRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcyk7fTtsb2c0amF2YXNjcmlwdC5pc1RpbWVTdGFtcHNJbk1pbGxpc2Vjb25kcz1mdW5jdGlvbigpe3JldHVybiB1c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM7fTtsb2c0amF2YXNjcmlwdC5ldmFsSW5TY29wZT1mdW5jdGlvbihleHByKXtyZXR1cm4gZXZhbChleHByKTt9O3ZhciBzaG93U3RhY2tUcmFjZXM9ZmFsc2U7bG9nNGphdmFzY3JpcHQuc2V0U2hvd1N0YWNrVHJhY2VzPWZ1bmN0aW9uKHNob3cpe3Nob3dTdGFja1RyYWNlcz1ib29sKHNob3cpO307dmFyIExldmVsPWZ1bmN0aW9uKGxldmVsLG5hbWUpe3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5uYW1lPW5hbWU7fTtMZXZlbC5wcm90b3R5cGU9e3RvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMubmFtZTt9LGVxdWFsczpmdW5jdGlvbihsZXZlbCl7cmV0dXJuIHRoaXMubGV2ZWw9PWxldmVsLmxldmVsO30saXNHcmVhdGVyT3JFcXVhbDpmdW5jdGlvbihsZXZlbCl7cmV0dXJuIHRoaXMubGV2ZWw+PWxldmVsLmxldmVsO319O0xldmVsLkFMTD1uZXcgTGV2ZWwoTnVtYmVyLk1JTl9WQUxVRSxcIkFMTFwiKTtMZXZlbC5UUkFDRT1uZXcgTGV2ZWwoMTAwMDAsXCJUUkFDRVwiKTtMZXZlbC5ERUJVRz1uZXcgTGV2ZWwoMjAwMDAsXCJERUJVR1wiKTtMZXZlbC5JTkZPPW5ldyBMZXZlbCgzMDAwMCxcIklORk9cIik7TGV2ZWwuV0FSTj1uZXcgTGV2ZWwoNDAwMDAsXCJXQVJOXCIpO0xldmVsLkVSUk9SPW5ldyBMZXZlbCg1MDAwMCxcIkVSUk9SXCIpO0xldmVsLkZBVEFMPW5ldyBMZXZlbCg2MDAwMCxcIkZBVEFMXCIpO0xldmVsLk9GRj1uZXcgTGV2ZWwoTnVtYmVyLk1BWF9WQUxVRSxcIk9GRlwiKTtsb2c0amF2YXNjcmlwdC5MZXZlbD1MZXZlbDtmdW5jdGlvbiBUaW1lcihuYW1lLGxldmVsKXt0aGlzLm5hbWU9bmFtZTt0aGlzLmxldmVsPWlzVW5kZWZpbmVkKGxldmVsKT9MZXZlbC5JTkZPOmxldmVsO3RoaXMuc3RhcnQ9bmV3IERhdGUoKTt9XHJcblRpbWVyLnByb3RvdHlwZS5nZXRFbGFwc2VkVGltZT1mdW5jdGlvbigpe3JldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKS10aGlzLnN0YXJ0LmdldFRpbWUoKTt9O3ZhciBhbm9ueW1vdXNMb2dnZXJOYW1lPVwiW2Fub255bW91c11cIjt2YXIgZGVmYXVsdExvZ2dlck5hbWU9XCJbZGVmYXVsdF1cIjt2YXIgbnVsbExvZ2dlck5hbWU9XCJbbnVsbF1cIjt2YXIgcm9vdExvZ2dlck5hbWU9XCJyb290XCI7ZnVuY3Rpb24gTG9nZ2VyKG5hbWUpe3RoaXMubmFtZT1uYW1lO3RoaXMucGFyZW50PW51bGw7dGhpcy5jaGlsZHJlbj1bXTt2YXIgYXBwZW5kZXJzPVtdO3ZhciBsb2dnZXJMZXZlbD1udWxsO3ZhciBpc1Jvb3Q9KHRoaXMubmFtZT09PXJvb3RMb2dnZXJOYW1lKTt2YXIgaXNOdWxsPSh0aGlzLm5hbWU9PT1udWxsTG9nZ2VyTmFtZSk7dmFyIGFwcGVuZGVyQ2FjaGU9bnVsbDt2YXIgYXBwZW5kZXJDYWNoZUludmFsaWRhdGVkPWZhbHNlO3RoaXMuYWRkQ2hpbGQ9ZnVuY3Rpb24oY2hpbGRMb2dnZXIpe3RoaXMuY2hpbGRyZW4ucHVzaChjaGlsZExvZ2dlcik7Y2hpbGRMb2dnZXIucGFyZW50PXRoaXM7Y2hpbGRMb2dnZXIuaW52YWxpZGF0ZUFwcGVuZGVyQ2FjaGUoKTt9O3ZhciBhZGRpdGl2ZT10cnVlO3RoaXMuZ2V0QWRkaXRpdml0eT1mdW5jdGlvbigpe3JldHVybiBhZGRpdGl2ZTt9O3RoaXMuc2V0QWRkaXRpdml0eT1mdW5jdGlvbihhZGRpdGl2aXR5KXt2YXIgdmFsdWVDaGFuZ2VkPShhZGRpdGl2ZSE9YWRkaXRpdml0eSk7YWRkaXRpdmU9YWRkaXRpdml0eTtpZih2YWx1ZUNoYW5nZWQpe3RoaXMuaW52YWxpZGF0ZUFwcGVuZGVyQ2FjaGUoKTt9fTt0aGlzLmFkZEFwcGVuZGVyPWZ1bmN0aW9uKGFwcGVuZGVyKXtpZihpc051bGwpe2hhbmRsZUVycm9yKFwiTG9nZ2VyLmFkZEFwcGVuZGVyOiB5b3UgbWF5IG5vdCBhZGQgYW4gYXBwZW5kZXIgdG8gdGhlIG51bGwgbG9nZ2VyXCIpO31lbHNle2lmKGFwcGVuZGVyIGluc3RhbmNlb2YgbG9nNGphdmFzY3JpcHQuQXBwZW5kZXIpe2lmKCFhcnJheV9jb250YWlucyhhcHBlbmRlcnMsYXBwZW5kZXIpKXthcHBlbmRlcnMucHVzaChhcHBlbmRlcik7YXBwZW5kZXIuc2V0QWRkZWRUb0xvZ2dlcih0aGlzKTt0aGlzLmludmFsaWRhdGVBcHBlbmRlckNhY2hlKCk7fX1lbHNle2hhbmRsZUVycm9yKFwiTG9nZ2VyLmFkZEFwcGVuZGVyOiBhcHBlbmRlciBzdXBwbGllZCAoJ1wiK1xyXG50b1N0cihhcHBlbmRlcikrXCInKSBpcyBub3QgYSBzdWJjbGFzcyBvZiBBcHBlbmRlclwiKTt9fX07dGhpcy5yZW1vdmVBcHBlbmRlcj1mdW5jdGlvbihhcHBlbmRlcil7YXJyYXlfcmVtb3ZlKGFwcGVuZGVycyxhcHBlbmRlcik7YXBwZW5kZXIuc2V0UmVtb3ZlZEZyb21Mb2dnZXIodGhpcyk7dGhpcy5pbnZhbGlkYXRlQXBwZW5kZXJDYWNoZSgpO307dGhpcy5yZW1vdmVBbGxBcHBlbmRlcnM9ZnVuY3Rpb24oKXt2YXIgYXBwZW5kZXJDb3VudD1hcHBlbmRlcnMubGVuZ3RoO2lmKGFwcGVuZGVyQ291bnQ+MCl7Zm9yKHZhciBpPTA7aTxhcHBlbmRlckNvdW50O2krKyl7YXBwZW5kZXJzW2ldLnNldFJlbW92ZWRGcm9tTG9nZ2VyKHRoaXMpO31cclxuYXBwZW5kZXJzLmxlbmd0aD0wO3RoaXMuaW52YWxpZGF0ZUFwcGVuZGVyQ2FjaGUoKTt9fTt0aGlzLmdldEVmZmVjdGl2ZUFwcGVuZGVycz1mdW5jdGlvbigpe2lmKGFwcGVuZGVyQ2FjaGU9PT1udWxsfHxhcHBlbmRlckNhY2hlSW52YWxpZGF0ZWQpe3ZhciBwYXJlbnRFZmZlY3RpdmVBcHBlbmRlcnM9KGlzUm9vdHx8IXRoaXMuZ2V0QWRkaXRpdml0eSgpKT9bXTp0aGlzLnBhcmVudC5nZXRFZmZlY3RpdmVBcHBlbmRlcnMoKTthcHBlbmRlckNhY2hlPXBhcmVudEVmZmVjdGl2ZUFwcGVuZGVycy5jb25jYXQoYXBwZW5kZXJzKTthcHBlbmRlckNhY2hlSW52YWxpZGF0ZWQ9ZmFsc2U7fVxyXG5yZXR1cm4gYXBwZW5kZXJDYWNoZTt9O3RoaXMuaW52YWxpZGF0ZUFwcGVuZGVyQ2FjaGU9ZnVuY3Rpb24oKXthcHBlbmRlckNhY2hlSW52YWxpZGF0ZWQ9dHJ1ZTtmb3IodmFyIGk9MCxsZW49dGhpcy5jaGlsZHJlbi5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmNoaWxkcmVuW2ldLmludmFsaWRhdGVBcHBlbmRlckNhY2hlKCk7fX07dGhpcy5sb2c9ZnVuY3Rpb24obGV2ZWwscGFyYW1zKXtpZihlbmFibGVkJiZsZXZlbC5pc0dyZWF0ZXJPckVxdWFsKHRoaXMuZ2V0RWZmZWN0aXZlTGV2ZWwoKSkpe3ZhciBleGNlcHRpb247dmFyIGZpbmFsUGFyYW1JbmRleD1wYXJhbXMubGVuZ3RoLTE7dmFyIGxhc3RQYXJhbT1wYXJhbXNbZmluYWxQYXJhbUluZGV4XTtpZihwYXJhbXMubGVuZ3RoPjEmJmlzRXJyb3IobGFzdFBhcmFtKSl7ZXhjZXB0aW9uPWxhc3RQYXJhbTtmaW5hbFBhcmFtSW5kZXgtLTt9XHJcbnZhciBtZXNzYWdlcz1bXTtmb3IodmFyIGk9MDtpPD1maW5hbFBhcmFtSW5kZXg7aSsrKXttZXNzYWdlc1tpXT1wYXJhbXNbaV07fVxyXG52YXIgbG9nZ2luZ0V2ZW50PW5ldyBMb2dnaW5nRXZlbnQodGhpcyxuZXcgRGF0ZSgpLGxldmVsLG1lc3NhZ2VzLGV4Y2VwdGlvbik7dGhpcy5jYWxsQXBwZW5kZXJzKGxvZ2dpbmdFdmVudCk7fX07dGhpcy5jYWxsQXBwZW5kZXJzPWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIGVmZmVjdGl2ZUFwcGVuZGVycz10aGlzLmdldEVmZmVjdGl2ZUFwcGVuZGVycygpO2Zvcih2YXIgaT0wLGxlbj1lZmZlY3RpdmVBcHBlbmRlcnMubGVuZ3RoO2k8bGVuO2krKyl7ZWZmZWN0aXZlQXBwZW5kZXJzW2ldLmRvQXBwZW5kKGxvZ2dpbmdFdmVudCk7fX07dGhpcy5zZXRMZXZlbD1mdW5jdGlvbihsZXZlbCl7aWYoaXNSb290JiZsZXZlbD09PW51bGwpe2hhbmRsZUVycm9yKFwiTG9nZ2VyLnNldExldmVsOiB5b3UgY2Fubm90IHNldCB0aGUgbGV2ZWwgb2YgdGhlIHJvb3QgbG9nZ2VyIHRvIG51bGxcIik7fWVsc2UgaWYobGV2ZWwgaW5zdGFuY2VvZiBMZXZlbCl7bG9nZ2VyTGV2ZWw9bGV2ZWw7fWVsc2V7aGFuZGxlRXJyb3IoXCJMb2dnZXIuc2V0TGV2ZWw6IGxldmVsIHN1cHBsaWVkIHRvIGxvZ2dlciBcIitcclxudGhpcy5uYW1lK1wiIGlzIG5vdCBhbiBpbnN0YW5jZSBvZiBsb2c0amF2YXNjcmlwdC5MZXZlbFwiKTt9fTt0aGlzLmdldExldmVsPWZ1bmN0aW9uKCl7cmV0dXJuIGxvZ2dlckxldmVsO307dGhpcy5nZXRFZmZlY3RpdmVMZXZlbD1mdW5jdGlvbigpe2Zvcih2YXIgbG9nZ2VyPXRoaXM7bG9nZ2VyIT09bnVsbDtsb2dnZXI9bG9nZ2VyLnBhcmVudCl7dmFyIGxldmVsPWxvZ2dlci5nZXRMZXZlbCgpO2lmKGxldmVsIT09bnVsbCl7cmV0dXJuIGxldmVsO319fTt0aGlzLmdyb3VwPWZ1bmN0aW9uKG5hbWUsaW5pdGlhbGx5RXhwYW5kZWQpe2lmKGVuYWJsZWQpe3ZhciBlZmZlY3RpdmVBcHBlbmRlcnM9dGhpcy5nZXRFZmZlY3RpdmVBcHBlbmRlcnMoKTtmb3IodmFyIGk9MCxsZW49ZWZmZWN0aXZlQXBwZW5kZXJzLmxlbmd0aDtpPGxlbjtpKyspe2VmZmVjdGl2ZUFwcGVuZGVyc1tpXS5ncm91cChuYW1lLGluaXRpYWxseUV4cGFuZGVkKTt9fX07dGhpcy5ncm91cEVuZD1mdW5jdGlvbigpe2lmKGVuYWJsZWQpe3ZhciBlZmZlY3RpdmVBcHBlbmRlcnM9dGhpcy5nZXRFZmZlY3RpdmVBcHBlbmRlcnMoKTtmb3IodmFyIGk9MCxsZW49ZWZmZWN0aXZlQXBwZW5kZXJzLmxlbmd0aDtpPGxlbjtpKyspe2VmZmVjdGl2ZUFwcGVuZGVyc1tpXS5ncm91cEVuZCgpO319fTt2YXIgdGltZXJzPXt9O3RoaXMudGltZT1mdW5jdGlvbihuYW1lLGxldmVsKXtpZihlbmFibGVkKXtpZihpc1VuZGVmaW5lZChuYW1lKSl7aGFuZGxlRXJyb3IoXCJMb2dnZXIudGltZTogYSBuYW1lIGZvciB0aGUgdGltZXIgbXVzdCBiZSBzdXBwbGllZFwiKTt9ZWxzZSBpZihsZXZlbCYmIShsZXZlbCBpbnN0YW5jZW9mIExldmVsKSl7aGFuZGxlRXJyb3IoXCJMb2dnZXIudGltZTogbGV2ZWwgc3VwcGxpZWQgdG8gdGltZXIgXCIrXHJcbm5hbWUrXCIgaXMgbm90IGFuIGluc3RhbmNlIG9mIGxvZzRqYXZhc2NyaXB0LkxldmVsXCIpO31lbHNle3RpbWVyc1tuYW1lXT1uZXcgVGltZXIobmFtZSxsZXZlbCk7fX19O3RoaXMudGltZUVuZD1mdW5jdGlvbihuYW1lKXtpZihlbmFibGVkKXtpZihpc1VuZGVmaW5lZChuYW1lKSl7aGFuZGxlRXJyb3IoXCJMb2dnZXIudGltZUVuZDogYSBuYW1lIGZvciB0aGUgdGltZXIgbXVzdCBiZSBzdXBwbGllZFwiKTt9ZWxzZSBpZih0aW1lcnNbbmFtZV0pe3ZhciB0aW1lcj10aW1lcnNbbmFtZV07dmFyIG1pbGxpc2Vjb25kcz10aW1lci5nZXRFbGFwc2VkVGltZSgpO3RoaXMubG9nKHRpbWVyLmxldmVsLFtcIlRpbWVyIFwiK3RvU3RyKG5hbWUpK1wiIGNvbXBsZXRlZCBpbiBcIittaWxsaXNlY29uZHMrXCJtc1wiXSk7ZGVsZXRlIHRpbWVyc1tuYW1lXTt9ZWxzZXtsb2dMb2cud2FybihcIkxvZ2dlci50aW1lRW5kOiBubyB0aW1lciBmb3VuZCB3aXRoIG5hbWUgXCIrbmFtZSk7fX19O3RoaXMuYXNzZXJ0PWZ1bmN0aW9uKGV4cHIpe2lmKGVuYWJsZWQmJiFleHByKXt2YXIgYXJncz1bXTtmb3IodmFyIGk9MSxsZW49YXJndW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe2FyZ3MucHVzaChhcmd1bWVudHNbaV0pO31cclxuYXJncz0oYXJncy5sZW5ndGg+MCk/YXJnczpbXCJBc3NlcnRpb24gRmFpbHVyZVwiXTthcmdzLnB1c2gobmV3TGluZSk7YXJncy5wdXNoKGV4cHIpO3RoaXMubG9nKExldmVsLkVSUk9SLGFyZ3MpO319O3RoaXMudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkxvZ2dlcltcIit0aGlzLm5hbWUrXCJdXCI7fTt9XHJcbkxvZ2dlci5wcm90b3R5cGU9e3RyYWNlOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuVFJBQ0UsYXJndW1lbnRzKTt9LGRlYnVnOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuREVCVUcsYXJndW1lbnRzKTt9LGluZm86ZnVuY3Rpb24oKXt0aGlzLmxvZyhMZXZlbC5JTkZPLGFyZ3VtZW50cyk7fSx3YXJuOmZ1bmN0aW9uKCl7dGhpcy5sb2coTGV2ZWwuV0FSTixhcmd1bWVudHMpO30sZXJyb3I6ZnVuY3Rpb24oKXt0aGlzLmxvZyhMZXZlbC5FUlJPUixhcmd1bWVudHMpO30sZmF0YWw6ZnVuY3Rpb24oKXt0aGlzLmxvZyhMZXZlbC5GQVRBTCxhcmd1bWVudHMpO30saXNFbmFibGVkRm9yOmZ1bmN0aW9uKGxldmVsKXtyZXR1cm4gbGV2ZWwuaXNHcmVhdGVyT3JFcXVhbCh0aGlzLmdldEVmZmVjdGl2ZUxldmVsKCkpO30saXNUcmFjZUVuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuVFJBQ0UpO30saXNEZWJ1Z0VuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuREVCVUcpO30saXNJbmZvRW5hYmxlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW5hYmxlZEZvcihMZXZlbC5JTkZPKTt9LGlzV2FybkVuYWJsZWQ6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5pc0VuYWJsZWRGb3IoTGV2ZWwuV0FSTik7fSxpc0Vycm9yRW5hYmxlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW5hYmxlZEZvcihMZXZlbC5FUlJPUik7fSxpc0ZhdGFsRW5hYmxlZDpmdW5jdGlvbigpe3JldHVybiB0aGlzLmlzRW5hYmxlZEZvcihMZXZlbC5GQVRBTCk7fX07TG9nZ2VyLnByb3RvdHlwZS50cmFjZS5pc0VudHJ5UG9pbnQ9dHJ1ZTtMb2dnZXIucHJvdG90eXBlLmRlYnVnLmlzRW50cnlQb2ludD10cnVlO0xvZ2dlci5wcm90b3R5cGUuaW5mby5pc0VudHJ5UG9pbnQ9dHJ1ZTtMb2dnZXIucHJvdG90eXBlLndhcm4uaXNFbnRyeVBvaW50PXRydWU7TG9nZ2VyLnByb3RvdHlwZS5lcnJvci5pc0VudHJ5UG9pbnQ9dHJ1ZTtMb2dnZXIucHJvdG90eXBlLmZhdGFsLmlzRW50cnlQb2ludD10cnVlO3ZhciBsb2dnZXJzPXt9O3ZhciBsb2dnZXJOYW1lcz1bXTt2YXIgUk9PVF9MT0dHRVJfREVGQVVMVF9MRVZFTD1MZXZlbC5ERUJVRzt2YXIgcm9vdExvZ2dlcj1uZXcgTG9nZ2VyKHJvb3RMb2dnZXJOYW1lKTtyb290TG9nZ2VyLnNldExldmVsKFJPT1RfTE9HR0VSX0RFRkFVTFRfTEVWRUwpO2xvZzRqYXZhc2NyaXB0LmdldFJvb3RMb2dnZXI9ZnVuY3Rpb24oKXtyZXR1cm4gcm9vdExvZ2dlcjt9O2xvZzRqYXZhc2NyaXB0LmdldExvZ2dlcj1mdW5jdGlvbihsb2dnZXJOYW1lKXtpZih0eXBlb2YgbG9nZ2VyTmFtZSE9XCJzdHJpbmdcIil7bG9nZ2VyTmFtZT1hbm9ueW1vdXNMb2dnZXJOYW1lO2xvZ0xvZy53YXJuKFwibG9nNGphdmFzY3JpcHQuZ2V0TG9nZ2VyOiBub24tc3RyaW5nIGxvZ2dlciBuYW1lIFwiK1xyXG50b1N0cihsb2dnZXJOYW1lKStcIiBzdXBwbGllZCwgcmV0dXJuaW5nIGFub255bW91cyBsb2dnZXJcIik7fVxyXG5pZihsb2dnZXJOYW1lPT1yb290TG9nZ2VyTmFtZSl7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdC5nZXRMb2dnZXI6IHJvb3QgbG9nZ2VyIG1heSBub3QgYmUgb2J0YWluZWQgYnkgbmFtZVwiKTt9XHJcbmlmKCFsb2dnZXJzW2xvZ2dlck5hbWVdKXt2YXIgbG9nZ2VyPW5ldyBMb2dnZXIobG9nZ2VyTmFtZSk7bG9nZ2Vyc1tsb2dnZXJOYW1lXT1sb2dnZXI7bG9nZ2VyTmFtZXMucHVzaChsb2dnZXJOYW1lKTt2YXIgbGFzdERvdEluZGV4PWxvZ2dlck5hbWUubGFzdEluZGV4T2YoXCIuXCIpO3ZhciBwYXJlbnRMb2dnZXI7aWYobGFzdERvdEluZGV4Pi0xKXt2YXIgcGFyZW50TG9nZ2VyTmFtZT1sb2dnZXJOYW1lLnN1YnN0cmluZygwLGxhc3REb3RJbmRleCk7cGFyZW50TG9nZ2VyPWxvZzRqYXZhc2NyaXB0LmdldExvZ2dlcihwYXJlbnRMb2dnZXJOYW1lKTt9ZWxzZXtwYXJlbnRMb2dnZXI9cm9vdExvZ2dlcjt9XHJcbnBhcmVudExvZ2dlci5hZGRDaGlsZChsb2dnZXIpO31cclxucmV0dXJuIGxvZ2dlcnNbbG9nZ2VyTmFtZV07fTt2YXIgZGVmYXVsdExvZ2dlcj1udWxsO2xvZzRqYXZhc2NyaXB0LmdldERlZmF1bHRMb2dnZXI9ZnVuY3Rpb24oKXtpZighZGVmYXVsdExvZ2dlcil7ZGVmYXVsdExvZ2dlcj1jcmVhdGVEZWZhdWx0TG9nZ2VyKCk7fVxyXG5yZXR1cm4gZGVmYXVsdExvZ2dlcjt9O3ZhciBudWxsTG9nZ2VyPW51bGw7bG9nNGphdmFzY3JpcHQuZ2V0TnVsbExvZ2dlcj1mdW5jdGlvbigpe2lmKCFudWxsTG9nZ2VyKXtudWxsTG9nZ2VyPW5ldyBMb2dnZXIobnVsbExvZ2dlck5hbWUpO251bGxMb2dnZXIuc2V0TGV2ZWwoTGV2ZWwuT0ZGKTt9XHJcbnJldHVybiBudWxsTG9nZ2VyO307bG9nNGphdmFzY3JpcHQucmVzZXRDb25maWd1cmF0aW9uPWZ1bmN0aW9uKCl7cm9vdExvZ2dlci5zZXRMZXZlbChST09UX0xPR0dFUl9ERUZBVUxUX0xFVkVMKTtsb2dnZXJzPXt9O307dmFyIExvZ2dpbmdFdmVudD1mdW5jdGlvbihsb2dnZXIsdGltZVN0YW1wLGxldmVsLG1lc3NhZ2VzLGV4Y2VwdGlvbil7dGhpcy5sb2dnZXI9bG9nZ2VyO3RoaXMudGltZVN0YW1wPXRpbWVTdGFtcDt0aGlzLnRpbWVTdGFtcEluTWlsbGlzZWNvbmRzPXRpbWVTdGFtcC5nZXRUaW1lKCk7dGhpcy50aW1lU3RhbXBJblNlY29uZHM9TWF0aC5mbG9vcih0aGlzLnRpbWVTdGFtcEluTWlsbGlzZWNvbmRzLzEwMDApO3RoaXMubWlsbGlzZWNvbmRzPXRoaXMudGltZVN0YW1wLmdldE1pbGxpc2Vjb25kcygpO3RoaXMubGV2ZWw9bGV2ZWw7dGhpcy5tZXNzYWdlcz1tZXNzYWdlczt0aGlzLmV4Y2VwdGlvbj1leGNlcHRpb247fTtMb2dnaW5nRXZlbnQucHJvdG90eXBlPXtnZXRUaHJvd2FibGVTdHJSZXA6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5leGNlcHRpb24/Z2V0RXhjZXB0aW9uU3RyaW5nUmVwKHRoaXMuZXhjZXB0aW9uKTpcIlwiO30sZ2V0Q29tYmluZWRNZXNzYWdlczpmdW5jdGlvbigpe3JldHVybih0aGlzLm1lc3NhZ2VzLmxlbmd0aD09MSk/dGhpcy5tZXNzYWdlc1swXTp0aGlzLm1lc3NhZ2VzLmpvaW4obmV3TGluZSk7fSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVyblwiTG9nZ2luZ0V2ZW50W1wiK3RoaXMubGV2ZWwrXCJdXCI7fX07bG9nNGphdmFzY3JpcHQuTG9nZ2luZ0V2ZW50PUxvZ2dpbmdFdmVudDt2YXIgTGF5b3V0PWZ1bmN0aW9uKCl7fTtMYXlvdXQucHJvdG90eXBlPXtkZWZhdWx0czp7bG9nZ2VyS2V5OlwibG9nZ2VyXCIsdGltZVN0YW1wS2V5OlwidGltZXN0YW1wXCIsbWlsbGlzZWNvbmRzS2V5OlwibWlsbGlzZWNvbmRzXCIsbGV2ZWxLZXk6XCJsZXZlbFwiLG1lc3NhZ2VLZXk6XCJtZXNzYWdlXCIsZXhjZXB0aW9uS2V5OlwiZXhjZXB0aW9uXCIsdXJsS2V5OlwidXJsXCJ9LGxvZ2dlcktleTpcImxvZ2dlclwiLHRpbWVTdGFtcEtleTpcInRpbWVzdGFtcFwiLG1pbGxpc2Vjb25kc0tleTpcIm1pbGxpc2Vjb25kc1wiLGxldmVsS2V5OlwibGV2ZWxcIixtZXNzYWdlS2V5OlwibWVzc2FnZVwiLGV4Y2VwdGlvbktleTpcImV4Y2VwdGlvblwiLHVybEtleTpcInVybFwiLGJhdGNoSGVhZGVyOlwiXCIsYmF0Y2hGb290ZXI6XCJcIixiYXRjaFNlcGFyYXRvcjpcIlwiLHJldHVybnNQb3N0RGF0YTpmYWxzZSxvdmVycmlkZVRpbWVTdGFtcHNTZXR0aW5nOmZhbHNlLHVzZVRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kczpudWxsLGZvcm1hdDpmdW5jdGlvbigpe2hhbmRsZUVycm9yKFwiTGF5b3V0LmZvcm1hdDogbGF5b3V0IHN1cHBsaWVkIGhhcyBubyBmb3JtYXQoKSBtZXRob2RcIik7fSxpZ25vcmVzVGhyb3dhYmxlOmZ1bmN0aW9uKCl7aGFuZGxlRXJyb3IoXCJMYXlvdXQuaWdub3Jlc1Rocm93YWJsZTogbGF5b3V0IHN1cHBsaWVkIGhhcyBubyBpZ25vcmVzVGhyb3dhYmxlKCkgbWV0aG9kXCIpO30sZ2V0Q29udGVudFR5cGU6ZnVuY3Rpb24oKXtyZXR1cm5cInRleHQvcGxhaW5cIjt9LGFsbG93QmF0Y2hpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gdHJ1ZTt9LHNldFRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kczpmdW5jdGlvbih0aW1lU3RhbXBzSW5NaWxsaXNlY29uZHMpe3RoaXMub3ZlcnJpZGVUaW1lU3RhbXBzU2V0dGluZz10cnVlO3RoaXMudXNlVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzPWJvb2wodGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKTt9LGlzVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMub3ZlcnJpZGVUaW1lU3RhbXBzU2V0dGluZz90aGlzLnVzZVRpbWVTdGFtcHNJbk1pbGxpc2Vjb25kczp1c2VUaW1lU3RhbXBzSW5NaWxsaXNlY29uZHM7fSxnZXRUaW1lU3RhbXBWYWx1ZTpmdW5jdGlvbihsb2dnaW5nRXZlbnQpe3JldHVybiB0aGlzLmlzVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKCk/bG9nZ2luZ0V2ZW50LnRpbWVTdGFtcEluTWlsbGlzZWNvbmRzOmxvZ2dpbmdFdmVudC50aW1lU3RhbXBJblNlY29uZHM7fSxnZXREYXRhVmFsdWVzOmZ1bmN0aW9uKGxvZ2dpbmdFdmVudCxjb21iaW5lTWVzc2FnZXMpe3ZhciBkYXRhVmFsdWVzPVtbdGhpcy5sb2dnZXJLZXksbG9nZ2luZ0V2ZW50LmxvZ2dlci5uYW1lXSxbdGhpcy50aW1lU3RhbXBLZXksdGhpcy5nZXRUaW1lU3RhbXBWYWx1ZShsb2dnaW5nRXZlbnQpXSxbdGhpcy5sZXZlbEtleSxsb2dnaW5nRXZlbnQubGV2ZWwubmFtZV0sW3RoaXMudXJsS2V5LHdpbmRvdy5sb2NhdGlvbi5ocmVmXSxbdGhpcy5tZXNzYWdlS2V5LGNvbWJpbmVNZXNzYWdlcz9sb2dnaW5nRXZlbnQuZ2V0Q29tYmluZWRNZXNzYWdlcygpOmxvZ2dpbmdFdmVudC5tZXNzYWdlc11dO2lmKCF0aGlzLmlzVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKCkpe2RhdGFWYWx1ZXMucHVzaChbdGhpcy5taWxsaXNlY29uZHNLZXksbG9nZ2luZ0V2ZW50Lm1pbGxpc2Vjb25kc10pO31cclxuaWYobG9nZ2luZ0V2ZW50LmV4Y2VwdGlvbil7ZGF0YVZhbHVlcy5wdXNoKFt0aGlzLmV4Y2VwdGlvbktleSxnZXRFeGNlcHRpb25TdHJpbmdSZXAobG9nZ2luZ0V2ZW50LmV4Y2VwdGlvbildKTt9XHJcbmlmKHRoaXMuaGFzQ3VzdG9tRmllbGRzKCkpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmN1c3RvbUZpZWxkcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgdmFsPXRoaXMuY3VzdG9tRmllbGRzW2ldLnZhbHVlO2lmKHR5cGVvZiB2YWw9PT1cImZ1bmN0aW9uXCIpe3ZhbD12YWwodGhpcyxsb2dnaW5nRXZlbnQpO31cclxuZGF0YVZhbHVlcy5wdXNoKFt0aGlzLmN1c3RvbUZpZWxkc1tpXS5uYW1lLHZhbF0pO319XHJcbnJldHVybiBkYXRhVmFsdWVzO30sc2V0S2V5czpmdW5jdGlvbihsb2dnZXJLZXksdGltZVN0YW1wS2V5LGxldmVsS2V5LG1lc3NhZ2VLZXksZXhjZXB0aW9uS2V5LHVybEtleSxtaWxsaXNlY29uZHNLZXkpe3RoaXMubG9nZ2VyS2V5PWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0obG9nZ2VyS2V5LHRoaXMuZGVmYXVsdHMubG9nZ2VyS2V5KTt0aGlzLnRpbWVTdGFtcEtleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKHRpbWVTdGFtcEtleSx0aGlzLmRlZmF1bHRzLnRpbWVTdGFtcEtleSk7dGhpcy5sZXZlbEtleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKGxldmVsS2V5LHRoaXMuZGVmYXVsdHMubGV2ZWxLZXkpO3RoaXMubWVzc2FnZUtleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKG1lc3NhZ2VLZXksdGhpcy5kZWZhdWx0cy5tZXNzYWdlS2V5KTt0aGlzLmV4Y2VwdGlvbktleT1leHRyYWN0U3RyaW5nRnJvbVBhcmFtKGV4Y2VwdGlvbktleSx0aGlzLmRlZmF1bHRzLmV4Y2VwdGlvbktleSk7dGhpcy51cmxLZXk9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbSh1cmxLZXksdGhpcy5kZWZhdWx0cy51cmxLZXkpO3RoaXMubWlsbGlzZWNvbmRzS2V5PWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0obWlsbGlzZWNvbmRzS2V5LHRoaXMuZGVmYXVsdHMubWlsbGlzZWNvbmRzS2V5KTt9LHNldEN1c3RvbUZpZWxkOmZ1bmN0aW9uKG5hbWUsdmFsdWUpe3ZhciBmaWVsZFVwZGF0ZWQ9ZmFsc2U7Zm9yKHZhciBpPTAsbGVuPXRoaXMuY3VzdG9tRmllbGRzLmxlbmd0aDtpPGxlbjtpKyspe2lmKHRoaXMuY3VzdG9tRmllbGRzW2ldLm5hbWU9PT1uYW1lKXt0aGlzLmN1c3RvbUZpZWxkc1tpXS52YWx1ZT12YWx1ZTtmaWVsZFVwZGF0ZWQ9dHJ1ZTt9fVxyXG5pZighZmllbGRVcGRhdGVkKXt0aGlzLmN1c3RvbUZpZWxkcy5wdXNoKHtcIm5hbWVcIjpuYW1lLFwidmFsdWVcIjp2YWx1ZX0pO319LGhhc0N1c3RvbUZpZWxkczpmdW5jdGlvbigpe3JldHVybih0aGlzLmN1c3RvbUZpZWxkcy5sZW5ndGg+MCk7fSxmb3JtYXRXaXRoRXhjZXB0aW9uOmZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIGZvcm1hdHRlZD10aGlzLmZvcm1hdChsb2dnaW5nRXZlbnQpO2lmKGxvZ2dpbmdFdmVudC5leGNlcHRpb24mJnRoaXMuaWdub3Jlc1Rocm93YWJsZSgpKXtmb3JtYXR0ZWQrPWxvZ2dpbmdFdmVudC5nZXRUaHJvd2FibGVTdHJSZXAoKTt9XHJcbnJldHVybiBmb3JtYXR0ZWQ7fSx0b1N0cmluZzpmdW5jdGlvbigpe2hhbmRsZUVycm9yKFwiTGF5b3V0LnRvU3RyaW5nOiBhbGwgbGF5b3V0cyBtdXN0IG92ZXJyaWRlIHRoaXMgbWV0aG9kXCIpO319O2xvZzRqYXZhc2NyaXB0LkxheW91dD1MYXlvdXQ7dmFyIEFwcGVuZGVyPWZ1bmN0aW9uKCl7fTtBcHBlbmRlci5wcm90b3R5cGU9bmV3IEV2ZW50U3VwcG9ydCgpO0FwcGVuZGVyLnByb3RvdHlwZS5sYXlvdXQ9bmV3IFBhdHRlcm5MYXlvdXQoKTtBcHBlbmRlci5wcm90b3R5cGUudGhyZXNob2xkPUxldmVsLkFMTDtBcHBlbmRlci5wcm90b3R5cGUubG9nZ2Vycz1bXTtBcHBlbmRlci5wcm90b3R5cGUuZG9BcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtpZihlbmFibGVkJiZsb2dnaW5nRXZlbnQubGV2ZWwubGV2ZWw+PXRoaXMudGhyZXNob2xkLmxldmVsKXt0aGlzLmFwcGVuZChsb2dnaW5nRXZlbnQpO319O0FwcGVuZGVyLnByb3RvdHlwZS5hcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXt9O0FwcGVuZGVyLnByb3RvdHlwZS5zZXRMYXlvdXQ9ZnVuY3Rpb24obGF5b3V0KXtpZihsYXlvdXQgaW5zdGFuY2VvZiBMYXlvdXQpe3RoaXMubGF5b3V0PWxheW91dDt9ZWxzZXtoYW5kbGVFcnJvcihcIkFwcGVuZGVyLnNldExheW91dDogbGF5b3V0IHN1cHBsaWVkIHRvIFwiK1xyXG50aGlzLnRvU3RyaW5nKCkrXCIgaXMgbm90IGEgc3ViY2xhc3Mgb2YgTGF5b3V0XCIpO319O0FwcGVuZGVyLnByb3RvdHlwZS5nZXRMYXlvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5sYXlvdXQ7fTtBcHBlbmRlci5wcm90b3R5cGUuc2V0VGhyZXNob2xkPWZ1bmN0aW9uKHRocmVzaG9sZCl7aWYodGhyZXNob2xkIGluc3RhbmNlb2YgTGV2ZWwpe3RoaXMudGhyZXNob2xkPXRocmVzaG9sZDt9ZWxzZXtoYW5kbGVFcnJvcihcIkFwcGVuZGVyLnNldFRocmVzaG9sZDogdGhyZXNob2xkIHN1cHBsaWVkIHRvIFwiK1xyXG50aGlzLnRvU3RyaW5nKCkrXCIgaXMgbm90IGEgc3ViY2xhc3Mgb2YgTGV2ZWxcIik7fX07QXBwZW5kZXIucHJvdG90eXBlLmdldFRocmVzaG9sZD1mdW5jdGlvbigpe3JldHVybiB0aGlzLnRocmVzaG9sZDt9O0FwcGVuZGVyLnByb3RvdHlwZS5zZXRBZGRlZFRvTG9nZ2VyPWZ1bmN0aW9uKGxvZ2dlcil7dGhpcy5sb2dnZXJzLnB1c2gobG9nZ2VyKTt9O0FwcGVuZGVyLnByb3RvdHlwZS5zZXRSZW1vdmVkRnJvbUxvZ2dlcj1mdW5jdGlvbihsb2dnZXIpe2FycmF5X3JlbW92ZSh0aGlzLmxvZ2dlcnMsbG9nZ2VyKTt9O0FwcGVuZGVyLnByb3RvdHlwZS5ncm91cD1lbXB0eUZ1bmN0aW9uO0FwcGVuZGVyLnByb3RvdHlwZS5ncm91cEVuZD1lbXB0eUZ1bmN0aW9uO0FwcGVuZGVyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe2hhbmRsZUVycm9yKFwiQXBwZW5kZXIudG9TdHJpbmc6IGFsbCBhcHBlbmRlcnMgbXVzdCBvdmVycmlkZSB0aGlzIG1ldGhvZFwiKTt9O2xvZzRqYXZhc2NyaXB0LkFwcGVuZGVyPUFwcGVuZGVyO2Z1bmN0aW9uIFNpbXBsZUxheW91dCgpe3RoaXMuY3VzdG9tRmllbGRzPVtdO31cclxuU2ltcGxlTGF5b3V0LnByb3RvdHlwZT1uZXcgTGF5b3V0KCk7U2ltcGxlTGF5b3V0LnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtyZXR1cm4gbG9nZ2luZ0V2ZW50LmxldmVsLm5hbWUrXCIgLSBcIitsb2dnaW5nRXZlbnQuZ2V0Q29tYmluZWRNZXNzYWdlcygpO307U2ltcGxlTGF5b3V0LnByb3RvdHlwZS5pZ25vcmVzVGhyb3dhYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTtTaW1wbGVMYXlvdXQucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJTaW1wbGVMYXlvdXRcIjt9O2xvZzRqYXZhc2NyaXB0LlNpbXBsZUxheW91dD1TaW1wbGVMYXlvdXQ7ZnVuY3Rpb24gTnVsbExheW91dCgpe3RoaXMuY3VzdG9tRmllbGRzPVtdO31cclxuTnVsbExheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO051bGxMYXlvdXQucHJvdG90eXBlLmZvcm1hdD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3JldHVybiBsb2dnaW5nRXZlbnQubWVzc2FnZXM7fTtOdWxsTGF5b3V0LnByb3RvdHlwZS5pZ25vcmVzVGhyb3dhYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIHRydWU7fTtOdWxsTGF5b3V0LnByb3RvdHlwZS5mb3JtYXRXaXRoRXhjZXB0aW9uPWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIG1lc3NhZ2VzPWxvZ2dpbmdFdmVudC5tZXNzYWdlcyxleD1sb2dnaW5nRXZlbnQuZXhjZXB0aW9uO3JldHVybiBleD9tZXNzYWdlcy5jb25jYXQoW2V4XSk6bWVzc2FnZXM7fTtOdWxsTGF5b3V0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiTnVsbExheW91dFwiO307bG9nNGphdmFzY3JpcHQuTnVsbExheW91dD1OdWxsTGF5b3V0O2Z1bmN0aW9uIFhtbExheW91dChjb21iaW5lTWVzc2FnZXMpe3RoaXMuY29tYmluZU1lc3NhZ2VzPWV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKGNvbWJpbmVNZXNzYWdlcyx0cnVlKTt0aGlzLmN1c3RvbUZpZWxkcz1bXTt9XHJcblhtbExheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO1htbExheW91dC5wcm90b3R5cGUuaXNDb21iaW5lZE1lc3NhZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tYmluZU1lc3NhZ2VzO307WG1sTGF5b3V0LnByb3RvdHlwZS5nZXRDb250ZW50VHlwZT1mdW5jdGlvbigpe3JldHVyblwidGV4dC94bWxcIjt9O1htbExheW91dC5wcm90b3R5cGUuZXNjYXBlQ2RhdGE9ZnVuY3Rpb24oc3RyKXtyZXR1cm4gc3RyLnJlcGxhY2UoL1xcXVxcXT4vLFwiXV0+XV0mZ3Q7PCFbQ0RBVEFbXCIpO307WG1sTGF5b3V0LnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXt2YXIgbGF5b3V0PXRoaXM7dmFyIGksbGVuO2Z1bmN0aW9uIGZvcm1hdE1lc3NhZ2UobWVzc2FnZSl7bWVzc2FnZT0odHlwZW9mIG1lc3NhZ2U9PT1cInN0cmluZ1wiKT9tZXNzYWdlOnRvU3RyKG1lc3NhZ2UpO3JldHVyblwiPGxvZzRqYXZhc2NyaXB0Om1lc3NhZ2U+PCFbQ0RBVEFbXCIrXHJcbmxheW91dC5lc2NhcGVDZGF0YShtZXNzYWdlKStcIl1dPjwvbG9nNGphdmFzY3JpcHQ6bWVzc2FnZT5cIjt9XHJcbnZhciBzdHI9XCI8bG9nNGphdmFzY3JpcHQ6ZXZlbnQgbG9nZ2VyPVxcXCJcIitsb2dnaW5nRXZlbnQubG9nZ2VyLm5hbWUrXCJcXFwiIHRpbWVzdGFtcD1cXFwiXCIrdGhpcy5nZXRUaW1lU3RhbXBWYWx1ZShsb2dnaW5nRXZlbnQpK1wiXFxcIlwiO2lmKCF0aGlzLmlzVGltZVN0YW1wc0luTWlsbGlzZWNvbmRzKCkpe3N0cis9XCIgbWlsbGlzZWNvbmRzPVxcXCJcIitsb2dnaW5nRXZlbnQubWlsbGlzZWNvbmRzK1wiXFxcIlwiO31cclxuc3RyKz1cIiBsZXZlbD1cXFwiXCIrbG9nZ2luZ0V2ZW50LmxldmVsLm5hbWUrXCJcXFwiPlwiK25ld0xpbmU7aWYodGhpcy5jb21iaW5lTWVzc2FnZXMpe3N0cis9Zm9ybWF0TWVzc2FnZShsb2dnaW5nRXZlbnQuZ2V0Q29tYmluZWRNZXNzYWdlcygpKTt9ZWxzZXtzdHIrPVwiPGxvZzRqYXZhc2NyaXB0Om1lc3NhZ2VzPlwiK25ld0xpbmU7Zm9yKGk9MCxsZW49bG9nZ2luZ0V2ZW50Lm1lc3NhZ2VzLmxlbmd0aDtpPGxlbjtpKyspe3N0cis9Zm9ybWF0TWVzc2FnZShsb2dnaW5nRXZlbnQubWVzc2FnZXNbaV0pK25ld0xpbmU7fVxyXG5zdHIrPVwiPC9sb2c0amF2YXNjcmlwdDptZXNzYWdlcz5cIituZXdMaW5lO31cclxuaWYodGhpcy5oYXNDdXN0b21GaWVsZHMoKSl7Zm9yKGk9MCxsZW49dGhpcy5jdXN0b21GaWVsZHMubGVuZ3RoO2k8bGVuO2krKyl7c3RyKz1cIjxsb2c0amF2YXNjcmlwdDpjdXN0b21maWVsZCBuYW1lPVxcXCJcIitcclxudGhpcy5jdXN0b21GaWVsZHNbaV0ubmFtZStcIlxcXCI+PCFbQ0RBVEFbXCIrXHJcbnRoaXMuY3VzdG9tRmllbGRzW2ldLnZhbHVlLnRvU3RyaW5nKCkrXCJdXT48L2xvZzRqYXZhc2NyaXB0OmN1c3RvbWZpZWxkPlwiK25ld0xpbmU7fX1cclxuaWYobG9nZ2luZ0V2ZW50LmV4Y2VwdGlvbil7c3RyKz1cIjxsb2c0amF2YXNjcmlwdDpleGNlcHRpb24+PCFbQ0RBVEFbXCIrXHJcbmdldEV4Y2VwdGlvblN0cmluZ1JlcChsb2dnaW5nRXZlbnQuZXhjZXB0aW9uKStcIl1dPjwvbG9nNGphdmFzY3JpcHQ6ZXhjZXB0aW9uPlwiK25ld0xpbmU7fVxyXG5zdHIrPVwiPC9sb2c0amF2YXNjcmlwdDpldmVudD5cIituZXdMaW5lK25ld0xpbmU7cmV0dXJuIHN0cjt9O1htbExheW91dC5wcm90b3R5cGUuaWdub3Jlc1Rocm93YWJsZT1mdW5jdGlvbigpe3JldHVybiBmYWxzZTt9O1htbExheW91dC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlhtbExheW91dFwiO307bG9nNGphdmFzY3JpcHQuWG1sTGF5b3V0PVhtbExheW91dDtmdW5jdGlvbiBlc2NhcGVOZXdMaW5lcyhzdHIpe3JldHVybiBzdHIucmVwbGFjZSgvXFxyXFxufFxccnxcXG4vZyxcIlxcXFxyXFxcXG5cIik7fVxyXG5mdW5jdGlvbiBKc29uTGF5b3V0KHJlYWRhYmxlLGNvbWJpbmVNZXNzYWdlcyl7dGhpcy5yZWFkYWJsZT1leHRyYWN0Qm9vbGVhbkZyb21QYXJhbShyZWFkYWJsZSxmYWxzZSk7dGhpcy5jb21iaW5lTWVzc2FnZXM9ZXh0cmFjdEJvb2xlYW5Gcm9tUGFyYW0oY29tYmluZU1lc3NhZ2VzLHRydWUpO3RoaXMuYmF0Y2hIZWFkZXI9dGhpcy5yZWFkYWJsZT9cIltcIituZXdMaW5lOlwiW1wiO3RoaXMuYmF0Y2hGb290ZXI9dGhpcy5yZWFkYWJsZT9cIl1cIituZXdMaW5lOlwiXVwiO3RoaXMuYmF0Y2hTZXBhcmF0b3I9dGhpcy5yZWFkYWJsZT9cIixcIituZXdMaW5lOlwiLFwiO3RoaXMuc2V0S2V5cygpO3RoaXMuY29sb249dGhpcy5yZWFkYWJsZT9cIjogXCI6XCI6XCI7dGhpcy50YWI9dGhpcy5yZWFkYWJsZT9cIlxcdFwiOlwiXCI7dGhpcy5saW5lQnJlYWs9dGhpcy5yZWFkYWJsZT9uZXdMaW5lOlwiXCI7dGhpcy5jdXN0b21GaWVsZHM9W107fVxyXG5Kc29uTGF5b3V0LnByb3RvdHlwZT1uZXcgTGF5b3V0KCk7SnNvbkxheW91dC5wcm90b3R5cGUuaXNSZWFkYWJsZT1mdW5jdGlvbigpe3JldHVybiB0aGlzLnJlYWRhYmxlO307SnNvbkxheW91dC5wcm90b3R5cGUuaXNDb21iaW5lZE1lc3NhZ2VzPWZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuY29tYmluZU1lc3NhZ2VzO307SnNvbkxheW91dC5wcm90b3R5cGUuZm9ybWF0PWZ1bmN0aW9uKGxvZ2dpbmdFdmVudCl7dmFyIGxheW91dD10aGlzO3ZhciBkYXRhVmFsdWVzPXRoaXMuZ2V0RGF0YVZhbHVlcyhsb2dnaW5nRXZlbnQsdGhpcy5jb21iaW5lTWVzc2FnZXMpO3ZhciBzdHI9XCJ7XCIrdGhpcy5saW5lQnJlYWs7dmFyIGksbGVuO2Z1bmN0aW9uIGZvcm1hdFZhbHVlKHZhbCxwcmVmaXgsZXhwYW5kKXt2YXIgZm9ybWF0dGVkVmFsdWU7dmFyIHZhbFR5cGU9dHlwZW9mIHZhbDtpZih2YWwgaW5zdGFuY2VvZiBEYXRlKXtmb3JtYXR0ZWRWYWx1ZT1TdHJpbmcodmFsLmdldFRpbWUoKSk7fWVsc2UgaWYoZXhwYW5kJiYodmFsIGluc3RhbmNlb2YgQXJyYXkpKXtmb3JtYXR0ZWRWYWx1ZT1cIltcIitsYXlvdXQubGluZUJyZWFrO2Zvcih2YXIgaT0wLGxlbj12YWwubGVuZ3RoO2k8bGVuO2krKyl7dmFyIGNoaWxkUHJlZml4PXByZWZpeCtsYXlvdXQudGFiO2Zvcm1hdHRlZFZhbHVlKz1jaGlsZFByZWZpeCtmb3JtYXRWYWx1ZSh2YWxbaV0sY2hpbGRQcmVmaXgsZmFsc2UpO2lmKGk8dmFsLmxlbmd0aC0xKXtmb3JtYXR0ZWRWYWx1ZSs9XCIsXCI7fVxyXG5mb3JtYXR0ZWRWYWx1ZSs9bGF5b3V0LmxpbmVCcmVhazt9XHJcbmZvcm1hdHRlZFZhbHVlKz1wcmVmaXgrXCJdXCI7fWVsc2UgaWYodmFsVHlwZSE9PVwibnVtYmVyXCImJnZhbFR5cGUhPT1cImJvb2xlYW5cIil7Zm9ybWF0dGVkVmFsdWU9XCJcXFwiXCIrZXNjYXBlTmV3TGluZXModG9TdHIodmFsKS5yZXBsYWNlKC9cXFwiL2csXCJcXFxcXFxcIlwiKSkrXCJcXFwiXCI7fWVsc2V7Zm9ybWF0dGVkVmFsdWU9dmFsO31cclxucmV0dXJuIGZvcm1hdHRlZFZhbHVlO31cclxuZm9yKGk9MCxsZW49ZGF0YVZhbHVlcy5sZW5ndGgtMTtpPD1sZW47aSsrKXtzdHIrPXRoaXMudGFiK1wiXFxcIlwiK2RhdGFWYWx1ZXNbaV1bMF0rXCJcXFwiXCIrdGhpcy5jb2xvbitmb3JtYXRWYWx1ZShkYXRhVmFsdWVzW2ldWzFdLHRoaXMudGFiLHRydWUpO2lmKGk8bGVuKXtzdHIrPVwiLFwiO31cclxuc3RyKz10aGlzLmxpbmVCcmVhazt9XHJcbnN0cis9XCJ9XCIrdGhpcy5saW5lQnJlYWs7cmV0dXJuIHN0cjt9O0pzb25MYXlvdXQucHJvdG90eXBlLmlnbm9yZXNUaHJvd2FibGU9ZnVuY3Rpb24oKXtyZXR1cm4gZmFsc2U7fTtKc29uTGF5b3V0LnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiSnNvbkxheW91dFwiO307SnNvbkxheW91dC5wcm90b3R5cGUuZ2V0Q29udGVudFR5cGU9ZnVuY3Rpb24oKXtyZXR1cm5cImFwcGxpY2F0aW9uL2pzb25cIjt9O2xvZzRqYXZhc2NyaXB0Lkpzb25MYXlvdXQ9SnNvbkxheW91dDtmdW5jdGlvbiBIdHRwUG9zdERhdGFMYXlvdXQoKXt0aGlzLnNldEtleXMoKTt0aGlzLmN1c3RvbUZpZWxkcz1bXTt0aGlzLnJldHVybnNQb3N0RGF0YT10cnVlO31cclxuSHR0cFBvc3REYXRhTGF5b3V0LnByb3RvdHlwZT1uZXcgTGF5b3V0KCk7SHR0cFBvc3REYXRhTGF5b3V0LnByb3RvdHlwZS5hbGxvd0JhdGNoaW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGZhbHNlO307SHR0cFBvc3REYXRhTGF5b3V0LnByb3RvdHlwZS5mb3JtYXQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXt2YXIgZGF0YVZhbHVlcz10aGlzLmdldERhdGFWYWx1ZXMobG9nZ2luZ0V2ZW50KTt2YXIgcXVlcnlCaXRzPVtdO2Zvcih2YXIgaT0wLGxlbj1kYXRhVmFsdWVzLmxlbmd0aDtpPGxlbjtpKyspe3ZhciB2YWw9KGRhdGFWYWx1ZXNbaV1bMV1pbnN0YW5jZW9mIERhdGUpP1N0cmluZyhkYXRhVmFsdWVzW2ldWzFdLmdldFRpbWUoKSk6ZGF0YVZhbHVlc1tpXVsxXTtxdWVyeUJpdHMucHVzaCh1cmxFbmNvZGUoZGF0YVZhbHVlc1tpXVswXSkrXCI9XCIrdXJsRW5jb2RlKHZhbCkpO31cclxucmV0dXJuIHF1ZXJ5Qml0cy5qb2luKFwiJlwiKTt9O0h0dHBQb3N0RGF0YUxheW91dC5wcm90b3R5cGUuaWdub3Jlc1Rocm93YWJsZT1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3JldHVybiBmYWxzZTt9O0h0dHBQb3N0RGF0YUxheW91dC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkh0dHBQb3N0RGF0YUxheW91dFwiO307bG9nNGphdmFzY3JpcHQuSHR0cFBvc3REYXRhTGF5b3V0PUh0dHBQb3N0RGF0YUxheW91dDtmdW5jdGlvbiBmb3JtYXRPYmplY3RFeHBhbnNpb24ob2JqLGRlcHRoLGluZGVudGF0aW9uKXt2YXIgb2JqZWN0c0V4cGFuZGVkPVtdO2Z1bmN0aW9uIGRvRm9ybWF0KG9iaixkZXB0aCxpbmRlbnRhdGlvbil7dmFyIGksbGVuLGNoaWxkRGVwdGgsY2hpbGRJbmRlbnRhdGlvbixjaGlsZExpbmVzLGV4cGFuc2lvbixjaGlsZEV4cGFuc2lvbjtpZighaW5kZW50YXRpb24pe2luZGVudGF0aW9uPVwiXCI7fVxyXG5mdW5jdGlvbiBmb3JtYXRTdHJpbmcodGV4dCl7dmFyIGxpbmVzPXNwbGl0SW50b0xpbmVzKHRleHQpO2Zvcih2YXIgaj0xLGpMZW49bGluZXMubGVuZ3RoO2o8akxlbjtqKyspe2xpbmVzW2pdPWluZGVudGF0aW9uK2xpbmVzW2pdO31cclxucmV0dXJuIGxpbmVzLmpvaW4obmV3TGluZSk7fVxyXG5pZihvYmo9PT1udWxsKXtyZXR1cm5cIm51bGxcIjt9ZWxzZSBpZih0eXBlb2Ygb2JqPT1cInVuZGVmaW5lZFwiKXtyZXR1cm5cInVuZGVmaW5lZFwiO31lbHNlIGlmKHR5cGVvZiBvYmo9PVwic3RyaW5nXCIpe3JldHVybiBmb3JtYXRTdHJpbmcob2JqKTt9ZWxzZSBpZih0eXBlb2Ygb2JqPT1cIm9iamVjdFwiJiZhcnJheV9jb250YWlucyhvYmplY3RzRXhwYW5kZWQsb2JqKSl7dHJ5e2V4cGFuc2lvbj10b1N0cihvYmopO31jYXRjaChleCl7ZXhwYW5zaW9uPVwiRXJyb3IgZm9ybWF0dGluZyBwcm9wZXJ0eS4gRGV0YWlsczogXCIrZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4KTt9XHJcbnJldHVybiBleHBhbnNpb24rXCIgW2FscmVhZHkgZXhwYW5kZWRdXCI7fWVsc2UgaWYoKG9iaiBpbnN0YW5jZW9mIEFycmF5KSYmZGVwdGg+MCl7b2JqZWN0c0V4cGFuZGVkLnB1c2gob2JqKTtleHBhbnNpb249XCJbXCIrbmV3TGluZTtjaGlsZERlcHRoPWRlcHRoLTE7Y2hpbGRJbmRlbnRhdGlvbj1pbmRlbnRhdGlvbitcIiAgXCI7Y2hpbGRMaW5lcz1bXTtmb3IoaT0wLGxlbj1vYmoubGVuZ3RoO2k8bGVuO2krKyl7dHJ5e2NoaWxkRXhwYW5zaW9uPWRvRm9ybWF0KG9ialtpXSxjaGlsZERlcHRoLGNoaWxkSW5kZW50YXRpb24pO2NoaWxkTGluZXMucHVzaChjaGlsZEluZGVudGF0aW9uK2NoaWxkRXhwYW5zaW9uKTt9Y2F0Y2goZXgpe2NoaWxkTGluZXMucHVzaChjaGlsZEluZGVudGF0aW9uK1wiRXJyb3IgZm9ybWF0dGluZyBhcnJheSBtZW1iZXIuIERldGFpbHM6IFwiK1xyXG5nZXRFeGNlcHRpb25TdHJpbmdSZXAoZXgpK1wiXCIpO319XHJcbmV4cGFuc2lvbis9Y2hpbGRMaW5lcy5qb2luKFwiLFwiK25ld0xpbmUpK25ld0xpbmUraW5kZW50YXRpb24rXCJdXCI7cmV0dXJuIGV4cGFuc2lvbjt9ZWxzZSBpZihPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwob2JqKT09XCJbb2JqZWN0IERhdGVdXCIpe3JldHVybiBvYmoudG9TdHJpbmcoKTt9ZWxzZSBpZih0eXBlb2Ygb2JqPT1cIm9iamVjdFwiJiZkZXB0aD4wKXtvYmplY3RzRXhwYW5kZWQucHVzaChvYmopO2V4cGFuc2lvbj1cIntcIituZXdMaW5lO2NoaWxkRGVwdGg9ZGVwdGgtMTtjaGlsZEluZGVudGF0aW9uPWluZGVudGF0aW9uK1wiICBcIjtjaGlsZExpbmVzPVtdO2ZvcihpIGluIG9iail7dHJ5e2NoaWxkRXhwYW5zaW9uPWRvRm9ybWF0KG9ialtpXSxjaGlsZERlcHRoLGNoaWxkSW5kZW50YXRpb24pO2NoaWxkTGluZXMucHVzaChjaGlsZEluZGVudGF0aW9uK2krXCI6IFwiK2NoaWxkRXhwYW5zaW9uKTt9Y2F0Y2goZXgpe2NoaWxkTGluZXMucHVzaChjaGlsZEluZGVudGF0aW9uK2krXCI6IEVycm9yIGZvcm1hdHRpbmcgcHJvcGVydHkuIERldGFpbHM6IFwiK1xyXG5nZXRFeGNlcHRpb25TdHJpbmdSZXAoZXgpKTt9fVxyXG5leHBhbnNpb24rPWNoaWxkTGluZXMuam9pbihcIixcIituZXdMaW5lKStuZXdMaW5lK2luZGVudGF0aW9uK1wifVwiO3JldHVybiBleHBhbnNpb247fWVsc2V7cmV0dXJuIGZvcm1hdFN0cmluZyh0b1N0cihvYmopKTt9fVxyXG5yZXR1cm4gZG9Gb3JtYXQob2JqLGRlcHRoLGluZGVudGF0aW9uKTt9XHJcbnZhciBTaW1wbGVEYXRlRm9ybWF0OyhmdW5jdGlvbigpe3ZhciByZWdleD0vKCdbXiddKicpfChHK3x5K3xNK3x3K3xXK3xEK3xkK3xGK3xFK3xhK3xIK3xrK3xLK3xoK3xtK3xzK3xTK3xaKyl8KFthLXpBLVpdKyl8KFteYS16QS1aJ10rKS87dmFyIG1vbnRoTmFtZXM9W1wiSmFudWFyeVwiLFwiRmVicnVhcnlcIixcIk1hcmNoXCIsXCJBcHJpbFwiLFwiTWF5XCIsXCJKdW5lXCIsXCJKdWx5XCIsXCJBdWd1c3RcIixcIlNlcHRlbWJlclwiLFwiT2N0b2JlclwiLFwiTm92ZW1iZXJcIixcIkRlY2VtYmVyXCJdO3ZhciBkYXlOYW1lcz1bXCJTdW5kYXlcIixcIk1vbmRheVwiLFwiVHVlc2RheVwiLFwiV2VkbmVzZGF5XCIsXCJUaHVyc2RheVwiLFwiRnJpZGF5XCIsXCJTYXR1cmRheVwiXTt2YXIgVEVYVDI9MCxURVhUMz0xLE5VTUJFUj0yLFlFQVI9MyxNT05USD00LFRJTUVaT05FPTU7dmFyIHR5cGVzPXtHOlRFWFQyLHk6WUVBUixNOk1PTlRILHc6TlVNQkVSLFc6TlVNQkVSLEQ6TlVNQkVSLGQ6TlVNQkVSLEY6TlVNQkVSLEU6VEVYVDMsYTpURVhUMixIOk5VTUJFUixrOk5VTUJFUixLOk5VTUJFUixoOk5VTUJFUixtOk5VTUJFUixzOk5VTUJFUixTOk5VTUJFUixaOlRJTUVaT05FfTt2YXIgT05FX0RBWT0yNCo2MCo2MCoxMDAwO3ZhciBPTkVfV0VFSz03Kk9ORV9EQVk7dmFyIERFRkFVTFRfTUlOSU1BTF9EQVlTX0lOX0ZJUlNUX1dFRUs9MTt2YXIgbmV3RGF0ZUF0TWlkbmlnaHQ9ZnVuY3Rpb24oeWVhcixtb250aCxkYXkpe3ZhciBkPW5ldyBEYXRlKHllYXIsbW9udGgsZGF5LDAsMCwwKTtkLnNldE1pbGxpc2Vjb25kcygwKTtyZXR1cm4gZDt9O0RhdGUucHJvdG90eXBlLmdldERpZmZlcmVuY2U9ZnVuY3Rpb24oZGF0ZSl7cmV0dXJuIHRoaXMuZ2V0VGltZSgpLWRhdGUuZ2V0VGltZSgpO307RGF0ZS5wcm90b3R5cGUuaXNCZWZvcmU9ZnVuY3Rpb24oZCl7cmV0dXJuIHRoaXMuZ2V0VGltZSgpPGQuZ2V0VGltZSgpO307RGF0ZS5wcm90b3R5cGUuZ2V0VVRDVGltZT1mdW5jdGlvbigpe3JldHVybiBEYXRlLlVUQyh0aGlzLmdldEZ1bGxZZWFyKCksdGhpcy5nZXRNb250aCgpLHRoaXMuZ2V0RGF0ZSgpLHRoaXMuZ2V0SG91cnMoKSx0aGlzLmdldE1pbnV0ZXMoKSx0aGlzLmdldFNlY29uZHMoKSx0aGlzLmdldE1pbGxpc2Vjb25kcygpKTt9O0RhdGUucHJvdG90eXBlLmdldFRpbWVTaW5jZT1mdW5jdGlvbihkKXtyZXR1cm4gdGhpcy5nZXRVVENUaW1lKCktZC5nZXRVVENUaW1lKCk7fTtEYXRlLnByb3RvdHlwZS5nZXRQcmV2aW91c1N1bmRheT1mdW5jdGlvbigpe3ZhciBtaWRkYXk9bmV3IERhdGUodGhpcy5nZXRGdWxsWWVhcigpLHRoaXMuZ2V0TW9udGgoKSx0aGlzLmdldERhdGUoKSwxMiwwLDApO3ZhciBwcmV2aW91c1N1bmRheT1uZXcgRGF0ZShtaWRkYXkuZ2V0VGltZSgpLXRoaXMuZ2V0RGF5KCkqT05FX0RBWSk7cmV0dXJuIG5ld0RhdGVBdE1pZG5pZ2h0KHByZXZpb3VzU3VuZGF5LmdldEZ1bGxZZWFyKCkscHJldmlvdXNTdW5kYXkuZ2V0TW9udGgoKSxwcmV2aW91c1N1bmRheS5nZXREYXRlKCkpO307RGF0ZS5wcm90b3R5cGUuZ2V0V2Vla0luWWVhcj1mdW5jdGlvbihtaW5pbWFsRGF5c0luRmlyc3RXZWVrKXtpZihpc1VuZGVmaW5lZCh0aGlzLm1pbmltYWxEYXlzSW5GaXJzdFdlZWspKXttaW5pbWFsRGF5c0luRmlyc3RXZWVrPURFRkFVTFRfTUlOSU1BTF9EQVlTX0lOX0ZJUlNUX1dFRUs7fVxyXG52YXIgcHJldmlvdXNTdW5kYXk9dGhpcy5nZXRQcmV2aW91c1N1bmRheSgpO3ZhciBzdGFydE9mWWVhcj1uZXdEYXRlQXRNaWRuaWdodCh0aGlzLmdldEZ1bGxZZWFyKCksMCwxKTt2YXIgbnVtYmVyT2ZTdW5kYXlzPXByZXZpb3VzU3VuZGF5LmlzQmVmb3JlKHN0YXJ0T2ZZZWFyKT8wOjErTWF0aC5mbG9vcihwcmV2aW91c1N1bmRheS5nZXRUaW1lU2luY2Uoc3RhcnRPZlllYXIpL09ORV9XRUVLKTt2YXIgbnVtYmVyT2ZEYXlzSW5GaXJzdFdlZWs9Ny1zdGFydE9mWWVhci5nZXREYXkoKTt2YXIgd2Vla0luWWVhcj1udW1iZXJPZlN1bmRheXM7aWYobnVtYmVyT2ZEYXlzSW5GaXJzdFdlZWs8bWluaW1hbERheXNJbkZpcnN0V2Vlayl7d2Vla0luWWVhci0tO31cclxucmV0dXJuIHdlZWtJblllYXI7fTtEYXRlLnByb3RvdHlwZS5nZXRXZWVrSW5Nb250aD1mdW5jdGlvbihtaW5pbWFsRGF5c0luRmlyc3RXZWVrKXtpZihpc1VuZGVmaW5lZCh0aGlzLm1pbmltYWxEYXlzSW5GaXJzdFdlZWspKXttaW5pbWFsRGF5c0luRmlyc3RXZWVrPURFRkFVTFRfTUlOSU1BTF9EQVlTX0lOX0ZJUlNUX1dFRUs7fVxyXG52YXIgcHJldmlvdXNTdW5kYXk9dGhpcy5nZXRQcmV2aW91c1N1bmRheSgpO3ZhciBzdGFydE9mTW9udGg9bmV3RGF0ZUF0TWlkbmlnaHQodGhpcy5nZXRGdWxsWWVhcigpLHRoaXMuZ2V0TW9udGgoKSwxKTt2YXIgbnVtYmVyT2ZTdW5kYXlzPXByZXZpb3VzU3VuZGF5LmlzQmVmb3JlKHN0YXJ0T2ZNb250aCk/MDoxK01hdGguZmxvb3IocHJldmlvdXNTdW5kYXkuZ2V0VGltZVNpbmNlKHN0YXJ0T2ZNb250aCkvT05FX1dFRUspO3ZhciBudW1iZXJPZkRheXNJbkZpcnN0V2Vlaz03LXN0YXJ0T2ZNb250aC5nZXREYXkoKTt2YXIgd2Vla0luTW9udGg9bnVtYmVyT2ZTdW5kYXlzO2lmKG51bWJlck9mRGF5c0luRmlyc3RXZWVrPj1taW5pbWFsRGF5c0luRmlyc3RXZWVrKXt3ZWVrSW5Nb250aCsrO31cclxucmV0dXJuIHdlZWtJbk1vbnRoO307RGF0ZS5wcm90b3R5cGUuZ2V0RGF5SW5ZZWFyPWZ1bmN0aW9uKCl7dmFyIHN0YXJ0T2ZZZWFyPW5ld0RhdGVBdE1pZG5pZ2h0KHRoaXMuZ2V0RnVsbFllYXIoKSwwLDEpO3JldHVybiAxK01hdGguZmxvb3IodGhpcy5nZXRUaW1lU2luY2Uoc3RhcnRPZlllYXIpL09ORV9EQVkpO307U2ltcGxlRGF0ZUZvcm1hdD1mdW5jdGlvbihmb3JtYXRTdHJpbmcpe3RoaXMuZm9ybWF0U3RyaW5nPWZvcm1hdFN0cmluZzt9O1NpbXBsZURhdGVGb3JtYXQucHJvdG90eXBlLnNldE1pbmltYWxEYXlzSW5GaXJzdFdlZWs9ZnVuY3Rpb24oZGF5cyl7dGhpcy5taW5pbWFsRGF5c0luRmlyc3RXZWVrPWRheXM7fTtTaW1wbGVEYXRlRm9ybWF0LnByb3RvdHlwZS5nZXRNaW5pbWFsRGF5c0luRmlyc3RXZWVrPWZ1bmN0aW9uKCl7cmV0dXJuIGlzVW5kZWZpbmVkKHRoaXMubWluaW1hbERheXNJbkZpcnN0V2Vlayk/REVGQVVMVF9NSU5JTUFMX0RBWVNfSU5fRklSU1RfV0VFSzp0aGlzLm1pbmltYWxEYXlzSW5GaXJzdFdlZWs7fTt2YXIgcGFkV2l0aFplcm9lcz1mdW5jdGlvbihzdHIsbGVuKXt3aGlsZShzdHIubGVuZ3RoPGxlbil7c3RyPVwiMFwiK3N0cjt9XHJcbnJldHVybiBzdHI7fTt2YXIgZm9ybWF0VGV4dD1mdW5jdGlvbihkYXRhLG51bWJlck9mTGV0dGVycyxtaW5MZW5ndGgpe3JldHVybihudW1iZXJPZkxldHRlcnM+PTQpP2RhdGE6ZGF0YS5zdWJzdHIoMCxNYXRoLm1heChtaW5MZW5ndGgsbnVtYmVyT2ZMZXR0ZXJzKSk7fTt2YXIgZm9ybWF0TnVtYmVyPWZ1bmN0aW9uKGRhdGEsbnVtYmVyT2ZMZXR0ZXJzKXt2YXIgZGF0YVN0cmluZz1cIlwiK2RhdGE7cmV0dXJuIHBhZFdpdGhaZXJvZXMoZGF0YVN0cmluZyxudW1iZXJPZkxldHRlcnMpO307U2ltcGxlRGF0ZUZvcm1hdC5wcm90b3R5cGUuZm9ybWF0PWZ1bmN0aW9uKGRhdGUpe3ZhciBmb3JtYXR0ZWRTdHJpbmc9XCJcIjt2YXIgcmVzdWx0O3ZhciBzZWFyY2hTdHJpbmc9dGhpcy5mb3JtYXRTdHJpbmc7d2hpbGUoKHJlc3VsdD1yZWdleC5leGVjKHNlYXJjaFN0cmluZykpKXt2YXIgcXVvdGVkU3RyaW5nPXJlc3VsdFsxXTt2YXIgcGF0dGVybkxldHRlcnM9cmVzdWx0WzJdO3ZhciBvdGhlckxldHRlcnM9cmVzdWx0WzNdO3ZhciBvdGhlckNoYXJhY3RlcnM9cmVzdWx0WzRdO2lmKHF1b3RlZFN0cmluZyl7aWYocXVvdGVkU3RyaW5nPT1cIicnXCIpe2Zvcm1hdHRlZFN0cmluZys9XCInXCI7fWVsc2V7Zm9ybWF0dGVkU3RyaW5nKz1xdW90ZWRTdHJpbmcuc3Vic3RyaW5nKDEscXVvdGVkU3RyaW5nLmxlbmd0aC0xKTt9fWVsc2UgaWYob3RoZXJMZXR0ZXJzKXt9ZWxzZSBpZihvdGhlckNoYXJhY3RlcnMpe2Zvcm1hdHRlZFN0cmluZys9b3RoZXJDaGFyYWN0ZXJzO31lbHNlIGlmKHBhdHRlcm5MZXR0ZXJzKXt2YXIgcGF0dGVybkxldHRlcj1wYXR0ZXJuTGV0dGVycy5jaGFyQXQoMCk7dmFyIG51bWJlck9mTGV0dGVycz1wYXR0ZXJuTGV0dGVycy5sZW5ndGg7dmFyIHJhd0RhdGE9XCJcIjtzd2l0Y2gocGF0dGVybkxldHRlcil7Y2FzZVwiR1wiOnJhd0RhdGE9XCJBRFwiO2JyZWFrO2Nhc2VcInlcIjpyYXdEYXRhPWRhdGUuZ2V0RnVsbFllYXIoKTticmVhaztjYXNlXCJNXCI6cmF3RGF0YT1kYXRlLmdldE1vbnRoKCk7YnJlYWs7Y2FzZVwid1wiOnJhd0RhdGE9ZGF0ZS5nZXRXZWVrSW5ZZWFyKHRoaXMuZ2V0TWluaW1hbERheXNJbkZpcnN0V2VlaygpKTticmVhaztjYXNlXCJXXCI6cmF3RGF0YT1kYXRlLmdldFdlZWtJbk1vbnRoKHRoaXMuZ2V0TWluaW1hbERheXNJbkZpcnN0V2VlaygpKTticmVhaztjYXNlXCJEXCI6cmF3RGF0YT1kYXRlLmdldERheUluWWVhcigpO2JyZWFrO2Nhc2VcImRcIjpyYXdEYXRhPWRhdGUuZ2V0RGF0ZSgpO2JyZWFrO2Nhc2VcIkZcIjpyYXdEYXRhPTErTWF0aC5mbG9vcigoZGF0ZS5nZXREYXRlKCktMSkvNyk7YnJlYWs7Y2FzZVwiRVwiOnJhd0RhdGE9ZGF5TmFtZXNbZGF0ZS5nZXREYXkoKV07YnJlYWs7Y2FzZVwiYVwiOnJhd0RhdGE9KGRhdGUuZ2V0SG91cnMoKT49MTIpP1wiUE1cIjpcIkFNXCI7YnJlYWs7Y2FzZVwiSFwiOnJhd0RhdGE9ZGF0ZS5nZXRIb3VycygpO2JyZWFrO2Nhc2VcImtcIjpyYXdEYXRhPWRhdGUuZ2V0SG91cnMoKXx8MjQ7YnJlYWs7Y2FzZVwiS1wiOnJhd0RhdGE9ZGF0ZS5nZXRIb3VycygpJTEyO2JyZWFrO2Nhc2VcImhcIjpyYXdEYXRhPShkYXRlLmdldEhvdXJzKCklMTIpfHwxMjticmVhaztjYXNlXCJtXCI6cmF3RGF0YT1kYXRlLmdldE1pbnV0ZXMoKTticmVhaztjYXNlXCJzXCI6cmF3RGF0YT1kYXRlLmdldFNlY29uZHMoKTticmVhaztjYXNlXCJTXCI6cmF3RGF0YT1kYXRlLmdldE1pbGxpc2Vjb25kcygpO2JyZWFrO2Nhc2VcIlpcIjpyYXdEYXRhPWRhdGUuZ2V0VGltZXpvbmVPZmZzZXQoKTticmVhazt9XHJcbnN3aXRjaCh0eXBlc1twYXR0ZXJuTGV0dGVyXSl7Y2FzZSBURVhUMjpmb3JtYXR0ZWRTdHJpbmcrPWZvcm1hdFRleHQocmF3RGF0YSxudW1iZXJPZkxldHRlcnMsMik7YnJlYWs7Y2FzZSBURVhUMzpmb3JtYXR0ZWRTdHJpbmcrPWZvcm1hdFRleHQocmF3RGF0YSxudW1iZXJPZkxldHRlcnMsMyk7YnJlYWs7Y2FzZSBOVU1CRVI6Zm9ybWF0dGVkU3RyaW5nKz1mb3JtYXROdW1iZXIocmF3RGF0YSxudW1iZXJPZkxldHRlcnMpO2JyZWFrO2Nhc2UgWUVBUjppZihudW1iZXJPZkxldHRlcnM8PTMpe3ZhciBkYXRhU3RyaW5nPVwiXCIrcmF3RGF0YTtmb3JtYXR0ZWRTdHJpbmcrPWRhdGFTdHJpbmcuc3Vic3RyKDIsMik7fWVsc2V7Zm9ybWF0dGVkU3RyaW5nKz1mb3JtYXROdW1iZXIocmF3RGF0YSxudW1iZXJPZkxldHRlcnMpO31cclxuYnJlYWs7Y2FzZSBNT05USDppZihudW1iZXJPZkxldHRlcnM+PTMpe2Zvcm1hdHRlZFN0cmluZys9Zm9ybWF0VGV4dChtb250aE5hbWVzW3Jhd0RhdGFdLG51bWJlck9mTGV0dGVycyxudW1iZXJPZkxldHRlcnMpO31lbHNle2Zvcm1hdHRlZFN0cmluZys9Zm9ybWF0TnVtYmVyKHJhd0RhdGErMSxudW1iZXJPZkxldHRlcnMpO31cclxuYnJlYWs7Y2FzZSBUSU1FWk9ORTp2YXIgaXNQb3NpdGl2ZT0ocmF3RGF0YT4wKTt2YXIgcHJlZml4PWlzUG9zaXRpdmU/XCItXCI6XCIrXCI7dmFyIGFic0RhdGE9TWF0aC5hYnMocmF3RGF0YSk7dmFyIGhvdXJzPVwiXCIrTWF0aC5mbG9vcihhYnNEYXRhLzYwKTtob3Vycz1wYWRXaXRoWmVyb2VzKGhvdXJzLDIpO3ZhciBtaW51dGVzPVwiXCIrKGFic0RhdGElNjApO21pbnV0ZXM9cGFkV2l0aFplcm9lcyhtaW51dGVzLDIpO2Zvcm1hdHRlZFN0cmluZys9cHJlZml4K2hvdXJzK21pbnV0ZXM7YnJlYWs7fX1cclxuc2VhcmNoU3RyaW5nPXNlYXJjaFN0cmluZy5zdWJzdHIocmVzdWx0LmluZGV4K3Jlc3VsdFswXS5sZW5ndGgpO31cclxucmV0dXJuIGZvcm1hdHRlZFN0cmluZzt9O30pKCk7bG9nNGphdmFzY3JpcHQuU2ltcGxlRGF0ZUZvcm1hdD1TaW1wbGVEYXRlRm9ybWF0O2Z1bmN0aW9uIFBhdHRlcm5MYXlvdXQocGF0dGVybil7aWYocGF0dGVybil7dGhpcy5wYXR0ZXJuPXBhdHRlcm47fWVsc2V7dGhpcy5wYXR0ZXJuPVBhdHRlcm5MYXlvdXQuREVGQVVMVF9DT05WRVJTSU9OX1BBVFRFUk47fVxyXG50aGlzLmN1c3RvbUZpZWxkcz1bXTt9XHJcblBhdHRlcm5MYXlvdXQuVFRDQ19DT05WRVJTSU9OX1BBVFRFUk49XCIlciAlcCAlYyAtICVtJW5cIjtQYXR0ZXJuTGF5b3V0LkRFRkFVTFRfQ09OVkVSU0lPTl9QQVRURVJOPVwiJW0lblwiO1BhdHRlcm5MYXlvdXQuSVNPODYwMV9EQVRFRk9STUFUPVwieXl5eS1NTS1kZCBISDptbTpzcyxTU1NcIjtQYXR0ZXJuTGF5b3V0LkRBVEVUSU1FX0RBVEVGT1JNQVQ9XCJkZCBNTU0geXl5eSBISDptbTpzcyxTU1NcIjtQYXR0ZXJuTGF5b3V0LkFCU09MVVRFVElNRV9EQVRFRk9STUFUPVwiSEg6bW06c3MsU1NTXCI7UGF0dGVybkxheW91dC5wcm90b3R5cGU9bmV3IExheW91dCgpO1BhdHRlcm5MYXlvdXQucHJvdG90eXBlLmZvcm1hdD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciByZWdleD0vJSgtP1swLTldKyk/KFxcLj9bMC05XSspPyhbYWNkZm1NbnByJV0pKFxceyhbXlxcfV0rKVxcfSk/fChbXiVdKykvO3ZhciBmb3JtYXR0ZWRTdHJpbmc9XCJcIjt2YXIgcmVzdWx0O3ZhciBzZWFyY2hTdHJpbmc9dGhpcy5wYXR0ZXJuO3doaWxlKChyZXN1bHQ9cmVnZXguZXhlYyhzZWFyY2hTdHJpbmcpKSl7dmFyIG1hdGNoZWRTdHJpbmc9cmVzdWx0WzBdO3ZhciBwYWRkaW5nPXJlc3VsdFsxXTt2YXIgdHJ1bmNhdGlvbj1yZXN1bHRbMl07dmFyIGNvbnZlcnNpb25DaGFyYWN0ZXI9cmVzdWx0WzNdO3ZhciBzcGVjaWZpZXI9cmVzdWx0WzVdO3ZhciB0ZXh0PXJlc3VsdFs2XTtpZih0ZXh0KXtmb3JtYXR0ZWRTdHJpbmcrPVwiXCIrdGV4dDt9ZWxzZXt2YXIgcmVwbGFjZW1lbnQ9XCJcIjtzd2l0Y2goY29udmVyc2lvbkNoYXJhY3Rlcil7Y2FzZVwiYVwiOmNhc2VcIm1cIjp2YXIgZGVwdGg9MDtpZihzcGVjaWZpZXIpe2RlcHRoPXBhcnNlSW50KHNwZWNpZmllciwxMCk7aWYoaXNOYU4oZGVwdGgpKXtoYW5kbGVFcnJvcihcIlBhdHRlcm5MYXlvdXQuZm9ybWF0OiBpbnZhbGlkIHNwZWNpZmllciAnXCIrXHJcbnNwZWNpZmllcitcIicgZm9yIGNvbnZlcnNpb24gY2hhcmFjdGVyICdcIitjb252ZXJzaW9uQ2hhcmFjdGVyK1wiJyAtIHNob3VsZCBiZSBhIG51bWJlclwiKTtkZXB0aD0wO319XHJcbnZhciBtZXNzYWdlcz0oY29udmVyc2lvbkNoYXJhY3Rlcj09PVwiYVwiKT9sb2dnaW5nRXZlbnQubWVzc2FnZXNbMF06bG9nZ2luZ0V2ZW50Lm1lc3NhZ2VzO2Zvcih2YXIgaT0wLGxlbj1tZXNzYWdlcy5sZW5ndGg7aTxsZW47aSsrKXtpZihpPjAmJihyZXBsYWNlbWVudC5jaGFyQXQocmVwbGFjZW1lbnQubGVuZ3RoLTEpIT09XCIgXCIpKXtyZXBsYWNlbWVudCs9XCIgXCI7fVxyXG5pZihkZXB0aD09PTApe3JlcGxhY2VtZW50Kz1tZXNzYWdlc1tpXTt9ZWxzZXtyZXBsYWNlbWVudCs9Zm9ybWF0T2JqZWN0RXhwYW5zaW9uKG1lc3NhZ2VzW2ldLGRlcHRoKTt9fVxyXG5icmVhaztjYXNlXCJjXCI6dmFyIGxvZ2dlck5hbWU9bG9nZ2luZ0V2ZW50LmxvZ2dlci5uYW1lO2lmKHNwZWNpZmllcil7dmFyIHByZWNpc2lvbj1wYXJzZUludChzcGVjaWZpZXIsMTApO3ZhciBsb2dnZXJOYW1lQml0cz1sb2dnaW5nRXZlbnQubG9nZ2VyLm5hbWUuc3BsaXQoXCIuXCIpO2lmKHByZWNpc2lvbj49bG9nZ2VyTmFtZUJpdHMubGVuZ3RoKXtyZXBsYWNlbWVudD1sb2dnZXJOYW1lO31lbHNle3JlcGxhY2VtZW50PWxvZ2dlck5hbWVCaXRzLnNsaWNlKGxvZ2dlck5hbWVCaXRzLmxlbmd0aC1wcmVjaXNpb24pLmpvaW4oXCIuXCIpO319ZWxzZXtyZXBsYWNlbWVudD1sb2dnZXJOYW1lO31cclxuYnJlYWs7Y2FzZVwiZFwiOnZhciBkYXRlRm9ybWF0PVBhdHRlcm5MYXlvdXQuSVNPODYwMV9EQVRFRk9STUFUO2lmKHNwZWNpZmllcil7ZGF0ZUZvcm1hdD1zcGVjaWZpZXI7aWYoZGF0ZUZvcm1hdD09XCJJU084NjAxXCIpe2RhdGVGb3JtYXQ9UGF0dGVybkxheW91dC5JU084NjAxX0RBVEVGT1JNQVQ7fWVsc2UgaWYoZGF0ZUZvcm1hdD09XCJBQlNPTFVURVwiKXtkYXRlRm9ybWF0PVBhdHRlcm5MYXlvdXQuQUJTT0xVVEVUSU1FX0RBVEVGT1JNQVQ7fWVsc2UgaWYoZGF0ZUZvcm1hdD09XCJEQVRFXCIpe2RhdGVGb3JtYXQ9UGF0dGVybkxheW91dC5EQVRFVElNRV9EQVRFRk9STUFUO319XHJcbnJlcGxhY2VtZW50PShuZXcgU2ltcGxlRGF0ZUZvcm1hdChkYXRlRm9ybWF0KSkuZm9ybWF0KGxvZ2dpbmdFdmVudC50aW1lU3RhbXApO2JyZWFrO2Nhc2VcImZcIjppZih0aGlzLmhhc0N1c3RvbUZpZWxkcygpKXt2YXIgZmllbGRJbmRleD0wO2lmKHNwZWNpZmllcil7ZmllbGRJbmRleD1wYXJzZUludChzcGVjaWZpZXIsMTApO2lmKGlzTmFOKGZpZWxkSW5kZXgpKXtoYW5kbGVFcnJvcihcIlBhdHRlcm5MYXlvdXQuZm9ybWF0OiBpbnZhbGlkIHNwZWNpZmllciAnXCIrXHJcbnNwZWNpZmllcitcIicgZm9yIGNvbnZlcnNpb24gY2hhcmFjdGVyICdmJyAtIHNob3VsZCBiZSBhIG51bWJlclwiKTt9ZWxzZSBpZihmaWVsZEluZGV4PT09MCl7aGFuZGxlRXJyb3IoXCJQYXR0ZXJuTGF5b3V0LmZvcm1hdDogaW52YWxpZCBzcGVjaWZpZXIgJ1wiK1xyXG5zcGVjaWZpZXIrXCInIGZvciBjb252ZXJzaW9uIGNoYXJhY3RlciAnZicgLSBtdXN0IGJlIGdyZWF0ZXIgdGhhbiB6ZXJvXCIpO31lbHNlIGlmKGZpZWxkSW5kZXg+dGhpcy5jdXN0b21GaWVsZHMubGVuZ3RoKXtoYW5kbGVFcnJvcihcIlBhdHRlcm5MYXlvdXQuZm9ybWF0OiBpbnZhbGlkIHNwZWNpZmllciAnXCIrXHJcbnNwZWNpZmllcitcIicgZm9yIGNvbnZlcnNpb24gY2hhcmFjdGVyICdmJyAtIHRoZXJlIGFyZW4ndCB0aGF0IG1hbnkgY3VzdG9tIGZpZWxkc1wiKTt9ZWxzZXtmaWVsZEluZGV4PWZpZWxkSW5kZXgtMTt9fVxyXG52YXIgdmFsPXRoaXMuY3VzdG9tRmllbGRzW2ZpZWxkSW5kZXhdLnZhbHVlO2lmKHR5cGVvZiB2YWw9PVwiZnVuY3Rpb25cIil7dmFsPXZhbCh0aGlzLGxvZ2dpbmdFdmVudCk7fVxyXG5yZXBsYWNlbWVudD12YWw7fVxyXG5icmVhaztjYXNlXCJuXCI6cmVwbGFjZW1lbnQ9bmV3TGluZTticmVhaztjYXNlXCJwXCI6cmVwbGFjZW1lbnQ9bG9nZ2luZ0V2ZW50LmxldmVsLm5hbWU7YnJlYWs7Y2FzZVwiclwiOnJlcGxhY2VtZW50PVwiXCIrbG9nZ2luZ0V2ZW50LnRpbWVTdGFtcC5nZXREaWZmZXJlbmNlKGFwcGxpY2F0aW9uU3RhcnREYXRlKTticmVhaztjYXNlXCIlXCI6cmVwbGFjZW1lbnQ9XCIlXCI7YnJlYWs7ZGVmYXVsdDpyZXBsYWNlbWVudD1tYXRjaGVkU3RyaW5nO2JyZWFrO31cclxudmFyIGw7aWYodHJ1bmNhdGlvbil7bD1wYXJzZUludCh0cnVuY2F0aW9uLnN1YnN0cigxKSwxMCk7dmFyIHN0ckxlbj1yZXBsYWNlbWVudC5sZW5ndGg7aWYobDxzdHJMZW4pe3JlcGxhY2VtZW50PXJlcGxhY2VtZW50LnN1YnN0cmluZyhzdHJMZW4tbCxzdHJMZW4pO319XHJcbmlmKHBhZGRpbmcpe2lmKHBhZGRpbmcuY2hhckF0KDApPT1cIi1cIil7bD1wYXJzZUludChwYWRkaW5nLnN1YnN0cigxKSwxMCk7d2hpbGUocmVwbGFjZW1lbnQubGVuZ3RoPGwpe3JlcGxhY2VtZW50Kz1cIiBcIjt9fWVsc2V7bD1wYXJzZUludChwYWRkaW5nLDEwKTt3aGlsZShyZXBsYWNlbWVudC5sZW5ndGg8bCl7cmVwbGFjZW1lbnQ9XCIgXCIrcmVwbGFjZW1lbnQ7fX19XHJcbmZvcm1hdHRlZFN0cmluZys9cmVwbGFjZW1lbnQ7fVxyXG5zZWFyY2hTdHJpbmc9c2VhcmNoU3RyaW5nLnN1YnN0cihyZXN1bHQuaW5kZXgrcmVzdWx0WzBdLmxlbmd0aCk7fVxyXG5yZXR1cm4gZm9ybWF0dGVkU3RyaW5nO307UGF0dGVybkxheW91dC5wcm90b3R5cGUuaWdub3Jlc1Rocm93YWJsZT1mdW5jdGlvbigpe3JldHVybiB0cnVlO307UGF0dGVybkxheW91dC5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIlBhdHRlcm5MYXlvdXRcIjt9O2xvZzRqYXZhc2NyaXB0LlBhdHRlcm5MYXlvdXQ9UGF0dGVybkxheW91dDtmdW5jdGlvbiBBbGVydEFwcGVuZGVyKCl7fVxyXG5BbGVydEFwcGVuZGVyLnByb3RvdHlwZT1uZXcgQXBwZW5kZXIoKTtBbGVydEFwcGVuZGVyLnByb3RvdHlwZS5sYXlvdXQ9bmV3IFNpbXBsZUxheW91dCgpO0FsZXJ0QXBwZW5kZXIucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe2FsZXJ0KHRoaXMuZ2V0TGF5b3V0KCkuZm9ybWF0V2l0aEV4Y2VwdGlvbihsb2dnaW5nRXZlbnQpKTt9O0FsZXJ0QXBwZW5kZXIucHJvdG90eXBlLnRvU3RyaW5nPWZ1bmN0aW9uKCl7cmV0dXJuXCJBbGVydEFwcGVuZGVyXCI7fTtsb2c0amF2YXNjcmlwdC5BbGVydEFwcGVuZGVyPUFsZXJ0QXBwZW5kZXI7ZnVuY3Rpb24gQnJvd3NlckNvbnNvbGVBcHBlbmRlcigpe31cclxuQnJvd3NlckNvbnNvbGVBcHBlbmRlci5wcm90b3R5cGU9bmV3IGxvZzRqYXZhc2NyaXB0LkFwcGVuZGVyKCk7QnJvd3NlckNvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUubGF5b3V0PW5ldyBOdWxsTGF5b3V0KCk7QnJvd3NlckNvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUudGhyZXNob2xkPUxldmVsLkRFQlVHO0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe3ZhciBhcHBlbmRlcj10aGlzO3ZhciBnZXRGb3JtYXR0ZWRNZXNzYWdlPWZ1bmN0aW9uKGNvbmNhdGVuYXRlKXt2YXIgZm9ybWF0dGVkTWVzc2FnZT1hcHBlbmRlci5nZXRMYXlvdXQoKS5mb3JtYXRXaXRoRXhjZXB0aW9uKGxvZ2dpbmdFdmVudCk7cmV0dXJuKHR5cGVvZiBmb3JtYXR0ZWRNZXNzYWdlPT1cInN0cmluZ1wiKT8oY29uY2F0ZW5hdGU/Zm9ybWF0dGVkTWVzc2FnZTpbZm9ybWF0dGVkTWVzc2FnZV0pOihjb25jYXRlbmF0ZT9mb3JtYXR0ZWRNZXNzYWdlLmpvaW4oXCIgXCIpOmZvcm1hdHRlZE1lc3NhZ2UpO307dmFyIGNvbnNvbGU9d2luZG93LmNvbnNvbGU7aWYoY29uc29sZSYmY29uc29sZS5sb2cpe3ZhciBjb25zb2xlTWV0aG9kTmFtZTtpZihjb25zb2xlLmRlYnVnJiZMZXZlbC5ERUJVRy5pc0dyZWF0ZXJPckVxdWFsKGxvZ2dpbmdFdmVudC5sZXZlbCkpe2NvbnNvbGVNZXRob2ROYW1lPVwiZGVidWdcIjt9ZWxzZSBpZihjb25zb2xlLmluZm8mJkxldmVsLklORk8uZXF1YWxzKGxvZ2dpbmdFdmVudC5sZXZlbCkpe2NvbnNvbGVNZXRob2ROYW1lPVwiaW5mb1wiO31lbHNlIGlmKGNvbnNvbGUud2FybiYmTGV2ZWwuV0FSTi5lcXVhbHMobG9nZ2luZ0V2ZW50LmxldmVsKSl7Y29uc29sZU1ldGhvZE5hbWU9XCJ3YXJuXCI7fWVsc2UgaWYoY29uc29sZS5lcnJvciYmbG9nZ2luZ0V2ZW50LmxldmVsLmlzR3JlYXRlck9yRXF1YWwoTGV2ZWwuRVJST1IpKXtjb25zb2xlTWV0aG9kTmFtZT1cImVycm9yXCI7fWVsc2V7Y29uc29sZU1ldGhvZE5hbWU9XCJsb2dcIjt9XHJcbmlmKHR5cGVvZiBjb25zb2xlW2NvbnNvbGVNZXRob2ROYW1lXS5hcHBseT09XCJmdW5jdGlvblwiKXtjb25zb2xlW2NvbnNvbGVNZXRob2ROYW1lXS5hcHBseShjb25zb2xlLGdldEZvcm1hdHRlZE1lc3NhZ2UoZmFsc2UpKTt9ZWxzZXtjb25zb2xlW2NvbnNvbGVNZXRob2ROYW1lXShnZXRGb3JtYXR0ZWRNZXNzYWdlKHRydWUpKTt9fWVsc2UgaWYoKHR5cGVvZiBvcGVyYSE9XCJ1bmRlZmluZWRcIikmJm9wZXJhLnBvc3RFcnJvcil7b3BlcmEucG9zdEVycm9yKGdldEZvcm1hdHRlZE1lc3NhZ2UodHJ1ZSkpO319O0Jyb3dzZXJDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlLmdyb3VwPWZ1bmN0aW9uKG5hbWUpe2lmKHdpbmRvdy5jb25zb2xlJiZ3aW5kb3cuY29uc29sZS5ncm91cCl7d2luZG93LmNvbnNvbGUuZ3JvdXAobmFtZSk7fX07QnJvd3NlckNvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUuZ3JvdXBFbmQ9ZnVuY3Rpb24oKXtpZih3aW5kb3cuY29uc29sZSYmd2luZG93LmNvbnNvbGUuZ3JvdXBFbmQpe3dpbmRvdy5jb25zb2xlLmdyb3VwRW5kKCk7fX07QnJvd3NlckNvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkJyb3dzZXJDb25zb2xlQXBwZW5kZXJcIjt9O2xvZzRqYXZhc2NyaXB0LkJyb3dzZXJDb25zb2xlQXBwZW5kZXI9QnJvd3NlckNvbnNvbGVBcHBlbmRlcjt2YXIgeGhyRmFjdG9yeT1mdW5jdGlvbigpe3JldHVybiBuZXcgWE1MSHR0cFJlcXVlc3QoKTt9O3ZhciB4bWxIdHRwRmFjdG9yaWVzPVt4aHJGYWN0b3J5LGZ1bmN0aW9uKCl7cmV0dXJuIG5ldyBBY3RpdmVYT2JqZWN0KFwiTXN4bWwyLlhNTEhUVFBcIik7fSxmdW5jdGlvbigpe3JldHVybiBuZXcgQWN0aXZlWE9iamVjdChcIk1pY3Jvc29mdC5YTUxIVFRQXCIpO31dO3ZhciB3aXRoQ3JlZGVudGlhbHNTdXBwb3J0ZWQ9ZmFsc2U7dmFyIGdldFhtbEh0dHA9ZnVuY3Rpb24oZXJyb3JIYW5kbGVyKXt2YXIgeG1sSHR0cD1udWxsLGZhY3Rvcnk7Zm9yKHZhciBpPTAsbGVuPXhtbEh0dHBGYWN0b3JpZXMubGVuZ3RoO2k8bGVuO2krKyl7ZmFjdG9yeT14bWxIdHRwRmFjdG9yaWVzW2ldO3RyeXt4bWxIdHRwPWZhY3RvcnkoKTt3aXRoQ3JlZGVudGlhbHNTdXBwb3J0ZWQ9KGZhY3Rvcnk9PXhockZhY3RvcnkmJihcIndpdGhDcmVkZW50aWFsc1wiaW4geG1sSHR0cCkpO2dldFhtbEh0dHA9ZmFjdG9yeTtyZXR1cm4geG1sSHR0cDt9Y2F0Y2goZSl7fX1cclxuaWYoZXJyb3JIYW5kbGVyKXtlcnJvckhhbmRsZXIoKTt9ZWxzZXtoYW5kbGVFcnJvcihcImdldFhtbEh0dHA6IHVuYWJsZSB0byBvYnRhaW4gWE1MSHR0cFJlcXVlc3Qgb2JqZWN0XCIpO319O2Z1bmN0aW9uIGlzSHR0cFJlcXVlc3RTdWNjZXNzZnVsKHhtbEh0dHApe3JldHVybiBpc1VuZGVmaW5lZCh4bWxIdHRwLnN0YXR1cyl8fHhtbEh0dHAuc3RhdHVzPT09MHx8KHhtbEh0dHAuc3RhdHVzPj0yMDAmJnhtbEh0dHAuc3RhdHVzPDMwMCl8fHhtbEh0dHAuc3RhdHVzPT0xMjIzO31cclxuZnVuY3Rpb24gQWpheEFwcGVuZGVyKHVybCx3aXRoQ3JlZGVudGlhbHMpe3ZhciBhcHBlbmRlcj10aGlzO3ZhciBpc1N1cHBvcnRlZD10cnVlO2lmKCF1cmwpe2hhbmRsZUVycm9yKFwiQWpheEFwcGVuZGVyOiBVUkwgbXVzdCBiZSBzcGVjaWZpZWQgaW4gY29uc3RydWN0b3JcIik7aXNTdXBwb3J0ZWQ9ZmFsc2U7fVxyXG52YXIgdGltZWQ9dGhpcy5kZWZhdWx0cy50aW1lZDt2YXIgd2FpdEZvclJlc3BvbnNlPXRoaXMuZGVmYXVsdHMud2FpdEZvclJlc3BvbnNlO3ZhciBiYXRjaFNpemU9dGhpcy5kZWZhdWx0cy5iYXRjaFNpemU7dmFyIHRpbWVySW50ZXJ2YWw9dGhpcy5kZWZhdWx0cy50aW1lckludGVydmFsO3ZhciByZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrPXRoaXMuZGVmYXVsdHMucmVxdWVzdFN1Y2Nlc3NDYWxsYmFjazt2YXIgZmFpbENhbGxiYWNrPXRoaXMuZGVmYXVsdHMuZmFpbENhbGxiYWNrO3ZhciBwb3N0VmFyTmFtZT10aGlzLmRlZmF1bHRzLnBvc3RWYXJOYW1lO3ZhciBzZW5kQWxsT25VbmxvYWQ9dGhpcy5kZWZhdWx0cy5zZW5kQWxsT25VbmxvYWQ7dmFyIGNvbnRlbnRUeXBlPXRoaXMuZGVmYXVsdHMuY29udGVudFR5cGU7dmFyIHNlc3Npb25JZD1udWxsO3ZhciBxdWV1ZWRMb2dnaW5nRXZlbnRzPVtdO3ZhciBxdWV1ZWRSZXF1ZXN0cz1bXTt2YXIgaGVhZGVycz1bXTt2YXIgc2VuZGluZz1mYWxzZTt2YXIgaW5pdGlhbGl6ZWQ9ZmFsc2U7ZnVuY3Rpb24gY2hlY2tDYW5Db25maWd1cmUoY29uZmlnT3B0aW9uTmFtZSl7aWYoaW5pdGlhbGl6ZWQpe2hhbmRsZUVycm9yKFwiQWpheEFwcGVuZGVyOiBjb25maWd1cmF0aW9uIG9wdGlvbiAnXCIrXHJcbmNvbmZpZ09wdGlvbk5hbWUrXCInIG1heSBub3QgYmUgc2V0IGFmdGVyIHRoZSBhcHBlbmRlciBoYXMgYmVlbiBpbml0aWFsaXplZFwiKTtyZXR1cm4gZmFsc2U7fVxyXG5yZXR1cm4gdHJ1ZTt9XHJcbnRoaXMuZ2V0U2Vzc2lvbklkPWZ1bmN0aW9uKCl7cmV0dXJuIHNlc3Npb25JZDt9O3RoaXMuc2V0U2Vzc2lvbklkPWZ1bmN0aW9uKHNlc3Npb25JZFBhcmFtKXtzZXNzaW9uSWQ9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShzZXNzaW9uSWRQYXJhbSxudWxsKTt0aGlzLmxheW91dC5zZXRDdXN0b21GaWVsZChcInNlc3Npb25pZFwiLHNlc3Npb25JZCk7fTt0aGlzLnNldExheW91dD1mdW5jdGlvbihsYXlvdXRQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJsYXlvdXRcIikpe3RoaXMubGF5b3V0PWxheW91dFBhcmFtO2lmKHNlc3Npb25JZCE9PW51bGwpe3RoaXMuc2V0U2Vzc2lvbklkKHNlc3Npb25JZCk7fX19O3RoaXMuaXNUaW1lZD1mdW5jdGlvbigpe3JldHVybiB0aW1lZDt9O3RoaXMuc2V0VGltZWQ9ZnVuY3Rpb24odGltZWRQYXJhbSl7aWYoY2hlY2tDYW5Db25maWd1cmUoXCJ0aW1lZFwiKSl7dGltZWQ9Ym9vbCh0aW1lZFBhcmFtKTt9fTt0aGlzLmdldFRpbWVySW50ZXJ2YWw9ZnVuY3Rpb24oKXtyZXR1cm4gdGltZXJJbnRlcnZhbDt9O3RoaXMuc2V0VGltZXJJbnRlcnZhbD1mdW5jdGlvbih0aW1lckludGVydmFsUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwidGltZXJJbnRlcnZhbFwiKSl7dGltZXJJbnRlcnZhbD1leHRyYWN0SW50RnJvbVBhcmFtKHRpbWVySW50ZXJ2YWxQYXJhbSx0aW1lckludGVydmFsKTt9fTt0aGlzLmlzV2FpdEZvclJlc3BvbnNlPWZ1bmN0aW9uKCl7cmV0dXJuIHdhaXRGb3JSZXNwb25zZTt9O3RoaXMuc2V0V2FpdEZvclJlc3BvbnNlPWZ1bmN0aW9uKHdhaXRGb3JSZXNwb25zZVBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcIndhaXRGb3JSZXNwb25zZVwiKSl7d2FpdEZvclJlc3BvbnNlPWJvb2wod2FpdEZvclJlc3BvbnNlUGFyYW0pO319O3RoaXMuZ2V0QmF0Y2hTaXplPWZ1bmN0aW9uKCl7cmV0dXJuIGJhdGNoU2l6ZTt9O3RoaXMuc2V0QmF0Y2hTaXplPWZ1bmN0aW9uKGJhdGNoU2l6ZVBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcImJhdGNoU2l6ZVwiKSl7YmF0Y2hTaXplPWV4dHJhY3RJbnRGcm9tUGFyYW0oYmF0Y2hTaXplUGFyYW0sYmF0Y2hTaXplKTt9fTt0aGlzLmlzU2VuZEFsbE9uVW5sb2FkPWZ1bmN0aW9uKCl7cmV0dXJuIHNlbmRBbGxPblVubG9hZDt9O3RoaXMuc2V0U2VuZEFsbE9uVW5sb2FkPWZ1bmN0aW9uKHNlbmRBbGxPblVubG9hZFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcInNlbmRBbGxPblVubG9hZFwiKSl7c2VuZEFsbE9uVW5sb2FkPWV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKHNlbmRBbGxPblVubG9hZFBhcmFtLHNlbmRBbGxPblVubG9hZCk7fX07dGhpcy5zZXRSZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrPWZ1bmN0aW9uKHJlcXVlc3RTdWNjZXNzQ2FsbGJhY2tQYXJhbSl7cmVxdWVzdFN1Y2Nlc3NDYWxsYmFjaz1leHRyYWN0RnVuY3Rpb25Gcm9tUGFyYW0ocmVxdWVzdFN1Y2Nlc3NDYWxsYmFja1BhcmFtLHJlcXVlc3RTdWNjZXNzQ2FsbGJhY2spO307dGhpcy5zZXRGYWlsQ2FsbGJhY2s9ZnVuY3Rpb24oZmFpbENhbGxiYWNrUGFyYW0pe2ZhaWxDYWxsYmFjaz1leHRyYWN0RnVuY3Rpb25Gcm9tUGFyYW0oZmFpbENhbGxiYWNrUGFyYW0sZmFpbENhbGxiYWNrKTt9O3RoaXMuZ2V0UG9zdFZhck5hbWU9ZnVuY3Rpb24oKXtyZXR1cm4gcG9zdFZhck5hbWU7fTt0aGlzLnNldFBvc3RWYXJOYW1lPWZ1bmN0aW9uKHBvc3RWYXJOYW1lUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwicG9zdFZhck5hbWVcIikpe3Bvc3RWYXJOYW1lPWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0ocG9zdFZhck5hbWVQYXJhbSxwb3N0VmFyTmFtZSk7fX07dGhpcy5nZXRIZWFkZXJzPWZ1bmN0aW9uKCl7cmV0dXJuIGhlYWRlcnM7fTt0aGlzLmFkZEhlYWRlcj1mdW5jdGlvbihuYW1lLHZhbHVlKXtpZihuYW1lLnRvTG93ZXJDYXNlKCk9PVwiY29udGVudC10eXBlXCIpe2NvbnRlbnRUeXBlPXZhbHVlO31lbHNle2hlYWRlcnMucHVzaCh7bmFtZTpuYW1lLHZhbHVlOnZhbHVlfSk7fX07ZnVuY3Rpb24gc2VuZEFsbCgpe2lmKGlzU3VwcG9ydGVkJiZlbmFibGVkKXtzZW5kaW5nPXRydWU7dmFyIGN1cnJlbnRSZXF1ZXN0QmF0Y2g7aWYod2FpdEZvclJlc3BvbnNlKXtpZihxdWV1ZWRSZXF1ZXN0cy5sZW5ndGg+MCl7Y3VycmVudFJlcXVlc3RCYXRjaD1xdWV1ZWRSZXF1ZXN0cy5zaGlmdCgpO3NlbmRSZXF1ZXN0KHByZXBhcmVQb3N0RGF0YShjdXJyZW50UmVxdWVzdEJhdGNoKSxzZW5kQWxsKTt9ZWxzZXtzZW5kaW5nPWZhbHNlO2lmKHRpbWVkKXtzY2hlZHVsZVNlbmRpbmcoKTt9fX1lbHNle3doaWxlKChjdXJyZW50UmVxdWVzdEJhdGNoPXF1ZXVlZFJlcXVlc3RzLnNoaWZ0KCkpKXtzZW5kUmVxdWVzdChwcmVwYXJlUG9zdERhdGEoY3VycmVudFJlcXVlc3RCYXRjaCkpO31cclxuc2VuZGluZz1mYWxzZTtpZih0aW1lZCl7c2NoZWR1bGVTZW5kaW5nKCk7fX19fVxyXG50aGlzLnNlbmRBbGw9c2VuZEFsbDtmdW5jdGlvbiBzZW5kQWxsUmVtYWluaW5nKCl7dmFyIHNlbmRpbmdBbnl0aGluZz1mYWxzZTtpZihpc1N1cHBvcnRlZCYmZW5hYmxlZCl7dmFyIGFjdHVhbEJhdGNoU2l6ZT1hcHBlbmRlci5nZXRMYXlvdXQoKS5hbGxvd0JhdGNoaW5nKCk/YmF0Y2hTaXplOjE7dmFyIGN1cnJlbnRMb2dnaW5nRXZlbnQ7dmFyIGJhdGNoZWRMb2dnaW5nRXZlbnRzPVtdO3doaWxlKChjdXJyZW50TG9nZ2luZ0V2ZW50PXF1ZXVlZExvZ2dpbmdFdmVudHMuc2hpZnQoKSkpe2JhdGNoZWRMb2dnaW5nRXZlbnRzLnB1c2goY3VycmVudExvZ2dpbmdFdmVudCk7aWYocXVldWVkTG9nZ2luZ0V2ZW50cy5sZW5ndGg+PWFjdHVhbEJhdGNoU2l6ZSl7cXVldWVkUmVxdWVzdHMucHVzaChiYXRjaGVkTG9nZ2luZ0V2ZW50cyk7YmF0Y2hlZExvZ2dpbmdFdmVudHM9W107fX1cclxuaWYoYmF0Y2hlZExvZ2dpbmdFdmVudHMubGVuZ3RoPjApe3F1ZXVlZFJlcXVlc3RzLnB1c2goYmF0Y2hlZExvZ2dpbmdFdmVudHMpO31cclxuc2VuZGluZ0FueXRoaW5nPShxdWV1ZWRSZXF1ZXN0cy5sZW5ndGg+MCk7d2FpdEZvclJlc3BvbnNlPWZhbHNlO3RpbWVkPWZhbHNlO3NlbmRBbGwoKTt9XHJcbnJldHVybiBzZW5kaW5nQW55dGhpbmc7fVxyXG50aGlzLnNlbmRBbGxSZW1haW5pbmc9c2VuZEFsbFJlbWFpbmluZztmdW5jdGlvbiBwcmVwYXJlUG9zdERhdGEoYmF0Y2hlZExvZ2dpbmdFdmVudHMpe3ZhciBmb3JtYXR0ZWRNZXNzYWdlcz1bXTt2YXIgY3VycmVudExvZ2dpbmdFdmVudDt2YXIgcG9zdERhdGE9XCJcIjt3aGlsZSgoY3VycmVudExvZ2dpbmdFdmVudD1iYXRjaGVkTG9nZ2luZ0V2ZW50cy5zaGlmdCgpKSl7Zm9ybWF0dGVkTWVzc2FnZXMucHVzaChhcHBlbmRlci5nZXRMYXlvdXQoKS5mb3JtYXRXaXRoRXhjZXB0aW9uKGN1cnJlbnRMb2dnaW5nRXZlbnQpKTt9XHJcbmlmKGJhdGNoZWRMb2dnaW5nRXZlbnRzLmxlbmd0aD09MSl7cG9zdERhdGE9Zm9ybWF0dGVkTWVzc2FnZXMuam9pbihcIlwiKTt9ZWxzZXtwb3N0RGF0YT1hcHBlbmRlci5nZXRMYXlvdXQoKS5iYXRjaEhlYWRlcitcclxuZm9ybWF0dGVkTWVzc2FnZXMuam9pbihhcHBlbmRlci5nZXRMYXlvdXQoKS5iYXRjaFNlcGFyYXRvcikrXHJcbmFwcGVuZGVyLmdldExheW91dCgpLmJhdGNoRm9vdGVyO31cclxuaWYoY29udGVudFR5cGU9PWFwcGVuZGVyLmRlZmF1bHRzLmNvbnRlbnRUeXBlKXtwb3N0RGF0YT1hcHBlbmRlci5nZXRMYXlvdXQoKS5yZXR1cm5zUG9zdERhdGE/cG9zdERhdGE6dXJsRW5jb2RlKHBvc3RWYXJOYW1lKStcIj1cIit1cmxFbmNvZGUocG9zdERhdGEpO2lmKHBvc3REYXRhLmxlbmd0aD4wKXtwb3N0RGF0YSs9XCImXCI7fVxyXG5wb3N0RGF0YSs9XCJsYXlvdXQ9XCIrdXJsRW5jb2RlKGFwcGVuZGVyLmdldExheW91dCgpLnRvU3RyaW5nKCkpO31cclxucmV0dXJuIHBvc3REYXRhO31cclxuZnVuY3Rpb24gc2NoZWR1bGVTZW5kaW5nKCl7d2luZG93LnNldFRpbWVvdXQoc2VuZEFsbCx0aW1lckludGVydmFsKTt9XHJcbmZ1bmN0aW9uIHhtbEh0dHBFcnJvckhhbmRsZXIoKXt2YXIgbXNnPVwiQWpheEFwcGVuZGVyOiBjb3VsZCBub3QgY3JlYXRlIFhNTEh0dHBSZXF1ZXN0IG9iamVjdC4gQWpheEFwcGVuZGVyIGRpc2FibGVkXCI7aGFuZGxlRXJyb3IobXNnKTtpc1N1cHBvcnRlZD1mYWxzZTtpZihmYWlsQ2FsbGJhY2spe2ZhaWxDYWxsYmFjayhtc2cpO319XHJcbmZ1bmN0aW9uIHNlbmRSZXF1ZXN0KHBvc3REYXRhLHN1Y2Nlc3NDYWxsYmFjayl7dHJ5e3ZhciB4bWxIdHRwPWdldFhtbEh0dHAoeG1sSHR0cEVycm9ySGFuZGxlcik7aWYoaXNTdXBwb3J0ZWQpe3htbEh0dHAub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYoeG1sSHR0cC5yZWFkeVN0YXRlPT00KXtpZihpc0h0dHBSZXF1ZXN0U3VjY2Vzc2Z1bCh4bWxIdHRwKSl7aWYocmVxdWVzdFN1Y2Nlc3NDYWxsYmFjayl7cmVxdWVzdFN1Y2Nlc3NDYWxsYmFjayh4bWxIdHRwKTt9XHJcbmlmKHN1Y2Nlc3NDYWxsYmFjayl7c3VjY2Vzc0NhbGxiYWNrKHhtbEh0dHApO319ZWxzZXt2YXIgbXNnPVwiQWpheEFwcGVuZGVyLmFwcGVuZDogWE1MSHR0cFJlcXVlc3QgcmVxdWVzdCB0byBVUkwgXCIrXHJcbnVybCtcIiByZXR1cm5lZCBzdGF0dXMgY29kZSBcIit4bWxIdHRwLnN0YXR1cztoYW5kbGVFcnJvcihtc2cpO2lmKGZhaWxDYWxsYmFjayl7ZmFpbENhbGxiYWNrKG1zZyk7fX1cclxueG1sSHR0cC5vbnJlYWR5c3RhdGVjaGFuZ2U9ZW1wdHlGdW5jdGlvbjt4bWxIdHRwPW51bGw7fX07eG1sSHR0cC5vcGVuKFwiUE9TVFwiLHVybCx0cnVlKTtpZih3aXRoQ3JlZGVudGlhbHMmJndpdGhDcmVkZW50aWFsc1N1cHBvcnRlZCl7eG1sSHR0cC53aXRoQ3JlZGVudGlhbHM9dHJ1ZTt9XHJcbnRyeXtmb3IodmFyIGk9MCxoZWFkZXI7aGVhZGVyPWhlYWRlcnNbaSsrXTspe3htbEh0dHAuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXIubmFtZSxoZWFkZXIudmFsdWUpO31cclxueG1sSHR0cC5zZXRSZXF1ZXN0SGVhZGVyKFwiQ29udGVudC1UeXBlXCIsY29udGVudFR5cGUpO31jYXRjaChoZWFkZXJFeCl7dmFyIG1zZz1cIkFqYXhBcHBlbmRlci5hcHBlbmQ6IHlvdXIgYnJvd3NlcidzIFhNTEh0dHBSZXF1ZXN0IGltcGxlbWVudGF0aW9uXCIrXCIgZG9lcyBub3Qgc3VwcG9ydCBzZXRSZXF1ZXN0SGVhZGVyLCB0aGVyZWZvcmUgY2Fubm90IHBvc3QgZGF0YS4gQWpheEFwcGVuZGVyIGRpc2FibGVkXCI7aGFuZGxlRXJyb3IobXNnKTtpc1N1cHBvcnRlZD1mYWxzZTtpZihmYWlsQ2FsbGJhY2spe2ZhaWxDYWxsYmFjayhtc2cpO31cclxucmV0dXJuO31cclxueG1sSHR0cC5zZW5kKHBvc3REYXRhKTt9fWNhdGNoKGV4KXt2YXIgZXJyTXNnPVwiQWpheEFwcGVuZGVyLmFwcGVuZDogZXJyb3Igc2VuZGluZyBsb2cgbWVzc2FnZSB0byBcIit1cmw7aGFuZGxlRXJyb3IoZXJyTXNnLGV4KTtpc1N1cHBvcnRlZD1mYWxzZTtpZihmYWlsQ2FsbGJhY2spe2ZhaWxDYWxsYmFjayhlcnJNc2crXCIuIERldGFpbHM6IFwiK2dldEV4Y2VwdGlvblN0cmluZ1JlcChleCkpO319fVxyXG50aGlzLmFwcGVuZD1mdW5jdGlvbihsb2dnaW5nRXZlbnQpe2lmKGlzU3VwcG9ydGVkKXtpZighaW5pdGlhbGl6ZWQpe2luaXQoKTt9XHJcbnF1ZXVlZExvZ2dpbmdFdmVudHMucHVzaChsb2dnaW5nRXZlbnQpO3ZhciBhY3R1YWxCYXRjaFNpemU9dGhpcy5nZXRMYXlvdXQoKS5hbGxvd0JhdGNoaW5nKCk/YmF0Y2hTaXplOjE7aWYocXVldWVkTG9nZ2luZ0V2ZW50cy5sZW5ndGg+PWFjdHVhbEJhdGNoU2l6ZSl7dmFyIGN1cnJlbnRMb2dnaW5nRXZlbnQ7dmFyIGJhdGNoZWRMb2dnaW5nRXZlbnRzPVtdO3doaWxlKChjdXJyZW50TG9nZ2luZ0V2ZW50PXF1ZXVlZExvZ2dpbmdFdmVudHMuc2hpZnQoKSkpe2JhdGNoZWRMb2dnaW5nRXZlbnRzLnB1c2goY3VycmVudExvZ2dpbmdFdmVudCk7fVxyXG5xdWV1ZWRSZXF1ZXN0cy5wdXNoKGJhdGNoZWRMb2dnaW5nRXZlbnRzKTtpZighdGltZWQmJighd2FpdEZvclJlc3BvbnNlfHwod2FpdEZvclJlc3BvbnNlJiYhc2VuZGluZykpKXtzZW5kQWxsKCk7fX19fTtmdW5jdGlvbiBpbml0KCl7aW5pdGlhbGl6ZWQ9dHJ1ZTtpZihzZW5kQWxsT25VbmxvYWQpe3ZhciBvbGRCZWZvcmVVbmxvYWQ9d2luZG93Lm9uYmVmb3JldW5sb2FkO3dpbmRvdy5vbmJlZm9yZXVubG9hZD1mdW5jdGlvbigpe2lmKG9sZEJlZm9yZVVubG9hZCl7b2xkQmVmb3JlVW5sb2FkKCk7fVxyXG5zZW5kQWxsUmVtYWluaW5nKCk7fTt9XHJcbmlmKHRpbWVkKXtzY2hlZHVsZVNlbmRpbmcoKTt9fX1cclxuQWpheEFwcGVuZGVyLnByb3RvdHlwZT1uZXcgQXBwZW5kZXIoKTtBamF4QXBwZW5kZXIucHJvdG90eXBlLmRlZmF1bHRzPXt3YWl0Rm9yUmVzcG9uc2U6ZmFsc2UsdGltZWQ6ZmFsc2UsdGltZXJJbnRlcnZhbDoxMDAwLGJhdGNoU2l6ZToxLHNlbmRBbGxPblVubG9hZDpmYWxzZSxyZXF1ZXN0U3VjY2Vzc0NhbGxiYWNrOm51bGwsZmFpbENhbGxiYWNrOm51bGwscG9zdFZhck5hbWU6XCJkYXRhXCIsY29udGVudFR5cGU6XCJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWRcIn07QWpheEFwcGVuZGVyLnByb3RvdHlwZS5sYXlvdXQ9bmV3IEh0dHBQb3N0RGF0YUxheW91dCgpO0FqYXhBcHBlbmRlci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkFqYXhBcHBlbmRlclwiO307bG9nNGphdmFzY3JpcHQuQWpheEFwcGVuZGVyPUFqYXhBcHBlbmRlcjtmdW5jdGlvbiBzZXRDb29raWUobmFtZSx2YWx1ZSxkYXlzLHBhdGgpe3ZhciBleHBpcmVzO3BhdGg9cGF0aD9cIjsgcGF0aD1cIitwYXRoOlwiXCI7aWYoZGF5cyl7dmFyIGRhdGU9bmV3IERhdGUoKTtkYXRlLnNldFRpbWUoZGF0ZS5nZXRUaW1lKCkrKGRheXMqMjQqNjAqNjAqMTAwMCkpO2V4cGlyZXM9XCI7IGV4cGlyZXM9XCIrZGF0ZS50b0dNVFN0cmluZygpO31lbHNle2V4cGlyZXM9XCJcIjt9XHJcbmRvY3VtZW50LmNvb2tpZT1lc2NhcGUobmFtZSkrXCI9XCIrZXNjYXBlKHZhbHVlKStleHBpcmVzK3BhdGg7fVxyXG5mdW5jdGlvbiBnZXRDb29raWUobmFtZSl7dmFyIG5hbWVFcXVhbHM9ZXNjYXBlKG5hbWUpK1wiPVwiO3ZhciBjYT1kb2N1bWVudC5jb29raWUuc3BsaXQoXCI7XCIpO2Zvcih2YXIgaT0wLGxlbj1jYS5sZW5ndGg7aTxsZW47aSsrKXt2YXIgYz1jYVtpXTt3aGlsZShjLmNoYXJBdCgwKT09PVwiIFwiKXtjPWMuc3Vic3RyaW5nKDEsYy5sZW5ndGgpO31cclxuaWYoYy5pbmRleE9mKG5hbWVFcXVhbHMpPT09MCl7cmV0dXJuIHVuZXNjYXBlKGMuc3Vic3RyaW5nKG5hbWVFcXVhbHMubGVuZ3RoLGMubGVuZ3RoKSk7fX1cclxucmV0dXJuIG51bGw7fVxyXG5mdW5jdGlvbiBnZXRCYXNlVXJsKCl7dmFyIHNjcmlwdHM9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJzY3JpcHRcIik7Zm9yKHZhciBpPTAsbGVuPXNjcmlwdHMubGVuZ3RoO2k8bGVuOysraSl7aWYoc2NyaXB0c1tpXS5zcmMuaW5kZXhPZihcImxvZzRqYXZhc2NyaXB0XCIpIT0tMSl7dmFyIGxhc3RTbGFzaD1zY3JpcHRzW2ldLnNyYy5sYXN0SW5kZXhPZihcIi9cIik7cmV0dXJuKGxhc3RTbGFzaD09LTEpP1wiXCI6c2NyaXB0c1tpXS5zcmMuc3Vic3RyKDAsbGFzdFNsYXNoKzEpO319XHJcbnJldHVybiBudWxsO31cclxuZnVuY3Rpb24gaXNMb2FkZWQod2luKXt0cnl7cmV0dXJuIGJvb2wod2luLmxvYWRlZCk7fWNhdGNoKGV4KXtyZXR1cm4gZmFsc2U7fX1cclxudmFyIENvbnNvbGVBcHBlbmRlcjsoZnVuY3Rpb24oKXt2YXIgZ2V0Q29uc29sZUh0bWxMaW5lcz1mdW5jdGlvbigpe3JldHVyblsnPCFET0NUWVBFIGh0bWwgUFVCTElDIFwiLS8vVzNDLy9EVEQgWEhUTUwgMS4wIFN0cmljdC8vRU5cIiBcImh0dHA6Ly93d3cudzMub3JnL1RSL3hodG1sMS9EVEQveGh0bWwxLXN0cmljdC5kdGRcIj4nLCc8aHRtbCB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIiBsYW5nPVwiZW5cIiB4bWw6bGFuZz1cImVuXCI+JywnPGhlYWQ+JywnPHRpdGxlPmxvZzRqYXZhc2NyaXB0PC90aXRsZT4nLCc8bWV0YSBodHRwLWVxdWl2PVwiQ29udGVudC1UeXBlXCIgY29udGVudD1cInRleHQvaHRtbDsgY2hhcnNldD11dGYtOFwiIC8+JywnPCEtLSBNYWtlIElFOCBiZWhhdmUgbGlrZSBJRTcsIGhhdmluZyBnb25lIHRvIGFsbCB0aGUgdHJvdWJsZSBvZiBtYWtpbmcgSUUgd29yayAtLT4nLCc8bWV0YSBodHRwLWVxdWl2PVwiWC1VQS1Db21wYXRpYmxlXCIgY29udGVudD1cIklFPTdcIiAvPicsJzxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPnZhciBpc0llID0gZmFsc2UsIGlzSWVQcmU3ID0gZmFsc2U7PC9zY3JpcHQ+JywnPCEtLVtpZiBJRV0+PHNjcmlwdCB0eXBlPVwidGV4dC9qYXZhc2NyaXB0XCI+aXNJZSA9IHRydWU8L3NjcmlwdD48IVtlbmRpZl0tLT4nLCc8IS0tW2lmIGx0IElFIDddPjxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPmlzSWVQcmU3ID0gdHJ1ZTwvc2NyaXB0PjwhW2VuZGlmXS0tPicsJzxzY3JpcHQgdHlwZT1cInRleHQvamF2YXNjcmlwdFwiPicsJy8vPCFbQ0RBVEFbJywndmFyIGxvZ2dpbmdFbmFibGVkPXRydWU7dmFyIGxvZ1F1ZXVlZEV2ZW50c1RpbWVyPW51bGw7dmFyIGxvZ0VudHJpZXM9W107dmFyIGxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzPVtdO3ZhciBsb2dJdGVtcz1bXTt2YXIgcmVuZGVyRGVsYXk9MTAwO3ZhciB1bnJlbmRlcmVkTG9nSXRlbXNFeGlzdD1mYWxzZTt2YXIgcm9vdEdyb3VwLGN1cnJlbnRHcm91cD1udWxsO3ZhciBsb2FkZWQ9ZmFsc2U7dmFyIGN1cnJlbnRMb2dJdGVtPW51bGw7dmFyIGxvZ01haW5Db250YWluZXI7ZnVuY3Rpb24gY29weVByb3BlcnRpZXMob2JqLHByb3BzKXtmb3IodmFyIGkgaW4gcHJvcHMpe29ialtpXT1wcm9wc1tpXTt9fScsJ2Z1bmN0aW9uIExvZ0l0ZW0oKXt9JywnTG9nSXRlbS5wcm90b3R5cGU9e21haW5Db250YWluZXI6bnVsbCx3cmFwcGVkQ29udGFpbmVyOm51bGwsdW53cmFwcGVkQ29udGFpbmVyOm51bGwsZ3JvdXA6bnVsbCxhcHBlbmRUb0xvZzpmdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0uYXBwZW5kVG9Mb2coKTt9JywndGhpcy5ncm91cC51cGRhdGUoKTt9LGRvUmVtb3ZlOmZ1bmN0aW9uKGRvVXBkYXRlLHJlbW92ZUZyb21Hcm91cCl7aWYodGhpcy5yZW5kZXJlZCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5yZW1vdmUoKTt9JywndGhpcy51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW51bGw7dGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1udWxsO3RoaXMubWFpbkVsZW1lbnRDb250YWluZXI9bnVsbDt9JywnaWYodGhpcy5ncm91cCYmcmVtb3ZlRnJvbUdyb3VwKXt0aGlzLmdyb3VwLnJlbW92ZUNoaWxkKHRoaXMsZG9VcGRhdGUpO30nLCdpZih0aGlzPT09Y3VycmVudExvZ0l0ZW0pe2N1cnJlbnRMb2dJdGVtPW51bGw7fX0scmVtb3ZlOmZ1bmN0aW9uKGRvVXBkYXRlLHJlbW92ZUZyb21Hcm91cCl7dGhpcy5kb1JlbW92ZShkb1VwZGF0ZSxyZW1vdmVGcm9tR3JvdXApO30scmVuZGVyOmZ1bmN0aW9uKCl7fSxhY2NlcHQ6ZnVuY3Rpb24odmlzaXRvcil7dmlzaXRvci52aXNpdCh0aGlzKTt9LGdldFVud3JhcHBlZERvbUNvbnRhaW5lcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdyb3VwLnVud3JhcHBlZEVsZW1lbnRDb250YWluZXIuY29udGVudERpdjt9LGdldFdyYXBwZWREb21Db250YWluZXI6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5ncm91cC53cmFwcGVkRWxlbWVudENvbnRhaW5lci5jb250ZW50RGl2O30sZ2V0TWFpbkRvbUNvbnRhaW5lcjpmdW5jdGlvbigpe3JldHVybiB0aGlzLmdyb3VwLm1haW5FbGVtZW50Q29udGFpbmVyLmNvbnRlbnREaXY7fX07TG9nSXRlbS5zZXJpYWxpemVkSXRlbUtleXM9e0xPR19FTlRSWTowLEdST1VQX1NUQVJUOjEsR1JPVVBfRU5EOjJ9O2Z1bmN0aW9uIExvZ0l0ZW1Db250YWluZXJFbGVtZW50KCl7fScsJ0xvZ0l0ZW1Db250YWluZXJFbGVtZW50LnByb3RvdHlwZT17YXBwZW5kVG9Mb2c6ZnVuY3Rpb24oKXt2YXIgaW5zZXJ0QmVmb3JlRmlyc3Q9KG5ld2VzdEF0VG9wJiZ0aGlzLmNvbnRhaW5lckRvbU5vZGUuaGFzQ2hpbGROb2RlcygpKTtpZihpbnNlcnRCZWZvcmVGaXJzdCl7dGhpcy5jb250YWluZXJEb21Ob2RlLmluc2VydEJlZm9yZSh0aGlzLm1haW5EaXYsdGhpcy5jb250YWluZXJEb21Ob2RlLmZpcnN0Q2hpbGQpO31lbHNle3RoaXMuY29udGFpbmVyRG9tTm9kZS5hcHBlbmRDaGlsZCh0aGlzLm1haW5EaXYpO319fTtmdW5jdGlvbiBTZXBhcmF0b3JFbGVtZW50Q29udGFpbmVyKGNvbnRhaW5lckRvbU5vZGUpe3RoaXMuY29udGFpbmVyRG9tTm9kZT1jb250YWluZXJEb21Ob2RlO3RoaXMubWFpbkRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubWFpbkRpdi5jbGFzc05hbWU9XCJzZXBhcmF0b3JcIjt0aGlzLm1haW5EaXYuaW5uZXJIVE1MPVwiJm5ic3A7XCI7fScsJ1NlcGFyYXRvckVsZW1lbnRDb250YWluZXIucHJvdG90eXBlPW5ldyBMb2dJdGVtQ29udGFpbmVyRWxlbWVudCgpO1NlcGFyYXRvckVsZW1lbnRDb250YWluZXIucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMubWFpbkRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMubWFpbkRpdik7dGhpcy5tYWluRGl2PW51bGw7fTtmdW5jdGlvbiBTZXBhcmF0b3IoKXt0aGlzLnJlbmRlcmVkPWZhbHNlO30nLCdTZXBhcmF0b3IucHJvdG90eXBlPW5ldyBMb2dJdGVtKCk7Y29weVByb3BlcnRpZXMoU2VwYXJhdG9yLnByb3RvdHlwZSx7cmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGNvbnRhaW5lckRvbU5vZGU9dGhpcy5ncm91cC5jb250ZW50RGl2O2lmKGlzSWUpe3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcj1uZXcgU2VwYXJhdG9yRWxlbWVudENvbnRhaW5lcih0aGlzLmdldFVud3JhcHBlZERvbUNvbnRhaW5lcigpKTt0aGlzLndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW5ldyBTZXBhcmF0b3JFbGVtZW50Q29udGFpbmVyKHRoaXMuZ2V0V3JhcHBlZERvbUNvbnRhaW5lcigpKTt0aGlzLmVsZW1lbnRDb250YWluZXJzPVt0aGlzLnVud3JhcHBlZEVsZW1lbnRDb250YWluZXIsdGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lcl07fWVsc2V7dGhpcy5tYWluRWxlbWVudENvbnRhaW5lcj1uZXcgU2VwYXJhdG9yRWxlbWVudENvbnRhaW5lcih0aGlzLmdldE1haW5Eb21Db250YWluZXIoKSk7dGhpcy5lbGVtZW50Q29udGFpbmVycz1bdGhpcy5tYWluRWxlbWVudENvbnRhaW5lcl07fScsJ3RoaXMuY29udGVudD10aGlzLmZvcm1hdHRlZE1lc3NhZ2U7dGhpcy5yZW5kZXJlZD10cnVlO319KTtmdW5jdGlvbiBHcm91cEVsZW1lbnRDb250YWluZXIoZ3JvdXAsY29udGFpbmVyRG9tTm9kZSxpc1Jvb3QsaXNXcmFwcGVkKXt0aGlzLmdyb3VwPWdyb3VwO3RoaXMuY29udGFpbmVyRG9tTm9kZT1jb250YWluZXJEb21Ob2RlO3RoaXMuaXNSb290PWlzUm9vdDt0aGlzLmlzV3JhcHBlZD1pc1dyYXBwZWQ7dGhpcy5leHBhbmRhYmxlPWZhbHNlO2lmKHRoaXMuaXNSb290KXtpZihpc0llKXt0aGlzLmNvbnRlbnREaXY9bG9nTWFpbkNvbnRhaW5lci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTt0aGlzLmNvbnRlbnREaXYuaWQ9dGhpcy5pc1dyYXBwZWQ/XCJsb2dfd3JhcHBlZFwiOlwibG9nX3Vud3JhcHBlZFwiO31lbHNle3RoaXMuY29udGVudERpdj1sb2dNYWluQ29udGFpbmVyO319ZWxzZXt2YXIgZ3JvdXBFbGVtZW50Q29udGFpbmVyPXRoaXM7dGhpcy5tYWluRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5tYWluRGl2LmNsYXNzTmFtZT1cImdyb3VwXCI7dGhpcy5oZWFkaW5nRGl2PXRoaXMubWFpbkRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKTt0aGlzLmhlYWRpbmdEaXYuY2xhc3NOYW1lPVwiZ3JvdXBoZWFkaW5nXCI7dGhpcy5leHBhbmRlcj10aGlzLmhlYWRpbmdEaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIikpO3RoaXMuZXhwYW5kZXIuY2xhc3NOYW1lPVwiZXhwYW5kZXIgdW5zZWxlY3RhYmxlIGdyZXllZG91dFwiO3RoaXMuZXhwYW5kZXIudW5zZWxlY3RhYmxlPXRydWU7dmFyIGV4cGFuZGVyVGV4dD10aGlzLmdyb3VwLmV4cGFuZGVkP1wiLVwiOlwiK1wiO3RoaXMuZXhwYW5kZXJUZXh0Tm9kZT10aGlzLmV4cGFuZGVyLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGV4cGFuZGVyVGV4dCkpO3RoaXMuaGVhZGluZ0Rpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIiBcIit0aGlzLmdyb3VwLm5hbWUpKTt0aGlzLmNvbnRlbnREaXY9dGhpcy5tYWluRGl2LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO3ZhciBjb250ZW50Q3NzQ2xhc3M9dGhpcy5ncm91cC5leHBhbmRlZD9cImV4cGFuZGVkXCI6XCJjb2xsYXBzZWRcIjt0aGlzLmNvbnRlbnREaXYuY2xhc3NOYW1lPVwiZ3JvdXBjb250ZW50IFwiK2NvbnRlbnRDc3NDbGFzczt0aGlzLmV4cGFuZGVyLm9uY2xpY2s9ZnVuY3Rpb24oKXtpZihncm91cEVsZW1lbnRDb250YWluZXIuZ3JvdXAuZXhwYW5kYWJsZSl7Z3JvdXBFbGVtZW50Q29udGFpbmVyLmdyb3VwLnRvZ2dsZUV4cGFuZGVkKCk7fX07fX0nLCdHcm91cEVsZW1lbnRDb250YWluZXIucHJvdG90eXBlPW5ldyBMb2dJdGVtQ29udGFpbmVyRWxlbWVudCgpO2NvcHlQcm9wZXJ0aWVzKEdyb3VwRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUse3RvZ2dsZUV4cGFuZGVkOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNSb290KXt2YXIgb2xkQ3NzQ2xhc3MsbmV3Q3NzQ2xhc3MsZXhwYW5kZXJUZXh0O2lmKHRoaXMuZ3JvdXAuZXhwYW5kZWQpe25ld0Nzc0NsYXNzPVwiZXhwYW5kZWRcIjtvbGRDc3NDbGFzcz1cImNvbGxhcHNlZFwiO2V4cGFuZGVyVGV4dD1cIi1cIjt9ZWxzZXtuZXdDc3NDbGFzcz1cImNvbGxhcHNlZFwiO29sZENzc0NsYXNzPVwiZXhwYW5kZWRcIjtleHBhbmRlclRleHQ9XCIrXCI7fScsJ3JlcGxhY2VDbGFzcyh0aGlzLmNvbnRlbnREaXYsbmV3Q3NzQ2xhc3Msb2xkQ3NzQ2xhc3MpO3RoaXMuZXhwYW5kZXJUZXh0Tm9kZS5ub2RlVmFsdWU9ZXhwYW5kZXJUZXh0O319LHJlbW92ZTpmdW5jdGlvbigpe2lmKCF0aGlzLmlzUm9vdCl7dGhpcy5oZWFkaW5nRGl2PW51bGw7dGhpcy5leHBhbmRlci5vbmNsaWNrPW51bGw7dGhpcy5leHBhbmRlcj1udWxsO3RoaXMuZXhwYW5kZXJUZXh0Tm9kZT1udWxsO3RoaXMuY29udGVudERpdj1udWxsO3RoaXMuY29udGFpbmVyRG9tTm9kZT1udWxsO3RoaXMubWFpbkRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHRoaXMubWFpbkRpdik7dGhpcy5tYWluRGl2PW51bGw7fX0scmV2ZXJzZUNoaWxkcmVuOmZ1bmN0aW9uKCl7dmFyIG5vZGU9bnVsbDt2YXIgY2hpbGREb21Ob2Rlcz1bXTt3aGlsZSgobm9kZT10aGlzLmNvbnRlbnREaXYuZmlyc3RDaGlsZCkpe3RoaXMuY29udGVudERpdi5yZW1vdmVDaGlsZChub2RlKTtjaGlsZERvbU5vZGVzLnB1c2gobm9kZSk7fScsJ3doaWxlKChub2RlPWNoaWxkRG9tTm9kZXMucG9wKCkpKXt0aGlzLmNvbnRlbnREaXYuYXBwZW5kQ2hpbGQobm9kZSk7fX0sdXBkYXRlOmZ1bmN0aW9uKCl7aWYoIXRoaXMuaXNSb290KXtpZih0aGlzLmdyb3VwLmV4cGFuZGFibGUpe3JlbW92ZUNsYXNzKHRoaXMuZXhwYW5kZXIsXCJncmV5ZWRvdXRcIik7fWVsc2V7YWRkQ2xhc3ModGhpcy5leHBhbmRlcixcImdyZXllZG91dFwiKTt9fX0sY2xlYXI6ZnVuY3Rpb24oKXtpZih0aGlzLmlzUm9vdCl7dGhpcy5jb250ZW50RGl2LmlubmVySFRNTD1cIlwiO319fSk7ZnVuY3Rpb24gR3JvdXAobmFtZSxpc1Jvb3QsaW5pdGlhbGx5RXhwYW5kZWQpe3RoaXMubmFtZT1uYW1lO3RoaXMuZ3JvdXA9bnVsbDt0aGlzLmlzUm9vdD1pc1Jvb3Q7dGhpcy5pbml0aWFsbHlFeHBhbmRlZD1pbml0aWFsbHlFeHBhbmRlZDt0aGlzLmVsZW1lbnRDb250YWluZXJzPVtdO3RoaXMuY2hpbGRyZW49W107dGhpcy5leHBhbmRlZD1pbml0aWFsbHlFeHBhbmRlZDt0aGlzLnJlbmRlcmVkPWZhbHNlO3RoaXMuZXhwYW5kYWJsZT1mYWxzZTt9JywnR3JvdXAucHJvdG90eXBlPW5ldyBMb2dJdGVtKCk7Y29weVByb3BlcnRpZXMoR3JvdXAucHJvdG90eXBlLHthZGRDaGlsZDpmdW5jdGlvbihsb2dJdGVtKXt0aGlzLmNoaWxkcmVuLnB1c2gobG9nSXRlbSk7bG9nSXRlbS5ncm91cD10aGlzO30scmVuZGVyOmZ1bmN0aW9uKCl7aWYoaXNJZSl7dmFyIHVud3JhcHBlZERvbUNvbnRhaW5lcix3cmFwcGVkRG9tQ29udGFpbmVyO2lmKHRoaXMuaXNSb290KXt1bndyYXBwZWREb21Db250YWluZXI9bG9nTWFpbkNvbnRhaW5lcjt3cmFwcGVkRG9tQ29udGFpbmVyPWxvZ01haW5Db250YWluZXI7fWVsc2V7dW53cmFwcGVkRG9tQ29udGFpbmVyPXRoaXMuZ2V0VW53cmFwcGVkRG9tQ29udGFpbmVyKCk7d3JhcHBlZERvbUNvbnRhaW5lcj10aGlzLmdldFdyYXBwZWREb21Db250YWluZXIoKTt9JywndGhpcy51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW5ldyBHcm91cEVsZW1lbnRDb250YWluZXIodGhpcyx1bndyYXBwZWREb21Db250YWluZXIsdGhpcy5pc1Jvb3QsZmFsc2UpO3RoaXMud3JhcHBlZEVsZW1lbnRDb250YWluZXI9bmV3IEdyb3VwRWxlbWVudENvbnRhaW5lcih0aGlzLHdyYXBwZWREb21Db250YWluZXIsdGhpcy5pc1Jvb3QsdHJ1ZSk7dGhpcy5lbGVtZW50Q29udGFpbmVycz1bdGhpcy51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyLHRoaXMud3JhcHBlZEVsZW1lbnRDb250YWluZXJdO31lbHNle3ZhciBtYWluRG9tQ29udGFpbmVyPXRoaXMuaXNSb290P2xvZ01haW5Db250YWluZXI6dGhpcy5nZXRNYWluRG9tQ29udGFpbmVyKCk7dGhpcy5tYWluRWxlbWVudENvbnRhaW5lcj1uZXcgR3JvdXBFbGVtZW50Q29udGFpbmVyKHRoaXMsbWFpbkRvbUNvbnRhaW5lcix0aGlzLmlzUm9vdCxmYWxzZSk7dGhpcy5lbGVtZW50Q29udGFpbmVycz1bdGhpcy5tYWluRWxlbWVudENvbnRhaW5lcl07fScsJ3RoaXMucmVuZGVyZWQ9dHJ1ZTt9LHRvZ2dsZUV4cGFuZGVkOmZ1bmN0aW9uKCl7dGhpcy5leHBhbmRlZD0hdGhpcy5leHBhbmRlZDtmb3IodmFyIGk9MCxsZW49dGhpcy5lbGVtZW50Q29udGFpbmVycy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmVsZW1lbnRDb250YWluZXJzW2ldLnRvZ2dsZUV4cGFuZGVkKCk7fX0sZXhwYW5kOmZ1bmN0aW9uKCl7aWYoIXRoaXMuZXhwYW5kZWQpe3RoaXMudG9nZ2xlRXhwYW5kZWQoKTt9fSxhY2NlcHQ6ZnVuY3Rpb24odmlzaXRvcil7dmlzaXRvci52aXNpdEdyb3VwKHRoaXMpO30scmV2ZXJzZUNoaWxkcmVuOmZ1bmN0aW9uKCl7aWYodGhpcy5yZW5kZXJlZCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5yZXZlcnNlQ2hpbGRyZW4oKTt9fX0sdXBkYXRlOmZ1bmN0aW9uKCl7dmFyIHByZXZpb3VzbHlFeHBhbmRhYmxlPXRoaXMuZXhwYW5kYWJsZTt0aGlzLmV4cGFuZGFibGU9KHRoaXMuY2hpbGRyZW4ubGVuZ3RoIT09MCk7aWYodGhpcy5leHBhbmRhYmxlIT09cHJldmlvdXNseUV4cGFuZGFibGUpe2Zvcih2YXIgaT0wLGxlbj10aGlzLmVsZW1lbnRDb250YWluZXJzLmxlbmd0aDtpPGxlbjtpKyspe3RoaXMuZWxlbWVudENvbnRhaW5lcnNbaV0udXBkYXRlKCk7fX19LGZsYXR0ZW46ZnVuY3Rpb24oKXt2YXIgdmlzaXRvcj1uZXcgR3JvdXBGbGF0dGVuZXIoKTt0aGlzLmFjY2VwdCh2aXNpdG9yKTtyZXR1cm4gdmlzaXRvci5sb2dFbnRyaWVzQW5kU2VwYXJhdG9yczt9LHJlbW92ZUNoaWxkOmZ1bmN0aW9uKGNoaWxkLGRvVXBkYXRlKXthcnJheV9yZW1vdmUodGhpcy5jaGlsZHJlbixjaGlsZCk7Y2hpbGQuZ3JvdXA9bnVsbDtpZihkb1VwZGF0ZSl7dGhpcy51cGRhdGUoKTt9fSxyZW1vdmU6ZnVuY3Rpb24oZG9VcGRhdGUscmVtb3ZlRnJvbUdyb3VwKXtmb3IodmFyIGk9MCxsZW49dGhpcy5jaGlsZHJlbi5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmNoaWxkcmVuW2ldLnJlbW92ZShmYWxzZSxmYWxzZSk7fScsJ3RoaXMuY2hpbGRyZW49W107dGhpcy51cGRhdGUoKTtpZih0aGlzPT09Y3VycmVudEdyb3VwKXtjdXJyZW50R3JvdXA9dGhpcy5ncm91cDt9JywndGhpcy5kb1JlbW92ZShkb1VwZGF0ZSxyZW1vdmVGcm9tR3JvdXApO30sc2VyaWFsaXplOmZ1bmN0aW9uKGl0ZW1zKXtpdGVtcy5wdXNoKFtMb2dJdGVtLnNlcmlhbGl6ZWRJdGVtS2V5cy5HUk9VUF9TVEFSVCx0aGlzLm5hbWVdKTtmb3IodmFyIGk9MCxsZW49dGhpcy5jaGlsZHJlbi5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmNoaWxkcmVuW2ldLnNlcmlhbGl6ZShpdGVtcyk7fScsJ2lmKHRoaXMhPT1jdXJyZW50R3JvdXApe2l0ZW1zLnB1c2goW0xvZ0l0ZW0uc2VyaWFsaXplZEl0ZW1LZXlzLkdST1VQX0VORF0pO319LGNsZWFyOmZ1bmN0aW9uKCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5jbGVhcigpO319fSk7ZnVuY3Rpb24gTG9nRW50cnlFbGVtZW50Q29udGFpbmVyKCl7fScsJ0xvZ0VudHJ5RWxlbWVudENvbnRhaW5lci5wcm90b3R5cGU9bmV3IExvZ0l0ZW1Db250YWluZXJFbGVtZW50KCk7Y29weVByb3BlcnRpZXMoTG9nRW50cnlFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZSx7cmVtb3ZlOmZ1bmN0aW9uKCl7dGhpcy5kb1JlbW92ZSgpO30sZG9SZW1vdmU6ZnVuY3Rpb24oKXt0aGlzLm1haW5EaXYucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0aGlzLm1haW5EaXYpO3RoaXMubWFpbkRpdj1udWxsO3RoaXMuY29udGVudEVsZW1lbnQ9bnVsbDt0aGlzLmNvbnRhaW5lckRvbU5vZGU9bnVsbDt9LHNldENvbnRlbnQ6ZnVuY3Rpb24oY29udGVudCx3cmFwcGVkQ29udGVudCl7aWYoY29udGVudD09PXRoaXMuZm9ybWF0dGVkTWVzc2FnZSl7dGhpcy5jb250ZW50RWxlbWVudC5pbm5lckhUTUw9XCJcIjt0aGlzLmNvbnRlbnRFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHRoaXMuZm9ybWF0dGVkTWVzc2FnZSkpO31lbHNle3RoaXMuY29udGVudEVsZW1lbnQuaW5uZXJIVE1MPWNvbnRlbnQ7fX0sc2V0U2VhcmNoTWF0Y2g6ZnVuY3Rpb24oaXNNYXRjaCl7dmFyIG9sZENzc0NsYXNzPWlzTWF0Y2g/XCJzZWFyY2hub25tYXRjaFwiOlwic2VhcmNobWF0Y2hcIjt2YXIgbmV3Q3NzQ2xhc3M9aXNNYXRjaD9cInNlYXJjaG1hdGNoXCI6XCJzZWFyY2hub25tYXRjaFwiO3JlcGxhY2VDbGFzcyh0aGlzLm1haW5EaXYsbmV3Q3NzQ2xhc3Msb2xkQ3NzQ2xhc3MpO30sY2xlYXJTZWFyY2g6ZnVuY3Rpb24oKXtyZW1vdmVDbGFzcyh0aGlzLm1haW5EaXYsXCJzZWFyY2htYXRjaFwiKTtyZW1vdmVDbGFzcyh0aGlzLm1haW5EaXYsXCJzZWFyY2hub25tYXRjaFwiKTt9fSk7ZnVuY3Rpb24gTG9nRW50cnlXcmFwcGVkRWxlbWVudENvbnRhaW5lcihsb2dFbnRyeSxjb250YWluZXJEb21Ob2RlKXt0aGlzLmxvZ0VudHJ5PWxvZ0VudHJ5O3RoaXMuY29udGFpbmVyRG9tTm9kZT1jb250YWluZXJEb21Ob2RlO3RoaXMubWFpbkRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubWFpbkRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2UpKTt0aGlzLm1haW5EaXYuY2xhc3NOYW1lPVwibG9nZW50cnkgd3JhcHBlZCBcIit0aGlzLmxvZ0VudHJ5LmxldmVsO3RoaXMuY29udGVudEVsZW1lbnQ9dGhpcy5tYWluRGl2O30nLCdMb2dFbnRyeVdyYXBwZWRFbGVtZW50Q29udGFpbmVyLnByb3RvdHlwZT1uZXcgTG9nRW50cnlFbGVtZW50Q29udGFpbmVyKCk7TG9nRW50cnlXcmFwcGVkRWxlbWVudENvbnRhaW5lci5wcm90b3R5cGUuc2V0Q29udGVudD1mdW5jdGlvbihjb250ZW50LHdyYXBwZWRDb250ZW50KXtpZihjb250ZW50PT09dGhpcy5mb3JtYXR0ZWRNZXNzYWdlKXt0aGlzLmNvbnRlbnRFbGVtZW50LmlubmVySFRNTD1cIlwiO3RoaXMuY29udGVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5mb3JtYXR0ZWRNZXNzYWdlKSk7fWVsc2V7dGhpcy5jb250ZW50RWxlbWVudC5pbm5lckhUTUw9d3JhcHBlZENvbnRlbnQ7fX07ZnVuY3Rpb24gTG9nRW50cnlVbndyYXBwZWRFbGVtZW50Q29udGFpbmVyKGxvZ0VudHJ5LGNvbnRhaW5lckRvbU5vZGUpe3RoaXMubG9nRW50cnk9bG9nRW50cnk7dGhpcy5jb250YWluZXJEb21Ob2RlPWNvbnRhaW5lckRvbU5vZGU7dGhpcy5tYWluRGl2PWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7dGhpcy5tYWluRGl2LmNsYXNzTmFtZT1cImxvZ2VudHJ5IHVud3JhcHBlZCBcIit0aGlzLmxvZ0VudHJ5LmxldmVsO3RoaXMucHJlPXRoaXMubWFpbkRpdi5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwicHJlXCIpKTt0aGlzLnByZS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSh0aGlzLmxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2UpKTt0aGlzLnByZS5jbGFzc05hbWU9XCJ1bndyYXBwZWRcIjt0aGlzLmNvbnRlbnRFbGVtZW50PXRoaXMucHJlO30nLCdMb2dFbnRyeVVud3JhcHBlZEVsZW1lbnRDb250YWluZXIucHJvdG90eXBlPW5ldyBMb2dFbnRyeUVsZW1lbnRDb250YWluZXIoKTtMb2dFbnRyeVVud3JhcHBlZEVsZW1lbnRDb250YWluZXIucHJvdG90eXBlLnJlbW92ZT1mdW5jdGlvbigpe3RoaXMuZG9SZW1vdmUoKTt0aGlzLnByZT1udWxsO307ZnVuY3Rpb24gTG9nRW50cnlNYWluRWxlbWVudENvbnRhaW5lcihsb2dFbnRyeSxjb250YWluZXJEb21Ob2RlKXt0aGlzLmxvZ0VudHJ5PWxvZ0VudHJ5O3RoaXMuY29udGFpbmVyRG9tTm9kZT1jb250YWluZXJEb21Ob2RlO3RoaXMubWFpbkRpdj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO3RoaXMubWFpbkRpdi5jbGFzc05hbWU9XCJsb2dlbnRyeSBub25pZWxvZ2VudHJ5IFwiK3RoaXMubG9nRW50cnkubGV2ZWw7dGhpcy5jb250ZW50RWxlbWVudD10aGlzLm1haW5EaXYuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInNwYW5cIikpO3RoaXMuY29udGVudEVsZW1lbnQuYXBwZW5kQ2hpbGQoZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUodGhpcy5sb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlKSk7fScsJ0xvZ0VudHJ5TWFpbkVsZW1lbnRDb250YWluZXIucHJvdG90eXBlPW5ldyBMb2dFbnRyeUVsZW1lbnRDb250YWluZXIoKTtmdW5jdGlvbiBMb2dFbnRyeShsZXZlbCxmb3JtYXR0ZWRNZXNzYWdlKXt0aGlzLmxldmVsPWxldmVsO3RoaXMuZm9ybWF0dGVkTWVzc2FnZT1mb3JtYXR0ZWRNZXNzYWdlO3RoaXMucmVuZGVyZWQ9ZmFsc2U7fScsJ0xvZ0VudHJ5LnByb3RvdHlwZT1uZXcgTG9nSXRlbSgpO2NvcHlQcm9wZXJ0aWVzKExvZ0VudHJ5LnByb3RvdHlwZSx7cmVuZGVyOmZ1bmN0aW9uKCl7dmFyIGxvZ0VudHJ5PXRoaXM7dmFyIGNvbnRhaW5lckRvbU5vZGU9dGhpcy5ncm91cC5jb250ZW50RGl2O2lmKGlzSWUpe3RoaXMuZm9ybWF0dGVkTWVzc2FnZT10aGlzLmZvcm1hdHRlZE1lc3NhZ2UucmVwbGFjZSgvXFxcXHJcXFxcbi9nLFwiXFxcXHJcIik7dGhpcy51bndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW5ldyBMb2dFbnRyeVVud3JhcHBlZEVsZW1lbnRDb250YWluZXIodGhpcyx0aGlzLmdldFVud3JhcHBlZERvbUNvbnRhaW5lcigpKTt0aGlzLndyYXBwZWRFbGVtZW50Q29udGFpbmVyPW5ldyBMb2dFbnRyeVdyYXBwZWRFbGVtZW50Q29udGFpbmVyKHRoaXMsdGhpcy5nZXRXcmFwcGVkRG9tQ29udGFpbmVyKCkpO3RoaXMuZWxlbWVudENvbnRhaW5lcnM9W3RoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lcix0aGlzLndyYXBwZWRFbGVtZW50Q29udGFpbmVyXTt9ZWxzZXt0aGlzLm1haW5FbGVtZW50Q29udGFpbmVyPW5ldyBMb2dFbnRyeU1haW5FbGVtZW50Q29udGFpbmVyKHRoaXMsdGhpcy5nZXRNYWluRG9tQ29udGFpbmVyKCkpO3RoaXMuZWxlbWVudENvbnRhaW5lcnM9W3RoaXMubWFpbkVsZW1lbnRDb250YWluZXJdO30nLCd0aGlzLmNvbnRlbnQ9dGhpcy5mb3JtYXR0ZWRNZXNzYWdlO3RoaXMucmVuZGVyZWQ9dHJ1ZTt9LHNldENvbnRlbnQ6ZnVuY3Rpb24oY29udGVudCx3cmFwcGVkQ29udGVudCl7aWYoY29udGVudCE9dGhpcy5jb250ZW50KXtpZihpc0llJiYoY29udGVudCE9PXRoaXMuZm9ybWF0dGVkTWVzc2FnZSkpe2NvbnRlbnQ9Y29udGVudC5yZXBsYWNlKC9cXFxcclxcXFxuL2csXCJcXFxcclwiKTt9JywnZm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5zZXRDb250ZW50KGNvbnRlbnQsd3JhcHBlZENvbnRlbnQpO30nLCd0aGlzLmNvbnRlbnQ9Y29udGVudDt9fSxnZXRTZWFyY2hNYXRjaGVzOmZ1bmN0aW9uKCl7dmFyIG1hdGNoZXM9W107dmFyIGksbGVuO2lmKGlzSWUpe3ZhciB1bndyYXBwZWRFbHM9Z2V0RWxlbWVudHNCeUNsYXNzKHRoaXMudW53cmFwcGVkRWxlbWVudENvbnRhaW5lci5tYWluRGl2LFwic2VhcmNodGVybVwiLFwic3BhblwiKTt2YXIgd3JhcHBlZEVscz1nZXRFbGVtZW50c0J5Q2xhc3ModGhpcy53cmFwcGVkRWxlbWVudENvbnRhaW5lci5tYWluRGl2LFwic2VhcmNodGVybVwiLFwic3BhblwiKTtmb3IoaT0wLGxlbj11bndyYXBwZWRFbHMubGVuZ3RoO2k8bGVuO2krKyl7bWF0Y2hlc1tpXT1uZXcgTWF0Y2godGhpcy5sZXZlbCxudWxsLHVud3JhcHBlZEVsc1tpXSx3cmFwcGVkRWxzW2ldKTt9fWVsc2V7dmFyIGVscz1nZXRFbGVtZW50c0J5Q2xhc3ModGhpcy5tYWluRWxlbWVudENvbnRhaW5lci5tYWluRGl2LFwic2VhcmNodGVybVwiLFwic3BhblwiKTtmb3IoaT0wLGxlbj1lbHMubGVuZ3RoO2k8bGVuO2krKyl7bWF0Y2hlc1tpXT1uZXcgTWF0Y2godGhpcy5sZXZlbCxlbHNbaV0pO319JywncmV0dXJuIG1hdGNoZXM7fSxzZXRTZWFyY2hNYXRjaDpmdW5jdGlvbihpc01hdGNoKXtmb3IodmFyIGk9MCxsZW49dGhpcy5lbGVtZW50Q29udGFpbmVycy5sZW5ndGg7aTxsZW47aSsrKXt0aGlzLmVsZW1lbnRDb250YWluZXJzW2ldLnNldFNlYXJjaE1hdGNoKGlzTWF0Y2gpO319LGNsZWFyU2VhcmNoOmZ1bmN0aW9uKCl7Zm9yKHZhciBpPTAsbGVuPXRoaXMuZWxlbWVudENvbnRhaW5lcnMubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5lbGVtZW50Q29udGFpbmVyc1tpXS5jbGVhclNlYXJjaCgpO319LGFjY2VwdDpmdW5jdGlvbih2aXNpdG9yKXt2aXNpdG9yLnZpc2l0TG9nRW50cnkodGhpcyk7fSxzZXJpYWxpemU6ZnVuY3Rpb24oaXRlbXMpe2l0ZW1zLnB1c2goW0xvZ0l0ZW0uc2VyaWFsaXplZEl0ZW1LZXlzLkxPR19FTlRSWSx0aGlzLmxldmVsLHRoaXMuZm9ybWF0dGVkTWVzc2FnZV0pO319KTtmdW5jdGlvbiBMb2dJdGVtVmlzaXRvcigpe30nLCdMb2dJdGVtVmlzaXRvci5wcm90b3R5cGU9e3Zpc2l0OmZ1bmN0aW9uKGxvZ0l0ZW0pe30sdmlzaXRQYXJlbnQ6ZnVuY3Rpb24obG9nSXRlbSl7aWYobG9nSXRlbS5ncm91cCl7bG9nSXRlbS5ncm91cC5hY2NlcHQodGhpcyk7fX0sdmlzaXRDaGlsZHJlbjpmdW5jdGlvbihsb2dJdGVtKXtmb3IodmFyIGk9MCxsZW49bG9nSXRlbS5jaGlsZHJlbi5sZW5ndGg7aTxsZW47aSsrKXtsb2dJdGVtLmNoaWxkcmVuW2ldLmFjY2VwdCh0aGlzKTt9fSx2aXNpdExvZ0VudHJ5OmZ1bmN0aW9uKGxvZ0VudHJ5KXt0aGlzLnZpc2l0KGxvZ0VudHJ5KTt9LHZpc2l0U2VwYXJhdG9yOmZ1bmN0aW9uKHNlcGFyYXRvcil7dGhpcy52aXNpdChzZXBhcmF0b3IpO30sdmlzaXRHcm91cDpmdW5jdGlvbihncm91cCl7dGhpcy52aXNpdChncm91cCk7fX07ZnVuY3Rpb24gR3JvdXBGbGF0dGVuZXIoKXt0aGlzLmxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzPVtdO30nLCdHcm91cEZsYXR0ZW5lci5wcm90b3R5cGU9bmV3IExvZ0l0ZW1WaXNpdG9yKCk7R3JvdXBGbGF0dGVuZXIucHJvdG90eXBlLnZpc2l0R3JvdXA9ZnVuY3Rpb24oZ3JvdXApe3RoaXMudmlzaXRDaGlsZHJlbihncm91cCk7fTtHcm91cEZsYXR0ZW5lci5wcm90b3R5cGUudmlzaXRMb2dFbnRyeT1mdW5jdGlvbihsb2dFbnRyeSl7dGhpcy5sb2dFbnRyaWVzQW5kU2VwYXJhdG9ycy5wdXNoKGxvZ0VudHJ5KTt9O0dyb3VwRmxhdHRlbmVyLnByb3RvdHlwZS52aXNpdFNlcGFyYXRvcj1mdW5jdGlvbihzZXBhcmF0b3Ipe3RoaXMubG9nRW50cmllc0FuZFNlcGFyYXRvcnMucHVzaChzZXBhcmF0b3IpO307d2luZG93Lm9ubG9hZD1mdW5jdGlvbigpe2lmKGxvY2F0aW9uLnNlYXJjaCl7dmFyIHF1ZXJ5Qml0cz11bmVzY2FwZShsb2NhdGlvbi5zZWFyY2gpLnN1YnN0cigxKS5zcGxpdChcIiZcIiksbmFtZVZhbHVlQml0cztmb3IodmFyIGk9MCxsZW49cXVlcnlCaXRzLmxlbmd0aDtpPGxlbjtpKyspe25hbWVWYWx1ZUJpdHM9cXVlcnlCaXRzW2ldLnNwbGl0KFwiPVwiKTtpZihuYW1lVmFsdWVCaXRzWzBdPT1cImxvZzRqYXZhc2NyaXB0X2RvbWFpblwiKXtkb2N1bWVudC5kb21haW49bmFtZVZhbHVlQml0c1sxXTticmVhazt9fX0nLCdsb2dNYWluQ29udGFpbmVyPSQoXCJsb2dcIik7aWYoaXNJZVByZTcpe2FkZENsYXNzKGxvZ01haW5Db250YWluZXIsXCJvbGRJZVwiKTt9Jywncm9vdEdyb3VwPW5ldyBHcm91cChcInJvb3RcIix0cnVlKTtyb290R3JvdXAucmVuZGVyKCk7Y3VycmVudEdyb3VwPXJvb3RHcm91cDtzZXRDb21tYW5kSW5wdXRXaWR0aCgpO3NldExvZ0NvbnRhaW5lckhlaWdodCgpO3RvZ2dsZUxvZ2dpbmdFbmFibGVkKCk7dG9nZ2xlU2VhcmNoRW5hYmxlZCgpO3RvZ2dsZVNlYXJjaEZpbHRlcigpO3RvZ2dsZVNlYXJjaEhpZ2hsaWdodCgpO2FwcGx5RmlsdGVycygpO2NoZWNrQWxsTGV2ZWxzKCk7dG9nZ2xlV3JhcCgpO3RvZ2dsZU5ld2VzdEF0VG9wKCk7dG9nZ2xlU2Nyb2xsVG9MYXRlc3QoKTtyZW5kZXJRdWV1ZWRMb2dJdGVtcygpO2xvYWRlZD10cnVlOyQoXCJjb21tYW5kXCIpLnZhbHVlPVwiXCI7JChcImNvbW1hbmRcIikuYXV0b2NvbXBsZXRlPVwib2ZmXCI7JChcImNvbW1hbmRcIikub25rZXlkb3duPWZ1bmN0aW9uKGV2dCl7ZXZ0PWdldEV2ZW50KGV2dCk7aWYoZXZ0LmtleUNvZGU9PTEwfHxldnQua2V5Q29kZT09MTMpe2V2YWxDb21tYW5kTGluZSgpO3N0b3BQcm9wYWdhdGlvbihldnQpO31lbHNlIGlmKGV2dC5rZXlDb2RlPT0yNyl7dGhpcy52YWx1ZT1cIlwiO3RoaXMuZm9jdXMoKTt9ZWxzZSBpZihldnQua2V5Q29kZT09MzgmJmNvbW1hbmRIaXN0b3J5Lmxlbmd0aD4wKXtjdXJyZW50Q29tbWFuZEluZGV4PU1hdGgubWF4KDAsY3VycmVudENvbW1hbmRJbmRleC0xKTt0aGlzLnZhbHVlPWNvbW1hbmRIaXN0b3J5W2N1cnJlbnRDb21tYW5kSW5kZXhdO21vdmVDYXJldFRvRW5kKHRoaXMpO31lbHNlIGlmKGV2dC5rZXlDb2RlPT00MCYmY29tbWFuZEhpc3RvcnkubGVuZ3RoPjApe2N1cnJlbnRDb21tYW5kSW5kZXg9TWF0aC5taW4oY29tbWFuZEhpc3RvcnkubGVuZ3RoLTEsY3VycmVudENvbW1hbmRJbmRleCsxKTt0aGlzLnZhbHVlPWNvbW1hbmRIaXN0b3J5W2N1cnJlbnRDb21tYW5kSW5kZXhdO21vdmVDYXJldFRvRW5kKHRoaXMpO319OyQoXCJjb21tYW5kXCIpLm9ua2V5cHJlc3M9ZnVuY3Rpb24oZXZ0KXtldnQ9Z2V0RXZlbnQoZXZ0KTtpZihldnQua2V5Q29kZT09MzgmJmNvbW1hbmRIaXN0b3J5Lmxlbmd0aD4wJiZldnQucHJldmVudERlZmF1bHQpe2V2dC5wcmV2ZW50RGVmYXVsdCgpO319OyQoXCJjb21tYW5kXCIpLm9ua2V5dXA9ZnVuY3Rpb24oZXZ0KXtldnQ9Z2V0RXZlbnQoZXZ0KTtpZihldnQua2V5Q29kZT09MjcmJmV2dC5wcmV2ZW50RGVmYXVsdCl7ZXZ0LnByZXZlbnREZWZhdWx0KCk7dGhpcy5mb2N1cygpO319O2RvY3VtZW50Lm9ua2V5ZG93bj1mdW5jdGlvbiBrZXlFdmVudEhhbmRsZXIoZXZ0KXtldnQ9Z2V0RXZlbnQoZXZ0KTtzd2l0Y2goZXZ0LmtleUNvZGUpe2Nhc2UgNjk6aWYoZXZ0LnNoaWZ0S2V5JiYoZXZ0LmN0cmxLZXl8fGV2dC5tZXRhS2V5KSl7ZXZhbExhc3RDb21tYW5kKCk7Y2FuY2VsS2V5RXZlbnQoZXZ0KTtyZXR1cm4gZmFsc2U7fScsJ2JyZWFrO2Nhc2UgNzU6aWYoZXZ0LnNoaWZ0S2V5JiYoZXZ0LmN0cmxLZXl8fGV2dC5tZXRhS2V5KSl7Zm9jdXNTZWFyY2goKTtjYW5jZWxLZXlFdmVudChldnQpO3JldHVybiBmYWxzZTt9JywnYnJlYWs7Y2FzZSA0MDpjYXNlIDc2OmlmKGV2dC5zaGlmdEtleSYmKGV2dC5jdHJsS2V5fHxldnQubWV0YUtleSkpe2ZvY3VzQ29tbWFuZExpbmUoKTtjYW5jZWxLZXlFdmVudChldnQpO3JldHVybiBmYWxzZTt9JywnYnJlYWs7fX07c2V0VGltZW91dChzZXRMb2dDb250YWluZXJIZWlnaHQsMjApO3NldFNob3dDb21tYW5kTGluZShzaG93Q29tbWFuZExpbmUpO2RvU2VhcmNoKCk7fTt3aW5kb3cub251bmxvYWQ9ZnVuY3Rpb24oKXtpZihtYWluV2luZG93RXhpc3RzKCkpe2FwcGVuZGVyLnVubG9hZCgpO30nLCdhcHBlbmRlcj1udWxsO307ZnVuY3Rpb24gdG9nZ2xlTG9nZ2luZ0VuYWJsZWQoKXtzZXRMb2dnaW5nRW5hYmxlZCgkKFwiZW5hYmxlTG9nZ2luZ1wiKS5jaGVja2VkKTt9JywnZnVuY3Rpb24gc2V0TG9nZ2luZ0VuYWJsZWQoZW5hYmxlKXtsb2dnaW5nRW5hYmxlZD1lbmFibGU7fScsJ3ZhciBhcHBlbmRlcj1udWxsO2Z1bmN0aW9uIHNldEFwcGVuZGVyKGFwcGVuZGVyUGFyYW0pe2FwcGVuZGVyPWFwcGVuZGVyUGFyYW07fScsJ2Z1bmN0aW9uIHNldFNob3dDbG9zZUJ1dHRvbihzaG93Q2xvc2VCdXR0b24peyQoXCJjbG9zZUJ1dHRvblwiKS5zdHlsZS5kaXNwbGF5PXNob3dDbG9zZUJ1dHRvbj9cImlubGluZVwiOlwibm9uZVwiO30nLCdmdW5jdGlvbiBzZXRTaG93SGlkZUJ1dHRvbihzaG93SGlkZUJ1dHRvbil7JChcImhpZGVCdXR0b25cIikuc3R5bGUuZGlzcGxheT1zaG93SGlkZUJ1dHRvbj9cImlubGluZVwiOlwibm9uZVwiO30nLCd2YXIgbmV3ZXN0QXRUb3A9ZmFsc2U7ZnVuY3Rpb24gTG9nSXRlbUNvbnRlbnRSZXZlcnNlcigpe30nLCdMb2dJdGVtQ29udGVudFJldmVyc2VyLnByb3RvdHlwZT1uZXcgTG9nSXRlbVZpc2l0b3IoKTtMb2dJdGVtQ29udGVudFJldmVyc2VyLnByb3RvdHlwZS52aXNpdEdyb3VwPWZ1bmN0aW9uKGdyb3VwKXtncm91cC5yZXZlcnNlQ2hpbGRyZW4oKTt0aGlzLnZpc2l0Q2hpbGRyZW4oZ3JvdXApO307ZnVuY3Rpb24gc2V0TmV3ZXN0QXRUb3AoaXNOZXdlc3RBdFRvcCl7dmFyIG9sZE5ld2VzdEF0VG9wPW5ld2VzdEF0VG9wO3ZhciBpLGlMZW4saixqTGVuO25ld2VzdEF0VG9wPUJvb2xlYW4oaXNOZXdlc3RBdFRvcCk7aWYob2xkTmV3ZXN0QXRUb3AhPW5ld2VzdEF0VG9wKXt2YXIgdmlzaXRvcj1uZXcgTG9nSXRlbUNvbnRlbnRSZXZlcnNlcigpO3Jvb3RHcm91cC5hY2NlcHQodmlzaXRvcik7aWYoY3VycmVudFNlYXJjaCl7dmFyIGN1cnJlbnRNYXRjaD1jdXJyZW50U2VhcmNoLm1hdGNoZXNbY3VycmVudE1hdGNoSW5kZXhdO3ZhciBtYXRjaEluZGV4PTA7dmFyIG1hdGNoZXM9W107dmFyIGFjdE9uTG9nRW50cnk9ZnVuY3Rpb24obG9nRW50cnkpe3ZhciBsb2dFbnRyeU1hdGNoZXM9bG9nRW50cnkuZ2V0U2VhcmNoTWF0Y2hlcygpO2ZvcihqPTAsakxlbj1sb2dFbnRyeU1hdGNoZXMubGVuZ3RoO2o8akxlbjtqKyspe21hdGNoZXNbbWF0Y2hJbmRleF09bG9nRW50cnlNYXRjaGVzW2pdO2lmKGN1cnJlbnRNYXRjaCYmbG9nRW50cnlNYXRjaGVzW2pdLmVxdWFscyhjdXJyZW50TWF0Y2gpKXtjdXJyZW50TWF0Y2hJbmRleD1tYXRjaEluZGV4O30nLCdtYXRjaEluZGV4Kys7fX07aWYobmV3ZXN0QXRUb3Ape2ZvcihpPWxvZ0VudHJpZXMubGVuZ3RoLTE7aT49MDtpLS0pe2FjdE9uTG9nRW50cnkobG9nRW50cmllc1tpXSk7fX1lbHNle2ZvcihpPTAsaUxlbj1sb2dFbnRyaWVzLmxlbmd0aDtpPGlMZW47aSsrKXthY3RPbkxvZ0VudHJ5KGxvZ0VudHJpZXNbaV0pO319JywnY3VycmVudFNlYXJjaC5tYXRjaGVzPW1hdGNoZXM7aWYoY3VycmVudE1hdGNoKXtjdXJyZW50TWF0Y2guc2V0Q3VycmVudCgpO319ZWxzZSBpZihzY3JvbGxUb0xhdGVzdCl7ZG9TY3JvbGxUb0xhdGVzdCgpO319JywnJChcIm5ld2VzdEF0VG9wXCIpLmNoZWNrZWQ9aXNOZXdlc3RBdFRvcDt9JywnZnVuY3Rpb24gdG9nZ2xlTmV3ZXN0QXRUb3AoKXt2YXIgaXNOZXdlc3RBdFRvcD0kKFwibmV3ZXN0QXRUb3BcIikuY2hlY2tlZDtzZXROZXdlc3RBdFRvcChpc05ld2VzdEF0VG9wKTt9JywndmFyIHNjcm9sbFRvTGF0ZXN0PXRydWU7ZnVuY3Rpb24gc2V0U2Nyb2xsVG9MYXRlc3QoaXNTY3JvbGxUb0xhdGVzdCl7c2Nyb2xsVG9MYXRlc3Q9aXNTY3JvbGxUb0xhdGVzdDtpZihzY3JvbGxUb0xhdGVzdCl7ZG9TY3JvbGxUb0xhdGVzdCgpO30nLCckKFwic2Nyb2xsVG9MYXRlc3RcIikuY2hlY2tlZD1pc1Njcm9sbFRvTGF0ZXN0O30nLCdmdW5jdGlvbiB0b2dnbGVTY3JvbGxUb0xhdGVzdCgpe3ZhciBpc1Njcm9sbFRvTGF0ZXN0PSQoXCJzY3JvbGxUb0xhdGVzdFwiKS5jaGVja2VkO3NldFNjcm9sbFRvTGF0ZXN0KGlzU2Nyb2xsVG9MYXRlc3QpO30nLCdmdW5jdGlvbiBkb1Njcm9sbFRvTGF0ZXN0KCl7dmFyIGw9bG9nTWFpbkNvbnRhaW5lcjtpZih0eXBlb2YgbC5zY3JvbGxUb3AhPVwidW5kZWZpbmVkXCIpe2lmKG5ld2VzdEF0VG9wKXtsLnNjcm9sbFRvcD0wO31lbHNle3ZhciBsYXRlc3RMb2dFbnRyeT1sLmxhc3RDaGlsZDtpZihsYXRlc3RMb2dFbnRyeSl7bC5zY3JvbGxUb3A9bC5zY3JvbGxIZWlnaHQ7fX19fScsJ3ZhciBjbG9zZUlmT3BlbmVyQ2xvc2VzPXRydWU7ZnVuY3Rpb24gc2V0Q2xvc2VJZk9wZW5lckNsb3Nlcyhpc0Nsb3NlSWZPcGVuZXJDbG9zZXMpe2Nsb3NlSWZPcGVuZXJDbG9zZXM9aXNDbG9zZUlmT3BlbmVyQ2xvc2VzO30nLCd2YXIgbWF4TWVzc2FnZXM9bnVsbDtmdW5jdGlvbiBzZXRNYXhNZXNzYWdlcyhtYXgpe21heE1lc3NhZ2VzPW1heDtwcnVuZUxvZ0VudHJpZXMoKTt9JywndmFyIHNob3dDb21tYW5kTGluZT1mYWxzZTtmdW5jdGlvbiBzZXRTaG93Q29tbWFuZExpbmUoaXNTaG93Q29tbWFuZExpbmUpe3Nob3dDb21tYW5kTGluZT1pc1Nob3dDb21tYW5kTGluZTtpZihsb2FkZWQpeyQoXCJjb21tYW5kTGluZVwiKS5zdHlsZS5kaXNwbGF5PXNob3dDb21tYW5kTGluZT9cImJsb2NrXCI6XCJub25lXCI7c2V0Q29tbWFuZElucHV0V2lkdGgoKTtzZXRMb2dDb250YWluZXJIZWlnaHQoKTt9fScsJ2Z1bmN0aW9uIGZvY3VzQ29tbWFuZExpbmUoKXtpZihsb2FkZWQpeyQoXCJjb21tYW5kXCIpLmZvY3VzKCk7fX0nLCdmdW5jdGlvbiBmb2N1c1NlYXJjaCgpe2lmKGxvYWRlZCl7JChcInNlYXJjaEJveFwiKS5mb2N1cygpO319JywnZnVuY3Rpb24gZ2V0TG9nSXRlbXMoKXt2YXIgaXRlbXM9W107Zm9yKHZhciBpPTAsbGVuPWxvZ0l0ZW1zLmxlbmd0aDtpPGxlbjtpKyspe2xvZ0l0ZW1zW2ldLnNlcmlhbGl6ZShpdGVtcyk7fScsJ3JldHVybiBpdGVtczt9JywnZnVuY3Rpb24gc2V0TG9nSXRlbXMoaXRlbXMpe3ZhciBsb2dnaW5nUmVhbGx5RW5hYmxlZD1sb2dnaW5nRW5hYmxlZDtsb2dnaW5nRW5hYmxlZD10cnVlO2Zvcih2YXIgaT0wLGxlbj1pdGVtcy5sZW5ndGg7aTxsZW47aSsrKXtzd2l0Y2goaXRlbXNbaV1bMF0pe2Nhc2UgTG9nSXRlbS5zZXJpYWxpemVkSXRlbUtleXMuTE9HX0VOVFJZOmxvZyhpdGVtc1tpXVsxXSxpdGVtc1tpXVsyXSk7YnJlYWs7Y2FzZSBMb2dJdGVtLnNlcmlhbGl6ZWRJdGVtS2V5cy5HUk9VUF9TVEFSVDpncm91cChpdGVtc1tpXVsxXSk7YnJlYWs7Y2FzZSBMb2dJdGVtLnNlcmlhbGl6ZWRJdGVtS2V5cy5HUk9VUF9FTkQ6Z3JvdXBFbmQoKTticmVhazt9fScsJ2xvZ2dpbmdFbmFibGVkPWxvZ2dpbmdSZWFsbHlFbmFibGVkO30nLCdmdW5jdGlvbiBsb2cobG9nTGV2ZWwsZm9ybWF0dGVkTWVzc2FnZSl7aWYobG9nZ2luZ0VuYWJsZWQpe3ZhciBsb2dFbnRyeT1uZXcgTG9nRW50cnkobG9nTGV2ZWwsZm9ybWF0dGVkTWVzc2FnZSk7bG9nRW50cmllcy5wdXNoKGxvZ0VudHJ5KTtsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycy5wdXNoKGxvZ0VudHJ5KTtsb2dJdGVtcy5wdXNoKGxvZ0VudHJ5KTtjdXJyZW50R3JvdXAuYWRkQ2hpbGQobG9nRW50cnkpO2lmKGxvYWRlZCl7aWYobG9nUXVldWVkRXZlbnRzVGltZXIhPT1udWxsKXtjbGVhclRpbWVvdXQobG9nUXVldWVkRXZlbnRzVGltZXIpO30nLCdsb2dRdWV1ZWRFdmVudHNUaW1lcj1zZXRUaW1lb3V0KHJlbmRlclF1ZXVlZExvZ0l0ZW1zLHJlbmRlckRlbGF5KTt1bnJlbmRlcmVkTG9nSXRlbXNFeGlzdD10cnVlO319fScsJ2Z1bmN0aW9uIHJlbmRlclF1ZXVlZExvZ0l0ZW1zKCl7bG9nUXVldWVkRXZlbnRzVGltZXI9bnVsbDt2YXIgcHJ1bmVkPXBydW5lTG9nRW50cmllcygpO3ZhciBpbml0aWFsbHlIYXNNYXRjaGVzPWN1cnJlbnRTZWFyY2g/Y3VycmVudFNlYXJjaC5oYXNNYXRjaGVzKCk6ZmFsc2U7Zm9yKHZhciBpPTAsbGVuPWxvZ0l0ZW1zLmxlbmd0aDtpPGxlbjtpKyspe2lmKCFsb2dJdGVtc1tpXS5yZW5kZXJlZCl7bG9nSXRlbXNbaV0ucmVuZGVyKCk7bG9nSXRlbXNbaV0uYXBwZW5kVG9Mb2coKTtpZihjdXJyZW50U2VhcmNoJiYobG9nSXRlbXNbaV1pbnN0YW5jZW9mIExvZ0VudHJ5KSl7Y3VycmVudFNlYXJjaC5hcHBseVRvKGxvZ0l0ZW1zW2ldKTt9fX0nLCdpZihjdXJyZW50U2VhcmNoKXtpZihwcnVuZWQpe2lmKGN1cnJlbnRTZWFyY2guaGFzVmlzaWJsZU1hdGNoZXMoKSl7aWYoY3VycmVudE1hdGNoSW5kZXg9PT1udWxsKXtzZXRDdXJyZW50TWF0Y2hJbmRleCgwKTt9JywnZGlzcGxheU1hdGNoZXMoKTt9ZWxzZXtkaXNwbGF5Tm9NYXRjaGVzKCk7fX1lbHNlIGlmKCFpbml0aWFsbHlIYXNNYXRjaGVzJiZjdXJyZW50U2VhcmNoLmhhc1Zpc2libGVNYXRjaGVzKCkpe3NldEN1cnJlbnRNYXRjaEluZGV4KDApO2Rpc3BsYXlNYXRjaGVzKCk7fX0nLCdpZihzY3JvbGxUb0xhdGVzdCl7ZG9TY3JvbGxUb0xhdGVzdCgpO30nLCd1bnJlbmRlcmVkTG9nSXRlbXNFeGlzdD1mYWxzZTt9JywnZnVuY3Rpb24gcHJ1bmVMb2dFbnRyaWVzKCl7aWYoKG1heE1lc3NhZ2VzIT09bnVsbCkmJihsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycy5sZW5ndGg+bWF4TWVzc2FnZXMpKXt2YXIgbnVtYmVyVG9EZWxldGU9bG9nRW50cmllc0FuZFNlcGFyYXRvcnMubGVuZ3RoLW1heE1lc3NhZ2VzO3ZhciBwcnVuZWRMb2dFbnRyaWVzPWxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzLnNsaWNlKDAsbnVtYmVyVG9EZWxldGUpO2lmKGN1cnJlbnRTZWFyY2gpe2N1cnJlbnRTZWFyY2gucmVtb3ZlTWF0Y2hlcyhwcnVuZWRMb2dFbnRyaWVzKTt9JywndmFyIGdyb3VwO2Zvcih2YXIgaT0wO2k8bnVtYmVyVG9EZWxldGU7aSsrKXtncm91cD1sb2dFbnRyaWVzQW5kU2VwYXJhdG9yc1tpXS5ncm91cDthcnJheV9yZW1vdmUobG9nSXRlbXMsbG9nRW50cmllc0FuZFNlcGFyYXRvcnNbaV0pO2FycmF5X3JlbW92ZShsb2dFbnRyaWVzLGxvZ0VudHJpZXNBbmRTZXBhcmF0b3JzW2ldKTtsb2dFbnRyaWVzQW5kU2VwYXJhdG9yc1tpXS5yZW1vdmUodHJ1ZSx0cnVlKTtpZihncm91cC5jaGlsZHJlbi5sZW5ndGg9PT0wJiZncm91cCE9PWN1cnJlbnRHcm91cCYmZ3JvdXAhPT1yb290R3JvdXApe2FycmF5X3JlbW92ZShsb2dJdGVtcyxncm91cCk7Z3JvdXAucmVtb3ZlKHRydWUsdHJ1ZSk7fX0nLCdsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycz1hcnJheV9yZW1vdmVGcm9tU3RhcnQobG9nRW50cmllc0FuZFNlcGFyYXRvcnMsbnVtYmVyVG9EZWxldGUpO3JldHVybiB0cnVlO30nLCdyZXR1cm4gZmFsc2U7fScsJ2Z1bmN0aW9uIGdyb3VwKG5hbWUsc3RhcnRFeHBhbmRlZCl7aWYobG9nZ2luZ0VuYWJsZWQpe2luaXRpYWxseUV4cGFuZGVkPSh0eXBlb2Ygc3RhcnRFeHBhbmRlZD09PVwidW5kZWZpbmVkXCIpP3RydWU6Qm9vbGVhbihzdGFydEV4cGFuZGVkKTt2YXIgbmV3R3JvdXA9bmV3IEdyb3VwKG5hbWUsZmFsc2UsaW5pdGlhbGx5RXhwYW5kZWQpO2N1cnJlbnRHcm91cC5hZGRDaGlsZChuZXdHcm91cCk7Y3VycmVudEdyb3VwPW5ld0dyb3VwO2xvZ0l0ZW1zLnB1c2gobmV3R3JvdXApO2lmKGxvYWRlZCl7aWYobG9nUXVldWVkRXZlbnRzVGltZXIhPT1udWxsKXtjbGVhclRpbWVvdXQobG9nUXVldWVkRXZlbnRzVGltZXIpO30nLCdsb2dRdWV1ZWRFdmVudHNUaW1lcj1zZXRUaW1lb3V0KHJlbmRlclF1ZXVlZExvZ0l0ZW1zLHJlbmRlckRlbGF5KTt1bnJlbmRlcmVkTG9nSXRlbXNFeGlzdD10cnVlO319fScsJ2Z1bmN0aW9uIGdyb3VwRW5kKCl7Y3VycmVudEdyb3VwPShjdXJyZW50R3JvdXA9PT1yb290R3JvdXApP3Jvb3RHcm91cDpjdXJyZW50R3JvdXAuZ3JvdXA7fScsJ2Z1bmN0aW9uIG1haW5QYWdlUmVsb2FkZWQoKXtjdXJyZW50R3JvdXA9cm9vdEdyb3VwO3ZhciBzZXBhcmF0b3I9bmV3IFNlcGFyYXRvcigpO2xvZ0VudHJpZXNBbmRTZXBhcmF0b3JzLnB1c2goc2VwYXJhdG9yKTtsb2dJdGVtcy5wdXNoKHNlcGFyYXRvcik7Y3VycmVudEdyb3VwLmFkZENoaWxkKHNlcGFyYXRvcik7fScsJ2Z1bmN0aW9uIGNsb3NlV2luZG93KCl7aWYoYXBwZW5kZXImJm1haW5XaW5kb3dFeGlzdHMoKSl7YXBwZW5kZXIuY2xvc2UodHJ1ZSk7fWVsc2V7d2luZG93LmNsb3NlKCk7fX0nLCdmdW5jdGlvbiBoaWRlKCl7aWYoYXBwZW5kZXImJm1haW5XaW5kb3dFeGlzdHMoKSl7YXBwZW5kZXIuaGlkZSgpO319JywndmFyIG1haW5XaW5kb3c9d2luZG93O3ZhciB3aW5kb3dJZD1cImxvZzRqYXZhc2NyaXB0Q29uc29sZVdpbmRvd19cIituZXcgRGF0ZSgpLmdldFRpbWUoKStcIl9cIisoXCJcIitNYXRoLnJhbmRvbSgpKS5zdWJzdHIoMik7ZnVuY3Rpb24gc2V0TWFpbldpbmRvdyh3aW4pe21haW5XaW5kb3c9d2luO21haW5XaW5kb3dbd2luZG93SWRdPXdpbmRvdztpZihvcGVuZXImJmNsb3NlSWZPcGVuZXJDbG9zZXMpe3BvbGxPcGVuZXIoKTt9fScsJ2Z1bmN0aW9uIHBvbGxPcGVuZXIoKXtpZihjbG9zZUlmT3BlbmVyQ2xvc2VzKXtpZihtYWluV2luZG93RXhpc3RzKCkpe3NldFRpbWVvdXQocG9sbE9wZW5lciw1MDApO31lbHNle2Nsb3NlV2luZG93KCk7fX19JywnZnVuY3Rpb24gbWFpbldpbmRvd0V4aXN0cygpe3RyeXtyZXR1cm4obWFpbldpbmRvdyYmIW1haW5XaW5kb3cuY2xvc2VkJiZtYWluV2luZG93W3dpbmRvd0lkXT09d2luZG93KTt9Y2F0Y2goZXgpe30nLCdyZXR1cm4gZmFsc2U7fScsJ3ZhciBsb2dMZXZlbHM9W1wiVFJBQ0VcIixcIkRFQlVHXCIsXCJJTkZPXCIsXCJXQVJOXCIsXCJFUlJPUlwiLFwiRkFUQUxcIl07ZnVuY3Rpb24gZ2V0Q2hlY2tCb3gobG9nTGV2ZWwpe3JldHVybiAkKFwic3dpdGNoX1wiK2xvZ0xldmVsKTt9JywnZnVuY3Rpb24gZ2V0SWVXcmFwcGVkTG9nQ29udGFpbmVyKCl7cmV0dXJuICQoXCJsb2dfd3JhcHBlZFwiKTt9JywnZnVuY3Rpb24gZ2V0SWVVbndyYXBwZWRMb2dDb250YWluZXIoKXtyZXR1cm4gJChcImxvZ191bndyYXBwZWRcIik7fScsJ2Z1bmN0aW9uIGFwcGx5RmlsdGVycygpe2Zvcih2YXIgaT0wO2k8bG9nTGV2ZWxzLmxlbmd0aDtpKyspe2lmKGdldENoZWNrQm94KGxvZ0xldmVsc1tpXSkuY2hlY2tlZCl7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixsb2dMZXZlbHNbaV0pO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsbG9nTGV2ZWxzW2ldKTt9fScsJ3VwZGF0ZVNlYXJjaEZyb21GaWx0ZXJzKCk7fScsJ2Z1bmN0aW9uIHRvZ2dsZUFsbExldmVscygpe3ZhciB0dXJuT249JChcInN3aXRjaF9BTExcIikuY2hlY2tlZDtmb3IodmFyIGk9MDtpPGxvZ0xldmVscy5sZW5ndGg7aSsrKXtnZXRDaGVja0JveChsb2dMZXZlbHNbaV0pLmNoZWNrZWQ9dHVybk9uO2lmKHR1cm5Pbil7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixsb2dMZXZlbHNbaV0pO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsbG9nTGV2ZWxzW2ldKTt9fX0nLCdmdW5jdGlvbiBjaGVja0FsbExldmVscygpe2Zvcih2YXIgaT0wO2k8bG9nTGV2ZWxzLmxlbmd0aDtpKyspe2lmKCFnZXRDaGVja0JveChsb2dMZXZlbHNbaV0pLmNoZWNrZWQpe2dldENoZWNrQm94KFwiQUxMXCIpLmNoZWNrZWQ9ZmFsc2U7cmV0dXJuO319JywnZ2V0Q2hlY2tCb3goXCJBTExcIikuY2hlY2tlZD10cnVlO30nLCdmdW5jdGlvbiBjbGVhckxvZygpe3Jvb3RHcm91cC5jbGVhcigpO2N1cnJlbnRHcm91cD1yb290R3JvdXA7bG9nRW50cmllcz1bXTtsb2dJdGVtcz1bXTtsb2dFbnRyaWVzQW5kU2VwYXJhdG9ycz1bXTtkb1NlYXJjaCgpO30nLCdmdW5jdGlvbiB0b2dnbGVXcmFwKCl7dmFyIGVuYWJsZT0kKFwid3JhcFwiKS5jaGVja2VkO2lmKGVuYWJsZSl7YWRkQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcIndyYXBcIik7fWVsc2V7cmVtb3ZlQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcIndyYXBcIik7fScsJ3JlZnJlc2hDdXJyZW50TWF0Y2goKTt9JywndmFyIHNlYXJjaFRpbWVyPW51bGw7ZnVuY3Rpb24gc2NoZWR1bGVTZWFyY2goKXt0cnl7Y2xlYXJUaW1lb3V0KHNlYXJjaFRpbWVyKTt9Y2F0Y2goZXgpe30nLCdzZWFyY2hUaW1lcj1zZXRUaW1lb3V0KGRvU2VhcmNoLDUwMCk7fScsJ2Z1bmN0aW9uIFNlYXJjaChzZWFyY2hUZXJtLGlzUmVnZXgsc2VhcmNoUmVnZXgsaXNDYXNlU2Vuc2l0aXZlKXt0aGlzLnNlYXJjaFRlcm09c2VhcmNoVGVybTt0aGlzLmlzUmVnZXg9aXNSZWdleDt0aGlzLnNlYXJjaFJlZ2V4PXNlYXJjaFJlZ2V4O3RoaXMuaXNDYXNlU2Vuc2l0aXZlPWlzQ2FzZVNlbnNpdGl2ZTt0aGlzLm1hdGNoZXM9W107fScsJ1NlYXJjaC5wcm90b3R5cGU9e2hhc01hdGNoZXM6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5tYXRjaGVzLmxlbmd0aD4wO30saGFzVmlzaWJsZU1hdGNoZXM6ZnVuY3Rpb24oKXtpZih0aGlzLmhhc01hdGNoZXMoKSl7Zm9yKHZhciBpPTA7aTx0aGlzLm1hdGNoZXMubGVuZ3RoO2krKyl7aWYodGhpcy5tYXRjaGVzW2ldLmlzVmlzaWJsZSgpKXtyZXR1cm4gdHJ1ZTt9fX0nLCdyZXR1cm4gZmFsc2U7fSxtYXRjaDpmdW5jdGlvbihsb2dFbnRyeSl7dmFyIGVudHJ5VGV4dD1TdHJpbmcobG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZSk7dmFyIG1hdGNoZXNTZWFyY2g9ZmFsc2U7aWYodGhpcy5pc1JlZ2V4KXttYXRjaGVzU2VhcmNoPXRoaXMuc2VhcmNoUmVnZXgudGVzdChlbnRyeVRleHQpO31lbHNlIGlmKHRoaXMuaXNDYXNlU2Vuc2l0aXZlKXttYXRjaGVzU2VhcmNoPShlbnRyeVRleHQuaW5kZXhPZih0aGlzLnNlYXJjaFRlcm0pPi0xKTt9ZWxzZXttYXRjaGVzU2VhcmNoPShlbnRyeVRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKHRoaXMuc2VhcmNoVGVybS50b0xvd2VyQ2FzZSgpKT4tMSk7fScsJ3JldHVybiBtYXRjaGVzU2VhcmNoO30sZ2V0TmV4dFZpc2libGVNYXRjaEluZGV4OmZ1bmN0aW9uKCl7Zm9yKHZhciBpPWN1cnJlbnRNYXRjaEluZGV4KzE7aTx0aGlzLm1hdGNoZXMubGVuZ3RoO2krKyl7aWYodGhpcy5tYXRjaGVzW2ldLmlzVmlzaWJsZSgpKXtyZXR1cm4gaTt9fScsJ2ZvcihpPTA7aTw9Y3VycmVudE1hdGNoSW5kZXg7aSsrKXtpZih0aGlzLm1hdGNoZXNbaV0uaXNWaXNpYmxlKCkpe3JldHVybiBpO319JywncmV0dXJuLTE7fSxnZXRQcmV2aW91c1Zpc2libGVNYXRjaEluZGV4OmZ1bmN0aW9uKCl7Zm9yKHZhciBpPWN1cnJlbnRNYXRjaEluZGV4LTE7aT49MDtpLS0pe2lmKHRoaXMubWF0Y2hlc1tpXS5pc1Zpc2libGUoKSl7cmV0dXJuIGk7fX0nLCdmb3IodmFyIGk9dGhpcy5tYXRjaGVzLmxlbmd0aC0xO2k+PWN1cnJlbnRNYXRjaEluZGV4O2ktLSl7aWYodGhpcy5tYXRjaGVzW2ldLmlzVmlzaWJsZSgpKXtyZXR1cm4gaTt9fScsJ3JldHVybi0xO30sYXBwbHlUbzpmdW5jdGlvbihsb2dFbnRyeSl7dmFyIGRvZXNNYXRjaD10aGlzLm1hdGNoKGxvZ0VudHJ5KTtpZihkb2VzTWF0Y2gpe2xvZ0VudHJ5Lmdyb3VwLmV4cGFuZCgpO2xvZ0VudHJ5LnNldFNlYXJjaE1hdGNoKHRydWUpO3ZhciBsb2dFbnRyeUNvbnRlbnQ7dmFyIHdyYXBwZWRMb2dFbnRyeUNvbnRlbnQ7dmFyIHNlYXJjaFRlcm1SZXBsYWNlbWVudFN0YXJ0VGFnPVwiPHNwYW4gY2xhc3M9XFxcXFxcXCJzZWFyY2h0ZXJtXFxcXFxcXCI+XCI7dmFyIHNlYXJjaFRlcm1SZXBsYWNlbWVudEVuZFRhZz1cIjxcIitcIi9zcGFuPlwiO3ZhciBwcmVUYWdOYW1lPWlzSWU/XCJwcmVcIjpcInNwYW5cIjt2YXIgcHJlU3RhcnRUYWc9XCI8XCIrcHJlVGFnTmFtZStcIiBjbGFzcz1cXFxcXFxcInByZVxcXFxcXFwiPlwiO3ZhciBwcmVFbmRUYWc9XCI8XCIrXCIvXCIrcHJlVGFnTmFtZStcIj5cIjt2YXIgc3RhcnRJbmRleD0wO3ZhciBzZWFyY2hJbmRleCxtYXRjaGVkVGV4dCx0ZXh0QmVmb3JlTWF0Y2g7aWYodGhpcy5pc1JlZ2V4KXt2YXIgZmxhZ3M9dGhpcy5pc0Nhc2VTZW5zaXRpdmU/XCJnXCI6XCJnaVwiO3ZhciBjYXB0dXJpbmdSZWdleD1uZXcgUmVnRXhwKFwiKFwiK3RoaXMuc2VhcmNoUmVnZXguc291cmNlK1wiKVwiLGZsYWdzKTt2YXIgcm5kPShcIlwiK01hdGgucmFuZG9tKCkpLnN1YnN0cigyKTt2YXIgc3RhcnRUb2tlbj1cIiUlc1wiK3JuZCtcIiUlXCI7dmFyIGVuZFRva2VuPVwiJSVlXCIrcm5kK1wiJSVcIjtsb2dFbnRyeUNvbnRlbnQ9bG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZS5yZXBsYWNlKGNhcHR1cmluZ1JlZ2V4LHN0YXJ0VG9rZW4rXCIkMVwiK2VuZFRva2VuKTtsb2dFbnRyeUNvbnRlbnQ9ZXNjYXBlSHRtbChsb2dFbnRyeUNvbnRlbnQpO3ZhciByZXN1bHQ7dmFyIHNlYXJjaFN0cmluZz1sb2dFbnRyeUNvbnRlbnQ7bG9nRW50cnlDb250ZW50PVwiXCI7d3JhcHBlZExvZ0VudHJ5Q29udGVudD1cIlwiO3doaWxlKChzZWFyY2hJbmRleD1zZWFyY2hTdHJpbmcuaW5kZXhPZihzdGFydFRva2VuLHN0YXJ0SW5kZXgpKT4tMSl7dmFyIGVuZFRva2VuSW5kZXg9c2VhcmNoU3RyaW5nLmluZGV4T2YoZW5kVG9rZW4sc2VhcmNoSW5kZXgpO21hdGNoZWRUZXh0PXNlYXJjaFN0cmluZy5zdWJzdHJpbmcoc2VhcmNoSW5kZXgrc3RhcnRUb2tlbi5sZW5ndGgsZW5kVG9rZW5JbmRleCk7dGV4dEJlZm9yZU1hdGNoPXNlYXJjaFN0cmluZy5zdWJzdHJpbmcoc3RhcnRJbmRleCxzZWFyY2hJbmRleCk7bG9nRW50cnlDb250ZW50Kz1wcmVTdGFydFRhZyt0ZXh0QmVmb3JlTWF0Y2grcHJlRW5kVGFnO2xvZ0VudHJ5Q29udGVudCs9c2VhcmNoVGVybVJlcGxhY2VtZW50U3RhcnRUYWcrcHJlU3RhcnRUYWcrbWF0Y2hlZFRleHQrJywncHJlRW5kVGFnK3NlYXJjaFRlcm1SZXBsYWNlbWVudEVuZFRhZztpZihpc0llKXt3cmFwcGVkTG9nRW50cnlDb250ZW50Kz10ZXh0QmVmb3JlTWF0Y2grc2VhcmNoVGVybVJlcGxhY2VtZW50U3RhcnRUYWcrJywnbWF0Y2hlZFRleHQrc2VhcmNoVGVybVJlcGxhY2VtZW50RW5kVGFnO30nLCdzdGFydEluZGV4PWVuZFRva2VuSW5kZXgrZW5kVG9rZW4ubGVuZ3RoO30nLCdsb2dFbnRyeUNvbnRlbnQrPXByZVN0YXJ0VGFnK3NlYXJjaFN0cmluZy5zdWJzdHIoc3RhcnRJbmRleCkrcHJlRW5kVGFnO2lmKGlzSWUpe3dyYXBwZWRMb2dFbnRyeUNvbnRlbnQrPXNlYXJjaFN0cmluZy5zdWJzdHIoc3RhcnRJbmRleCk7fX1lbHNle2xvZ0VudHJ5Q29udGVudD1cIlwiO3dyYXBwZWRMb2dFbnRyeUNvbnRlbnQ9XCJcIjt2YXIgc2VhcmNoVGVybVJlcGxhY2VtZW50TGVuZ3RoPXNlYXJjaFRlcm1SZXBsYWNlbWVudFN0YXJ0VGFnLmxlbmd0aCsnLCd0aGlzLnNlYXJjaFRlcm0ubGVuZ3RoK3NlYXJjaFRlcm1SZXBsYWNlbWVudEVuZFRhZy5sZW5ndGg7dmFyIHNlYXJjaFRlcm1MZW5ndGg9dGhpcy5zZWFyY2hUZXJtLmxlbmd0aDt2YXIgc2VhcmNoVGVybUxvd2VyQ2FzZT10aGlzLnNlYXJjaFRlcm0udG9Mb3dlckNhc2UoKTt2YXIgbG9nVGV4dExvd2VyQ2FzZT1sb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlLnRvTG93ZXJDYXNlKCk7d2hpbGUoKHNlYXJjaEluZGV4PWxvZ1RleHRMb3dlckNhc2UuaW5kZXhPZihzZWFyY2hUZXJtTG93ZXJDYXNlLHN0YXJ0SW5kZXgpKT4tMSl7bWF0Y2hlZFRleHQ9ZXNjYXBlSHRtbChsb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlLnN1YnN0cihzZWFyY2hJbmRleCx0aGlzLnNlYXJjaFRlcm0ubGVuZ3RoKSk7dGV4dEJlZm9yZU1hdGNoPWVzY2FwZUh0bWwobG9nRW50cnkuZm9ybWF0dGVkTWVzc2FnZS5zdWJzdHJpbmcoc3RhcnRJbmRleCxzZWFyY2hJbmRleCkpO3ZhciBzZWFyY2hUZXJtUmVwbGFjZW1lbnQ9c2VhcmNoVGVybVJlcGxhY2VtZW50U3RhcnRUYWcrJywncHJlU3RhcnRUYWcrbWF0Y2hlZFRleHQrcHJlRW5kVGFnK3NlYXJjaFRlcm1SZXBsYWNlbWVudEVuZFRhZztsb2dFbnRyeUNvbnRlbnQrPXByZVN0YXJ0VGFnK3RleHRCZWZvcmVNYXRjaCtwcmVFbmRUYWcrc2VhcmNoVGVybVJlcGxhY2VtZW50O2lmKGlzSWUpe3dyYXBwZWRMb2dFbnRyeUNvbnRlbnQrPXRleHRCZWZvcmVNYXRjaCtzZWFyY2hUZXJtUmVwbGFjZW1lbnRTdGFydFRhZysnLCdtYXRjaGVkVGV4dCtzZWFyY2hUZXJtUmVwbGFjZW1lbnRFbmRUYWc7fScsJ3N0YXJ0SW5kZXg9c2VhcmNoSW5kZXgrc2VhcmNoVGVybUxlbmd0aDt9JywndmFyIHRleHRBZnRlckxhc3RNYXRjaD1lc2NhcGVIdG1sKGxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2Uuc3Vic3RyKHN0YXJ0SW5kZXgpKTtsb2dFbnRyeUNvbnRlbnQrPXByZVN0YXJ0VGFnK3RleHRBZnRlckxhc3RNYXRjaCtwcmVFbmRUYWc7aWYoaXNJZSl7d3JhcHBlZExvZ0VudHJ5Q29udGVudCs9dGV4dEFmdGVyTGFzdE1hdGNoO319JywnbG9nRW50cnkuc2V0Q29udGVudChsb2dFbnRyeUNvbnRlbnQsd3JhcHBlZExvZ0VudHJ5Q29udGVudCk7dmFyIGxvZ0VudHJ5TWF0Y2hlcz1sb2dFbnRyeS5nZXRTZWFyY2hNYXRjaGVzKCk7dGhpcy5tYXRjaGVzPXRoaXMubWF0Y2hlcy5jb25jYXQobG9nRW50cnlNYXRjaGVzKTt9ZWxzZXtsb2dFbnRyeS5zZXRTZWFyY2hNYXRjaChmYWxzZSk7bG9nRW50cnkuc2V0Q29udGVudChsb2dFbnRyeS5mb3JtYXR0ZWRNZXNzYWdlLGxvZ0VudHJ5LmZvcm1hdHRlZE1lc3NhZ2UpO30nLCdyZXR1cm4gZG9lc01hdGNoO30scmVtb3ZlTWF0Y2hlczpmdW5jdGlvbihsb2dFbnRyaWVzKXt2YXIgbWF0Y2hlc1RvUmVtb3ZlQ291bnQ9MDt2YXIgY3VycmVudE1hdGNoUmVtb3ZlZD1mYWxzZTt2YXIgbWF0Y2hlc1RvUmVtb3ZlPVtdO3ZhciBpLGlMZW4saixqTGVuO2ZvcihpPTAsaUxlbj10aGlzLm1hdGNoZXMubGVuZ3RoO2k8aUxlbjtpKyspe2ZvcihqPTAsakxlbj1sb2dFbnRyaWVzLmxlbmd0aDtqPGpMZW47aisrKXtpZih0aGlzLm1hdGNoZXNbaV0uYmVsb25nc1RvKGxvZ0VudHJpZXNbal0pKXttYXRjaGVzVG9SZW1vdmUucHVzaCh0aGlzLm1hdGNoZXNbaV0pO2lmKGk9PT1jdXJyZW50TWF0Y2hJbmRleCl7Y3VycmVudE1hdGNoUmVtb3ZlZD10cnVlO319fX0nLCd2YXIgbmV3TWF0Y2g9Y3VycmVudE1hdGNoUmVtb3ZlZD9udWxsOnRoaXMubWF0Y2hlc1tjdXJyZW50TWF0Y2hJbmRleF07aWYoY3VycmVudE1hdGNoUmVtb3ZlZCl7Zm9yKGk9Y3VycmVudE1hdGNoSW5kZXgsaUxlbj10aGlzLm1hdGNoZXMubGVuZ3RoO2k8aUxlbjtpKyspe2lmKHRoaXMubWF0Y2hlc1tpXS5pc1Zpc2libGUoKSYmIWFycmF5X2NvbnRhaW5zKG1hdGNoZXNUb1JlbW92ZSx0aGlzLm1hdGNoZXNbaV0pKXtuZXdNYXRjaD10aGlzLm1hdGNoZXNbaV07YnJlYWs7fX19JywnZm9yKGk9MCxpTGVuPW1hdGNoZXNUb1JlbW92ZS5sZW5ndGg7aTxpTGVuO2krKyl7YXJyYXlfcmVtb3ZlKHRoaXMubWF0Y2hlcyxtYXRjaGVzVG9SZW1vdmVbaV0pO21hdGNoZXNUb1JlbW92ZVtpXS5yZW1vdmUoKTt9JywnaWYodGhpcy5oYXNWaXNpYmxlTWF0Y2hlcygpKXtpZihuZXdNYXRjaD09PW51bGwpe3NldEN1cnJlbnRNYXRjaEluZGV4KDApO31lbHNle3ZhciBuZXdNYXRjaEluZGV4PTA7Zm9yKGk9MCxpTGVuPXRoaXMubWF0Y2hlcy5sZW5ndGg7aTxpTGVuO2krKyl7aWYobmV3TWF0Y2g9PT10aGlzLm1hdGNoZXNbaV0pe25ld01hdGNoSW5kZXg9aTticmVhazt9fScsJ3NldEN1cnJlbnRNYXRjaEluZGV4KG5ld01hdGNoSW5kZXgpO319ZWxzZXtjdXJyZW50TWF0Y2hJbmRleD1udWxsO2Rpc3BsYXlOb01hdGNoZXMoKTt9fX07ZnVuY3Rpb24gZ2V0UGFnZU9mZnNldFRvcChlbCxjb250YWluZXIpe3ZhciBjdXJyZW50RWw9ZWw7dmFyIHk9MDt3aGlsZShjdXJyZW50RWwmJmN1cnJlbnRFbCE9Y29udGFpbmVyKXt5Kz1jdXJyZW50RWwub2Zmc2V0VG9wO2N1cnJlbnRFbD1jdXJyZW50RWwub2Zmc2V0UGFyZW50O30nLCdyZXR1cm4geTt9JywnZnVuY3Rpb24gc2Nyb2xsSW50b1ZpZXcoZWwpe3ZhciBsb2dDb250YWluZXI9bG9nTWFpbkNvbnRhaW5lcjtpZighJChcIndyYXBcIikuY2hlY2tlZCl7dmFyIGxvZ0NvbnRhaW5lckxlZnQ9bG9nQ29udGFpbmVyLnNjcm9sbExlZnQ7dmFyIGxvZ0NvbnRhaW5lclJpZ2h0PWxvZ0NvbnRhaW5lckxlZnQrbG9nQ29udGFpbmVyLm9mZnNldFdpZHRoO3ZhciBlbExlZnQ9ZWwub2Zmc2V0TGVmdDt2YXIgZWxSaWdodD1lbExlZnQrZWwub2Zmc2V0V2lkdGg7aWYoZWxMZWZ0PGxvZ0NvbnRhaW5lckxlZnR8fGVsUmlnaHQ+bG9nQ29udGFpbmVyUmlnaHQpe2xvZ0NvbnRhaW5lci5zY3JvbGxMZWZ0PWVsTGVmdC0obG9nQ29udGFpbmVyLm9mZnNldFdpZHRoLWVsLm9mZnNldFdpZHRoKS8yO319JywndmFyIGxvZ0NvbnRhaW5lclRvcD1sb2dDb250YWluZXIuc2Nyb2xsVG9wO3ZhciBsb2dDb250YWluZXJCb3R0b209bG9nQ29udGFpbmVyVG9wK2xvZ0NvbnRhaW5lci5vZmZzZXRIZWlnaHQ7dmFyIGVsVG9wPWdldFBhZ2VPZmZzZXRUb3AoZWwpLWdldFRvb2xCYXJzSGVpZ2h0KCk7dmFyIGVsQm90dG9tPWVsVG9wK2VsLm9mZnNldEhlaWdodDtpZihlbFRvcDxsb2dDb250YWluZXJUb3B8fGVsQm90dG9tPmxvZ0NvbnRhaW5lckJvdHRvbSl7bG9nQ29udGFpbmVyLnNjcm9sbFRvcD1lbFRvcC0obG9nQ29udGFpbmVyLm9mZnNldEhlaWdodC1lbC5vZmZzZXRIZWlnaHQpLzI7fX0nLCdmdW5jdGlvbiBNYXRjaChsb2dFbnRyeUxldmVsLHNwYW5Jbk1haW5EaXYsc3BhbkluVW53cmFwcGVkUHJlLHNwYW5JbldyYXBwZWREaXYpe3RoaXMubG9nRW50cnlMZXZlbD1sb2dFbnRyeUxldmVsO3RoaXMuc3BhbkluTWFpbkRpdj1zcGFuSW5NYWluRGl2O2lmKGlzSWUpe3RoaXMuc3BhbkluVW53cmFwcGVkUHJlPXNwYW5JblVud3JhcHBlZFByZTt0aGlzLnNwYW5JbldyYXBwZWREaXY9c3BhbkluV3JhcHBlZERpdjt9JywndGhpcy5tYWluU3Bhbj1pc0llP3NwYW5JblVud3JhcHBlZFByZTpzcGFuSW5NYWluRGl2O30nLCdNYXRjaC5wcm90b3R5cGU9e2VxdWFsczpmdW5jdGlvbihtYXRjaCl7cmV0dXJuIHRoaXMubWFpblNwYW49PT1tYXRjaC5tYWluU3Bhbjt9LHNldEN1cnJlbnQ6ZnVuY3Rpb24oKXtpZihpc0llKXthZGRDbGFzcyh0aGlzLnNwYW5JblVud3JhcHBlZFByZSxcImN1cnJlbnRtYXRjaFwiKTthZGRDbGFzcyh0aGlzLnNwYW5JbldyYXBwZWREaXYsXCJjdXJyZW50bWF0Y2hcIik7dmFyIGVsZW1lbnRUb1Njcm9sbD0kKFwid3JhcFwiKS5jaGVja2VkP3RoaXMuc3BhbkluV3JhcHBlZERpdjp0aGlzLnNwYW5JblVud3JhcHBlZFByZTtzY3JvbGxJbnRvVmlldyhlbGVtZW50VG9TY3JvbGwpO31lbHNle2FkZENsYXNzKHRoaXMuc3BhbkluTWFpbkRpdixcImN1cnJlbnRtYXRjaFwiKTtzY3JvbGxJbnRvVmlldyh0aGlzLnNwYW5Jbk1haW5EaXYpO319LGJlbG9uZ3NUbzpmdW5jdGlvbihsb2dFbnRyeSl7aWYoaXNJZSl7cmV0dXJuIGlzRGVzY2VuZGFudCh0aGlzLnNwYW5JblVud3JhcHBlZFByZSxsb2dFbnRyeS51bndyYXBwZWRQcmUpO31lbHNle3JldHVybiBpc0Rlc2NlbmRhbnQodGhpcy5zcGFuSW5NYWluRGl2LGxvZ0VudHJ5Lm1haW5EaXYpO319LHNldE5vdEN1cnJlbnQ6ZnVuY3Rpb24oKXtpZihpc0llKXtyZW1vdmVDbGFzcyh0aGlzLnNwYW5JblVud3JhcHBlZFByZSxcImN1cnJlbnRtYXRjaFwiKTtyZW1vdmVDbGFzcyh0aGlzLnNwYW5JbldyYXBwZWREaXYsXCJjdXJyZW50bWF0Y2hcIik7fWVsc2V7cmVtb3ZlQ2xhc3ModGhpcy5zcGFuSW5NYWluRGl2LFwiY3VycmVudG1hdGNoXCIpO319LGlzT3JwaGFuOmZ1bmN0aW9uKCl7cmV0dXJuIGlzT3JwaGFuKHRoaXMubWFpblNwYW4pO30saXNWaXNpYmxlOmZ1bmN0aW9uKCl7cmV0dXJuIGdldENoZWNrQm94KHRoaXMubG9nRW50cnlMZXZlbCkuY2hlY2tlZDt9LHJlbW92ZTpmdW5jdGlvbigpe2lmKGlzSWUpe3RoaXMuc3BhbkluVW53cmFwcGVkUHJlPW51bGw7dGhpcy5zcGFuSW5XcmFwcGVkRGl2PW51bGw7fWVsc2V7dGhpcy5zcGFuSW5NYWluRGl2PW51bGw7fX19O3ZhciBjdXJyZW50U2VhcmNoPW51bGw7dmFyIGN1cnJlbnRNYXRjaEluZGV4PW51bGw7ZnVuY3Rpb24gZG9TZWFyY2goKXt2YXIgc2VhcmNoQm94PSQoXCJzZWFyY2hCb3hcIik7dmFyIHNlYXJjaFRlcm09c2VhcmNoQm94LnZhbHVlO3ZhciBpc1JlZ2V4PSQoXCJzZWFyY2hSZWdleFwiKS5jaGVja2VkO3ZhciBpc0Nhc2VTZW5zaXRpdmU9JChcInNlYXJjaENhc2VTZW5zaXRpdmVcIikuY2hlY2tlZDt2YXIgaTtpZihzZWFyY2hUZXJtPT09XCJcIil7JChcInNlYXJjaFJlc2V0XCIpLmRpc2FibGVkPXRydWU7JChcInNlYXJjaE5hdlwiKS5zdHlsZS5kaXNwbGF5PVwibm9uZVwiO3JlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksXCJzZWFyY2hpbmdcIik7cmVtb3ZlQ2xhc3Moc2VhcmNoQm94LFwiaGFzbWF0Y2hlc1wiKTtyZW1vdmVDbGFzcyhzZWFyY2hCb3gsXCJub21hdGNoZXNcIik7Zm9yKGk9MDtpPGxvZ0VudHJpZXMubGVuZ3RoO2krKyl7bG9nRW50cmllc1tpXS5jbGVhclNlYXJjaCgpO2xvZ0VudHJpZXNbaV0uc2V0Q29udGVudChsb2dFbnRyaWVzW2ldLmZvcm1hdHRlZE1lc3NhZ2UsbG9nRW50cmllc1tpXS5mb3JtYXR0ZWRNZXNzYWdlKTt9JywnY3VycmVudFNlYXJjaD1udWxsO3NldExvZ0NvbnRhaW5lckhlaWdodCgpO31lbHNleyQoXCJzZWFyY2hSZXNldFwiKS5kaXNhYmxlZD1mYWxzZTskKFwic2VhcmNoTmF2XCIpLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiO3ZhciBzZWFyY2hSZWdleDt2YXIgcmVnZXhWYWxpZDtpZihpc1JlZ2V4KXt0cnl7c2VhcmNoUmVnZXg9aXNDYXNlU2Vuc2l0aXZlP25ldyBSZWdFeHAoc2VhcmNoVGVybSxcImdcIik6bmV3IFJlZ0V4cChzZWFyY2hUZXJtLFwiZ2lcIik7cmVnZXhWYWxpZD10cnVlO3JlcGxhY2VDbGFzcyhzZWFyY2hCb3gsXCJ2YWxpZHJlZ2V4XCIsXCJpbnZhbGlkcmVnZXhcIik7c2VhcmNoQm94LnRpdGxlPVwiVmFsaWQgcmVnZXhcIjt9Y2F0Y2goZXgpe3JlZ2V4VmFsaWQ9ZmFsc2U7cmVwbGFjZUNsYXNzKHNlYXJjaEJveCxcImludmFsaWRyZWdleFwiLFwidmFsaWRyZWdleFwiKTtzZWFyY2hCb3gudGl0bGU9XCJJbnZhbGlkIHJlZ2V4OiBcIisoZXgubWVzc2FnZT9leC5tZXNzYWdlOihleC5kZXNjcmlwdGlvbj9leC5kZXNjcmlwdGlvbjpcInVua25vd24gZXJyb3JcIikpO3JldHVybjt9fWVsc2V7c2VhcmNoQm94LnRpdGxlPVwiXCI7cmVtb3ZlQ2xhc3Moc2VhcmNoQm94LFwidmFsaWRyZWdleFwiKTtyZW1vdmVDbGFzcyhzZWFyY2hCb3gsXCJpbnZhbGlkcmVnZXhcIik7fScsJ2FkZENsYXNzKGRvY3VtZW50LmJvZHksXCJzZWFyY2hpbmdcIik7Y3VycmVudFNlYXJjaD1uZXcgU2VhcmNoKHNlYXJjaFRlcm0saXNSZWdleCxzZWFyY2hSZWdleCxpc0Nhc2VTZW5zaXRpdmUpO2ZvcihpPTA7aTxsb2dFbnRyaWVzLmxlbmd0aDtpKyspe2N1cnJlbnRTZWFyY2guYXBwbHlUbyhsb2dFbnRyaWVzW2ldKTt9Jywnc2V0TG9nQ29udGFpbmVySGVpZ2h0KCk7aWYoY3VycmVudFNlYXJjaC5oYXNWaXNpYmxlTWF0Y2hlcygpKXtzZXRDdXJyZW50TWF0Y2hJbmRleCgwKTtkaXNwbGF5TWF0Y2hlcygpO31lbHNle2Rpc3BsYXlOb01hdGNoZXMoKTt9fX0nLCdmdW5jdGlvbiB1cGRhdGVTZWFyY2hGcm9tRmlsdGVycygpe2lmKGN1cnJlbnRTZWFyY2gpe2lmKGN1cnJlbnRTZWFyY2guaGFzTWF0Y2hlcygpKXtpZihjdXJyZW50TWF0Y2hJbmRleD09PW51bGwpe2N1cnJlbnRNYXRjaEluZGV4PTA7fScsJ3ZhciBjdXJyZW50TWF0Y2g9Y3VycmVudFNlYXJjaC5tYXRjaGVzW2N1cnJlbnRNYXRjaEluZGV4XTtpZihjdXJyZW50TWF0Y2guaXNWaXNpYmxlKCkpe2Rpc3BsYXlNYXRjaGVzKCk7c2V0Q3VycmVudE1hdGNoSW5kZXgoY3VycmVudE1hdGNoSW5kZXgpO31lbHNle2N1cnJlbnRNYXRjaC5zZXROb3RDdXJyZW50KCk7dmFyIG5leHRWaXNpYmxlTWF0Y2hJbmRleD1jdXJyZW50U2VhcmNoLmdldE5leHRWaXNpYmxlTWF0Y2hJbmRleCgpO2lmKG5leHRWaXNpYmxlTWF0Y2hJbmRleD4tMSl7c2V0Q3VycmVudE1hdGNoSW5kZXgobmV4dFZpc2libGVNYXRjaEluZGV4KTtkaXNwbGF5TWF0Y2hlcygpO31lbHNle2Rpc3BsYXlOb01hdGNoZXMoKTt9fX1lbHNle2Rpc3BsYXlOb01hdGNoZXMoKTt9fX0nLCdmdW5jdGlvbiByZWZyZXNoQ3VycmVudE1hdGNoKCl7aWYoY3VycmVudFNlYXJjaCYmY3VycmVudFNlYXJjaC5oYXNWaXNpYmxlTWF0Y2hlcygpKXtzZXRDdXJyZW50TWF0Y2hJbmRleChjdXJyZW50TWF0Y2hJbmRleCk7fX0nLCdmdW5jdGlvbiBkaXNwbGF5TWF0Y2hlcygpe3JlcGxhY2VDbGFzcygkKFwic2VhcmNoQm94XCIpLFwiaGFzbWF0Y2hlc1wiLFwibm9tYXRjaGVzXCIpOyQoXCJzZWFyY2hCb3hcIikudGl0bGU9XCJcIitjdXJyZW50U2VhcmNoLm1hdGNoZXMubGVuZ3RoK1wiIG1hdGNoZXMgZm91bmRcIjskKFwic2VhcmNoTmF2XCIpLnN0eWxlLmRpc3BsYXk9XCJibG9ja1wiO3NldExvZ0NvbnRhaW5lckhlaWdodCgpO30nLCdmdW5jdGlvbiBkaXNwbGF5Tm9NYXRjaGVzKCl7cmVwbGFjZUNsYXNzKCQoXCJzZWFyY2hCb3hcIiksXCJub21hdGNoZXNcIixcImhhc21hdGNoZXNcIik7JChcInNlYXJjaEJveFwiKS50aXRsZT1cIk5vIG1hdGNoZXMgZm91bmRcIjskKFwic2VhcmNoTmF2XCIpLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7c2V0TG9nQ29udGFpbmVySGVpZ2h0KCk7fScsJ2Z1bmN0aW9uIHRvZ2dsZVNlYXJjaEVuYWJsZWQoZW5hYmxlKXtlbmFibGU9KHR5cGVvZiBlbmFibGU9PVwidW5kZWZpbmVkXCIpPyEkKFwic2VhcmNoRGlzYWJsZVwiKS5jaGVja2VkOmVuYWJsZTskKFwic2VhcmNoQm94XCIpLmRpc2FibGVkPSFlbmFibGU7JChcInNlYXJjaFJlc2V0XCIpLmRpc2FibGVkPSFlbmFibGU7JChcInNlYXJjaFJlZ2V4XCIpLmRpc2FibGVkPSFlbmFibGU7JChcInNlYXJjaE5leHRcIikuZGlzYWJsZWQ9IWVuYWJsZTskKFwic2VhcmNoUHJldmlvdXNcIikuZGlzYWJsZWQ9IWVuYWJsZTskKFwic2VhcmNoQ2FzZVNlbnNpdGl2ZVwiKS5kaXNhYmxlZD0hZW5hYmxlOyQoXCJzZWFyY2hOYXZcIikuc3R5bGUuZGlzcGxheT0oZW5hYmxlJiYoJChcInNlYXJjaEJveFwiKS52YWx1ZSE9PVwiXCIpJiZjdXJyZW50U2VhcmNoJiZjdXJyZW50U2VhcmNoLmhhc1Zpc2libGVNYXRjaGVzKCkpP1wiYmxvY2tcIjpcIm5vbmVcIjtpZihlbmFibGUpe3JlbW92ZUNsYXNzKCQoXCJzZWFyY2hcIiksXCJncmV5ZWRvdXRcIik7YWRkQ2xhc3MoZG9jdW1lbnQuYm9keSxcInNlYXJjaGluZ1wiKTtpZigkKFwic2VhcmNoSGlnaGxpZ2h0XCIpLmNoZWNrZWQpe2FkZENsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hoaWdobGlnaHRcIik7fWVsc2V7cmVtb3ZlQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGhpZ2hsaWdodFwiKTt9JywnaWYoJChcInNlYXJjaEZpbHRlclwiKS5jaGVja2VkKXthZGRDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoZmlsdGVyXCIpO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hmaWx0ZXJcIik7fScsJyQoXCJzZWFyY2hEaXNhYmxlXCIpLmNoZWNrZWQ9IWVuYWJsZTt9ZWxzZXthZGRDbGFzcygkKFwic2VhcmNoXCIpLFwiZ3JleWVkb3V0XCIpO3JlbW92ZUNsYXNzKGRvY3VtZW50LmJvZHksXCJzZWFyY2hpbmdcIik7cmVtb3ZlQ2xhc3MobG9nTWFpbkNvbnRhaW5lcixcInNlYXJjaGhpZ2hsaWdodFwiKTtyZW1vdmVDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoZmlsdGVyXCIpO30nLCdzZXRMb2dDb250YWluZXJIZWlnaHQoKTt9JywnZnVuY3Rpb24gdG9nZ2xlU2VhcmNoRmlsdGVyKCl7dmFyIGVuYWJsZT0kKFwic2VhcmNoRmlsdGVyXCIpLmNoZWNrZWQ7aWYoZW5hYmxlKXthZGRDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoZmlsdGVyXCIpO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hmaWx0ZXJcIik7fScsJ3JlZnJlc2hDdXJyZW50TWF0Y2goKTt9JywnZnVuY3Rpb24gdG9nZ2xlU2VhcmNoSGlnaGxpZ2h0KCl7dmFyIGVuYWJsZT0kKFwic2VhcmNoSGlnaGxpZ2h0XCIpLmNoZWNrZWQ7aWYoZW5hYmxlKXthZGRDbGFzcyhsb2dNYWluQ29udGFpbmVyLFwic2VhcmNoaGlnaGxpZ2h0XCIpO31lbHNle3JlbW92ZUNsYXNzKGxvZ01haW5Db250YWluZXIsXCJzZWFyY2hoaWdobGlnaHRcIik7fX0nLCdmdW5jdGlvbiBjbGVhclNlYXJjaCgpeyQoXCJzZWFyY2hCb3hcIikudmFsdWU9XCJcIjtkb1NlYXJjaCgpO30nLCdmdW5jdGlvbiBzZWFyY2hOZXh0KCl7aWYoY3VycmVudFNlYXJjaCE9PW51bGwmJmN1cnJlbnRNYXRjaEluZGV4IT09bnVsbCl7Y3VycmVudFNlYXJjaC5tYXRjaGVzW2N1cnJlbnRNYXRjaEluZGV4XS5zZXROb3RDdXJyZW50KCk7dmFyIG5leHRNYXRjaEluZGV4PWN1cnJlbnRTZWFyY2guZ2V0TmV4dFZpc2libGVNYXRjaEluZGV4KCk7aWYobmV4dE1hdGNoSW5kZXg+Y3VycmVudE1hdGNoSW5kZXh8fGNvbmZpcm0oXCJSZWFjaGVkIHRoZSBlbmQgb2YgdGhlIHBhZ2UuIFN0YXJ0IGZyb20gdGhlIHRvcD9cIikpe3NldEN1cnJlbnRNYXRjaEluZGV4KG5leHRNYXRjaEluZGV4KTt9fX0nLCdmdW5jdGlvbiBzZWFyY2hQcmV2aW91cygpe2lmKGN1cnJlbnRTZWFyY2ghPT1udWxsJiZjdXJyZW50TWF0Y2hJbmRleCE9PW51bGwpe2N1cnJlbnRTZWFyY2gubWF0Y2hlc1tjdXJyZW50TWF0Y2hJbmRleF0uc2V0Tm90Q3VycmVudCgpO3ZhciBwcmV2aW91c01hdGNoSW5kZXg9Y3VycmVudFNlYXJjaC5nZXRQcmV2aW91c1Zpc2libGVNYXRjaEluZGV4KCk7aWYocHJldmlvdXNNYXRjaEluZGV4PGN1cnJlbnRNYXRjaEluZGV4fHxjb25maXJtKFwiUmVhY2hlZCB0aGUgc3RhcnQgb2YgdGhlIHBhZ2UuIENvbnRpbnVlIGZyb20gdGhlIGJvdHRvbT9cIikpe3NldEN1cnJlbnRNYXRjaEluZGV4KHByZXZpb3VzTWF0Y2hJbmRleCk7fX19JywnZnVuY3Rpb24gc2V0Q3VycmVudE1hdGNoSW5kZXgoaW5kZXgpe2N1cnJlbnRNYXRjaEluZGV4PWluZGV4O2N1cnJlbnRTZWFyY2gubWF0Y2hlc1tjdXJyZW50TWF0Y2hJbmRleF0uc2V0Q3VycmVudCgpO30nLCdmdW5jdGlvbiBhZGRDbGFzcyhlbCxjc3NDbGFzcyl7aWYoIWhhc0NsYXNzKGVsLGNzc0NsYXNzKSl7aWYoZWwuY2xhc3NOYW1lKXtlbC5jbGFzc05hbWUrPVwiIFwiK2Nzc0NsYXNzO31lbHNle2VsLmNsYXNzTmFtZT1jc3NDbGFzczt9fX0nLCdmdW5jdGlvbiBoYXNDbGFzcyhlbCxjc3NDbGFzcyl7aWYoZWwuY2xhc3NOYW1lKXt2YXIgY2xhc3NOYW1lcz1lbC5jbGFzc05hbWUuc3BsaXQoXCIgXCIpO3JldHVybiBhcnJheV9jb250YWlucyhjbGFzc05hbWVzLGNzc0NsYXNzKTt9JywncmV0dXJuIGZhbHNlO30nLCdmdW5jdGlvbiByZW1vdmVDbGFzcyhlbCxjc3NDbGFzcyl7aWYoaGFzQ2xhc3MoZWwsY3NzQ2xhc3MpKXt2YXIgZXhpc3RpbmdDbGFzc2VzPWVsLmNsYXNzTmFtZS5zcGxpdChcIiBcIik7dmFyIG5ld0NsYXNzZXM9W107Zm9yKHZhciBpPTAsbGVuPWV4aXN0aW5nQ2xhc3Nlcy5sZW5ndGg7aTxsZW47aSsrKXtpZihleGlzdGluZ0NsYXNzZXNbaV0hPWNzc0NsYXNzKXtuZXdDbGFzc2VzW25ld0NsYXNzZXMubGVuZ3RoXT1leGlzdGluZ0NsYXNzZXNbaV07fX0nLCdlbC5jbGFzc05hbWU9bmV3Q2xhc3Nlcy5qb2luKFwiIFwiKTt9fScsJ2Z1bmN0aW9uIHJlcGxhY2VDbGFzcyhlbCxuZXdDc3NDbGFzcyxvbGRDc3NDbGFzcyl7cmVtb3ZlQ2xhc3MoZWwsb2xkQ3NzQ2xhc3MpO2FkZENsYXNzKGVsLG5ld0Nzc0NsYXNzKTt9JywnZnVuY3Rpb24gZ2V0RWxlbWVudHNCeUNsYXNzKGVsLGNzc0NsYXNzLHRhZ05hbWUpe3ZhciBlbGVtZW50cz1lbC5nZXRFbGVtZW50c0J5VGFnTmFtZSh0YWdOYW1lKTt2YXIgbWF0Y2hlcz1bXTtmb3IodmFyIGk9MCxsZW49ZWxlbWVudHMubGVuZ3RoO2k8bGVuO2krKyl7aWYoaGFzQ2xhc3MoZWxlbWVudHNbaV0sY3NzQ2xhc3MpKXttYXRjaGVzLnB1c2goZWxlbWVudHNbaV0pO319JywncmV0dXJuIG1hdGNoZXM7fScsJ2Z1bmN0aW9uICQoaWQpe3JldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7fScsJ2Z1bmN0aW9uIGlzRGVzY2VuZGFudChub2RlLGFuY2VzdG9yTm9kZSl7d2hpbGUobm9kZSE9bnVsbCl7aWYobm9kZT09PWFuY2VzdG9yTm9kZSl7cmV0dXJuIHRydWU7fScsJ25vZGU9bm9kZS5wYXJlbnROb2RlO30nLCdyZXR1cm4gZmFsc2U7fScsJ2Z1bmN0aW9uIGlzT3JwaGFuKG5vZGUpe3ZhciBjdXJyZW50Tm9kZT1ub2RlO3doaWxlKGN1cnJlbnROb2RlKXtpZihjdXJyZW50Tm9kZT09ZG9jdW1lbnQuYm9keSl7cmV0dXJuIGZhbHNlO30nLCdjdXJyZW50Tm9kZT1jdXJyZW50Tm9kZS5wYXJlbnROb2RlO30nLCdyZXR1cm4gdHJ1ZTt9JywnZnVuY3Rpb24gZXNjYXBlSHRtbChzdHIpe3JldHVybiBzdHIucmVwbGFjZSgvJi9nLFwiJmFtcDtcIikucmVwbGFjZSgvWzxdL2csXCImbHQ7XCIpLnJlcGxhY2UoLz4vZyxcIiZndDtcIik7fScsJ2Z1bmN0aW9uIGdldFdpbmRvd1dpZHRoKCl7aWYod2luZG93LmlubmVyV2lkdGgpe3JldHVybiB3aW5kb3cuaW5uZXJXaWR0aDt9ZWxzZSBpZihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCl7cmV0dXJuIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aDt9ZWxzZSBpZihkb2N1bWVudC5ib2R5KXtyZXR1cm4gZG9jdW1lbnQuYm9keS5jbGllbnRXaWR0aDt9JywncmV0dXJuIDA7fScsJ2Z1bmN0aW9uIGdldFdpbmRvd0hlaWdodCgpe2lmKHdpbmRvdy5pbm5lckhlaWdodCl7cmV0dXJuIHdpbmRvdy5pbm5lckhlaWdodDt9ZWxzZSBpZihkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQmJmRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRIZWlnaHQpe3JldHVybiBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0O31lbHNlIGlmKGRvY3VtZW50LmJvZHkpe3JldHVybiBkb2N1bWVudC5ib2R5LmNsaWVudEhlaWdodDt9JywncmV0dXJuIDA7fScsJ2Z1bmN0aW9uIGdldFRvb2xCYXJzSGVpZ2h0KCl7cmV0dXJuICQoXCJzd2l0Y2hlc1wiKS5vZmZzZXRIZWlnaHQ7fScsJ2Z1bmN0aW9uIGdldENocm9tZUhlaWdodCgpe3ZhciBoZWlnaHQ9Z2V0VG9vbEJhcnNIZWlnaHQoKTtpZihzaG93Q29tbWFuZExpbmUpe2hlaWdodCs9JChcImNvbW1hbmRMaW5lXCIpLm9mZnNldEhlaWdodDt9JywncmV0dXJuIGhlaWdodDt9JywnZnVuY3Rpb24gc2V0TG9nQ29udGFpbmVySGVpZ2h0KCl7aWYobG9nTWFpbkNvbnRhaW5lcil7dmFyIHdpbmRvd0hlaWdodD1nZXRXaW5kb3dIZWlnaHQoKTskKFwiYm9keVwiKS5zdHlsZS5oZWlnaHQ9Z2V0V2luZG93SGVpZ2h0KCkrXCJweFwiO2xvZ01haW5Db250YWluZXIuc3R5bGUuaGVpZ2h0PVwiXCIrJywnTWF0aC5tYXgoMCx3aW5kb3dIZWlnaHQtZ2V0Q2hyb21lSGVpZ2h0KCkpK1wicHhcIjt9fScsJ2Z1bmN0aW9uIHNldENvbW1hbmRJbnB1dFdpZHRoKCl7aWYoc2hvd0NvbW1hbmRMaW5lKXskKFwiY29tbWFuZFwiKS5zdHlsZS53aWR0aD1cIlwiK01hdGgubWF4KDAsJChcImNvbW1hbmRMaW5lQ29udGFpbmVyXCIpLm9mZnNldFdpZHRoLScsJygkKFwiZXZhbHVhdGVCdXR0b25cIikub2Zmc2V0V2lkdGgrMTMpKStcInB4XCI7fX0nLCd3aW5kb3cub25yZXNpemU9ZnVuY3Rpb24oKXtzZXRDb21tYW5kSW5wdXRXaWR0aCgpO3NldExvZ0NvbnRhaW5lckhlaWdodCgpO307aWYoIUFycmF5LnByb3RvdHlwZS5wdXNoKXtBcnJheS5wcm90b3R5cGUucHVzaD1mdW5jdGlvbigpe2Zvcih2YXIgaT0wLGxlbj1hcmd1bWVudHMubGVuZ3RoO2k8bGVuO2krKyl7dGhpc1t0aGlzLmxlbmd0aF09YXJndW1lbnRzW2ldO30nLCdyZXR1cm4gdGhpcy5sZW5ndGg7fTt9JywnaWYoIUFycmF5LnByb3RvdHlwZS5wb3Ape0FycmF5LnByb3RvdHlwZS5wb3A9ZnVuY3Rpb24oKXtpZih0aGlzLmxlbmd0aD4wKXt2YXIgdmFsPXRoaXNbdGhpcy5sZW5ndGgtMV07dGhpcy5sZW5ndGg9dGhpcy5sZW5ndGgtMTtyZXR1cm4gdmFsO319O30nLCdpZighQXJyYXkucHJvdG90eXBlLnNoaWZ0KXtBcnJheS5wcm90b3R5cGUuc2hpZnQ9ZnVuY3Rpb24oKXtpZih0aGlzLmxlbmd0aD4wKXt2YXIgZmlyc3RJdGVtPXRoaXNbMF07Zm9yKHZhciBpPTAsbGVuPXRoaXMubGVuZ3RoLTE7aTxsZW47aSsrKXt0aGlzW2ldPXRoaXNbaSsxXTt9JywndGhpcy5sZW5ndGg9dGhpcy5sZW5ndGgtMTtyZXR1cm4gZmlyc3RJdGVtO319O30nLCdpZighQXJyYXkucHJvdG90eXBlLnNwbGljZSl7QXJyYXkucHJvdG90eXBlLnNwbGljZT1mdW5jdGlvbihzdGFydEluZGV4LGRlbGV0ZUNvdW50KXt2YXIgaXRlbXNBZnRlckRlbGV0ZWQ9dGhpcy5zbGljZShzdGFydEluZGV4K2RlbGV0ZUNvdW50KTt2YXIgaXRlbXNEZWxldGVkPXRoaXMuc2xpY2Uoc3RhcnRJbmRleCxzdGFydEluZGV4K2RlbGV0ZUNvdW50KTt0aGlzLmxlbmd0aD1zdGFydEluZGV4O3ZhciBhcmd1bWVudHNBcnJheT1bXTtmb3IodmFyIGk9MCxsZW49YXJndW1lbnRzLmxlbmd0aDtpPGxlbjtpKyspe2FyZ3VtZW50c0FycmF5W2ldPWFyZ3VtZW50c1tpXTt9JywndmFyIGl0ZW1zVG9BcHBlbmQ9KGFyZ3VtZW50c0FycmF5Lmxlbmd0aD4yKT9pdGVtc0FmdGVyRGVsZXRlZD1hcmd1bWVudHNBcnJheS5zbGljZSgyKS5jb25jYXQoaXRlbXNBZnRlckRlbGV0ZWQpOml0ZW1zQWZ0ZXJEZWxldGVkO2ZvcihpPTAsbGVuPWl0ZW1zVG9BcHBlbmQubGVuZ3RoO2k8bGVuO2krKyl7dGhpcy5wdXNoKGl0ZW1zVG9BcHBlbmRbaV0pO30nLCdyZXR1cm4gaXRlbXNEZWxldGVkO307fScsJ2Z1bmN0aW9uIGFycmF5X3JlbW92ZShhcnIsdmFsKXt2YXIgaW5kZXg9LTE7Zm9yKHZhciBpPTAsbGVuPWFyci5sZW5ndGg7aTxsZW47aSsrKXtpZihhcnJbaV09PT12YWwpe2luZGV4PWk7YnJlYWs7fX0nLCdpZihpbmRleD49MCl7YXJyLnNwbGljZShpbmRleCwxKTtyZXR1cm4gaW5kZXg7fWVsc2V7cmV0dXJuIGZhbHNlO319JywnZnVuY3Rpb24gYXJyYXlfcmVtb3ZlRnJvbVN0YXJ0KGFycmF5LG51bWJlclRvUmVtb3ZlKXtpZihBcnJheS5wcm90b3R5cGUuc3BsaWNlKXthcnJheS5zcGxpY2UoMCxudW1iZXJUb1JlbW92ZSk7fWVsc2V7Zm9yKHZhciBpPW51bWJlclRvUmVtb3ZlLGxlbj1hcnJheS5sZW5ndGg7aTxsZW47aSsrKXthcnJheVtpLW51bWJlclRvUmVtb3ZlXT1hcnJheVtpXTt9JywnYXJyYXkubGVuZ3RoPWFycmF5Lmxlbmd0aC1udW1iZXJUb1JlbW92ZTt9JywncmV0dXJuIGFycmF5O30nLCdmdW5jdGlvbiBhcnJheV9jb250YWlucyhhcnIsdmFsKXtmb3IodmFyIGk9MCxsZW49YXJyLmxlbmd0aDtpPGxlbjtpKyspe2lmKGFycltpXT09dmFsKXtyZXR1cm4gdHJ1ZTt9fScsJ3JldHVybiBmYWxzZTt9JywnZnVuY3Rpb24gZ2V0RXJyb3JNZXNzYWdlKGV4KXtpZihleC5tZXNzYWdlKXtyZXR1cm4gZXgubWVzc2FnZTt9ZWxzZSBpZihleC5kZXNjcmlwdGlvbil7cmV0dXJuIGV4LmRlc2NyaXB0aW9uO30nLCdyZXR1cm5cIlwiK2V4O30nLCdmdW5jdGlvbiBtb3ZlQ2FyZXRUb0VuZChpbnB1dCl7aWYoaW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2Upe2lucHV0LmZvY3VzKCk7dmFyIGxlbmd0aD1pbnB1dC52YWx1ZS5sZW5ndGg7aW5wdXQuc2V0U2VsZWN0aW9uUmFuZ2UobGVuZ3RoLGxlbmd0aCk7fWVsc2UgaWYoaW5wdXQuY3JlYXRlVGV4dFJhbmdlKXt2YXIgcmFuZ2U9aW5wdXQuY3JlYXRlVGV4dFJhbmdlKCk7cmFuZ2UuY29sbGFwc2UoZmFsc2UpO3JhbmdlLnNlbGVjdCgpO30nLCdpbnB1dC5mb2N1cygpO30nLCdmdW5jdGlvbiBzdG9wUHJvcGFnYXRpb24oZXZ0KXtpZihldnQuc3RvcFByb3BhZ2F0aW9uKXtldnQuc3RvcFByb3BhZ2F0aW9uKCk7fWVsc2UgaWYodHlwZW9mIGV2dC5jYW5jZWxCdWJibGUhPVwidW5kZWZpbmVkXCIpe2V2dC5jYW5jZWxCdWJibGU9dHJ1ZTt9fScsJ2Z1bmN0aW9uIGdldEV2ZW50KGV2dCl7cmV0dXJuIGV2dD9ldnQ6ZXZlbnQ7fScsJ2Z1bmN0aW9uIGdldFRhcmdldChldnQpe3JldHVybiBldnQudGFyZ2V0P2V2dC50YXJnZXQ6ZXZ0LnNyY0VsZW1lbnQ7fScsJ2Z1bmN0aW9uIGdldFJlbGF0ZWRUYXJnZXQoZXZ0KXtpZihldnQucmVsYXRlZFRhcmdldCl7cmV0dXJuIGV2dC5yZWxhdGVkVGFyZ2V0O31lbHNlIGlmKGV2dC5zcmNFbGVtZW50KXtzd2l0Y2goZXZ0LnR5cGUpe2Nhc2VcIm1vdXNlb3ZlclwiOnJldHVybiBldnQuZnJvbUVsZW1lbnQ7Y2FzZVwibW91c2VvdXRcIjpyZXR1cm4gZXZ0LnRvRWxlbWVudDtkZWZhdWx0OnJldHVybiBldnQuc3JjRWxlbWVudDt9fX0nLCdmdW5jdGlvbiBjYW5jZWxLZXlFdmVudChldnQpe2V2dC5yZXR1cm5WYWx1ZT1mYWxzZTtzdG9wUHJvcGFnYXRpb24oZXZ0KTt9JywnZnVuY3Rpb24gZXZhbENvbW1hbmRMaW5lKCl7dmFyIGV4cHI9JChcImNvbW1hbmRcIikudmFsdWU7ZXZhbENvbW1hbmQoZXhwcik7JChcImNvbW1hbmRcIikudmFsdWU9XCJcIjt9JywnZnVuY3Rpb24gZXZhbExhc3RDb21tYW5kKCl7aWYobGFzdENvbW1hbmQhPW51bGwpe2V2YWxDb21tYW5kKGxhc3RDb21tYW5kKTt9fScsJ3ZhciBsYXN0Q29tbWFuZD1udWxsO3ZhciBjb21tYW5kSGlzdG9yeT1bXTt2YXIgY3VycmVudENvbW1hbmRJbmRleD0wO2Z1bmN0aW9uIGV2YWxDb21tYW5kKGV4cHIpe2lmKGFwcGVuZGVyKXthcHBlbmRlci5ldmFsQ29tbWFuZEFuZEFwcGVuZChleHByKTt9ZWxzZXt2YXIgcHJlZml4PVwiPj4+IFwiK2V4cHIrXCJcXFxcclxcXFxuXCI7dHJ5e2xvZyhcIklORk9cIixwcmVmaXgrZXZhbChleHByKSk7fWNhdGNoKGV4KXtsb2coXCJFUlJPUlwiLHByZWZpeCtcIkVycm9yOiBcIitnZXRFcnJvck1lc3NhZ2UoZXgpKTt9fScsJ2lmKGV4cHIhPWNvbW1hbmRIaXN0b3J5W2NvbW1hbmRIaXN0b3J5Lmxlbmd0aC0xXSl7Y29tbWFuZEhpc3RvcnkucHVzaChleHByKTtpZihhcHBlbmRlcil7YXBwZW5kZXIuc3RvcmVDb21tYW5kSGlzdG9yeShjb21tYW5kSGlzdG9yeSk7fX0nLCdjdXJyZW50Q29tbWFuZEluZGV4PShleHByPT1jb21tYW5kSGlzdG9yeVtjdXJyZW50Q29tbWFuZEluZGV4XSk/Y3VycmVudENvbW1hbmRJbmRleCsxOmNvbW1hbmRIaXN0b3J5Lmxlbmd0aDtsYXN0Q29tbWFuZD1leHByO30nLCcvL11dPicsJzwvc2NyaXB0PicsJzxzdHlsZSB0eXBlPVwidGV4dC9jc3NcIj4nLCdib2R5e2JhY2tncm91bmQtY29sb3I6d2hpdGU7Y29sb3I6YmxhY2s7cGFkZGluZzowO21hcmdpbjowO2ZvbnQtZmFtaWx5OnRhaG9tYSx2ZXJkYW5hLGFyaWFsLGhlbHZldGljYSxzYW5zLXNlcmlmO292ZXJmbG93OmhpZGRlbn1kaXYjc3dpdGNoZXNDb250YWluZXIgaW5wdXR7bWFyZ2luLWJvdHRvbTowfWRpdi50b29sYmFye2JvcmRlci10b3A6c29saWQgI2ZmZmZmZiAxcHg7Ym9yZGVyLWJvdHRvbTpzb2xpZCAjYWNhODk5IDFweDtiYWNrZ3JvdW5kLWNvbG9yOiNmMWVmZTc7cGFkZGluZzozcHggNXB4O2ZvbnQtc2l6ZTo2OC43NSV9ZGl2LnRvb2xiYXIsZGl2I3NlYXJjaCBpbnB1dHtmb250LWZhbWlseTp0YWhvbWEsdmVyZGFuYSxhcmlhbCxoZWx2ZXRpY2Esc2Fucy1zZXJpZn1kaXYudG9vbGJhciBpbnB1dC5idXR0b257cGFkZGluZzowIDVweDtmb250LXNpemU6MTAwJX1kaXYudG9vbGJhciBpbnB1dC5oaWRkZW57ZGlzcGxheTpub25lfWRpdiNzd2l0Y2hlcyBpbnB1dCNjbGVhckJ1dHRvbnttYXJnaW4tbGVmdDoyMHB4fWRpdiNsZXZlbHMgbGFiZWx7Zm9udC13ZWlnaHQ6Ym9sZH1kaXYjbGV2ZWxzIGxhYmVsLGRpdiNvcHRpb25zIGxhYmVse21hcmdpbi1yaWdodDo1cHh9ZGl2I2xldmVscyBsYWJlbCN3cmFwTGFiZWx7Zm9udC13ZWlnaHQ6bm9ybWFsfWRpdiNzZWFyY2ggbGFiZWx7bWFyZ2luLXJpZ2h0OjEwcHh9ZGl2I3NlYXJjaCBsYWJlbC5zZWFyY2hib3hsYWJlbHttYXJnaW4tcmlnaHQ6MH1kaXYjc2VhcmNoIGlucHV0e2ZvbnQtc2l6ZToxMDAlfWRpdiNzZWFyY2ggaW5wdXQudmFsaWRyZWdleHtjb2xvcjpncmVlbn1kaXYjc2VhcmNoIGlucHV0LmludmFsaWRyZWdleHtjb2xvcjpyZWR9ZGl2I3NlYXJjaCBpbnB1dC5ub21hdGNoZXN7Y29sb3I6d2hpdGU7YmFja2dyb3VuZC1jb2xvcjojZmY2NjY2fWRpdiNzZWFyY2ggaW5wdXQubm9tYXRjaGVze2NvbG9yOndoaXRlO2JhY2tncm91bmQtY29sb3I6I2ZmNjY2Nn1kaXYjc2VhcmNoTmF2e2Rpc3BsYXk6bm9uZX1kaXYjY29tbWFuZExpbmV7ZGlzcGxheTpub25lfWRpdiNjb21tYW5kTGluZSBpbnB1dCNjb21tYW5ke2ZvbnQtc2l6ZToxMDAlO2ZvbnQtZmFtaWx5OkNvdXJpZXIgTmV3LENvdXJpZXJ9ZGl2I2NvbW1hbmRMaW5lIGlucHV0I2V2YWx1YXRlQnV0dG9ue30qLmdyZXllZG91dHtjb2xvcjpncmF5ICFpbXBvcnRhbnQ7Ym9yZGVyLWNvbG9yOmdyYXkgIWltcG9ydGFudH0qLmdyZXllZG91dCAqLmFsd2F5c2VuYWJsZWR7Y29sb3I6YmxhY2t9Ki51bnNlbGVjdGFibGV7LWtodG1sLXVzZXItc2VsZWN0Om5vbmU7LW1vei11c2VyLXNlbGVjdDpub25lO3VzZXItc2VsZWN0Om5vbmV9ZGl2I2xvZ3tmb250LWZhbWlseTpDb3VyaWVyIE5ldyxDb3VyaWVyO2ZvbnQtc2l6ZTo3NSU7d2lkdGg6MTAwJTtvdmVyZmxvdzphdXRvO2NsZWFyOmJvdGg7cG9zaXRpb246cmVsYXRpdmV9ZGl2Lmdyb3Vwe2JvcmRlci1jb2xvcjojY2NjY2NjO2JvcmRlci1zdHlsZTpzb2xpZDtib3JkZXItd2lkdGg6MXB4IDAgMXB4IDFweDtvdmVyZmxvdzp2aXNpYmxlfWRpdi5vbGRJZSBkaXYuZ3JvdXAsZGl2Lm9sZEllIGRpdi5ncm91cCAqLGRpdi5vbGRJZSAqLmxvZ2VudHJ5e2hlaWdodDoxJX1kaXYuZ3JvdXAgZGl2Lmdyb3VwaGVhZGluZyBzcGFuLmV4cGFuZGVye2JvcmRlcjpzb2xpZCBibGFjayAxcHg7Zm9udC1mYW1pbHk6Q291cmllciBOZXcsQ291cmllcjtmb250LXNpemU6MC44MzNlbTtiYWNrZ3JvdW5kLWNvbG9yOiNlZWVlZWU7cG9zaXRpb246cmVsYXRpdmU7dG9wOi0xcHg7Y29sb3I6YmxhY2s7cGFkZGluZzowIDJweDtjdXJzb3I6cG9pbnRlcjtjdXJzb3I6aGFuZDtoZWlnaHQ6MSV9ZGl2Lmdyb3VwIGRpdi5ncm91cGNvbnRlbnR7bWFyZ2luLWxlZnQ6MTBweDtwYWRkaW5nLWJvdHRvbToycHg7b3ZlcmZsb3c6dmlzaWJsZX1kaXYuZ3JvdXAgZGl2LmV4cGFuZGVke2Rpc3BsYXk6YmxvY2t9ZGl2Lmdyb3VwIGRpdi5jb2xsYXBzZWR7ZGlzcGxheTpub25lfSoubG9nZW50cnl7b3ZlcmZsb3c6dmlzaWJsZTtkaXNwbGF5Om5vbmU7d2hpdGUtc3BhY2U6cHJlfXNwYW4ucHJle3doaXRlLXNwYWNlOnByZX1wcmUudW53cmFwcGVke2Rpc3BsYXk6aW5saW5lICFpbXBvcnRhbnR9cHJlLnVud3JhcHBlZCBwcmUucHJlLGRpdi53cmFwcGVkIHByZS5wcmV7ZGlzcGxheTppbmxpbmV9ZGl2LndyYXBwZWQgcHJlLnByZXt3aGl0ZS1zcGFjZTpub3JtYWx9ZGl2LndyYXBwZWR7ZGlzcGxheTpub25lfWJvZHkuc2VhcmNoaW5nICoubG9nZW50cnkgc3Bhbi5jdXJyZW50bWF0Y2h7Y29sb3I6d2hpdGUgIWltcG9ydGFudDtiYWNrZ3JvdW5kLWNvbG9yOmdyZWVuICFpbXBvcnRhbnR9Ym9keS5zZWFyY2hpbmcgZGl2LnNlYXJjaGhpZ2hsaWdodCAqLmxvZ2VudHJ5IHNwYW4uc2VhcmNodGVybXtjb2xvcjpibGFjaztiYWNrZ3JvdW5kLWNvbG9yOnllbGxvd31kaXYud3JhcCAqLmxvZ2VudHJ5e3doaXRlLXNwYWNlOm5vcm1hbCAhaW1wb3J0YW50O2JvcmRlci13aWR0aDowIDAgMXB4IDA7Ym9yZGVyLWNvbG9yOiNkZGRkZGQ7Ym9yZGVyLXN0eWxlOmRvdHRlZH1kaXYud3JhcCAjbG9nX3dyYXBwZWQsI2xvZ191bndyYXBwZWR7ZGlzcGxheTpibG9ja31kaXYud3JhcCAjbG9nX3Vud3JhcHBlZCwjbG9nX3dyYXBwZWR7ZGlzcGxheTpub25lfWRpdi53cmFwICoubG9nZW50cnkgc3Bhbi5wcmV7b3ZlcmZsb3c6dmlzaWJsZTt3aGl0ZS1zcGFjZTpub3JtYWx9ZGl2LndyYXAgKi5sb2dlbnRyeSBwcmUudW53cmFwcGVke2Rpc3BsYXk6bm9uZX1kaXYud3JhcCAqLmxvZ2VudHJ5IHNwYW4ud3JhcHBlZHtkaXNwbGF5OmlubGluZX1kaXYuc2VhcmNoZmlsdGVyICouc2VhcmNobm9ubWF0Y2h7ZGlzcGxheTpub25lICFpbXBvcnRhbnR9ZGl2I2xvZyAqLlRSQUNFLGxhYmVsI2xhYmVsX1RSQUNFe2NvbG9yOiM2NjY2NjZ9ZGl2I2xvZyAqLkRFQlVHLGxhYmVsI2xhYmVsX0RFQlVHe2NvbG9yOmdyZWVufWRpdiNsb2cgKi5JTkZPLGxhYmVsI2xhYmVsX0lORk97Y29sb3I6IzAwMDA5OX1kaXYjbG9nICouV0FSTixsYWJlbCNsYWJlbF9XQVJOe2NvbG9yOiM5OTk5MDB9ZGl2I2xvZyAqLkVSUk9SLGxhYmVsI2xhYmVsX0VSUk9Se2NvbG9yOnJlZH1kaXYjbG9nICouRkFUQUwsbGFiZWwjbGFiZWxfRkFUQUx7Y29sb3I6IzY2MDA2Nn1kaXYuVFJBQ0UjbG9nICouVFJBQ0UsZGl2LkRFQlVHI2xvZyAqLkRFQlVHLGRpdi5JTkZPI2xvZyAqLklORk8sZGl2LldBUk4jbG9nICouV0FSTixkaXYuRVJST1IjbG9nICouRVJST1IsZGl2LkZBVEFMI2xvZyAqLkZBVEFMe2Rpc3BsYXk6YmxvY2t9ZGl2I2xvZyBkaXYuc2VwYXJhdG9ye2JhY2tncm91bmQtY29sb3I6I2NjY2NjYzttYXJnaW46NXB4IDA7bGluZS1oZWlnaHQ6MXB4fScsJzwvc3R5bGU+JywnPC9oZWFkPicsJzxib2R5IGlkPVwiYm9keVwiPicsJzxkaXYgaWQ9XCJzd2l0Y2hlc0NvbnRhaW5lclwiPicsJzxkaXYgaWQ9XCJzd2l0Y2hlc1wiPicsJzxkaXYgaWQ9XCJsZXZlbHNcIiBjbGFzcz1cInRvb2xiYXJcIj4nLCdGaWx0ZXJzOicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9UUkFDRVwiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgdHJhY2UgbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfVFJBQ0VcIiBpZD1cImxhYmVsX1RSQUNFXCI+dHJhY2U8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9ERUJVR1wiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgZGVidWcgbWVzc2FnZXNcIiAvPjxsYWJlbCBmb3I9XCJzd2l0Y2hfREVCVUdcIiBpZD1cImxhYmVsX0RFQlVHXCI+ZGVidWc8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInN3aXRjaF9JTkZPXCIgb25jbGljaz1cImFwcGx5RmlsdGVycygpOyBjaGVja0FsbExldmVscygpXCIgY2hlY2tlZD1cImNoZWNrZWRcIiB0aXRsZT1cIlNob3cvaGlkZSBpbmZvIG1lc3NhZ2VzXCIgLz48bGFiZWwgZm9yPVwic3dpdGNoX0lORk9cIiBpZD1cImxhYmVsX0lORk9cIj5pbmZvPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzd2l0Y2hfV0FSTlwiIG9uY2xpY2s9XCJhcHBseUZpbHRlcnMoKTsgY2hlY2tBbGxMZXZlbHMoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJTaG93L2hpZGUgd2FybiBtZXNzYWdlc1wiIC8+PGxhYmVsIGZvcj1cInN3aXRjaF9XQVJOXCIgaWQ9XCJsYWJlbF9XQVJOXCI+d2FybjwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic3dpdGNoX0VSUk9SXCIgb25jbGljaz1cImFwcGx5RmlsdGVycygpOyBjaGVja0FsbExldmVscygpXCIgY2hlY2tlZD1cImNoZWNrZWRcIiB0aXRsZT1cIlNob3cvaGlkZSBlcnJvciBtZXNzYWdlc1wiIC8+PGxhYmVsIGZvcj1cInN3aXRjaF9FUlJPUlwiIGlkPVwibGFiZWxfRVJST1JcIj5lcnJvcjwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic3dpdGNoX0ZBVEFMXCIgb25jbGljaz1cImFwcGx5RmlsdGVycygpOyBjaGVja0FsbExldmVscygpXCIgY2hlY2tlZD1cImNoZWNrZWRcIiB0aXRsZT1cIlNob3cvaGlkZSBmYXRhbCBtZXNzYWdlc1wiIC8+PGxhYmVsIGZvcj1cInN3aXRjaF9GQVRBTFwiIGlkPVwibGFiZWxfRkFUQUxcIj5mYXRhbDwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic3dpdGNoX0FMTFwiIG9uY2xpY2s9XCJ0b2dnbGVBbGxMZXZlbHMoKTsgYXBwbHlGaWx0ZXJzKClcIiBjaGVja2VkPVwiY2hlY2tlZFwiIHRpdGxlPVwiU2hvdy9oaWRlIGFsbCBtZXNzYWdlc1wiIC8+PGxhYmVsIGZvcj1cInN3aXRjaF9BTExcIiBpZD1cImxhYmVsX0FMTFwiPmFsbDwvbGFiZWw+JywnPC9kaXY+JywnPGRpdiBpZD1cInNlYXJjaFwiIGNsYXNzPVwidG9vbGJhclwiPicsJzxsYWJlbCBmb3I9XCJzZWFyY2hCb3hcIiBjbGFzcz1cInNlYXJjaGJveGxhYmVsXCI+U2VhcmNoOjwvbGFiZWw+IDxpbnB1dCB0eXBlPVwidGV4dFwiIGlkPVwic2VhcmNoQm94XCIgb25jbGljaz1cInRvZ2dsZVNlYXJjaEVuYWJsZWQodHJ1ZSlcIiBvbmtleXVwPVwic2NoZWR1bGVTZWFyY2goKVwiIHNpemU9XCIyMFwiIC8+JywnPGlucHV0IHR5cGU9XCJidXR0b25cIiBpZD1cInNlYXJjaFJlc2V0XCIgZGlzYWJsZWQ9XCJkaXNhYmxlZFwiIHZhbHVlPVwiUmVzZXRcIiBvbmNsaWNrPVwiY2xlYXJTZWFyY2goKVwiIGNsYXNzPVwiYnV0dG9uXCIgdGl0bGU9XCJSZXNldCB0aGUgc2VhcmNoXCIgLz4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJzZWFyY2hSZWdleFwiIG9uY2xpY2s9XCJkb1NlYXJjaCgpXCIgdGl0bGU9XCJJZiBjaGVja2VkLCBzZWFyY2ggaXMgdHJlYXRlZCBhcyBhIHJlZ3VsYXIgZXhwcmVzc2lvblwiIC8+PGxhYmVsIGZvcj1cInNlYXJjaFJlZ2V4XCI+UmVnZXg8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInNlYXJjaENhc2VTZW5zaXRpdmVcIiBvbmNsaWNrPVwiZG9TZWFyY2goKVwiIHRpdGxlPVwiSWYgY2hlY2tlZCwgc2VhcmNoIGlzIGNhc2Ugc2Vuc2l0aXZlXCIgLz48bGFiZWwgZm9yPVwic2VhcmNoQ2FzZVNlbnNpdGl2ZVwiPk1hdGNoIGNhc2U8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInNlYXJjaERpc2FibGVcIiBvbmNsaWNrPVwidG9nZ2xlU2VhcmNoRW5hYmxlZCgpXCIgdGl0bGU9XCJFbmFibGUvZGlzYWJsZSBzZWFyY2hcIiAvPjxsYWJlbCBmb3I9XCJzZWFyY2hEaXNhYmxlXCIgY2xhc3M9XCJhbHdheXNlbmFibGVkXCI+RGlzYWJsZTwvbGFiZWw+JywnPGRpdiBpZD1cInNlYXJjaE5hdlwiPicsJzxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJzZWFyY2hOZXh0XCIgZGlzYWJsZWQ9XCJkaXNhYmxlZFwiIHZhbHVlPVwiTmV4dFwiIG9uY2xpY2s9XCJzZWFyY2hOZXh0KClcIiBjbGFzcz1cImJ1dHRvblwiIHRpdGxlPVwiR28gdG8gdGhlIG5leHQgbWF0Y2hpbmcgbG9nIGVudHJ5XCIgLz4nLCc8aW5wdXQgdHlwZT1cImJ1dHRvblwiIGlkPVwic2VhcmNoUHJldmlvdXNcIiBkaXNhYmxlZD1cImRpc2FibGVkXCIgdmFsdWU9XCJQcmV2aW91c1wiIG9uY2xpY2s9XCJzZWFyY2hQcmV2aW91cygpXCIgY2xhc3M9XCJidXR0b25cIiB0aXRsZT1cIkdvIHRvIHRoZSBwcmV2aW91cyBtYXRjaGluZyBsb2cgZW50cnlcIiAvPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInNlYXJjaEZpbHRlclwiIG9uY2xpY2s9XCJ0b2dnbGVTZWFyY2hGaWx0ZXIoKVwiIHRpdGxlPVwiSWYgY2hlY2tlZCwgbm9uLW1hdGNoaW5nIGxvZyBlbnRyaWVzIGFyZSBmaWx0ZXJlZCBvdXRcIiAvPjxsYWJlbCBmb3I9XCJzZWFyY2hGaWx0ZXJcIj5GaWx0ZXI8L2xhYmVsPicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cInNlYXJjaEhpZ2hsaWdodFwiIG9uY2xpY2s9XCJ0b2dnbGVTZWFyY2hIaWdobGlnaHQoKVwiIHRpdGxlPVwiSGlnaGxpZ2h0IG1hdGNoZWQgc2VhcmNoIHRlcm1zXCIgLz48bGFiZWwgZm9yPVwic2VhcmNoSGlnaGxpZ2h0XCIgY2xhc3M9XCJhbHdheXNlbmFibGVkXCI+SGlnaGxpZ2h0IGFsbDwvbGFiZWw+JywnPC9kaXY+JywnPC9kaXY+JywnPGRpdiBpZD1cIm9wdGlvbnNcIiBjbGFzcz1cInRvb2xiYXJcIj4nLCdPcHRpb25zOicsJzxpbnB1dCB0eXBlPVwiY2hlY2tib3hcIiBpZD1cImVuYWJsZUxvZ2dpbmdcIiBvbmNsaWNrPVwidG9nZ2xlTG9nZ2luZ0VuYWJsZWQoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJFbmFibGUvZGlzYWJsZSBsb2dnaW5nXCIgLz48bGFiZWwgZm9yPVwiZW5hYmxlTG9nZ2luZ1wiIGlkPVwiZW5hYmxlTG9nZ2luZ0xhYmVsXCI+TG9nPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJ3cmFwXCIgb25jbGljaz1cInRvZ2dsZVdyYXAoKVwiIHRpdGxlPVwiRW5hYmxlIC8gZGlzYWJsZSB3b3JkIHdyYXBcIiAvPjxsYWJlbCBmb3I9XCJ3cmFwXCIgaWQ9XCJ3cmFwTGFiZWxcIj5XcmFwPC9sYWJlbD4nLCc8aW5wdXQgdHlwZT1cImNoZWNrYm94XCIgaWQ9XCJuZXdlc3RBdFRvcFwiIG9uY2xpY2s9XCJ0b2dnbGVOZXdlc3RBdFRvcCgpXCIgdGl0bGU9XCJJZiBjaGVja2VkLCBjYXVzZXMgbmV3ZXN0IG1lc3NhZ2VzIHRvIGFwcGVhciBhdCB0aGUgdG9wXCIgLz48bGFiZWwgZm9yPVwibmV3ZXN0QXRUb3BcIiBpZD1cIm5ld2VzdEF0VG9wTGFiZWxcIj5OZXdlc3QgYXQgdGhlIHRvcDwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJjaGVja2JveFwiIGlkPVwic2Nyb2xsVG9MYXRlc3RcIiBvbmNsaWNrPVwidG9nZ2xlU2Nyb2xsVG9MYXRlc3QoKVwiIGNoZWNrZWQ9XCJjaGVja2VkXCIgdGl0bGU9XCJJZiBjaGVja2VkLCB3aW5kb3cgYXV0b21hdGljYWxseSBzY3JvbGxzIHRvIGEgbmV3IG1lc3NhZ2Ugd2hlbiBpdCBpcyBhZGRlZFwiIC8+PGxhYmVsIGZvcj1cInNjcm9sbFRvTGF0ZXN0XCIgaWQ9XCJzY3JvbGxUb0xhdGVzdExhYmVsXCI+U2Nyb2xsIHRvIGxhdGVzdDwvbGFiZWw+JywnPGlucHV0IHR5cGU9XCJidXR0b25cIiBpZD1cImNsZWFyQnV0dG9uXCIgdmFsdWU9XCJDbGVhclwiIG9uY2xpY2s9XCJjbGVhckxvZygpXCIgY2xhc3M9XCJidXR0b25cIiB0aXRsZT1cIkNsZWFyIGFsbCBsb2cgbWVzc2FnZXNcIiAgLz4nLCc8aW5wdXQgdHlwZT1cImJ1dHRvblwiIGlkPVwiaGlkZUJ1dHRvblwiIHZhbHVlPVwiSGlkZVwiIG9uY2xpY2s9XCJoaWRlKClcIiBjbGFzcz1cImhpZGRlbiBidXR0b25cIiB0aXRsZT1cIkhpZGUgdGhlIGNvbnNvbGVcIiAvPicsJzxpbnB1dCB0eXBlPVwiYnV0dG9uXCIgaWQ9XCJjbG9zZUJ1dHRvblwiIHZhbHVlPVwiQ2xvc2VcIiBvbmNsaWNrPVwiY2xvc2VXaW5kb3coKVwiIGNsYXNzPVwiaGlkZGVuIGJ1dHRvblwiIHRpdGxlPVwiQ2xvc2UgdGhlIHdpbmRvd1wiIC8+JywnPC9kaXY+JywnPC9kaXY+JywnPC9kaXY+JywnPGRpdiBpZD1cImxvZ1wiIGNsYXNzPVwiVFJBQ0UgREVCVUcgSU5GTyBXQVJOIEVSUk9SIEZBVEFMXCI+PC9kaXY+JywnPGRpdiBpZD1cImNvbW1hbmRMaW5lXCIgY2xhc3M9XCJ0b29sYmFyXCI+JywnPGRpdiBpZD1cImNvbW1hbmRMaW5lQ29udGFpbmVyXCI+JywnPGlucHV0IHR5cGU9XCJ0ZXh0XCIgaWQ9XCJjb21tYW5kXCIgdGl0bGU9XCJFbnRlciBhIEphdmFTY3JpcHQgY29tbWFuZCBoZXJlIGFuZCBoaXQgcmV0dXJuIG9yIHByZXNzIFxcJ0V2YWx1YXRlXFwnXCIgLz4nLCc8aW5wdXQgdHlwZT1cImJ1dHRvblwiIGlkPVwiZXZhbHVhdGVCdXR0b25cIiB2YWx1ZT1cIkV2YWx1YXRlXCIgY2xhc3M9XCJidXR0b25cIiB0aXRsZT1cIkV2YWx1YXRlIHRoZSBjb21tYW5kXCIgb25jbGljaz1cImV2YWxDb21tYW5kTGluZSgpXCIgLz4nLCc8L2Rpdj4nLCc8L2Rpdj4nLCc8L2JvZHk+JywnPC9odG1sPicsJyddO307dmFyIGRlZmF1bHRDb21tYW5kTGluZUZ1bmN0aW9ucz1bXTtDb25zb2xlQXBwZW5kZXI9ZnVuY3Rpb24oKXt9O3ZhciBjb25zb2xlQXBwZW5kZXJJZENvdW50ZXI9MTtDb25zb2xlQXBwZW5kZXIucHJvdG90eXBlPW5ldyBBcHBlbmRlcigpO0NvbnNvbGVBcHBlbmRlci5wcm90b3R5cGUuY3JlYXRlPWZ1bmN0aW9uKGluUGFnZSxjb250YWluZXIsbGF6eUluaXQsaW5pdGlhbGx5TWluaW1pemVkLHVzZURvY3VtZW50V3JpdGUsd2lkdGgsaGVpZ2h0LGZvY3VzQ29uc29sZVdpbmRvdyl7dmFyIGFwcGVuZGVyPXRoaXM7dmFyIGluaXRpYWxpemVkPWZhbHNlO3ZhciBjb25zb2xlV2luZG93Q3JlYXRlZD1mYWxzZTt2YXIgY29uc29sZVdpbmRvd0xvYWRlZD1mYWxzZTt2YXIgY29uc29sZUNsb3NlZD1mYWxzZTt2YXIgcXVldWVkTG9nZ2luZ0V2ZW50cz1bXTt2YXIgaXNTdXBwb3J0ZWQ9dHJ1ZTt2YXIgY29uc29sZUFwcGVuZGVySWQ9Y29uc29sZUFwcGVuZGVySWRDb3VudGVyKys7aW5pdGlhbGx5TWluaW1pemVkPWV4dHJhY3RCb29sZWFuRnJvbVBhcmFtKGluaXRpYWxseU1pbmltaXplZCx0aGlzLmRlZmF1bHRzLmluaXRpYWxseU1pbmltaXplZCk7bGF6eUluaXQ9ZXh0cmFjdEJvb2xlYW5Gcm9tUGFyYW0obGF6eUluaXQsdGhpcy5kZWZhdWx0cy5sYXp5SW5pdCk7dXNlRG9jdW1lbnRXcml0ZT1leHRyYWN0Qm9vbGVhbkZyb21QYXJhbSh1c2VEb2N1bWVudFdyaXRlLHRoaXMuZGVmYXVsdHMudXNlRG9jdW1lbnRXcml0ZSk7dmFyIG5ld2VzdE1lc3NhZ2VBdFRvcD10aGlzLmRlZmF1bHRzLm5ld2VzdE1lc3NhZ2VBdFRvcDt2YXIgc2Nyb2xsVG9MYXRlc3RNZXNzYWdlPXRoaXMuZGVmYXVsdHMuc2Nyb2xsVG9MYXRlc3RNZXNzYWdlO3dpZHRoPXdpZHRoP3dpZHRoOnRoaXMuZGVmYXVsdHMud2lkdGg7aGVpZ2h0PWhlaWdodD9oZWlnaHQ6dGhpcy5kZWZhdWx0cy5oZWlnaHQ7dmFyIG1heE1lc3NhZ2VzPXRoaXMuZGVmYXVsdHMubWF4TWVzc2FnZXM7dmFyIHNob3dDb21tYW5kTGluZT10aGlzLmRlZmF1bHRzLnNob3dDb21tYW5kTGluZTt2YXIgY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aD10aGlzLmRlZmF1bHRzLmNvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg7dmFyIHNob3dIaWRlQnV0dG9uPXRoaXMuZGVmYXVsdHMuc2hvd0hpZGVCdXR0b247dmFyIHNob3dDbG9zZUJ1dHRvbj10aGlzLmRlZmF1bHRzLnNob3dDbG9zZUJ1dHRvbjt0aGlzLnNldExheW91dCh0aGlzLmRlZmF1bHRzLmxheW91dCk7dmFyIGluaXQsY3JlYXRlV2luZG93LHNhZmVUb0FwcGVuZCxnZXRDb25zb2xlV2luZG93LG9wZW47dmFyIGFwcGVuZGVyTmFtZT1pblBhZ2U/XCJJblBhZ2VBcHBlbmRlclwiOlwiUG9wVXBBcHBlbmRlclwiO3ZhciBjaGVja0NhbkNvbmZpZ3VyZT1mdW5jdGlvbihjb25maWdPcHRpb25OYW1lKXtpZihjb25zb2xlV2luZG93Q3JlYXRlZCl7aGFuZGxlRXJyb3IoYXBwZW5kZXJOYW1lK1wiOiBjb25maWd1cmF0aW9uIG9wdGlvbiAnXCIrY29uZmlnT3B0aW9uTmFtZStcIicgbWF5IG5vdCBiZSBzZXQgYWZ0ZXIgdGhlIGFwcGVuZGVyIGhhcyBiZWVuIGluaXRpYWxpemVkXCIpO3JldHVybiBmYWxzZTt9XHJcbnJldHVybiB0cnVlO307dmFyIGNvbnNvbGVXaW5kb3dFeGlzdHM9ZnVuY3Rpb24oKXtyZXR1cm4oY29uc29sZVdpbmRvd0xvYWRlZCYmaXNTdXBwb3J0ZWQmJiFjb25zb2xlQ2xvc2VkKTt9O3RoaXMuaXNOZXdlc3RNZXNzYWdlQXRUb3A9ZnVuY3Rpb24oKXtyZXR1cm4gbmV3ZXN0TWVzc2FnZUF0VG9wO307dGhpcy5zZXROZXdlc3RNZXNzYWdlQXRUb3A9ZnVuY3Rpb24obmV3ZXN0TWVzc2FnZUF0VG9wUGFyYW0pe25ld2VzdE1lc3NhZ2VBdFRvcD1ib29sKG5ld2VzdE1lc3NhZ2VBdFRvcFBhcmFtKTtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5zZXROZXdlc3RBdFRvcChuZXdlc3RNZXNzYWdlQXRUb3ApO319O3RoaXMuaXNTY3JvbGxUb0xhdGVzdE1lc3NhZ2U9ZnVuY3Rpb24oKXtyZXR1cm4gc2Nyb2xsVG9MYXRlc3RNZXNzYWdlO307dGhpcy5zZXRTY3JvbGxUb0xhdGVzdE1lc3NhZ2U9ZnVuY3Rpb24oc2Nyb2xsVG9MYXRlc3RNZXNzYWdlUGFyYW0pe3Njcm9sbFRvTGF0ZXN0TWVzc2FnZT1ib29sKHNjcm9sbFRvTGF0ZXN0TWVzc2FnZVBhcmFtKTtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5zZXRTY3JvbGxUb0xhdGVzdChzY3JvbGxUb0xhdGVzdE1lc3NhZ2UpO319O3RoaXMuZ2V0V2lkdGg9ZnVuY3Rpb24oKXtyZXR1cm4gd2lkdGg7fTt0aGlzLnNldFdpZHRoPWZ1bmN0aW9uKHdpZHRoUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwid2lkdGhcIikpe3dpZHRoPWV4dHJhY3RTdHJpbmdGcm9tUGFyYW0od2lkdGhQYXJhbSx3aWR0aCk7fX07dGhpcy5nZXRIZWlnaHQ9ZnVuY3Rpb24oKXtyZXR1cm4gaGVpZ2h0O307dGhpcy5zZXRIZWlnaHQ9ZnVuY3Rpb24oaGVpZ2h0UGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwiaGVpZ2h0XCIpKXtoZWlnaHQ9ZXh0cmFjdFN0cmluZ0Zyb21QYXJhbShoZWlnaHRQYXJhbSxoZWlnaHQpO319O3RoaXMuZ2V0TWF4TWVzc2FnZXM9ZnVuY3Rpb24oKXtyZXR1cm4gbWF4TWVzc2FnZXM7fTt0aGlzLnNldE1heE1lc3NhZ2VzPWZ1bmN0aW9uKG1heE1lc3NhZ2VzUGFyYW0pe21heE1lc3NhZ2VzPWV4dHJhY3RJbnRGcm9tUGFyYW0obWF4TWVzc2FnZXNQYXJhbSxtYXhNZXNzYWdlcyk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0TWF4TWVzc2FnZXMobWF4TWVzc2FnZXMpO319O3RoaXMuaXNTaG93Q29tbWFuZExpbmU9ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0NvbW1hbmRMaW5lO307dGhpcy5zZXRTaG93Q29tbWFuZExpbmU9ZnVuY3Rpb24oc2hvd0NvbW1hbmRMaW5lUGFyYW0pe3Nob3dDb21tYW5kTGluZT1ib29sKHNob3dDb21tYW5kTGluZVBhcmFtKTtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5zZXRTaG93Q29tbWFuZExpbmUoc2hvd0NvbW1hbmRMaW5lKTt9fTt0aGlzLmlzU2hvd0hpZGVCdXR0b249ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0hpZGVCdXR0b247fTt0aGlzLnNldFNob3dIaWRlQnV0dG9uPWZ1bmN0aW9uKHNob3dIaWRlQnV0dG9uUGFyYW0pe3Nob3dIaWRlQnV0dG9uPWJvb2woc2hvd0hpZGVCdXR0b25QYXJhbSk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuc2V0U2hvd0hpZGVCdXR0b24oc2hvd0hpZGVCdXR0b24pO319O3RoaXMuaXNTaG93Q2xvc2VCdXR0b249ZnVuY3Rpb24oKXtyZXR1cm4gc2hvd0Nsb3NlQnV0dG9uO307dGhpcy5zZXRTaG93Q2xvc2VCdXR0b249ZnVuY3Rpb24oc2hvd0Nsb3NlQnV0dG9uUGFyYW0pe3Nob3dDbG9zZUJ1dHRvbj1ib29sKHNob3dDbG9zZUJ1dHRvblBhcmFtKTtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5zZXRTaG93Q2xvc2VCdXR0b24oc2hvd0Nsb3NlQnV0dG9uKTt9fTt0aGlzLmdldENvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg9ZnVuY3Rpb24oKXtyZXR1cm4gY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aDt9O3RoaXMuc2V0Q29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aD1mdW5jdGlvbihjb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoUGFyYW0pe2NvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGg9ZXh0cmFjdEludEZyb21QYXJhbShjb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoUGFyYW0sY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aCk7fTt2YXIgbWluaW1pemVkPWluaXRpYWxseU1pbmltaXplZDt0aGlzLmlzSW5pdGlhbGx5TWluaW1pemVkPWZ1bmN0aW9uKCl7cmV0dXJuIGluaXRpYWxseU1pbmltaXplZDt9O3RoaXMuc2V0SW5pdGlhbGx5TWluaW1pemVkPWZ1bmN0aW9uKGluaXRpYWxseU1pbmltaXplZFBhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcImluaXRpYWxseU1pbmltaXplZFwiKSl7aW5pdGlhbGx5TWluaW1pemVkPWJvb2woaW5pdGlhbGx5TWluaW1pemVkUGFyYW0pO21pbmltaXplZD1pbml0aWFsbHlNaW5pbWl6ZWQ7fX07dGhpcy5pc1VzZURvY3VtZW50V3JpdGU9ZnVuY3Rpb24oKXtyZXR1cm4gdXNlRG9jdW1lbnRXcml0ZTt9O3RoaXMuc2V0VXNlRG9jdW1lbnRXcml0ZT1mdW5jdGlvbih1c2VEb2N1bWVudFdyaXRlUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwidXNlRG9jdW1lbnRXcml0ZVwiKSl7dXNlRG9jdW1lbnRXcml0ZT1ib29sKHVzZURvY3VtZW50V3JpdGVQYXJhbSk7fX07ZnVuY3Rpb24gUXVldWVkTG9nZ2luZ0V2ZW50KGxvZ2dpbmdFdmVudCxmb3JtYXR0ZWRNZXNzYWdlKXt0aGlzLmxvZ2dpbmdFdmVudD1sb2dnaW5nRXZlbnQ7dGhpcy5sZXZlbE5hbWU9bG9nZ2luZ0V2ZW50LmxldmVsLm5hbWU7dGhpcy5mb3JtYXR0ZWRNZXNzYWdlPWZvcm1hdHRlZE1lc3NhZ2U7fVxyXG5RdWV1ZWRMb2dnaW5nRXZlbnQucHJvdG90eXBlLmFwcGVuZD1mdW5jdGlvbigpe2dldENvbnNvbGVXaW5kb3coKS5sb2codGhpcy5sZXZlbE5hbWUsdGhpcy5mb3JtYXR0ZWRNZXNzYWdlKTt9O2Z1bmN0aW9uIFF1ZXVlZEdyb3VwKG5hbWUsaW5pdGlhbGx5RXhwYW5kZWQpe3RoaXMubmFtZT1uYW1lO3RoaXMuaW5pdGlhbGx5RXhwYW5kZWQ9aW5pdGlhbGx5RXhwYW5kZWQ7fVxyXG5RdWV1ZWRHcm91cC5wcm90b3R5cGUuYXBwZW5kPWZ1bmN0aW9uKCl7Z2V0Q29uc29sZVdpbmRvdygpLmdyb3VwKHRoaXMubmFtZSx0aGlzLmluaXRpYWxseUV4cGFuZGVkKTt9O2Z1bmN0aW9uIFF1ZXVlZEdyb3VwRW5kKCl7fVxyXG5RdWV1ZWRHcm91cEVuZC5wcm90b3R5cGUuYXBwZW5kPWZ1bmN0aW9uKCl7Z2V0Q29uc29sZVdpbmRvdygpLmdyb3VwRW5kKCk7fTt2YXIgY2hlY2tBbmRBcHBlbmQ9ZnVuY3Rpb24oKXtzYWZlVG9BcHBlbmQoKTtpZighaW5pdGlhbGl6ZWQpe2luaXQoKTt9ZWxzZSBpZihjb25zb2xlQ2xvc2VkJiZyZW9wZW5XaGVuQ2xvc2VkKXtjcmVhdGVXaW5kb3coKTt9XHJcbmlmKHNhZmVUb0FwcGVuZCgpKXthcHBlbmRRdWV1ZWRMb2dnaW5nRXZlbnRzKCk7fX07dGhpcy5hcHBlbmQ9ZnVuY3Rpb24obG9nZ2luZ0V2ZW50KXtpZihpc1N1cHBvcnRlZCl7dmFyIGZvcm1hdHRlZE1lc3NhZ2U9YXBwZW5kZXIuZ2V0TGF5b3V0KCkuZm9ybWF0V2l0aEV4Y2VwdGlvbihsb2dnaW5nRXZlbnQpO3F1ZXVlZExvZ2dpbmdFdmVudHMucHVzaChuZXcgUXVldWVkTG9nZ2luZ0V2ZW50KGxvZ2dpbmdFdmVudCxmb3JtYXR0ZWRNZXNzYWdlKSk7Y2hlY2tBbmRBcHBlbmQoKTt9fTt0aGlzLmdyb3VwPWZ1bmN0aW9uKG5hbWUsaW5pdGlhbGx5RXhwYW5kZWQpe2lmKGlzU3VwcG9ydGVkKXtxdWV1ZWRMb2dnaW5nRXZlbnRzLnB1c2gobmV3IFF1ZXVlZEdyb3VwKG5hbWUsaW5pdGlhbGx5RXhwYW5kZWQpKTtjaGVja0FuZEFwcGVuZCgpO319O3RoaXMuZ3JvdXBFbmQ9ZnVuY3Rpb24oKXtpZihpc1N1cHBvcnRlZCl7cXVldWVkTG9nZ2luZ0V2ZW50cy5wdXNoKG5ldyBRdWV1ZWRHcm91cEVuZCgpKTtjaGVja0FuZEFwcGVuZCgpO319O3ZhciBhcHBlbmRRdWV1ZWRMb2dnaW5nRXZlbnRzPWZ1bmN0aW9uKCl7d2hpbGUocXVldWVkTG9nZ2luZ0V2ZW50cy5sZW5ndGg+MCl7cXVldWVkTG9nZ2luZ0V2ZW50cy5zaGlmdCgpLmFwcGVuZCgpO31cclxuaWYoZm9jdXNDb25zb2xlV2luZG93KXtnZXRDb25zb2xlV2luZG93KCkuZm9jdXMoKTt9fTt0aGlzLnNldEFkZGVkVG9Mb2dnZXI9ZnVuY3Rpb24obG9nZ2VyKXt0aGlzLmxvZ2dlcnMucHVzaChsb2dnZXIpO2lmKGVuYWJsZWQmJiFsYXp5SW5pdCl7aW5pdCgpO319O3RoaXMuY2xlYXI9ZnVuY3Rpb24oKXtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5jbGVhckxvZygpO31cclxucXVldWVkTG9nZ2luZ0V2ZW50cy5sZW5ndGg9MDt9O3RoaXMuZm9jdXM9ZnVuY3Rpb24oKXtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS5mb2N1cygpO319O3RoaXMuZm9jdXNDb21tYW5kTGluZT1mdW5jdGlvbigpe2lmKGNvbnNvbGVXaW5kb3dFeGlzdHMoKSl7Z2V0Q29uc29sZVdpbmRvdygpLmZvY3VzQ29tbWFuZExpbmUoKTt9fTt0aGlzLmZvY3VzU2VhcmNoPWZ1bmN0aW9uKCl7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuZm9jdXNTZWFyY2goKTt9fTt2YXIgY29tbWFuZFdpbmRvdz13aW5kb3c7dGhpcy5nZXRDb21tYW5kV2luZG93PWZ1bmN0aW9uKCl7cmV0dXJuIGNvbW1hbmRXaW5kb3c7fTt0aGlzLnNldENvbW1hbmRXaW5kb3c9ZnVuY3Rpb24oY29tbWFuZFdpbmRvd1BhcmFtKXtjb21tYW5kV2luZG93PWNvbW1hbmRXaW5kb3dQYXJhbTt9O3RoaXMuZXhlY3V0ZUxhc3RDb21tYW5kPWZ1bmN0aW9uKCl7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXtnZXRDb25zb2xlV2luZG93KCkuZXZhbExhc3RDb21tYW5kKCk7fX07dmFyIGNvbW1hbmRMYXlvdXQ9bmV3IFBhdHRlcm5MYXlvdXQoXCIlbVwiKTt0aGlzLmdldENvbW1hbmRMYXlvdXQ9ZnVuY3Rpb24oKXtyZXR1cm4gY29tbWFuZExheW91dDt9O3RoaXMuc2V0Q29tbWFuZExheW91dD1mdW5jdGlvbihjb21tYW5kTGF5b3V0UGFyYW0pe2NvbW1hbmRMYXlvdXQ9Y29tbWFuZExheW91dFBhcmFtO307dGhpcy5ldmFsQ29tbWFuZEFuZEFwcGVuZD1mdW5jdGlvbihleHByKXt2YXIgY29tbWFuZFJldHVyblZhbHVlPXthcHBlbmRSZXN1bHQ6dHJ1ZSxpc0Vycm9yOmZhbHNlfTt2YXIgY29tbWFuZE91dHB1dD1cIlwiO3RyeXt2YXIgcmVzdWx0LGk7aWYoIWNvbW1hbmRXaW5kb3cuZXZhbCYmY29tbWFuZFdpbmRvdy5leGVjU2NyaXB0KXtjb21tYW5kV2luZG93LmV4ZWNTY3JpcHQoXCJudWxsXCIpO31cclxudmFyIGNvbW1hbmRMaW5lRnVuY3Rpb25zSGFzaD17fTtmb3IoaT0wLGxlbj1jb21tYW5kTGluZUZ1bmN0aW9ucy5sZW5ndGg7aTxsZW47aSsrKXtjb21tYW5kTGluZUZ1bmN0aW9uc0hhc2hbY29tbWFuZExpbmVGdW5jdGlvbnNbaV1bMF1dPWNvbW1hbmRMaW5lRnVuY3Rpb25zW2ldWzFdO31cclxudmFyIG9iamVjdHNUb1Jlc3RvcmU9W107dmFyIGFkZE9iamVjdFRvUmVzdG9yZT1mdW5jdGlvbihuYW1lKXtvYmplY3RzVG9SZXN0b3JlLnB1c2goW25hbWUsY29tbWFuZFdpbmRvd1tuYW1lXV0pO307YWRkT2JqZWN0VG9SZXN0b3JlKFwiYXBwZW5kZXJcIik7Y29tbWFuZFdpbmRvdy5hcHBlbmRlcj1hcHBlbmRlcjthZGRPYmplY3RUb1Jlc3RvcmUoXCJjb21tYW5kUmV0dXJuVmFsdWVcIik7Y29tbWFuZFdpbmRvdy5jb21tYW5kUmV0dXJuVmFsdWU9Y29tbWFuZFJldHVyblZhbHVlO2FkZE9iamVjdFRvUmVzdG9yZShcImNvbW1hbmRMaW5lRnVuY3Rpb25zSGFzaFwiKTtjb21tYW5kV2luZG93LmNvbW1hbmRMaW5lRnVuY3Rpb25zSGFzaD1jb21tYW5kTGluZUZ1bmN0aW9uc0hhc2g7dmFyIGFkZEZ1bmN0aW9uVG9XaW5kb3c9ZnVuY3Rpb24obmFtZSl7YWRkT2JqZWN0VG9SZXN0b3JlKG5hbWUpO2NvbW1hbmRXaW5kb3dbbmFtZV09ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5jb21tYW5kTGluZUZ1bmN0aW9uc0hhc2hbbmFtZV0oYXBwZW5kZXIsYXJndW1lbnRzLGNvbW1hbmRSZXR1cm5WYWx1ZSk7fTt9O2ZvcihpPTAsbGVuPWNvbW1hbmRMaW5lRnVuY3Rpb25zLmxlbmd0aDtpPGxlbjtpKyspe2FkZEZ1bmN0aW9uVG9XaW5kb3coY29tbWFuZExpbmVGdW5jdGlvbnNbaV1bMF0pO31cclxuaWYoY29tbWFuZFdpbmRvdz09PXdpbmRvdyYmY29tbWFuZFdpbmRvdy5leGVjU2NyaXB0KXthZGRPYmplY3RUb1Jlc3RvcmUoXCJldmFsRXhwclwiKTthZGRPYmplY3RUb1Jlc3RvcmUoXCJyZXN1bHRcIik7d2luZG93LmV2YWxFeHByPWV4cHI7Y29tbWFuZFdpbmRvdy5leGVjU2NyaXB0KFwid2luZG93LnJlc3VsdD1ldmFsKHdpbmRvdy5ldmFsRXhwcik7XCIpO3Jlc3VsdD13aW5kb3cucmVzdWx0O31lbHNle3Jlc3VsdD1jb21tYW5kV2luZG93LmV2YWwoZXhwcik7fVxyXG5jb21tYW5kT3V0cHV0PWlzVW5kZWZpbmVkKHJlc3VsdCk/cmVzdWx0OmZvcm1hdE9iamVjdEV4cGFuc2lvbihyZXN1bHQsY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aCk7Zm9yKGk9MCxsZW49b2JqZWN0c1RvUmVzdG9yZS5sZW5ndGg7aTxsZW47aSsrKXtjb21tYW5kV2luZG93W29iamVjdHNUb1Jlc3RvcmVbaV1bMF1dPW9iamVjdHNUb1Jlc3RvcmVbaV1bMV07fX1jYXRjaChleCl7Y29tbWFuZE91dHB1dD1cIkVycm9yIGV2YWx1YXRpbmcgY29tbWFuZDogXCIrZ2V0RXhjZXB0aW9uU3RyaW5nUmVwKGV4KTtjb21tYW5kUmV0dXJuVmFsdWUuaXNFcnJvcj10cnVlO31cclxuaWYoY29tbWFuZFJldHVyblZhbHVlLmFwcGVuZFJlc3VsdCl7dmFyIG1lc3NhZ2U9XCI+Pj4gXCIrZXhwcjtpZighaXNVbmRlZmluZWQoY29tbWFuZE91dHB1dCkpe21lc3NhZ2UrPW5ld0xpbmUrY29tbWFuZE91dHB1dDt9XHJcbnZhciBsZXZlbD1jb21tYW5kUmV0dXJuVmFsdWUuaXNFcnJvcj9MZXZlbC5FUlJPUjpMZXZlbC5JTkZPO3ZhciBsb2dnaW5nRXZlbnQ9bmV3IExvZ2dpbmdFdmVudChudWxsLG5ldyBEYXRlKCksbGV2ZWwsW21lc3NhZ2VdLG51bGwpO3ZhciBtYWluTGF5b3V0PXRoaXMuZ2V0TGF5b3V0KCk7dGhpcy5zZXRMYXlvdXQoY29tbWFuZExheW91dCk7dGhpcy5hcHBlbmQobG9nZ2luZ0V2ZW50KTt0aGlzLnNldExheW91dChtYWluTGF5b3V0KTt9fTt2YXIgY29tbWFuZExpbmVGdW5jdGlvbnM9ZGVmYXVsdENvbW1hbmRMaW5lRnVuY3Rpb25zLmNvbmNhdChbXSk7dGhpcy5hZGRDb21tYW5kTGluZUZ1bmN0aW9uPWZ1bmN0aW9uKGZ1bmN0aW9uTmFtZSxjb21tYW5kTGluZUZ1bmN0aW9uKXtjb21tYW5kTGluZUZ1bmN0aW9ucy5wdXNoKFtmdW5jdGlvbk5hbWUsY29tbWFuZExpbmVGdW5jdGlvbl0pO307dmFyIGNvbW1hbmRIaXN0b3J5Q29va2llTmFtZT1cImxvZzRqYXZhc2NyaXB0Q29tbWFuZEhpc3RvcnlcIjt0aGlzLnN0b3JlQ29tbWFuZEhpc3Rvcnk9ZnVuY3Rpb24oY29tbWFuZEhpc3Rvcnkpe3NldENvb2tpZShjb21tYW5kSGlzdG9yeUNvb2tpZU5hbWUsY29tbWFuZEhpc3Rvcnkuam9pbihcIixcIikpO307dmFyIHdyaXRlSHRtbD1mdW5jdGlvbihkb2Mpe3ZhciBsaW5lcz1nZXRDb25zb2xlSHRtbExpbmVzKCk7ZG9jLm9wZW4oKTtmb3IodmFyIGk9MCxsZW49bGluZXMubGVuZ3RoO2k8bGVuO2krKyl7ZG9jLndyaXRlbG4obGluZXNbaV0pO31cclxuZG9jLmNsb3NlKCk7fTt0aGlzLnNldEV2ZW50VHlwZXMoW1wibG9hZFwiLFwidW5sb2FkXCJdKTt2YXIgY29uc29sZVdpbmRvd0xvYWRIYW5kbGVyPWZ1bmN0aW9uKCl7dmFyIHdpbj1nZXRDb25zb2xlV2luZG93KCk7d2luLnNldEFwcGVuZGVyKGFwcGVuZGVyKTt3aW4uc2V0TmV3ZXN0QXRUb3AobmV3ZXN0TWVzc2FnZUF0VG9wKTt3aW4uc2V0U2Nyb2xsVG9MYXRlc3Qoc2Nyb2xsVG9MYXRlc3RNZXNzYWdlKTt3aW4uc2V0TWF4TWVzc2FnZXMobWF4TWVzc2FnZXMpO3dpbi5zZXRTaG93Q29tbWFuZExpbmUoc2hvd0NvbW1hbmRMaW5lKTt3aW4uc2V0U2hvd0hpZGVCdXR0b24oc2hvd0hpZGVCdXR0b24pO3dpbi5zZXRTaG93Q2xvc2VCdXR0b24oc2hvd0Nsb3NlQnV0dG9uKTt3aW4uc2V0TWFpbldpbmRvdyh3aW5kb3cpO3ZhciBzdG9yZWRWYWx1ZT1nZXRDb29raWUoY29tbWFuZEhpc3RvcnlDb29raWVOYW1lKTtpZihzdG9yZWRWYWx1ZSl7d2luLmNvbW1hbmRIaXN0b3J5PXN0b3JlZFZhbHVlLnNwbGl0KFwiLFwiKTt3aW4uY3VycmVudENvbW1hbmRJbmRleD13aW4uY29tbWFuZEhpc3RvcnkubGVuZ3RoO31cclxuYXBwZW5kZXIuZGlzcGF0Y2hFdmVudChcImxvYWRcIix7XCJ3aW5cIjp3aW59KTt9O3RoaXMudW5sb2FkPWZ1bmN0aW9uKCl7bG9nTG9nLmRlYnVnKFwidW5sb2FkIFwiK3RoaXMrXCIsIGNhbGxlcjogXCIrdGhpcy51bmxvYWQuY2FsbGVyKTtpZighY29uc29sZUNsb3NlZCl7bG9nTG9nLmRlYnVnKFwicmVhbGx5IGRvaW5nIHVubG9hZCBcIit0aGlzKTtjb25zb2xlQ2xvc2VkPXRydWU7Y29uc29sZVdpbmRvd0xvYWRlZD1mYWxzZTtjb25zb2xlV2luZG93Q3JlYXRlZD1mYWxzZTthcHBlbmRlci5kaXNwYXRjaEV2ZW50KFwidW5sb2FkXCIse30pO319O3ZhciBwb2xsQ29uc29sZVdpbmRvdz1mdW5jdGlvbih3aW5kb3dUZXN0LGludGVydmFsLHN1Y2Nlc3NDYWxsYmFjayxlcnJvck1lc3NhZ2Upe2Z1bmN0aW9uIGRvUG9sbCgpe3RyeXtpZihjb25zb2xlQ2xvc2VkKXtjbGVhckludGVydmFsKHBvbGwpO31cclxuaWYod2luZG93VGVzdChnZXRDb25zb2xlV2luZG93KCkpKXtjbGVhckludGVydmFsKHBvbGwpO3N1Y2Nlc3NDYWxsYmFjaygpO319Y2F0Y2goZXgpe2NsZWFySW50ZXJ2YWwocG9sbCk7aXNTdXBwb3J0ZWQ9ZmFsc2U7aGFuZGxlRXJyb3IoZXJyb3JNZXNzYWdlLGV4KTt9fVxyXG52YXIgcG9sbD1zZXRJbnRlcnZhbChkb1BvbGwsaW50ZXJ2YWwpO307dmFyIGdldENvbnNvbGVVcmw9ZnVuY3Rpb24oKXt2YXIgZG9jdW1lbnREb21haW5TZXQ9KGRvY3VtZW50LmRvbWFpbiE9bG9jYXRpb24uaG9zdG5hbWUpO3JldHVybiB1c2VEb2N1bWVudFdyaXRlP1wiXCI6Z2V0QmFzZVVybCgpK1wiY29uc29sZS5odG1sXCIrXHJcbihkb2N1bWVudERvbWFpblNldD9cIj9sb2c0amF2YXNjcmlwdF9kb21haW49XCIrZXNjYXBlKGRvY3VtZW50LmRvbWFpbik6XCJcIik7fTtpZihpblBhZ2Upe3ZhciBjb250YWluZXJFbGVtZW50PW51bGw7dmFyIGNzc1Byb3BlcnRpZXM9W107dGhpcy5hZGRDc3NQcm9wZXJ0eT1mdW5jdGlvbihuYW1lLHZhbHVlKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcImNzc1Byb3BlcnRpZXNcIikpe2Nzc1Byb3BlcnRpZXMucHVzaChbbmFtZSx2YWx1ZV0pO319O3ZhciB3aW5kb3dDcmVhdGlvblN0YXJ0ZWQ9ZmFsc2U7dmFyIGlmcmFtZUNvbnRhaW5lckRpdjt2YXIgaWZyYW1lSWQ9dW5pcXVlSWQrXCJfSW5QYWdlQXBwZW5kZXJfXCIrY29uc29sZUFwcGVuZGVySWQ7dGhpcy5oaWRlPWZ1bmN0aW9uKCl7aWYoaW5pdGlhbGl6ZWQmJmNvbnNvbGVXaW5kb3dDcmVhdGVkKXtpZihjb25zb2xlV2luZG93RXhpc3RzKCkpe2dldENvbnNvbGVXaW5kb3coKS4kKFwiY29tbWFuZFwiKS5ibHVyKCk7fVxyXG5pZnJhbWVDb250YWluZXJEaXYuc3R5bGUuZGlzcGxheT1cIm5vbmVcIjttaW5pbWl6ZWQ9dHJ1ZTt9fTt0aGlzLnNob3c9ZnVuY3Rpb24oKXtpZihpbml0aWFsaXplZCl7aWYoY29uc29sZVdpbmRvd0NyZWF0ZWQpe2lmcmFtZUNvbnRhaW5lckRpdi5zdHlsZS5kaXNwbGF5PVwiYmxvY2tcIjt0aGlzLnNldFNob3dDb21tYW5kTGluZShzaG93Q29tbWFuZExpbmUpO21pbmltaXplZD1mYWxzZTt9ZWxzZSBpZighd2luZG93Q3JlYXRpb25TdGFydGVkKXtjcmVhdGVXaW5kb3codHJ1ZSk7fX19O3RoaXMuaXNWaXNpYmxlPWZ1bmN0aW9uKCl7cmV0dXJuIW1pbmltaXplZCYmIWNvbnNvbGVDbG9zZWQ7fTt0aGlzLmNsb3NlPWZ1bmN0aW9uKGZyb21CdXR0b24pe2lmKCFjb25zb2xlQ2xvc2VkJiYoIWZyb21CdXR0b258fGNvbmZpcm0oXCJUaGlzIHdpbGwgcGVybWFuZW50bHkgcmVtb3ZlIHRoZSBjb25zb2xlIGZyb20gdGhlIHBhZ2UuIE5vIG1vcmUgbWVzc2FnZXMgd2lsbCBiZSBsb2dnZWQuIERvIHlvdSB3aXNoIHRvIGNvbnRpbnVlP1wiKSkpe2lmcmFtZUNvbnRhaW5lckRpdi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGlmcmFtZUNvbnRhaW5lckRpdik7dGhpcy51bmxvYWQoKTt9fTtvcGVuPWZ1bmN0aW9uKCl7dmFyIGluaXRFcnJvck1lc3NhZ2U9XCJJblBhZ2VBcHBlbmRlci5vcGVuOiB1bmFibGUgdG8gY3JlYXRlIGNvbnNvbGUgaWZyYW1lXCI7ZnVuY3Rpb24gZmluYWxJbml0KCl7dHJ5e2lmKCFpbml0aWFsbHlNaW5pbWl6ZWQpe2FwcGVuZGVyLnNob3coKTt9XHJcbmNvbnNvbGVXaW5kb3dMb2FkSGFuZGxlcigpO2NvbnNvbGVXaW5kb3dMb2FkZWQ9dHJ1ZTthcHBlbmRRdWV1ZWRMb2dnaW5nRXZlbnRzKCk7fWNhdGNoKGV4KXtpc1N1cHBvcnRlZD1mYWxzZTtoYW5kbGVFcnJvcihpbml0RXJyb3JNZXNzYWdlLGV4KTt9fVxyXG5mdW5jdGlvbiB3cml0ZVRvRG9jdW1lbnQoKXt0cnl7dmFyIHdpbmRvd1Rlc3Q9ZnVuY3Rpb24od2luKXtyZXR1cm4gaXNMb2FkZWQod2luKTt9O2lmKHVzZURvY3VtZW50V3JpdGUpe3dyaXRlSHRtbChnZXRDb25zb2xlV2luZG93KCkuZG9jdW1lbnQpO31cclxuaWYod2luZG93VGVzdChnZXRDb25zb2xlV2luZG93KCkpKXtmaW5hbEluaXQoKTt9ZWxzZXtwb2xsQ29uc29sZVdpbmRvdyh3aW5kb3dUZXN0LDEwMCxmaW5hbEluaXQsaW5pdEVycm9yTWVzc2FnZSk7fX1jYXRjaChleCl7aXNTdXBwb3J0ZWQ9ZmFsc2U7aGFuZGxlRXJyb3IoaW5pdEVycm9yTWVzc2FnZSxleCk7fX1cclxubWluaW1pemVkPWZhbHNlO2lmcmFtZUNvbnRhaW5lckRpdj1jb250YWluZXJFbGVtZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIikpO2lmcmFtZUNvbnRhaW5lckRpdi5zdHlsZS53aWR0aD13aWR0aDtpZnJhbWVDb250YWluZXJEaXYuc3R5bGUuaGVpZ2h0PWhlaWdodDtpZnJhbWVDb250YWluZXJEaXYuc3R5bGUuYm9yZGVyPVwic29saWQgZ3JheSAxcHhcIjtmb3IodmFyIGk9MCxsZW49Y3NzUHJvcGVydGllcy5sZW5ndGg7aTxsZW47aSsrKXtpZnJhbWVDb250YWluZXJEaXYuc3R5bGVbY3NzUHJvcGVydGllc1tpXVswXV09Y3NzUHJvcGVydGllc1tpXVsxXTt9XHJcbnZhciBpZnJhbWVTcmM9dXNlRG9jdW1lbnRXcml0ZT9cIlwiOlwiIHNyYz0nXCIrZ2V0Q29uc29sZVVybCgpK1wiJ1wiO2lmcmFtZUNvbnRhaW5lckRpdi5pbm5lckhUTUw9XCI8aWZyYW1lIGlkPSdcIitpZnJhbWVJZCtcIicgbmFtZT0nXCIraWZyYW1lSWQrXCInIHdpZHRoPScxMDAlJyBoZWlnaHQ9JzEwMCUnIGZyYW1lYm9yZGVyPScwJ1wiK2lmcmFtZVNyYytcIiBzY3JvbGxpbmc9J25vJz48L2lmcmFtZT5cIjtjb25zb2xlQ2xvc2VkPWZhbHNlO3ZhciBpZnJhbWVEb2N1bWVudEV4aXN0c1Rlc3Q9ZnVuY3Rpb24od2luKXt0cnl7cmV0dXJuIGJvb2wod2luKSYmYm9vbCh3aW4uZG9jdW1lbnQpO31jYXRjaChleCl7cmV0dXJuIGZhbHNlO319O2lmKGlmcmFtZURvY3VtZW50RXhpc3RzVGVzdChnZXRDb25zb2xlV2luZG93KCkpKXt3cml0ZVRvRG9jdW1lbnQoKTt9ZWxzZXtwb2xsQ29uc29sZVdpbmRvdyhpZnJhbWVEb2N1bWVudEV4aXN0c1Rlc3QsMTAwLHdyaXRlVG9Eb2N1bWVudCxpbml0RXJyb3JNZXNzYWdlKTt9XHJcbmNvbnNvbGVXaW5kb3dDcmVhdGVkPXRydWU7fTtjcmVhdGVXaW5kb3c9ZnVuY3Rpb24oc2hvdyl7aWYoc2hvd3x8IWluaXRpYWxseU1pbmltaXplZCl7dmFyIHBhZ2VMb2FkSGFuZGxlcj1mdW5jdGlvbigpe2lmKCFjb250YWluZXIpe2NvbnRhaW5lckVsZW1lbnQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtjb250YWluZXJFbGVtZW50LnN0eWxlLnBvc2l0aW9uPVwiZml4ZWRcIjtjb250YWluZXJFbGVtZW50LnN0eWxlLmxlZnQ9XCIwXCI7Y29udGFpbmVyRWxlbWVudC5zdHlsZS5yaWdodD1cIjBcIjtjb250YWluZXJFbGVtZW50LnN0eWxlLmJvdHRvbT1cIjBcIjtkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKGNvbnRhaW5lckVsZW1lbnQpO2FwcGVuZGVyLmFkZENzc1Byb3BlcnR5KFwiYm9yZGVyV2lkdGhcIixcIjFweCAwIDAgMFwiKTthcHBlbmRlci5hZGRDc3NQcm9wZXJ0eShcInpJbmRleFwiLDEwMDAwMDApO29wZW4oKTt9ZWxzZXt0cnl7dmFyIGVsPWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGNvbnRhaW5lcik7aWYoZWwubm9kZVR5cGU9PTEpe2NvbnRhaW5lckVsZW1lbnQ9ZWw7fVxyXG5vcGVuKCk7fWNhdGNoKGV4KXtoYW5kbGVFcnJvcihcIkluUGFnZUFwcGVuZGVyLmluaXQ6IGludmFsaWQgY29udGFpbmVyIGVsZW1lbnQgJ1wiK2NvbnRhaW5lcitcIicgc3VwcGxpZWRcIixleCk7fX19O2lmKHBhZ2VMb2FkZWQmJmNvbnRhaW5lciYmY29udGFpbmVyLmFwcGVuZENoaWxkKXtjb250YWluZXJFbGVtZW50PWNvbnRhaW5lcjtvcGVuKCk7fWVsc2UgaWYocGFnZUxvYWRlZCl7cGFnZUxvYWRIYW5kbGVyKCk7fWVsc2V7bG9nNGphdmFzY3JpcHQuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixwYWdlTG9hZEhhbmRsZXIpO31cclxud2luZG93Q3JlYXRpb25TdGFydGVkPXRydWU7fX07aW5pdD1mdW5jdGlvbigpe2NyZWF0ZVdpbmRvdygpO2luaXRpYWxpemVkPXRydWU7fTtnZXRDb25zb2xlV2luZG93PWZ1bmN0aW9uKCl7dmFyIGlmcmFtZT13aW5kb3cuZnJhbWVzW2lmcmFtZUlkXTtpZihpZnJhbWUpe3JldHVybiBpZnJhbWU7fX07c2FmZVRvQXBwZW5kPWZ1bmN0aW9uKCl7aWYoaXNTdXBwb3J0ZWQmJiFjb25zb2xlQ2xvc2VkKXtpZihjb25zb2xlV2luZG93Q3JlYXRlZCYmIWNvbnNvbGVXaW5kb3dMb2FkZWQmJmdldENvbnNvbGVXaW5kb3coKSYmaXNMb2FkZWQoZ2V0Q29uc29sZVdpbmRvdygpKSl7Y29uc29sZVdpbmRvd0xvYWRlZD10cnVlO31cclxucmV0dXJuIGNvbnNvbGVXaW5kb3dMb2FkZWQ7fVxyXG5yZXR1cm4gZmFsc2U7fTt9ZWxzZXt2YXIgdXNlT2xkUG9wVXA9YXBwZW5kZXIuZGVmYXVsdHMudXNlT2xkUG9wVXA7dmFyIGNvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nPWFwcGVuZGVyLmRlZmF1bHRzLmNvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nO3ZhciByZW9wZW5XaGVuQ2xvc2VkPXRoaXMuZGVmYXVsdHMucmVvcGVuV2hlbkNsb3NlZDt0aGlzLmlzVXNlT2xkUG9wVXA9ZnVuY3Rpb24oKXtyZXR1cm4gdXNlT2xkUG9wVXA7fTt0aGlzLnNldFVzZU9sZFBvcFVwPWZ1bmN0aW9uKHVzZU9sZFBvcFVwUGFyYW0pe2lmKGNoZWNrQ2FuQ29uZmlndXJlKFwidXNlT2xkUG9wVXBcIikpe3VzZU9sZFBvcFVwPWJvb2wodXNlT2xkUG9wVXBQYXJhbSk7fX07dGhpcy5pc0NvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nPWZ1bmN0aW9uKCl7cmV0dXJuIGNvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nO307dGhpcy5zZXRDb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZz1mdW5jdGlvbihjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZ1BhcmFtKXtpZihjaGVja0NhbkNvbmZpZ3VyZShcImNvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nXCIpKXtjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZz1ib29sKGNvbXBsYWluQWJvdXRQb3BVcEJsb2NraW5nUGFyYW0pO319O3RoaXMuaXNGb2N1c1BvcFVwPWZ1bmN0aW9uKCl7cmV0dXJuIGZvY3VzQ29uc29sZVdpbmRvdzt9O3RoaXMuc2V0Rm9jdXNQb3BVcD1mdW5jdGlvbihmb2N1c1BvcFVwUGFyYW0pe2ZvY3VzQ29uc29sZVdpbmRvdz1ib29sKGZvY3VzUG9wVXBQYXJhbSk7fTt0aGlzLmlzUmVvcGVuV2hlbkNsb3NlZD1mdW5jdGlvbigpe3JldHVybiByZW9wZW5XaGVuQ2xvc2VkO307dGhpcy5zZXRSZW9wZW5XaGVuQ2xvc2VkPWZ1bmN0aW9uKHJlb3BlbldoZW5DbG9zZWRQYXJhbSl7cmVvcGVuV2hlbkNsb3NlZD1ib29sKHJlb3BlbldoZW5DbG9zZWRQYXJhbSk7fTt0aGlzLmNsb3NlPWZ1bmN0aW9uKCl7bG9nTG9nLmRlYnVnKFwiY2xvc2UgXCIrdGhpcyk7dHJ5e3BvcFVwLmNsb3NlKCk7dGhpcy51bmxvYWQoKTt9Y2F0Y2goZXgpe319O3RoaXMuaGlkZT1mdW5jdGlvbigpe2xvZ0xvZy5kZWJ1ZyhcImhpZGUgXCIrdGhpcyk7aWYoY29uc29sZVdpbmRvd0V4aXN0cygpKXt0aGlzLmNsb3NlKCk7fX07dGhpcy5zaG93PWZ1bmN0aW9uKCl7bG9nTG9nLmRlYnVnKFwic2hvdyBcIit0aGlzKTtpZighY29uc29sZVdpbmRvd0NyZWF0ZWQpe29wZW4oKTt9fTt0aGlzLmlzVmlzaWJsZT1mdW5jdGlvbigpe3JldHVybiBzYWZlVG9BcHBlbmQoKTt9O3ZhciBwb3BVcDtvcGVuPWZ1bmN0aW9uKCl7dmFyIHdpbmRvd1Byb3BlcnRpZXM9XCJ3aWR0aD1cIit3aWR0aCtcIixoZWlnaHQ9XCIraGVpZ2h0K1wiLHN0YXR1cyxyZXNpemFibGVcIjt2YXIgZnJhbWVJbmZvPVwiXCI7dHJ5e3ZhciBmcmFtZUVsPXdpbmRvdy5mcmFtZUVsZW1lbnQ7aWYoZnJhbWVFbCl7ZnJhbWVJbmZvPVwiX1wiK2ZyYW1lRWwudGFnTmFtZStcIl9cIisoZnJhbWVFbC5uYW1lfHxmcmFtZUVsLmlkfHxcIlwiKTt9fWNhdGNoKGUpe2ZyYW1lSW5mbz1cIl9pbmFjY2Vzc2libGVQYXJlbnRGcmFtZVwiO31cclxudmFyIHdpbmRvd05hbWU9XCJQb3BVcF9cIitsb2NhdGlvbi5ob3N0LnJlcGxhY2UoL1teYS16MC05XS9naSxcIl9cIikrXCJfXCIrY29uc29sZUFwcGVuZGVySWQrZnJhbWVJbmZvO2lmKCF1c2VPbGRQb3BVcHx8IXVzZURvY3VtZW50V3JpdGUpe3dpbmRvd05hbWU9d2luZG93TmFtZStcIl9cIit1bmlxdWVJZDt9XHJcbnZhciBjaGVja1BvcFVwQ2xvc2VkPWZ1bmN0aW9uKHdpbil7aWYoY29uc29sZUNsb3NlZCl7cmV0dXJuIHRydWU7fWVsc2V7dHJ5e3JldHVybiBib29sKHdpbikmJndpbi5jbG9zZWQ7fWNhdGNoKGV4KXt9fVxyXG5yZXR1cm4gZmFsc2U7fTt2YXIgcG9wVXBDbG9zZWRDYWxsYmFjaz1mdW5jdGlvbigpe2lmKCFjb25zb2xlQ2xvc2VkKXthcHBlbmRlci51bmxvYWQoKTt9fTtmdW5jdGlvbiBmaW5hbEluaXQoKXtnZXRDb25zb2xlV2luZG93KCkuc2V0Q2xvc2VJZk9wZW5lckNsb3NlcyghdXNlT2xkUG9wVXB8fCF1c2VEb2N1bWVudFdyaXRlKTtjb25zb2xlV2luZG93TG9hZEhhbmRsZXIoKTtjb25zb2xlV2luZG93TG9hZGVkPXRydWU7YXBwZW5kUXVldWVkTG9nZ2luZ0V2ZW50cygpO3BvbGxDb25zb2xlV2luZG93KGNoZWNrUG9wVXBDbG9zZWQsNTAwLHBvcFVwQ2xvc2VkQ2FsbGJhY2ssXCJQb3BVcEFwcGVuZGVyLmNoZWNrUG9wVXBDbG9zZWQ6IGVycm9yIGNoZWNraW5nIHBvcC11cCB3aW5kb3dcIik7fVxyXG50cnl7cG9wVXA9d2luZG93Lm9wZW4oZ2V0Q29uc29sZVVybCgpLHdpbmRvd05hbWUsd2luZG93UHJvcGVydGllcyk7Y29uc29sZUNsb3NlZD1mYWxzZTtjb25zb2xlV2luZG93Q3JlYXRlZD10cnVlO2lmKHBvcFVwJiZwb3BVcC5kb2N1bWVudCl7aWYodXNlRG9jdW1lbnRXcml0ZSYmdXNlT2xkUG9wVXAmJmlzTG9hZGVkKHBvcFVwKSl7cG9wVXAubWFpblBhZ2VSZWxvYWRlZCgpO2ZpbmFsSW5pdCgpO31lbHNle2lmKHVzZURvY3VtZW50V3JpdGUpe3dyaXRlSHRtbChwb3BVcC5kb2N1bWVudCk7fVxyXG52YXIgcG9wVXBMb2FkZWRUZXN0PWZ1bmN0aW9uKHdpbil7cmV0dXJuIGJvb2wod2luKSYmaXNMb2FkZWQod2luKTt9O2lmKGlzTG9hZGVkKHBvcFVwKSl7ZmluYWxJbml0KCk7fWVsc2V7cG9sbENvbnNvbGVXaW5kb3cocG9wVXBMb2FkZWRUZXN0LDEwMCxmaW5hbEluaXQsXCJQb3BVcEFwcGVuZGVyLmluaXQ6IHVuYWJsZSB0byBjcmVhdGUgY29uc29sZSB3aW5kb3dcIik7fX19ZWxzZXtpc1N1cHBvcnRlZD1mYWxzZTtsb2dMb2cud2FybihcIlBvcFVwQXBwZW5kZXIuaW5pdDogcG9wLXVwcyBibG9ja2VkLCBwbGVhc2UgdW5ibG9jayB0byB1c2UgUG9wVXBBcHBlbmRlclwiKTtpZihjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZyl7aGFuZGxlRXJyb3IoXCJsb2c0amF2YXNjcmlwdDogcG9wLXVwIHdpbmRvd3MgYXBwZWFyIHRvIGJlIGJsb2NrZWQuIFBsZWFzZSB1bmJsb2NrIHRoZW0gdG8gdXNlIHBvcC11cCBsb2dnaW5nLlwiKTt9fX1jYXRjaChleCl7aGFuZGxlRXJyb3IoXCJQb3BVcEFwcGVuZGVyLmluaXQ6IGVycm9yIGNyZWF0aW5nIHBvcC11cFwiLGV4KTt9fTtjcmVhdGVXaW5kb3c9ZnVuY3Rpb24oKXtpZighaW5pdGlhbGx5TWluaW1pemVkKXtvcGVuKCk7fX07aW5pdD1mdW5jdGlvbigpe2NyZWF0ZVdpbmRvdygpO2luaXRpYWxpemVkPXRydWU7fTtnZXRDb25zb2xlV2luZG93PWZ1bmN0aW9uKCl7cmV0dXJuIHBvcFVwO307c2FmZVRvQXBwZW5kPWZ1bmN0aW9uKCl7aWYoaXNTdXBwb3J0ZWQmJiFpc1VuZGVmaW5lZChwb3BVcCkmJiFjb25zb2xlQ2xvc2VkKXtpZihwb3BVcC5jbG9zZWR8fChjb25zb2xlV2luZG93TG9hZGVkJiZpc1VuZGVmaW5lZChwb3BVcC5jbG9zZWQpKSl7YXBwZW5kZXIudW5sb2FkKCk7bG9nTG9nLmRlYnVnKFwiUG9wVXBBcHBlbmRlcjogcG9wLXVwIGNsb3NlZFwiKTtyZXR1cm4gZmFsc2U7fVxyXG5pZighY29uc29sZVdpbmRvd0xvYWRlZCYmaXNMb2FkZWQocG9wVXApKXtjb25zb2xlV2luZG93TG9hZGVkPXRydWU7fX1cclxucmV0dXJuIGlzU3VwcG9ydGVkJiZjb25zb2xlV2luZG93TG9hZGVkJiYhY29uc29sZUNsb3NlZDt9O31cclxudGhpcy5nZXRDb25zb2xlV2luZG93PWdldENvbnNvbGVXaW5kb3c7fTtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbj1mdW5jdGlvbihmdW5jdGlvbk5hbWUsY29tbWFuZExpbmVGdW5jdGlvbil7ZGVmYXVsdENvbW1hbmRMaW5lRnVuY3Rpb25zLnB1c2goW2Z1bmN0aW9uTmFtZSxjb21tYW5kTGluZUZ1bmN0aW9uXSk7fTtmdW5jdGlvbiBQb3BVcEFwcGVuZGVyKGxhenlJbml0LGluaXRpYWxseU1pbmltaXplZCx1c2VEb2N1bWVudFdyaXRlLHdpZHRoLGhlaWdodCl7dGhpcy5jcmVhdGUoZmFsc2UsbnVsbCxsYXp5SW5pdCxpbml0aWFsbHlNaW5pbWl6ZWQsdXNlRG9jdW1lbnRXcml0ZSx3aWR0aCxoZWlnaHQsdGhpcy5kZWZhdWx0cy5mb2N1c1BvcFVwKTt9XHJcblBvcFVwQXBwZW5kZXIucHJvdG90eXBlPW5ldyBDb25zb2xlQXBwZW5kZXIoKTtQb3BVcEFwcGVuZGVyLnByb3RvdHlwZS5kZWZhdWx0cz17bGF5b3V0Om5ldyBQYXR0ZXJuTGF5b3V0KFwiJWR7SEg6bW06c3N9ICUtNXAgLSAlbXsxfSVuXCIpLGluaXRpYWxseU1pbmltaXplZDpmYWxzZSxmb2N1c1BvcFVwOmZhbHNlLGxhenlJbml0OnRydWUsdXNlT2xkUG9wVXA6dHJ1ZSxjb21wbGFpbkFib3V0UG9wVXBCbG9ja2luZzp0cnVlLG5ld2VzdE1lc3NhZ2VBdFRvcDpmYWxzZSxzY3JvbGxUb0xhdGVzdE1lc3NhZ2U6dHJ1ZSx3aWR0aDpcIjYwMFwiLGhlaWdodDpcIjQwMFwiLHJlb3BlbldoZW5DbG9zZWQ6ZmFsc2UsbWF4TWVzc2FnZXM6bnVsbCxzaG93Q29tbWFuZExpbmU6dHJ1ZSxjb21tYW5kTGluZU9iamVjdEV4cGFuc2lvbkRlcHRoOjEsc2hvd0hpZGVCdXR0b246ZmFsc2Usc2hvd0Nsb3NlQnV0dG9uOnRydWUsdXNlRG9jdW1lbnRXcml0ZTp0cnVlfTtQb3BVcEFwcGVuZGVyLnByb3RvdHlwZS50b1N0cmluZz1mdW5jdGlvbigpe3JldHVyblwiUG9wVXBBcHBlbmRlclwiO307bG9nNGphdmFzY3JpcHQuUG9wVXBBcHBlbmRlcj1Qb3BVcEFwcGVuZGVyO2Z1bmN0aW9uIEluUGFnZUFwcGVuZGVyKGNvbnRhaW5lcixsYXp5SW5pdCxpbml0aWFsbHlNaW5pbWl6ZWQsdXNlRG9jdW1lbnRXcml0ZSx3aWR0aCxoZWlnaHQpe3RoaXMuY3JlYXRlKHRydWUsY29udGFpbmVyLGxhenlJbml0LGluaXRpYWxseU1pbmltaXplZCx1c2VEb2N1bWVudFdyaXRlLHdpZHRoLGhlaWdodCxmYWxzZSk7fVxyXG5JblBhZ2VBcHBlbmRlci5wcm90b3R5cGU9bmV3IENvbnNvbGVBcHBlbmRlcigpO0luUGFnZUFwcGVuZGVyLnByb3RvdHlwZS5kZWZhdWx0cz17bGF5b3V0Om5ldyBQYXR0ZXJuTGF5b3V0KFwiJWR7SEg6bW06c3N9ICUtNXAgLSAlbXsxfSVuXCIpLGluaXRpYWxseU1pbmltaXplZDpmYWxzZSxsYXp5SW5pdDp0cnVlLG5ld2VzdE1lc3NhZ2VBdFRvcDpmYWxzZSxzY3JvbGxUb0xhdGVzdE1lc3NhZ2U6dHJ1ZSx3aWR0aDpcIjEwMCVcIixoZWlnaHQ6XCIyMjBweFwiLG1heE1lc3NhZ2VzOm51bGwsc2hvd0NvbW1hbmRMaW5lOnRydWUsY29tbWFuZExpbmVPYmplY3RFeHBhbnNpb25EZXB0aDoxLHNob3dIaWRlQnV0dG9uOmZhbHNlLHNob3dDbG9zZUJ1dHRvbjpmYWxzZSxzaG93TG9nRW50cnlEZWxldGVCdXR0b25zOnRydWUsdXNlRG9jdW1lbnRXcml0ZTp0cnVlfTtJblBhZ2VBcHBlbmRlci5wcm90b3R5cGUudG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm5cIkluUGFnZUFwcGVuZGVyXCI7fTtsb2c0amF2YXNjcmlwdC5JblBhZ2VBcHBlbmRlcj1JblBhZ2VBcHBlbmRlcjtsb2c0amF2YXNjcmlwdC5JbmxpbmVBcHBlbmRlcj1JblBhZ2VBcHBlbmRlcjt9KSgpO2Z1bmN0aW9uIHBhZFdpdGhTcGFjZXMoc3RyLGxlbil7aWYoc3RyLmxlbmd0aDxsZW4pe3ZhciBzcGFjZXM9W107dmFyIG51bWJlck9mU3BhY2VzPU1hdGgubWF4KDAsbGVuLXN0ci5sZW5ndGgpO2Zvcih2YXIgaT0wO2k8bnVtYmVyT2ZTcGFjZXM7aSsrKXtzcGFjZXNbaV09XCIgXCI7fVxyXG5zdHIrPXNwYWNlcy5qb2luKFwiXCIpO31cclxucmV0dXJuIHN0cjt9XHJcbihmdW5jdGlvbigpe2Z1bmN0aW9uIGRpcihvYmope3ZhciBtYXhMZW49MDtmb3IodmFyIHAgaW4gb2JqKXttYXhMZW49TWF0aC5tYXgodG9TdHIocCkubGVuZ3RoLG1heExlbik7fVxyXG52YXIgcHJvcExpc3Q9W107Zm9yKHAgaW4gb2JqKXt2YXIgcHJvcE5hbWVTdHI9XCIgIFwiK3BhZFdpdGhTcGFjZXModG9TdHIocCksbWF4TGVuKzIpO3ZhciBwcm9wVmFsO3RyeXtwcm9wVmFsPXNwbGl0SW50b0xpbmVzKHRvU3RyKG9ialtwXSkpLmpvaW4ocGFkV2l0aFNwYWNlcyhuZXdMaW5lLG1heExlbis2KSk7fWNhdGNoKGV4KXtwcm9wVmFsPVwiW0Vycm9yIG9idGFpbmluZyBwcm9wZXJ0eS4gRGV0YWlsczogXCIrZ2V0RXhjZXB0aW9uTWVzc2FnZShleCkrXCJdXCI7fVxyXG5wcm9wTGlzdC5wdXNoKHByb3BOYW1lU3RyK3Byb3BWYWwpO31cclxucmV0dXJuIHByb3BMaXN0LmpvaW4obmV3TGluZSk7fVxyXG52YXIgbm9kZVR5cGVzPXtFTEVNRU5UX05PREU6MSxBVFRSSUJVVEVfTk9ERToyLFRFWFRfTk9ERTozLENEQVRBX1NFQ1RJT05fTk9ERTo0LEVOVElUWV9SRUZFUkVOQ0VfTk9ERTo1LEVOVElUWV9OT0RFOjYsUFJPQ0VTU0lOR19JTlNUUlVDVElPTl9OT0RFOjcsQ09NTUVOVF9OT0RFOjgsRE9DVU1FTlRfTk9ERTo5LERPQ1VNRU5UX1RZUEVfTk9ERToxMCxET0NVTUVOVF9GUkFHTUVOVF9OT0RFOjExLE5PVEFUSU9OX05PREU6MTJ9O3ZhciBwcmVGb3JtYXR0ZWRFbGVtZW50cz1bXCJzY3JpcHRcIixcInByZVwiXTt2YXIgZW1wdHlFbGVtZW50cz1bXCJiclwiLFwiaW1nXCIsXCJoclwiLFwicGFyYW1cIixcImxpbmtcIixcImFyZWFcIixcImlucHV0XCIsXCJjb2xcIixcImJhc2VcIixcIm1ldGFcIl07dmFyIGluZGVudGF0aW9uVW5pdD1cIiAgXCI7ZnVuY3Rpb24gZ2V0WGh0bWwocm9vdE5vZGUsaW5jbHVkZVJvb3ROb2RlLGluZGVudGF0aW9uLHN0YXJ0TmV3TGluZSxwcmVmb3JtYXR0ZWQpe2luY2x1ZGVSb290Tm9kZT0odHlwZW9mIGluY2x1ZGVSb290Tm9kZT09XCJ1bmRlZmluZWRcIik/dHJ1ZTohIWluY2x1ZGVSb290Tm9kZTtpZih0eXBlb2YgaW5kZW50YXRpb24hPVwic3RyaW5nXCIpe2luZGVudGF0aW9uPVwiXCI7fVxyXG5zdGFydE5ld0xpbmU9ISFzdGFydE5ld0xpbmU7cHJlZm9ybWF0dGVkPSEhcHJlZm9ybWF0dGVkO3ZhciB4aHRtbDtmdW5jdGlvbiBpc1doaXRlc3BhY2Uobm9kZSl7cmV0dXJuKChub2RlLm5vZGVUeXBlPT1ub2RlVHlwZXMuVEVYVF9OT0RFKSYmL15bIFxcdFxcclxcbl0qJC8udGVzdChub2RlLm5vZGVWYWx1ZSkpO31cclxuZnVuY3Rpb24gZml4QXR0cmlidXRlVmFsdWUoYXR0clZhbHVlKXtyZXR1cm4gYXR0clZhbHVlLnRvU3RyaW5nKCkucmVwbGFjZSgvJi9nLFwiJmFtcDtcIikucmVwbGFjZSgvPC9nLFwiJmx0O1wiKS5yZXBsYWNlKC9cIi9nLFwiJnF1b3Q7XCIpO31cclxuZnVuY3Rpb24gZ2V0U3R5bGVBdHRyaWJ1dGVWYWx1ZShlbCl7dmFyIHN0eWxlUGFpcnM9ZWwuc3R5bGUuY3NzVGV4dC5zcGxpdChcIjtcIik7dmFyIHN0eWxlVmFsdWU9XCJcIjtmb3IodmFyIGo9MCxsZW49c3R5bGVQYWlycy5sZW5ndGg7ajxsZW47aisrKXt2YXIgbmFtZVZhbHVlQml0cz1zdHlsZVBhaXJzW2pdLnNwbGl0KFwiOlwiKTt2YXIgcHJvcHM9W107aWYoIS9eXFxzKiQvLnRlc3QobmFtZVZhbHVlQml0c1swXSkpe3Byb3BzLnB1c2godHJpbShuYW1lVmFsdWVCaXRzWzBdKS50b0xvd2VyQ2FzZSgpK1wiOlwiK3RyaW0obmFtZVZhbHVlQml0c1sxXSkpO31cclxuc3R5bGVWYWx1ZT1wcm9wcy5qb2luKFwiO1wiKTt9XHJcbnJldHVybiBzdHlsZVZhbHVlO31cclxuZnVuY3Rpb24gZ2V0TmFtZXNwYWNlKGVsKXtpZihlbC5wcmVmaXgpe3JldHVybiBlbC5wcmVmaXg7fWVsc2UgaWYoZWwub3V0ZXJIVE1MKXt2YXIgcmVnZXg9bmV3IFJlZ0V4cChcIjwoW146XSspOlwiK2VsLnRhZ05hbWUrXCJbXj5dKj5cIixcImlcIik7aWYocmVnZXgudGVzdChlbC5vdXRlckhUTUwpKXtyZXR1cm4gUmVnRXhwLiQxLnRvTG93ZXJDYXNlKCk7fX1cclxucmV0dXJuXCJcIjt9XHJcbnZhciBsdD1cIjxcIjt2YXIgZ3Q9XCI+XCI7dmFyIGksbGVuO2lmKGluY2x1ZGVSb290Tm9kZSYmcm9vdE5vZGUubm9kZVR5cGUhPW5vZGVUeXBlcy5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKXtzd2l0Y2gocm9vdE5vZGUubm9kZVR5cGUpe2Nhc2Ugbm9kZVR5cGVzLkVMRU1FTlRfTk9ERTp2YXIgdGFnTmFtZT1yb290Tm9kZS50YWdOYW1lLnRvTG93ZXJDYXNlKCk7eGh0bWw9c3RhcnROZXdMaW5lP25ld0xpbmUraW5kZW50YXRpb246XCJcIjt4aHRtbCs9bHQ7dmFyIHByZWZpeD1nZXROYW1lc3BhY2Uocm9vdE5vZGUpO3ZhciBoYXNQcmVmaXg9ISFwcmVmaXg7aWYoaGFzUHJlZml4KXt4aHRtbCs9cHJlZml4K1wiOlwiO31cclxueGh0bWwrPXRhZ05hbWU7Zm9yKGk9MCxsZW49cm9vdE5vZGUuYXR0cmlidXRlcy5sZW5ndGg7aTxsZW47aSsrKXt2YXIgY3VycmVudEF0dHI9cm9vdE5vZGUuYXR0cmlidXRlc1tpXTtpZighY3VycmVudEF0dHIuc3BlY2lmaWVkfHxjdXJyZW50QXR0ci5ub2RlVmFsdWU9PT1udWxsfHxjdXJyZW50QXR0ci5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpPT09XCJzdHlsZVwifHx0eXBlb2YgY3VycmVudEF0dHIubm9kZVZhbHVlIT09XCJzdHJpbmdcInx8Y3VycmVudEF0dHIubm9kZU5hbWUuaW5kZXhPZihcIl9tb3pcIik9PT0wKXtjb250aW51ZTt9XHJcbnhodG1sKz1cIiBcIitjdXJyZW50QXR0ci5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpK1wiPVxcXCJcIjt4aHRtbCs9Zml4QXR0cmlidXRlVmFsdWUoY3VycmVudEF0dHIubm9kZVZhbHVlKTt4aHRtbCs9XCJcXFwiXCI7fVxyXG5pZihyb290Tm9kZS5zdHlsZS5jc3NUZXh0KXt2YXIgc3R5bGVWYWx1ZT1nZXRTdHlsZUF0dHJpYnV0ZVZhbHVlKHJvb3ROb2RlKTtpZihzdHlsZVZhbHVlIT09XCJcIil7eGh0bWwrPVwiIHN0eWxlPVxcXCJcIitnZXRTdHlsZUF0dHJpYnV0ZVZhbHVlKHJvb3ROb2RlKStcIlxcXCJcIjt9fVxyXG5pZihhcnJheV9jb250YWlucyhlbXB0eUVsZW1lbnRzLHRhZ05hbWUpfHwoaGFzUHJlZml4JiYhcm9vdE5vZGUuaGFzQ2hpbGROb2RlcygpKSl7eGh0bWwrPVwiL1wiK2d0O31lbHNle3hodG1sKz1ndDt2YXIgY2hpbGRTdGFydE5ld0xpbmU9IShyb290Tm9kZS5jaGlsZE5vZGVzLmxlbmd0aD09PTEmJnJvb3ROb2RlLmNoaWxkTm9kZXNbMF0ubm9kZVR5cGU9PT1ub2RlVHlwZXMuVEVYVF9OT0RFKTt2YXIgY2hpbGRQcmVmb3JtYXR0ZWQ9YXJyYXlfY29udGFpbnMocHJlRm9ybWF0dGVkRWxlbWVudHMsdGFnTmFtZSk7Zm9yKGk9MCxsZW49cm9vdE5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7aTxsZW47aSsrKXt4aHRtbCs9Z2V0WGh0bWwocm9vdE5vZGUuY2hpbGROb2Rlc1tpXSx0cnVlLGluZGVudGF0aW9uK2luZGVudGF0aW9uVW5pdCxjaGlsZFN0YXJ0TmV3TGluZSxjaGlsZFByZWZvcm1hdHRlZCk7fVxyXG52YXIgZW5kVGFnPWx0K1wiL1wiK3RhZ05hbWUrZ3Q7eGh0bWwrPWNoaWxkU3RhcnROZXdMaW5lP25ld0xpbmUraW5kZW50YXRpb24rZW5kVGFnOmVuZFRhZzt9XHJcbnJldHVybiB4aHRtbDtjYXNlIG5vZGVUeXBlcy5URVhUX05PREU6aWYoaXNXaGl0ZXNwYWNlKHJvb3ROb2RlKSl7eGh0bWw9XCJcIjt9ZWxzZXtpZihwcmVmb3JtYXR0ZWQpe3hodG1sPXJvb3ROb2RlLm5vZGVWYWx1ZTt9ZWxzZXt2YXIgbGluZXM9c3BsaXRJbnRvTGluZXModHJpbShyb290Tm9kZS5ub2RlVmFsdWUpKTt2YXIgdHJpbW1lZExpbmVzPVtdO2ZvcihpPTAsbGVuPWxpbmVzLmxlbmd0aDtpPGxlbjtpKyspe3RyaW1tZWRMaW5lc1tpXT10cmltKGxpbmVzW2ldKTt9XHJcbnhodG1sPXRyaW1tZWRMaW5lcy5qb2luKG5ld0xpbmUraW5kZW50YXRpb24pO31cclxuaWYoc3RhcnROZXdMaW5lKXt4aHRtbD1uZXdMaW5lK2luZGVudGF0aW9uK3hodG1sO319XHJcbnJldHVybiB4aHRtbDtjYXNlIG5vZGVUeXBlcy5DREFUQV9TRUNUSU9OX05PREU6cmV0dXJuXCI8IVtDREFcIitcIlRBW1wiK3Jvb3ROb2RlLm5vZGVWYWx1ZStcIl1cIitcIl0+XCIrbmV3TGluZTtjYXNlIG5vZGVUeXBlcy5ET0NVTUVOVF9OT0RFOnhodG1sPVwiXCI7Zm9yKGk9MCxsZW49cm9vdE5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7aTxsZW47aSsrKXt4aHRtbCs9Z2V0WGh0bWwocm9vdE5vZGUuY2hpbGROb2Rlc1tpXSx0cnVlLGluZGVudGF0aW9uKTt9XHJcbnJldHVybiB4aHRtbDtkZWZhdWx0OnJldHVyblwiXCI7fX1lbHNle3hodG1sPVwiXCI7Zm9yKGk9MCxsZW49cm9vdE5vZGUuY2hpbGROb2Rlcy5sZW5ndGg7aTxsZW47aSsrKXt4aHRtbCs9Z2V0WGh0bWwocm9vdE5vZGUuY2hpbGROb2Rlc1tpXSx0cnVlLGluZGVudGF0aW9uK2luZGVudGF0aW9uVW5pdCk7fVxyXG5yZXR1cm4geGh0bWw7fX1cclxuZnVuY3Rpb24gY3JlYXRlQ29tbWFuZExpbmVGdW5jdGlvbnMoKXtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbihcIiRcIixmdW5jdGlvbihhcHBlbmRlcixhcmdzLHJldHVyblZhbHVlKXtyZXR1cm4gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoYXJnc1swXSk7fSk7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCJkaXJcIixmdW5jdGlvbihhcHBlbmRlcixhcmdzLHJldHVyblZhbHVlKXt2YXIgbGluZXM9W107Zm9yKHZhciBpPTAsbGVuPWFyZ3MubGVuZ3RoO2k8bGVuO2krKyl7bGluZXNbaV09ZGlyKGFyZ3NbaV0pO31cclxucmV0dXJuIGxpbmVzLmpvaW4obmV3TGluZStuZXdMaW5lKTt9KTtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbihcImRpcnhtbFwiLGZ1bmN0aW9uKGFwcGVuZGVyLGFyZ3MscmV0dXJuVmFsdWUpe3ZhciBsaW5lcz1bXTtmb3IodmFyIGk9MCxsZW49YXJncy5sZW5ndGg7aTxsZW47aSsrKXtsaW5lc1tpXT1nZXRYaHRtbChhcmdzW2ldKTt9XHJcbnJldHVybiBsaW5lcy5qb2luKG5ld0xpbmUrbmV3TGluZSk7fSk7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCJjZFwiLGZ1bmN0aW9uKGFwcGVuZGVyLGFyZ3MscmV0dXJuVmFsdWUpe3ZhciB3aW4sbWVzc2FnZTtpZihhcmdzLmxlbmd0aD09PTB8fGFyZ3NbMF09PT1cIlwiKXt3aW49d2luZG93O21lc3NhZ2U9XCJDb21tYW5kIGxpbmUgc2V0IHRvIHJ1biBpbiBtYWluIHdpbmRvd1wiO31lbHNle2lmKGFyZ3NbMF0ud2luZG93PT1hcmdzWzBdKXt3aW49YXJnc1swXTttZXNzYWdlPVwiQ29tbWFuZCBsaW5lIHNldCB0byBydW4gaW4gZnJhbWUgJ1wiK2FyZ3NbMF0ubmFtZStcIidcIjt9ZWxzZXt3aW49d2luZG93LmZyYW1lc1thcmdzWzBdXTtpZih3aW4pe21lc3NhZ2U9XCJDb21tYW5kIGxpbmUgc2V0IHRvIHJ1biBpbiBmcmFtZSAnXCIrYXJnc1swXStcIidcIjt9ZWxzZXtyZXR1cm5WYWx1ZS5pc0Vycm9yPXRydWU7bWVzc2FnZT1cIkZyYW1lICdcIithcmdzWzBdK1wiJyBkb2VzIG5vdCBleGlzdFwiO3dpbj1hcHBlbmRlci5nZXRDb21tYW5kV2luZG93KCk7fX19XHJcbmFwcGVuZGVyLnNldENvbW1hbmRXaW5kb3cod2luKTtyZXR1cm4gbWVzc2FnZTt9KTtDb25zb2xlQXBwZW5kZXIuYWRkR2xvYmFsQ29tbWFuZExpbmVGdW5jdGlvbihcImNsZWFyXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7cmV0dXJuVmFsdWUuYXBwZW5kUmVzdWx0PWZhbHNlO2FwcGVuZGVyLmNsZWFyKCk7fSk7Q29uc29sZUFwcGVuZGVyLmFkZEdsb2JhbENvbW1hbmRMaW5lRnVuY3Rpb24oXCJrZXlzXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7dmFyIGtleXM9W107Zm9yKHZhciBrIGluIGFyZ3NbMF0pe2tleXMucHVzaChrKTt9XHJcbnJldHVybiBrZXlzO30pO0NvbnNvbGVBcHBlbmRlci5hZGRHbG9iYWxDb21tYW5kTGluZUZ1bmN0aW9uKFwidmFsdWVzXCIsZnVuY3Rpb24oYXBwZW5kZXIsYXJncyxyZXR1cm5WYWx1ZSl7dmFyIHZhbHVlcz1bXTtmb3IodmFyIGsgaW4gYXJnc1swXSl7dHJ5e3ZhbHVlcy5wdXNoKGFyZ3NbMF1ba10pO31jYXRjaChleCl7bG9nTG9nLndhcm4oXCJ2YWx1ZXMoKTogVW5hYmxlIHRvIG9idGFpbiB2YWx1ZSBmb3Iga2V5IFwiK2srXCIuIERldGFpbHM6IFwiK2dldEV4Y2VwdGlvbk1lc3NhZ2UoZXgpKTt9fVxyXG5yZXR1cm4gdmFsdWVzO30pO0NvbnNvbGVBcHBlbmRlci5hZGRHbG9iYWxDb21tYW5kTGluZUZ1bmN0aW9uKFwiZXhwYW5zaW9uRGVwdGhcIixmdW5jdGlvbihhcHBlbmRlcixhcmdzLHJldHVyblZhbHVlKXt2YXIgZXhwYW5zaW9uRGVwdGg9cGFyc2VJbnQoYXJnc1swXSwxMCk7aWYoaXNOYU4oZXhwYW5zaW9uRGVwdGgpfHxleHBhbnNpb25EZXB0aDwwKXtyZXR1cm5WYWx1ZS5pc0Vycm9yPXRydWU7cmV0dXJuXCJcIithcmdzWzBdK1wiIGlzIG5vdCBhIHZhbGlkIGV4cGFuc2lvbiBkZXB0aFwiO31lbHNle2FwcGVuZGVyLnNldENvbW1hbmRMaW5lT2JqZWN0RXhwYW5zaW9uRGVwdGgoZXhwYW5zaW9uRGVwdGgpO3JldHVyblwiT2JqZWN0IGV4cGFuc2lvbiBkZXB0aCBzZXQgdG8gXCIrZXhwYW5zaW9uRGVwdGg7fX0pO31cclxuZnVuY3Rpb24gaW5pdCgpe2NyZWF0ZUNvbW1hbmRMaW5lRnVuY3Rpb25zKCk7fVxyXG5pbml0KCk7fSkoKTtmdW5jdGlvbiBjcmVhdGVEZWZhdWx0TG9nZ2VyKCl7dmFyIGxvZ2dlcj1sb2c0amF2YXNjcmlwdC5nZXRMb2dnZXIoZGVmYXVsdExvZ2dlck5hbWUpO3ZhciBhPW5ldyBsb2c0amF2YXNjcmlwdC5Qb3BVcEFwcGVuZGVyKCk7bG9nZ2VyLmFkZEFwcGVuZGVyKGEpO3JldHVybiBsb2dnZXI7fVxyXG5sb2c0amF2YXNjcmlwdC5zZXREb2N1bWVudFJlYWR5PWZ1bmN0aW9uKCl7cGFnZUxvYWRlZD10cnVlO2xvZzRqYXZhc2NyaXB0LmRpc3BhdGNoRXZlbnQoXCJsb2FkXCIse30pO307aWYod2luZG93LmFkZEV2ZW50TGlzdGVuZXIpe3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLGxvZzRqYXZhc2NyaXB0LnNldERvY3VtZW50UmVhZHksZmFsc2UpO31lbHNlIGlmKHdpbmRvdy5hdHRhY2hFdmVudCl7d2luZG93LmF0dGFjaEV2ZW50KFwib25sb2FkXCIsbG9nNGphdmFzY3JpcHQuc2V0RG9jdW1lbnRSZWFkeSk7fWVsc2V7dmFyIG9sZE9ubG9hZD13aW5kb3cub25sb2FkO2lmKHR5cGVvZiB3aW5kb3cub25sb2FkIT1cImZ1bmN0aW9uXCIpe3dpbmRvdy5vbmxvYWQ9bG9nNGphdmFzY3JpcHQuc2V0RG9jdW1lbnRSZWFkeTt9ZWxzZXt3aW5kb3cub25sb2FkPWZ1bmN0aW9uKGV2dCl7aWYob2xkT25sb2FkKXtvbGRPbmxvYWQoZXZ0KTt9XHJcbmxvZzRqYXZhc2NyaXB0LnNldERvY3VtZW50UmVhZHkoKTt9O319XHJcbnJldHVybiBsb2c0amF2YXNjcmlwdDt9LHRoaXMpO1xyXG4iLCIhZnVuY3Rpb24odCxyKXtcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cyYmXCJvYmplY3RcIj09dHlwZW9mIG1vZHVsZT9tb2R1bGUuZXhwb3J0cz1yKCk6XCJmdW5jdGlvblwiPT10eXBlb2YgZGVmaW5lJiZkZWZpbmUuYW1kP2RlZmluZShbXSxyKTpcIm9iamVjdFwiPT10eXBlb2YgZXhwb3J0cz9leHBvcnRzLk1lc3NhZ2VGb3JtYXQ9cigpOnQuTWVzc2FnZUZvcm1hdD1yKCl9KHRoaXMsZnVuY3Rpb24oKXtyZXR1cm4gZnVuY3Rpb24odCl7dmFyIHI9e307ZnVuY3Rpb24gZShuKXtpZihyW25dKXJldHVybiByW25dLmV4cG9ydHM7dmFyIG89cltuXT17aTpuLGw6ITEsZXhwb3J0czp7fX07cmV0dXJuIHRbbl0uY2FsbChvLmV4cG9ydHMsbyxvLmV4cG9ydHMsZSksby5sPSEwLG8uZXhwb3J0c31yZXR1cm4gZS5tPXQsZS5jPXIsZS5kPWZ1bmN0aW9uKHQscixuKXtlLm8odCxyKXx8T2JqZWN0LmRlZmluZVByb3BlcnR5KHQscix7ZW51bWVyYWJsZTohMCxnZXQ6bn0pfSxlLnI9ZnVuY3Rpb24odCl7XCJ1bmRlZmluZWRcIiE9dHlwZW9mIFN5bWJvbCYmU3ltYm9sLnRvU3RyaW5nVGFnJiZPYmplY3QuZGVmaW5lUHJvcGVydHkodCxTeW1ib2wudG9TdHJpbmdUYWcse3ZhbHVlOlwiTW9kdWxlXCJ9KSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxcIl9fZXNNb2R1bGVcIix7dmFsdWU6ITB9KX0sZS50PWZ1bmN0aW9uKHQscil7aWYoMSZyJiYodD1lKHQpKSw4JnIpcmV0dXJuIHQ7aWYoNCZyJiZcIm9iamVjdFwiPT10eXBlb2YgdCYmdCYmdC5fX2VzTW9kdWxlKXJldHVybiB0O3ZhciBuPU9iamVjdC5jcmVhdGUobnVsbCk7aWYoZS5yKG4pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLFwiZGVmYXVsdFwiLHtlbnVtZXJhYmxlOiEwLHZhbHVlOnR9KSwyJnImJlwic3RyaW5nXCIhPXR5cGVvZiB0KWZvcih2YXIgbyBpbiB0KWUuZChuLG8sZnVuY3Rpb24ocil7cmV0dXJuIHRbcl19LmJpbmQobnVsbCxvKSk7cmV0dXJuIG59LGUubj1mdW5jdGlvbih0KXt2YXIgcj10JiZ0Ll9fZXNNb2R1bGU/ZnVuY3Rpb24oKXtyZXR1cm4gdC5kZWZhdWx0fTpmdW5jdGlvbigpe3JldHVybiB0fTtyZXR1cm4gZS5kKHIsXCJhXCIscikscn0sZS5vPWZ1bmN0aW9uKHQscil7cmV0dXJuIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbCh0LHIpfSxlLnA9XCJcIixlKGUucz04KX0oW2Z1bmN0aW9uKHQscixlKXt2YXIgbixvO3ZvaWQgMD09PShvPVwiZnVuY3Rpb25cIj09dHlwZW9mKG49e2FmOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGFrOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGFtOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9LGFyOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dCxvPW4mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjowPT10P1wiemVyb1wiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6bz49MyYmbzw9MTA/XCJmZXdcIjpvPj0xMSYmbzw9OTk/XCJtYW55XCI6XCJvdGhlclwifSxhcnM6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXQ/XCJ6ZXJvXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpvPj0zJiZvPD0xMD9cImZld1wiOm8+PTExJiZvPD05OT9cIm1hbnlcIjpcIm90aGVyXCJ9LGFzOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/MT09dHx8NT09dHx8Nz09dHx8OD09dHx8OT09dHx8MTA9PXQ/XCJvbmVcIjoyPT10fHwzPT10P1widHdvXCI6ND09dD9cImZld1wiOjY9PXQ/XCJtYW55XCI6XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9LGFzYTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxhc3Q6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGF6OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1uLnNsaWNlKC0xKSxpPW4uc2xpY2UoLTIpLHU9bi5zbGljZSgtMyk7cmV0dXJuIHI/MT09b3x8Mj09b3x8NT09b3x8Nz09b3x8OD09b3x8MjA9PWl8fDUwPT1pfHw3MD09aXx8ODA9PWk/XCJvbmVcIjozPT1vfHw0PT1vfHwxMDA9PXV8fDIwMD09dXx8MzAwPT11fHw0MDA9PXV8fDUwMD09dXx8NjAwPT11fHw3MDA9PXV8fDgwMD09dXx8OTAwPT11P1wiZmV3XCI6MD09bnx8Nj09b3x8NDA9PWl8fDYwPT1pfHw5MD09aT9cIm1hbnlcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sYmU6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMSksaT1uJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj8yIT1vJiYzIT1vfHwxMj09aXx8MTM9PWk/XCJvdGhlclwiOlwiZmV3XCI6MT09byYmMTEhPWk/XCJvbmVcIjpvPj0yJiZvPD00JiYoaTwxMnx8aT4xNCk/XCJmZXdcIjpuJiYwPT1vfHxvPj01JiZvPD05fHxpPj0xMSYmaTw9MTQ/XCJtYW55XCI6XCJvdGhlclwifSxiZW06ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sYmV6OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJnOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJoOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGJtOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxibjpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXR8fDU9PXR8fDc9PXR8fDg9PXR8fDk9PXR8fDEwPT10P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjo2PT10P1wibWFueVwiOlwib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxibzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sYnI6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10LG89biYmZVswXS5zbGljZSgtMSksaT1uJiZlWzBdLnNsaWNlKC0yKSx1PW4mJmVbMF0uc2xpY2UoLTYpO3JldHVybiByP1wib3RoZXJcIjoxPT1vJiYxMSE9aSYmNzEhPWkmJjkxIT1pP1wib25lXCI6Mj09byYmMTIhPWkmJjcyIT1pJiY5MiE9aT9cInR3b1wiOigzPT1vfHw0PT1vfHw5PT1vKSYmKGk8MTB8fGk+MTkpJiYoaTw3MHx8aT43OSkmJihpPDkwfHxpPjk5KT9cImZld1wiOjAhPXQmJm4mJjA9PXU/XCJtYW55XCI6XCJvdGhlclwifSxicng6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sYnM6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTEpLGE9bi5zbGljZSgtMiksYz1vLnNsaWNlKC0xKSxoPW8uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjppJiYxPT11JiYxMSE9YXx8MT09YyYmMTEhPWg/XCJvbmVcIjppJiZ1Pj0yJiZ1PD00JiYoYTwxMnx8YT4xNCl8fGM+PTImJmM8PTQmJihoPDEyfHxoPjE0KT9cImZld1wiOlwib3RoZXJcIn0sY2E6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/MT09dHx8Mz09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjo0PT10P1wiZmV3XCI6XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGNlOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGNnZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxjaHI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sY2tiOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGNzOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbz9cIm9uZVwiOm4+PTImJm48PTQmJm8/XCJmZXdcIjpvP1wib3RoZXJcIjpcIm1hbnlcIn0sY3k6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj8wPT10fHw3PT10fHw4PT10fHw5PT10P1wiemVyb1wiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6Mz09dHx8ND09dD9cImZld1wiOjU9PXR8fDY9PXQ/XCJtYW55XCI6XCJvdGhlclwiOjA9PXQ/XCJ6ZXJvXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjozPT10P1wiZmV3XCI6Nj09dD9cIm1hbnlcIjpcIm90aGVyXCJ9LGRhOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1OdW1iZXIoZVswXSk9PXQ7cmV0dXJuIHI/XCJvdGhlclwiOjEhPXQmJihvfHwwIT1uJiYxIT1uKT9cIm90aGVyXCI6XCJvbmVcIn0sZGU6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGRzYjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMiksYT1vLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMT09dXx8MT09YT9cIm9uZVwiOmkmJjI9PXV8fDI9PWE/XCJ0d29cIjppJiYoMz09dXx8ND09dSl8fDM9PWF8fDQ9PWE/XCJmZXdcIjpcIm90aGVyXCJ9LGR2OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGR6OmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxlZTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxlbDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxlbjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXSxvPU51bWJlcihlWzBdKT09dCxpPW8mJmVbMF0uc2xpY2UoLTEpLHU9byYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/MT09aSYmMTEhPXU/XCJvbmVcIjoyPT1pJiYxMiE9dT9cInR3b1wiOjM9PWkmJjEzIT11P1wiZmV3XCI6XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGVvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGVzOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGV0OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxldTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxmYTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxmZjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PDI/XCJvbmVcIjpcIm90aGVyXCJ9LGZpOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxmaWw6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTEpLGE9by5zbGljZSgtMSk7cmV0dXJuIHI/MT09dD9cIm9uZVwiOlwib3RoZXJcIjppJiYoMT09bnx8Mj09bnx8Mz09bil8fGkmJjQhPXUmJjYhPXUmJjkhPXV8fCFpJiY0IT1hJiY2IT1hJiY5IT1hP1wib25lXCI6XCJvdGhlclwifSxmbzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxmcjpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXQ/XCJvbmVcIjpcIm90aGVyXCI6dD49MCYmdDwyP1wib25lXCI6XCJvdGhlclwifSxmdXI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sZnk6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGdhOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj8xPT10P1wib25lXCI6XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6biYmdD49MyYmdDw9Nj9cImZld1wiOm4mJnQ+PTcmJnQ8PTEwP1wibWFueVwiOlwib3RoZXJcIn0sZ2Q6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10O3JldHVybiByPzE9PXR8fDExPT10P1wib25lXCI6Mj09dHx8MTI9PXQ/XCJ0d29cIjozPT10fHwxMz09dD9cImZld1wiOlwib3RoZXJcIjoxPT10fHwxMT09dD9cIm9uZVwiOjI9PXR8fDEyPT10P1widHdvXCI6biYmdD49MyYmdDw9MTB8fG4mJnQ+PTEzJiZ0PD0xOT9cImZld1wiOlwib3RoZXJcIn0sZ2w6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LGdzdzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxndTpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXQ/XCJvbmVcIjoyPT10fHwzPT10P1widHdvXCI6ND09dD9cImZld1wiOjY9PXQ/XCJtYW55XCI6XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9LGd1dzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSxndjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV0saT1uLnNsaWNlKC0xKSx1PW4uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjpvJiYxPT1pP1wib25lXCI6byYmMj09aT9cInR3b1wiOiFvfHwwIT11JiYyMCE9dSYmNDAhPXUmJjYwIT11JiY4MCE9dT9vP1wib3RoZXJcIjpcIm1hbnlcIjpcImZld1wifSxoYTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxoYXc6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0saGU6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPSFlWzFdLGk9TnVtYmVyKGVbMF0pPT10LHU9aSYmZVswXS5zbGljZSgtMSk7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm8/XCJvbmVcIjoyPT1uJiZvP1widHdvXCI6byYmKHQ8MHx8dD4xMCkmJmkmJjA9PXU/XCJtYW55XCI6XCJvdGhlclwifSxoaTpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXQ/XCJvbmVcIjoyPT10fHwzPT10P1widHdvXCI6ND09dD9cImZld1wiOjY9PXQ/XCJtYW55XCI6XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9LGhyOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiLGk9IWVbMV0sdT1uLnNsaWNlKC0xKSxhPW4uc2xpY2UoLTIpLGM9by5zbGljZSgtMSksaD1vLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMT09dSYmMTEhPWF8fDE9PWMmJjExIT1oP1wib25lXCI6aSYmdT49MiYmdTw9NCYmKGE8MTJ8fGE+MTQpfHxjPj0yJiZjPD00JiYoaDwxMnx8aD4xNCk/XCJmZXdcIjpcIm90aGVyXCJ9LGhzYjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMiksYT1vLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMT09dXx8MT09YT9cIm9uZVwiOmkmJjI9PXV8fDI9PWE/XCJ0d29cIjppJiYoMz09dXx8ND09dSl8fDM9PWF8fDQ9PWE/XCJmZXdcIjpcIm90aGVyXCJ9LGh1OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/MT09dHx8NT09dD9cIm9uZVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxoeTpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXQ/XCJvbmVcIjpcIm90aGVyXCI6dD49MCYmdDwyP1wib25lXCI6XCJvdGhlclwifSxpYTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0saWQ6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGlnOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxpaTpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0saW46ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGlvOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxpczpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89TnVtYmVyKGVbMF0pPT10LGk9bi5zbGljZSgtMSksdT1uLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6byYmMT09aSYmMTEhPXV8fCFvP1wib25lXCI6XCJvdGhlclwifSxpdDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj8xMT09dHx8OD09dHx8ODA9PXR8fDgwMD09dD9cIm1hbnlcIjpcIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0saXU6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LGl3OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXSxpPU51bWJlcihlWzBdKT09dCx1PWkmJmVbMF0uc2xpY2UoLTEpO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZvP1wib25lXCI6Mj09biYmbz9cInR3b1wiOm8mJih0PDB8fHQ+MTApJiZpJiYwPT11P1wibWFueVwiOlwib3RoZXJcIn0samE6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGpibzpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0samdvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGppOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxqbWM6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sanY6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGp3OmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxrYTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89bi5zbGljZSgtMik7cmV0dXJuIHI/MT09bj9cIm9uZVwiOjA9PW58fG8+PTImJm88PTIwfHw0MD09b3x8NjA9PW98fDgwPT1vP1wibWFueVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxrYWI6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6dD49MCYmdDwyP1wib25lXCI6XCJvdGhlclwifSxrYWo6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa2NnOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGtkZTpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sa2VhOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxrazpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQsbz1uJiZlWzBdLnNsaWNlKC0xKTtyZXR1cm4gcj82PT1vfHw5PT1vfHxuJiYwPT1vJiYwIT10P1wibWFueVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxra2o6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa2w6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa206ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LGtuOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9LGtvOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxrczpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxrc2I6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa3NoOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXQ/XCJ6ZXJvXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa3U6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sa3c6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LGt5OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGxhZzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdO3JldHVybiByP1wib3RoZXJcIjowPT10P1wiemVyb1wiOjAhPW4mJjEhPW58fDA9PXQ/XCJvdGhlclwiOlwib25lXCJ9LGxiOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGxnOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LGxrdDpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0sbG46ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbG86ZnVuY3Rpb24odCxyKXtyZXR1cm4gciYmMT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbHQ6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVsxXXx8XCJcIixvPU51bWJlcihlWzBdKT09dCxpPW8mJmVbMF0uc2xpY2UoLTEpLHU9byYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOjE9PWkmJih1PDExfHx1PjE5KT9cIm9uZVwiOmk+PTImJmk8PTkmJih1PDExfHx1PjE5KT9cImZld1wiOjAhPW4/XCJtYW55XCI6XCJvdGhlclwifSxsdjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzFdfHxcIlwiLG89bi5sZW5ndGgsaT1OdW1iZXIoZVswXSk9PXQsdT1pJiZlWzBdLnNsaWNlKC0xKSxhPWkmJmVbMF0uc2xpY2UoLTIpLGM9bi5zbGljZSgtMiksaD1uLnNsaWNlKC0xKTtyZXR1cm4gcj9cIm90aGVyXCI6aSYmMD09dXx8YT49MTEmJmE8PTE5fHwyPT1vJiZjPj0xMSYmYzw9MTk/XCJ6ZXJvXCI6MT09dSYmMTEhPWF8fDI9PW8mJjE9PWgmJjExIT1jfHwyIT1vJiYxPT1oP1wib25lXCI6XCJvdGhlclwifSxtYXM6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbWc6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbWdvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG1rOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiLGk9IWVbMV0sdT1uLnNsaWNlKC0xKSxhPW4uc2xpY2UoLTIpLGM9by5zbGljZSgtMSksaD1vLnNsaWNlKC0yKTtyZXR1cm4gcj8xPT11JiYxMSE9YT9cIm9uZVwiOjI9PXUmJjEyIT1hP1widHdvXCI6NyE9dSYmOCE9dXx8MTc9PWF8fDE4PT1hP1wib3RoZXJcIjpcIm1hbnlcIjppJiYxPT11JiYxMSE9YXx8MT09YyYmMTEhPWg/XCJvbmVcIjpcIm90aGVyXCJ9LG1sOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG1uOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG1vOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdLG89TnVtYmVyKGVbMF0pPT10LGk9byYmZVswXS5zbGljZSgtMik7cmV0dXJuIHI/MT09dD9cIm9uZVwiOlwib3RoZXJcIjoxPT10JiZuP1wib25lXCI6IW58fDA9PXR8fDEhPXQmJmk+PTEmJmk8PTE5P1wiZmV3XCI6XCJvdGhlclwifSxtcjpmdW5jdGlvbih0LHIpe3JldHVybiByPzE9PXQ/XCJvbmVcIjoyPT10fHwzPT10P1widHdvXCI6ND09dD9cImZld1wiOlwib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6XCJvdGhlclwifSxtczpmdW5jdGlvbih0LHIpe3JldHVybiByJiYxPT10P1wib25lXCI6XCJvdGhlclwifSxtdDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQsbz1uJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjA9PXR8fG8+PTImJm88PTEwP1wiZmV3XCI6bz49MTEmJm88PTE5P1wibWFueVwiOlwib3RoZXJcIn0sbXk6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LG5haDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxuYXE6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LG5iOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG5kOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG5lOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj9uJiZ0Pj0xJiZ0PD00P1wib25lXCI6XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG5sOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByP1wib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxubjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxubmg6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbm86ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbnFvOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxucjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxuc286ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MD09dHx8MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbnk6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sbnluOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG9tOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LG9yOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPU51bWJlcihlWzBdKT09dDtyZXR1cm4gcj8xPT10fHw1PT10fHxuJiZ0Pj03JiZ0PD05P1wib25lXCI6Mj09dHx8Mz09dD9cInR3b1wiOjQ9PXQ/XCJmZXdcIjo2PT10P1wibWFueVwiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxvczpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxwYTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSxwYXA6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0scGw6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPSFlWzFdLGk9bi5zbGljZSgtMSksdT1uLnNsaWNlKC0yKTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbz9cIm9uZVwiOm8mJmk+PTImJmk8PTQmJih1PDEyfHx1PjE0KT9cImZld1wiOm8mJjEhPW4mJigwPT1pfHwxPT1pKXx8byYmaT49NSYmaTw9OXx8byYmdT49MTImJnU8PTE0P1wibWFueVwiOlwib3RoZXJcIn0scHJnOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMV18fFwiXCIsbz1uLmxlbmd0aCxpPU51bWJlcihlWzBdKT09dCx1PWkmJmVbMF0uc2xpY2UoLTEpLGE9aSYmZVswXS5zbGljZSgtMiksYz1uLnNsaWNlKC0yKSxoPW4uc2xpY2UoLTEpO3JldHVybiByP1wib3RoZXJcIjppJiYwPT11fHxhPj0xMSYmYTw9MTl8fDI9PW8mJmM+PTExJiZjPD0xOT9cInplcm9cIjoxPT11JiYxMSE9YXx8Mj09byYmMT09aCYmMTEhPWN8fDIhPW8mJjE9PWg/XCJvbmVcIjpcIm90aGVyXCJ9LHBzOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHB0OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF07cmV0dXJuIHI/XCJvdGhlclwiOjA9PW58fDE9PW4/XCJvbmVcIjpcIm90aGVyXCJ9LFwicHQtUFRcIjpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0scm06ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0scm86ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV0sbz1OdW1iZXIoZVswXSk9PXQsaT1vJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj8xPT10P1wib25lXCI6XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjohbnx8MD09dHx8MSE9dCYmaT49MSYmaTw9MTk/XCJmZXdcIjpcIm90aGVyXCJ9LHJvZjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxyb290OmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxydTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV0saT1uLnNsaWNlKC0xKSx1PW4uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjpvJiYxPT1pJiYxMSE9dT9cIm9uZVwiOm8mJmk+PTImJmk8PTQmJih1PDEyfHx1PjE0KT9cImZld1wiOm8mJjA9PWl8fG8mJmk+PTUmJmk8PTl8fG8mJnU+PTExJiZ1PD0xND9cIm1hbnlcIjpcIm90aGVyXCJ9LHJ3azpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzYWg6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHNhcTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzYzpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj8xMT09dHx8OD09dHx8ODA9PXR8fDgwMD09dD9cIm1hbnlcIjpcIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sc2NuOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdO3JldHVybiByPzExPT10fHw4PT10fHw4MD09dHx8ODAwPT10P1wibWFueVwiOlwib3RoZXJcIjoxPT10JiZuP1wib25lXCI6XCJvdGhlclwifSxzZDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzZGg6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc2U6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LHNlaDpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzZXM6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHNnOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSxzaDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMSksYT1uLnNsaWNlKC0yKSxjPW8uc2xpY2UoLTEpLGg9by5zbGljZSgtMik7cmV0dXJuIHI/XCJvdGhlclwiOmkmJjE9PXUmJjExIT1hfHwxPT1jJiYxMSE9aD9cIm9uZVwiOmkmJnU+PTImJnU8PTQmJihhPDEyfHxhPjE0KXx8Yz49MiYmYzw9NCYmKGg8MTJ8fGg+MTQpP1wiZmV3XCI6XCJvdGhlclwifSxzaGk6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10O3JldHVybiByP1wib3RoZXJcIjp0Pj0wJiZ0PD0xP1wib25lXCI6biYmdD49MiYmdDw9MTA/XCJmZXdcIjpcIm90aGVyXCJ9LHNpOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz1lWzFdfHxcIlwiO3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10fHwwPT1uJiYxPT1vP1wib25lXCI6XCJvdGhlclwifSxzazpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm8/XCJvbmVcIjpuPj0yJiZuPD00JiZvP1wiZmV3XCI6bz9cIm90aGVyXCI6XCJtYW55XCJ9LHNsOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXSxpPW4uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjpvJiYxPT1pP1wib25lXCI6byYmMj09aT9cInR3b1wiOm8mJigzPT1pfHw0PT1pKXx8IW8/XCJmZXdcIjpcIm90aGVyXCJ9LHNtYTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOlwib3RoZXJcIn0sc21pOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxzbWo6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOjI9PXQ/XCJ0d29cIjpcIm90aGVyXCJ9LHNtbjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6Mj09dD9cInR3b1wiOlwib3RoZXJcIn0sc21zOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjoyPT10P1widHdvXCI6XCJvdGhlclwifSxzbjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzbzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSxzcTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQsbz1uJiZlWzBdLnNsaWNlKC0xKSxpPW4mJmVbMF0uc2xpY2UoLTIpO3JldHVybiByPzE9PXQ/XCJvbmVcIjo0PT1vJiYxNCE9aT9cIm1hbnlcIjpcIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc3I6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49ZVswXSxvPWVbMV18fFwiXCIsaT0hZVsxXSx1PW4uc2xpY2UoLTEpLGE9bi5zbGljZSgtMiksYz1vLnNsaWNlKC0xKSxoPW8uc2xpY2UoLTIpO3JldHVybiByP1wib3RoZXJcIjppJiYxPT11JiYxMSE9YXx8MT09YyYmMTEhPWg/XCJvbmVcIjppJiZ1Pj0yJiZ1PD00JiYoYTwxMnx8YT4xNCl8fGM+PTImJmM8PTQmJihoPDEyfHxoPjE0KT9cImZld1wiOlwib3RoZXJcIn0sc3M6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sc3N5OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHN0OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHN2OmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPSFlWzFdLG89TnVtYmVyKGVbMF0pPT10LGk9byYmZVswXS5zbGljZSgtMSksdT1vJiZlWzBdLnNsaWNlKC0yKTtyZXR1cm4gcj8xIT1pJiYyIT1pfHwxMT09dXx8MTI9PXU/XCJvdGhlclwiOlwib25lXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0sc3c6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHN5cjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0YTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0ZTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0ZW86ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sdGg6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHRpOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjA9PXR8fDE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHRpZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0azpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1OdW1iZXIoZVswXSk9PXQsbz1uJiZlWzBdLnNsaWNlKC0xKTtyZXR1cm4gcj82PT1vfHw5PT1vfHwxMD09dD9cImZld1wiOlwib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0bDpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj1lWzBdLG89ZVsxXXx8XCJcIixpPSFlWzFdLHU9bi5zbGljZSgtMSksYT1vLnNsaWNlKC0xKTtyZXR1cm4gcj8xPT10P1wib25lXCI6XCJvdGhlclwiOmkmJigxPT1ufHwyPT1ufHwzPT1uKXx8aSYmNCE9dSYmNiE9dSYmOSE9dXx8IWkmJjQhPWEmJjYhPWEmJjkhPWE/XCJvbmVcIjpcIm90aGVyXCJ9LHRuOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHRvOmZ1bmN0aW9uKHQscil7cmV0dXJuXCJvdGhlclwifSx0cjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0czpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx0em06ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49TnVtYmVyKGVbMF0pPT10O3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10fHxuJiZ0Pj0xMSYmdDw9OTk/XCJvbmVcIjpcIm90aGVyXCJ9LHVnOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHVrOmZ1bmN0aW9uKHQscil7dmFyIGU9U3RyaW5nKHQpLnNwbGl0KFwiLlwiKSxuPWVbMF0sbz0hZVsxXSxpPU51bWJlcihlWzBdKT09dCx1PWkmJmVbMF0uc2xpY2UoLTEpLGE9aSYmZVswXS5zbGljZSgtMiksYz1uLnNsaWNlKC0xKSxoPW4uc2xpY2UoLTIpO3JldHVybiByPzM9PXUmJjEzIT1hP1wiZmV3XCI6XCJvdGhlclwiOm8mJjE9PWMmJjExIT1oP1wib25lXCI6byYmYz49MiYmYzw9NCYmKGg8MTJ8fGg+MTQpP1wiZmV3XCI6byYmMD09Y3x8byYmYz49NSYmYzw9OXx8byYmaD49MTEmJmg8PTE0P1wibWFueVwiOlwib3RoZXJcIn0sdXI6ZnVuY3Rpb24odCxyKXt2YXIgZT1TdHJpbmcodCkuc3BsaXQoXCIuXCIpLG49IWVbMV07cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQmJm4/XCJvbmVcIjpcIm90aGVyXCJ9LHV6OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHZlOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHZpOmZ1bmN0aW9uKHQscil7cmV0dXJuIHImJjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHZvOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHZ1bjpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx3YTpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjowPT10fHwxPT10P1wib25lXCI6XCJvdGhlclwifSx3YWU6ZnVuY3Rpb24odCxyKXtyZXR1cm4gcj9cIm90aGVyXCI6MT09dD9cIm9uZVwiOlwib3RoZXJcIn0sd286ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHhoOmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOjE9PXQ/XCJvbmVcIjpcIm90aGVyXCJ9LHhvZzpmdW5jdGlvbih0LHIpe3JldHVybiByP1wib3RoZXJcIjoxPT10P1wib25lXCI6XCJvdGhlclwifSx5aTpmdW5jdGlvbih0LHIpe3ZhciBlPVN0cmluZyh0KS5zcGxpdChcIi5cIiksbj0hZVsxXTtyZXR1cm4gcj9cIm90aGVyXCI6MT09dCYmbj9cIm9uZVwiOlwib3RoZXJcIn0seW86ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHl1ZTpmdW5jdGlvbih0LHIpe3JldHVyblwib3RoZXJcIn0semg6ZnVuY3Rpb24odCxyKXtyZXR1cm5cIm90aGVyXCJ9LHp1OmZ1bmN0aW9uKHQscil7cmV0dXJuIHI/XCJvdGhlclwiOnQ+PTAmJnQ8PTE/XCJvbmVcIjpcIm90aGVyXCJ9fSk/bi5jYWxsKHIsZSxyLHQpOm4pfHwodC5leHBvcnRzPW8pfSxmdW5jdGlvbih0LHIsZSl7dC5leHBvcnRzPXtkYXRlOmUoNCksZHVyYXRpb246ZSg1KSxudW1iZXI6ZSg2KSx0aW1lOmUoNyl9fSxmdW5jdGlvbih0LHIsZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gbih0LHIsZSxvKXt0aGlzLm1lc3NhZ2U9dCx0aGlzLmV4cGVjdGVkPXIsdGhpcy5mb3VuZD1lLHRoaXMubG9jYXRpb249byx0aGlzLm5hbWU9XCJTeW50YXhFcnJvclwiLFwiZnVuY3Rpb25cIj09dHlwZW9mIEVycm9yLmNhcHR1cmVTdGFja1RyYWNlJiZFcnJvci5jYXB0dXJlU3RhY2tUcmFjZSh0aGlzLG4pfSFmdW5jdGlvbih0LHIpe2Z1bmN0aW9uIGUoKXt0aGlzLmNvbnN0cnVjdG9yPXR9ZS5wcm90b3R5cGU9ci5wcm90b3R5cGUsdC5wcm90b3R5cGU9bmV3IGV9KG4sRXJyb3IpLG4uYnVpbGRNZXNzYWdlPWZ1bmN0aW9uKHQscil7dmFyIGU9e2xpdGVyYWw6ZnVuY3Rpb24odCl7cmV0dXJuJ1wiJytvKHQudGV4dCkrJ1wiJ30sY2xhc3M6ZnVuY3Rpb24odCl7dmFyIHIsZT1cIlwiO2ZvcihyPTA7cjx0LnBhcnRzLmxlbmd0aDtyKyspZSs9dC5wYXJ0c1tyXWluc3RhbmNlb2YgQXJyYXk/aSh0LnBhcnRzW3JdWzBdKStcIi1cIitpKHQucGFydHNbcl1bMV0pOmkodC5wYXJ0c1tyXSk7cmV0dXJuXCJbXCIrKHQuaW52ZXJ0ZWQ/XCJeXCI6XCJcIikrZStcIl1cIn0sYW55OmZ1bmN0aW9uKHQpe3JldHVyblwiYW55IGNoYXJhY3RlclwifSxlbmQ6ZnVuY3Rpb24odCl7cmV0dXJuXCJlbmQgb2YgaW5wdXRcIn0sb3RoZXI6ZnVuY3Rpb24odCl7cmV0dXJuIHQuZGVzY3JpcHRpb259fTtmdW5jdGlvbiBuKHQpe3JldHVybiB0LmNoYXJDb2RlQXQoMCkudG9TdHJpbmcoMTYpLnRvVXBwZXJDYXNlKCl9ZnVuY3Rpb24gbyh0KXtyZXR1cm4gdC5yZXBsYWNlKC9cXFxcL2csXCJcXFxcXFxcXFwiKS5yZXBsYWNlKC9cIi9nLCdcXFxcXCInKS5yZXBsYWNlKC9cXDAvZyxcIlxcXFwwXCIpLnJlcGxhY2UoL1xcdC9nLFwiXFxcXHRcIikucmVwbGFjZSgvXFxuL2csXCJcXFxcblwiKS5yZXBsYWNlKC9cXHIvZyxcIlxcXFxyXCIpLnJlcGxhY2UoL1tcXHgwMC1cXHgwRl0vZyxmdW5jdGlvbih0KXtyZXR1cm5cIlxcXFx4MFwiK24odCl9KS5yZXBsYWNlKC9bXFx4MTAtXFx4MUZcXHg3Ri1cXHg5Rl0vZyxmdW5jdGlvbih0KXtyZXR1cm5cIlxcXFx4XCIrbih0KX0pfWZ1bmN0aW9uIGkodCl7cmV0dXJuIHQucmVwbGFjZSgvXFxcXC9nLFwiXFxcXFxcXFxcIikucmVwbGFjZSgvXFxdL2csXCJcXFxcXVwiKS5yZXBsYWNlKC9cXF4vZyxcIlxcXFxeXCIpLnJlcGxhY2UoLy0vZyxcIlxcXFwtXCIpLnJlcGxhY2UoL1xcMC9nLFwiXFxcXDBcIikucmVwbGFjZSgvXFx0L2csXCJcXFxcdFwiKS5yZXBsYWNlKC9cXG4vZyxcIlxcXFxuXCIpLnJlcGxhY2UoL1xcci9nLFwiXFxcXHJcIikucmVwbGFjZSgvW1xceDAwLVxceDBGXS9nLGZ1bmN0aW9uKHQpe3JldHVyblwiXFxcXHgwXCIrbih0KX0pLnJlcGxhY2UoL1tcXHgxMC1cXHgxRlxceDdGLVxceDlGXS9nLGZ1bmN0aW9uKHQpe3JldHVyblwiXFxcXHhcIituKHQpfSl9cmV0dXJuXCJFeHBlY3RlZCBcIitmdW5jdGlvbih0KXt2YXIgcixuLG8saT1uZXcgQXJyYXkodC5sZW5ndGgpO2ZvcihyPTA7cjx0Lmxlbmd0aDtyKyspaVtyXT0obz10W3JdLGVbby50eXBlXShvKSk7aWYoaS5zb3J0KCksaS5sZW5ndGg+MCl7Zm9yKHI9MSxuPTE7cjxpLmxlbmd0aDtyKyspaVtyLTFdIT09aVtyXSYmKGlbbl09aVtyXSxuKyspO2kubGVuZ3RoPW59c3dpdGNoKGkubGVuZ3RoKXtjYXNlIDE6cmV0dXJuIGlbMF07Y2FzZSAyOnJldHVybiBpWzBdK1wiIG9yIFwiK2lbMV07ZGVmYXVsdDpyZXR1cm4gaS5zbGljZSgwLC0xKS5qb2luKFwiLCBcIikrXCIsIG9yIFwiK2lbaS5sZW5ndGgtMV19fSh0KStcIiBidXQgXCIrZnVuY3Rpb24odCl7cmV0dXJuIHQ/J1wiJytvKHQpKydcIic6XCJlbmQgb2YgaW5wdXRcIn0ocikrXCIgZm91bmQuXCJ9LHQuZXhwb3J0cz17U3ludGF4RXJyb3I6bixwYXJzZTpmdW5jdGlvbih0LHIpe3I9dm9pZCAwIT09cj9yOnt9O3ZhciBlLG89e30saT17c3RhcnQ6dHJ9LHU9dHIsYT1cIiNcIixjPUl0KFwiI1wiLCExKSxoPWZ1bmN0aW9uKCl7cmV0dXJuIHByWzBdfSxmPWZ1bmN0aW9uKCl7cmV0dXJue3R5cGU6XCJvY3RvdGhvcnBlXCJ9fSxzPWZ1bmN0aW9uKHQpe3JldHVybiB0LmpvaW4oXCJcIil9LGw9XCJ7XCIscD1JdChcIntcIiwhMSksbT1cIn1cIixkPUl0KFwifVwiLCExKSx5PWZ1bmN0aW9uKHQpe3JldHVybnt0eXBlOlwiYXJndW1lbnRcIixhcmc6dH19LGc9XCIsXCIsdj1JdChcIixcIiwhMSksdz1cInNlbGVjdFwiLGI9SXQoXCJzZWxlY3RcIiwhMSksUz1mdW5jdGlvbih0LGUpe3JldHVybiByLnN0cmljdCYmcHIudW5zaGlmdCghMSksZX0saz1mdW5jdGlvbih0LGUpe3JldHVybiByLnN0cmljdCYmcHIuc2hpZnQoKSx7dHlwZTpcInNlbGVjdFwiLGFyZzp0LGNhc2VzOmV9fSx4PVwicGx1cmFsXCIsQT1JdChcInBsdXJhbFwiLCExKSxqPVwic2VsZWN0b3JkaW5hbFwiLE49SXQoXCJzZWxlY3RvcmRpbmFsXCIsITEpLEM9ZnVuY3Rpb24odCxyKXtyZXR1cm4gcHIudW5zaGlmdCghMCkscn0sRj1mdW5jdGlvbih0LGUsbixvKXt2YXIgaT0oXCJzZWxlY3RvcmRpbmFsXCI9PT1lP3Iub3JkaW5hbDpyLmNhcmRpbmFsKXx8W1wiemVyb1wiLFwib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl07cmV0dXJuIGkmJmkubGVuZ3RoJiZvLmZvckVhY2goZnVuY3Rpb24ocil7aWYoaXNOYU4oci5rZXkpJiZpLmluZGV4T2Yoci5rZXkpPDApdGhyb3cgbmV3IEVycm9yKFwiSW52YWxpZCBrZXkgYFwiK3Iua2V5K1wiYCBmb3IgYXJndW1lbnQgYFwiK3QrXCJgLiBWYWxpZCBcIitlK1wiIGtleXMgZm9yIHRoaXMgbG9jYWxlIGFyZSBgXCIraS5qb2luKFwiYCwgYFwiKStcImAsIGFuZCBleHBsaWNpdCBrZXlzIGxpa2UgYD0wYC5cIil9KSxwci5zaGlmdCgpLHt0eXBlOmUsYXJnOnQsb2Zmc2V0Om58fDAsY2FzZXM6b319LE89ZnVuY3Rpb24odCxyLGUpe3JldHVybnt0eXBlOlwiZnVuY3Rpb25cIixhcmc6dCxrZXk6cixwYXJhbTplfX0sRT1WdChcImlkZW50aWZpZXJcIiksej0vXlteXFx0LVxcciBcXHg4NVxcdTIwMEVcXHUyMDBGXFx1MjAyOFxcdTIwMjkhLVxcLzotQFstXFxeYHstflxceEExLVxceEE3XFx4QTlcXHhBQlxceEFDXFx4QUVcXHhCMFxceEIxXFx4QjZcXHhCQlxceEJGXFx4RDdcXHhGN1xcdTIwMTAtXFx1MjAyN1xcdTIwMzAtXFx1MjAzRVxcdTIwNDEtXFx1MjA1M1xcdTIwNTUtXFx1MjA1RVxcdTIxOTAtXFx1MjQ1RlxcdTI1MDAtXFx1Mjc3NVxcdTI3OTQtXFx1MkJGRlxcdTJFMDAtXFx1MkU3RlxcdTMwMDEtXFx1MzAwM1xcdTMwMDgtXFx1MzAyMFxcdTMwMzBcXHVGRDNFXFx1RkQzRlxcdUZFNDVcXHVGRTQ2XS8sUD1ZdChbW1wiXFx0XCIsXCJcXHJcIl0sXCIgXCIsXCLChVwiLFwi4oCOXCIsXCLigI9cIixcIlxcdTIwMjhcIixcIlxcdTIwMjlcIixbXCIhXCIsXCIvXCJdLFtcIjpcIixcIkBcIl0sW1wiW1wiLFwiXlwiXSxcImBcIixbXCJ7XCIsXCJ+XCJdLFtcIsKhXCIsXCLCp1wiXSxcIsKpXCIsXCLCq1wiLFwiwqxcIixcIsKuXCIsXCLCsFwiLFwiwrFcIixcIsK2XCIsXCLCu1wiLFwiwr9cIixcIsOXXCIsXCLDt1wiLFtcIuKAkFwiLFwi4oCnXCJdLFtcIuKAsFwiLFwi4oC+XCJdLFtcIuKBgVwiLFwi4oGTXCJdLFtcIuKBlVwiLFwi4oGeXCJdLFtcIuKGkFwiLFwi4pGfXCJdLFtcIuKUgFwiLFwi4p21XCJdLFtcIuKelFwiLFwi4q+/XCJdLFtcIuK4gFwiLFwi4rm/XCJdLFtcIuOAgVwiLFwi44CDXCJdLFtcIuOAiFwiLFwi44CgXCJdLFwi44CwXCIsXCLvtL5cIixcIu+0v1wiLFwi77mFXCIsXCLvuYZcIl0sITAsITEpLEw9ZnVuY3Rpb24odCxyKXtyZXR1cm57a2V5OnQsdG9rZW5zOnJ9fSxKPWZ1bmN0aW9uKHQpe3JldHVybiB0fSxEPVZ0KFwicGx1cmFsIG9mZnNldFwiKSxNPVwib2Zmc2V0XCIsXz1JdChcIm9mZnNldFwiLCExKSxUPVwiOlwiLFI9SXQoXCI6XCIsITEpLEI9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LHE9XCI9XCIsJD1JdChcIj1cIiwhMSksSz1cIm51bWJlclwiLEc9SXQoXCJudW1iZXJcIiwhMSksVT1cImRhdGVcIixaPUl0KFwiZGF0ZVwiLCExKSxJPVwidGltZVwiLFk9SXQoXCJ0aW1lXCIsITEpLFY9XCJzcGVsbG91dFwiLFc9SXQoXCJzcGVsbG91dFwiLCExKSxIPVwib3JkaW5hbFwiLFE9SXQoXCJvcmRpbmFsXCIsITEpLFg9XCJkdXJhdGlvblwiLHR0PUl0KFwiZHVyYXRpb25cIiwhMSkscnQ9ZnVuY3Rpb24odCl7aWYoci5zdHJpY3R8fC9eXFxkLy50ZXN0KHQpKXJldHVybiExO3N3aXRjaCh0LnRvTG93ZXJDYXNlKCkpe2Nhc2VcInNlbGVjdFwiOmNhc2VcInBsdXJhbFwiOmNhc2VcInNlbGVjdG9yZGluYWxcIjpyZXR1cm4hMTtkZWZhdWx0OnJldHVybiEwfX0sZXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LG50PWZ1bmN0aW9uKHQpe3JldHVybiFyLnN0cmljdH0sb3Q9ZnVuY3Rpb24odCl7cmV0dXJue3Rva2Vuczp0fX0saXQ9ZnVuY3Rpb24odCl7cmV0dXJue3Rva2VuczpbdC5qb2luKFwiXCIpXX19LHV0PVZ0KFwiYSB2YWxpZCAoc3RyaWN0KSBmdW5jdGlvbiBwYXJhbWV0ZXJcIiksYXQ9L15bXid7fV0vLGN0PVl0KFtcIidcIixcIntcIixcIn1cIl0sITAsITEpLGh0PWZ1bmN0aW9uKHQpe3JldHVybiB0LmpvaW4oXCJcIil9LGZ0PVwiJ1wiLHN0PUl0KFwiJ1wiLCExKSxsdD1mdW5jdGlvbih0KXtyZXR1cm4gdH0scHQ9ZnVuY3Rpb24odCl7cmV0dXJuXCJ7XCIrdC5qb2luKFwiXCIpK1wifVwifSxtdD1WdChcImRvdWJsZWQgYXBvc3Ryb3BoZVwiKSxkdD1cIicnXCIseXQ9SXQoXCInJ1wiLCExKSxndD1mdW5jdGlvbigpe3JldHVyblwiJ1wifSx2dD0vXlteJ10vLHd0PVl0KFtcIidcIl0sITAsITEpLGJ0PVwiJ3tcIixTdD1JdChcIid7XCIsITEpLGt0PWZ1bmN0aW9uKHQpe3JldHVyblwie1wiK3Quam9pbihcIlwiKX0seHQ9XCInfVwiLEF0PUl0KFwiJ31cIiwhMSksanQ9ZnVuY3Rpb24odCl7cmV0dXJuXCJ9XCIrdC5qb2luKFwiXCIpfSxOdD1WdChcImVzY2FwZWQgc3RyaW5nXCIpLEN0PVwiJyNcIixGdD1JdChcIicjXCIsITEpLE90PWZ1bmN0aW9uKHQpe3JldHVyblwiI1wiK3Quam9pbihcIlwiKX0sRXQ9ZnVuY3Rpb24odCl7cmV0dXJuIHRbMF19LHp0PVZ0KFwicGxhaW4gY2hhclwiKSxQdD0vXltee30jXFwwLVxceDA4XFx4MEUtXFx4MUZcXHg3Rl0vLEx0PVl0KFtcIntcIixcIn1cIixcIiNcIixbXCJcXDBcIixcIlxcYlwiXSxbXCJcdTAwMGVcIixcIlx1MDAxZlwiXSxcIn9cIl0sITAsITEpLEp0PWZ1bmN0aW9uKHQpe3JldHVybiFwclswXX0sRHQ9ZnVuY3Rpb24odCl7cmV0dXJuIHR9LE10PVZ0KFwiaW50ZWdlclwiKSxfdD0vXlswLTldLyxUdD1ZdChbW1wiMFwiLFwiOVwiXV0sITEsITEpLFJ0PVZ0KFwid2hpdGUgc3BhY2VcIiksQnQ9L15bXFx0LVxcciBcXHg4NVxcdTIwMEVcXHUyMDBGXFx1MjAyOFxcdTIwMjldLyxxdD1ZdChbW1wiXFx0XCIsXCJcXHJcIl0sXCIgXCIsXCLChVwiLFwi4oCOXCIsXCLigI9cIixcIlxcdTIwMjhcIixcIlxcdTIwMjlcIl0sITEsITEpLCR0PTAsS3Q9W3tsaW5lOjEsY29sdW1uOjF9XSxHdD0wLFV0PVtdLFp0PTA7aWYoXCJzdGFydFJ1bGVcImluIHIpe2lmKCEoci5zdGFydFJ1bGUgaW4gaSkpdGhyb3cgbmV3IEVycm9yKFwiQ2FuJ3Qgc3RhcnQgcGFyc2luZyBmcm9tIHJ1bGUgXFxcIlwiK3Iuc3RhcnRSdWxlKydcIi4nKTt1PWlbci5zdGFydFJ1bGVdfWZ1bmN0aW9uIEl0KHQscil7cmV0dXJue3R5cGU6XCJsaXRlcmFsXCIsdGV4dDp0LGlnbm9yZUNhc2U6cn19ZnVuY3Rpb24gWXQodCxyLGUpe3JldHVybnt0eXBlOlwiY2xhc3NcIixwYXJ0czp0LGludmVydGVkOnIsaWdub3JlQ2FzZTplfX1mdW5jdGlvbiBWdCh0KXtyZXR1cm57dHlwZTpcIm90aGVyXCIsZGVzY3JpcHRpb246dH19ZnVuY3Rpb24gV3Qocil7dmFyIGUsbj1LdFtyXTtpZihuKXJldHVybiBuO2ZvcihlPXItMTshS3RbZV07KWUtLTtmb3Iobj17bGluZToobj1LdFtlXSkubGluZSxjb2x1bW46bi5jb2x1bW59O2U8cjspMTA9PT10LmNoYXJDb2RlQXQoZSk/KG4ubGluZSsrLG4uY29sdW1uPTEpOm4uY29sdW1uKyssZSsrO3JldHVybiBLdFtyXT1uLG59ZnVuY3Rpb24gSHQodCxyKXt2YXIgZT1XdCh0KSxuPVd0KHIpO3JldHVybntzdGFydDp7b2Zmc2V0OnQsbGluZTplLmxpbmUsY29sdW1uOmUuY29sdW1ufSxlbmQ6e29mZnNldDpyLGxpbmU6bi5saW5lLGNvbHVtbjpuLmNvbHVtbn19fWZ1bmN0aW9uIFF0KHQpeyR0PEd0fHwoJHQ+R3QmJihHdD0kdCxVdD1bXSksVXQucHVzaCh0KSl9ZnVuY3Rpb24gWHQodCxyLGUpe3JldHVybiBuZXcgbihuLmJ1aWxkTWVzc2FnZSh0LHIpLHQscixlKX1mdW5jdGlvbiB0cigpe3ZhciB0LHI7Zm9yKHQ9W10scj1ycigpO3IhPT1vOyl0LnB1c2gocikscj1ycigpO3JldHVybiB0fWZ1bmN0aW9uIHJyKCl7dmFyIHIsZSxuO2lmKChyPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGk7cmV0dXJuIHI9JHQsMTIzPT09dC5jaGFyQ29kZUF0KCR0KT8oZT1sLCR0KyspOihlPW8sMD09PVp0JiZRdChwKSksZSE9PW8mJmxyKCkhPT1vJiYobj1lcigpKSE9PW8mJmxyKCkhPT1vPygxMjU9PT10LmNoYXJDb2RlQXQoJHQpPyhpPW0sJHQrKyk6KGk9bywwPT09WnQmJlF0KGQpKSxpIT09bz8oZT15KG4pLHI9ZSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKSxyfSgpKT09PW8mJihyPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGksdSxhLGMsaCxmO2lmKHI9JHQsMTIzPT09dC5jaGFyQ29kZUF0KCR0KT8oZT1sLCR0KyspOihlPW8sMD09PVp0JiZRdChwKSksZSE9PW8paWYobHIoKSE9PW8paWYoKG49ZXIoKSkhPT1vKWlmKGxyKCkhPT1vKWlmKDQ0PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1nLCR0KyspOihpPW8sMD09PVp0JiZRdCh2KSksaSE9PW8paWYobHIoKSE9PW8paWYoJHQsdC5zdWJzdHIoJHQsNik9PT13Pyh1PXcsJHQrPTYpOih1PW8sMD09PVp0JiZRdChiKSksdSE9PW8mJih1PVMobix1KSksdSE9PW8paWYoKHU9bHIoKSkhPT1vKWlmKDQ0PT09dC5jaGFyQ29kZUF0KCR0KT8oYT1nLCR0KyspOihhPW8sMD09PVp0JiZRdCh2KSksYSE9PW8paWYobHIoKSE9PW8pe2lmKGM9W10sKGg9bnIoKSkhPT1vKWZvcig7aCE9PW87KWMucHVzaChoKSxoPW5yKCk7ZWxzZSBjPW87YyE9PW8mJihoPWxyKCkpIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oZj1tLCR0KyspOihmPW8sMD09PVp0JiZRdChkKSksZiE9PW8/KGU9ayhuLGMpLHI9ZSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO3JldHVybiByfSgpKT09PW8mJihyPWZ1bmN0aW9uKCl7dmFyIHIsZSxuLGksdSxhLGMsaCxmLHMseTtpZihyPSR0LDEyMz09PXQuY2hhckNvZGVBdCgkdCk/KGU9bCwkdCsrKTooZT1vLDA9PT1adCYmUXQocCkpLGUhPT1vKWlmKGxyKCkhPT1vKWlmKChuPWVyKCkpIT09bylpZihscigpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KGk9ZywkdCsrKTooaT1vLDA9PT1adCYmUXQodikpLGkhPT1vKWlmKGxyKCkhPT1vKWlmKHU9JHQsdC5zdWJzdHIoJHQsNik9PT14PyhhPXgsJHQrPTYpOihhPW8sMD09PVp0JiZRdChBKSksYT09PW8mJih0LnN1YnN0cigkdCwxMyk9PT1qPyhhPWosJHQrPTEzKTooYT1vLDA9PT1adCYmUXQoTikpKSxhIT09byYmKGE9QyhuLGEpKSwodT1hKSE9PW8paWYoKGE9bHIoKSkhPT1vKWlmKDQ0PT09dC5jaGFyQ29kZUF0KCR0KT8oYz1nLCR0KyspOihjPW8sMD09PVp0JiZRdCh2KSksYyE9PW8paWYobHIoKSE9PW8paWYoKGg9ZnVuY3Rpb24oKXt2YXIgcixlLG4saSx1O3JldHVybiBadCsrLHI9JHQsKGU9bHIoKSkhPT1vPyh0LnN1YnN0cigkdCw2KT09PU0/KG49TSwkdCs9Nik6KG49bywwPT09WnQmJlF0KF8pKSxuIT09byYmbHIoKSE9PW8/KDU4PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1ULCR0KyspOihpPW8sMD09PVp0JiZRdChSKSksaSE9PW8mJmxyKCkhPT1vJiYodT1zcigpKSE9PW8mJmxyKCkhPT1vPyhlPUIodSkscj1lKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pLFp0LS0scj09PW8mJihlPW8sMD09PVp0JiZRdChEKSkscn0oKSk9PT1vJiYoaD1udWxsKSxoIT09byl7aWYoZj1bXSwocz1vcigpKSE9PW8pZm9yKDtzIT09bzspZi5wdXNoKHMpLHM9b3IoKTtlbHNlIGY9bztmIT09byYmKHM9bHIoKSkhPT1vPygxMjU9PT10LmNoYXJDb2RlQXQoJHQpPyh5PW0sJHQrKyk6KHk9bywwPT09WnQmJlF0KGQpKSx5IT09bz8oZT1GKG4sdSxoLGYpLHI9ZSk6KCR0PXIscj1vKSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztlbHNlICR0PXIscj1vO2Vsc2UgJHQ9cixyPW87cmV0dXJuIHJ9KCkpPT09byYmKHI9ZnVuY3Rpb24oKXt2YXIgcixlLG4saSx1LGEsYztyZXR1cm4gcj0kdCwxMjM9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWwsJHQrKyk6KGU9bywwPT09WnQmJlF0KHApKSxlIT09byYmbHIoKSE9PW8mJihuPWVyKCkpIT09byYmbHIoKSE9PW8/KDQ0PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1nLCR0KyspOihpPW8sMD09PVp0JiZRdCh2KSksaSE9PW8mJmxyKCkhPT1vJiYodT1mdW5jdGlvbigpe3ZhciByLGUsbixpLHU7cmV0dXJuIHQuc3Vic3RyKCR0LDYpPT09Sz8ocj1LLCR0Kz02KToocj1vLDA9PT1adCYmUXQoRykpLHI9PT1vJiYodC5zdWJzdHIoJHQsNCk9PT1VPyhyPVUsJHQrPTQpOihyPW8sMD09PVp0JiZRdChaKSkscj09PW8mJih0LnN1YnN0cigkdCw0KT09PUk/KHI9SSwkdCs9NCk6KHI9bywwPT09WnQmJlF0KFkpKSxyPT09byYmKHQuc3Vic3RyKCR0LDgpPT09Vj8ocj1WLCR0Kz04KToocj1vLDA9PT1adCYmUXQoVykpLHI9PT1vJiYodC5zdWJzdHIoJHQsNyk9PT1IPyhyPUgsJHQrPTcpOihyPW8sMD09PVp0JiZRdChRKSkscj09PW8mJih0LnN1YnN0cigkdCw4KT09PVg/KHI9WCwkdCs9OCk6KHI9bywwPT09WnQmJlF0KHR0KSkscj09PW8mJihyPSR0LGU9JHQsWnQrKyx0LnN1YnN0cigkdCw2KT09PXc/KG49dywkdCs9Nik6KG49bywwPT09WnQmJlF0KGIpKSxadC0tLG49PT1vP2U9dm9pZCAwOigkdD1lLGU9byksZSE9PW8/KG49JHQsWnQrKyx0LnN1YnN0cigkdCw2KT09PXg/KGk9eCwkdCs9Nik6KGk9bywwPT09WnQmJlF0KEEpKSxadC0tLGk9PT1vP249dm9pZCAwOigkdD1uLG49byksbiE9PW8/KGk9JHQsWnQrKyx0LnN1YnN0cigkdCwxMyk9PT1qPyh1PWosJHQrPTEzKToodT1vLDA9PT1adCYmUXQoTikpLFp0LS0sdT09PW8/aT12b2lkIDA6KCR0PWksaT1vKSxpIT09byYmKHU9ZXIoKSkhPT1vJiYocnQodSk/dm9pZCAwOm8pIT09bz8oZT1ldCh1KSxyPWUpOigkdD1yLHI9bykpOigkdD1yLHI9bykpOigkdD1yLHI9bykpKSkpKSkscn0oKSkhPT1vJiZscigpIT09bz8oKGE9ZnVuY3Rpb24oKXt2YXIgcixlLG4saSx1O2lmKHI9JHQsKGU9bHIoKSkhPT1vKWlmKDQ0PT09dC5jaGFyQ29kZUF0KCR0KT8obj1nLCR0KyspOihuPW8sMD09PVp0JiZRdCh2KSksbiE9PW8pe2ZvcihpPVtdLHU9cnIoKTt1IT09bzspaS5wdXNoKHUpLHU9cnIoKTtpIT09byYmKHU9KHU9bnQoaSkpP3ZvaWQgMDpvKSE9PW8/KGU9b3QoaSkscj1lKTooJHQ9cixyPW8pfWVsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztpZihyPT09bylpZihyPSR0LChlPWxyKCkpIT09bylpZig0ND09PXQuY2hhckNvZGVBdCgkdCk/KG49ZywkdCsrKToobj1vLDA9PT1adCYmUXQodikpLG4hPT1vKXtmb3IoaT1bXSx1PXVyKCk7dSE9PW87KWkucHVzaCh1KSx1PXVyKCk7aSE9PW8/KGU9aXQoaSkscj1lKTooJHQ9cixyPW8pfWVsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztyZXR1cm4gcn0oKSk9PT1vJiYoYT1udWxsKSxhIT09bz8oMTI1PT09dC5jaGFyQ29kZUF0KCR0KT8oYz1tLCR0KyspOihjPW8sMD09PVp0JiZRdChkKSksYyE9PW8/KGU9TyhuLHUsYSkscj1lKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pLHJ9KCkpPT09byYmKHI9JHQsMzU9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWEsJHQrKyk6KGU9bywwPT09WnQmJlF0KGMpKSxlIT09byYmKG49KG49aCgpKT92b2lkIDA6bykhPT1vP3I9ZT1mKCk6KCR0PXIscj1vKSxyPT09bykpe2lmKHI9JHQsZT1bXSwobj1mcigpKSE9PW8pZm9yKDtuIT09bzspZS5wdXNoKG4pLG49ZnIoKTtlbHNlIGU9bztlIT09byYmKGU9cyhlKSkscj1lfXJldHVybiByfWZ1bmN0aW9uIGVyKCl7dmFyIHIsZSxuO2lmKFp0Kysscj0kdCxlPVtdLHoudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQoUCkpLG4hPT1vKWZvcig7biE9PW87KWUucHVzaChuKSx6LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KFApKTtlbHNlIGU9bztyZXR1cm4gcj1lIT09bz90LnN1YnN0cmluZyhyLCR0KTplLFp0LS0scj09PW8mJihlPW8sMD09PVp0JiZRdChFKSkscn1mdW5jdGlvbiBucigpe3ZhciB0LHIsZTtyZXR1cm4gdD0kdCxscigpIT09byYmKHI9ZXIoKSkhPT1vJiZscigpIT09byYmKGU9aXIoKSkhPT1vP3Q9TChyLGUpOigkdD10LHQ9byksdH1mdW5jdGlvbiBvcigpe3ZhciByLGUsbjtyZXR1cm4gcj0kdCxscigpIT09byYmKGU9ZnVuY3Rpb24oKXt2YXIgcixlLG47cmV0dXJuKHI9ZXIoKSk9PT1vJiYocj0kdCw2MT09PXQuY2hhckNvZGVBdCgkdCk/KGU9cSwkdCsrKTooZT1vLDA9PT1adCYmUXQoJCkpLGUhPT1vJiYobj1zcigpKSE9PW8/KGU9QihuKSxyPWUpOigkdD1yLHI9bykpLHJ9KCkpIT09byYmbHIoKSE9PW8mJihuPWlyKCkpIT09bz9yPUwoZSxuKTooJHQ9cixyPW8pLHJ9ZnVuY3Rpb24gaXIoKXt2YXIgcixlLG4saSx1LGE7aWYocj0kdCwxMjM9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWwsJHQrKyk6KGU9bywwPT09WnQmJlF0KHApKSxlIT09bylpZihuPSR0LChpPWxyKCkpIT09bz8odT0kdCxadCsrLDEyMz09PXQuY2hhckNvZGVBdCgkdCk/KGE9bCwkdCsrKTooYT1vLDA9PT1adCYmUXQocCkpLFp0LS0sYSE9PW8/KCR0PXUsdT12b2lkIDApOnU9byx1IT09bz9uPWk9W2ksdV06KCR0PW4sbj1vKSk6KCR0PW4sbj1vKSxuPT09byYmKG49bnVsbCksbiE9PW8pe2ZvcihpPVtdLHU9cnIoKTt1IT09bzspaS5wdXNoKHUpLHU9cnIoKTtpIT09byYmKHU9bHIoKSkhPT1vPygxMjU9PT10LmNoYXJDb2RlQXQoJHQpPyhhPW0sJHQrKyk6KGE9bywwPT09WnQmJlF0KGQpKSxhIT09bz9yPWU9SihpKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pfWVsc2UgJHQ9cixyPW87ZWxzZSAkdD1yLHI9bztyZXR1cm4gcn1mdW5jdGlvbiB1cigpe3ZhciByLGUsbixpO2lmKFp0Kysscj0kdCxlPVtdLGF0LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KGN0KSksbiE9PW8pZm9yKDtuIT09bzspZS5wdXNoKG4pLGF0LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KGN0KSk7ZWxzZSBlPW87aWYoZSE9PW8mJihlPWh0KGUpKSwocj1lKT09PW8mJihyPWFyKCkpPT09byYmKHI9JHQsMzk9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWZ0LCR0KyspOihlPW8sMD09PVp0JiZRdChzdCkpLGUhPT1vJiYobj1jcigpKSE9PW8/KDM5PT09dC5jaGFyQ29kZUF0KCR0KT8oaT1mdCwkdCsrKTooaT1vLDA9PT1adCYmUXQoc3QpKSxpIT09bz9yPWU9bHQobik6KCR0PXIscj1vKSk6KCR0PXIscj1vKSxyPT09bykpaWYocj0kdCwxMjM9PT10LmNoYXJDb2RlQXQoJHQpPyhlPWwsJHQrKyk6KGU9bywwPT09WnQmJlF0KHApKSxlIT09byl7Zm9yKG49W10saT11cigpO2khPT1vOyluLnB1c2goaSksaT11cigpO24hPT1vPygxMjU9PT10LmNoYXJDb2RlQXQoJHQpPyhpPW0sJHQrKyk6KGk9bywwPT09WnQmJlF0KGQpKSxpIT09bz9yPWU9cHQobik6KCR0PXIscj1vKSk6KCR0PXIscj1vKX1lbHNlICR0PXIscj1vO3JldHVybiBadC0tLHI9PT1vJiYoZT1vLDA9PT1adCYmUXQodXQpKSxyfWZ1bmN0aW9uIGFyKCl7dmFyIHIsZTtyZXR1cm4gWnQrKyxyPSR0LHQuc3Vic3RyKCR0LDIpPT09ZHQ/KGU9ZHQsJHQrPTIpOihlPW8sMD09PVp0JiZRdCh5dCkpLGUhPT1vJiYoZT1ndCgpKSxadC0tLChyPWUpPT09byYmKGU9bywwPT09WnQmJlF0KG10KSkscn1mdW5jdGlvbiBjcigpe3ZhciByLGUsbjtpZigocj1hcigpKT09PW8pe2lmKHI9JHQsZT1bXSx2dC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdCh3dCkpLG4hPT1vKWZvcig7biE9PW87KWUucHVzaChuKSx2dC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdCh3dCkpO2Vsc2UgZT1vO2UhPT1vJiYoZT1zKGUpKSxyPWV9cmV0dXJuIHJ9ZnVuY3Rpb24gaHIoKXt2YXIgcixlLG4saSx1LGE7aWYoWnQrKywocj1mdW5jdGlvbigpe3ZhciByLGUsbixpO2lmKHI9JHQsdC5zdWJzdHIoJHQsMik9PT1idD8oZT1idCwkdCs9Mik6KGU9bywwPT09WnQmJlF0KFN0KSksZSE9PW8pe2ZvcihuPVtdLGk9Y3IoKTtpIT09bzspbi5wdXNoKGkpLGk9Y3IoKTtuIT09bz8oMzk9PT10LmNoYXJDb2RlQXQoJHQpPyhpPWZ0LCR0KyspOihpPW8sMD09PVp0JiZRdChzdCkpLGkhPT1vP3I9ZT1rdChuKTooJHQ9cixyPW8pKTooJHQ9cixyPW8pfWVsc2UgJHQ9cixyPW87aWYocj09PW8paWYocj0kdCx0LnN1YnN0cigkdCwyKT09PXh0PyhlPXh0LCR0Kz0yKTooZT1vLDA9PT1adCYmUXQoQXQpKSxlIT09byl7Zm9yKG49W10saT1jcigpO2khPT1vOyluLnB1c2goaSksaT1jcigpO24hPT1vPygzOT09PXQuY2hhckNvZGVBdCgkdCk/KGk9ZnQsJHQrKyk6KGk9bywwPT09WnQmJlF0KHN0KSksaSE9PW8/cj1lPWp0KG4pOigkdD1yLHI9bykpOigkdD1yLHI9byl9ZWxzZSAkdD1yLHI9bztyZXR1cm4gcn0oKSk9PT1vKXtpZihyPSR0LGU9JHQsbj0kdCx0LnN1YnN0cigkdCwyKT09PUN0PyhpPUN0LCR0Kz0yKTooaT1vLDA9PT1adCYmUXQoRnQpKSxpIT09byl7Zm9yKHU9W10sYT1jcigpO2EhPT1vOyl1LnB1c2goYSksYT1jcigpO3UhPT1vPygzOT09PXQuY2hhckNvZGVBdCgkdCk/KGE9ZnQsJHQrKyk6KGE9bywwPT09WnQmJlF0KHN0KSksYSE9PW8/bj1pPU90KHUpOigkdD1uLG49bykpOigkdD1uLG49byl9ZWxzZSAkdD1uLG49bztuIT09byYmKGk9KGk9aCgpKT92b2lkIDA6bykhPT1vP2U9bj1bbixpXTooJHQ9ZSxlPW8pLGUhPT1vJiYoZT1FdChlKSksKHI9ZSk9PT1vJiYoMzk9PT10LmNoYXJDb2RlQXQoJHQpPyhyPWZ0LCR0KyspOihyPW8sMD09PVp0JiZRdChzdCkpKX1yZXR1cm4gWnQtLSxyPT09byYmKGU9bywwPT09WnQmJlF0KE50KSkscn1mdW5jdGlvbiBmcigpe3ZhciByLGU7cmV0dXJuKHI9YXIoKSk9PT1vJiYocj1ocigpKT09PW8mJihyPSR0LDM1PT09dC5jaGFyQ29kZUF0KCR0KT8oZT1hLCR0KyspOihlPW8sMD09PVp0JiZRdChjKSksZSE9PW8mJihKdChlKT92b2lkIDA6bykhPT1vP3I9ZT1EdChlKTooJHQ9cixyPW8pLHI9PT1vJiYocj1mdW5jdGlvbigpe3ZhciByO3JldHVybiBadCsrLFB0LnRlc3QodC5jaGFyQXQoJHQpKT8ocj10LmNoYXJBdCgkdCksJHQrKyk6KHI9bywwPT09WnQmJlF0KEx0KSksWnQtLSxyPT09byYmMD09PVp0JiZRdCh6dCkscn0oKSkpLHJ9ZnVuY3Rpb24gc3IoKXt2YXIgcixlLG47aWYoWnQrKyxyPSR0LGU9W10sX3QudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQoVHQpKSxuIT09bylmb3IoO24hPT1vOyllLnB1c2gobiksX3QudGVzdCh0LmNoYXJBdCgkdCkpPyhuPXQuY2hhckF0KCR0KSwkdCsrKToobj1vLDA9PT1adCYmUXQoVHQpKTtlbHNlIGU9bztyZXR1cm4gcj1lIT09bz90LnN1YnN0cmluZyhyLCR0KTplLFp0LS0scj09PW8mJihlPW8sMD09PVp0JiZRdChNdCkpLHJ9ZnVuY3Rpb24gbHIoKXt2YXIgcixlLG47Zm9yKFp0Kysscj0kdCxlPVtdLEJ0LnRlc3QodC5jaGFyQXQoJHQpKT8obj10LmNoYXJBdCgkdCksJHQrKyk6KG49bywwPT09WnQmJlF0KHF0KSk7biE9PW87KWUucHVzaChuKSxCdC50ZXN0KHQuY2hhckF0KCR0KSk/KG49dC5jaGFyQXQoJHQpLCR0KyspOihuPW8sMD09PVp0JiZRdChxdCkpO3JldHVybiByPWUhPT1vP3Quc3Vic3RyaW5nKHIsJHQpOmUsWnQtLSxyPT09byYmKGU9bywwPT09WnQmJlF0KFJ0KSkscn12YXIgcHI9WyExXTtpZigoZT11KCkpIT09byYmJHQ9PT10Lmxlbmd0aClyZXR1cm4gZTt0aHJvdyBlIT09byYmJHQ8dC5sZW5ndGgmJlF0KHt0eXBlOlwiZW5kXCJ9KSxYdChVdCxHdDx0Lmxlbmd0aD90LmNoYXJBdChHdCk6bnVsbCxHdDx0Lmxlbmd0aD9IdChHdCxHdCsxKTpIdChHdCxHdCkpfX19LGZ1bmN0aW9uKHQscixlKXt2YXIgbixvLGk9W3tjYXJkaW5hbDpbXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSx7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSx7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl19LHtjYXJkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX1dO3ZvaWQgMD09PShvPVwiZnVuY3Rpb25cIj09dHlwZW9mKG49e2FmOmlbMV0sYWs6aVsxXSxhbTppWzFdLGFyOntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxhcnM6e2NhcmRpbmFsOltcInplcm9cIixcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGFzOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl19LGFzYTppWzFdLGFzdDppWzFdLGF6OntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdfSxiZTp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wiZmV3XCIsXCJvdGhlclwiXX0sYmVtOmlbMV0sYmV6OmlbMV0sYmc6aVsxXSxiaDppWzFdLGJtOmlbMF0sYm46e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXX0sYm86aVswXSxicjp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sYnJ4OmlbMV0sYnM6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxjYTp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm90aGVyXCJdfSxjZTppWzFdLGNnZzppWzFdLGNocjppWzFdLGNrYjppWzFdLGNzOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sY3k6e2NhcmRpbmFsOltcInplcm9cIixcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wiemVyb1wiLFwib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl19LGRhOmlbMV0sZGU6aVsxXSxkc2I6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGR2OmlbMV0sZHo6aVswXSxlZTppWzFdLGVsOmlbMV0sZW46e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXX0sZW86aVsxXSxlczppWzFdLGV0OmlbMV0sZXU6aVsxXSxmYTppWzFdLGZmOmlbMV0sZmk6aVsxXSxmaWw6aVsyXSxmbzppWzFdLGZyOmlbMl0sZnVyOmlbMV0sZnk6aVsxXSxnYTp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSxnZDp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXX0sZ2w6aVsxXSxnc3c6aVsxXSxndTp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdfSxndXc6aVsxXSxndjp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0saGE6aVsxXSxoYXc6aVsxXSxoZTp7Y2FyZGluYWw6W1wib25lXCIsXCJ0d29cIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGhpOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib25lXCIsXCJ0d29cIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl19LGhyOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0saHNiOntjYXJkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxodTppWzJdLGh5OmlbMl0saWE6aVsxXSxpZDppWzBdLGlnOmlbMF0saWk6aVswXSxpbjppWzBdLGlvOmlbMV0saXM6aVsxXSxpdDp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm1hbnlcIixcIm90aGVyXCJdfSxpdTppWzNdLGl3OntjYXJkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0samE6aVswXSxqYm86aVswXSxqZ286aVsxXSxqaTppWzFdLGptYzppWzFdLGp2OmlbMF0sanc6aVswXSxrYTp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwibWFueVwiLFwib3RoZXJcIl19LGthYjppWzFdLGthajppWzFdLGtjZzppWzFdLGtkZTppWzBdLGtlYTppWzBdLGtrOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wibWFueVwiLFwib3RoZXJcIl19LGtrajppWzFdLGtsOmlbMV0sa206aVswXSxrbjppWzFdLGtvOmlbMF0sa3M6aVsxXSxrc2I6aVsxXSxrc2g6e2NhcmRpbmFsOltcInplcm9cIixcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sa3U6aVsxXSxrdzppWzNdLGt5OmlbMV0sbGFnOntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LGxiOmlbMV0sbGc6aVsxXSxsa3Q6aVswXSxsbjppWzFdLGxvOntjYXJkaW5hbDpbXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl19LGx0OntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sbHY6e2NhcmRpbmFsOltcInplcm9cIixcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sbWFzOmlbMV0sbWc6aVsxXSxtZ286aVsxXSxtazp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJtYW55XCIsXCJvdGhlclwiXX0sbWw6aVsxXSxtbjppWzFdLG1vOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSxtcjp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm90aGVyXCJdfSxtczp7Y2FyZGluYWw6W1wib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSxtdDp7Y2FyZGluYWw6W1wib25lXCIsXCJmZXdcIixcIm1hbnlcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LG15OmlbMF0sbmFoOmlbMV0sbmFxOmlbM10sbmI6aVsxXSxuZDppWzFdLG5lOmlbMl0sbmw6aVsxXSxubjppWzFdLG5uaDppWzFdLG5vOmlbMV0sbnFvOmlbMF0sbnI6aVsxXSxuc286aVsxXSxueTppWzFdLG55bjppWzFdLG9tOmlbMV0sb3I6e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcInR3b1wiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXX0sb3M6aVsxXSxwYTppWzFdLHBhcDppWzFdLHBsOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0scHJnOntjYXJkaW5hbDpbXCJ6ZXJvXCIsXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LHBzOmlbMV0scHQ6aVsxXSxcInB0LVBUXCI6aVsxXSxybTppWzFdLHJvOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdfSxyb2Y6aVsxXSxyb290OmlbMF0scnU6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxyd2s6aVsxXSxzYWg6aVswXSxzYXE6aVsxXSxzYzp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm1hbnlcIixcIm90aGVyXCJdfSxzY246e2NhcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJtYW55XCIsXCJvdGhlclwiXX0sc2Q6aVsxXSxzZGg6aVsxXSxzZTppWzNdLHNlaDppWzFdLHNlczppWzBdLHNnOmlbMF0sc2g6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxzaGk6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm90aGVyXCJdfSxzaTppWzFdLHNrOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwibWFueVwiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sc2w6e2NhcmRpbmFsOltcIm9uZVwiLFwidHdvXCIsXCJmZXdcIixcIm90aGVyXCJdLG9yZGluYWw6W1wib3RoZXJcIl19LHNtYTppWzNdLHNtaTppWzNdLHNtajppWzNdLHNtbjppWzNdLHNtczppWzNdLHNuOmlbMV0sc286aVsxXSxzcTp7Y2FyZGluYWw6W1wib25lXCIsXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwibWFueVwiLFwib3RoZXJcIl19LHNyOntjYXJkaW5hbDpbXCJvbmVcIixcImZld1wiLFwib3RoZXJcIl0sb3JkaW5hbDpbXCJvdGhlclwiXX0sc3M6aVsxXSxzc3k6aVsxXSxzdDppWzFdLHN2OmlbMl0sc3c6aVsxXSxzeXI6aVsxXSx0YTppWzFdLHRlOmlbMV0sdGVvOmlbMV0sdGg6aVswXSx0aTppWzFdLHRpZzppWzFdLHRrOntjYXJkaW5hbDpbXCJvbmVcIixcIm90aGVyXCJdLG9yZGluYWw6W1wiZmV3XCIsXCJvdGhlclwiXX0sdGw6aVsyXSx0bjppWzFdLHRvOmlbMF0sdHI6aVsxXSx0czppWzFdLHR6bTppWzFdLHVnOmlbMV0sdWs6e2NhcmRpbmFsOltcIm9uZVwiLFwiZmV3XCIsXCJtYW55XCIsXCJvdGhlclwiXSxvcmRpbmFsOltcImZld1wiLFwib3RoZXJcIl19LHVyOmlbMV0sdXo6aVsxXSx2ZTppWzFdLHZpOntjYXJkaW5hbDpbXCJvdGhlclwiXSxvcmRpbmFsOltcIm9uZVwiLFwib3RoZXJcIl19LHZvOmlbMV0sdnVuOmlbMV0sd2E6aVsxXSx3YWU6aVsxXSx3bzppWzBdLHhoOmlbMV0seG9nOmlbMV0seWk6aVsxXSx5bzppWzBdLHl1ZTppWzBdLHpoOmlbMF0senU6aVsxXX0pP24uY2FsbChyLGUscix0KTpuKXx8KHQuZXhwb3J0cz1vKX0sZnVuY3Rpb24odCxyKXtmdW5jdGlvbiBlKHQscixlKXt2YXIgbj17ZGF5OlwibnVtZXJpY1wiLG1vbnRoOlwic2hvcnRcIix5ZWFyOlwibnVtZXJpY1wifTtzd2l0Y2goZSl7Y2FzZVwiZnVsbFwiOm4ud2Vla2RheT1cImxvbmdcIjtjYXNlXCJsb25nXCI6bi5tb250aD1cImxvbmdcIjticmVhaztjYXNlXCJzaG9ydFwiOm4ubW9udGg9XCJudW1lcmljXCJ9cmV0dXJuIG5ldyBEYXRlKHQpLnRvTG9jYWxlRGF0ZVN0cmluZyhyLG4pfXQuZXhwb3J0cz1mdW5jdGlvbigpe3JldHVybiBlfX0sZnVuY3Rpb24odCxyKXtmdW5jdGlvbiBlKHQpe2lmKCFpc0Zpbml0ZSh0KSlyZXR1cm4gU3RyaW5nKHQpO3ZhciByPVwiXCI7dDwwPyhyPVwiLVwiLHQ9TWF0aC5hYnModCkpOnQ9TnVtYmVyKHQpO3ZhciBlPXQlNjAsbj1bTWF0aC5yb3VuZChlKT09PWU/ZTplLnRvRml4ZWQoMyldO3JldHVybiB0PDYwP24udW5zaGlmdCgwKToodD1NYXRoLnJvdW5kKCh0LW5bMF0pLzYwKSxuLnVuc2hpZnQodCU2MCksdD49NjAmJih0PU1hdGgucm91bmQoKHQtblswXSkvNjApLG4udW5zaGlmdCh0KSkpLHIrbi5zaGlmdCgpK1wiOlwiK24ubWFwKGZ1bmN0aW9uKHQpe3JldHVybiB0PDEwP1wiMFwiK1N0cmluZyh0KTpTdHJpbmcodCl9KS5qb2luKFwiOlwiKX10LmV4cG9ydHM9ZnVuY3Rpb24oKXtyZXR1cm4gZX19LGZ1bmN0aW9uKHQscil7dC5leHBvcnRzPWZ1bmN0aW9uKHQpe3ZhciByPWZ1bmN0aW9uKHQscixlKXt2YXIgbj1lJiZlLnNwbGl0KFwiOlwiKXx8W10sbz17aW50ZWdlcjp7bWF4aW11bUZyYWN0aW9uRGlnaXRzOjB9LHBlcmNlbnQ6e3N0eWxlOlwicGVyY2VudFwifSxjdXJyZW5jeTp7c3R5bGU6XCJjdXJyZW5jeVwiLGN1cnJlbmN5Om5bMV0mJm5bMV0udHJpbSgpfHxDVVJSRU5DWSxtaW5pbXVtRnJhY3Rpb25EaWdpdHM6MixtYXhpbXVtRnJhY3Rpb25EaWdpdHM6Mn19O3JldHVybiBuZXcgSW50bC5OdW1iZXJGb3JtYXQocixvW25bMF1dfHx7fSkuZm9ybWF0KHQpfS50b1N0cmluZygpLnJlcGxhY2UoXCJDVVJSRU5DWVwiLEpTT04uc3RyaW5naWZ5KHQuY3VycmVuY3l8fFwiVVNEXCIpKS5tYXRjaCgvXFwoKFteKV0qKVxcKVtee10qeyhbXFxzXFxTXSopfS8pO3JldHVybiBuZXcgRnVuY3Rpb24oclsxXSxyWzJdKX19LGZ1bmN0aW9uKHQscil7ZnVuY3Rpb24gZSh0LHIsZSl7dmFyIG49e3NlY29uZDpcIm51bWVyaWNcIixtaW51dGU6XCJudW1lcmljXCIsaG91cjpcIm51bWVyaWNcIn07c3dpdGNoKGUpe2Nhc2VcImZ1bGxcIjpjYXNlXCJsb25nXCI6bi50aW1lWm9uZU5hbWU9XCJzaG9ydFwiO2JyZWFrO2Nhc2VcInNob3J0XCI6ZGVsZXRlIG4uc2Vjb25kfXJldHVybiBuZXcgRGF0ZSh0KS50b0xvY2FsZVRpbWVTdHJpbmcocixuKX10LmV4cG9ydHM9ZnVuY3Rpb24oKXtyZXR1cm4gZX19LGZ1bmN0aW9uKHQscixlKXtcInVzZSBzdHJpY3RcIjtlLnIocik7dmFyIG49ZSgxKSxvPWUubihuKSxpPWUoMiksdT17YnJlYWs6ITAsY29udGludWU6ITAsZGVsZXRlOiEwLGVsc2U6ITAsZm9yOiEwLGZ1bmN0aW9uOiEwLGlmOiEwLGluOiEwLG5ldzohMCxyZXR1cm46ITAsdGhpczohMCx0eXBlb2Y6ITAsdmFyOiEwLHZvaWQ6ITAsd2hpbGU6ITAsd2l0aDohMCxjYXNlOiEwLGNhdGNoOiEwLGRlZmF1bHQ6ITAsZG86ITAsZmluYWxseTohMCxpbnN0YW5jZW9mOiEwLHN3aXRjaDohMCx0aHJvdzohMCx0cnk6ITB9LGE9e2RlYnVnZ2VyOiEwLGNsYXNzOiEwLGVudW06ITAsZXh0ZW5kczohMCxzdXBlcjohMCxjb25zdDohMCxleHBvcnQ6ITAsaW1wb3J0OiEwLG51bGw6ITAsdHJ1ZTohMCxmYWxzZTohMCxpbXBsZW1lbnRzOiEwLGxldDohMCxwcml2YXRlOiEwLHB1YmxpYzohMCx5aWVsZDohMCxpbnRlcmZhY2U6ITAscGFja2FnZTohMCxwcm90ZWN0ZWQ6ITAsc3RhdGljOiEwfTtmdW5jdGlvbiBjKHQscil7aWYoL15bQS1aXyRdWzAtOUEtWl8kXSokL2kudGVzdCh0KSYmIXVbdF0pcmV0dXJuIHI/XCJcIi5jb25jYXQocixcIi5cIikuY29uY2F0KHQpOnQ7dmFyIGU9SlNPTi5zdHJpbmdpZnkodCk7cmV0dXJuIHI/citcIltcIi5jb25jYXQoZSxcIl1cIik6ZX1mdW5jdGlvbiBoKHQpe3ZhciByPXQudHJpbSgpLnJlcGxhY2UoL1xcVysvZyxcIl9cIik7cmV0dXJuIHVbcl18fGFbcl18fC9eXFxkLy50ZXN0KHIpP1wiX1wiK3I6cn12YXIgZj1uZXcgUmVnRXhwKFwiXlwiK1tcImFyXCIsXCJja2JcIixcImZhXCIsXCJoZVwiLFwia3MoJHxbXmJmaF0pXCIsXCJscmNcIixcIm16blwiLFwicGEtQXJhYlwiLFwicHNcIixcInVnXCIsXCJ1clwiLFwidXotQXJhYlwiLFwieWlcIl0uam9pbihcInxeXCIpKTtmdW5jdGlvbiBzKHQpe3JldHVybihzPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmXCJzeW1ib2xcIj09dHlwZW9mIFN5bWJvbC5pdGVyYXRvcj9mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHR9OmZ1bmN0aW9uKHQpe3JldHVybiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJnQuY29uc3RydWN0b3I9PT1TeW1ib2wmJnQhPT1TeW1ib2wucHJvdG90eXBlP1wic3ltYm9sXCI6dHlwZW9mIHR9KSh0KX1mdW5jdGlvbiBsKHQscil7Zm9yKHZhciBlPTA7ZTxyLmxlbmd0aDtlKyspe3ZhciBuPXJbZV07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LG4ua2V5LG4pfX12YXIgcD1mdW5jdGlvbigpe2Z1bmN0aW9uIHQocil7IWZ1bmN0aW9uKHQscil7aWYoISh0IGluc3RhbmNlb2YgcikpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX0odGhpcyx0KSx0aGlzLm1mPXIsdGhpcy5sYz1udWxsLHRoaXMubG9jYWxlcz17fSx0aGlzLnJ1bnRpbWU9e30sdGhpcy5mb3JtYXR0ZXJzPXt9fXZhciByLGUsbjtyZXR1cm4gcj10LChlPVt7a2V5OlwiY29tcGlsZVwiLHZhbHVlOmZ1bmN0aW9uKHQscixlKXt2YXIgbj10aGlzO2lmKFwib2JqZWN0XCIhPXModCkpe3RoaXMubGM9cjt2YXIgbz1lW3JdfHx7Y2FyZGluYWw6W10sb3JkaW5hbDpbXX07by5zdHJpY3Q9ISF0aGlzLm1mLm9wdGlvbnMuc3RyaWN0TnVtYmVyU2lnbjt2YXIgdT1PYmplY3QoaS5wYXJzZSkodCxvKS5tYXAoZnVuY3Rpb24odCl7cmV0dXJuIG4udG9rZW4odCl9KTtyZXR1cm5cImZ1bmN0aW9uKGQpIHsgcmV0dXJuIFwiLmNvbmNhdCh1LmpvaW4oXCIgKyBcIil8fCdcIlwiJyxcIjsgfVwiKX12YXIgYT17fTtmb3IodmFyIGMgaW4gdCl7dmFyIGg9ZS5oYXNPd25Qcm9wZXJ0eShjKT9jOnI7YVtjXT10aGlzLmNvbXBpbGUodFtjXSxoLGUpfXJldHVybiBhfX0se2tleTpcImNhc2VzXCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgZT10aGlzLG49XCJzZWxlY3RcIj09PXQudHlwZXx8IXRoaXMubWYuaGFzQ3VzdG9tUGx1cmFsRnVuY3Msbz10LmNhc2VzLm1hcChmdW5jdGlvbih0KXt2YXIgbz10LmtleSxpPXQudG9rZW5zO1wib3RoZXJcIj09PW8mJihuPSExKTt2YXIgdT1pLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gZS50b2tlbih0LHIpfSk7cmV0dXJuIGMobykrXCI6IFwiKyh1LmpvaW4oXCIgKyBcIil8fCdcIlwiJyl9KTtpZihuKXRocm93IG5ldyBFcnJvcihcIk5vICdvdGhlcicgZm9ybSBmb3VuZCBpbiBcIitKU09OLnN0cmluZ2lmeSh0KSk7cmV0dXJuXCJ7IFwiLmNvbmNhdChvLmpvaW4oXCIsIFwiKSxcIiB9XCIpfX0se2tleTpcInRva2VuXCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgZSxuPXRoaXM7aWYoXCJzdHJpbmdcIj09dHlwZW9mIHQpcmV0dXJuIEpTT04uc3RyaW5naWZ5KHQpO3ZhciBvLGksdSxhLHM9W2ModC5hcmcsXCJkXCIpXTtzd2l0Y2godC50eXBlKXtjYXNlXCJhcmd1bWVudFwiOnJldHVybiB0aGlzLm1mLm9wdGlvbnMuYmlEaVN1cHBvcnQ/KG89c1swXSxpPXRoaXMubGMsdT1mLnRlc3QoaSksYT1KU09OLnN0cmluZ2lmeSh1P1wi4oCPXCI6XCLigI5cIiksXCJcIi5jb25jYXQoYSxcIiArIFwiKS5jb25jYXQobyxcIiArIFwiKS5jb25jYXQoYSkpOnNbMF07Y2FzZVwic2VsZWN0XCI6ZT1cInNlbGVjdFwiLHImJnRoaXMubWYub3B0aW9ucy5zdHJpY3ROdW1iZXJTaWduJiYocj1udWxsKSxzLnB1c2godGhpcy5jYXNlcyh0LHIpKSx0aGlzLnJ1bnRpbWUuc2VsZWN0PSEwO2JyZWFrO2Nhc2VcInNlbGVjdG9yZGluYWxcIjplPVwicGx1cmFsXCIscy5wdXNoKDAsaCh0aGlzLmxjKSx0aGlzLmNhc2VzKHQsdCksMSksdGhpcy5sb2NhbGVzW3RoaXMubGNdPSEwLHRoaXMucnVudGltZS5wbHVyYWw9ITA7YnJlYWs7Y2FzZVwicGx1cmFsXCI6ZT1cInBsdXJhbFwiLHMucHVzaCh0Lm9mZnNldHx8MCxoKHRoaXMubGMpLHRoaXMuY2FzZXModCx0KSksdGhpcy5sb2NhbGVzW3RoaXMubGNdPSEwLHRoaXMucnVudGltZS5wbHVyYWw9ITA7YnJlYWs7Y2FzZVwiZnVuY3Rpb25cIjppZighKHQua2V5IGluIHRoaXMubWYuZm10KSYmdC5rZXkgaW4gdGhpcy5tZi5jb25zdHJ1Y3Rvci5mb3JtYXR0ZXJzKXt2YXIgbD10aGlzLm1mLmNvbnN0cnVjdG9yLmZvcm1hdHRlcnNbdC5rZXldO3RoaXMubWYuZm10W3Qua2V5XT1sKHRoaXMubWYpfWlmKCF0aGlzLm1mLmZtdFt0LmtleV0pdGhyb3cgbmV3IEVycm9yKFwiRm9ybWF0dGluZyBmdW5jdGlvbiBcIi5jb25jYXQoSlNPTi5zdHJpbmdpZnkodC5rZXkpLFwiIG5vdCBmb3VuZCFcIikpO2lmKHMucHVzaChKU09OLnN0cmluZ2lmeSh0aGlzLmxjKSksdC5wYXJhbSl7ciYmdGhpcy5tZi5vcHRpb25zLnN0cmljdE51bWJlclNpZ24mJihyPW51bGwpO3ZhciBwPXQucGFyYW0udG9rZW5zLm1hcChmdW5jdGlvbih0KXtyZXR1cm4gbi50b2tlbih0LHIpfSk7cy5wdXNoKFwiKFwiKyhwLmpvaW4oXCIgKyBcIil8fCdcIlwiJykrXCIpLnRyaW0oKVwiKX1lPWModC5rZXksXCJmbXRcIiksdGhpcy5mb3JtYXR0ZXJzW3Qua2V5XT0hMDticmVhaztjYXNlXCJvY3RvdGhvcnBlXCI6aWYoIXIpcmV0dXJuJ1wiI1wiJztlPVwibnVtYmVyXCIscz1bYyhyLmFyZyxcImRcIiksSlNPTi5zdHJpbmdpZnkoci5hcmcpXSxyLm9mZnNldCYmcy5wdXNoKHIub2Zmc2V0KSx0aGlzLnJ1bnRpbWUubnVtYmVyPSEwfWlmKCFlKXRocm93IG5ldyBFcnJvcihcIlBhcnNlciBlcnJvciBmb3IgdG9rZW4gXCIrSlNPTi5zdHJpbmdpZnkodCkpO3JldHVyblwiXCIuY29uY2F0KGUsXCIoXCIpLmNvbmNhdChzLmpvaW4oXCIsIFwiKSxcIilcIil9fV0pJiZsKHIucHJvdG90eXBlLGUpLG4mJmwocixuKSx0fSgpLG09ZSgzKSxkPWUubihtKSx5PWUoMCksZz1lLm4oeSk7ZnVuY3Rpb24gdih0LHIsZSl7dmFyIG49ZnVuY3Rpb24oKXtyZXR1cm4gci5hcHBseSh0aGlzLGFyZ3VtZW50cyl9O2lmKG4udG9TdHJpbmc9ZnVuY3Rpb24oKXtyZXR1cm4gci50b1N0cmluZygpfSxlKXt2YXIgbz1kLmFbdF18fHt9O24uY2FyZGluYWw9by5jYXJkaW5hbCxuLm9yZGluYWw9by5vcmRpbmFsfWVsc2Ugbi5jYXJkaW5hbD1bXSxuLm9yZGluYWw9W107cmV0dXJuIG59ZnVuY3Rpb24gdyh0LHIpe2Zvcih2YXIgZT1yLnBsdXJhbEtleUNoZWNrcyxuPVN0cmluZyh0KTtuO249bi5yZXBsYWNlKC9bLV9dP1teLV9dKiQvLFwiXCIpKXt2YXIgbz1nLmFbbl07aWYobylyZXR1cm4gdihuLG8sZSl9dGhyb3cgbmV3IEVycm9yKFwiTG9jYWxpc2F0aW9uIGZ1bmN0aW9uIG5vdCBmb3VuZCBmb3IgbG9jYWxlIFwiK0pTT04uc3RyaW5naWZ5KHQpKX1mdW5jdGlvbiBiKHQpe3JldHVybihiPVwiZnVuY3Rpb25cIj09dHlwZW9mIFN5bWJvbCYmXCJzeW1ib2xcIj09dHlwZW9mIFN5bWJvbC5pdGVyYXRvcj9mdW5jdGlvbih0KXtyZXR1cm4gdHlwZW9mIHR9OmZ1bmN0aW9uKHQpe3JldHVybiB0JiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJnQuY29uc3RydWN0b3I9PT1TeW1ib2wmJnQhPT1TeW1ib2wucHJvdG90eXBlP1wic3ltYm9sXCI6dHlwZW9mIHR9KSh0KX1mdW5jdGlvbiBTKHQscil7Zm9yKHZhciBlPTA7ZTxyLmxlbmd0aDtlKyspe3ZhciBuPXJbZV07bi5lbnVtZXJhYmxlPW4uZW51bWVyYWJsZXx8ITEsbi5jb25maWd1cmFibGU9ITAsXCJ2YWx1ZVwiaW4gbiYmKG4ud3JpdGFibGU9ITApLE9iamVjdC5kZWZpbmVQcm9wZXJ0eSh0LG4ua2V5LG4pfX12YXIgaz1mdW5jdGlvbigpe2Z1bmN0aW9uIHQocil7IWZ1bmN0aW9uKHQscil7aWYoISh0IGluc3RhbmNlb2YgcikpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX0odGhpcyx0KSx0aGlzLnBsdXJhbD1mdW5jdGlvbih0LHIsZSxuLG8pe2lmKHt9Lmhhc093blByb3BlcnR5LmNhbGwobix0KSlyZXR1cm4gblt0XTtyJiYodC09cik7dmFyIGk9ZSh0LG8pO3JldHVybiBpIGluIG4/bltpXTpuLm90aGVyfSx0aGlzLnNlbGVjdD1mdW5jdGlvbih0LHIpe3JldHVybnt9Lmhhc093blByb3BlcnR5LmNhbGwocix0KT9yW3RdOnIub3RoZXJ9LHRoaXMubWY9cix0aGlzLnNldFN0cmljdE51bWJlcihyLm9wdGlvbnMuc3RyaWN0TnVtYmVyU2lnbil9dmFyIHIsZSxuO3JldHVybiByPXQsKGU9W3trZXk6XCJzZXRTdHJpY3ROdW1iZXJcIix2YWx1ZTpmdW5jdGlvbihyKXt0aGlzLm51bWJlcj1yP3Quc3RyaWN0TnVtYmVyOnQuZGVmYXVsdE51bWJlcn19LHtrZXk6XCJ0b1N0cmluZ1wiLHZhbHVlOmZ1bmN0aW9uKHQscil7Zm9yKHZhciBlPXt9LG49T2JqZWN0LmtleXMoci5sb2NhbGVzKSxvPTA7bzxuLmxlbmd0aDsrK28pe3ZhciBpPW5bb107ZVtoKGkpXT10W2ldfWZvcih2YXIgdT1PYmplY3Qua2V5cyhyLnJ1bnRpbWUpLGE9MDthPHUubGVuZ3RoOysrYSl7dmFyIGY9dVthXTtlW2ZdPXRoaXNbZl19dmFyIHM9T2JqZWN0LmtleXMoci5mb3JtYXR0ZXJzKTtpZihzLmxlbmd0aD4wKXtlLmZtdD17fTtmb3IodmFyIGw9MDtsPHMubGVuZ3RoOysrbCl7dmFyIHA9c1tsXTtlLmZtdFtwXT10aGlzLm1mLmZtdFtwXX19cmV0dXJuIGZ1bmN0aW9uIHQocixlKXtpZihcIm9iamVjdFwiIT1iKHIpKXt2YXIgbj1yLnRvU3RyaW5nKCkucmVwbGFjZSgvXihmdW5jdGlvbiApXFx3Ki8sXCIkMVwiKSxvPS8oWyBcXHRdKilcXFMuKiQvLmV4ZWMobik7cmV0dXJuIG8/bi5yZXBsYWNlKG5ldyBSZWdFeHAoXCJeXCIrb1sxXSxcIm1nXCIpLFwiXCIpOm59dmFyIGk9W107Zm9yKHZhciB1IGluIHIpe3ZhciBhPXQoclt1XSxlKzEpO2kucHVzaCgwPT09ZT9cInZhciBcIi5jb25jYXQodSxcIiA9IFwiKS5jb25jYXQoYSxcIjtcXG5cIik6XCJcIi5jb25jYXQoYyh1KSxcIjogXCIpLmNvbmNhdChhKSl9aWYoMD09PWUpcmV0dXJuIGkuam9pbihcIlwiKTtpZigwPT09aS5sZW5ndGgpcmV0dXJuXCJ7fVwiO2Zvcih2YXIgaD1cIiAgXCI7LS1lOyloKz1cIiAgXCI7dmFyIGY9aS5qb2luKFwiLFxcblwiKS5yZXBsYWNlKC9eL2dtLGgpO3JldHVyblwie1xcblwiLmNvbmNhdChmLFwiXFxufVwiKX0oZSwwKX19XSkmJlMoci5wcm90b3R5cGUsZSksbiYmUyhyLG4pLHR9KCk7ZnVuY3Rpb24geCh0KXtyZXR1cm4oeD1cImZ1bmN0aW9uXCI9PXR5cGVvZiBTeW1ib2wmJlwic3ltYm9sXCI9PXR5cGVvZiBTeW1ib2wuaXRlcmF0b3I/ZnVuY3Rpb24odCl7cmV0dXJuIHR5cGVvZiB0fTpmdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJmdW5jdGlvblwiPT10eXBlb2YgU3ltYm9sJiZ0LmNvbnN0cnVjdG9yPT09U3ltYm9sJiZ0IT09U3ltYm9sLnByb3RvdHlwZT9cInN5bWJvbFwiOnR5cGVvZiB0fSkodCl9ZnVuY3Rpb24gQSh0LHIpe2Zvcih2YXIgZT0wO2U8ci5sZW5ndGg7ZSsrKXt2YXIgbj1yW2VdO24uZW51bWVyYWJsZT1uLmVudW1lcmFibGV8fCExLG4uY29uZmlndXJhYmxlPSEwLFwidmFsdWVcImluIG4mJihuLndyaXRhYmxlPSEwKSxPYmplY3QuZGVmaW5lUHJvcGVydHkodCxuLmtleSxuKX19ZnVuY3Rpb24gaih0LHIsZSl7cmV0dXJuIHImJkEodC5wcm90b3R5cGUsciksZSYmQSh0LGUpLHR9ay5kZWZhdWx0TnVtYmVyPWZ1bmN0aW9uKHQscixlKXtpZighZSlyZXR1cm4gdDtpZihpc05hTih0KSl0aHJvdyBuZXcgRXJyb3IoXCJDYW4ndCBhcHBseSBvZmZzZXQ6XCIrZStcIiB0byBhcmd1bWVudCBgXCIrcitcImAgd2l0aCBub24tbnVtZXJpY2FsIHZhbHVlIFwiK0pTT04uc3RyaW5naWZ5KHQpK1wiLlwiKTtyZXR1cm4gdC1lfSxrLnN0cmljdE51bWJlcj1mdW5jdGlvbih0LHIsZSl7aWYoaXNOYU4odCkpdGhyb3cgbmV3IEVycm9yKFwiQXJndW1lbnQgYFwiK3IrXCJgIGhhcyBub24tbnVtZXJpY2FsIHZhbHVlIFwiK0pTT04uc3RyaW5naWZ5KHQpK1wiLlwiKTtyZXR1cm4gdC0oZXx8MCl9LGUuZChyLFwiZGVmYXVsdFwiLGZ1bmN0aW9uKCl7cmV0dXJuIE59KTt2YXIgTj1mdW5jdGlvbigpe2Z1bmN0aW9uIHQocixlKXt2YXIgbj10aGlzO2lmKGZ1bmN0aW9uKHQscil7aWYoISh0IGluc3RhbmNlb2YgcikpdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKX0odGhpcyx0KSx0aGlzLm9wdGlvbnM9T2JqZWN0LmFzc2lnbih7YmlEaVN1cHBvcnQ6ITEsY3VzdG9tRm9ybWF0dGVyczpudWxsLHBsdXJhbEtleUNoZWNrczohMCxzdHJpY3ROdW1iZXJTaWduOiExfSxlKSx0aGlzLnBsdXJhbEZ1bmNzPXt9LFwic3RyaW5nXCI9PXR5cGVvZiByKXRoaXMucGx1cmFsRnVuY3Nbcl09dyhyLHRoaXMub3B0aW9ucyksdGhpcy5kZWZhdWx0TG9jYWxlPXI7ZWxzZSBpZihBcnJheS5pc0FycmF5KHIpKXIuZm9yRWFjaChmdW5jdGlvbih0KXtuLnBsdXJhbEZ1bmNzW3RdPXcodCxuLm9wdGlvbnMpfSksdGhpcy5kZWZhdWx0TG9jYWxlPXJbMF07ZWxzZXtpZihyKWZvcih2YXIgbz1PYmplY3Qua2V5cyhyKSxpPTA7aTxvLmxlbmd0aDsrK2kpe3ZhciB1PW9baV07aWYoXCJmdW5jdGlvblwiIT10eXBlb2Ygclt1XSl7dmFyIGE9XCJFeHBlY3RlZCBmdW5jdGlvbiB2YWx1ZSBmb3IgbG9jYWxlIFwiK1N0cmluZyh1KTt0aHJvdyBuZXcgRXJyb3IoYSl9dGhpcy5wbHVyYWxGdW5jc1t1XT1yW3VdLHRoaXMuZGVmYXVsdExvY2FsZXx8KHRoaXMuZGVmYXVsdExvY2FsZT11KX10aGlzLmRlZmF1bHRMb2NhbGU/dGhpcy5oYXNDdXN0b21QbHVyYWxGdW5jcz0hMDoodGhpcy5kZWZhdWx0TG9jYWxlPXQuZGVmYXVsdExvY2FsZSx0aGlzLmhhc0N1c3RvbVBsdXJhbEZ1bmNzPSExKX10aGlzLmZtdD1PYmplY3QuYXNzaWduKHt9LHRoaXMub3B0aW9ucy5jdXN0b21Gb3JtYXR0ZXJzKSx0aGlzLnJ1bnRpbWU9bmV3IGsodGhpcyl9cmV0dXJuIGoodCxudWxsLFt7a2V5OlwiZXNjYXBlXCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgZT1yPy9bI3t9XS9nOi9be31dL2c7cmV0dXJuIFN0cmluZyh0KS5yZXBsYWNlKGUsXCInJCYnXCIpfX1dKSxqKHQsW3trZXk6XCJhZGRGb3JtYXR0ZXJzXCIsdmFsdWU6ZnVuY3Rpb24odCl7Zm9yKHZhciByPU9iamVjdC5rZXlzKHQpLGU9MDtlPHIubGVuZ3RoOysrZSl7dmFyIG49cltlXTt0aGlzLmZtdFtuXT10W25dfXJldHVybiB0aGlzfX0se2tleTpcImRpc2FibGVQbHVyYWxLZXlDaGVja3NcIix2YWx1ZTpmdW5jdGlvbigpe2Zvcih2YXIgdCBpbiB0aGlzLm9wdGlvbnMucGx1cmFsS2V5Q2hlY2tzPSExLHRoaXMucGx1cmFsRnVuY3Mpe3ZhciByPXRoaXMucGx1cmFsRnVuY3NbdF07ciYmKHIuY2FyZGluYWw9W10sci5vcmRpbmFsPVtdKX1yZXR1cm4gdGhpc319LHtrZXk6XCJzZXRCaURpU3VwcG9ydFwiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuYmlEaVN1cHBvcnQ9ISF0fHx2b2lkIDA9PT10LHRoaXN9fSx7a2V5Olwic2V0U3RyaWN0TnVtYmVyU2lnblwiLHZhbHVlOmZ1bmN0aW9uKHQpe3JldHVybiB0aGlzLm9wdGlvbnMuc3RyaWN0TnVtYmVyU2lnbj0hIXR8fHZvaWQgMD09PXQsdGhpcy5ydW50aW1lLnNldFN0cmljdE51bWJlcih0aGlzLm9wdGlvbnMuc3RyaWN0TnVtYmVyU2lnbiksdGhpc319LHtrZXk6XCJjb21waWxlXCIsdmFsdWU6ZnVuY3Rpb24odCxyKXt2YXIgZT17fTtpZigwPT09T2JqZWN0LmtleXModGhpcy5wbHVyYWxGdW5jcykubGVuZ3RoKWlmKHIpe3ZhciBuPXcocix0aGlzLm9wdGlvbnMpO2lmKCFuKXt2YXIgbz1KU09OLnN0cmluZ2lmeShyKTt0aHJvdyBuZXcgRXJyb3IoXCJMb2NhbGUgXCIuY29uY2F0KG8sXCIgbm90IGZvdW5kIVwiKSl9ZVtyXT1ufWVsc2Ugcj10aGlzLmRlZmF1bHRMb2NhbGUsZT1mdW5jdGlvbih0KXtmb3IodmFyIHI9dC5wbHVyYWxLZXlDaGVja3MsZT17fSxuPU9iamVjdC5rZXlzKGcuYSksbz0wO288bi5sZW5ndGg7KytvKXt2YXIgaT1uW29dO2VbaV09dihpLGcuYVtpXSxyKX1yZXR1cm4gZX0odGhpcy5vcHRpb25zKTtlbHNlIGlmKHIpe3ZhciBpPXRoaXMucGx1cmFsRnVuY3Nbcl07aWYoIWkpe3ZhciB1PUpTT04uc3RyaW5naWZ5KHIpLGE9SlNPTi5zdHJpbmdpZnkodGhpcy5wbHVyYWxGdW5jcyk7dGhyb3cgbmV3IEVycm9yKFwiTG9jYWxlIFwiLmNvbmNhdCh1LFwiIG5vdCBmb3VuZCBpbiBcIikuY29uY2F0KGEsXCIhXCIpKX1lW3JdPWl9ZWxzZSByPXRoaXMuZGVmYXVsdExvY2FsZSxlPXRoaXMucGx1cmFsRnVuY3M7dmFyIGY9bmV3IHAodGhpcykscz1mLmNvbXBpbGUodCxyLGUpO2lmKFwib2JqZWN0XCIhPXgodCkpe3ZhciBsPW5ldyBGdW5jdGlvbihcIm51bWJlciwgcGx1cmFsLCBzZWxlY3QsIGZtdFwiLGgociksXCJyZXR1cm4gXCIrcyksbT10aGlzLnJ1bnRpbWU7cmV0dXJuIGwobS5udW1iZXIsbS5wbHVyYWwsbS5zZWxlY3QsdGhpcy5mbXQsZVtyXSl9dmFyIGQ9dGhpcy5ydW50aW1lLnRvU3RyaW5nKGUsZikrXCJcXG5cIix5PWZ1bmN0aW9uIHQocixlKXtpZihlfHwoZT0wKSxcIm9iamVjdFwiIT14KHIpKXJldHVybiByO2Zvcih2YXIgbj1cIlwiLG89MDtvPGU7KytvKW4rPVwiICBcIjt2YXIgaT1bXTtmb3IodmFyIHUgaW4gcil7dmFyIGE9dChyW3VdLGUrMSk7aS5wdXNoKFwiXFxuXCIuY29uY2F0KG4sXCIgIFwiKS5jb25jYXQoYyh1KSxcIjogXCIpLmNvbmNhdChhKSl9cmV0dXJuXCJ7XCIuY29uY2F0KGkuam9pbihcIixcIiksXCJcXG5cIikuY29uY2F0KG4sXCJ9XCIpfShzKSxiPW5ldyBGdW5jdGlvbihkK1wicmV0dXJuIFwiK3kpKCk7aWYoYi5oYXNPd25Qcm9wZXJ0eShcInRvU3RyaW5nXCIpKXRocm93IG5ldyBFcnJvcihcIlRoZSB0b3AtbGV2ZWwgbWVzc2FnZSBrZXkgYHRvU3RyaW5nYCBpcyByZXNlcnZlZFwiKTtyZXR1cm4gYi50b1N0cmluZz1mdW5jdGlvbih0KXtyZXR1cm4gdCYmXCJleHBvcnQgZGVmYXVsdFwiIT09dD90LmluZGV4T2YoXCIuXCIpPi0xP2QrdCtcIiA9IFwiK3k6ZCtbXCIoZnVuY3Rpb24gKHJvb3QsIEcpIHtcIiwnICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHsgZGVmaW5lKEcpOyB9JywnICBlbHNlIGlmICh0eXBlb2YgZXhwb3J0cyA9PT0gXCJvYmplY3RcIikgeyBtb2R1bGUuZXhwb3J0cyA9IEc7IH0nLFwiICBlbHNlIHsgXCIrYyh0LFwicm9vdFwiKStcIiA9IEc7IH1cIixcIn0pKHRoaXMsIFwiK3krXCIpO1wiXS5qb2luKFwiXFxuXCIpOmQrXCJleHBvcnQgZGVmYXVsdCBcIit5fSxifX1dKSx0fSgpO04uZGVmYXVsdExvY2FsZT1cImVuXCIsTi5mb3JtYXR0ZXJzPW8uYX1dKS5kZWZhdWx0fSk7XG4vLyMgc291cmNlTWFwcGluZ1VSTD1tZXNzYWdlZm9ybWF0LmpzLm1hcCIsIi8vIHNoaW0gZm9yIHVzaW5nIHByb2Nlc3MgaW4gYnJvd3NlclxudmFyIHByb2Nlc3MgPSBtb2R1bGUuZXhwb3J0cyA9IHt9O1xuXG4vLyBjYWNoZWQgZnJvbSB3aGF0ZXZlciBnbG9iYWwgaXMgcHJlc2VudCBzbyB0aGF0IHRlc3QgcnVubmVycyB0aGF0IHN0dWIgaXRcbi8vIGRvbid0IGJyZWFrIHRoaW5ncy4gIEJ1dCB3ZSBuZWVkIHRvIHdyYXAgaXQgaW4gYSB0cnkgY2F0Y2ggaW4gY2FzZSBpdCBpc1xuLy8gd3JhcHBlZCBpbiBzdHJpY3QgbW9kZSBjb2RlIHdoaWNoIGRvZXNuJ3QgZGVmaW5lIGFueSBnbG9iYWxzLiAgSXQncyBpbnNpZGUgYVxuLy8gZnVuY3Rpb24gYmVjYXVzZSB0cnkvY2F0Y2hlcyBkZW9wdGltaXplIGluIGNlcnRhaW4gZW5naW5lcy5cblxudmFyIGNhY2hlZFNldFRpbWVvdXQ7XG52YXIgY2FjaGVkQ2xlYXJUaW1lb3V0O1xuXG5mdW5jdGlvbiBkZWZhdWx0U2V0VGltb3V0KCkge1xuICAgIHRocm93IG5ldyBFcnJvcignc2V0VGltZW91dCBoYXMgbm90IGJlZW4gZGVmaW5lZCcpO1xufVxuZnVuY3Rpb24gZGVmYXVsdENsZWFyVGltZW91dCAoKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdjbGVhclRpbWVvdXQgaGFzIG5vdCBiZWVuIGRlZmluZWQnKTtcbn1cbihmdW5jdGlvbiAoKSB7XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBzZXRUaW1lb3V0ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gc2V0VGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBkZWZhdWx0U2V0VGltb3V0O1xuICAgICAgICB9XG4gICAgfSBjYXRjaCAoZSkge1xuICAgICAgICBjYWNoZWRTZXRUaW1lb3V0ID0gZGVmYXVsdFNldFRpbW91dDtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBjbGVhclRpbWVvdXQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGNsZWFyVGltZW91dDtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGNhY2hlZENsZWFyVGltZW91dCA9IGRlZmF1bHRDbGVhclRpbWVvdXQ7XG4gICAgfVxufSAoKSlcbmZ1bmN0aW9uIHJ1blRpbWVvdXQoZnVuKSB7XG4gICAgaWYgKGNhY2hlZFNldFRpbWVvdXQgPT09IHNldFRpbWVvdXQpIHtcbiAgICAgICAgLy9ub3JtYWwgZW52aXJvbWVudHMgaW4gc2FuZSBzaXR1YXRpb25zXG4gICAgICAgIHJldHVybiBzZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfVxuICAgIC8vIGlmIHNldFRpbWVvdXQgd2Fzbid0IGF2YWlsYWJsZSBidXQgd2FzIGxhdHRlciBkZWZpbmVkXG4gICAgaWYgKChjYWNoZWRTZXRUaW1lb3V0ID09PSBkZWZhdWx0U2V0VGltb3V0IHx8ICFjYWNoZWRTZXRUaW1lb3V0KSAmJiBzZXRUaW1lb3V0KSB7XG4gICAgICAgIGNhY2hlZFNldFRpbWVvdXQgPSBzZXRUaW1lb3V0O1xuICAgICAgICByZXR1cm4gc2V0VGltZW91dChmdW4sIDApO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICAvLyB3aGVuIHdoZW4gc29tZWJvZHkgaGFzIHNjcmV3ZWQgd2l0aCBzZXRUaW1lb3V0IGJ1dCBubyBJLkUuIG1hZGRuZXNzXG4gICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0KGZ1biwgMCk7XG4gICAgfSBjYXRjaChlKXtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIC8vIFdoZW4gd2UgYXJlIGluIEkuRS4gYnV0IHRoZSBzY3JpcHQgaGFzIGJlZW4gZXZhbGVkIHNvIEkuRS4gZG9lc24ndCB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZFNldFRpbWVvdXQuY2FsbChudWxsLCBmdW4sIDApO1xuICAgICAgICB9IGNhdGNoKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3JcbiAgICAgICAgICAgIHJldHVybiBjYWNoZWRTZXRUaW1lb3V0LmNhbGwodGhpcywgZnVuLCAwKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG59XG5mdW5jdGlvbiBydW5DbGVhclRpbWVvdXQobWFya2VyKSB7XG4gICAgaWYgKGNhY2hlZENsZWFyVGltZW91dCA9PT0gY2xlYXJUaW1lb3V0KSB7XG4gICAgICAgIC8vbm9ybWFsIGVudmlyb21lbnRzIGluIHNhbmUgc2l0dWF0aW9uc1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIC8vIGlmIGNsZWFyVGltZW91dCB3YXNuJ3QgYXZhaWxhYmxlIGJ1dCB3YXMgbGF0dGVyIGRlZmluZWRcbiAgICBpZiAoKGNhY2hlZENsZWFyVGltZW91dCA9PT0gZGVmYXVsdENsZWFyVGltZW91dCB8fCAhY2FjaGVkQ2xlYXJUaW1lb3V0KSAmJiBjbGVhclRpbWVvdXQpIHtcbiAgICAgICAgY2FjaGVkQ2xlYXJUaW1lb3V0ID0gY2xlYXJUaW1lb3V0O1xuICAgICAgICByZXR1cm4gY2xlYXJUaW1lb3V0KG1hcmtlcik7XG4gICAgfVxuICAgIHRyeSB7XG4gICAgICAgIC8vIHdoZW4gd2hlbiBzb21lYm9keSBoYXMgc2NyZXdlZCB3aXRoIHNldFRpbWVvdXQgYnV0IG5vIEkuRS4gbWFkZG5lc3NcbiAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dChtYXJrZXIpO1xuICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgLy8gV2hlbiB3ZSBhcmUgaW4gSS5FLiBidXQgdGhlIHNjcmlwdCBoYXMgYmVlbiBldmFsZWQgc28gSS5FLiBkb2Vzbid0ICB0cnVzdCB0aGUgZ2xvYmFsIG9iamVjdCB3aGVuIGNhbGxlZCBub3JtYWxseVxuICAgICAgICAgICAgcmV0dXJuIGNhY2hlZENsZWFyVGltZW91dC5jYWxsKG51bGwsIG1hcmtlcik7XG4gICAgICAgIH0gY2F0Y2ggKGUpe1xuICAgICAgICAgICAgLy8gc2FtZSBhcyBhYm92ZSBidXQgd2hlbiBpdCdzIGEgdmVyc2lvbiBvZiBJLkUuIHRoYXQgbXVzdCBoYXZlIHRoZSBnbG9iYWwgb2JqZWN0IGZvciAndGhpcycsIGhvcGZ1bGx5IG91ciBjb250ZXh0IGNvcnJlY3Qgb3RoZXJ3aXNlIGl0IHdpbGwgdGhyb3cgYSBnbG9iYWwgZXJyb3IuXG4gICAgICAgICAgICAvLyBTb21lIHZlcnNpb25zIG9mIEkuRS4gaGF2ZSBkaWZmZXJlbnQgcnVsZXMgZm9yIGNsZWFyVGltZW91dCB2cyBzZXRUaW1lb3V0XG4gICAgICAgICAgICByZXR1cm4gY2FjaGVkQ2xlYXJUaW1lb3V0LmNhbGwodGhpcywgbWFya2VyKTtcbiAgICAgICAgfVxuICAgIH1cblxuXG5cbn1cbnZhciBxdWV1ZSA9IFtdO1xudmFyIGRyYWluaW5nID0gZmFsc2U7XG52YXIgY3VycmVudFF1ZXVlO1xudmFyIHF1ZXVlSW5kZXggPSAtMTtcblxuZnVuY3Rpb24gY2xlYW5VcE5leHRUaWNrKCkge1xuICAgIGlmICghZHJhaW5pbmcgfHwgIWN1cnJlbnRRdWV1ZSkge1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGRyYWluaW5nID0gZmFsc2U7XG4gICAgaWYgKGN1cnJlbnRRdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgcXVldWUgPSBjdXJyZW50UXVldWUuY29uY2F0KHF1ZXVlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgfVxuICAgIGlmIChxdWV1ZS5sZW5ndGgpIHtcbiAgICAgICAgZHJhaW5RdWV1ZSgpO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gZHJhaW5RdWV1ZSgpIHtcbiAgICBpZiAoZHJhaW5pbmcpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICB2YXIgdGltZW91dCA9IHJ1blRpbWVvdXQoY2xlYW5VcE5leHRUaWNrKTtcbiAgICBkcmFpbmluZyA9IHRydWU7XG5cbiAgICB2YXIgbGVuID0gcXVldWUubGVuZ3RoO1xuICAgIHdoaWxlKGxlbikge1xuICAgICAgICBjdXJyZW50UXVldWUgPSBxdWV1ZTtcbiAgICAgICAgcXVldWUgPSBbXTtcbiAgICAgICAgd2hpbGUgKCsrcXVldWVJbmRleCA8IGxlbikge1xuICAgICAgICAgICAgaWYgKGN1cnJlbnRRdWV1ZSkge1xuICAgICAgICAgICAgICAgIGN1cnJlbnRRdWV1ZVtxdWV1ZUluZGV4XS5ydW4oKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBxdWV1ZUluZGV4ID0gLTE7XG4gICAgICAgIGxlbiA9IHF1ZXVlLmxlbmd0aDtcbiAgICB9XG4gICAgY3VycmVudFF1ZXVlID0gbnVsbDtcbiAgICBkcmFpbmluZyA9IGZhbHNlO1xuICAgIHJ1bkNsZWFyVGltZW91dCh0aW1lb3V0KTtcbn1cblxucHJvY2Vzcy5uZXh0VGljayA9IGZ1bmN0aW9uIChmdW4pIHtcbiAgICB2YXIgYXJncyA9IG5ldyBBcnJheShhcmd1bWVudHMubGVuZ3RoIC0gMSk7XG4gICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7XG4gICAgICAgIGZvciAodmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBhcmdzW2kgLSAxXSA9IGFyZ3VtZW50c1tpXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBxdWV1ZS5wdXNoKG5ldyBJdGVtKGZ1biwgYXJncykpO1xuICAgIGlmIChxdWV1ZS5sZW5ndGggPT09IDEgJiYgIWRyYWluaW5nKSB7XG4gICAgICAgIHJ1blRpbWVvdXQoZHJhaW5RdWV1ZSk7XG4gICAgfVxufTtcblxuLy8gdjggbGlrZXMgcHJlZGljdGlibGUgb2JqZWN0c1xuZnVuY3Rpb24gSXRlbShmdW4sIGFycmF5KSB7XG4gICAgdGhpcy5mdW4gPSBmdW47XG4gICAgdGhpcy5hcnJheSA9IGFycmF5O1xufVxuSXRlbS5wcm90b3R5cGUucnVuID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZnVuLmFwcGx5KG51bGwsIHRoaXMuYXJyYXkpO1xufTtcbnByb2Nlc3MudGl0bGUgPSAnYnJvd3Nlcic7XG5wcm9jZXNzLmJyb3dzZXIgPSB0cnVlO1xucHJvY2Vzcy5lbnYgPSB7fTtcbnByb2Nlc3MuYXJndiA9IFtdO1xucHJvY2Vzcy52ZXJzaW9uID0gJyc7IC8vIGVtcHR5IHN0cmluZyB0byBhdm9pZCByZWdleHAgaXNzdWVzXG5wcm9jZXNzLnZlcnNpb25zID0ge307XG5cbmZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5wcm9jZXNzLm9uID0gbm9vcDtcbnByb2Nlc3MuYWRkTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5vbmNlID0gbm9vcDtcbnByb2Nlc3Mub2ZmID0gbm9vcDtcbnByb2Nlc3MucmVtb3ZlTGlzdGVuZXIgPSBub29wO1xucHJvY2Vzcy5yZW1vdmVBbGxMaXN0ZW5lcnMgPSBub29wO1xucHJvY2Vzcy5lbWl0ID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZExpc3RlbmVyID0gbm9vcDtcbnByb2Nlc3MucHJlcGVuZE9uY2VMaXN0ZW5lciA9IG5vb3A7XG5cbnByb2Nlc3MubGlzdGVuZXJzID0gZnVuY3Rpb24gKG5hbWUpIHsgcmV0dXJuIFtdIH1cblxucHJvY2Vzcy5iaW5kaW5nID0gZnVuY3Rpb24gKG5hbWUpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuYmluZGluZyBpcyBub3Qgc3VwcG9ydGVkJyk7XG59O1xuXG5wcm9jZXNzLmN3ZCA9IGZ1bmN0aW9uICgpIHsgcmV0dXJuICcvJyB9O1xucHJvY2Vzcy5jaGRpciA9IGZ1bmN0aW9uIChkaXIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3Byb2Nlc3MuY2hkaXIgaXMgbm90IHN1cHBvcnRlZCcpO1xufTtcbnByb2Nlc3MudW1hc2sgPSBmdW5jdGlvbigpIHsgcmV0dXJuIDA7IH07XG4iLCIvKiFcbiAqIFFVbml0IDIuMTEuM1xuICogaHR0cHM6Ly9xdW5pdGpzLmNvbS9cbiAqXG4gKiBDb3B5cmlnaHQgT3BlbkpTIEZvdW5kYXRpb24gYW5kIG90aGVyIGNvbnRyaWJ1dG9yc1xuICogUmVsZWFzZWQgdW5kZXIgdGhlIE1JVCBsaWNlbnNlXG4gKiBodHRwczovL2pxdWVyeS5vcmcvbGljZW5zZVxuICpcbiAqIERhdGU6IDIwMjAtMTAtMDVUMDE6MzRaXG4gKi9cbihmdW5jdGlvbiAoZ2xvYmFsJDEpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGZ1bmN0aW9uIF9pbnRlcm9wRGVmYXVsdExlZ2FjeSAoZSkgeyByZXR1cm4gZSAmJiB0eXBlb2YgZSA9PT0gJ29iamVjdCcgJiYgJ2RlZmF1bHQnIGluIGUgPyBlIDogeyAnZGVmYXVsdCc6IGUgfTsgfVxuXG5cdHZhciBnbG9iYWxfX2RlZmF1bHQgPSAvKiNfX1BVUkVfXyovX2ludGVyb3BEZWZhdWx0TGVnYWN5KGdsb2JhbCQxKTtcblxuXHR2YXIgd2luZG93JDEgPSBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS53aW5kb3c7XG5cdHZhciBzZWxmJDEgPSBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS5zZWxmO1xuXHR2YXIgY29uc29sZSA9IGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLmNvbnNvbGU7XG5cdHZhciBzZXRUaW1lb3V0JDEgPSBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS5zZXRUaW1lb3V0O1xuXHR2YXIgY2xlYXJUaW1lb3V0ID0gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uY2xlYXJUaW1lb3V0O1xuXHR2YXIgZG9jdW1lbnQkMSA9IHdpbmRvdyQxICYmIHdpbmRvdyQxLmRvY3VtZW50O1xuXHR2YXIgbmF2aWdhdG9yID0gd2luZG93JDEgJiYgd2luZG93JDEubmF2aWdhdG9yO1xuXHR2YXIgbG9jYWxTZXNzaW9uU3RvcmFnZSA9IGZ1bmN0aW9uICgpIHtcblx0ICB2YXIgeCA9IFwicXVuaXQtdGVzdC1zdHJpbmdcIjtcblxuXHQgIHRyeSB7XG5cdCAgICBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS5zZXNzaW9uU3RvcmFnZS5zZXRJdGVtKHgsIHgpO1xuXHQgICAgZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uc2Vzc2lvblN0b3JhZ2UucmVtb3ZlSXRlbSh4KTtcblx0ICAgIHJldHVybiBnbG9iYWxfX2RlZmF1bHRbJ2RlZmF1bHQnXS5zZXNzaW9uU3RvcmFnZTtcblx0ICB9IGNhdGNoIChlKSB7XG5cdCAgICByZXR1cm4gdW5kZWZpbmVkO1xuXHQgIH1cblx0fSgpOyAvLyBTdXBwb3J0IElFIDktMTA6IEZhbGxiYWNrIGZvciBmdXp6eXNvcnQuanMgdXNlZCBieSAvcmVwb3J0ZXIvaHRtbC5qc1xuXG5cdGlmICghZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uTWFwKSB7XG5cdCAgZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10uTWFwID0gZnVuY3Rpb24gU3RyaW5nTWFwKCkge1xuXHQgICAgdmFyIHN0b3JlID0gT2JqZWN0LmNyZWF0ZShudWxsKTtcblxuXHQgICAgdGhpcy5nZXQgPSBmdW5jdGlvbiAoc3RyS2V5KSB7XG5cdCAgICAgIHJldHVybiBzdG9yZVtzdHJLZXldO1xuXHQgICAgfTtcblxuXHQgICAgdGhpcy5zZXQgPSBmdW5jdGlvbiAoc3RyS2V5LCB2YWwpIHtcblx0ICAgICAgc3RvcmVbc3RyS2V5XSA9IHZhbDtcblx0ICAgICAgcmV0dXJuIHRoaXM7XG5cdCAgICB9O1xuXG5cdCAgICB0aGlzLmNsZWFyID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBzdG9yZSA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdCAgICB9O1xuXHQgIH07XG5cdH1cblxuXHRmdW5jdGlvbiBfdHlwZW9mKG9iaikge1xuXHQgIFwiQGJhYmVsL2hlbHBlcnMgLSB0eXBlb2ZcIjtcblxuXHQgIGlmICh0eXBlb2YgU3ltYm9sID09PSBcImZ1bmN0aW9uXCIgJiYgdHlwZW9mIFN5bWJvbC5pdGVyYXRvciA9PT0gXCJzeW1ib2xcIikge1xuXHQgICAgX3R5cGVvZiA9IGZ1bmN0aW9uIChvYmopIHtcblx0ICAgICAgcmV0dXJuIHR5cGVvZiBvYmo7XG5cdCAgICB9O1xuXHQgIH0gZWxzZSB7XG5cdCAgICBfdHlwZW9mID0gZnVuY3Rpb24gKG9iaikge1xuXHQgICAgICByZXR1cm4gb2JqICYmIHR5cGVvZiBTeW1ib2wgPT09IFwiZnVuY3Rpb25cIiAmJiBvYmouY29uc3RydWN0b3IgPT09IFN5bWJvbCAmJiBvYmogIT09IFN5bWJvbC5wcm90b3R5cGUgPyBcInN5bWJvbFwiIDogdHlwZW9mIG9iajtcblx0ICAgIH07XG5cdCAgfVxuXG5cdCAgcmV0dXJuIF90eXBlb2Yob2JqKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9jbGFzc0NhbGxDaGVjayhpbnN0YW5jZSwgQ29uc3RydWN0b3IpIHtcblx0ICBpZiAoIShpbnN0YW5jZSBpbnN0YW5jZW9mIENvbnN0cnVjdG9yKSkge1xuXHQgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCBjYWxsIGEgY2xhc3MgYXMgYSBmdW5jdGlvblwiKTtcblx0ICB9XG5cdH1cblxuXHRmdW5jdGlvbiBfZGVmaW5lUHJvcGVydGllcyh0YXJnZXQsIHByb3BzKSB7XG5cdCAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9wcy5sZW5ndGg7IGkrKykge1xuXHQgICAgdmFyIGRlc2NyaXB0b3IgPSBwcm9wc1tpXTtcblx0ICAgIGRlc2NyaXB0b3IuZW51bWVyYWJsZSA9IGRlc2NyaXB0b3IuZW51bWVyYWJsZSB8fCBmYWxzZTtcblx0ICAgIGRlc2NyaXB0b3IuY29uZmlndXJhYmxlID0gdHJ1ZTtcblx0ICAgIGlmIChcInZhbHVlXCIgaW4gZGVzY3JpcHRvcikgZGVzY3JpcHRvci53cml0YWJsZSA9IHRydWU7XG5cdCAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkodGFyZ2V0LCBkZXNjcmlwdG9yLmtleSwgZGVzY3JpcHRvcik7XG5cdCAgfVxuXHR9XG5cblx0ZnVuY3Rpb24gX2NyZWF0ZUNsYXNzKENvbnN0cnVjdG9yLCBwcm90b1Byb3BzLCBzdGF0aWNQcm9wcykge1xuXHQgIGlmIChwcm90b1Byb3BzKSBfZGVmaW5lUHJvcGVydGllcyhDb25zdHJ1Y3Rvci5wcm90b3R5cGUsIHByb3RvUHJvcHMpO1xuXHQgIGlmIChzdGF0aWNQcm9wcykgX2RlZmluZVByb3BlcnRpZXMoQ29uc3RydWN0b3IsIHN0YXRpY1Byb3BzKTtcblx0ICByZXR1cm4gQ29uc3RydWN0b3I7XG5cdH1cblxuXHRmdW5jdGlvbiBfdG9Db25zdW1hYmxlQXJyYXkoYXJyKSB7XG5cdCAgcmV0dXJuIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHx8IF9pdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfdW5zdXBwb3J0ZWRJdGVyYWJsZVRvQXJyYXkoYXJyKSB8fCBfbm9uSXRlcmFibGVTcHJlYWQoKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9hcnJheVdpdGhvdXRIb2xlcyhhcnIpIHtcblx0ICBpZiAoQXJyYXkuaXNBcnJheShhcnIpKSByZXR1cm4gX2FycmF5TGlrZVRvQXJyYXkoYXJyKTtcblx0fVxuXG5cdGZ1bmN0aW9uIF9pdGVyYWJsZVRvQXJyYXkoaXRlcikge1xuXHQgIGlmICh0eXBlb2YgU3ltYm9sICE9PSBcInVuZGVmaW5lZFwiICYmIFN5bWJvbC5pdGVyYXRvciBpbiBPYmplY3QoaXRlcikpIHJldHVybiBBcnJheS5mcm9tKGl0ZXIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8sIG1pbkxlbikge1xuXHQgIGlmICghbykgcmV0dXJuO1xuXHQgIGlmICh0eXBlb2YgbyA9PT0gXCJzdHJpbmdcIikgcmV0dXJuIF9hcnJheUxpa2VUb0FycmF5KG8sIG1pbkxlbik7XG5cdCAgdmFyIG4gPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwobykuc2xpY2UoOCwgLTEpO1xuXHQgIGlmIChuID09PSBcIk9iamVjdFwiICYmIG8uY29uc3RydWN0b3IpIG4gPSBvLmNvbnN0cnVjdG9yLm5hbWU7XG5cdCAgaWYgKG4gPT09IFwiTWFwXCIgfHwgbiA9PT0gXCJTZXRcIikgcmV0dXJuIEFycmF5LmZyb20obyk7XG5cdCAgaWYgKG4gPT09IFwiQXJndW1lbnRzXCIgfHwgL14oPzpVaXxJKW50KD86OHwxNnwzMikoPzpDbGFtcGVkKT9BcnJheSQvLnRlc3QobikpIHJldHVybiBfYXJyYXlMaWtlVG9BcnJheShvLCBtaW5MZW4pO1xuXHR9XG5cblx0ZnVuY3Rpb24gX2FycmF5TGlrZVRvQXJyYXkoYXJyLCBsZW4pIHtcblx0ICBpZiAobGVuID09IG51bGwgfHwgbGVuID4gYXJyLmxlbmd0aCkgbGVuID0gYXJyLmxlbmd0aDtcblxuXHQgIGZvciAodmFyIGkgPSAwLCBhcnIyID0gbmV3IEFycmF5KGxlbik7IGkgPCBsZW47IGkrKykgYXJyMltpXSA9IGFycltpXTtcblxuXHQgIHJldHVybiBhcnIyO1xuXHR9XG5cblx0ZnVuY3Rpb24gX25vbkl0ZXJhYmxlU3ByZWFkKCkge1xuXHQgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJJbnZhbGlkIGF0dGVtcHQgdG8gc3ByZWFkIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xuXHR9XG5cblx0ZnVuY3Rpb24gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIobywgYWxsb3dBcnJheUxpa2UpIHtcblx0ICB2YXIgaXQ7XG5cblx0ICBpZiAodHlwZW9mIFN5bWJvbCA9PT0gXCJ1bmRlZmluZWRcIiB8fCBvW1N5bWJvbC5pdGVyYXRvcl0gPT0gbnVsbCkge1xuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkobykgfHwgKGl0ID0gX3Vuc3VwcG9ydGVkSXRlcmFibGVUb0FycmF5KG8pKSB8fCBhbGxvd0FycmF5TGlrZSAmJiBvICYmIHR5cGVvZiBvLmxlbmd0aCA9PT0gXCJudW1iZXJcIikge1xuXHQgICAgICBpZiAoaXQpIG8gPSBpdDtcblx0ICAgICAgdmFyIGkgPSAwO1xuXG5cdCAgICAgIHZhciBGID0gZnVuY3Rpb24gKCkge307XG5cblx0ICAgICAgcmV0dXJuIHtcblx0ICAgICAgICBzOiBGLFxuXHQgICAgICAgIG46IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIGlmIChpID49IG8ubGVuZ3RoKSByZXR1cm4ge1xuXHQgICAgICAgICAgICBkb25lOiB0cnVlXG5cdCAgICAgICAgICB9O1xuXHQgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgZG9uZTogZmFsc2UsXG5cdCAgICAgICAgICAgIHZhbHVlOiBvW2krK11cblx0ICAgICAgICAgIH07XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBlOiBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgICAgdGhyb3cgZTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGY6IEZcblx0ICAgICAgfTtcblx0ICAgIH1cblxuXHQgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkludmFsaWQgYXR0ZW1wdCB0byBpdGVyYXRlIG5vbi1pdGVyYWJsZSBpbnN0YW5jZS5cXG5JbiBvcmRlciB0byBiZSBpdGVyYWJsZSwgbm9uLWFycmF5IG9iamVjdHMgbXVzdCBoYXZlIGEgW1N5bWJvbC5pdGVyYXRvcl0oKSBtZXRob2QuXCIpO1xuXHQgIH1cblxuXHQgIHZhciBub3JtYWxDb21wbGV0aW9uID0gdHJ1ZSxcblx0ICAgICAgZGlkRXJyID0gZmFsc2UsXG5cdCAgICAgIGVycjtcblx0ICByZXR1cm4ge1xuXHQgICAgczogZnVuY3Rpb24gKCkge1xuXHQgICAgICBpdCA9IG9bU3ltYm9sLml0ZXJhdG9yXSgpO1xuXHQgICAgfSxcblx0ICAgIG46IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgdmFyIHN0ZXAgPSBpdC5uZXh0KCk7XG5cdCAgICAgIG5vcm1hbENvbXBsZXRpb24gPSBzdGVwLmRvbmU7XG5cdCAgICAgIHJldHVybiBzdGVwO1xuXHQgICAgfSxcblx0ICAgIGU6IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgIGRpZEVyciA9IHRydWU7XG5cdCAgICAgIGVyciA9IGU7XG5cdCAgICB9LFxuXHQgICAgZjogZnVuY3Rpb24gKCkge1xuXHQgICAgICB0cnkge1xuXHQgICAgICAgIGlmICghbm9ybWFsQ29tcGxldGlvbiAmJiBpdC5yZXR1cm4gIT0gbnVsbCkgaXQucmV0dXJuKCk7XG5cdCAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgaWYgKGRpZEVycikgdGhyb3cgZXJyO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfTtcblx0fVxuXG5cdC8vIFRoaXMgYWxsb3dzIHN1cHBvcnQgZm9yIElFIDksIHdoaWNoIGRvZXNuJ3QgaGF2ZSBhIGNvbnNvbGVcblx0Ly8gb2JqZWN0IGlmIHRoZSBkZXZlbG9wZXIgdG9vbHMgYXJlIG5vdCBvcGVuLlxuXG5cdHZhciBMb2dnZXIgPSB7XG5cdCAgd2FybjogY29uc29sZSA/IGNvbnNvbGUud2Fybi5iaW5kKGNvbnNvbGUpIDogZnVuY3Rpb24gKCkge31cblx0fTtcblxuXHR2YXIgdG9TdHJpbmcgPSBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nO1xuXHR2YXIgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTtcblx0dmFyIG5vdyA9IERhdGUubm93IHx8IGZ1bmN0aW9uICgpIHtcblx0ICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCk7XG5cdH07XG5cdHZhciBoYXNQZXJmb3JtYW5jZUFwaSA9IGRldGVjdFBlcmZvcm1hbmNlQXBpKCk7XG5cdHZhciBwZXJmb3JtYW5jZSA9IGhhc1BlcmZvcm1hbmNlQXBpID8gd2luZG93JDEucGVyZm9ybWFuY2UgOiB1bmRlZmluZWQ7XG5cdHZhciBwZXJmb3JtYW5jZU5vdyA9IGhhc1BlcmZvcm1hbmNlQXBpID8gcGVyZm9ybWFuY2Uubm93LmJpbmQocGVyZm9ybWFuY2UpIDogbm93O1xuXG5cdGZ1bmN0aW9uIGRldGVjdFBlcmZvcm1hbmNlQXBpKCkge1xuXHQgIHJldHVybiB3aW5kb3ckMSAmJiB0eXBlb2Ygd2luZG93JDEucGVyZm9ybWFuY2UgIT09IFwidW5kZWZpbmVkXCIgJiYgdHlwZW9mIHdpbmRvdyQxLnBlcmZvcm1hbmNlLm1hcmsgPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2Ygd2luZG93JDEucGVyZm9ybWFuY2UubWVhc3VyZSA9PT0gXCJmdW5jdGlvblwiO1xuXHR9XG5cblx0ZnVuY3Rpb24gbWVhc3VyZShjb21tZW50LCBzdGFydE1hcmssIGVuZE1hcmspIHtcblx0ICAvLyBgcGVyZm9ybWFuY2UubWVhc3VyZWAgbWF5IGZhaWwgaWYgdGhlIG1hcmsgY291bGQgbm90IGJlIGZvdW5kLlxuXHQgIC8vIHJlYXNvbnMgYSBzcGVjaWZpYyBtYXJrIGNvdWxkIG5vdCBiZSBmb3VuZCBpbmNsdWRlOiBvdXRzaWRlIGNvZGUgaW52b2tpbmcgYHBlcmZvcm1hbmNlLmNsZWFyTWFya3MoKWBcblx0ICB0cnkge1xuXHQgICAgcGVyZm9ybWFuY2UubWVhc3VyZShjb21tZW50LCBzdGFydE1hcmssIGVuZE1hcmspO1xuXHQgIH0gY2F0Y2ggKGV4KSB7XG5cdCAgICBMb2dnZXIud2FybihcInBlcmZvcm1hbmNlLm1lYXN1cmUgY291bGQgbm90IGJlIGV4ZWN1dGVkIGJlY2F1c2Ugb2YgXCIsIGV4Lm1lc3NhZ2UpO1xuXHQgIH1cblx0fVxuXHR2YXIgZGVmaW5lZCA9IHtcblx0ICBkb2N1bWVudDogd2luZG93JDEgJiYgd2luZG93JDEuZG9jdW1lbnQgIT09IHVuZGVmaW5lZCxcblx0ICBzZXRUaW1lb3V0OiBzZXRUaW1lb3V0JDEgIT09IHVuZGVmaW5lZFxuXHR9OyAvLyBSZXR1cm5zIGEgbmV3IEFycmF5IHdpdGggdGhlIGVsZW1lbnRzIHRoYXQgYXJlIGluIGEgYnV0IG5vdCBpbiBiXG5cblx0ZnVuY3Rpb24gZGlmZihhLCBiKSB7XG5cdCAgdmFyIGksXG5cdCAgICAgIGosXG5cdCAgICAgIHJlc3VsdCA9IGEuc2xpY2UoKTtcblxuXHQgIGZvciAoaSA9IDA7IGkgPCByZXN1bHQubGVuZ3RoOyBpKyspIHtcblx0ICAgIGZvciAoaiA9IDA7IGogPCBiLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgIGlmIChyZXN1bHRbaV0gPT09IGJbal0pIHtcblx0ICAgICAgICByZXN1bHQuc3BsaWNlKGksIDEpO1xuXHQgICAgICAgIGktLTtcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1cblxuXHQgIHJldHVybiByZXN1bHQ7XG5cdH1cblx0LyoqXG5cdCAqIERldGVybWluZXMgd2hldGhlciBhbiBlbGVtZW50IGV4aXN0cyBpbiBhIGdpdmVuIGFycmF5IG9yIG5vdC5cblx0ICpcblx0ICogQG1ldGhvZCBpbkFycmF5XG5cdCAqIEBwYXJhbSB7QW55fSBlbGVtXG5cdCAqIEBwYXJhbSB7QXJyYXl9IGFycmF5XG5cdCAqIEByZXR1cm4ge0Jvb2xlYW59XG5cdCAqL1xuXG5cdGZ1bmN0aW9uIGluQXJyYXkoZWxlbSwgYXJyYXkpIHtcblx0ICByZXR1cm4gYXJyYXkuaW5kZXhPZihlbGVtKSAhPT0gLTE7XG5cdH1cblx0LyoqXG5cdCAqIE1ha2VzIGEgY2xvbmUgb2YgYW4gb2JqZWN0IHVzaW5nIG9ubHkgQXJyYXkgb3IgT2JqZWN0IGFzIGJhc2UsXG5cdCAqIGFuZCBjb3BpZXMgb3ZlciB0aGUgb3duIGVudW1lcmFibGUgcHJvcGVydGllcy5cblx0ICpcblx0ICogQHBhcmFtIHtPYmplY3R9IG9ialxuXHQgKiBAcmV0dXJuIHtPYmplY3R9IE5ldyBvYmplY3Qgd2l0aCBvbmx5IHRoZSBvd24gcHJvcGVydGllcyAocmVjdXJzaXZlbHkpLlxuXHQgKi9cblxuXHRmdW5jdGlvbiBvYmplY3RWYWx1ZXMob2JqKSB7XG5cdCAgdmFyIGtleSxcblx0ICAgICAgdmFsLFxuXHQgICAgICB2YWxzID0gaXMoXCJhcnJheVwiLCBvYmopID8gW10gOiB7fTtcblxuXHQgIGZvciAoa2V5IGluIG9iaikge1xuXHQgICAgaWYgKGhhc093bi5jYWxsKG9iaiwga2V5KSkge1xuXHQgICAgICB2YWwgPSBvYmpba2V5XTtcblx0ICAgICAgdmFsc1trZXldID0gdmFsID09PSBPYmplY3QodmFsKSA/IG9iamVjdFZhbHVlcyh2YWwpIDogdmFsO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIHJldHVybiB2YWxzO1xuXHR9XG5cdGZ1bmN0aW9uIGV4dGVuZChhLCBiLCB1bmRlZk9ubHkpIHtcblx0ICBmb3IgKHZhciBwcm9wIGluIGIpIHtcblx0ICAgIGlmIChoYXNPd24uY2FsbChiLCBwcm9wKSkge1xuXHQgICAgICBpZiAoYltwcm9wXSA9PT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgZGVsZXRlIGFbcHJvcF07XG5cdCAgICAgIH0gZWxzZSBpZiAoISh1bmRlZk9ubHkgJiYgdHlwZW9mIGFbcHJvcF0gIT09IFwidW5kZWZpbmVkXCIpKSB7XG5cdCAgICAgICAgYVtwcm9wXSA9IGJbcHJvcF07XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cblx0ICByZXR1cm4gYTtcblx0fVxuXHRmdW5jdGlvbiBvYmplY3RUeXBlKG9iaikge1xuXHQgIGlmICh0eXBlb2Ygb2JqID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICByZXR1cm4gXCJ1bmRlZmluZWRcIjtcblx0ICB9IC8vIENvbnNpZGVyOiB0eXBlb2YgbnVsbCA9PT0gb2JqZWN0XG5cblxuXHQgIGlmIChvYmogPT09IG51bGwpIHtcblx0ICAgIHJldHVybiBcIm51bGxcIjtcblx0ICB9XG5cblx0ICB2YXIgbWF0Y2ggPSB0b1N0cmluZy5jYWxsKG9iaikubWF0Y2goL15cXFtvYmplY3RcXHMoLiopXFxdJC8pLFxuXHQgICAgICB0eXBlID0gbWF0Y2ggJiYgbWF0Y2hbMV07XG5cblx0ICBzd2l0Y2ggKHR5cGUpIHtcblx0ICAgIGNhc2UgXCJOdW1iZXJcIjpcblx0ICAgICAgaWYgKGlzTmFOKG9iaikpIHtcblx0ICAgICAgICByZXR1cm4gXCJuYW5cIjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBcIm51bWJlclwiO1xuXG5cdCAgICBjYXNlIFwiU3RyaW5nXCI6XG5cdCAgICBjYXNlIFwiQm9vbGVhblwiOlxuXHQgICAgY2FzZSBcIkFycmF5XCI6XG5cdCAgICBjYXNlIFwiU2V0XCI6XG5cdCAgICBjYXNlIFwiTWFwXCI6XG5cdCAgICBjYXNlIFwiRGF0ZVwiOlxuXHQgICAgY2FzZSBcIlJlZ0V4cFwiOlxuXHQgICAgY2FzZSBcIkZ1bmN0aW9uXCI6XG5cdCAgICBjYXNlIFwiU3ltYm9sXCI6XG5cdCAgICAgIHJldHVybiB0eXBlLnRvTG93ZXJDYXNlKCk7XG5cblx0ICAgIGRlZmF1bHQ6XG5cdCAgICAgIHJldHVybiBfdHlwZW9mKG9iaik7XG5cdCAgfVxuXHR9IC8vIFNhZmUgb2JqZWN0IHR5cGUgY2hlY2tpbmdcblxuXHRmdW5jdGlvbiBpcyh0eXBlLCBvYmopIHtcblx0ICByZXR1cm4gb2JqZWN0VHlwZShvYmopID09PSB0eXBlO1xuXHR9IC8vIEJhc2VkIG9uIEphdmEncyBTdHJpbmcuaGFzaENvZGUsIGEgc2ltcGxlIGJ1dCBub3Rcblx0Ly8gcmlnb3JvdXNseSBjb2xsaXNpb24gcmVzaXN0YW50IGhhc2hpbmcgZnVuY3Rpb25cblxuXHRmdW5jdGlvbiBnZW5lcmF0ZUhhc2gobW9kdWxlLCB0ZXN0TmFtZSkge1xuXHQgIHZhciBzdHIgPSBtb2R1bGUgKyBcIlxceDFDXCIgKyB0ZXN0TmFtZTtcblx0ICB2YXIgaGFzaCA9IDA7XG5cblx0ICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuXHQgICAgaGFzaCA9IChoYXNoIDw8IDUpIC0gaGFzaCArIHN0ci5jaGFyQ29kZUF0KGkpO1xuXHQgICAgaGFzaCB8PSAwO1xuXHQgIH0gLy8gQ29udmVydCB0aGUgcG9zc2libHkgbmVnYXRpdmUgaW50ZWdlciBoYXNoIGNvZGUgaW50byBhbiA4IGNoYXJhY3RlciBoZXggc3RyaW5nLCB3aGljaCBpc24ndFxuXHQgIC8vIHN0cmljdGx5IG5lY2Vzc2FyeSBidXQgaW5jcmVhc2VzIHVzZXIgdW5kZXJzdGFuZGluZyB0aGF0IHRoZSBpZCBpcyBhIFNIQS1saWtlIGhhc2hcblxuXG5cdCAgdmFyIGhleCA9ICgweDEwMDAwMDAwMCArIGhhc2gpLnRvU3RyaW5nKDE2KTtcblxuXHQgIGlmIChoZXgubGVuZ3RoIDwgOCkge1xuXHQgICAgaGV4ID0gXCIwMDAwMDAwXCIgKyBoZXg7XG5cdCAgfVxuXG5cdCAgcmV0dXJuIGhleC5zbGljZSgtOCk7XG5cdH1cblxuXHQvLyBBdXRob3JzOiBQaGlsaXBwZSBSYXRow6kgPHByYXRoZUBnbWFpbC5jb20+LCBEYXZpZCBDaGFuIDxkYXZpZEB0cm9pLm9yZz5cblxuXHR2YXIgZXF1aXYgPSAoZnVuY3Rpb24gKCkge1xuXHQgIC8vIFZhbHVlIHBhaXJzIHF1ZXVlZCBmb3IgY29tcGFyaXNvbi4gVXNlZCBmb3IgYnJlYWR0aC1maXJzdCBwcm9jZXNzaW5nIG9yZGVyLCByZWN1cnNpb25cblx0ICAvLyBkZXRlY3Rpb24gYW5kIGF2b2lkaW5nIHJlcGVhdGVkIGNvbXBhcmlzb24gKHNlZSBiZWxvdyBmb3IgZGV0YWlscykuXG5cdCAgLy8gRWxlbWVudHMgYXJlIHsgYTogdmFsLCBiOiB2YWwgfS5cblx0ICB2YXIgcGFpcnMgPSBbXTtcblxuXHQgIHZhciBnZXRQcm90byA9IE9iamVjdC5nZXRQcm90b3R5cGVPZiB8fCBmdW5jdGlvbiAob2JqKSB7XG5cdCAgICByZXR1cm4gb2JqLl9fcHJvdG9fXztcblx0ICB9O1xuXG5cdCAgZnVuY3Rpb24gdXNlU3RyaWN0RXF1YWxpdHkoYSwgYikge1xuXHQgICAgLy8gVGhpcyBvbmx5IGdldHMgY2FsbGVkIGlmIGEgYW5kIGIgYXJlIG5vdCBzdHJpY3QgZXF1YWwsIGFuZCBpcyB1c2VkIHRvIGNvbXBhcmUgb25cblx0ICAgIC8vIHRoZSBwcmltaXRpdmUgdmFsdWVzIGluc2lkZSBvYmplY3Qgd3JhcHBlcnMuIEZvciBleGFtcGxlOlxuXHQgICAgLy8gYHZhciBpID0gMTtgXG5cdCAgICAvLyBgdmFyIGogPSBuZXcgTnVtYmVyKDEpO2Bcblx0ICAgIC8vIE5laXRoZXIgYSBub3IgYiBjYW4gYmUgbnVsbCwgYXMgYSAhPT0gYiBhbmQgdGhleSBoYXZlIHRoZSBzYW1lIHR5cGUuXG5cdCAgICBpZiAoX3R5cGVvZihhKSA9PT0gXCJvYmplY3RcIikge1xuXHQgICAgICBhID0gYS52YWx1ZU9mKCk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChfdHlwZW9mKGIpID09PSBcIm9iamVjdFwiKSB7XG5cdCAgICAgIGIgPSBiLnZhbHVlT2YoKTtcblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIGEgPT09IGI7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gY29tcGFyZUNvbnN0cnVjdG9ycyhhLCBiKSB7XG5cdCAgICB2YXIgcHJvdG9BID0gZ2V0UHJvdG8oYSk7XG5cdCAgICB2YXIgcHJvdG9CID0gZ2V0UHJvdG8oYik7IC8vIENvbXBhcmluZyBjb25zdHJ1Y3RvcnMgaXMgbW9yZSBzdHJpY3QgdGhhbiB1c2luZyBgaW5zdGFuY2VvZmBcblxuXHQgICAgaWYgKGEuY29uc3RydWN0b3IgPT09IGIuY29uc3RydWN0b3IpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9IC8vIFJlZiAjODUxXG5cdCAgICAvLyBJZiB0aGUgb2JqIHByb3RvdHlwZSBkZXNjZW5kcyBmcm9tIGEgbnVsbCBjb25zdHJ1Y3RvciwgdHJlYXQgaXRcblx0ICAgIC8vIGFzIGEgbnVsbCBwcm90b3R5cGUuXG5cblxuXHQgICAgaWYgKHByb3RvQSAmJiBwcm90b0EuY29uc3RydWN0b3IgPT09IG51bGwpIHtcblx0ICAgICAgcHJvdG9BID0gbnVsbDtcblx0ICAgIH1cblxuXHQgICAgaWYgKHByb3RvQiAmJiBwcm90b0IuY29uc3RydWN0b3IgPT09IG51bGwpIHtcblx0ICAgICAgcHJvdG9CID0gbnVsbDtcblx0ICAgIH0gLy8gQWxsb3cgb2JqZWN0cyB3aXRoIG5vIHByb3RvdHlwZSB0byBiZSBlcXVpdmFsZW50IHRvXG5cdCAgICAvLyBvYmplY3RzIHdpdGggT2JqZWN0IGFzIHRoZWlyIGNvbnN0cnVjdG9yLlxuXG5cblx0ICAgIGlmIChwcm90b0EgPT09IG51bGwgJiYgcHJvdG9CID09PSBPYmplY3QucHJvdG90eXBlIHx8IHByb3RvQiA9PT0gbnVsbCAmJiBwcm90b0EgPT09IE9iamVjdC5wcm90b3R5cGUpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBnZXRSZWdFeHBGbGFncyhyZWdleHApIHtcblx0ICAgIHJldHVybiBcImZsYWdzXCIgaW4gcmVnZXhwID8gcmVnZXhwLmZsYWdzIDogcmVnZXhwLnRvU3RyaW5nKCkubWF0Y2goL1tnaW11eV0qJC8pWzBdO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGlzQ29udGFpbmVyKHZhbCkge1xuXHQgICAgcmV0dXJuIFtcIm9iamVjdFwiLCBcImFycmF5XCIsIFwibWFwXCIsIFwic2V0XCJdLmluZGV4T2Yob2JqZWN0VHlwZSh2YWwpKSAhPT0gLTE7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYnJlYWR0aEZpcnN0Q29tcGFyZUNoaWxkKGEsIGIpIHtcblx0ICAgIC8vIElmIGEgaXMgYSBjb250YWluZXIgbm90IHJlZmVyZW5jZS1lcXVhbCB0byBiLCBwb3N0cG9uZSB0aGUgY29tcGFyaXNvbiB0byB0aGVcblx0ICAgIC8vIGVuZCBvZiB0aGUgcGFpcnMgcXVldWUgLS0gdW5sZXNzIChhLCBiKSBoYXMgYmVlbiBzZWVuIGJlZm9yZSwgaW4gd2hpY2ggY2FzZSBza2lwXG5cdCAgICAvLyBvdmVyIHRoZSBwYWlyLlxuXHQgICAgaWYgKGEgPT09IGIpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cblx0ICAgIGlmICghaXNDb250YWluZXIoYSkpIHtcblx0ICAgICAgcmV0dXJuIHR5cGVFcXVpdihhLCBiKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKHBhaXJzLmV2ZXJ5KGZ1bmN0aW9uIChwYWlyKSB7XG5cdCAgICAgIHJldHVybiBwYWlyLmEgIT09IGEgfHwgcGFpci5iICE9PSBiO1xuXHQgICAgfSkpIHtcblx0ICAgICAgLy8gTm90IHlldCBzdGFydGVkIGNvbXBhcmluZyB0aGlzIHBhaXJcblx0ICAgICAgcGFpcnMucHVzaCh7XG5cdCAgICAgICAgYTogYSxcblx0ICAgICAgICBiOiBiXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gdHJ1ZTtcblx0ICB9XG5cblx0ICB2YXIgY2FsbGJhY2tzID0ge1xuXHQgICAgXCJzdHJpbmdcIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcImJvb2xlYW5cIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcIm51bWJlclwiOiB1c2VTdHJpY3RFcXVhbGl0eSxcblx0ICAgIFwibnVsbFwiOiB1c2VTdHJpY3RFcXVhbGl0eSxcblx0ICAgIFwidW5kZWZpbmVkXCI6IHVzZVN0cmljdEVxdWFsaXR5LFxuXHQgICAgXCJzeW1ib2xcIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcImRhdGVcIjogdXNlU3RyaWN0RXF1YWxpdHksXG5cdCAgICBcIm5hblwiOiBmdW5jdGlvbiBuYW4oKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfSxcblx0ICAgIFwicmVnZXhwXCI6IGZ1bmN0aW9uIHJlZ2V4cChhLCBiKSB7XG5cdCAgICAgIHJldHVybiBhLnNvdXJjZSA9PT0gYi5zb3VyY2UgJiYgLy8gSW5jbHVkZSBmbGFncyBpbiB0aGUgY29tcGFyaXNvblxuXHQgICAgICBnZXRSZWdFeHBGbGFncyhhKSA9PT0gZ2V0UmVnRXhwRmxhZ3MoYik7XG5cdCAgICB9LFxuXHQgICAgLy8gYWJvcnQgKGlkZW50aWNhbCByZWZlcmVuY2VzIC8gaW5zdGFuY2UgbWV0aG9kcyB3ZXJlIHNraXBwZWQgZWFybGllcilcblx0ICAgIFwiZnVuY3Rpb25cIjogZnVuY3Rpb24gX2Z1bmN0aW9uKCkge1xuXHQgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICB9LFxuXHQgICAgXCJhcnJheVwiOiBmdW5jdGlvbiBhcnJheShhLCBiKSB7XG5cdCAgICAgIHZhciBpLCBsZW47XG5cdCAgICAgIGxlbiA9IGEubGVuZ3RoO1xuXG5cdCAgICAgIGlmIChsZW4gIT09IGIubGVuZ3RoKSB7XG5cdCAgICAgICAgLy8gU2FmZSBhbmQgZmFzdGVyXG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cblx0ICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgLy8gQ29tcGFyZSBub24tY29udGFpbmVyczsgcXVldWUgbm9uLXJlZmVyZW5jZS1lcXVhbCBjb250YWluZXJzXG5cdCAgICAgICAgaWYgKCFicmVhZHRoRmlyc3RDb21wYXJlQ2hpbGQoYVtpXSwgYltpXSkpIHtcblx0ICAgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH0sXG5cdCAgICAvLyBEZWZpbmUgc2V0cyBhIGFuZCBiIHRvIGJlIGVxdWl2YWxlbnQgaWYgZm9yIGVhY2ggZWxlbWVudCBhVmFsIGluIGEsIHRoZXJlXG5cdCAgICAvLyBpcyBzb21lIGVsZW1lbnQgYlZhbCBpbiBiIHN1Y2ggdGhhdCBhVmFsIGFuZCBiVmFsIGFyZSBlcXVpdmFsZW50LiBFbGVtZW50XG5cdCAgICAvLyByZXBldGl0aW9ucyBhcmUgbm90IGNvdW50ZWQsIHNvIHRoZXNlIGFyZSBlcXVpdmFsZW50OlxuXHQgICAgLy8gYSA9IG5ldyBTZXQoIFsge30sIFtdLCBbXSBdICk7XG5cdCAgICAvLyBiID0gbmV3IFNldCggWyB7fSwge30sIFtdIF0gKTtcblx0ICAgIFwic2V0XCI6IGZ1bmN0aW9uIHNldChhLCBiKSB7XG5cdCAgICAgIHZhciBpbm5lckVxLFxuXHQgICAgICAgICAgb3V0ZXJFcSA9IHRydWU7XG5cblx0ICAgICAgaWYgKGEuc2l6ZSAhPT0gYi5zaXplKSB7XG5cdCAgICAgICAgLy8gVGhpcyBvcHRpbWl6YXRpb24gaGFzIGNlcnRhaW4gcXVpcmtzIGJlY2F1c2Ugb2YgdGhlIGxhY2sgb2Zcblx0ICAgICAgICAvLyByZXBldGl0aW9uIGNvdW50aW5nLiBGb3IgaW5zdGFuY2UsIGFkZGluZyB0aGUgc2FtZVxuXHQgICAgICAgIC8vIChyZWZlcmVuY2UtaWRlbnRpY2FsKSBlbGVtZW50IHRvIHR3byBlcXVpdmFsZW50IHNldHMgY2FuXG5cdCAgICAgICAgLy8gbWFrZSB0aGVtIG5vbi1lcXVpdmFsZW50LlxuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGEuZm9yRWFjaChmdW5jdGlvbiAoYVZhbCkge1xuXHQgICAgICAgIC8vIFNob3J0LWNpcmN1aXQgaWYgdGhlIHJlc3VsdCBpcyBhbHJlYWR5IGtub3duLiAoVXNpbmcgZm9yLi4ub2Zcblx0ICAgICAgICAvLyB3aXRoIGEgYnJlYWsgY2xhdXNlIHdvdWxkIGJlIGNsZWFuZXIgaGVyZSwgYnV0IGl0IHdvdWxkIGNhdXNlXG5cdCAgICAgICAgLy8gYSBzeW50YXggZXJyb3Igb24gb2xkZXIgSmF2YXNjcmlwdCBpbXBsZW1lbnRhdGlvbnMgZXZlbiBpZlxuXHQgICAgICAgIC8vIFNldCBpcyB1bnVzZWQpXG5cdCAgICAgICAgaWYgKCFvdXRlckVxKSB7XG5cdCAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaW5uZXJFcSA9IGZhbHNlO1xuXHQgICAgICAgIGIuZm9yRWFjaChmdW5jdGlvbiAoYlZhbCkge1xuXHQgICAgICAgICAgdmFyIHBhcmVudFBhaXJzOyAvLyBMaWtld2lzZSwgc2hvcnQtY2lyY3VpdCBpZiB0aGUgcmVzdWx0IGlzIGFscmVhZHkga25vd25cblxuXHQgICAgICAgICAgaWYgKGlubmVyRXEpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfSAvLyBTd2FwIG91dCB0aGUgZ2xvYmFsIHBhaXJzIGxpc3QsIGFzIHRoZSBuZXN0ZWQgY2FsbCB0b1xuXHQgICAgICAgICAgLy8gaW5uZXJFcXVpdiB3aWxsIGNsb2JiZXIgaXRzIGNvbnRlbnRzXG5cblxuXHQgICAgICAgICAgcGFyZW50UGFpcnMgPSBwYWlycztcblxuXHQgICAgICAgICAgaWYgKGlubmVyRXF1aXYoYlZhbCwgYVZhbCkpIHtcblx0ICAgICAgICAgICAgaW5uZXJFcSA9IHRydWU7XG5cdCAgICAgICAgICB9IC8vIFJlcGxhY2UgdGhlIGdsb2JhbCBwYWlycyBsaXN0XG5cblxuXHQgICAgICAgICAgcGFpcnMgPSBwYXJlbnRQYWlycztcblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGlmICghaW5uZXJFcSkge1xuXHQgICAgICAgICAgb3V0ZXJFcSA9IGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBvdXRlckVxO1xuXHQgICAgfSxcblx0ICAgIC8vIERlZmluZSBtYXBzIGEgYW5kIGIgdG8gYmUgZXF1aXZhbGVudCBpZiBmb3IgZWFjaCBrZXktdmFsdWUgcGFpciAoYUtleSwgYVZhbClcblx0ICAgIC8vIGluIGEsIHRoZXJlIGlzIHNvbWUga2V5LXZhbHVlIHBhaXIgKGJLZXksIGJWYWwpIGluIGIgc3VjaCB0aGF0XG5cdCAgICAvLyBbIGFLZXksIGFWYWwgXSBhbmQgWyBiS2V5LCBiVmFsIF0gYXJlIGVxdWl2YWxlbnQuIEtleSByZXBldGl0aW9ucyBhcmUgbm90XG5cdCAgICAvLyBjb3VudGVkLCBzbyB0aGVzZSBhcmUgZXF1aXZhbGVudDpcblx0ICAgIC8vIGEgPSBuZXcgTWFwKCBbIFsge30sIDEgXSwgWyB7fSwgMSBdLCBbIFtdLCAxIF0gXSApO1xuXHQgICAgLy8gYiA9IG5ldyBNYXAoIFsgWyB7fSwgMSBdLCBbIFtdLCAxIF0sIFsgW10sIDEgXSBdICk7XG5cdCAgICBcIm1hcFwiOiBmdW5jdGlvbiBtYXAoYSwgYikge1xuXHQgICAgICB2YXIgaW5uZXJFcSxcblx0ICAgICAgICAgIG91dGVyRXEgPSB0cnVlO1xuXG5cdCAgICAgIGlmIChhLnNpemUgIT09IGIuc2l6ZSkge1xuXHQgICAgICAgIC8vIFRoaXMgb3B0aW1pemF0aW9uIGhhcyBjZXJ0YWluIHF1aXJrcyBiZWNhdXNlIG9mIHRoZSBsYWNrIG9mXG5cdCAgICAgICAgLy8gcmVwZXRpdGlvbiBjb3VudGluZy4gRm9yIGluc3RhbmNlLCBhZGRpbmcgdGhlIHNhbWVcblx0ICAgICAgICAvLyAocmVmZXJlbmNlLWlkZW50aWNhbCkga2V5LXZhbHVlIHBhaXIgdG8gdHdvIGVxdWl2YWxlbnQgbWFwc1xuXHQgICAgICAgIC8vIGNhbiBtYWtlIHRoZW0gbm9uLWVxdWl2YWxlbnQuXG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9XG5cblx0ICAgICAgYS5mb3JFYWNoKGZ1bmN0aW9uIChhVmFsLCBhS2V5KSB7XG5cdCAgICAgICAgLy8gU2hvcnQtY2lyY3VpdCBpZiB0aGUgcmVzdWx0IGlzIGFscmVhZHkga25vd24uIChVc2luZyBmb3IuLi5vZlxuXHQgICAgICAgIC8vIHdpdGggYSBicmVhayBjbGF1c2Ugd291bGQgYmUgY2xlYW5lciBoZXJlLCBidXQgaXQgd291bGQgY2F1c2Vcblx0ICAgICAgICAvLyBhIHN5bnRheCBlcnJvciBvbiBvbGRlciBKYXZhc2NyaXB0IGltcGxlbWVudGF0aW9ucyBldmVuIGlmXG5cdCAgICAgICAgLy8gTWFwIGlzIHVudXNlZClcblx0ICAgICAgICBpZiAoIW91dGVyRXEpIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpbm5lckVxID0gZmFsc2U7XG5cdCAgICAgICAgYi5mb3JFYWNoKGZ1bmN0aW9uIChiVmFsLCBiS2V5KSB7XG5cdCAgICAgICAgICB2YXIgcGFyZW50UGFpcnM7IC8vIExpa2V3aXNlLCBzaG9ydC1jaXJjdWl0IGlmIHRoZSByZXN1bHQgaXMgYWxyZWFkeSBrbm93blxuXG5cdCAgICAgICAgICBpZiAoaW5uZXJFcSkge1xuXHQgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICB9IC8vIFN3YXAgb3V0IHRoZSBnbG9iYWwgcGFpcnMgbGlzdCwgYXMgdGhlIG5lc3RlZCBjYWxsIHRvXG5cdCAgICAgICAgICAvLyBpbm5lckVxdWl2IHdpbGwgY2xvYmJlciBpdHMgY29udGVudHNcblxuXG5cdCAgICAgICAgICBwYXJlbnRQYWlycyA9IHBhaXJzO1xuXG5cdCAgICAgICAgICBpZiAoaW5uZXJFcXVpdihbYlZhbCwgYktleV0sIFthVmFsLCBhS2V5XSkpIHtcblx0ICAgICAgICAgICAgaW5uZXJFcSA9IHRydWU7XG5cdCAgICAgICAgICB9IC8vIFJlcGxhY2UgdGhlIGdsb2JhbCBwYWlycyBsaXN0XG5cblxuXHQgICAgICAgICAgcGFpcnMgPSBwYXJlbnRQYWlycztcblx0ICAgICAgICB9KTtcblxuXHQgICAgICAgIGlmICghaW5uZXJFcSkge1xuXHQgICAgICAgICAgb3V0ZXJFcSA9IGZhbHNlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBvdXRlckVxO1xuXHQgICAgfSxcblx0ICAgIFwib2JqZWN0XCI6IGZ1bmN0aW9uIG9iamVjdChhLCBiKSB7XG5cdCAgICAgIHZhciBpLFxuXHQgICAgICAgICAgYVByb3BlcnRpZXMgPSBbXSxcblx0ICAgICAgICAgIGJQcm9wZXJ0aWVzID0gW107XG5cblx0ICAgICAgaWYgKGNvbXBhcmVDb25zdHJ1Y3RvcnMoYSwgYikgPT09IGZhbHNlKSB7XG5cdCAgICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgICB9IC8vIEJlIHN0cmljdDogZG9uJ3QgZW5zdXJlIGhhc093blByb3BlcnR5IGFuZCBnbyBkZWVwXG5cblxuXHQgICAgICBmb3IgKGkgaW4gYSkge1xuXHQgICAgICAgIC8vIENvbGxlY3QgYSdzIHByb3BlcnRpZXNcblx0ICAgICAgICBhUHJvcGVydGllcy5wdXNoKGkpOyAvLyBTa2lwIE9PUCBtZXRob2RzIHRoYXQgbG9vayB0aGUgc2FtZVxuXG5cdCAgICAgICAgaWYgKGEuY29uc3RydWN0b3IgIT09IE9iamVjdCAmJiB0eXBlb2YgYS5jb25zdHJ1Y3RvciAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgYVtpXSA9PT0gXCJmdW5jdGlvblwiICYmIHR5cGVvZiBiW2ldID09PSBcImZ1bmN0aW9uXCIgJiYgYVtpXS50b1N0cmluZygpID09PSBiW2ldLnRvU3RyaW5nKCkpIHtcblx0ICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgIH0gLy8gQ29tcGFyZSBub24tY29udGFpbmVyczsgcXVldWUgbm9uLXJlZmVyZW5jZS1lcXVhbCBjb250YWluZXJzXG5cblxuXHQgICAgICAgIGlmICghYnJlYWR0aEZpcnN0Q29tcGFyZUNoaWxkKGFbaV0sIGJbaV0pKSB7XG5cdCAgICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgZm9yIChpIGluIGIpIHtcblx0ICAgICAgICAvLyBDb2xsZWN0IGIncyBwcm9wZXJ0aWVzXG5cdCAgICAgICAgYlByb3BlcnRpZXMucHVzaChpKTtcblx0ICAgICAgfSAvLyBFbnN1cmVzIGlkZW50aWNhbCBwcm9wZXJ0aWVzIG5hbWVcblxuXG5cdCAgICAgIHJldHVybiB0eXBlRXF1aXYoYVByb3BlcnRpZXMuc29ydCgpLCBiUHJvcGVydGllcy5zb3J0KCkpO1xuXHQgICAgfVxuXHQgIH07XG5cblx0ICBmdW5jdGlvbiB0eXBlRXF1aXYoYSwgYikge1xuXHQgICAgdmFyIHR5cGUgPSBvYmplY3RUeXBlKGEpOyAvLyBDYWxsYmFja3MgZm9yIGNvbnRhaW5lcnMgd2lsbCBhcHBlbmQgdG8gdGhlIHBhaXJzIHF1ZXVlIHRvIGFjaGlldmUgYnJlYWR0aC1maXJzdFxuXHQgICAgLy8gc2VhcmNoIG9yZGVyLiBUaGUgcGFpcnMgcXVldWUgaXMgYWxzbyB1c2VkIHRvIGF2b2lkIHJlcHJvY2Vzc2luZyBhbnkgcGFpciBvZlxuXHQgICAgLy8gY29udGFpbmVycyB0aGF0IGFyZSByZWZlcmVuY2UtZXF1YWwgdG8gYSBwcmV2aW91c2x5IHZpc2l0ZWQgcGFpciAoYSBzcGVjaWFsIGNhc2Vcblx0ICAgIC8vIHRoaXMgYmVpbmcgcmVjdXJzaW9uIGRldGVjdGlvbikuXG5cdCAgICAvL1xuXHQgICAgLy8gQmVjYXVzZSBvZiB0aGlzIGFwcHJvYWNoLCBvbmNlIHR5cGVFcXVpdiByZXR1cm5zIGEgZmFsc2UgdmFsdWUsIGl0IHNob3VsZCBub3QgYmVcblx0ICAgIC8vIGNhbGxlZCBhZ2FpbiB3aXRob3V0IGNsZWFyaW5nIHRoZSBwYWlyIHF1ZXVlIGVsc2UgaXQgbWF5IHdyb25nbHkgcmVwb3J0IGEgdmlzaXRlZFxuXHQgICAgLy8gcGFpciBhcyBiZWluZyBlcXVpdmFsZW50LlxuXG5cdCAgICByZXR1cm4gb2JqZWN0VHlwZShiKSA9PT0gdHlwZSAmJiBjYWxsYmFja3NbdHlwZV0oYSwgYik7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gaW5uZXJFcXVpdihhLCBiKSB7XG5cdCAgICB2YXIgaSwgcGFpcjsgLy8gV2UncmUgZG9uZSB3aGVuIHRoZXJlJ3Mgbm90aGluZyBtb3JlIHRvIGNvbXBhcmVcblxuXHQgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPCAyKSB7XG5cdCAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgfSAvLyBDbGVhciB0aGUgZ2xvYmFsIHBhaXIgcXVldWUgYW5kIGFkZCB0aGUgdG9wLWxldmVsIHZhbHVlcyBiZWluZyBjb21wYXJlZFxuXG5cblx0ICAgIHBhaXJzID0gW3tcblx0ICAgICAgYTogYSxcblx0ICAgICAgYjogYlxuXHQgICAgfV07XG5cblx0ICAgIGZvciAoaSA9IDA7IGkgPCBwYWlycy5sZW5ndGg7IGkrKykge1xuXHQgICAgICBwYWlyID0gcGFpcnNbaV07IC8vIFBlcmZvcm0gdHlwZS1zcGVjaWZpYyBjb21wYXJpc29uIG9uIGFueSBwYWlycyB0aGF0IGFyZSBub3Qgc3RyaWN0bHlcblx0ICAgICAgLy8gZXF1YWwuIEZvciBjb250YWluZXIgdHlwZXMsIHRoYXQgY29tcGFyaXNvbiB3aWxsIHBvc3Rwb25lIGNvbXBhcmlzb25cblx0ICAgICAgLy8gb2YgYW55IHN1Yi1jb250YWluZXIgcGFpciB0byB0aGUgZW5kIG9mIHRoZSBwYWlyIHF1ZXVlLiBUaGlzIGdpdmVzXG5cdCAgICAgIC8vIGJyZWFkdGgtZmlyc3Qgc2VhcmNoIG9yZGVyLiBJdCBhbHNvIGF2b2lkcyB0aGUgcmVwcm9jZXNzaW5nIG9mXG5cdCAgICAgIC8vIHJlZmVyZW5jZS1lcXVhbCBzaWJsaW5ncywgY291c2lucyBldGMsIHdoaWNoIGNhbiBoYXZlIGEgc2lnbmlmaWNhbnQgc3BlZWRcblx0ICAgICAgLy8gaW1wYWN0IHdoZW4gY29tcGFyaW5nIGEgY29udGFpbmVyIG9mIHNtYWxsIG9iamVjdHMgZWFjaCBvZiB3aGljaCBoYXMgYVxuXHQgICAgICAvLyByZWZlcmVuY2UgdG8gdGhlIHNhbWUgKHNpbmdsZXRvbikgbGFyZ2Ugb2JqZWN0LlxuXG5cdCAgICAgIGlmIChwYWlyLmEgIT09IHBhaXIuYiAmJiAhdHlwZUVxdWl2KHBhaXIuYSwgcGFpci5iKSkge1xuXHQgICAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgICAgfVxuXHQgICAgfSAvLyAuLi5hY3Jvc3MgYWxsIGNvbnNlY3V0aXZlIGFyZ3VtZW50IHBhaXJzXG5cblxuXHQgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPT09IDIgfHwgaW5uZXJFcXVpdi5hcHBseSh0aGlzLCBbXS5zbGljZS5jYWxsKGFyZ3VtZW50cywgMSkpO1xuXHQgIH1cblxuXHQgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICB2YXIgcmVzdWx0ID0gaW5uZXJFcXVpdi5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7IC8vIFJlbGVhc2UgYW55IHJldGFpbmVkIG9iamVjdHNcblxuXHQgICAgcGFpcnMubGVuZ3RoID0gMDtcblx0ICAgIHJldHVybiByZXN1bHQ7XG5cdCAgfTtcblx0fSkoKTtcblxuXHQvKipcblx0ICogQ29uZmlnIG9iamVjdDogTWFpbnRhaW4gaW50ZXJuYWwgc3RhdGVcblx0ICogTGF0ZXIgZXhwb3NlZCBhcyBRVW5pdC5jb25maWdcblx0ICogYGNvbmZpZ2AgaW5pdGlhbGl6ZWQgYXQgdG9wIG9mIHNjb3BlXG5cdCAqL1xuXG5cdHZhciBjb25maWcgPSB7XG5cdCAgLy8gVGhlIHF1ZXVlIG9mIHRlc3RzIHRvIHJ1blxuXHQgIHF1ZXVlOiBbXSxcblx0ICAvLyBCbG9jayB1bnRpbCBkb2N1bWVudCByZWFkeVxuXHQgIGJsb2NraW5nOiB0cnVlLFxuXHQgIC8vIEJ5IGRlZmF1bHQsIHJ1biBwcmV2aW91c2x5IGZhaWxlZCB0ZXN0cyBmaXJzdFxuXHQgIC8vIHZlcnkgdXNlZnVsIGluIGNvbWJpbmF0aW9uIHdpdGggXCJIaWRlIHBhc3NlZCB0ZXN0c1wiIGNoZWNrZWRcblx0ICByZW9yZGVyOiB0cnVlLFxuXHQgIC8vIEJ5IGRlZmF1bHQsIG1vZGlmeSBkb2N1bWVudC50aXRsZSB3aGVuIHN1aXRlIGlzIGRvbmVcblx0ICBhbHRlcnRpdGxlOiB0cnVlLFxuXHQgIC8vIEhUTUwgUmVwb3J0ZXI6IGNvbGxhcHNlIGV2ZXJ5IHRlc3QgZXhjZXB0IHRoZSBmaXJzdCBmYWlsaW5nIHRlc3Rcblx0ICAvLyBJZiBmYWxzZSwgYWxsIGZhaWxpbmcgdGVzdHMgd2lsbCBiZSBleHBhbmRlZFxuXHQgIGNvbGxhcHNlOiB0cnVlLFxuXHQgIC8vIEJ5IGRlZmF1bHQsIHNjcm9sbCB0byB0b3Agb2YgdGhlIHBhZ2Ugd2hlbiBzdWl0ZSBpcyBkb25lXG5cdCAgc2Nyb2xsdG9wOiB0cnVlLFxuXHQgIC8vIERlcHRoIHVwLXRvIHdoaWNoIG9iamVjdCB3aWxsIGJlIGR1bXBlZFxuXHQgIG1heERlcHRoOiA1LFxuXHQgIC8vIFdoZW4gZW5hYmxlZCwgYWxsIHRlc3RzIG11c3QgY2FsbCBleHBlY3QoKVxuXHQgIHJlcXVpcmVFeHBlY3RzOiBmYWxzZSxcblx0ICAvLyBQbGFjZWhvbGRlciBmb3IgdXNlci1jb25maWd1cmFibGUgZm9ybS1leHBvc2VkIFVSTCBwYXJhbWV0ZXJzXG5cdCAgdXJsQ29uZmlnOiBbXSxcblx0ICAvLyBTZXQgb2YgYWxsIG1vZHVsZXMuXG5cdCAgbW9kdWxlczogW10sXG5cdCAgLy8gVGhlIGZpcnN0IHVubmFtZWQgbW9kdWxlXG5cdCAgY3VycmVudE1vZHVsZToge1xuXHQgICAgbmFtZTogXCJcIixcblx0ICAgIHRlc3RzOiBbXSxcblx0ICAgIGNoaWxkTW9kdWxlczogW10sXG5cdCAgICB0ZXN0c1J1bjogMCxcblx0ICAgIHVuc2tpcHBlZFRlc3RzUnVuOiAwLFxuXHQgICAgaG9va3M6IHtcblx0ICAgICAgYmVmb3JlOiBbXSxcblx0ICAgICAgYmVmb3JlRWFjaDogW10sXG5cdCAgICAgIGFmdGVyRWFjaDogW10sXG5cdCAgICAgIGFmdGVyOiBbXVxuXHQgICAgfVxuXHQgIH0sXG5cdCAgY2FsbGJhY2tzOiB7fSxcblx0ICAvLyBUaGUgc3RvcmFnZSBtb2R1bGUgdG8gdXNlIGZvciByZW9yZGVyaW5nIHRlc3RzXG5cdCAgc3RvcmFnZTogbG9jYWxTZXNzaW9uU3RvcmFnZVxuXHR9OyAvLyB0YWtlIGEgcHJlZGVmaW5lZCBRVW5pdC5jb25maWcgYW5kIGV4dGVuZCB0aGUgZGVmYXVsdHNcblxuXHR2YXIgZ2xvYmFsQ29uZmlnID0gd2luZG93JDEgJiYgd2luZG93JDEuUVVuaXQgJiYgd2luZG93JDEuUVVuaXQuY29uZmlnOyAvLyBvbmx5IGV4dGVuZCB0aGUgZ2xvYmFsIGNvbmZpZyBpZiB0aGVyZSBpcyBubyBRVW5pdCBvdmVybG9hZFxuXG5cdGlmICh3aW5kb3ckMSAmJiB3aW5kb3ckMS5RVW5pdCAmJiAhd2luZG93JDEuUVVuaXQudmVyc2lvbikge1xuXHQgIGV4dGVuZChjb25maWcsIGdsb2JhbENvbmZpZyk7XG5cdH0gLy8gUHVzaCBhIGxvb3NlIHVubmFtZWQgbW9kdWxlIHRvIHRoZSBtb2R1bGVzIGNvbGxlY3Rpb25cblxuXG5cdGNvbmZpZy5tb2R1bGVzLnB1c2goY29uZmlnLmN1cnJlbnRNb2R1bGUpO1xuXG5cdC8vIGh0dHBzOi8vZmxlc2xlci5ibG9nc3BvdC5jb20vMjAwOC8wNS9qc2R1bXAtcHJldHR5LWR1bXAtb2YtYW55LWphdmFzY3JpcHQuaHRtbFxuXG5cdHZhciBkdW1wID0gKGZ1bmN0aW9uICgpIHtcblx0ICBmdW5jdGlvbiBxdW90ZShzdHIpIHtcblx0ICAgIHJldHVybiBcIlxcXCJcIiArIHN0ci50b1N0cmluZygpLnJlcGxhY2UoL1xcXFwvZywgXCJcXFxcXFxcXFwiKS5yZXBsYWNlKC9cIi9nLCBcIlxcXFxcXFwiXCIpICsgXCJcXFwiXCI7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gbGl0ZXJhbChvKSB7XG5cdCAgICByZXR1cm4gbyArIFwiXCI7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gam9pbihwcmUsIGFyciwgcG9zdCkge1xuXHQgICAgdmFyIHMgPSBkdW1wLnNlcGFyYXRvcigpLFxuXHQgICAgICAgIGJhc2UgPSBkdW1wLmluZGVudCgpLFxuXHQgICAgICAgIGlubmVyID0gZHVtcC5pbmRlbnQoMSk7XG5cblx0ICAgIGlmIChhcnIuam9pbikge1xuXHQgICAgICBhcnIgPSBhcnIuam9pbihcIixcIiArIHMgKyBpbm5lcik7XG5cdCAgICB9XG5cblx0ICAgIGlmICghYXJyKSB7XG5cdCAgICAgIHJldHVybiBwcmUgKyBwb3N0O1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gW3ByZSwgaW5uZXIgKyBhcnIsIGJhc2UgKyBwb3N0XS5qb2luKHMpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFycmF5KGFyciwgc3RhY2spIHtcblx0ICAgIHZhciBpID0gYXJyLmxlbmd0aCxcblx0ICAgICAgICByZXQgPSBuZXcgQXJyYXkoaSk7XG5cblx0ICAgIGlmIChkdW1wLm1heERlcHRoICYmIGR1bXAuZGVwdGggPiBkdW1wLm1heERlcHRoKSB7XG5cdCAgICAgIHJldHVybiBcIltvYmplY3QgQXJyYXldXCI7XG5cdCAgICB9XG5cblx0ICAgIHRoaXMudXAoKTtcblxuXHQgICAgd2hpbGUgKGktLSkge1xuXHQgICAgICByZXRbaV0gPSB0aGlzLnBhcnNlKGFycltpXSwgdW5kZWZpbmVkLCBzdGFjayk7XG5cdCAgICB9XG5cblx0ICAgIHRoaXMuZG93bigpO1xuXHQgICAgcmV0dXJuIGpvaW4oXCJbXCIsIHJldCwgXCJdXCIpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGlzQXJyYXkob2JqKSB7XG5cdCAgICByZXR1cm4gKC8vTmF0aXZlIEFycmF5c1xuXHQgICAgICB0b1N0cmluZy5jYWxsKG9iaikgPT09IFwiW29iamVjdCBBcnJheV1cIiB8fCAvLyBOb2RlTGlzdCBvYmplY3RzXG5cdCAgICAgIHR5cGVvZiBvYmoubGVuZ3RoID09PSBcIm51bWJlclwiICYmIG9iai5pdGVtICE9PSB1bmRlZmluZWQgJiYgKG9iai5sZW5ndGggPyBvYmouaXRlbSgwKSA9PT0gb2JqWzBdIDogb2JqLml0ZW0oMCkgPT09IG51bGwgJiYgb2JqWzBdID09PSB1bmRlZmluZWQpXG5cdCAgICApO1xuXHQgIH1cblxuXHQgIHZhciByZU5hbWUgPSAvXmZ1bmN0aW9uIChcXHcrKS8sXG5cdCAgICAgIGR1bXAgPSB7XG5cdCAgICAvLyBUaGUgb2JqVHlwZSBpcyB1c2VkIG1vc3RseSBpbnRlcm5hbGx5LCB5b3UgY2FuIGZpeCBhIChjdXN0b20pIHR5cGUgaW4gYWR2YW5jZVxuXHQgICAgcGFyc2U6IGZ1bmN0aW9uIHBhcnNlKG9iaiwgb2JqVHlwZSwgc3RhY2spIHtcblx0ICAgICAgc3RhY2sgPSBzdGFjayB8fCBbXTtcblx0ICAgICAgdmFyIHJlcyxcblx0ICAgICAgICAgIHBhcnNlcixcblx0ICAgICAgICAgIHBhcnNlclR5cGUsXG5cdCAgICAgICAgICBvYmpJbmRleCA9IHN0YWNrLmluZGV4T2Yob2JqKTtcblxuXHQgICAgICBpZiAob2JqSW5kZXggIT09IC0xKSB7XG5cdCAgICAgICAgcmV0dXJuIFwicmVjdXJzaW9uKFwiLmNvbmNhdChvYmpJbmRleCAtIHN0YWNrLmxlbmd0aCwgXCIpXCIpO1xuXHQgICAgICB9XG5cblx0ICAgICAgb2JqVHlwZSA9IG9ialR5cGUgfHwgdGhpcy50eXBlT2Yob2JqKTtcblx0ICAgICAgcGFyc2VyID0gdGhpcy5wYXJzZXJzW29ialR5cGVdO1xuXHQgICAgICBwYXJzZXJUeXBlID0gX3R5cGVvZihwYXJzZXIpO1xuXG5cdCAgICAgIGlmIChwYXJzZXJUeXBlID09PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgICAgICBzdGFjay5wdXNoKG9iaik7XG5cdCAgICAgICAgcmVzID0gcGFyc2VyLmNhbGwodGhpcywgb2JqLCBzdGFjayk7XG5cdCAgICAgICAgc3RhY2sucG9wKCk7XG5cdCAgICAgICAgcmV0dXJuIHJlcztcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBwYXJzZXJUeXBlID09PSBcInN0cmluZ1wiID8gcGFyc2VyIDogdGhpcy5wYXJzZXJzLmVycm9yO1xuXHQgICAgfSxcblx0ICAgIHR5cGVPZjogZnVuY3Rpb24gdHlwZU9mKG9iaikge1xuXHQgICAgICB2YXIgdHlwZTtcblxuXHQgICAgICBpZiAob2JqID09PSBudWxsKSB7XG5cdCAgICAgICAgdHlwZSA9IFwibnVsbFwiO1xuXHQgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBvYmogPT09IFwidW5kZWZpbmVkXCIpIHtcblx0ICAgICAgICB0eXBlID0gXCJ1bmRlZmluZWRcIjtcblx0ICAgICAgfSBlbHNlIGlmIChpcyhcInJlZ2V4cFwiLCBvYmopKSB7XG5cdCAgICAgICAgdHlwZSA9IFwicmVnZXhwXCI7XG5cdCAgICAgIH0gZWxzZSBpZiAoaXMoXCJkYXRlXCIsIG9iaikpIHtcblx0ICAgICAgICB0eXBlID0gXCJkYXRlXCI7XG5cdCAgICAgIH0gZWxzZSBpZiAoaXMoXCJmdW5jdGlvblwiLCBvYmopKSB7XG5cdCAgICAgICAgdHlwZSA9IFwiZnVuY3Rpb25cIjtcblx0ICAgICAgfSBlbHNlIGlmIChvYmouc2V0SW50ZXJ2YWwgIT09IHVuZGVmaW5lZCAmJiBvYmouZG9jdW1lbnQgIT09IHVuZGVmaW5lZCAmJiBvYmoubm9kZVR5cGUgPT09IHVuZGVmaW5lZCkge1xuXHQgICAgICAgIHR5cGUgPSBcIndpbmRvd1wiO1xuXHQgICAgICB9IGVsc2UgaWYgKG9iai5ub2RlVHlwZSA9PT0gOSkge1xuXHQgICAgICAgIHR5cGUgPSBcImRvY3VtZW50XCI7XG5cdCAgICAgIH0gZWxzZSBpZiAob2JqLm5vZGVUeXBlKSB7XG5cdCAgICAgICAgdHlwZSA9IFwibm9kZVwiO1xuXHQgICAgICB9IGVsc2UgaWYgKGlzQXJyYXkob2JqKSkge1xuXHQgICAgICAgIHR5cGUgPSBcImFycmF5XCI7XG5cdCAgICAgIH0gZWxzZSBpZiAob2JqLmNvbnN0cnVjdG9yID09PSBFcnJvci5wcm90b3R5cGUuY29uc3RydWN0b3IpIHtcblx0ICAgICAgICB0eXBlID0gXCJlcnJvclwiO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHR5cGUgPSBfdHlwZW9mKG9iaik7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gdHlwZTtcblx0ICAgIH0sXG5cdCAgICBzZXBhcmF0b3I6IGZ1bmN0aW9uIHNlcGFyYXRvcigpIHtcblx0ICAgICAgaWYgKHRoaXMubXVsdGlsaW5lKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMuSFRNTCA/IFwiPGJyIC8+XCIgOiBcIlxcblwiO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIHJldHVybiB0aGlzLkhUTUwgPyBcIiYjMTYwO1wiIDogXCIgXCI7XG5cdCAgICAgIH1cblx0ICAgIH0sXG5cdCAgICAvLyBFeHRyYSBjYW4gYmUgYSBudW1iZXIsIHNob3J0Y3V0IGZvciBpbmNyZWFzaW5nLWNhbGxpbmctZGVjcmVhc2luZ1xuXHQgICAgaW5kZW50OiBmdW5jdGlvbiBpbmRlbnQoZXh0cmEpIHtcblx0ICAgICAgaWYgKCF0aGlzLm11bHRpbGluZSkge1xuXHQgICAgICAgIHJldHVybiBcIlwiO1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIGNociA9IHRoaXMuaW5kZW50Q2hhcjtcblxuXHQgICAgICBpZiAodGhpcy5IVE1MKSB7XG5cdCAgICAgICAgY2hyID0gY2hyLnJlcGxhY2UoL1xcdC9nLCBcIiAgIFwiKS5yZXBsYWNlKC8gL2csIFwiJiMxNjA7XCIpO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIG5ldyBBcnJheSh0aGlzLmRlcHRoICsgKGV4dHJhIHx8IDApKS5qb2luKGNocik7XG5cdCAgICB9LFxuXHQgICAgdXA6IGZ1bmN0aW9uIHVwKGEpIHtcblx0ICAgICAgdGhpcy5kZXB0aCArPSBhIHx8IDE7XG5cdCAgICB9LFxuXHQgICAgZG93bjogZnVuY3Rpb24gZG93bihhKSB7XG5cdCAgICAgIHRoaXMuZGVwdGggLT0gYSB8fCAxO1xuXHQgICAgfSxcblx0ICAgIHNldFBhcnNlcjogZnVuY3Rpb24gc2V0UGFyc2VyKG5hbWUsIHBhcnNlcikge1xuXHQgICAgICB0aGlzLnBhcnNlcnNbbmFtZV0gPSBwYXJzZXI7XG5cdCAgICB9LFxuXHQgICAgLy8gVGhlIG5leHQgMyBhcmUgZXhwb3NlZCBzbyB5b3UgY2FuIHVzZSB0aGVtXG5cdCAgICBxdW90ZTogcXVvdGUsXG5cdCAgICBsaXRlcmFsOiBsaXRlcmFsLFxuXHQgICAgam9pbjogam9pbixcblx0ICAgIGRlcHRoOiAxLFxuXHQgICAgbWF4RGVwdGg6IGNvbmZpZy5tYXhEZXB0aCxcblx0ICAgIC8vIFRoaXMgaXMgdGhlIGxpc3Qgb2YgcGFyc2VycywgdG8gbW9kaWZ5IHRoZW0sIHVzZSBkdW1wLnNldFBhcnNlclxuXHQgICAgcGFyc2Vyczoge1xuXHQgICAgICB3aW5kb3c6IFwiW1dpbmRvd11cIixcblx0ICAgICAgZG9jdW1lbnQ6IFwiW0RvY3VtZW50XVwiLFxuXHQgICAgICBlcnJvcjogZnVuY3Rpb24gZXJyb3IoX2Vycm9yKSB7XG5cdCAgICAgICAgcmV0dXJuIFwiRXJyb3IoXFxcIlwiICsgX2Vycm9yLm1lc3NhZ2UgKyBcIlxcXCIpXCI7XG5cdCAgICAgIH0sXG5cdCAgICAgIHVua25vd246IFwiW1Vua25vd25dXCIsXG5cdCAgICAgIFwibnVsbFwiOiBcIm51bGxcIixcblx0ICAgICAgXCJ1bmRlZmluZWRcIjogXCJ1bmRlZmluZWRcIixcblx0ICAgICAgXCJmdW5jdGlvblwiOiBmdW5jdGlvbiBfZnVuY3Rpb24oZm4pIHtcblx0ICAgICAgICB2YXIgcmV0ID0gXCJmdW5jdGlvblwiLFxuXHQgICAgICAgICAgICAvLyBGdW5jdGlvbnMgbmV2ZXIgaGF2ZSBuYW1lIGluIElFXG5cdCAgICAgICAgbmFtZSA9IFwibmFtZVwiIGluIGZuID8gZm4ubmFtZSA6IChyZU5hbWUuZXhlYyhmbikgfHwgW10pWzFdO1xuXG5cdCAgICAgICAgaWYgKG5hbWUpIHtcblx0ICAgICAgICAgIHJldCArPSBcIiBcIiArIG5hbWU7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0ICs9IFwiKFwiO1xuXHQgICAgICAgIHJldCA9IFtyZXQsIGR1bXAucGFyc2UoZm4sIFwiZnVuY3Rpb25BcmdzXCIpLCBcIil7XCJdLmpvaW4oXCJcIik7XG5cdCAgICAgICAgcmV0dXJuIGpvaW4ocmV0LCBkdW1wLnBhcnNlKGZuLCBcImZ1bmN0aW9uQ29kZVwiKSwgXCJ9XCIpO1xuXHQgICAgICB9LFxuXHQgICAgICBhcnJheTogYXJyYXksXG5cdCAgICAgIG5vZGVsaXN0OiBhcnJheSxcblx0ICAgICAgXCJhcmd1bWVudHNcIjogYXJyYXksXG5cdCAgICAgIG9iamVjdDogZnVuY3Rpb24gb2JqZWN0KG1hcCwgc3RhY2spIHtcblx0ICAgICAgICB2YXIga2V5cyxcblx0ICAgICAgICAgICAga2V5LFxuXHQgICAgICAgICAgICB2YWwsXG5cdCAgICAgICAgICAgIGksXG5cdCAgICAgICAgICAgIG5vbkVudW1lcmFibGVQcm9wZXJ0aWVzLFxuXHQgICAgICAgICAgICByZXQgPSBbXTtcblxuXHQgICAgICAgIGlmIChkdW1wLm1heERlcHRoICYmIGR1bXAuZGVwdGggPiBkdW1wLm1heERlcHRoKSB7XG5cdCAgICAgICAgICByZXR1cm4gXCJbb2JqZWN0IE9iamVjdF1cIjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBkdW1wLnVwKCk7XG5cdCAgICAgICAga2V5cyA9IFtdO1xuXG5cdCAgICAgICAgZm9yIChrZXkgaW4gbWFwKSB7XG5cdCAgICAgICAgICBrZXlzLnB1c2goa2V5KTtcblx0ICAgICAgICB9IC8vIFNvbWUgcHJvcGVydGllcyBhcmUgbm90IGFsd2F5cyBlbnVtZXJhYmxlIG9uIEVycm9yIG9iamVjdHMuXG5cblxuXHQgICAgICAgIG5vbkVudW1lcmFibGVQcm9wZXJ0aWVzID0gW1wibWVzc2FnZVwiLCBcIm5hbWVcIl07XG5cblx0ICAgICAgICBmb3IgKGkgaW4gbm9uRW51bWVyYWJsZVByb3BlcnRpZXMpIHtcblx0ICAgICAgICAgIGtleSA9IG5vbkVudW1lcmFibGVQcm9wZXJ0aWVzW2ldO1xuXG5cdCAgICAgICAgICBpZiAoa2V5IGluIG1hcCAmJiAhaW5BcnJheShrZXksIGtleXMpKSB7XG5cdCAgICAgICAgICAgIGtleXMucHVzaChrZXkpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGtleXMuc29ydCgpO1xuXG5cdCAgICAgICAgZm9yIChpID0gMDsgaSA8IGtleXMubGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgIGtleSA9IGtleXNbaV07XG5cdCAgICAgICAgICB2YWwgPSBtYXBba2V5XTtcblx0ICAgICAgICAgIHJldC5wdXNoKGR1bXAucGFyc2Uoa2V5LCBcImtleVwiKSArIFwiOiBcIiArIGR1bXAucGFyc2UodmFsLCB1bmRlZmluZWQsIHN0YWNrKSk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgZHVtcC5kb3duKCk7XG5cdCAgICAgICAgcmV0dXJuIGpvaW4oXCJ7XCIsIHJldCwgXCJ9XCIpO1xuXHQgICAgICB9LFxuXHQgICAgICBub2RlOiBmdW5jdGlvbiBub2RlKF9ub2RlKSB7XG5cdCAgICAgICAgdmFyIGxlbixcblx0ICAgICAgICAgICAgaSxcblx0ICAgICAgICAgICAgdmFsLFxuXHQgICAgICAgICAgICBvcGVuID0gZHVtcC5IVE1MID8gXCImbHQ7XCIgOiBcIjxcIixcblx0ICAgICAgICAgICAgY2xvc2UgPSBkdW1wLkhUTUwgPyBcIiZndDtcIiA6IFwiPlwiLFxuXHQgICAgICAgICAgICB0YWcgPSBfbm9kZS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpLFxuXHQgICAgICAgICAgICByZXQgPSBvcGVuICsgdGFnLFxuXHQgICAgICAgICAgICBhdHRycyA9IF9ub2RlLmF0dHJpYnV0ZXM7XG5cblx0ICAgICAgICBpZiAoYXR0cnMpIHtcblx0ICAgICAgICAgIGZvciAoaSA9IDAsIGxlbiA9IGF0dHJzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG5cdCAgICAgICAgICAgIHZhbCA9IGF0dHJzW2ldLm5vZGVWYWx1ZTsgLy8gSUU2IGluY2x1ZGVzIGFsbCBhdHRyaWJ1dGVzIGluIC5hdHRyaWJ1dGVzLCBldmVuIG9uZXMgbm90IGV4cGxpY2l0bHlcblx0ICAgICAgICAgICAgLy8gc2V0LiBUaG9zZSBoYXZlIHZhbHVlcyBsaWtlIHVuZGVmaW5lZCwgbnVsbCwgMCwgZmFsc2UsIFwiXCIgb3Jcblx0ICAgICAgICAgICAgLy8gXCJpbmhlcml0XCIuXG5cblx0ICAgICAgICAgICAgaWYgKHZhbCAmJiB2YWwgIT09IFwiaW5oZXJpdFwiKSB7XG5cdCAgICAgICAgICAgICAgcmV0ICs9IFwiIFwiICsgYXR0cnNbaV0ubm9kZU5hbWUgKyBcIj1cIiArIGR1bXAucGFyc2UodmFsLCBcImF0dHJpYnV0ZVwiKTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldCArPSBjbG9zZTsgLy8gU2hvdyBjb250ZW50IG9mIFRleHROb2RlIG9yIENEQVRBU2VjdGlvblxuXG5cdCAgICAgICAgaWYgKF9ub2RlLm5vZGVUeXBlID09PSAzIHx8IF9ub2RlLm5vZGVUeXBlID09PSA0KSB7XG5cdCAgICAgICAgICByZXQgKz0gX25vZGUubm9kZVZhbHVlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHJldHVybiByZXQgKyBvcGVuICsgXCIvXCIgKyB0YWcgKyBjbG9zZTtcblx0ICAgICAgfSxcblx0ICAgICAgLy8gRnVuY3Rpb24gY2FsbHMgaXQgaW50ZXJuYWxseSwgaXQncyB0aGUgYXJndW1lbnRzIHBhcnQgb2YgdGhlIGZ1bmN0aW9uXG5cdCAgICAgIGZ1bmN0aW9uQXJnczogZnVuY3Rpb24gZnVuY3Rpb25BcmdzKGZuKSB7XG5cdCAgICAgICAgdmFyIGFyZ3MsXG5cdCAgICAgICAgICAgIGwgPSBmbi5sZW5ndGg7XG5cblx0ICAgICAgICBpZiAoIWwpIHtcblx0ICAgICAgICAgIHJldHVybiBcIlwiO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGFyZ3MgPSBuZXcgQXJyYXkobCk7XG5cblx0ICAgICAgICB3aGlsZSAobC0tKSB7XG5cdCAgICAgICAgICAvLyA5NyBpcyAnYSdcblx0ICAgICAgICAgIGFyZ3NbbF0gPSBTdHJpbmcuZnJvbUNoYXJDb2RlKDk3ICsgbCk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0dXJuIFwiIFwiICsgYXJncy5qb2luKFwiLCBcIikgKyBcIiBcIjtcblx0ICAgICAgfSxcblx0ICAgICAgLy8gT2JqZWN0IGNhbGxzIGl0IGludGVybmFsbHksIHRoZSBrZXkgcGFydCBvZiBhbiBpdGVtIGluIGEgbWFwXG5cdCAgICAgIGtleTogcXVvdGUsXG5cdCAgICAgIC8vIEZ1bmN0aW9uIGNhbGxzIGl0IGludGVybmFsbHksIGl0J3MgdGhlIGNvbnRlbnQgb2YgdGhlIGZ1bmN0aW9uXG5cdCAgICAgIGZ1bmN0aW9uQ29kZTogXCJbY29kZV1cIixcblx0ICAgICAgLy8gTm9kZSBjYWxscyBpdCBpbnRlcm5hbGx5LCBpdCdzIGEgaHRtbCBhdHRyaWJ1dGUgdmFsdWVcblx0ICAgICAgYXR0cmlidXRlOiBxdW90ZSxcblx0ICAgICAgc3RyaW5nOiBxdW90ZSxcblx0ICAgICAgZGF0ZTogcXVvdGUsXG5cdCAgICAgIHJlZ2V4cDogbGl0ZXJhbCxcblx0ICAgICAgbnVtYmVyOiBsaXRlcmFsLFxuXHQgICAgICBcImJvb2xlYW5cIjogbGl0ZXJhbCxcblx0ICAgICAgc3ltYm9sOiBmdW5jdGlvbiBzeW1ib2woc3ltKSB7XG5cdCAgICAgICAgcmV0dXJuIHN5bS50b1N0cmluZygpO1xuXHQgICAgICB9XG5cdCAgICB9LFxuXHQgICAgLy8gSWYgdHJ1ZSwgZW50aXRpZXMgYXJlIGVzY2FwZWQgKCA8LCA+LCBcXHQsIHNwYWNlIGFuZCBcXG4gKVxuXHQgICAgSFRNTDogZmFsc2UsXG5cdCAgICAvLyBJbmRlbnRhdGlvbiB1bml0XG5cdCAgICBpbmRlbnRDaGFyOiBcIiAgXCIsXG5cdCAgICAvLyBJZiB0cnVlLCBpdGVtcyBpbiBhIGNvbGxlY3Rpb24sIGFyZSBzZXBhcmF0ZWQgYnkgYSBcXG4sIGVsc2UganVzdCBhIHNwYWNlLlxuXHQgICAgbXVsdGlsaW5lOiB0cnVlXG5cdCAgfTtcblx0ICByZXR1cm4gZHVtcDtcblx0fSkoKTtcblxuXHR2YXIgU3VpdGVSZXBvcnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuXHQgIGZ1bmN0aW9uIFN1aXRlUmVwb3J0KG5hbWUsIHBhcmVudFN1aXRlKSB7XG5cdCAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgU3VpdGVSZXBvcnQpO1xuXG5cdCAgICB0aGlzLm5hbWUgPSBuYW1lO1xuXHQgICAgdGhpcy5mdWxsTmFtZSA9IHBhcmVudFN1aXRlID8gcGFyZW50U3VpdGUuZnVsbE5hbWUuY29uY2F0KG5hbWUpIDogW107XG5cdCAgICB0aGlzLnRlc3RzID0gW107XG5cdCAgICB0aGlzLmNoaWxkU3VpdGVzID0gW107XG5cblx0ICAgIGlmIChwYXJlbnRTdWl0ZSkge1xuXHQgICAgICBwYXJlbnRTdWl0ZS5wdXNoQ2hpbGRTdWl0ZSh0aGlzKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBfY3JlYXRlQ2xhc3MoU3VpdGVSZXBvcnQsIFt7XG5cdCAgICBrZXk6IFwic3RhcnRcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBzdGFydChyZWNvcmRUaW1lKSB7XG5cdCAgICAgIGlmIChyZWNvcmRUaW1lKSB7XG5cdCAgICAgICAgdGhpcy5fc3RhcnRUaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcblxuXHQgICAgICAgIGlmIChwZXJmb3JtYW5jZSkge1xuXHQgICAgICAgICAgdmFyIHN1aXRlTGV2ZWwgPSB0aGlzLmZ1bGxOYW1lLmxlbmd0aDtcblx0ICAgICAgICAgIHBlcmZvcm1hbmNlLm1hcmsoXCJxdW5pdF9zdWl0ZV9cIi5jb25jYXQoc3VpdGVMZXZlbCwgXCJfc3RhcnRcIikpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuXHQgICAgICAgIGZ1bGxOYW1lOiB0aGlzLmZ1bGxOYW1lLnNsaWNlKCksXG5cdCAgICAgICAgdGVzdHM6IHRoaXMudGVzdHMubWFwKGZ1bmN0aW9uICh0ZXN0KSB7XG5cdCAgICAgICAgICByZXR1cm4gdGVzdC5zdGFydCgpO1xuXHQgICAgICAgIH0pLFxuXHQgICAgICAgIGNoaWxkU3VpdGVzOiB0aGlzLmNoaWxkU3VpdGVzLm1hcChmdW5jdGlvbiAoc3VpdGUpIHtcblx0ICAgICAgICAgIHJldHVybiBzdWl0ZS5zdGFydCgpO1xuXHQgICAgICAgIH0pLFxuXHQgICAgICAgIHRlc3RDb3VudHM6IHtcblx0ICAgICAgICAgIHRvdGFsOiB0aGlzLmdldFRlc3RDb3VudHMoKS50b3RhbFxuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZW5kXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZW5kKHJlY29yZFRpbWUpIHtcblx0ICAgICAgaWYgKHJlY29yZFRpbWUpIHtcblx0ICAgICAgICB0aGlzLl9lbmRUaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcblxuXHQgICAgICAgIGlmIChwZXJmb3JtYW5jZSkge1xuXHQgICAgICAgICAgdmFyIHN1aXRlTGV2ZWwgPSB0aGlzLmZ1bGxOYW1lLmxlbmd0aDtcblx0ICAgICAgICAgIHBlcmZvcm1hbmNlLm1hcmsoXCJxdW5pdF9zdWl0ZV9cIi5jb25jYXQoc3VpdGVMZXZlbCwgXCJfZW5kXCIpKTtcblx0ICAgICAgICAgIHZhciBzdWl0ZU5hbWUgPSB0aGlzLmZ1bGxOYW1lLmpvaW4oXCIg4oCTIFwiKTtcblx0ICAgICAgICAgIG1lYXN1cmUoc3VpdGVMZXZlbCA9PT0gMCA/IFwiUVVuaXQgVGVzdCBSdW5cIiA6IFwiUVVuaXQgVGVzdCBTdWl0ZTogXCIuY29uY2F0KHN1aXRlTmFtZSksIFwicXVuaXRfc3VpdGVfXCIuY29uY2F0KHN1aXRlTGV2ZWwsIFwiX3N0YXJ0XCIpLCBcInF1bml0X3N1aXRlX1wiLmNvbmNhdChzdWl0ZUxldmVsLCBcIl9lbmRcIikpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiB7XG5cdCAgICAgICAgbmFtZTogdGhpcy5uYW1lLFxuXHQgICAgICAgIGZ1bGxOYW1lOiB0aGlzLmZ1bGxOYW1lLnNsaWNlKCksXG5cdCAgICAgICAgdGVzdHM6IHRoaXMudGVzdHMubWFwKGZ1bmN0aW9uICh0ZXN0KSB7XG5cdCAgICAgICAgICByZXR1cm4gdGVzdC5lbmQoKTtcblx0ICAgICAgICB9KSxcblx0ICAgICAgICBjaGlsZFN1aXRlczogdGhpcy5jaGlsZFN1aXRlcy5tYXAoZnVuY3Rpb24gKHN1aXRlKSB7XG5cdCAgICAgICAgICByZXR1cm4gc3VpdGUuZW5kKCk7XG5cdCAgICAgICAgfSksXG5cdCAgICAgICAgdGVzdENvdW50czogdGhpcy5nZXRUZXN0Q291bnRzKCksXG5cdCAgICAgICAgcnVudGltZTogdGhpcy5nZXRSdW50aW1lKCksXG5cdCAgICAgICAgc3RhdHVzOiB0aGlzLmdldFN0YXR1cygpXG5cdCAgICAgIH07XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInB1c2hDaGlsZFN1aXRlXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcHVzaENoaWxkU3VpdGUoc3VpdGUpIHtcblx0ICAgICAgdGhpcy5jaGlsZFN1aXRlcy5wdXNoKHN1aXRlKTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicHVzaFRlc3RcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBwdXNoVGVzdCh0ZXN0KSB7XG5cdCAgICAgIHRoaXMudGVzdHMucHVzaCh0ZXN0KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0UnVudGltZVwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldFJ1bnRpbWUoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLl9lbmRUaW1lIC0gdGhpcy5fc3RhcnRUaW1lO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJnZXRUZXN0Q291bnRzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0VGVzdENvdW50cygpIHtcblx0ICAgICAgdmFyIGNvdW50cyA9IGFyZ3VtZW50cy5sZW5ndGggPiAwICYmIGFyZ3VtZW50c1swXSAhPT0gdW5kZWZpbmVkID8gYXJndW1lbnRzWzBdIDoge1xuXHQgICAgICAgIHBhc3NlZDogMCxcblx0ICAgICAgICBmYWlsZWQ6IDAsXG5cdCAgICAgICAgc2tpcHBlZDogMCxcblx0ICAgICAgICB0b2RvOiAwLFxuXHQgICAgICAgIHRvdGFsOiAwXG5cdCAgICAgIH07XG5cdCAgICAgIGNvdW50cyA9IHRoaXMudGVzdHMucmVkdWNlKGZ1bmN0aW9uIChjb3VudHMsIHRlc3QpIHtcblx0ICAgICAgICBpZiAodGVzdC52YWxpZCkge1xuXHQgICAgICAgICAgY291bnRzW3Rlc3QuZ2V0U3RhdHVzKCldKys7XG5cdCAgICAgICAgICBjb3VudHMudG90YWwrKztcblx0ICAgICAgICB9XG5cblx0ICAgICAgICByZXR1cm4gY291bnRzO1xuXHQgICAgICB9LCBjb3VudHMpO1xuXHQgICAgICByZXR1cm4gdGhpcy5jaGlsZFN1aXRlcy5yZWR1Y2UoZnVuY3Rpb24gKGNvdW50cywgc3VpdGUpIHtcblx0ICAgICAgICByZXR1cm4gc3VpdGUuZ2V0VGVzdENvdW50cyhjb3VudHMpO1xuXHQgICAgICB9LCBjb3VudHMpO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJnZXRTdGF0dXNcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRTdGF0dXMoKSB7XG5cdCAgICAgIHZhciBfdGhpcyRnZXRUZXN0Q291bnRzID0gdGhpcy5nZXRUZXN0Q291bnRzKCksXG5cdCAgICAgICAgICB0b3RhbCA9IF90aGlzJGdldFRlc3RDb3VudHMudG90YWwsXG5cdCAgICAgICAgICBmYWlsZWQgPSBfdGhpcyRnZXRUZXN0Q291bnRzLmZhaWxlZCxcblx0ICAgICAgICAgIHNraXBwZWQgPSBfdGhpcyRnZXRUZXN0Q291bnRzLnNraXBwZWQsXG5cdCAgICAgICAgICB0b2RvID0gX3RoaXMkZ2V0VGVzdENvdW50cy50b2RvO1xuXG5cdCAgICAgIGlmIChmYWlsZWQpIHtcblx0ICAgICAgICByZXR1cm4gXCJmYWlsZWRcIjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBpZiAoc2tpcHBlZCA9PT0gdG90YWwpIHtcblx0ICAgICAgICAgIHJldHVybiBcInNraXBwZWRcIjtcblx0ICAgICAgICB9IGVsc2UgaWYgKHRvZG8gPT09IHRvdGFsKSB7XG5cdCAgICAgICAgICByZXR1cm4gXCJ0b2RvXCI7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHJldHVybiBcInBhc3NlZFwiO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH1dKTtcblxuXHQgIHJldHVybiBTdWl0ZVJlcG9ydDtcblx0fSgpO1xuXG5cdHZhciBmb2N1c2VkID0gZmFsc2U7XG5cdHZhciBtb2R1bGVTdGFjayA9IFtdO1xuXG5cdGZ1bmN0aW9uIGlzUGFyZW50TW9kdWxlSW5RdWV1ZSgpIHtcblx0ICB2YXIgbW9kdWxlc0luUXVldWUgPSBjb25maWcubW9kdWxlcy5tYXAoZnVuY3Rpb24gKG1vZHVsZSkge1xuXHQgICAgcmV0dXJuIG1vZHVsZS5tb2R1bGVJZDtcblx0ICB9KTtcblx0ICByZXR1cm4gbW9kdWxlU3RhY2suc29tZShmdW5jdGlvbiAobW9kdWxlKSB7XG5cdCAgICByZXR1cm4gbW9kdWxlc0luUXVldWUuaW5jbHVkZXMobW9kdWxlLm1vZHVsZUlkKTtcblx0ICB9KTtcblx0fVxuXG5cdGZ1bmN0aW9uIGNyZWF0ZU1vZHVsZShuYW1lLCB0ZXN0RW52aXJvbm1lbnQsIG1vZGlmaWVycykge1xuXHQgIHZhciBwYXJlbnRNb2R1bGUgPSBtb2R1bGVTdGFjay5sZW5ndGggPyBtb2R1bGVTdGFjay5zbGljZSgtMSlbMF0gOiBudWxsO1xuXHQgIHZhciBtb2R1bGVOYW1lID0gcGFyZW50TW9kdWxlICE9PSBudWxsID8gW3BhcmVudE1vZHVsZS5uYW1lLCBuYW1lXS5qb2luKFwiID4gXCIpIDogbmFtZTtcblx0ICB2YXIgcGFyZW50U3VpdGUgPSBwYXJlbnRNb2R1bGUgPyBwYXJlbnRNb2R1bGUuc3VpdGVSZXBvcnQgOiBnbG9iYWxTdWl0ZTtcblx0ICB2YXIgc2tpcCA9IHBhcmVudE1vZHVsZSAhPT0gbnVsbCAmJiBwYXJlbnRNb2R1bGUuc2tpcCB8fCBtb2RpZmllcnMuc2tpcDtcblx0ICB2YXIgdG9kbyA9IHBhcmVudE1vZHVsZSAhPT0gbnVsbCAmJiBwYXJlbnRNb2R1bGUudG9kbyB8fCBtb2RpZmllcnMudG9kbztcblx0ICB2YXIgbW9kdWxlID0ge1xuXHQgICAgbmFtZTogbW9kdWxlTmFtZSxcblx0ICAgIHBhcmVudE1vZHVsZTogcGFyZW50TW9kdWxlLFxuXHQgICAgdGVzdHM6IFtdLFxuXHQgICAgbW9kdWxlSWQ6IGdlbmVyYXRlSGFzaChtb2R1bGVOYW1lKSxcblx0ICAgIHRlc3RzUnVuOiAwLFxuXHQgICAgdW5za2lwcGVkVGVzdHNSdW46IDAsXG5cdCAgICBjaGlsZE1vZHVsZXM6IFtdLFxuXHQgICAgc3VpdGVSZXBvcnQ6IG5ldyBTdWl0ZVJlcG9ydChuYW1lLCBwYXJlbnRTdWl0ZSksXG5cdCAgICAvLyBQYXNzIGFsb25nIGBza2lwYCBhbmQgYHRvZG9gIHByb3BlcnRpZXMgZnJvbSBwYXJlbnQgbW9kdWxlLCBpbiBjYXNlXG5cdCAgICAvLyB0aGVyZSBpcyBvbmUsIHRvIGNoaWxkcy4gQW5kIHVzZSBvd24gb3RoZXJ3aXNlLlxuXHQgICAgLy8gVGhpcyBwcm9wZXJ0eSB3aWxsIGJlIHVzZWQgdG8gbWFyayBvd24gdGVzdHMgYW5kIHRlc3RzIG9mIGNoaWxkIHN1aXRlc1xuXHQgICAgLy8gYXMgZWl0aGVyIGBza2lwcGVkYCBvciBgdG9kb2AuXG5cdCAgICBza2lwOiBza2lwLFxuXHQgICAgdG9kbzogc2tpcCA/IGZhbHNlIDogdG9kb1xuXHQgIH07XG5cdCAgdmFyIGVudiA9IHt9O1xuXG5cdCAgaWYgKHBhcmVudE1vZHVsZSkge1xuXHQgICAgcGFyZW50TW9kdWxlLmNoaWxkTW9kdWxlcy5wdXNoKG1vZHVsZSk7XG5cdCAgICBleHRlbmQoZW52LCBwYXJlbnRNb2R1bGUudGVzdEVudmlyb25tZW50KTtcblx0ICB9XG5cblx0ICBleHRlbmQoZW52LCB0ZXN0RW52aXJvbm1lbnQpO1xuXHQgIG1vZHVsZS50ZXN0RW52aXJvbm1lbnQgPSBlbnY7XG5cdCAgY29uZmlnLm1vZHVsZXMucHVzaChtb2R1bGUpO1xuXHQgIHJldHVybiBtb2R1bGU7XG5cdH1cblxuXHRmdW5jdGlvbiBwcm9jZXNzTW9kdWxlKG5hbWUsIG9wdGlvbnMsIGV4ZWN1dGVOb3cpIHtcblx0ICB2YXIgbW9kaWZpZXJzID0gYXJndW1lbnRzLmxlbmd0aCA+IDMgJiYgYXJndW1lbnRzWzNdICE9PSB1bmRlZmluZWQgPyBhcmd1bWVudHNbM10gOiB7fTtcblxuXHQgIGlmIChvYmplY3RUeXBlKG9wdGlvbnMpID09PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgIGV4ZWN1dGVOb3cgPSBvcHRpb25zO1xuXHQgICAgb3B0aW9ucyA9IHVuZGVmaW5lZDtcblx0ICB9XG5cblx0ICB2YXIgbW9kdWxlID0gY3JlYXRlTW9kdWxlKG5hbWUsIG9wdGlvbnMsIG1vZGlmaWVycyk7IC8vIE1vdmUgYW55IGhvb2tzIHRvIGEgJ2hvb2tzJyBvYmplY3RcblxuXHQgIHZhciB0ZXN0RW52aXJvbm1lbnQgPSBtb2R1bGUudGVzdEVudmlyb25tZW50O1xuXHQgIHZhciBob29rcyA9IG1vZHVsZS5ob29rcyA9IHt9O1xuXHQgIHNldEhvb2tGcm9tRW52aXJvbm1lbnQoaG9va3MsIHRlc3RFbnZpcm9ubWVudCwgXCJiZWZvcmVcIik7XG5cdCAgc2V0SG9va0Zyb21FbnZpcm9ubWVudChob29rcywgdGVzdEVudmlyb25tZW50LCBcImJlZm9yZUVhY2hcIik7XG5cdCAgc2V0SG9va0Zyb21FbnZpcm9ubWVudChob29rcywgdGVzdEVudmlyb25tZW50LCBcImFmdGVyRWFjaFwiKTtcblx0ICBzZXRIb29rRnJvbUVudmlyb25tZW50KGhvb2tzLCB0ZXN0RW52aXJvbm1lbnQsIFwiYWZ0ZXJcIik7XG5cdCAgdmFyIG1vZHVsZUZucyA9IHtcblx0ICAgIGJlZm9yZTogc2V0SG9va0Z1bmN0aW9uKG1vZHVsZSwgXCJiZWZvcmVcIiksXG5cdCAgICBiZWZvcmVFYWNoOiBzZXRIb29rRnVuY3Rpb24obW9kdWxlLCBcImJlZm9yZUVhY2hcIiksXG5cdCAgICBhZnRlckVhY2g6IHNldEhvb2tGdW5jdGlvbihtb2R1bGUsIFwiYWZ0ZXJFYWNoXCIpLFxuXHQgICAgYWZ0ZXI6IHNldEhvb2tGdW5jdGlvbihtb2R1bGUsIFwiYWZ0ZXJcIilcblx0ICB9O1xuXHQgIHZhciBjdXJyZW50TW9kdWxlID0gY29uZmlnLmN1cnJlbnRNb2R1bGU7XG5cblx0ICBpZiAob2JqZWN0VHlwZShleGVjdXRlTm93KSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICBtb2R1bGVTdGFjay5wdXNoKG1vZHVsZSk7XG5cdCAgICBjb25maWcuY3VycmVudE1vZHVsZSA9IG1vZHVsZTtcblx0ICAgIGV4ZWN1dGVOb3cuY2FsbChtb2R1bGUudGVzdEVudmlyb25tZW50LCBtb2R1bGVGbnMpO1xuXHQgICAgbW9kdWxlU3RhY2sucG9wKCk7XG5cdCAgICBtb2R1bGUgPSBtb2R1bGUucGFyZW50TW9kdWxlIHx8IGN1cnJlbnRNb2R1bGU7XG5cdCAgfVxuXG5cdCAgY29uZmlnLmN1cnJlbnRNb2R1bGUgPSBtb2R1bGU7XG5cblx0ICBmdW5jdGlvbiBzZXRIb29rRnJvbUVudmlyb25tZW50KGhvb2tzLCBlbnZpcm9ubWVudCwgbmFtZSkge1xuXHQgICAgdmFyIHBvdGVudGlhbEhvb2sgPSBlbnZpcm9ubWVudFtuYW1lXTtcblx0ICAgIGhvb2tzW25hbWVdID0gdHlwZW9mIHBvdGVudGlhbEhvb2sgPT09IFwiZnVuY3Rpb25cIiA/IFtwb3RlbnRpYWxIb29rXSA6IFtdO1xuXHQgICAgZGVsZXRlIGVudmlyb25tZW50W25hbWVdO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHNldEhvb2tGdW5jdGlvbihtb2R1bGUsIGhvb2tOYW1lKSB7XG5cdCAgICByZXR1cm4gZnVuY3Rpb24gc2V0SG9vayhjYWxsYmFjaykge1xuXHQgICAgICBtb2R1bGUuaG9va3NbaG9va05hbWVdLnB1c2goY2FsbGJhY2spO1xuXHQgICAgfTtcblx0ICB9XG5cdH1cblxuXHRmdW5jdGlvbiBtb2R1bGUkMShuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93KSB7XG5cdCAgaWYgKGZvY3VzZWQgJiYgIWlzUGFyZW50TW9kdWxlSW5RdWV1ZSgpKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgcHJvY2Vzc01vZHVsZShuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93KTtcblx0fVxuXG5cdG1vZHVsZSQxLm9ubHkgPSBmdW5jdGlvbiAoKSB7XG5cdCAgaWYgKCFmb2N1c2VkKSB7XG5cdCAgICBjb25maWcubW9kdWxlcy5sZW5ndGggPSAwO1xuXHQgICAgY29uZmlnLnF1ZXVlLmxlbmd0aCA9IDA7XG5cdCAgfVxuXG5cdCAgcHJvY2Vzc01vZHVsZS5hcHBseSh2b2lkIDAsIGFyZ3VtZW50cyk7XG5cdCAgZm9jdXNlZCA9IHRydWU7XG5cdH07XG5cblx0bW9kdWxlJDEuc2tpcCA9IGZ1bmN0aW9uIChuYW1lLCBvcHRpb25zLCBleGVjdXRlTm93KSB7XG5cdCAgaWYgKGZvY3VzZWQpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICBwcm9jZXNzTW9kdWxlKG5hbWUsIG9wdGlvbnMsIGV4ZWN1dGVOb3csIHtcblx0ICAgIHNraXA6IHRydWVcblx0ICB9KTtcblx0fTtcblxuXHRtb2R1bGUkMS50b2RvID0gZnVuY3Rpb24gKG5hbWUsIG9wdGlvbnMsIGV4ZWN1dGVOb3cpIHtcblx0ICBpZiAoZm9jdXNlZCkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHByb2Nlc3NNb2R1bGUobmFtZSwgb3B0aW9ucywgZXhlY3V0ZU5vdywge1xuXHQgICAgdG9kbzogdHJ1ZVxuXHQgIH0pO1xuXHR9O1xuXG5cdHZhciBMSVNURU5FUlMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuXHR2YXIgU1VQUE9SVEVEX0VWRU5UUyA9IFtcInJ1blN0YXJ0XCIsIFwic3VpdGVTdGFydFwiLCBcInRlc3RTdGFydFwiLCBcImFzc2VydGlvblwiLCBcInRlc3RFbmRcIiwgXCJzdWl0ZUVuZFwiLCBcInJ1bkVuZFwiXTtcblx0LyoqXG5cdCAqIEVtaXRzIGFuIGV2ZW50IHdpdGggdGhlIHNwZWNpZmllZCBkYXRhIHRvIGFsbCBjdXJyZW50bHkgcmVnaXN0ZXJlZCBsaXN0ZW5lcnMuXG5cdCAqIENhbGxiYWNrcyB3aWxsIGZpcmUgaW4gdGhlIG9yZGVyIGluIHdoaWNoIHRoZXkgYXJlIHJlZ2lzdGVyZWQgKEZJRk8pLiBUaGlzXG5cdCAqIGZ1bmN0aW9uIGlzIG5vdCBleHBvc2VkIHB1YmxpY2x5OyBpdCBpcyB1c2VkIGJ5IFFVbml0IGludGVybmFscyB0byBlbWl0XG5cdCAqIGxvZ2dpbmcgZXZlbnRzLlxuXHQgKlxuXHQgKiBAcHJpdmF0ZVxuXHQgKiBAbWV0aG9kIGVtaXRcblx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZVxuXHQgKiBAcGFyYW0ge09iamVjdH0gZGF0YVxuXHQgKiBAcmV0dXJuIHtWb2lkfVxuXHQgKi9cblxuXHRmdW5jdGlvbiBlbWl0KGV2ZW50TmFtZSwgZGF0YSkge1xuXHQgIGlmIChvYmplY3RUeXBlKGV2ZW50TmFtZSkgIT09IFwic3RyaW5nXCIpIHtcblx0ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJldmVudE5hbWUgbXVzdCBiZSBhIHN0cmluZyB3aGVuIGVtaXR0aW5nIGFuIGV2ZW50XCIpO1xuXHQgIH0gLy8gQ2xvbmUgdGhlIGNhbGxiYWNrcyBpbiBjYXNlIG9uZSBvZiB0aGVtIHJlZ2lzdGVycyBhIG5ldyBjYWxsYmFja1xuXG5cblx0ICB2YXIgb3JpZ2luYWxDYWxsYmFja3MgPSBMSVNURU5FUlNbZXZlbnROYW1lXTtcblx0ICB2YXIgY2FsbGJhY2tzID0gb3JpZ2luYWxDYWxsYmFja3MgPyBfdG9Db25zdW1hYmxlQXJyYXkob3JpZ2luYWxDYWxsYmFja3MpIDogW107XG5cblx0ICBmb3IgKHZhciBpID0gMDsgaSA8IGNhbGxiYWNrcy5sZW5ndGg7IGkrKykge1xuXHQgICAgY2FsbGJhY2tzW2ldKGRhdGEpO1xuXHQgIH1cblx0fVxuXHQvKipcblx0ICogUmVnaXN0ZXJzIGEgY2FsbGJhY2sgYXMgYSBsaXN0ZW5lciB0byB0aGUgc3BlY2lmaWVkIGV2ZW50LlxuXHQgKlxuXHQgKiBAcHVibGljXG5cdCAqIEBtZXRob2Qgb25cblx0ICogQHBhcmFtIHtTdHJpbmd9IGV2ZW50TmFtZVxuXHQgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFja1xuXHQgKiBAcmV0dXJuIHtWb2lkfVxuXHQgKi9cblxuXHRmdW5jdGlvbiBvbihldmVudE5hbWUsIGNhbGxiYWNrKSB7XG5cdCAgaWYgKG9iamVjdFR5cGUoZXZlbnROYW1lKSAhPT0gXCJzdHJpbmdcIikge1xuXHQgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcImV2ZW50TmFtZSBtdXN0IGJlIGEgc3RyaW5nIHdoZW4gcmVnaXN0ZXJpbmcgYSBsaXN0ZW5lclwiKTtcblx0ICB9IGVsc2UgaWYgKCFpbkFycmF5KGV2ZW50TmFtZSwgU1VQUE9SVEVEX0VWRU5UUykpIHtcblx0ICAgIHZhciBldmVudHMgPSBTVVBQT1JURURfRVZFTlRTLmpvaW4oXCIsIFwiKTtcblx0ICAgIHRocm93IG5ldyBFcnJvcihcIlxcXCJcIi5jb25jYXQoZXZlbnROYW1lLCBcIlxcXCIgaXMgbm90IGEgdmFsaWQgZXZlbnQ7IG11c3QgYmUgb25lIG9mOiBcIikuY29uY2F0KGV2ZW50cywgXCIuXCIpKTtcblx0ICB9IGVsc2UgaWYgKG9iamVjdFR5cGUoY2FsbGJhY2spICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJjYWxsYmFjayBtdXN0IGJlIGEgZnVuY3Rpb24gd2hlbiByZWdpc3RlcmluZyBhIGxpc3RlbmVyXCIpO1xuXHQgIH1cblxuXHQgIGlmICghTElTVEVORVJTW2V2ZW50TmFtZV0pIHtcblx0ICAgIExJU1RFTkVSU1tldmVudE5hbWVdID0gW107XG5cdCAgfSAvLyBEb24ndCByZWdpc3RlciB0aGUgc2FtZSBjYWxsYmFjayBtb3JlIHRoYW4gb25jZVxuXG5cblx0ICBpZiAoIWluQXJyYXkoY2FsbGJhY2ssIExJU1RFTkVSU1tldmVudE5hbWVdKSkge1xuXHQgICAgTElTVEVORVJTW2V2ZW50TmFtZV0ucHVzaChjYWxsYmFjayk7XG5cdCAgfVxuXHR9XG5cblx0dmFyIGNvbW1vbmpzR2xvYmFsID0gdHlwZW9mIGdsb2JhbFRoaXMgIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsVGhpcyA6IHR5cGVvZiB3aW5kb3cgIT09ICd1bmRlZmluZWQnID8gd2luZG93IDogdHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgPyBnbG9iYWwgOiB0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcgPyBzZWxmIDoge307XG5cblx0ZnVuY3Rpb24gY3JlYXRlQ29tbW9uanNNb2R1bGUoZm4sIGJhc2VkaXIsIG1vZHVsZSkge1xuXHRcdHJldHVybiBtb2R1bGUgPSB7XG5cdFx0ICBwYXRoOiBiYXNlZGlyLFxuXHRcdCAgZXhwb3J0czoge30sXG5cdFx0ICByZXF1aXJlOiBmdW5jdGlvbiAocGF0aCwgYmFzZSkge1xuXHQgICAgICByZXR1cm4gY29tbW9uanNSZXF1aXJlKHBhdGgsIChiYXNlID09PSB1bmRlZmluZWQgfHwgYmFzZSA9PT0gbnVsbCkgPyBtb2R1bGUucGF0aCA6IGJhc2UpO1xuXHQgICAgfVxuXHRcdH0sIGZuKG1vZHVsZSwgbW9kdWxlLmV4cG9ydHMpLCBtb2R1bGUuZXhwb3J0cztcblx0fVxuXG5cdGZ1bmN0aW9uIGNvbW1vbmpzUmVxdWlyZSAoKSB7XG5cdFx0dGhyb3cgbmV3IEVycm9yKCdEeW5hbWljIHJlcXVpcmVzIGFyZSBub3QgY3VycmVudGx5IHN1cHBvcnRlZCBieSBAcm9sbHVwL3BsdWdpbi1jb21tb25qcycpO1xuXHR9XG5cblx0dmFyIGVzNlByb21pc2UgPSBjcmVhdGVDb21tb25qc01vZHVsZShmdW5jdGlvbiAobW9kdWxlLCBleHBvcnRzKSB7XG5cdCAgLyohXG5cdCAgICogQG92ZXJ2aWV3IGVzNi1wcm9taXNlIC0gYSB0aW55IGltcGxlbWVudGF0aW9uIG9mIFByb21pc2VzL0ErLlxuXHQgICAqIEBjb3B5cmlnaHQgQ29weXJpZ2h0IChjKSAyMDE0IFllaHVkYSBLYXR6LCBUb20gRGFsZSwgU3RlZmFuIFBlbm5lciBhbmQgY29udHJpYnV0b3JzIChDb252ZXJzaW9uIHRvIEVTNiBBUEkgYnkgSmFrZSBBcmNoaWJhbGQpXG5cdCAgICogQGxpY2Vuc2UgICBMaWNlbnNlZCB1bmRlciBNSVQgbGljZW5zZVxuXHQgICAqICAgICAgICAgICAgU2VlIGh0dHBzOi8vcmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbS9zdGVmYW5wZW5uZXIvZXM2LXByb21pc2UvbWFzdGVyL0xJQ0VOU0Vcblx0ICAgKiBAdmVyc2lvbiAgIHY0LjIuOCsxZTY4ZGNlNlxuXHQgICAqL1xuXHQgIChmdW5jdGlvbiAoZ2xvYmFsLCBmYWN0b3J5KSB7XG5cdCAgICAgbW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCkgO1xuXHQgIH0pKGNvbW1vbmpzR2xvYmFsLCBmdW5jdGlvbiAoKSB7XG5cblx0ICAgIGZ1bmN0aW9uIG9iamVjdE9yRnVuY3Rpb24oeCkge1xuXHQgICAgICB2YXIgdHlwZSA9IHR5cGVvZiB4O1xuXHQgICAgICByZXR1cm4geCAhPT0gbnVsbCAmJiAodHlwZSA9PT0gJ29iamVjdCcgfHwgdHlwZSA9PT0gJ2Z1bmN0aW9uJyk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGlzRnVuY3Rpb24oeCkge1xuXHQgICAgICByZXR1cm4gdHlwZW9mIHggPT09ICdmdW5jdGlvbic7XG5cdCAgICB9XG5cblx0ICAgIHZhciBfaXNBcnJheSA9IHZvaWQgMDtcblxuXHQgICAgaWYgKEFycmF5LmlzQXJyYXkpIHtcblx0ICAgICAgX2lzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgX2lzQXJyYXkgPSBmdW5jdGlvbiAoeCkge1xuXHQgICAgICAgIHJldHVybiBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nLmNhbGwoeCkgPT09ICdbb2JqZWN0IEFycmF5XSc7XG5cdCAgICAgIH07XG5cdCAgICB9XG5cblx0ICAgIHZhciBpc0FycmF5ID0gX2lzQXJyYXk7XG5cdCAgICB2YXIgbGVuID0gMDtcblx0ICAgIHZhciB2ZXJ0eE5leHQgPSB2b2lkIDA7XG5cdCAgICB2YXIgY3VzdG9tU2NoZWR1bGVyRm4gPSB2b2lkIDA7XG5cblx0ICAgIHZhciBhc2FwID0gZnVuY3Rpb24gYXNhcChjYWxsYmFjaywgYXJnKSB7XG5cdCAgICAgIHF1ZXVlW2xlbl0gPSBjYWxsYmFjaztcblx0ICAgICAgcXVldWVbbGVuICsgMV0gPSBhcmc7XG5cdCAgICAgIGxlbiArPSAyO1xuXG5cdCAgICAgIGlmIChsZW4gPT09IDIpIHtcblx0ICAgICAgICAvLyBJZiBsZW4gaXMgMiwgdGhhdCBtZWFucyB0aGF0IHdlIG5lZWQgdG8gc2NoZWR1bGUgYW4gYXN5bmMgZmx1c2guXG5cdCAgICAgICAgLy8gSWYgYWRkaXRpb25hbCBjYWxsYmFja3MgYXJlIHF1ZXVlZCBiZWZvcmUgdGhlIHF1ZXVlIGlzIGZsdXNoZWQsIHRoZXlcblx0ICAgICAgICAvLyB3aWxsIGJlIHByb2Nlc3NlZCBieSB0aGlzIGZsdXNoIHRoYXQgd2UgYXJlIHNjaGVkdWxpbmcuXG5cdCAgICAgICAgaWYgKGN1c3RvbVNjaGVkdWxlckZuKSB7XG5cdCAgICAgICAgICBjdXN0b21TY2hlZHVsZXJGbihmbHVzaCk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHNjaGVkdWxlRmx1c2goKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH07XG5cblx0ICAgIGZ1bmN0aW9uIHNldFNjaGVkdWxlcihzY2hlZHVsZUZuKSB7XG5cdCAgICAgIGN1c3RvbVNjaGVkdWxlckZuID0gc2NoZWR1bGVGbjtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gc2V0QXNhcChhc2FwRm4pIHtcblx0ICAgICAgYXNhcCA9IGFzYXBGbjtcblx0ICAgIH1cblxuXHQgICAgdmFyIGJyb3dzZXJXaW5kb3cgPSB0eXBlb2Ygd2luZG93ICE9PSAndW5kZWZpbmVkJyA/IHdpbmRvdyA6IHVuZGVmaW5lZDtcblx0ICAgIHZhciBicm93c2VyR2xvYmFsID0gYnJvd3NlcldpbmRvdyB8fCB7fTtcblx0ICAgIHZhciBCcm93c2VyTXV0YXRpb25PYnNlcnZlciA9IGJyb3dzZXJHbG9iYWwuTXV0YXRpb25PYnNlcnZlciB8fCBicm93c2VyR2xvYmFsLldlYktpdE11dGF0aW9uT2JzZXJ2ZXI7XG5cdCAgICB2YXIgaXNOb2RlID0gdHlwZW9mIHNlbGYgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBwcm9jZXNzICE9PSAndW5kZWZpbmVkJyAmJiB7fS50b1N0cmluZy5jYWxsKHByb2Nlc3MpID09PSAnW29iamVjdCBwcm9jZXNzXSc7IC8vIHRlc3QgZm9yIHdlYiB3b3JrZXIgYnV0IG5vdCBpbiBJRTEwXG5cblx0ICAgIHZhciBpc1dvcmtlciA9IHR5cGVvZiBVaW50OENsYW1wZWRBcnJheSAhPT0gJ3VuZGVmaW5lZCcgJiYgdHlwZW9mIGltcG9ydFNjcmlwdHMgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBNZXNzYWdlQ2hhbm5lbCAhPT0gJ3VuZGVmaW5lZCc7IC8vIG5vZGVcblxuXHQgICAgZnVuY3Rpb24gdXNlTmV4dFRpY2soKSB7XG5cdCAgICAgIC8vIG5vZGUgdmVyc2lvbiAwLjEwLnggZGlzcGxheXMgYSBkZXByZWNhdGlvbiB3YXJuaW5nIHdoZW4gbmV4dFRpY2sgaXMgdXNlZCByZWN1cnNpdmVseVxuXHQgICAgICAvLyBzZWUgaHR0cHM6Ly9naXRodWIuY29tL2N1am9qcy93aGVuL2lzc3Vlcy80MTAgZm9yIGRldGFpbHNcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gcHJvY2Vzcy5uZXh0VGljayhmbHVzaCk7XG5cdCAgICAgIH07XG5cdCAgICB9IC8vIHZlcnR4XG5cblxuXHQgICAgZnVuY3Rpb24gdXNlVmVydHhUaW1lcigpIHtcblx0ICAgICAgaWYgKHR5cGVvZiB2ZXJ0eE5leHQgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHZlcnR4TmV4dChmbHVzaCk7XG5cdCAgICAgICAgfTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiB1c2VTZXRUaW1lb3V0KCk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHVzZU11dGF0aW9uT2JzZXJ2ZXIoKSB7XG5cdCAgICAgIHZhciBpdGVyYXRpb25zID0gMDtcblx0ICAgICAgdmFyIG9ic2VydmVyID0gbmV3IEJyb3dzZXJNdXRhdGlvbk9ic2VydmVyKGZsdXNoKTtcblx0ICAgICAgdmFyIG5vZGUgPSBkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSgnJyk7XG5cdCAgICAgIG9ic2VydmVyLm9ic2VydmUobm9kZSwge1xuXHQgICAgICAgIGNoYXJhY3RlckRhdGE6IHRydWVcblx0ICAgICAgfSk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgbm9kZS5kYXRhID0gaXRlcmF0aW9ucyA9ICsraXRlcmF0aW9ucyAlIDI7XG5cdCAgICAgIH07XG5cdCAgICB9IC8vIHdlYiB3b3JrZXJcblxuXG5cdCAgICBmdW5jdGlvbiB1c2VNZXNzYWdlQ2hhbm5lbCgpIHtcblx0ICAgICAgdmFyIGNoYW5uZWwgPSBuZXcgTWVzc2FnZUNoYW5uZWwoKTtcblx0ICAgICAgY2hhbm5lbC5wb3J0MS5vbm1lc3NhZ2UgPSBmbHVzaDtcblx0ICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICByZXR1cm4gY2hhbm5lbC5wb3J0Mi5wb3N0TWVzc2FnZSgwKTtcblx0ICAgICAgfTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gdXNlU2V0VGltZW91dCgpIHtcblx0ICAgICAgLy8gU3RvcmUgc2V0VGltZW91dCByZWZlcmVuY2Ugc28gZXM2LXByb21pc2Ugd2lsbCBiZSB1bmFmZmVjdGVkIGJ5XG5cdCAgICAgIC8vIG90aGVyIGNvZGUgbW9kaWZ5aW5nIHNldFRpbWVvdXQgKGxpa2Ugc2lub24udXNlRmFrZVRpbWVycygpKVxuXHQgICAgICB2YXIgZ2xvYmFsU2V0VGltZW91dCA9IHNldFRpbWVvdXQ7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIGdsb2JhbFNldFRpbWVvdXQoZmx1c2gsIDEpO1xuXHQgICAgICB9O1xuXHQgICAgfVxuXG5cdCAgICB2YXIgcXVldWUgPSBuZXcgQXJyYXkoMTAwMCk7XG5cblx0ICAgIGZ1bmN0aW9uIGZsdXNoKCkge1xuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSArPSAyKSB7XG5cdCAgICAgICAgdmFyIGNhbGxiYWNrID0gcXVldWVbaV07XG5cdCAgICAgICAgdmFyIGFyZyA9IHF1ZXVlW2kgKyAxXTtcblx0ICAgICAgICBjYWxsYmFjayhhcmcpO1xuXHQgICAgICAgIHF1ZXVlW2ldID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIHF1ZXVlW2kgKyAxXSA9IHVuZGVmaW5lZDtcblx0ICAgICAgfVxuXG5cdCAgICAgIGxlbiA9IDA7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGF0dGVtcHRWZXJ0eCgpIHtcblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICB2YXIgdmVydHggPSBGdW5jdGlvbigncmV0dXJuIHRoaXMnKSgpLnJlcXVpcmUoJ3ZlcnR4Jyk7XG5cblx0ICAgICAgICB2ZXJ0eE5leHQgPSB2ZXJ0eC5ydW5Pbkxvb3AgfHwgdmVydHgucnVuT25Db250ZXh0O1xuXHQgICAgICAgIHJldHVybiB1c2VWZXJ0eFRpbWVyKCk7XG5cdCAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICByZXR1cm4gdXNlU2V0VGltZW91dCgpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHZhciBzY2hlZHVsZUZsdXNoID0gdm9pZCAwOyAvLyBEZWNpZGUgd2hhdCBhc3luYyBtZXRob2QgdG8gdXNlIHRvIHRyaWdnZXJpbmcgcHJvY2Vzc2luZyBvZiBxdWV1ZWQgY2FsbGJhY2tzOlxuXG5cdCAgICBpZiAoaXNOb2RlKSB7XG5cdCAgICAgIHNjaGVkdWxlRmx1c2ggPSB1c2VOZXh0VGljaygpO1xuXHQgICAgfSBlbHNlIGlmIChCcm93c2VyTXV0YXRpb25PYnNlcnZlcikge1xuXHQgICAgICBzY2hlZHVsZUZsdXNoID0gdXNlTXV0YXRpb25PYnNlcnZlcigpO1xuXHQgICAgfSBlbHNlIGlmIChpc1dvcmtlcikge1xuXHQgICAgICBzY2hlZHVsZUZsdXNoID0gdXNlTWVzc2FnZUNoYW5uZWwoKTtcblx0ICAgIH0gZWxzZSBpZiAoYnJvd3NlcldpbmRvdyA9PT0gdW5kZWZpbmVkICYmIHR5cGVvZiBjb21tb25qc1JlcXVpcmUgPT09ICdmdW5jdGlvbicpIHtcblx0ICAgICAgc2NoZWR1bGVGbHVzaCA9IGF0dGVtcHRWZXJ0eCgpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc2NoZWR1bGVGbHVzaCA9IHVzZVNldFRpbWVvdXQoKTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gdGhlbihvbkZ1bGZpbGxtZW50LCBvblJlamVjdGlvbikge1xuXHQgICAgICB2YXIgcGFyZW50ID0gdGhpcztcblx0ICAgICAgdmFyIGNoaWxkID0gbmV3IHRoaXMuY29uc3RydWN0b3Iobm9vcCk7XG5cblx0ICAgICAgaWYgKGNoaWxkW1BST01JU0VfSURdID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICBtYWtlUHJvbWlzZShjaGlsZCk7XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgX3N0YXRlID0gcGFyZW50Ll9zdGF0ZTtcblxuXHQgICAgICBpZiAoX3N0YXRlKSB7XG5cdCAgICAgICAgdmFyIGNhbGxiYWNrID0gYXJndW1lbnRzW19zdGF0ZSAtIDFdO1xuXHQgICAgICAgIGFzYXAoZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgcmV0dXJuIGludm9rZUNhbGxiYWNrKF9zdGF0ZSwgY2hpbGQsIGNhbGxiYWNrLCBwYXJlbnQuX3Jlc3VsdCk7XG5cdCAgICAgICAgfSk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3Vic2NyaWJlKHBhcmVudCwgY2hpbGQsIG9uRnVsZmlsbG1lbnQsIG9uUmVqZWN0aW9uKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBjaGlsZDtcblx0ICAgIH1cblx0ICAgIC8qKlxuXHQgICAgICBgUHJvbWlzZS5yZXNvbHZlYCByZXR1cm5zIGEgcHJvbWlzZSB0aGF0IHdpbGwgYmVjb21lIHJlc29sdmVkIHdpdGggdGhlXG5cdCAgICAgIHBhc3NlZCBgdmFsdWVgLiBJdCBpcyBzaG9ydGhhbmQgZm9yIHRoZSBmb2xsb3dpbmc6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgcmVzb2x2ZSgxKTtcblx0ICAgICAgfSk7XG5cdCAgICBcblx0ICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcblx0ICAgICAgICAvLyB2YWx1ZSA9PT0gMVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgSW5zdGVhZCBvZiB3cml0aW5nIHRoZSBhYm92ZSwgeW91ciBjb2RlIG5vdyBzaW1wbHkgYmVjb21lcyB0aGUgZm9sbG93aW5nOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHByb21pc2UgPSBQcm9taXNlLnJlc29sdmUoMSk7XG5cdCAgICBcblx0ICAgICAgcHJvbWlzZS50aGVuKGZ1bmN0aW9uKHZhbHVlKXtcblx0ICAgICAgICAvLyB2YWx1ZSA9PT0gMVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQG1ldGhvZCByZXNvbHZlXG5cdCAgICAgIEBzdGF0aWNcblx0ICAgICAgQHBhcmFtIHtBbnl9IHZhbHVlIHZhbHVlIHRoYXQgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbCBiZSByZXNvbHZlZCB3aXRoXG5cdCAgICAgIFVzZWZ1bCBmb3IgdG9vbGluZy5cblx0ICAgICAgQHJldHVybiB7UHJvbWlzZX0gYSBwcm9taXNlIHRoYXQgd2lsbCBiZWNvbWUgZnVsZmlsbGVkIHdpdGggdGhlIGdpdmVuXG5cdCAgICAgIGB2YWx1ZWBcblx0ICAgICovXG5cblxuXHQgICAgZnVuY3Rpb24gcmVzb2x2ZSQxKG9iamVjdCkge1xuXHQgICAgICAvKmpzaGludCB2YWxpZHRoaXM6dHJ1ZSAqL1xuXHQgICAgICB2YXIgQ29uc3RydWN0b3IgPSB0aGlzO1xuXG5cdCAgICAgIGlmIChvYmplY3QgJiYgdHlwZW9mIG9iamVjdCA9PT0gJ29iamVjdCcgJiYgb2JqZWN0LmNvbnN0cnVjdG9yID09PSBDb25zdHJ1Y3Rvcikge1xuXHQgICAgICAgIHJldHVybiBvYmplY3Q7XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBDb25zdHJ1Y3Rvcihub29wKTtcblx0ICAgICAgcmVzb2x2ZShwcm9taXNlLCBvYmplY3QpO1xuXHQgICAgICByZXR1cm4gcHJvbWlzZTtcblx0ICAgIH1cblxuXHQgICAgdmFyIFBST01JU0VfSUQgPSBNYXRoLnJhbmRvbSgpLnRvU3RyaW5nKDM2KS5zdWJzdHJpbmcoMik7XG5cblx0ICAgIGZ1bmN0aW9uIG5vb3AoKSB7fVxuXG5cdCAgICB2YXIgUEVORElORyA9IHZvaWQgMDtcblx0ICAgIHZhciBGVUxGSUxMRUQgPSAxO1xuXHQgICAgdmFyIFJFSkVDVEVEID0gMjtcblxuXHQgICAgZnVuY3Rpb24gc2VsZkZ1bGZpbGxtZW50KCkge1xuXHQgICAgICByZXR1cm4gbmV3IFR5cGVFcnJvcihcIllvdSBjYW5ub3QgcmVzb2x2ZSBhIHByb21pc2Ugd2l0aCBpdHNlbGZcIik7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGNhbm5vdFJldHVybk93bigpIHtcblx0ICAgICAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoJ0EgcHJvbWlzZXMgY2FsbGJhY2sgY2Fubm90IHJldHVybiB0aGF0IHNhbWUgcHJvbWlzZS4nKTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gdHJ5VGhlbih0aGVuJCQxLCB2YWx1ZSwgZnVsZmlsbG1lbnRIYW5kbGVyLCByZWplY3Rpb25IYW5kbGVyKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgdGhlbiQkMS5jYWxsKHZhbHVlLCBmdWxmaWxsbWVudEhhbmRsZXIsIHJlamVjdGlvbkhhbmRsZXIpO1xuXHQgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgcmV0dXJuIGU7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gaGFuZGxlRm9yZWlnblRoZW5hYmxlKHByb21pc2UsIHRoZW5hYmxlLCB0aGVuJCQxKSB7XG5cdCAgICAgIGFzYXAoZnVuY3Rpb24gKHByb21pc2UpIHtcblx0ICAgICAgICB2YXIgc2VhbGVkID0gZmFsc2U7XG5cdCAgICAgICAgdmFyIGVycm9yID0gdHJ5VGhlbih0aGVuJCQxLCB0aGVuYWJsZSwgZnVuY3Rpb24gKHZhbHVlKSB7XG5cdCAgICAgICAgICBpZiAoc2VhbGVkKSB7XG5cdCAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgc2VhbGVkID0gdHJ1ZTtcblxuXHQgICAgICAgICAgaWYgKHRoZW5hYmxlICE9PSB2YWx1ZSkge1xuXHQgICAgICAgICAgICByZXNvbHZlKHByb21pc2UsIHZhbHVlKTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAgIGlmIChzZWFsZWQpIHtcblx0ICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBzZWFsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgcmVqZWN0KHByb21pc2UsIHJlYXNvbik7XG5cdCAgICAgICAgfSwgJ1NldHRsZTogJyArIChwcm9taXNlLl9sYWJlbCB8fCAnIHVua25vd24gcHJvbWlzZScpKTtcblxuXHQgICAgICAgIGlmICghc2VhbGVkICYmIGVycm9yKSB7XG5cdCAgICAgICAgICBzZWFsZWQgPSB0cnVlO1xuXHQgICAgICAgICAgcmVqZWN0KHByb21pc2UsIGVycm9yKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0sIHByb21pc2UpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBoYW5kbGVPd25UaGVuYWJsZShwcm9taXNlLCB0aGVuYWJsZSkge1xuXHQgICAgICBpZiAodGhlbmFibGUuX3N0YXRlID09PSBGVUxGSUxMRUQpIHtcblx0ICAgICAgICBmdWxmaWxsKHByb21pc2UsIHRoZW5hYmxlLl9yZXN1bHQpO1xuXHQgICAgICB9IGVsc2UgaWYgKHRoZW5hYmxlLl9zdGF0ZSA9PT0gUkVKRUNURUQpIHtcblx0ICAgICAgICByZWplY3QocHJvbWlzZSwgdGhlbmFibGUuX3Jlc3VsdCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3Vic2NyaWJlKHRoZW5hYmxlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAgIHJldHVybiByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBoYW5kbGVNYXliZVRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUsIHRoZW4kJDEpIHtcblx0ICAgICAgaWYgKG1heWJlVGhlbmFibGUuY29uc3RydWN0b3IgPT09IHByb21pc2UuY29uc3RydWN0b3IgJiYgdGhlbiQkMSA9PT0gdGhlbiAmJiBtYXliZVRoZW5hYmxlLmNvbnN0cnVjdG9yLnJlc29sdmUgPT09IHJlc29sdmUkMSkge1xuXHQgICAgICAgIGhhbmRsZU93blRoZW5hYmxlKHByb21pc2UsIG1heWJlVGhlbmFibGUpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGlmICh0aGVuJCQxID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG5cdCAgICAgICAgfSBlbHNlIGlmIChpc0Z1bmN0aW9uKHRoZW4kJDEpKSB7XG5cdCAgICAgICAgICBoYW5kbGVGb3JlaWduVGhlbmFibGUocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSwgdGhlbiQkMSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgbWF5YmVUaGVuYWJsZSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpIHtcblx0ICAgICAgaWYgKHByb21pc2UgPT09IHZhbHVlKSB7XG5cdCAgICAgICAgcmVqZWN0KHByb21pc2UsIHNlbGZGdWxmaWxsbWVudCgpKTtcblx0ICAgICAgfSBlbHNlIGlmIChvYmplY3RPckZ1bmN0aW9uKHZhbHVlKSkge1xuXHQgICAgICAgIHZhciB0aGVuJCQxID0gdm9pZCAwO1xuXG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIHRoZW4kJDEgPSB2YWx1ZS50aGVuO1xuXHQgICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG5cdCAgICAgICAgICByZWplY3QocHJvbWlzZSwgZXJyb3IpO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGhhbmRsZU1heWJlVGhlbmFibGUocHJvbWlzZSwgdmFsdWUsIHRoZW4kJDEpO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHB1Ymxpc2hSZWplY3Rpb24ocHJvbWlzZSkge1xuXHQgICAgICBpZiAocHJvbWlzZS5fb25lcnJvcikge1xuXHQgICAgICAgIHByb21pc2UuX29uZXJyb3IocHJvbWlzZS5fcmVzdWx0KTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHB1Ymxpc2gocHJvbWlzZSk7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGZ1bGZpbGwocHJvbWlzZSwgdmFsdWUpIHtcblx0ICAgICAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gdmFsdWU7XG5cdCAgICAgIHByb21pc2UuX3N0YXRlID0gRlVMRklMTEVEO1xuXG5cdCAgICAgIGlmIChwcm9taXNlLl9zdWJzY3JpYmVycy5sZW5ndGggIT09IDApIHtcblx0ICAgICAgICBhc2FwKHB1Ymxpc2gsIHByb21pc2UpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHJlamVjdChwcm9taXNlLCByZWFzb24pIHtcblx0ICAgICAgaWYgKHByb21pc2UuX3N0YXRlICE9PSBQRU5ESU5HKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgcHJvbWlzZS5fc3RhdGUgPSBSRUpFQ1RFRDtcblx0ICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gcmVhc29uO1xuXHQgICAgICBhc2FwKHB1Ymxpc2hSZWplY3Rpb24sIHByb21pc2UpO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBzdWJzY3JpYmUocGFyZW50LCBjaGlsZCwgb25GdWxmaWxsbWVudCwgb25SZWplY3Rpb24pIHtcblx0ICAgICAgdmFyIF9zdWJzY3JpYmVycyA9IHBhcmVudC5fc3Vic2NyaWJlcnM7XG5cdCAgICAgIHZhciBsZW5ndGggPSBfc3Vic2NyaWJlcnMubGVuZ3RoO1xuXHQgICAgICBwYXJlbnQuX29uZXJyb3IgPSBudWxsO1xuXHQgICAgICBfc3Vic2NyaWJlcnNbbGVuZ3RoXSA9IGNoaWxkO1xuXHQgICAgICBfc3Vic2NyaWJlcnNbbGVuZ3RoICsgRlVMRklMTEVEXSA9IG9uRnVsZmlsbG1lbnQ7XG5cdCAgICAgIF9zdWJzY3JpYmVyc1tsZW5ndGggKyBSRUpFQ1RFRF0gPSBvblJlamVjdGlvbjtcblxuXHQgICAgICBpZiAobGVuZ3RoID09PSAwICYmIHBhcmVudC5fc3RhdGUpIHtcblx0ICAgICAgICBhc2FwKHB1Ymxpc2gsIHBhcmVudCk7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gcHVibGlzaChwcm9taXNlKSB7XG5cdCAgICAgIHZhciBzdWJzY3JpYmVycyA9IHByb21pc2UuX3N1YnNjcmliZXJzO1xuXHQgICAgICB2YXIgc2V0dGxlZCA9IHByb21pc2UuX3N0YXRlO1xuXG5cdCAgICAgIGlmIChzdWJzY3JpYmVycy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblxuXHQgICAgICB2YXIgY2hpbGQgPSB2b2lkIDAsXG5cdCAgICAgICAgICBjYWxsYmFjayA9IHZvaWQgMCxcblx0ICAgICAgICAgIGRldGFpbCA9IHByb21pc2UuX3Jlc3VsdDtcblxuXHQgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN1YnNjcmliZXJzLmxlbmd0aDsgaSArPSAzKSB7XG5cdCAgICAgICAgY2hpbGQgPSBzdWJzY3JpYmVyc1tpXTtcblx0ICAgICAgICBjYWxsYmFjayA9IHN1YnNjcmliZXJzW2kgKyBzZXR0bGVkXTtcblxuXHQgICAgICAgIGlmIChjaGlsZCkge1xuXHQgICAgICAgICAgaW52b2tlQ2FsbGJhY2soc2V0dGxlZCwgY2hpbGQsIGNhbGxiYWNrLCBkZXRhaWwpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBjYWxsYmFjayhkZXRhaWwpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHByb21pc2UuX3N1YnNjcmliZXJzLmxlbmd0aCA9IDA7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGludm9rZUNhbGxiYWNrKHNldHRsZWQsIHByb21pc2UsIGNhbGxiYWNrLCBkZXRhaWwpIHtcblx0ICAgICAgdmFyIGhhc0NhbGxiYWNrID0gaXNGdW5jdGlvbihjYWxsYmFjayksXG5cdCAgICAgICAgICB2YWx1ZSA9IHZvaWQgMCxcblx0ICAgICAgICAgIGVycm9yID0gdm9pZCAwLFxuXHQgICAgICAgICAgc3VjY2VlZGVkID0gdHJ1ZTtcblxuXHQgICAgICBpZiAoaGFzQ2FsbGJhY2spIHtcblx0ICAgICAgICB0cnkge1xuXHQgICAgICAgICAgdmFsdWUgPSBjYWxsYmFjayhkZXRhaWwpO1xuXHQgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgIHN1Y2NlZWRlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgZXJyb3IgPSBlO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChwcm9taXNlID09PSB2YWx1ZSkge1xuXHQgICAgICAgICAgcmVqZWN0KHByb21pc2UsIGNhbm5vdFJldHVybk93bigpKTtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdmFsdWUgPSBkZXRhaWw7XG5cdCAgICAgIH1cblxuXHQgICAgICBpZiAocHJvbWlzZS5fc3RhdGUgIT09IFBFTkRJTkcpIDsgZWxzZSBpZiAoaGFzQ2FsbGJhY2sgJiYgc3VjY2VlZGVkKSB7XG5cdCAgICAgICAgcmVzb2x2ZShwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgIH0gZWxzZSBpZiAoc3VjY2VlZGVkID09PSBmYWxzZSkge1xuXHQgICAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG5cdCAgICAgIH0gZWxzZSBpZiAoc2V0dGxlZCA9PT0gRlVMRklMTEVEKSB7XG5cdCAgICAgICAgZnVsZmlsbChwcm9taXNlLCB2YWx1ZSk7XG5cdCAgICAgIH0gZWxzZSBpZiAoc2V0dGxlZCA9PT0gUkVKRUNURUQpIHtcblx0ICAgICAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIGluaXRpYWxpemVQcm9taXNlKHByb21pc2UsIHJlc29sdmVyKSB7XG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgcmVzb2x2ZXIoZnVuY3Rpb24gcmVzb2x2ZVByb21pc2UodmFsdWUpIHtcblx0ICAgICAgICAgIHJlc29sdmUocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgIH0sIGZ1bmN0aW9uIHJlamVjdFByb21pc2UocmVhc29uKSB7XG5cdCAgICAgICAgICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSBjYXRjaCAoZSkge1xuXHQgICAgICAgIHJlamVjdChwcm9taXNlLCBlKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICB2YXIgaWQgPSAwO1xuXG5cdCAgICBmdW5jdGlvbiBuZXh0SWQoKSB7XG5cdCAgICAgIHJldHVybiBpZCsrO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBtYWtlUHJvbWlzZShwcm9taXNlKSB7XG5cdCAgICAgIHByb21pc2VbUFJPTUlTRV9JRF0gPSBpZCsrO1xuXHQgICAgICBwcm9taXNlLl9zdGF0ZSA9IHVuZGVmaW5lZDtcblx0ICAgICAgcHJvbWlzZS5fcmVzdWx0ID0gdW5kZWZpbmVkO1xuXHQgICAgICBwcm9taXNlLl9zdWJzY3JpYmVycyA9IFtdO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiB2YWxpZGF0aW9uRXJyb3IoKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRXJyb3IoJ0FycmF5IE1ldGhvZHMgbXVzdCBiZSBwcm92aWRlZCBhbiBBcnJheScpO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgRW51bWVyYXRvciA9IGZ1bmN0aW9uICgpIHtcblx0ICAgICAgZnVuY3Rpb24gRW51bWVyYXRvcihDb25zdHJ1Y3RvciwgaW5wdXQpIHtcblx0ICAgICAgICB0aGlzLl9pbnN0YW5jZUNvbnN0cnVjdG9yID0gQ29uc3RydWN0b3I7XG5cdCAgICAgICAgdGhpcy5wcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuXG5cdCAgICAgICAgaWYgKCF0aGlzLnByb21pc2VbUFJPTUlTRV9JRF0pIHtcblx0ICAgICAgICAgIG1ha2VQcm9taXNlKHRoaXMucHJvbWlzZSk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKGlzQXJyYXkoaW5wdXQpKSB7XG5cdCAgICAgICAgICB0aGlzLmxlbmd0aCA9IGlucHV0Lmxlbmd0aDtcblx0ICAgICAgICAgIHRoaXMuX3JlbWFpbmluZyA9IGlucHV0Lmxlbmd0aDtcblx0ICAgICAgICAgIHRoaXMuX3Jlc3VsdCA9IG5ldyBBcnJheSh0aGlzLmxlbmd0aCk7XG5cblx0ICAgICAgICAgIGlmICh0aGlzLmxlbmd0aCA9PT0gMCkge1xuXHQgICAgICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHRoaXMubGVuZ3RoID0gdGhpcy5sZW5ndGggfHwgMDtcblxuXHQgICAgICAgICAgICB0aGlzLl9lbnVtZXJhdGUoaW5wdXQpO1xuXG5cdCAgICAgICAgICAgIGlmICh0aGlzLl9yZW1haW5pbmcgPT09IDApIHtcblx0ICAgICAgICAgICAgICBmdWxmaWxsKHRoaXMucHJvbWlzZSwgdGhpcy5fcmVzdWx0KTtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICByZWplY3QodGhpcy5wcm9taXNlLCB2YWxpZGF0aW9uRXJyb3IoKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgRW51bWVyYXRvci5wcm90b3R5cGUuX2VudW1lcmF0ZSA9IGZ1bmN0aW9uIF9lbnVtZXJhdGUoaW5wdXQpIHtcblx0ICAgICAgICBmb3IgKHZhciBpID0gMDsgdGhpcy5fc3RhdGUgPT09IFBFTkRJTkcgJiYgaSA8IGlucHV0Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICB0aGlzLl9lYWNoRW50cnkoaW5wdXRbaV0sIGkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblxuXHQgICAgICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fZWFjaEVudHJ5ID0gZnVuY3Rpb24gX2VhY2hFbnRyeShlbnRyeSwgaSkge1xuXHQgICAgICAgIHZhciBjID0gdGhpcy5faW5zdGFuY2VDb25zdHJ1Y3Rvcjtcblx0ICAgICAgICB2YXIgcmVzb2x2ZSQkMSA9IGMucmVzb2x2ZTtcblxuXHQgICAgICAgIGlmIChyZXNvbHZlJCQxID09PSByZXNvbHZlJDEpIHtcblx0ICAgICAgICAgIHZhciBfdGhlbiA9IHZvaWQgMDtcblxuXHQgICAgICAgICAgdmFyIGVycm9yID0gdm9pZCAwO1xuXHQgICAgICAgICAgdmFyIGRpZEVycm9yID0gZmFsc2U7XG5cblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIF90aGVuID0gZW50cnkudGhlbjtcblx0ICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICAgICAgZGlkRXJyb3IgPSB0cnVlO1xuXHQgICAgICAgICAgICBlcnJvciA9IGU7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIGlmIChfdGhlbiA9PT0gdGhlbiAmJiBlbnRyeS5fc3RhdGUgIT09IFBFTkRJTkcpIHtcblx0ICAgICAgICAgICAgdGhpcy5fc2V0dGxlZEF0KGVudHJ5Ll9zdGF0ZSwgaSwgZW50cnkuX3Jlc3VsdCk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBfdGhlbiAhPT0gJ2Z1bmN0aW9uJykge1xuXHQgICAgICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcblx0ICAgICAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gZW50cnk7XG5cdCAgICAgICAgICB9IGVsc2UgaWYgKGMgPT09IFByb21pc2UkMSkge1xuXHQgICAgICAgICAgICB2YXIgcHJvbWlzZSA9IG5ldyBjKG5vb3ApO1xuXG5cdCAgICAgICAgICAgIGlmIChkaWRFcnJvcikge1xuXHQgICAgICAgICAgICAgIHJlamVjdChwcm9taXNlLCBlcnJvcik7XG5cdCAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgaGFuZGxlTWF5YmVUaGVuYWJsZShwcm9taXNlLCBlbnRyeSwgX3RoZW4pO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KHByb21pc2UsIGkpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5fd2lsbFNldHRsZUF0KG5ldyBjKGZ1bmN0aW9uIChyZXNvbHZlJCQxKSB7XG5cdCAgICAgICAgICAgICAgcmV0dXJuIHJlc29sdmUkJDEoZW50cnkpO1xuXHQgICAgICAgICAgICB9KSwgaSk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRoaXMuX3dpbGxTZXR0bGVBdChyZXNvbHZlJCQxKGVudHJ5KSwgaSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9O1xuXG5cdCAgICAgIEVudW1lcmF0b3IucHJvdG90eXBlLl9zZXR0bGVkQXQgPSBmdW5jdGlvbiBfc2V0dGxlZEF0KHN0YXRlLCBpLCB2YWx1ZSkge1xuXHQgICAgICAgIHZhciBwcm9taXNlID0gdGhpcy5wcm9taXNlO1xuXG5cdCAgICAgICAgaWYgKHByb21pc2UuX3N0YXRlID09PSBQRU5ESU5HKSB7XG5cdCAgICAgICAgICB0aGlzLl9yZW1haW5pbmctLTtcblxuXHQgICAgICAgICAgaWYgKHN0YXRlID09PSBSRUpFQ1RFRCkge1xuXHQgICAgICAgICAgICByZWplY3QocHJvbWlzZSwgdmFsdWUpO1xuXHQgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgdGhpcy5fcmVzdWx0W2ldID0gdmFsdWU7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaWYgKHRoaXMuX3JlbWFpbmluZyA9PT0gMCkge1xuXHQgICAgICAgICAgZnVsZmlsbChwcm9taXNlLCB0aGlzLl9yZXN1bHQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfTtcblxuXHQgICAgICBFbnVtZXJhdG9yLnByb3RvdHlwZS5fd2lsbFNldHRsZUF0ID0gZnVuY3Rpb24gX3dpbGxTZXR0bGVBdChwcm9taXNlLCBpKSB7XG5cdCAgICAgICAgdmFyIGVudW1lcmF0b3IgPSB0aGlzO1xuXHQgICAgICAgIHN1YnNjcmliZShwcm9taXNlLCB1bmRlZmluZWQsIGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgcmV0dXJuIGVudW1lcmF0b3IuX3NldHRsZWRBdChGVUxGSUxMRUQsIGksIHZhbHVlKTtcblx0ICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgICByZXR1cm4gZW51bWVyYXRvci5fc2V0dGxlZEF0KFJFSkVDVEVELCBpLCByZWFzb24pO1xuXHQgICAgICAgIH0pO1xuXHQgICAgICB9O1xuXG5cdCAgICAgIHJldHVybiBFbnVtZXJhdG9yO1xuXHQgICAgfSgpO1xuXHQgICAgLyoqXG5cdCAgICAgIGBQcm9taXNlLmFsbGAgYWNjZXB0cyBhbiBhcnJheSBvZiBwcm9taXNlcywgYW5kIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaFxuXHQgICAgICBpcyBmdWxmaWxsZWQgd2l0aCBhbiBhcnJheSBvZiBmdWxmaWxsbWVudCB2YWx1ZXMgZm9yIHRoZSBwYXNzZWQgcHJvbWlzZXMsIG9yXG5cdCAgICAgIHJlamVjdGVkIHdpdGggdGhlIHJlYXNvbiBvZiB0aGUgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gYmUgcmVqZWN0ZWQuIEl0IGNhc3RzIGFsbFxuXHQgICAgICBlbGVtZW50cyBvZiB0aGUgcGFzc2VkIGl0ZXJhYmxlIHRvIHByb21pc2VzIGFzIGl0IHJ1bnMgdGhpcyBhbGdvcml0aG0uXG5cdCAgICBcblx0ICAgICAgRXhhbXBsZTpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGxldCBwcm9taXNlMSA9IHJlc29sdmUoMSk7XG5cdCAgICAgIGxldCBwcm9taXNlMiA9IHJlc29sdmUoMik7XG5cdCAgICAgIGxldCBwcm9taXNlMyA9IHJlc29sdmUoMyk7XG5cdCAgICAgIGxldCBwcm9taXNlcyA9IFsgcHJvbWlzZTEsIHByb21pc2UyLCBwcm9taXNlMyBdO1xuXHQgICAgXG5cdCAgICAgIFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKGZ1bmN0aW9uKGFycmF5KXtcblx0ICAgICAgICAvLyBUaGUgYXJyYXkgaGVyZSB3b3VsZCBiZSBbIDEsIDIsIDMgXTtcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIElmIGFueSBvZiB0aGUgYHByb21pc2VzYCBnaXZlbiB0byBgYWxsYCBhcmUgcmVqZWN0ZWQsIHRoZSBmaXJzdCBwcm9taXNlXG5cdCAgICAgIHRoYXQgaXMgcmVqZWN0ZWQgd2lsbCBiZSBnaXZlbiBhcyBhbiBhcmd1bWVudCB0byB0aGUgcmV0dXJuZWQgcHJvbWlzZXMnc1xuXHQgICAgICByZWplY3Rpb24gaGFuZGxlci4gRm9yIGV4YW1wbGU6XG5cdCAgICBcblx0ICAgICAgRXhhbXBsZTpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGxldCBwcm9taXNlMSA9IHJlc29sdmUoMSk7XG5cdCAgICAgIGxldCBwcm9taXNlMiA9IHJlamVjdChuZXcgRXJyb3IoXCIyXCIpKTtcblx0ICAgICAgbGV0IHByb21pc2UzID0gcmVqZWN0KG5ldyBFcnJvcihcIjNcIikpO1xuXHQgICAgICBsZXQgcHJvbWlzZXMgPSBbIHByb21pc2UxLCBwcm9taXNlMiwgcHJvbWlzZTMgXTtcblx0ICAgIFxuXHQgICAgICBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbihmdW5jdGlvbihhcnJheSl7XG5cdCAgICAgICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnMgYmVjYXVzZSB0aGVyZSBhcmUgcmVqZWN0ZWQgcHJvbWlzZXMhXG5cdCAgICAgIH0sIGZ1bmN0aW9uKGVycm9yKSB7XG5cdCAgICAgICAgLy8gZXJyb3IubWVzc2FnZSA9PT0gXCIyXCJcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgXG5cdCAgICAgIEBtZXRob2QgYWxsXG5cdCAgICAgIEBzdGF0aWNcblx0ICAgICAgQHBhcmFtIHtBcnJheX0gZW50cmllcyBhcnJheSBvZiBwcm9taXNlc1xuXHQgICAgICBAcGFyYW0ge1N0cmluZ30gbGFiZWwgb3B0aW9uYWwgc3RyaW5nIGZvciBsYWJlbGluZyB0aGUgcHJvbWlzZS5cblx0ICAgICAgVXNlZnVsIGZvciB0b29saW5nLlxuXHQgICAgICBAcmV0dXJuIHtQcm9taXNlfSBwcm9taXNlIHRoYXQgaXMgZnVsZmlsbGVkIHdoZW4gYWxsIGBwcm9taXNlc2AgaGF2ZSBiZWVuXG5cdCAgICAgIGZ1bGZpbGxlZCwgb3IgcmVqZWN0ZWQgaWYgYW55IG9mIHRoZW0gYmVjb21lIHJlamVjdGVkLlxuXHQgICAgICBAc3RhdGljXG5cdCAgICAqL1xuXG5cblx0ICAgIGZ1bmN0aW9uIGFsbChlbnRyaWVzKSB7XG5cdCAgICAgIHJldHVybiBuZXcgRW51bWVyYXRvcih0aGlzLCBlbnRyaWVzKS5wcm9taXNlO1xuXHQgICAgfVxuXHQgICAgLyoqXG5cdCAgICAgIGBQcm9taXNlLnJhY2VgIHJldHVybnMgYSBuZXcgcHJvbWlzZSB3aGljaCBpcyBzZXR0bGVkIGluIHRoZSBzYW1lIHdheSBhcyB0aGVcblx0ICAgICAgZmlyc3QgcGFzc2VkIHByb21pc2UgdG8gc2V0dGxlLlxuXHQgICAgXG5cdCAgICAgIEV4YW1wbGU6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZTEgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3Qpe1xuXHQgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcblx0ICAgICAgICAgIHJlc29sdmUoJ3Byb21pc2UgMScpO1xuXHQgICAgICAgIH0sIDIwMCk7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIGxldCBwcm9taXNlMiA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHQgICAgICAgICAgcmVzb2x2ZSgncHJvbWlzZSAyJyk7XG5cdCAgICAgICAgfSwgMTAwKTtcblx0ICAgICAgfSk7XG5cdCAgICBcblx0ICAgICAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdCAgICAgICAgLy8gcmVzdWx0ID09PSAncHJvbWlzZSAyJyBiZWNhdXNlIGl0IHdhcyByZXNvbHZlZCBiZWZvcmUgcHJvbWlzZTFcblx0ICAgICAgICAvLyB3YXMgcmVzb2x2ZWQuXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBgUHJvbWlzZS5yYWNlYCBpcyBkZXRlcm1pbmlzdGljIGluIHRoYXQgb25seSB0aGUgc3RhdGUgb2YgdGhlIGZpcnN0XG5cdCAgICAgIHNldHRsZWQgcHJvbWlzZSBtYXR0ZXJzLiBGb3IgZXhhbXBsZSwgZXZlbiBpZiBvdGhlciBwcm9taXNlcyBnaXZlbiB0byB0aGVcblx0ICAgICAgYHByb21pc2VzYCBhcnJheSBhcmd1bWVudCBhcmUgcmVzb2x2ZWQsIGJ1dCB0aGUgZmlyc3Qgc2V0dGxlZCBwcm9taXNlIGhhc1xuXHQgICAgICBiZWNvbWUgcmVqZWN0ZWQgYmVmb3JlIHRoZSBvdGhlciBwcm9taXNlcyBiZWNhbWUgZnVsZmlsbGVkLCB0aGUgcmV0dXJuZWRcblx0ICAgICAgcHJvbWlzZSB3aWxsIGJlY29tZSByZWplY3RlZDpcblx0ICAgIFxuXHQgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGxldCBwcm9taXNlMSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuXHQgICAgICAgICAgcmVzb2x2ZSgncHJvbWlzZSAxJyk7XG5cdCAgICAgICAgfSwgMjAwKTtcblx0ICAgICAgfSk7XG5cdCAgICBcblx0ICAgICAgbGV0IHByb21pc2UyID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcblx0ICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdwcm9taXNlIDInKSk7XG5cdCAgICAgICAgfSwgMTAwKTtcblx0ICAgICAgfSk7XG5cdCAgICBcblx0ICAgICAgUHJvbWlzZS5yYWNlKFtwcm9taXNlMSwgcHJvbWlzZTJdKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdCAgICAgICAgLy8gQ29kZSBoZXJlIG5ldmVyIHJ1bnNcblx0ICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyByZWFzb24ubWVzc2FnZSA9PT0gJ3Byb21pc2UgMicgYmVjYXVzZSBwcm9taXNlIDIgYmVjYW1lIHJlamVjdGVkIGJlZm9yZVxuXHQgICAgICAgIC8vIHByb21pc2UgMSBiZWNhbWUgZnVsZmlsbGVkXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBBbiBleGFtcGxlIHJlYWwtd29ybGQgdXNlIGNhc2UgaXMgaW1wbGVtZW50aW5nIHRpbWVvdXRzOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgUHJvbWlzZS5yYWNlKFthamF4KCdmb28uanNvbicpLCB0aW1lb3V0KDUwMDApXSlcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQG1ldGhvZCByYWNlXG5cdCAgICAgIEBzdGF0aWNcblx0ICAgICAgQHBhcmFtIHtBcnJheX0gcHJvbWlzZXMgYXJyYXkgb2YgcHJvbWlzZXMgdG8gb2JzZXJ2ZVxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSB3aGljaCBzZXR0bGVzIGluIHRoZSBzYW1lIHdheSBhcyB0aGUgZmlyc3QgcGFzc2VkXG5cdCAgICAgIHByb21pc2UgdG8gc2V0dGxlLlxuXHQgICAgKi9cblxuXG5cdCAgICBmdW5jdGlvbiByYWNlKGVudHJpZXMpIHtcblx0ICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOnRydWUgKi9cblx0ICAgICAgdmFyIENvbnN0cnVjdG9yID0gdGhpcztcblxuXHQgICAgICBpZiAoIWlzQXJyYXkoZW50cmllcykpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uIChfLCByZWplY3QpIHtcblx0ICAgICAgICAgIHJldHVybiByZWplY3QobmV3IFR5cGVFcnJvcignWW91IG11c3QgcGFzcyBhbiBhcnJheSB0byByYWNlLicpKTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gbmV3IENvbnN0cnVjdG9yKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAgIHZhciBsZW5ndGggPSBlbnRyaWVzLmxlbmd0aDtcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgICBDb25zdHJ1Y3Rvci5yZXNvbHZlKGVudHJpZXNbaV0pLnRoZW4ocmVzb2x2ZSwgcmVqZWN0KTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgICAgLyoqXG5cdCAgICAgIGBQcm9taXNlLnJlamVjdGAgcmV0dXJucyBhIHByb21pc2UgcmVqZWN0ZWQgd2l0aCB0aGUgcGFzc2VkIGByZWFzb25gLlxuXHQgICAgICBJdCBpcyBzaG9ydGhhbmQgZm9yIHRoZSBmb2xsb3dpbmc6XG5cdCAgICBcblx0ICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcHJvbWlzZSA9IG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCl7XG5cdCAgICAgICAgcmVqZWN0KG5ldyBFcnJvcignV0hPT1BTJykpO1xuXHQgICAgICB9KTtcblx0ICAgIFxuXHQgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuXHQgICAgICAgIC8vIENvZGUgaGVyZSBkb2Vzbid0IHJ1biBiZWNhdXNlIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIVxuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAnV0hPT1BTJ1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgSW5zdGVhZCBvZiB3cml0aW5nIHRoZSBhYm92ZSwgeW91ciBjb2RlIG5vdyBzaW1wbHkgYmVjb21lcyB0aGUgZm9sbG93aW5nOlxuXHQgICAgXG5cdCAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgbGV0IHByb21pc2UgPSBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ1dIT09QUycpKTtcblx0ICAgIFxuXHQgICAgICBwcm9taXNlLnRoZW4oZnVuY3Rpb24odmFsdWUpe1xuXHQgICAgICAgIC8vIENvZGUgaGVyZSBkb2Vzbid0IHJ1biBiZWNhdXNlIHRoZSBwcm9taXNlIGlzIHJlamVjdGVkIVxuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIHJlYXNvbi5tZXNzYWdlID09PSAnV0hPT1BTJ1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQG1ldGhvZCByZWplY3Rcblx0ICAgICAgQHN0YXRpY1xuXHQgICAgICBAcGFyYW0ge0FueX0gcmVhc29uIHZhbHVlIHRoYXQgdGhlIHJldHVybmVkIHByb21pc2Ugd2lsbCBiZSByZWplY3RlZCB3aXRoLlxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9IGEgcHJvbWlzZSByZWplY3RlZCB3aXRoIHRoZSBnaXZlbiBgcmVhc29uYC5cblx0ICAgICovXG5cblxuXHQgICAgZnVuY3Rpb24gcmVqZWN0JDEocmVhc29uKSB7XG5cdCAgICAgIC8qanNoaW50IHZhbGlkdGhpczp0cnVlICovXG5cdCAgICAgIHZhciBDb25zdHJ1Y3RvciA9IHRoaXM7XG5cdCAgICAgIHZhciBwcm9taXNlID0gbmV3IENvbnN0cnVjdG9yKG5vb3ApO1xuXHQgICAgICByZWplY3QocHJvbWlzZSwgcmVhc29uKTtcblx0ICAgICAgcmV0dXJuIHByb21pc2U7XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIG5lZWRzUmVzb2x2ZXIoKSB7XG5cdCAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1lvdSBtdXN0IHBhc3MgYSByZXNvbHZlciBmdW5jdGlvbiBhcyB0aGUgZmlyc3QgYXJndW1lbnQgdG8gdGhlIHByb21pc2UgY29uc3RydWN0b3InKTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gbmVlZHNOZXcoKSB7XG5cdCAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdQcm9taXNlJzogUGxlYXNlIHVzZSB0aGUgJ25ldycgb3BlcmF0b3IsIHRoaXMgb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7XG5cdCAgICB9XG5cdCAgICAvKipcblx0ICAgICAgUHJvbWlzZSBvYmplY3RzIHJlcHJlc2VudCB0aGUgZXZlbnR1YWwgcmVzdWx0IG9mIGFuIGFzeW5jaHJvbm91cyBvcGVyYXRpb24uIFRoZVxuXHQgICAgICBwcmltYXJ5IHdheSBvZiBpbnRlcmFjdGluZyB3aXRoIGEgcHJvbWlzZSBpcyB0aHJvdWdoIGl0cyBgdGhlbmAgbWV0aG9kLCB3aGljaFxuXHQgICAgICByZWdpc3RlcnMgY2FsbGJhY2tzIHRvIHJlY2VpdmUgZWl0aGVyIGEgcHJvbWlzZSdzIGV2ZW50dWFsIHZhbHVlIG9yIHRoZSByZWFzb25cblx0ICAgICAgd2h5IHRoZSBwcm9taXNlIGNhbm5vdCBiZSBmdWxmaWxsZWQuXG5cdCAgICBcblx0ICAgICAgVGVybWlub2xvZ3lcblx0ICAgICAgLS0tLS0tLS0tLS1cblx0ICAgIFxuXHQgICAgICAtIGBwcm9taXNlYCBpcyBhbiBvYmplY3Qgb3IgZnVuY3Rpb24gd2l0aCBhIGB0aGVuYCBtZXRob2Qgd2hvc2UgYmVoYXZpb3IgY29uZm9ybXMgdG8gdGhpcyBzcGVjaWZpY2F0aW9uLlxuXHQgICAgICAtIGB0aGVuYWJsZWAgaXMgYW4gb2JqZWN0IG9yIGZ1bmN0aW9uIHRoYXQgZGVmaW5lcyBhIGB0aGVuYCBtZXRob2QuXG5cdCAgICAgIC0gYHZhbHVlYCBpcyBhbnkgbGVnYWwgSmF2YVNjcmlwdCB2YWx1ZSAoaW5jbHVkaW5nIHVuZGVmaW5lZCwgYSB0aGVuYWJsZSwgb3IgYSBwcm9taXNlKS5cblx0ICAgICAgLSBgZXhjZXB0aW9uYCBpcyBhIHZhbHVlIHRoYXQgaXMgdGhyb3duIHVzaW5nIHRoZSB0aHJvdyBzdGF0ZW1lbnQuXG5cdCAgICAgIC0gYHJlYXNvbmAgaXMgYSB2YWx1ZSB0aGF0IGluZGljYXRlcyB3aHkgYSBwcm9taXNlIHdhcyByZWplY3RlZC5cblx0ICAgICAgLSBgc2V0dGxlZGAgdGhlIGZpbmFsIHJlc3Rpbmcgc3RhdGUgb2YgYSBwcm9taXNlLCBmdWxmaWxsZWQgb3IgcmVqZWN0ZWQuXG5cdCAgICBcblx0ICAgICAgQSBwcm9taXNlIGNhbiBiZSBpbiBvbmUgb2YgdGhyZWUgc3RhdGVzOiBwZW5kaW5nLCBmdWxmaWxsZWQsIG9yIHJlamVjdGVkLlxuXHQgICAgXG5cdCAgICAgIFByb21pc2VzIHRoYXQgYXJlIGZ1bGZpbGxlZCBoYXZlIGEgZnVsZmlsbG1lbnQgdmFsdWUgYW5kIGFyZSBpbiB0aGUgZnVsZmlsbGVkXG5cdCAgICAgIHN0YXRlLiAgUHJvbWlzZXMgdGhhdCBhcmUgcmVqZWN0ZWQgaGF2ZSBhIHJlamVjdGlvbiByZWFzb24gYW5kIGFyZSBpbiB0aGVcblx0ICAgICAgcmVqZWN0ZWQgc3RhdGUuICBBIGZ1bGZpbGxtZW50IHZhbHVlIGlzIG5ldmVyIGEgdGhlbmFibGUuXG5cdCAgICBcblx0ICAgICAgUHJvbWlzZXMgY2FuIGFsc28gYmUgc2FpZCB0byAqcmVzb2x2ZSogYSB2YWx1ZS4gIElmIHRoaXMgdmFsdWUgaXMgYWxzbyBhXG5cdCAgICAgIHByb21pc2UsIHRoZW4gdGhlIG9yaWdpbmFsIHByb21pc2UncyBzZXR0bGVkIHN0YXRlIHdpbGwgbWF0Y2ggdGhlIHZhbHVlJ3Ncblx0ICAgICAgc2V0dGxlZCBzdGF0ZS4gIFNvIGEgcHJvbWlzZSB0aGF0ICpyZXNvbHZlcyogYSBwcm9taXNlIHRoYXQgcmVqZWN0cyB3aWxsXG5cdCAgICAgIGl0c2VsZiByZWplY3QsIGFuZCBhIHByb21pc2UgdGhhdCAqcmVzb2x2ZXMqIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHdpbGxcblx0ICAgICAgaXRzZWxmIGZ1bGZpbGwuXG5cdCAgICBcblx0ICAgIFxuXHQgICAgICBCYXNpYyBVc2FnZTpcblx0ICAgICAgLS0tLS0tLS0tLS0tXG5cdCAgICBcblx0ICAgICAgYGBganNcblx0ICAgICAgbGV0IHByb21pc2UgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcblx0ICAgICAgICAvLyBvbiBzdWNjZXNzXG5cdCAgICAgICAgcmVzb2x2ZSh2YWx1ZSk7XG5cdCAgICBcblx0ICAgICAgICAvLyBvbiBmYWlsdXJlXG5cdCAgICAgICAgcmVqZWN0KHJlYXNvbik7XG5cdCAgICAgIH0pO1xuXHQgICAgXG5cdCAgICAgIHByb21pc2UudGhlbihmdW5jdGlvbih2YWx1ZSkge1xuXHQgICAgICAgIC8vIG9uIGZ1bGZpbGxtZW50XG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbikge1xuXHQgICAgICAgIC8vIG9uIHJlamVjdGlvblxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICBcblx0ICAgICAgQWR2YW5jZWQgVXNhZ2U6XG5cdCAgICAgIC0tLS0tLS0tLS0tLS0tLVxuXHQgICAgXG5cdCAgICAgIFByb21pc2VzIHNoaW5lIHdoZW4gYWJzdHJhY3RpbmcgYXdheSBhc3luY2hyb25vdXMgaW50ZXJhY3Rpb25zIHN1Y2ggYXNcblx0ICAgICAgYFhNTEh0dHBSZXF1ZXN0YHMuXG5cdCAgICBcblx0ICAgICAgYGBganNcblx0ICAgICAgZnVuY3Rpb24gZ2V0SlNPTih1cmwpIHtcblx0ICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KXtcblx0ICAgICAgICAgIGxldCB4aHIgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcblx0ICAgIFxuXHQgICAgICAgICAgeGhyLm9wZW4oJ0dFVCcsIHVybCk7XG5cdCAgICAgICAgICB4aHIub25yZWFkeXN0YXRlY2hhbmdlID0gaGFuZGxlcjtcblx0ICAgICAgICAgIHhoci5yZXNwb25zZVR5cGUgPSAnanNvbic7XG5cdCAgICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgJ2FwcGxpY2F0aW9uL2pzb24nKTtcblx0ICAgICAgICAgIHhoci5zZW5kKCk7XG5cdCAgICBcblx0ICAgICAgICAgIGZ1bmN0aW9uIGhhbmRsZXIoKSB7XG5cdCAgICAgICAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuRE9ORSkge1xuXHQgICAgICAgICAgICAgIGlmICh0aGlzLnN0YXR1cyA9PT0gMjAwKSB7XG5cdCAgICAgICAgICAgICAgICByZXNvbHZlKHRoaXMucmVzcG9uc2UpO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICByZWplY3QobmV3IEVycm9yKCdnZXRKU09OOiBgJyArIHVybCArICdgIGZhaWxlZCB3aXRoIHN0YXR1czogWycgKyB0aGlzLnN0YXR1cyArICddJykpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfTtcblx0ICAgICAgICB9KTtcblx0ICAgICAgfVxuXHQgICAgXG5cdCAgICAgIGdldEpTT04oJy9wb3N0cy5qc29uJykudGhlbihmdW5jdGlvbihqc29uKSB7XG5cdCAgICAgICAgLy8gb24gZnVsZmlsbG1lbnRcblx0ICAgICAgfSwgZnVuY3Rpb24ocmVhc29uKSB7XG5cdCAgICAgICAgLy8gb24gcmVqZWN0aW9uXG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBVbmxpa2UgY2FsbGJhY2tzLCBwcm9taXNlcyBhcmUgZ3JlYXQgY29tcG9zYWJsZSBwcmltaXRpdmVzLlxuXHQgICAgXG5cdCAgICAgIGBgYGpzXG5cdCAgICAgIFByb21pc2UuYWxsKFtcblx0ICAgICAgICBnZXRKU09OKCcvcG9zdHMnKSxcblx0ICAgICAgICBnZXRKU09OKCcvY29tbWVudHMnKVxuXHQgICAgICBdKS50aGVuKGZ1bmN0aW9uKHZhbHVlcyl7XG5cdCAgICAgICAgdmFsdWVzWzBdIC8vID0+IHBvc3RzSlNPTlxuXHQgICAgICAgIHZhbHVlc1sxXSAvLyA9PiBjb21tZW50c0pTT05cblx0ICAgIFxuXHQgICAgICAgIHJldHVybiB2YWx1ZXM7XG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgIFxuXHQgICAgICBAY2xhc3MgUHJvbWlzZVxuXHQgICAgICBAcGFyYW0ge0Z1bmN0aW9ufSByZXNvbHZlclxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEBjb25zdHJ1Y3RvclxuXHQgICAgKi9cblxuXG5cdCAgICB2YXIgUHJvbWlzZSQxID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICBmdW5jdGlvbiBQcm9taXNlKHJlc29sdmVyKSB7XG5cdCAgICAgICAgdGhpc1tQUk9NSVNFX0lEXSA9IG5leHRJZCgpO1xuXHQgICAgICAgIHRoaXMuX3Jlc3VsdCA9IHRoaXMuX3N0YXRlID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIHRoaXMuX3N1YnNjcmliZXJzID0gW107XG5cblx0ICAgICAgICBpZiAobm9vcCAhPT0gcmVzb2x2ZXIpIHtcblx0ICAgICAgICAgIHR5cGVvZiByZXNvbHZlciAhPT0gJ2Z1bmN0aW9uJyAmJiBuZWVkc1Jlc29sdmVyKCk7XG5cdCAgICAgICAgICB0aGlzIGluc3RhbmNlb2YgUHJvbWlzZSA/IGluaXRpYWxpemVQcm9taXNlKHRoaXMsIHJlc29sdmVyKSA6IG5lZWRzTmV3KCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICAgIC8qKlxuXHQgICAgICBUaGUgcHJpbWFyeSB3YXkgb2YgaW50ZXJhY3Rpbmcgd2l0aCBhIHByb21pc2UgaXMgdGhyb3VnaCBpdHMgYHRoZW5gIG1ldGhvZCxcblx0ICAgICAgd2hpY2ggcmVnaXN0ZXJzIGNhbGxiYWNrcyB0byByZWNlaXZlIGVpdGhlciBhIHByb21pc2UncyBldmVudHVhbCB2YWx1ZSBvciB0aGVcblx0ICAgICAgcmVhc29uIHdoeSB0aGUgcHJvbWlzZSBjYW5ub3QgYmUgZnVsZmlsbGVkLlxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uKHVzZXIpe1xuXHQgICAgICAgIC8vIHVzZXIgaXMgYXZhaWxhYmxlXG5cdCAgICAgIH0sIGZ1bmN0aW9uKHJlYXNvbil7XG5cdCAgICAgICAgLy8gdXNlciBpcyB1bmF2YWlsYWJsZSwgYW5kIHlvdSBhcmUgZ2l2ZW4gdGhlIHJlYXNvbiB3aHlcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgQ2hhaW5pbmdcblx0ICAgICAgLS0tLS0tLS1cblx0ICAgICAgIFRoZSByZXR1cm4gdmFsdWUgb2YgYHRoZW5gIGlzIGl0c2VsZiBhIHByb21pc2UuICBUaGlzIHNlY29uZCwgJ2Rvd25zdHJlYW0nXG5cdCAgICAgIHByb21pc2UgaXMgcmVzb2x2ZWQgd2l0aCB0aGUgcmV0dXJuIHZhbHVlIG9mIHRoZSBmaXJzdCBwcm9taXNlJ3MgZnVsZmlsbG1lbnRcblx0ICAgICAgb3IgcmVqZWN0aW9uIGhhbmRsZXIsIG9yIHJlamVjdGVkIGlmIHRoZSBoYW5kbGVyIHRocm93cyBhbiBleGNlcHRpb24uXG5cdCAgICAgICBgYGBqc1xuXHQgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICByZXR1cm4gdXNlci5uYW1lO1xuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgcmV0dXJuICdkZWZhdWx0IG5hbWUnO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uICh1c2VyTmFtZSkge1xuXHQgICAgICAgIC8vIElmIGBmaW5kVXNlcmAgZnVsZmlsbGVkLCBgdXNlck5hbWVgIHdpbGwgYmUgdGhlIHVzZXIncyBuYW1lLCBvdGhlcndpc2UgaXRcblx0ICAgICAgICAvLyB3aWxsIGJlIGAnZGVmYXVsdCBuYW1lJ2Bcblx0ICAgICAgfSk7XG5cdCAgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ZvdW5kIHVzZXIsIGJ1dCBzdGlsbCB1bmhhcHB5Jyk7XG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknKTtcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAvLyBuZXZlciByZWFjaGVkXG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAvLyBpZiBgZmluZFVzZXJgIGZ1bGZpbGxlZCwgYHJlYXNvbmAgd2lsbCBiZSAnRm91bmQgdXNlciwgYnV0IHN0aWxsIHVuaGFwcHknLlxuXHQgICAgICAgIC8vIElmIGBmaW5kVXNlcmAgcmVqZWN0ZWQsIGByZWFzb25gIHdpbGwgYmUgJ2BmaW5kVXNlcmAgcmVqZWN0ZWQgYW5kIHdlJ3JlIHVuaGFwcHknLlxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgIElmIHRoZSBkb3duc3RyZWFtIHByb21pc2UgZG9lcyBub3Qgc3BlY2lmeSBhIHJlamVjdGlvbiBoYW5kbGVyLCByZWplY3Rpb24gcmVhc29ucyB3aWxsIGJlIHByb3BhZ2F0ZWQgZnVydGhlciBkb3duc3RyZWFtLlxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgdGhyb3cgbmV3IFBlZGFnb2dpY2FsRXhjZXB0aW9uKCdVcHN0cmVhbSBlcnJvcicpO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgIC8vIG5ldmVyIHJlYWNoZWRcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAodmFsdWUpIHtcblx0ICAgICAgICAvLyBuZXZlciByZWFjaGVkXG5cdCAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcblx0ICAgICAgICAvLyBUaGUgYFBlZGdhZ29jaWFsRXhjZXB0aW9uYCBpcyBwcm9wYWdhdGVkIGFsbCB0aGUgd2F5IGRvd24gdG8gaGVyZVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgICBBc3NpbWlsYXRpb25cblx0ICAgICAgLS0tLS0tLS0tLS0tXG5cdCAgICAgICBTb21ldGltZXMgdGhlIHZhbHVlIHlvdSB3YW50IHRvIHByb3BhZ2F0ZSB0byBhIGRvd25zdHJlYW0gcHJvbWlzZSBjYW4gb25seSBiZVxuXHQgICAgICByZXRyaWV2ZWQgYXN5bmNocm9ub3VzbHkuIFRoaXMgY2FuIGJlIGFjaGlldmVkIGJ5IHJldHVybmluZyBhIHByb21pc2UgaW4gdGhlXG5cdCAgICAgIGZ1bGZpbGxtZW50IG9yIHJlamVjdGlvbiBoYW5kbGVyLiBUaGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgdGhlbiBiZSBwZW5kaW5nXG5cdCAgICAgIHVudGlsIHRoZSByZXR1cm5lZCBwcm9taXNlIGlzIHNldHRsZWQuIFRoaXMgaXMgY2FsbGVkICphc3NpbWlsYXRpb24qLlxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFVzZXIoKS50aGVuKGZ1bmN0aW9uICh1c2VyKSB7XG5cdCAgICAgICAgcmV0dXJuIGZpbmRDb21tZW50c0J5QXV0aG9yKHVzZXIpO1xuXHQgICAgICB9KS50aGVuKGZ1bmN0aW9uIChjb21tZW50cykge1xuXHQgICAgICAgIC8vIFRoZSB1c2VyJ3MgY29tbWVudHMgYXJlIG5vdyBhdmFpbGFibGVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgSWYgdGhlIGFzc2ltbGlhdGVkIHByb21pc2UgcmVqZWN0cywgdGhlbiB0aGUgZG93bnN0cmVhbSBwcm9taXNlIHdpbGwgYWxzbyByZWplY3QuXG5cdCAgICAgICBgYGBqc1xuXHQgICAgICBmaW5kVXNlcigpLnRoZW4oZnVuY3Rpb24gKHVzZXIpIHtcblx0ICAgICAgICByZXR1cm4gZmluZENvbW1lbnRzQnlBdXRob3IodXNlcik7XG5cdCAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKGNvbW1lbnRzKSB7XG5cdCAgICAgICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCBmdWxmaWxscywgd2UnbGwgaGF2ZSB0aGUgdmFsdWUgaGVyZVxuXHQgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XG5cdCAgICAgICAgLy8gSWYgYGZpbmRDb21tZW50c0J5QXV0aG9yYCByZWplY3RzLCB3ZSdsbCBoYXZlIHRoZSByZWFzb24gaGVyZVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgICBTaW1wbGUgRXhhbXBsZVxuXHQgICAgICAtLS0tLS0tLS0tLS0tLVxuXHQgICAgICAgU3luY2hyb25vdXMgRXhhbXBsZVxuXHQgICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgcmVzdWx0O1xuXHQgICAgICAgdHJ5IHtcblx0ICAgICAgICByZXN1bHQgPSBmaW5kUmVzdWx0KCk7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9IGNhdGNoKHJlYXNvbikge1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfVxuXHQgICAgICBgYGBcblx0ICAgICAgIEVycmJhY2sgRXhhbXBsZVxuXHQgICAgICAgYGBganNcblx0ICAgICAgZmluZFJlc3VsdChmdW5jdGlvbihyZXN1bHQsIGVycil7XG5cdCAgICAgICAgaWYgKGVycikge1xuXHQgICAgICAgICAgLy8gZmFpbHVyZVxuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAvLyBzdWNjZXNzXG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgICBQcm9taXNlIEV4YW1wbGU7XG5cdCAgICAgICBgYGBqYXZhc2NyaXB0XG5cdCAgICAgIGZpbmRSZXN1bHQoKS50aGVuKGZ1bmN0aW9uKHJlc3VsdCl7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9LCBmdW5jdGlvbihyZWFzb24pe1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICAgQWR2YW5jZWQgRXhhbXBsZVxuXHQgICAgICAtLS0tLS0tLS0tLS0tLVxuXHQgICAgICAgU3luY2hyb25vdXMgRXhhbXBsZVxuXHQgICAgICAgYGBgamF2YXNjcmlwdFxuXHQgICAgICBsZXQgYXV0aG9yLCBib29rcztcblx0ICAgICAgIHRyeSB7XG5cdCAgICAgICAgYXV0aG9yID0gZmluZEF1dGhvcigpO1xuXHQgICAgICAgIGJvb2tzICA9IGZpbmRCb29rc0J5QXV0aG9yKGF1dGhvcik7XG5cdCAgICAgICAgLy8gc3VjY2Vzc1xuXHQgICAgICB9IGNhdGNoKHJlYXNvbikge1xuXHQgICAgICAgIC8vIGZhaWx1cmVcblx0ICAgICAgfVxuXHQgICAgICBgYGBcblx0ICAgICAgIEVycmJhY2sgRXhhbXBsZVxuXHQgICAgICAgYGBganNcblx0ICAgICAgIGZ1bmN0aW9uIGZvdW5kQm9va3MoYm9va3MpIHtcblx0ICAgICAgIH1cblx0ICAgICAgIGZ1bmN0aW9uIGZhaWx1cmUocmVhc29uKSB7XG5cdCAgICAgICB9XG5cdCAgICAgICBmaW5kQXV0aG9yKGZ1bmN0aW9uKGF1dGhvciwgZXJyKXtcblx0ICAgICAgICBpZiAoZXJyKSB7XG5cdCAgICAgICAgICBmYWlsdXJlKGVycik7XG5cdCAgICAgICAgICAvLyBmYWlsdXJlXG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgIGZpbmRCb29va3NCeUF1dGhvcihhdXRob3IsIGZ1bmN0aW9uKGJvb2tzLCBlcnIpIHtcblx0ICAgICAgICAgICAgICBpZiAoZXJyKSB7XG5cdCAgICAgICAgICAgICAgICBmYWlsdXJlKGVycik7XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICAgICAgICAgIGZvdW5kQm9va3MoYm9va3MpO1xuXHQgICAgICAgICAgICAgICAgfSBjYXRjaChyZWFzb24pIHtcblx0ICAgICAgICAgICAgICAgICAgZmFpbHVyZShyZWFzb24pO1xuXHQgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSk7XG5cdCAgICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cdCAgICAgICAgICAgIGZhaWx1cmUoZXJyKTtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICAgIC8vIHN1Y2Nlc3Ncblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgICBgYGBcblx0ICAgICAgIFByb21pc2UgRXhhbXBsZTtcblx0ICAgICAgIGBgYGphdmFzY3JpcHRcblx0ICAgICAgZmluZEF1dGhvcigpLlxuXHQgICAgICAgIHRoZW4oZmluZEJvb2tzQnlBdXRob3IpLlxuXHQgICAgICAgIHRoZW4oZnVuY3Rpb24oYm9va3Mpe1xuXHQgICAgICAgICAgLy8gZm91bmQgYm9va3Ncblx0ICAgICAgfSkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAvLyBzb21ldGhpbmcgd2VudCB3cm9uZ1xuXHQgICAgICB9KTtcblx0ICAgICAgYGBgXG5cdCAgICAgICBAbWV0aG9kIHRoZW5cblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25GdWxmaWxsZWRcblx0ICAgICAgQHBhcmFtIHtGdW5jdGlvbn0gb25SZWplY3RlZFxuXHQgICAgICBVc2VmdWwgZm9yIHRvb2xpbmcuXG5cdCAgICAgIEByZXR1cm4ge1Byb21pc2V9XG5cdCAgICAgICovXG5cblx0ICAgICAgLyoqXG5cdCAgICAgIGBjYXRjaGAgaXMgc2ltcGx5IHN1Z2FyIGZvciBgdGhlbih1bmRlZmluZWQsIG9uUmVqZWN0aW9uKWAgd2hpY2ggbWFrZXMgaXQgdGhlIHNhbWVcblx0ICAgICAgYXMgdGhlIGNhdGNoIGJsb2NrIG9mIGEgdHJ5L2NhdGNoIHN0YXRlbWVudC5cblx0ICAgICAgYGBganNcblx0ICAgICAgZnVuY3Rpb24gZmluZEF1dGhvcigpe1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkbid0IGZpbmQgdGhhdCBhdXRob3InKTtcblx0ICAgICAgfVxuXHQgICAgICAvLyBzeW5jaHJvbm91c1xuXHQgICAgICB0cnkge1xuXHQgICAgICBmaW5kQXV0aG9yKCk7XG5cdCAgICAgIH0gY2F0Y2gocmVhc29uKSB7XG5cdCAgICAgIC8vIHNvbWV0aGluZyB3ZW50IHdyb25nXG5cdCAgICAgIH1cblx0ICAgICAgLy8gYXN5bmMgd2l0aCBwcm9taXNlc1xuXHQgICAgICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgLy8gc29tZXRoaW5nIHdlbnQgd3Jvbmdcblx0ICAgICAgfSk7XG5cdCAgICAgIGBgYFxuXHQgICAgICBAbWV0aG9kIGNhdGNoXG5cdCAgICAgIEBwYXJhbSB7RnVuY3Rpb259IG9uUmVqZWN0aW9uXG5cdCAgICAgIFVzZWZ1bCBmb3IgdG9vbGluZy5cblx0ICAgICAgQHJldHVybiB7UHJvbWlzZX1cblx0ICAgICAgKi9cblxuXG5cdCAgICAgIFByb21pc2UucHJvdG90eXBlLmNhdGNoID0gZnVuY3Rpb24gX2NhdGNoKG9uUmVqZWN0aW9uKSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudGhlbihudWxsLCBvblJlamVjdGlvbik7XG5cdCAgICAgIH07XG5cdCAgICAgIC8qKlxuXHQgICAgICAgIGBmaW5hbGx5YCB3aWxsIGJlIGludm9rZWQgcmVnYXJkbGVzcyBvZiB0aGUgcHJvbWlzZSdzIGZhdGUganVzdCBhcyBuYXRpdmVcblx0ICAgICAgICB0cnkvY2F0Y2gvZmluYWxseSBiZWhhdmVzXG5cdCAgICAgIFxuXHQgICAgICAgIFN5bmNocm9ub3VzIGV4YW1wbGU6XG5cdCAgICAgIFxuXHQgICAgICAgIGBgYGpzXG5cdCAgICAgICAgZmluZEF1dGhvcigpIHtcblx0ICAgICAgICAgIGlmIChNYXRoLnJhbmRvbSgpID4gMC41KSB7XG5cdCAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAgcmV0dXJuIG5ldyBBdXRob3IoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIFxuXHQgICAgICAgIHRyeSB7XG5cdCAgICAgICAgICByZXR1cm4gZmluZEF1dGhvcigpOyAvLyBzdWNjZWVkIG9yIGZhaWxcblx0ICAgICAgICB9IGNhdGNoKGVycm9yKSB7XG5cdCAgICAgICAgICByZXR1cm4gZmluZE90aGVyQXV0aGVyKCk7XG5cdCAgICAgICAgfSBmaW5hbGx5IHtcblx0ICAgICAgICAgIC8vIGFsd2F5cyBydW5zXG5cdCAgICAgICAgICAvLyBkb2Vzbid0IGFmZmVjdCB0aGUgcmV0dXJuIHZhbHVlXG5cdCAgICAgICAgfVxuXHQgICAgICAgIGBgYFxuXHQgICAgICBcblx0ICAgICAgICBBc3luY2hyb25vdXMgZXhhbXBsZTpcblx0ICAgICAgXG5cdCAgICAgICAgYGBganNcblx0ICAgICAgICBmaW5kQXV0aG9yKCkuY2F0Y2goZnVuY3Rpb24ocmVhc29uKXtcblx0ICAgICAgICAgIHJldHVybiBmaW5kT3RoZXJBdXRoZXIoKTtcblx0ICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCl7XG5cdCAgICAgICAgICAvLyBhdXRob3Igd2FzIGVpdGhlciBmb3VuZCwgb3Igbm90XG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgYGBgXG5cdCAgICAgIFxuXHQgICAgICAgIEBtZXRob2QgZmluYWxseVxuXHQgICAgICAgIEBwYXJhbSB7RnVuY3Rpb259IGNhbGxiYWNrXG5cdCAgICAgICAgQHJldHVybiB7UHJvbWlzZX1cblx0ICAgICAgKi9cblxuXG5cdCAgICAgIFByb21pc2UucHJvdG90eXBlLmZpbmFsbHkgPSBmdW5jdGlvbiBfZmluYWxseShjYWxsYmFjaykge1xuXHQgICAgICAgIHZhciBwcm9taXNlID0gdGhpcztcblx0ICAgICAgICB2YXIgY29uc3RydWN0b3IgPSBwcm9taXNlLmNvbnN0cnVjdG9yO1xuXG5cdCAgICAgICAgaWYgKGlzRnVuY3Rpb24oY2FsbGJhY2spKSB7XG5cdCAgICAgICAgICByZXR1cm4gcHJvbWlzZS50aGVuKGZ1bmN0aW9uICh2YWx1ZSkge1xuXHQgICAgICAgICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICByZXR1cm4gdmFsdWU7XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xuXHQgICAgICAgICAgICByZXR1cm4gY29uc3RydWN0b3IucmVzb2x2ZShjYWxsYmFjaygpKS50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgICB0aHJvdyByZWFzb247XG5cdCAgICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0dXJuIHByb21pc2UudGhlbihjYWxsYmFjaywgY2FsbGJhY2spO1xuXHQgICAgICB9O1xuXG5cdCAgICAgIHJldHVybiBQcm9taXNlO1xuXHQgICAgfSgpO1xuXG5cdCAgICBQcm9taXNlJDEucHJvdG90eXBlLnRoZW4gPSB0aGVuO1xuXHQgICAgUHJvbWlzZSQxLmFsbCA9IGFsbDtcblx0ICAgIFByb21pc2UkMS5yYWNlID0gcmFjZTtcblx0ICAgIFByb21pc2UkMS5yZXNvbHZlID0gcmVzb2x2ZSQxO1xuXHQgICAgUHJvbWlzZSQxLnJlamVjdCA9IHJlamVjdCQxO1xuXHQgICAgUHJvbWlzZSQxLl9zZXRTY2hlZHVsZXIgPSBzZXRTY2hlZHVsZXI7XG5cdCAgICBQcm9taXNlJDEuX3NldEFzYXAgPSBzZXRBc2FwO1xuXHQgICAgUHJvbWlzZSQxLl9hc2FwID0gYXNhcDtcblx0ICAgIC8qZ2xvYmFsIHNlbGYqL1xuXG5cdCAgICBmdW5jdGlvbiBwb2x5ZmlsbCgpIHtcblx0ICAgICAgdmFyIGxvY2FsID0gdm9pZCAwO1xuXG5cdCAgICAgIGlmICh0eXBlb2YgY29tbW9uanNHbG9iYWwgIT09ICd1bmRlZmluZWQnKSB7XG5cdCAgICAgICAgbG9jYWwgPSBjb21tb25qc0dsb2JhbDtcblx0ICAgICAgfSBlbHNlIGlmICh0eXBlb2Ygc2VsZiAhPT0gJ3VuZGVmaW5lZCcpIHtcblx0ICAgICAgICBsb2NhbCA9IHNlbGY7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIGxvY2FsID0gRnVuY3Rpb24oJ3JldHVybiB0aGlzJykoKTtcblx0ICAgICAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ3BvbHlmaWxsIGZhaWxlZCBiZWNhdXNlIGdsb2JhbCBvYmplY3QgaXMgdW5hdmFpbGFibGUgaW4gdGhpcyBlbnZpcm9ubWVudCcpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciBQID0gbG9jYWwuUHJvbWlzZTtcblxuXHQgICAgICBpZiAoUCkge1xuXHQgICAgICAgIHZhciBwcm9taXNlVG9TdHJpbmcgPSBudWxsO1xuXG5cdCAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgIHByb21pc2VUb1N0cmluZyA9IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbChQLnJlc29sdmUoKSk7XG5cdCAgICAgICAgfSBjYXRjaCAoZSkgey8vIHNpbGVudGx5IGlnbm9yZWRcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBpZiAocHJvbWlzZVRvU3RyaW5nID09PSAnW29iamVjdCBQcm9taXNlXScgJiYgIVAuY2FzdCkge1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIGxvY2FsLlByb21pc2UgPSBQcm9taXNlJDE7XG5cdCAgICB9IC8vIFN0cmFuZ2UgY29tcGF0Li5cblxuXG5cdCAgICBQcm9taXNlJDEucG9seWZpbGwgPSBwb2x5ZmlsbDtcblx0ICAgIFByb21pc2UkMS5Qcm9taXNlID0gUHJvbWlzZSQxO1xuXHQgICAgcmV0dXJuIFByb21pc2UkMTtcblx0ICB9KTtcblx0fSk7XG5cblx0dmFyIFByb21pc2UkMSA9IHR5cGVvZiBQcm9taXNlICE9PSBcInVuZGVmaW5lZFwiID8gUHJvbWlzZSA6IGVzNlByb21pc2U7XG5cblx0ZnVuY3Rpb24gcmVnaXN0ZXJMb2dnaW5nQ2FsbGJhY2tzKG9iaikge1xuXHQgIHZhciBpLFxuXHQgICAgICBsLFxuXHQgICAgICBrZXksXG5cdCAgICAgIGNhbGxiYWNrTmFtZXMgPSBbXCJiZWdpblwiLCBcImRvbmVcIiwgXCJsb2dcIiwgXCJ0ZXN0U3RhcnRcIiwgXCJ0ZXN0RG9uZVwiLCBcIm1vZHVsZVN0YXJ0XCIsIFwibW9kdWxlRG9uZVwiXTtcblxuXHQgIGZ1bmN0aW9uIHJlZ2lzdGVyTG9nZ2luZ0NhbGxiYWNrKGtleSkge1xuXHQgICAgdmFyIGxvZ2dpbmdDYWxsYmFjayA9IGZ1bmN0aW9uIGxvZ2dpbmdDYWxsYmFjayhjYWxsYmFjaykge1xuXHQgICAgICBpZiAob2JqZWN0VHlwZShjYWxsYmFjaykgIT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlFVbml0IGxvZ2dpbmcgbWV0aG9kcyByZXF1aXJlIGEgY2FsbGJhY2sgZnVuY3Rpb24gYXMgdGhlaXIgZmlyc3QgcGFyYW1ldGVycy5cIik7XG5cdCAgICAgIH1cblxuXHQgICAgICBjb25maWcuY2FsbGJhY2tzW2tleV0ucHVzaChjYWxsYmFjayk7XG5cdCAgICB9O1xuXG5cdCAgICByZXR1cm4gbG9nZ2luZ0NhbGxiYWNrO1xuXHQgIH1cblxuXHQgIGZvciAoaSA9IDAsIGwgPSBjYWxsYmFja05hbWVzLmxlbmd0aDsgaSA8IGw7IGkrKykge1xuXHQgICAga2V5ID0gY2FsbGJhY2tOYW1lc1tpXTsgLy8gSW5pdGlhbGl6ZSBrZXkgY29sbGVjdGlvbiBvZiBsb2dnaW5nIGNhbGxiYWNrXG5cblx0ICAgIGlmIChvYmplY3RUeXBlKGNvbmZpZy5jYWxsYmFja3Nba2V5XSkgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0ICAgICAgY29uZmlnLmNhbGxiYWNrc1trZXldID0gW107XG5cdCAgICB9XG5cblx0ICAgIG9ialtrZXldID0gcmVnaXN0ZXJMb2dnaW5nQ2FsbGJhY2soa2V5KTtcblx0ICB9XG5cdH1cblx0ZnVuY3Rpb24gcnVuTG9nZ2luZ0NhbGxiYWNrcyhrZXksIGFyZ3MpIHtcblx0ICB2YXIgY2FsbGJhY2tzID0gY29uZmlnLmNhbGxiYWNrc1trZXldOyAvLyBIYW5kbGluZyAnbG9nJyBjYWxsYmFja3Mgc2VwYXJhdGVseS4gVW5saWtlIHRoZSBvdGhlciBjYWxsYmFja3MsXG5cdCAgLy8gdGhlIGxvZyBjYWxsYmFjayBpcyBub3QgY29udHJvbGxlZCBieSB0aGUgcHJvY2Vzc2luZyBxdWV1ZSxcblx0ICAvLyBidXQgcmF0aGVyIHVzZWQgYnkgYXNzZXJ0cy4gSGVuY2UgdG8gcHJvbWlzZnkgdGhlICdsb2cnIGNhbGxiYWNrXG5cdCAgLy8gd291bGQgbWVhbiBwcm9taXNmeWluZyBlYWNoIHN0ZXAgb2YgYSB0ZXN0XG5cblx0ICBpZiAoa2V5ID09PSBcImxvZ1wiKSB7XG5cdCAgICBjYWxsYmFja3MubWFwKGZ1bmN0aW9uIChjYWxsYmFjaykge1xuXHQgICAgICByZXR1cm4gY2FsbGJhY2soYXJncyk7XG5cdCAgICB9KTtcblx0ICAgIHJldHVybjtcblx0ICB9IC8vIGVuc3VyZSB0aGF0IGVhY2ggY2FsbGJhY2sgaXMgZXhlY3V0ZWQgc2VyaWFsbHlcblxuXG5cdCAgcmV0dXJuIGNhbGxiYWNrcy5yZWR1Y2UoZnVuY3Rpb24gKHByb21pc2VDaGFpbiwgY2FsbGJhY2spIHtcblx0ICAgIHJldHVybiBwcm9taXNlQ2hhaW4udGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBQcm9taXNlJDEucmVzb2x2ZShjYWxsYmFjayhhcmdzKSk7XG5cdCAgICB9KTtcblx0ICB9LCBQcm9taXNlJDEucmVzb2x2ZShbXSkpO1xuXHR9XG5cblx0Ly8gRG9lc24ndCBzdXBwb3J0IElFOSwgaXQgd2lsbCByZXR1cm4gdW5kZWZpbmVkIG9uIHRoZXNlIGJyb3dzZXJzXG5cdC8vIFNlZSBhbHNvIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuL0phdmFTY3JpcHQvUmVmZXJlbmNlL0dsb2JhbF9PYmplY3RzL0Vycm9yL1N0YWNrXG5cdHZhciBmaWxlTmFtZSA9IChzb3VyY2VGcm9tU3RhY2t0cmFjZSgwKSB8fCBcIlwiKS5yZXBsYWNlKC8oOlxcZCspK1xcKT8vLCBcIlwiKS5yZXBsYWNlKC8uK1xcLy8sIFwiXCIpO1xuXHRmdW5jdGlvbiBleHRyYWN0U3RhY2t0cmFjZShlLCBvZmZzZXQpIHtcblx0ICBvZmZzZXQgPSBvZmZzZXQgPT09IHVuZGVmaW5lZCA/IDQgOiBvZmZzZXQ7XG5cdCAgdmFyIHN0YWNrLCBpbmNsdWRlLCBpO1xuXG5cdCAgaWYgKGUgJiYgZS5zdGFjaykge1xuXHQgICAgc3RhY2sgPSBlLnN0YWNrLnNwbGl0KFwiXFxuXCIpO1xuXG5cdCAgICBpZiAoL15lcnJvciQvaS50ZXN0KHN0YWNrWzBdKSkge1xuXHQgICAgICBzdGFjay5zaGlmdCgpO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoZmlsZU5hbWUpIHtcblx0ICAgICAgaW5jbHVkZSA9IFtdO1xuXG5cdCAgICAgIGZvciAoaSA9IG9mZnNldDsgaSA8IHN0YWNrLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgaWYgKHN0YWNrW2ldLmluZGV4T2YoZmlsZU5hbWUpICE9PSAtMSkge1xuXHQgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgaW5jbHVkZS5wdXNoKHN0YWNrW2ldKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChpbmNsdWRlLmxlbmd0aCkge1xuXHQgICAgICAgIHJldHVybiBpbmNsdWRlLmpvaW4oXCJcXG5cIik7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgcmV0dXJuIHN0YWNrW29mZnNldF07XG5cdCAgfVxuXHR9XG5cdGZ1bmN0aW9uIHNvdXJjZUZyb21TdGFja3RyYWNlKG9mZnNldCkge1xuXHQgIHZhciBlcnJvciA9IG5ldyBFcnJvcigpOyAvLyBTdXBwb3J0OiBTYWZhcmkgPD03IG9ubHksIElFIDw9MTAgLSAxMSBvbmx5XG5cdCAgLy8gTm90IGFsbCBicm93c2VycyBnZW5lcmF0ZSB0aGUgYHN0YWNrYCBwcm9wZXJ0eSBmb3IgYG5ldyBFcnJvcigpYCwgc2VlIGFsc28gIzYzNlxuXG5cdCAgaWYgKCFlcnJvci5zdGFjaykge1xuXHQgICAgdHJ5IHtcblx0ICAgICAgdGhyb3cgZXJyb3I7XG5cdCAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgZXJyb3IgPSBlcnI7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgcmV0dXJuIGV4dHJhY3RTdGFja3RyYWNlKGVycm9yLCBvZmZzZXQpO1xuXHR9XG5cblx0dmFyIHByaW9yaXR5Q291bnQgPSAwO1xuXHR2YXIgdW5pdFNhbXBsZXI7IC8vIFRoaXMgaXMgYSBxdWV1ZSBvZiBmdW5jdGlvbnMgdGhhdCBhcmUgdGFza3Mgd2l0aGluIGEgc2luZ2xlIHRlc3QuXG5cdC8vIEFmdGVyIHRlc3RzIGFyZSBkZXF1ZXVlZCBmcm9tIGNvbmZpZy5xdWV1ZSB0aGV5IGFyZSBleHBhbmRlZCBpbnRvXG5cdC8vIGEgc2V0IG9mIHRhc2tzIGluIHRoaXMgcXVldWUuXG5cblx0dmFyIHRhc2tRdWV1ZSA9IFtdO1xuXHQvKipcblx0ICogQWR2YW5jZXMgdGhlIHRhc2tRdWV1ZSB0byB0aGUgbmV4dCB0YXNrLiBJZiB0aGUgdGFza1F1ZXVlIGlzIGVtcHR5LFxuXHQgKiBwcm9jZXNzIHRoZSB0ZXN0UXVldWVcblx0ICovXG5cblx0ZnVuY3Rpb24gYWR2YW5jZSgpIHtcblx0ICBhZHZhbmNlVGFza1F1ZXVlKCk7XG5cblx0ICBpZiAoIXRhc2tRdWV1ZS5sZW5ndGggJiYgIWNvbmZpZy5ibG9ja2luZyAmJiAhY29uZmlnLmN1cnJlbnQpIHtcblx0ICAgIGFkdmFuY2VUZXN0UXVldWUoKTtcblx0ICB9XG5cdH1cblx0LyoqXG5cdCAqIEFkdmFuY2VzIHRoZSB0YXNrUXVldWUgd2l0aCBhbiBpbmNyZWFzZWQgZGVwdGhcblx0ICovXG5cblxuXHRmdW5jdGlvbiBhZHZhbmNlVGFza1F1ZXVlKCkge1xuXHQgIHZhciBzdGFydCA9IG5vdygpO1xuXHQgIGNvbmZpZy5kZXB0aCA9IChjb25maWcuZGVwdGggfHwgMCkgKyAxO1xuXHQgIHByb2Nlc3NUYXNrUXVldWUoc3RhcnQpO1xuXHQgIGNvbmZpZy5kZXB0aC0tO1xuXHR9XG5cdC8qKlxuXHQgKiBQcm9jZXNzIHRoZSBmaXJzdCB0YXNrIG9uIHRoZSB0YXNrUXVldWUgYXMgYSBwcm9taXNlLlxuXHQgKiBFYWNoIHRhc2sgaXMgYSBmdW5jdGlvbiByZXR1cm5lZCBieSBodHRwczovL2dpdGh1Yi5jb20vcXVuaXRqcy9xdW5pdC9ibG9iL21hc3Rlci9zcmMvdGVzdC5qcyNMMzgxXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gcHJvY2Vzc1Rhc2tRdWV1ZShzdGFydCkge1xuXHQgIGlmICh0YXNrUXVldWUubGVuZ3RoICYmICFjb25maWcuYmxvY2tpbmcpIHtcblx0ICAgIHZhciBlbGFwc2VkVGltZSA9IG5vdygpIC0gc3RhcnQ7XG5cblx0ICAgIGlmICghZGVmaW5lZC5zZXRUaW1lb3V0IHx8IGNvbmZpZy51cGRhdGVSYXRlIDw9IDAgfHwgZWxhcHNlZFRpbWUgPCBjb25maWcudXBkYXRlUmF0ZSkge1xuXHQgICAgICB2YXIgdGFzayA9IHRhc2tRdWV1ZS5zaGlmdCgpO1xuXHQgICAgICBQcm9taXNlJDEucmVzb2x2ZSh0YXNrKCkpLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIGlmICghdGFza1F1ZXVlLmxlbmd0aCkge1xuXHQgICAgICAgICAgYWR2YW5jZSgpO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBwcm9jZXNzVGFza1F1ZXVlKHN0YXJ0KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH0pO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgc2V0VGltZW91dCQxKGFkdmFuY2UpO1xuXHQgICAgfVxuXHQgIH1cblx0fVxuXHQvKipcblx0ICogQWR2YW5jZSB0aGUgdGVzdFF1ZXVlIHRvIHRoZSBuZXh0IHRlc3QgdG8gcHJvY2Vzcy4gQ2FsbCBkb25lKCkgaWYgdGVzdFF1ZXVlIGNvbXBsZXRlcy5cblx0ICovXG5cblxuXHRmdW5jdGlvbiBhZHZhbmNlVGVzdFF1ZXVlKCkge1xuXHQgIGlmICghY29uZmlnLmJsb2NraW5nICYmICFjb25maWcucXVldWUubGVuZ3RoICYmIGNvbmZpZy5kZXB0aCA9PT0gMCkge1xuXHQgICAgZG9uZSgpO1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHZhciB0ZXN0VGFza3MgPSBjb25maWcucXVldWUuc2hpZnQoKTtcblx0ICBhZGRUb1Rhc2tRdWV1ZSh0ZXN0VGFza3MoKSk7XG5cblx0ICBpZiAocHJpb3JpdHlDb3VudCA+IDApIHtcblx0ICAgIHByaW9yaXR5Q291bnQtLTtcblx0ICB9XG5cblx0ICBhZHZhbmNlKCk7XG5cdH1cblx0LyoqXG5cdCAqIEVucXVldWUgdGhlIHRhc2tzIGZvciBhIHRlc3QgaW50byB0aGUgdGFzayBxdWV1ZS5cblx0ICogQHBhcmFtIHtBcnJheX0gdGFza3NBcnJheVxuXHQgKi9cblxuXG5cdGZ1bmN0aW9uIGFkZFRvVGFza1F1ZXVlKHRhc2tzQXJyYXkpIHtcblx0ICB0YXNrUXVldWUucHVzaC5hcHBseSh0YXNrUXVldWUsIF90b0NvbnN1bWFibGVBcnJheSh0YXNrc0FycmF5KSk7XG5cdH1cblx0LyoqXG5cdCAqIFJldHVybiB0aGUgbnVtYmVyIG9mIHRhc2tzIHJlbWFpbmluZyBpbiB0aGUgdGFzayBxdWV1ZSB0byBiZSBwcm9jZXNzZWQuXG5cdCAqIEByZXR1cm4ge051bWJlcn1cblx0ICovXG5cblxuXHRmdW5jdGlvbiB0YXNrUXVldWVMZW5ndGgoKSB7XG5cdCAgcmV0dXJuIHRhc2tRdWV1ZS5sZW5ndGg7XG5cdH1cblx0LyoqXG5cdCAqIEFkZHMgYSB0ZXN0IHRvIHRoZSBUZXN0UXVldWUgZm9yIGV4ZWN1dGlvbi5cblx0ICogQHBhcmFtIHtGdW5jdGlvbn0gdGVzdFRhc2tzRnVuY1xuXHQgKiBAcGFyYW0ge0Jvb2xlYW59IHByaW9yaXRpemVcblx0ICogQHBhcmFtIHtTdHJpbmd9IHNlZWRcblx0ICovXG5cblxuXHRmdW5jdGlvbiBhZGRUb1Rlc3RRdWV1ZSh0ZXN0VGFza3NGdW5jLCBwcmlvcml0aXplLCBzZWVkKSB7XG5cdCAgaWYgKHByaW9yaXRpemUpIHtcblx0ICAgIGNvbmZpZy5xdWV1ZS5zcGxpY2UocHJpb3JpdHlDb3VudCsrLCAwLCB0ZXN0VGFza3NGdW5jKTtcblx0ICB9IGVsc2UgaWYgKHNlZWQpIHtcblx0ICAgIGlmICghdW5pdFNhbXBsZXIpIHtcblx0ICAgICAgdW5pdFNhbXBsZXIgPSB1bml0U2FtcGxlckdlbmVyYXRvcihzZWVkKTtcblx0ICAgIH0gLy8gSW5zZXJ0IGludG8gYSByYW5kb20gcG9zaXRpb24gYWZ0ZXIgYWxsIHByaW9yaXRpemVkIGl0ZW1zXG5cblxuXHQgICAgdmFyIGluZGV4ID0gTWF0aC5mbG9vcih1bml0U2FtcGxlcigpICogKGNvbmZpZy5xdWV1ZS5sZW5ndGggLSBwcmlvcml0eUNvdW50ICsgMSkpO1xuXHQgICAgY29uZmlnLnF1ZXVlLnNwbGljZShwcmlvcml0eUNvdW50ICsgaW5kZXgsIDAsIHRlc3RUYXNrc0Z1bmMpO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBjb25maWcucXVldWUucHVzaCh0ZXN0VGFza3NGdW5jKTtcblx0ICB9XG5cdH1cblx0LyoqXG5cdCAqIENyZWF0ZXMgYSBzZWVkZWQgXCJzYW1wbGVcIiBnZW5lcmF0b3Igd2hpY2ggaXMgdXNlZCBmb3IgcmFuZG9taXppbmcgdGVzdHMuXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gdW5pdFNhbXBsZXJHZW5lcmF0b3Ioc2VlZCkge1xuXHQgIC8vIDMyLWJpdCB4b3JzaGlmdCwgcmVxdWlyZXMgb25seSBhIG5vbnplcm8gc2VlZFxuXHQgIC8vIGh0dHBzOi8vZXhjYW1lcmEuY29tL3NwaGlueC9hcnRpY2xlLXhvcnNoaWZ0Lmh0bWxcblx0ICB2YXIgc2FtcGxlID0gcGFyc2VJbnQoZ2VuZXJhdGVIYXNoKHNlZWQpLCAxNikgfHwgLTE7XG5cdCAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgIHNhbXBsZSBePSBzYW1wbGUgPDwgMTM7XG5cdCAgICBzYW1wbGUgXj0gc2FtcGxlID4+PiAxNztcblx0ICAgIHNhbXBsZSBePSBzYW1wbGUgPDwgNTsgLy8gRUNNQVNjcmlwdCBoYXMgbm8gdW5zaWduZWQgbnVtYmVyIHR5cGVcblxuXHQgICAgaWYgKHNhbXBsZSA8IDApIHtcblx0ICAgICAgc2FtcGxlICs9IDB4MTAwMDAwMDAwO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gc2FtcGxlIC8gMHgxMDAwMDAwMDA7XG5cdCAgfTtcblx0fVxuXHQvKipcblx0ICogVGhpcyBmdW5jdGlvbiBpcyBjYWxsZWQgd2hlbiB0aGUgUHJvY2Vzc2luZ1F1ZXVlIGlzIGRvbmUgcHJvY2Vzc2luZyBhbGxcblx0ICogaXRlbXMuIEl0IGhhbmRsZXMgZW1pdHRpbmcgdGhlIGZpbmFsIHJ1biBldmVudHMuXG5cdCAqL1xuXG5cblx0ZnVuY3Rpb24gZG9uZSgpIHtcblx0ICB2YXIgc3RvcmFnZSA9IGNvbmZpZy5zdG9yYWdlO1xuXHQgIFByb2Nlc3NpbmdRdWV1ZS5maW5pc2hlZCA9IHRydWU7XG5cdCAgdmFyIHJ1bnRpbWUgPSBub3coKSAtIGNvbmZpZy5zdGFydGVkO1xuXHQgIHZhciBwYXNzZWQgPSBjb25maWcuc3RhdHMuYWxsIC0gY29uZmlnLnN0YXRzLmJhZDtcblxuXHQgIGlmIChjb25maWcuc3RhdHMudGVzdENvdW50ID09PSAwKSB7XG5cdCAgICBpZiAoY29uZmlnLmZpbHRlciAmJiBjb25maWcuZmlsdGVyLmxlbmd0aCkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0ZXN0cyBtYXRjaGVkIHRoZSBmaWx0ZXIgXFxcIlwiLmNvbmNhdChjb25maWcuZmlsdGVyLCBcIlxcXCIuXCIpKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGNvbmZpZy5tb2R1bGUgJiYgY29uZmlnLm1vZHVsZS5sZW5ndGgpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKFwiTm8gdGVzdHMgbWF0Y2hlZCB0aGUgbW9kdWxlIFxcXCJcIi5jb25jYXQoY29uZmlnLm1vZHVsZSwgXCJcXFwiLlwiKSk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcubW9kdWxlSWQgJiYgY29uZmlnLm1vZHVsZUlkLmxlbmd0aCkge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0ZXN0cyBtYXRjaGVkIHRoZSBtb2R1bGVJZCBcXFwiXCIuY29uY2F0KGNvbmZpZy5tb2R1bGVJZCwgXCJcXFwiLlwiKSk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcudGVzdElkICYmIGNvbmZpZy50ZXN0SWQubGVuZ3RoKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcIk5vIHRlc3RzIG1hdGNoZWQgdGhlIHRlc3RJZCBcXFwiXCIuY29uY2F0KGNvbmZpZy50ZXN0SWQsIFwiXFxcIi5cIikpO1xuXHQgICAgfVxuXG5cdCAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyB0ZXN0cyB3ZXJlIHJ1bi5cIik7XG5cdCAgfVxuXG5cdCAgZW1pdChcInJ1bkVuZFwiLCBnbG9iYWxTdWl0ZS5lbmQodHJ1ZSkpO1xuXHQgIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJkb25lXCIsIHtcblx0ICAgIHBhc3NlZDogcGFzc2VkLFxuXHQgICAgZmFpbGVkOiBjb25maWcuc3RhdHMuYmFkLFxuXHQgICAgdG90YWw6IGNvbmZpZy5zdGF0cy5hbGwsXG5cdCAgICBydW50aW1lOiBydW50aW1lXG5cdCAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAvLyBDbGVhciBvd24gc3RvcmFnZSBpdGVtcyBpZiBhbGwgdGVzdHMgcGFzc2VkXG5cdCAgICBpZiAoc3RvcmFnZSAmJiBjb25maWcuc3RhdHMuYmFkID09PSAwKSB7XG5cdCAgICAgIGZvciAodmFyIGkgPSBzdG9yYWdlLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7XG5cdCAgICAgICAgdmFyIGtleSA9IHN0b3JhZ2Uua2V5KGkpO1xuXG5cdCAgICAgICAgaWYgKGtleS5pbmRleE9mKFwicXVuaXQtdGVzdC1cIikgPT09IDApIHtcblx0ICAgICAgICAgIHN0b3JhZ2UucmVtb3ZlSXRlbShrZXkpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0pO1xuXHR9XG5cblx0dmFyIFByb2Nlc3NpbmdRdWV1ZSA9IHtcblx0ICBmaW5pc2hlZDogZmFsc2UsXG5cdCAgYWRkOiBhZGRUb1Rlc3RRdWV1ZSxcblx0ICBhZHZhbmNlOiBhZHZhbmNlLFxuXHQgIHRhc2tDb3VudDogdGFza1F1ZXVlTGVuZ3RoXG5cdH07XG5cblx0dmFyIFRlc3RSZXBvcnQgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkge1xuXHQgIGZ1bmN0aW9uIFRlc3RSZXBvcnQobmFtZSwgc3VpdGUsIG9wdGlvbnMpIHtcblx0ICAgIF9jbGFzc0NhbGxDaGVjayh0aGlzLCBUZXN0UmVwb3J0KTtcblxuXHQgICAgdGhpcy5uYW1lID0gbmFtZTtcblx0ICAgIHRoaXMuc3VpdGVOYW1lID0gc3VpdGUubmFtZTtcblx0ICAgIHRoaXMuZnVsbE5hbWUgPSBzdWl0ZS5mdWxsTmFtZS5jb25jYXQobmFtZSk7XG5cdCAgICB0aGlzLnJ1bnRpbWUgPSAwO1xuXHQgICAgdGhpcy5hc3NlcnRpb25zID0gW107XG5cdCAgICB0aGlzLnNraXBwZWQgPSAhIW9wdGlvbnMuc2tpcDtcblx0ICAgIHRoaXMudG9kbyA9ICEhb3B0aW9ucy50b2RvO1xuXHQgICAgdGhpcy52YWxpZCA9IG9wdGlvbnMudmFsaWQ7XG5cdCAgICB0aGlzLl9zdGFydFRpbWUgPSAwO1xuXHQgICAgdGhpcy5fZW5kVGltZSA9IDA7XG5cdCAgICBzdWl0ZS5wdXNoVGVzdCh0aGlzKTtcblx0ICB9XG5cblx0ICBfY3JlYXRlQ2xhc3MoVGVzdFJlcG9ydCwgW3tcblx0ICAgIGtleTogXCJzdGFydFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN0YXJ0KHJlY29yZFRpbWUpIHtcblx0ICAgICAgaWYgKHJlY29yZFRpbWUpIHtcblx0ICAgICAgICB0aGlzLl9zdGFydFRpbWUgPSBwZXJmb3JtYW5jZU5vdygpO1xuXG5cdCAgICAgICAgaWYgKHBlcmZvcm1hbmNlKSB7XG5cdCAgICAgICAgICBwZXJmb3JtYW5jZS5tYXJrKFwicXVuaXRfdGVzdF9zdGFydFwiKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4ge1xuXHQgICAgICAgIG5hbWU6IHRoaXMubmFtZSxcblx0ICAgICAgICBzdWl0ZU5hbWU6IHRoaXMuc3VpdGVOYW1lLFxuXHQgICAgICAgIGZ1bGxOYW1lOiB0aGlzLmZ1bGxOYW1lLnNsaWNlKClcblx0ICAgICAgfTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZW5kXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZW5kKHJlY29yZFRpbWUpIHtcblx0ICAgICAgaWYgKHJlY29yZFRpbWUpIHtcblx0ICAgICAgICB0aGlzLl9lbmRUaW1lID0gcGVyZm9ybWFuY2VOb3coKTtcblxuXHQgICAgICAgIGlmIChwZXJmb3JtYW5jZSkge1xuXHQgICAgICAgICAgcGVyZm9ybWFuY2UubWFyayhcInF1bml0X3Rlc3RfZW5kXCIpO1xuXHQgICAgICAgICAgdmFyIHRlc3ROYW1lID0gdGhpcy5mdWxsTmFtZS5qb2luKFwiIOKAkyBcIik7XG5cdCAgICAgICAgICBtZWFzdXJlKFwiUVVuaXQgVGVzdDogXCIuY29uY2F0KHRlc3ROYW1lKSwgXCJxdW5pdF90ZXN0X3N0YXJ0XCIsIFwicXVuaXRfdGVzdF9lbmRcIik7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIGV4dGVuZCh0aGlzLnN0YXJ0KCksIHtcblx0ICAgICAgICBydW50aW1lOiB0aGlzLmdldFJ1bnRpbWUoKSxcblx0ICAgICAgICBzdGF0dXM6IHRoaXMuZ2V0U3RhdHVzKCksXG5cdCAgICAgICAgZXJyb3JzOiB0aGlzLmdldEZhaWxlZEFzc2VydGlvbnMoKSxcblx0ICAgICAgICBhc3NlcnRpb25zOiB0aGlzLmdldEFzc2VydGlvbnMoKVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicHVzaEFzc2VydGlvblwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHB1c2hBc3NlcnRpb24oYXNzZXJ0aW9uKSB7XG5cdCAgICAgIHRoaXMuYXNzZXJ0aW9ucy5wdXNoKGFzc2VydGlvbik7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImdldFJ1bnRpbWVcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBnZXRSdW50aW1lKCkge1xuXHQgICAgICByZXR1cm4gdGhpcy5fZW5kVGltZSAtIHRoaXMuX3N0YXJ0VGltZTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0U3RhdHVzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0U3RhdHVzKCkge1xuXHQgICAgICBpZiAodGhpcy5za2lwcGVkKSB7XG5cdCAgICAgICAgcmV0dXJuIFwic2tpcHBlZFwiO1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIHRlc3RQYXNzZWQgPSB0aGlzLmdldEZhaWxlZEFzc2VydGlvbnMoKS5sZW5ndGggPiAwID8gdGhpcy50b2RvIDogIXRoaXMudG9kbztcblxuXHQgICAgICBpZiAoIXRlc3RQYXNzZWQpIHtcblx0ICAgICAgICByZXR1cm4gXCJmYWlsZWRcIjtcblx0ICAgICAgfSBlbHNlIGlmICh0aGlzLnRvZG8pIHtcblx0ICAgICAgICByZXR1cm4gXCJ0b2RvXCI7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIFwicGFzc2VkXCI7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZ2V0RmFpbGVkQXNzZXJ0aW9uc1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIGdldEZhaWxlZEFzc2VydGlvbnMoKSB7XG5cdCAgICAgIHJldHVybiB0aGlzLmFzc2VydGlvbnMuZmlsdGVyKGZ1bmN0aW9uIChhc3NlcnRpb24pIHtcblx0ICAgICAgICByZXR1cm4gIWFzc2VydGlvbi5wYXNzZWQ7XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJnZXRBc3NlcnRpb25zXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gZ2V0QXNzZXJ0aW9ucygpIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuYXNzZXJ0aW9ucy5zbGljZSgpO1xuXHQgICAgfSAvLyBSZW1vdmUgYWN0dWFsIGFuZCBleHBlY3RlZCB2YWx1ZXMgZnJvbSBhc3NlcnRpb25zLiBUaGlzIGlzIHRvIHByZXZlbnRcblx0ICAgIC8vIGxlYWtpbmcgbWVtb3J5IHRocm91Z2hvdXQgYSB0ZXN0IHN1aXRlLlxuXG5cdCAgfSwge1xuXHQgICAga2V5OiBcInNsaW1Bc3NlcnRpb25zXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc2xpbUFzc2VydGlvbnMoKSB7XG5cdCAgICAgIHRoaXMuYXNzZXJ0aW9ucyA9IHRoaXMuYXNzZXJ0aW9ucy5tYXAoZnVuY3Rpb24gKGFzc2VydGlvbikge1xuXHQgICAgICAgIGRlbGV0ZSBhc3NlcnRpb24uYWN0dWFsO1xuXHQgICAgICAgIGRlbGV0ZSBhc3NlcnRpb24uZXhwZWN0ZWQ7XG5cdCAgICAgICAgcmV0dXJuIGFzc2VydGlvbjtcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfV0pO1xuXG5cdCAgcmV0dXJuIFRlc3RSZXBvcnQ7XG5cdH0oKTtcblxuXHR2YXIgZm9jdXNlZCQxID0gZmFsc2U7XG5cdGZ1bmN0aW9uIFRlc3Qoc2V0dGluZ3MpIHtcblx0ICB2YXIgaSwgbDtcblx0ICArK1Rlc3QuY291bnQ7XG5cdCAgdGhpcy5leHBlY3RlZCA9IG51bGw7XG5cdCAgdGhpcy5hc3NlcnRpb25zID0gW107XG5cdCAgdGhpcy5zZW1hcGhvcmUgPSAwO1xuXHQgIHRoaXMubW9kdWxlID0gY29uZmlnLmN1cnJlbnRNb2R1bGU7XG5cdCAgdGhpcy5zdGVwcyA9IFtdO1xuXHQgIHRoaXMudGltZW91dCA9IHVuZGVmaW5lZDtcblx0ICB0aGlzLmVycm9yRm9yU3RhY2sgPSBuZXcgRXJyb3IoKTsgLy8gSWYgYSBtb2R1bGUgaXMgc2tpcHBlZCwgYWxsIGl0cyB0ZXN0cyBhbmQgdGhlIHRlc3RzIG9mIHRoZSBjaGlsZCBzdWl0ZXNcblx0ICAvLyBzaG91bGQgYmUgdHJlYXRlZCBhcyBza2lwcGVkIGV2ZW4gaWYgdGhleSBhcmUgZGVmaW5lZCBhcyBgb25seWAgb3IgYHRvZG9gLlxuXHQgIC8vIEFzIGZvciBgdG9kb2AgbW9kdWxlLCBhbGwgaXRzIHRlc3RzIHdpbGwgYmUgdHJlYXRlZCBhcyBgdG9kb2AgZXhjZXB0IGZvclxuXHQgIC8vIHRlc3RzIGRlZmluZWQgYXMgYHNraXBgIHdoaWNoIHdpbGwgYmUgbGVmdCBpbnRhY3QuXG5cdCAgLy9cblx0ICAvLyBTbywgaWYgYSB0ZXN0IGlzIGRlZmluZWQgYXMgYHRvZG9gIGFuZCBpcyBpbnNpZGUgYSBza2lwcGVkIG1vZHVsZSwgd2Ugc2hvdWxkXG5cdCAgLy8gdGhlbiB0cmVhdCB0aGF0IHRlc3QgYXMgaWYgd2FzIGRlZmluZWQgYXMgYHNraXBgLlxuXG5cdCAgaWYgKHRoaXMubW9kdWxlLnNraXApIHtcblx0ICAgIHNldHRpbmdzLnNraXAgPSB0cnVlO1xuXHQgICAgc2V0dGluZ3MudG9kbyA9IGZhbHNlOyAvLyBTa2lwcGVkIHRlc3RzIHNob3VsZCBiZSBsZWZ0IGludGFjdFxuXHQgIH0gZWxzZSBpZiAodGhpcy5tb2R1bGUudG9kbyAmJiAhc2V0dGluZ3Muc2tpcCkge1xuXHQgICAgc2V0dGluZ3MudG9kbyA9IHRydWU7XG5cdCAgfVxuXG5cdCAgZXh0ZW5kKHRoaXMsIHNldHRpbmdzKTtcblx0ICB0aGlzLnRlc3RSZXBvcnQgPSBuZXcgVGVzdFJlcG9ydChzZXR0aW5ncy50ZXN0TmFtZSwgdGhpcy5tb2R1bGUuc3VpdGVSZXBvcnQsIHtcblx0ICAgIHRvZG86IHNldHRpbmdzLnRvZG8sXG5cdCAgICBza2lwOiBzZXR0aW5ncy5za2lwLFxuXHQgICAgdmFsaWQ6IHRoaXMudmFsaWQoKVxuXHQgIH0pOyAvLyBSZWdpc3RlciB1bmlxdWUgc3RyaW5nc1xuXG5cdCAgZm9yIChpID0gMCwgbCA9IHRoaXMubW9kdWxlLnRlc3RzOyBpIDwgbC5sZW5ndGg7IGkrKykge1xuXHQgICAgaWYgKHRoaXMubW9kdWxlLnRlc3RzW2ldLm5hbWUgPT09IHRoaXMudGVzdE5hbWUpIHtcblx0ICAgICAgdGhpcy50ZXN0TmFtZSArPSBcIiBcIjtcblx0ICAgIH1cblx0ICB9XG5cblx0ICB0aGlzLnRlc3RJZCA9IGdlbmVyYXRlSGFzaCh0aGlzLm1vZHVsZS5uYW1lLCB0aGlzLnRlc3ROYW1lKTtcblx0ICB0aGlzLm1vZHVsZS50ZXN0cy5wdXNoKHtcblx0ICAgIG5hbWU6IHRoaXMudGVzdE5hbWUsXG5cdCAgICB0ZXN0SWQ6IHRoaXMudGVzdElkLFxuXHQgICAgc2tpcDogISFzZXR0aW5ncy5za2lwXG5cdCAgfSk7XG5cblx0ICBpZiAoc2V0dGluZ3Muc2tpcCkge1xuXHQgICAgLy8gU2tpcHBlZCB0ZXN0cyB3aWxsIGZ1bGx5IGlnbm9yZSBhbnkgc2VudCBjYWxsYmFja1xuXHQgICAgdGhpcy5jYWxsYmFjayA9IGZ1bmN0aW9uICgpIHt9O1xuXG5cdCAgICB0aGlzLmFzeW5jID0gZmFsc2U7XG5cdCAgICB0aGlzLmV4cGVjdGVkID0gMDtcblx0ICB9IGVsc2Uge1xuXHQgICAgaWYgKHR5cGVvZiB0aGlzLmNhbGxiYWNrICE9PSBcImZ1bmN0aW9uXCIpIHtcblx0ICAgICAgdmFyIG1ldGhvZCA9IHRoaXMudG9kbyA/IFwidG9kb1wiIDogXCJ0ZXN0XCI7IC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBtYXgtbGVuXG5cblx0ICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcIllvdSBtdXN0IHByb3ZpZGUgYSBmdW5jdGlvbiBhcyBhIHRlc3QgY2FsbGJhY2sgdG8gUVVuaXQuXCIuY29uY2F0KG1ldGhvZCwgXCIoXFxcIlwiKS5jb25jYXQoc2V0dGluZ3MudGVzdE5hbWUsIFwiXFxcIilcIikpO1xuXHQgICAgfVxuXG5cdCAgICB0aGlzLmFzc2VydCA9IG5ldyBBc3NlcnQodGhpcyk7XG5cdCAgfVxuXHR9XG5cdFRlc3QuY291bnQgPSAwO1xuXG5cdGZ1bmN0aW9uIGdldE5vdFN0YXJ0ZWRNb2R1bGVzKHN0YXJ0TW9kdWxlKSB7XG5cdCAgdmFyIG1vZHVsZSA9IHN0YXJ0TW9kdWxlLFxuXHQgICAgICBtb2R1bGVzID0gW107XG5cblx0ICB3aGlsZSAobW9kdWxlICYmIG1vZHVsZS50ZXN0c1J1biA9PT0gMCkge1xuXHQgICAgbW9kdWxlcy5wdXNoKG1vZHVsZSk7XG5cdCAgICBtb2R1bGUgPSBtb2R1bGUucGFyZW50TW9kdWxlO1xuXHQgIH0gLy8gVGhlIGFib3ZlIHB1c2ggbW9kdWxlcyBmcm9tIHRoZSBjaGlsZCB0byB0aGUgcGFyZW50XG5cdCAgLy8gcmV0dXJuIGEgcmV2ZXJzZWQgb3JkZXIgd2l0aCB0aGUgdG9wIGJlaW5nIHRoZSB0b3AgbW9zdCBwYXJlbnQgbW9kdWxlXG5cblxuXHQgIHJldHVybiBtb2R1bGVzLnJldmVyc2UoKTtcblx0fVxuXG5cdFRlc3QucHJvdG90eXBlID0ge1xuXHQgIC8vIGdlbmVyYXRpbmcgYSBzdGFjayB0cmFjZSBjYW4gYmUgZXhwZW5zaXZlLCBzbyB1c2luZyBhIGdldHRlciBkZWZlcnMgdGhpcyB1bnRpbCB3ZSBuZWVkIGl0XG5cdCAgZ2V0IHN0YWNrKCkge1xuXHQgICAgcmV0dXJuIGV4dHJhY3RTdGFja3RyYWNlKHRoaXMuZXJyb3JGb3JTdGFjaywgMik7XG5cdCAgfSxcblxuXHQgIGJlZm9yZTogZnVuY3Rpb24gYmVmb3JlKCkge1xuXHQgICAgdmFyIF90aGlzID0gdGhpcztcblxuXHQgICAgdmFyIG1vZHVsZSA9IHRoaXMubW9kdWxlLFxuXHQgICAgICAgIG5vdFN0YXJ0ZWRNb2R1bGVzID0gZ2V0Tm90U3RhcnRlZE1vZHVsZXMobW9kdWxlKTsgLy8gZW5zdXJlIHRoZSBjYWxsYmFja3MgYXJlIGV4ZWN1dGVkIHNlcmlhbGx5IGZvciBlYWNoIG1vZHVsZVxuXG5cdCAgICB2YXIgY2FsbGJhY2tQcm9taXNlcyA9IG5vdFN0YXJ0ZWRNb2R1bGVzLnJlZHVjZShmdW5jdGlvbiAocHJvbWlzZUNoYWluLCBzdGFydE1vZHVsZSkge1xuXHQgICAgICByZXR1cm4gcHJvbWlzZUNoYWluLnRoZW4oZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHN0YXJ0TW9kdWxlLnN0YXRzID0ge1xuXHQgICAgICAgICAgYWxsOiAwLFxuXHQgICAgICAgICAgYmFkOiAwLFxuXHQgICAgICAgICAgc3RhcnRlZDogbm93KClcblx0ICAgICAgICB9O1xuXHQgICAgICAgIGVtaXQoXCJzdWl0ZVN0YXJ0XCIsIHN0YXJ0TW9kdWxlLnN1aXRlUmVwb3J0LnN0YXJ0KHRydWUpKTtcblx0ICAgICAgICByZXR1cm4gcnVuTG9nZ2luZ0NhbGxiYWNrcyhcIm1vZHVsZVN0YXJ0XCIsIHtcblx0ICAgICAgICAgIG5hbWU6IHN0YXJ0TW9kdWxlLm5hbWUsXG5cdCAgICAgICAgICB0ZXN0czogc3RhcnRNb2R1bGUudGVzdHNcblx0ICAgICAgICB9KTtcblx0ICAgICAgfSk7XG5cdCAgICB9LCBQcm9taXNlJDEucmVzb2x2ZShbXSkpO1xuXHQgICAgcmV0dXJuIGNhbGxiYWNrUHJvbWlzZXMudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGNvbmZpZy5jdXJyZW50ID0gX3RoaXM7XG5cdCAgICAgIF90aGlzLnRlc3RFbnZpcm9ubWVudCA9IGV4dGVuZCh7fSwgbW9kdWxlLnRlc3RFbnZpcm9ubWVudCk7XG5cdCAgICAgIF90aGlzLnN0YXJ0ZWQgPSBub3coKTtcblx0ICAgICAgZW1pdChcInRlc3RTdGFydFwiLCBfdGhpcy50ZXN0UmVwb3J0LnN0YXJ0KHRydWUpKTtcblx0ICAgICAgcmV0dXJuIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJ0ZXN0U3RhcnRcIiwge1xuXHQgICAgICAgIG5hbWU6IF90aGlzLnRlc3ROYW1lLFxuXHQgICAgICAgIG1vZHVsZTogbW9kdWxlLm5hbWUsXG5cdCAgICAgICAgdGVzdElkOiBfdGhpcy50ZXN0SWQsXG5cdCAgICAgICAgcHJldmlvdXNGYWlsdXJlOiBfdGhpcy5wcmV2aW91c0ZhaWx1cmVcblx0ICAgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKCFjb25maWcucG9sbHV0aW9uKSB7XG5cdCAgICAgICAgICBzYXZlR2xvYmFsKCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9KTtcblx0ICAgIH0pO1xuXHQgIH0sXG5cdCAgcnVuOiBmdW5jdGlvbiBydW4oKSB7XG5cdCAgICB2YXIgcHJvbWlzZTtcblx0ICAgIGNvbmZpZy5jdXJyZW50ID0gdGhpcztcblx0ICAgIHRoaXMuY2FsbGJhY2tTdGFydGVkID0gbm93KCk7XG5cblx0ICAgIGlmIChjb25maWcubm90cnljYXRjaCkge1xuXHQgICAgICBydW5UZXN0KHRoaXMpO1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cblx0ICAgIHRyeSB7XG5cdCAgICAgIHJ1blRlc3QodGhpcyk7XG5cdCAgICB9IGNhdGNoIChlKSB7XG5cdCAgICAgIHRoaXMucHVzaEZhaWx1cmUoXCJEaWVkIG9uIHRlc3QgI1wiICsgKHRoaXMuYXNzZXJ0aW9ucy5sZW5ndGggKyAxKSArIFwiIFwiICsgdGhpcy5zdGFjayArIFwiOiBcIiArIChlLm1lc3NhZ2UgfHwgZSksIGV4dHJhY3RTdGFja3RyYWNlKGUsIDApKTsgLy8gRWxzZSBuZXh0IHRlc3Qgd2lsbCBjYXJyeSB0aGUgcmVzcG9uc2liaWxpdHlcblxuXHQgICAgICBzYXZlR2xvYmFsKCk7IC8vIFJlc3RhcnQgdGhlIHRlc3RzIGlmIHRoZXkncmUgYmxvY2tpbmdcblxuXHQgICAgICBpZiAoY29uZmlnLmJsb2NraW5nKSB7XG5cdCAgICAgICAgaW50ZXJuYWxSZWNvdmVyKHRoaXMpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGZ1bmN0aW9uIHJ1blRlc3QodGVzdCkge1xuXHQgICAgICBwcm9taXNlID0gdGVzdC5jYWxsYmFjay5jYWxsKHRlc3QudGVzdEVudmlyb25tZW50LCB0ZXN0LmFzc2VydCk7XG5cdCAgICAgIHRlc3QucmVzb2x2ZVByb21pc2UocHJvbWlzZSk7IC8vIElmIHRoZSB0ZXN0IGhhcyBhIFwibG9ja1wiIG9uIGl0LCBidXQgdGhlIHRpbWVvdXQgaXMgMCwgdGhlbiB3ZSBwdXNoIGFcblx0ICAgICAgLy8gZmFpbHVyZSBhcyB0aGUgdGVzdCBzaG91bGQgYmUgc3luY2hyb25vdXMuXG5cblx0ICAgICAgaWYgKHRlc3QudGltZW91dCA9PT0gMCAmJiB0ZXN0LnNlbWFwaG9yZSAhPT0gMCkge1xuXHQgICAgICAgIHB1c2hGYWlsdXJlKFwiVGVzdCBkaWQgbm90IGZpbmlzaCBzeW5jaHJvbm91c2x5IGV2ZW4gdGhvdWdoIGFzc2VydC50aW1lb3V0KCAwICkgd2FzIHVzZWQuXCIsIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0sXG5cdCAgYWZ0ZXI6IGZ1bmN0aW9uIGFmdGVyKCkge1xuXHQgICAgY2hlY2tQb2xsdXRpb24oKTtcblx0ICB9LFxuXHQgIHF1ZXVlSG9vazogZnVuY3Rpb24gcXVldWVIb29rKGhvb2ssIGhvb2tOYW1lLCBob29rT3duZXIpIHtcblx0ICAgIHZhciBfdGhpczIgPSB0aGlzO1xuXG5cdCAgICB2YXIgY2FsbEhvb2sgPSBmdW5jdGlvbiBjYWxsSG9vaygpIHtcblx0ICAgICAgdmFyIHByb21pc2UgPSBob29rLmNhbGwoX3RoaXMyLnRlc3RFbnZpcm9ubWVudCwgX3RoaXMyLmFzc2VydCk7XG5cblx0ICAgICAgX3RoaXMyLnJlc29sdmVQcm9taXNlKHByb21pc2UsIGhvb2tOYW1lKTtcblx0ICAgIH07XG5cblx0ICAgIHZhciBydW5Ib29rID0gZnVuY3Rpb24gcnVuSG9vaygpIHtcblx0ICAgICAgaWYgKGhvb2tOYW1lID09PSBcImJlZm9yZVwiKSB7XG5cdCAgICAgICAgaWYgKGhvb2tPd25lci51bnNraXBwZWRUZXN0c1J1biAhPT0gMCkge1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIF90aGlzMi5wcmVzZXJ2ZUVudmlyb25tZW50ID0gdHJ1ZTtcblx0ICAgICAgfSAvLyBUaGUgJ2FmdGVyJyBob29rIHNob3VsZCBvbmx5IGV4ZWN1dGUgd2hlbiB0aGVyZSBhcmUgbm90IHRlc3RzIGxlZnQgYW5kXG5cdCAgICAgIC8vIHdoZW4gdGhlICdhZnRlcicgYW5kICdmaW5pc2gnIHRhc2tzIGFyZSB0aGUgb25seSB0YXNrcyBsZWZ0IHRvIHByb2Nlc3NcblxuXG5cdCAgICAgIGlmIChob29rTmFtZSA9PT0gXCJhZnRlclwiICYmIGhvb2tPd25lci51bnNraXBwZWRUZXN0c1J1biAhPT0gbnVtYmVyT2ZVbnNraXBwZWRUZXN0cyhob29rT3duZXIpIC0gMSAmJiAoY29uZmlnLnF1ZXVlLmxlbmd0aCA+IDAgfHwgUHJvY2Vzc2luZ1F1ZXVlLnRhc2tDb3VudCgpID4gMikpIHtcblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblxuXHQgICAgICBjb25maWcuY3VycmVudCA9IF90aGlzMjtcblxuXHQgICAgICBpZiAoY29uZmlnLm5vdHJ5Y2F0Y2gpIHtcblx0ICAgICAgICBjYWxsSG9vaygpO1xuXHQgICAgICAgIHJldHVybjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHRyeSB7XG5cdCAgICAgICAgY2FsbEhvb2soKTtcblx0ICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcblx0ICAgICAgICBfdGhpczIucHVzaEZhaWx1cmUoaG9va05hbWUgKyBcIiBmYWlsZWQgb24gXCIgKyBfdGhpczIudGVzdE5hbWUgKyBcIjogXCIgKyAoZXJyb3IubWVzc2FnZSB8fCBlcnJvciksIGV4dHJhY3RTdGFja3RyYWNlKGVycm9yLCAwKSk7XG5cdCAgICAgIH1cblx0ICAgIH07XG5cblx0ICAgIHJldHVybiBydW5Ib29rO1xuXHQgIH0sXG5cdCAgLy8gQ3VycmVudGx5IG9ubHkgdXNlZCBmb3IgbW9kdWxlIGxldmVsIGhvb2tzLCBjYW4gYmUgdXNlZCB0byBhZGQgZ2xvYmFsIGxldmVsIG9uZXNcblx0ICBob29rczogZnVuY3Rpb24gaG9va3MoaGFuZGxlcikge1xuXHQgICAgdmFyIGhvb2tzID0gW107XG5cblx0ICAgIGZ1bmN0aW9uIHByb2Nlc3NIb29rcyh0ZXN0LCBtb2R1bGUpIHtcblx0ICAgICAgaWYgKG1vZHVsZS5wYXJlbnRNb2R1bGUpIHtcblx0ICAgICAgICBwcm9jZXNzSG9va3ModGVzdCwgbW9kdWxlLnBhcmVudE1vZHVsZSk7XG5cdCAgICAgIH1cblxuXHQgICAgICBpZiAobW9kdWxlLmhvb2tzW2hhbmRsZXJdLmxlbmd0aCkge1xuXHQgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbW9kdWxlLmhvb2tzW2hhbmRsZXJdLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgICAgICBob29rcy5wdXNoKHRlc3QucXVldWVIb29rKG1vZHVsZS5ob29rc1toYW5kbGVyXVtpXSwgaGFuZGxlciwgbW9kdWxlKSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9IC8vIEhvb2tzIGFyZSBpZ25vcmVkIG9uIHNraXBwZWQgdGVzdHNcblxuXG5cdCAgICBpZiAoIXRoaXMuc2tpcCkge1xuXHQgICAgICBwcm9jZXNzSG9va3ModGhpcywgdGhpcy5tb2R1bGUpO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gaG9va3M7XG5cdCAgfSxcblx0ICBmaW5pc2g6IGZ1bmN0aW9uIGZpbmlzaCgpIHtcblx0ICAgIGNvbmZpZy5jdXJyZW50ID0gdGhpczsgLy8gUmVsZWFzZSB0aGUgdGVzdCBjYWxsYmFjayB0byBlbnN1cmUgdGhhdCBhbnl0aGluZyByZWZlcmVuY2VkIGhhcyBiZWVuXG5cdCAgICAvLyByZWxlYXNlZCB0byBiZSBnYXJiYWdlIGNvbGxlY3RlZC5cblxuXHQgICAgdGhpcy5jYWxsYmFjayA9IHVuZGVmaW5lZDtcblxuXHQgICAgaWYgKHRoaXMuc3RlcHMubGVuZ3RoKSB7XG5cdCAgICAgIHZhciBzdGVwc0xpc3QgPSB0aGlzLnN0ZXBzLmpvaW4oXCIsIFwiKTtcblx0ICAgICAgdGhpcy5wdXNoRmFpbHVyZShcIkV4cGVjdGVkIGFzc2VydC52ZXJpZnlTdGVwcygpIHRvIGJlIGNhbGxlZCBiZWZvcmUgZW5kIG9mIHRlc3QgXCIgKyBcImFmdGVyIHVzaW5nIGFzc2VydC5zdGVwKCkuIFVudmVyaWZpZWQgc3RlcHM6IFwiLmNvbmNhdChzdGVwc0xpc3QpLCB0aGlzLnN0YWNrKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGNvbmZpZy5yZXF1aXJlRXhwZWN0cyAmJiB0aGlzLmV4cGVjdGVkID09PSBudWxsKSB7XG5cdCAgICAgIHRoaXMucHVzaEZhaWx1cmUoXCJFeHBlY3RlZCBudW1iZXIgb2YgYXNzZXJ0aW9ucyB0byBiZSBkZWZpbmVkLCBidXQgZXhwZWN0KCkgd2FzIFwiICsgXCJub3QgY2FsbGVkLlwiLCB0aGlzLnN0YWNrKTtcblx0ICAgIH0gZWxzZSBpZiAodGhpcy5leHBlY3RlZCAhPT0gbnVsbCAmJiB0aGlzLmV4cGVjdGVkICE9PSB0aGlzLmFzc2VydGlvbnMubGVuZ3RoKSB7XG5cdCAgICAgIHRoaXMucHVzaEZhaWx1cmUoXCJFeHBlY3RlZCBcIiArIHRoaXMuZXhwZWN0ZWQgKyBcIiBhc3NlcnRpb25zLCBidXQgXCIgKyB0aGlzLmFzc2VydGlvbnMubGVuZ3RoICsgXCIgd2VyZSBydW5cIiwgdGhpcy5zdGFjayk7XG5cdCAgICB9IGVsc2UgaWYgKHRoaXMuZXhwZWN0ZWQgPT09IG51bGwgJiYgIXRoaXMuYXNzZXJ0aW9ucy5sZW5ndGgpIHtcblx0ICAgICAgdGhpcy5wdXNoRmFpbHVyZShcIkV4cGVjdGVkIGF0IGxlYXN0IG9uZSBhc3NlcnRpb24sIGJ1dCBub25lIHdlcmUgcnVuIC0gY2FsbCBcIiArIFwiZXhwZWN0KDApIHRvIGFjY2VwdCB6ZXJvIGFzc2VydGlvbnMuXCIsIHRoaXMuc3RhY2spO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgaSxcblx0ICAgICAgICBtb2R1bGUgPSB0aGlzLm1vZHVsZSxcblx0ICAgICAgICBtb2R1bGVOYW1lID0gbW9kdWxlLm5hbWUsXG5cdCAgICAgICAgdGVzdE5hbWUgPSB0aGlzLnRlc3ROYW1lLFxuXHQgICAgICAgIHNraXBwZWQgPSAhIXRoaXMuc2tpcCxcblx0ICAgICAgICB0b2RvID0gISF0aGlzLnRvZG8sXG5cdCAgICAgICAgYmFkID0gMCxcblx0ICAgICAgICBzdG9yYWdlID0gY29uZmlnLnN0b3JhZ2U7XG5cdCAgICB0aGlzLnJ1bnRpbWUgPSBub3coKSAtIHRoaXMuc3RhcnRlZDtcblx0ICAgIGNvbmZpZy5zdGF0cy5hbGwgKz0gdGhpcy5hc3NlcnRpb25zLmxlbmd0aDtcblx0ICAgIGNvbmZpZy5zdGF0cy50ZXN0Q291bnQgKz0gMTtcblx0ICAgIG1vZHVsZS5zdGF0cy5hbGwgKz0gdGhpcy5hc3NlcnRpb25zLmxlbmd0aDtcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IHRoaXMuYXNzZXJ0aW9ucy5sZW5ndGg7IGkrKykge1xuXHQgICAgICBpZiAoIXRoaXMuYXNzZXJ0aW9uc1tpXS5yZXN1bHQpIHtcblx0ICAgICAgICBiYWQrKztcblx0ICAgICAgICBjb25maWcuc3RhdHMuYmFkKys7XG5cdCAgICAgICAgbW9kdWxlLnN0YXRzLmJhZCsrO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIG5vdGlmeVRlc3RzUmFuKG1vZHVsZSwgc2tpcHBlZCk7IC8vIFN0b3JlIHJlc3VsdCB3aGVuIHBvc3NpYmxlXG5cblx0ICAgIGlmIChzdG9yYWdlKSB7XG5cdCAgICAgIGlmIChiYWQpIHtcblx0ICAgICAgICBzdG9yYWdlLnNldEl0ZW0oXCJxdW5pdC10ZXN0LVwiICsgbW9kdWxlTmFtZSArIFwiLVwiICsgdGVzdE5hbWUsIGJhZCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgc3RvcmFnZS5yZW1vdmVJdGVtKFwicXVuaXQtdGVzdC1cIiArIG1vZHVsZU5hbWUgKyBcIi1cIiArIHRlc3ROYW1lKTtcblx0ICAgICAgfVxuXHQgICAgfSAvLyBBZnRlciBlbWl0dGluZyB0aGUganMtcmVwb3J0ZXJzIGV2ZW50IHdlIGNsZWFudXAgdGhlIGFzc2VydGlvbiBkYXRhIHRvXG5cdCAgICAvLyBhdm9pZCBsZWFraW5nIGl0LiBJdCBpcyBub3QgdXNlZCBieSB0aGUgbGVnYWN5IHRlc3REb25lIGNhbGxiYWNrcy5cblxuXG5cdCAgICBlbWl0KFwidGVzdEVuZFwiLCB0aGlzLnRlc3RSZXBvcnQuZW5kKHRydWUpKTtcblx0ICAgIHRoaXMudGVzdFJlcG9ydC5zbGltQXNzZXJ0aW9ucygpO1xuXHQgICAgdmFyIHRlc3QgPSB0aGlzO1xuXHQgICAgcmV0dXJuIHJ1bkxvZ2dpbmdDYWxsYmFja3MoXCJ0ZXN0RG9uZVwiLCB7XG5cdCAgICAgIG5hbWU6IHRlc3ROYW1lLFxuXHQgICAgICBtb2R1bGU6IG1vZHVsZU5hbWUsXG5cdCAgICAgIHNraXBwZWQ6IHNraXBwZWQsXG5cdCAgICAgIHRvZG86IHRvZG8sXG5cdCAgICAgIGZhaWxlZDogYmFkLFxuXHQgICAgICBwYXNzZWQ6IHRoaXMuYXNzZXJ0aW9ucy5sZW5ndGggLSBiYWQsXG5cdCAgICAgIHRvdGFsOiB0aGlzLmFzc2VydGlvbnMubGVuZ3RoLFxuXHQgICAgICBydW50aW1lOiBza2lwcGVkID8gMCA6IHRoaXMucnVudGltZSxcblx0ICAgICAgLy8gSFRNTCBSZXBvcnRlciB1c2Vcblx0ICAgICAgYXNzZXJ0aW9uczogdGhpcy5hc3NlcnRpb25zLFxuXHQgICAgICB0ZXN0SWQ6IHRoaXMudGVzdElkLFxuXG5cdCAgICAgIC8vIFNvdXJjZSBvZiBUZXN0XG5cdCAgICAgIC8vIGdlbmVyYXRpbmcgc3RhY2sgdHJhY2UgaXMgZXhwZW5zaXZlLCBzbyB1c2luZyBhIGdldHRlciB3aWxsIGhlbHAgZGVmZXIgdGhpcyB1bnRpbCB3ZSBuZWVkIGl0XG5cdCAgICAgIGdldCBzb3VyY2UoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRlc3Quc3RhY2s7XG5cdCAgICAgIH1cblxuXHQgICAgfSkudGhlbihmdW5jdGlvbiAoKSB7XG5cdCAgICAgIGlmIChtb2R1bGUudGVzdHNSdW4gPT09IG51bWJlck9mVGVzdHMobW9kdWxlKSkge1xuXHQgICAgICAgIHZhciBjb21wbGV0ZWRNb2R1bGVzID0gW21vZHVsZV07IC8vIENoZWNrIGlmIHRoZSBwYXJlbnQgbW9kdWxlcywgaXRlcmF0aXZlbHksIGFyZSBkb25lLiBJZiB0aGF0IHRoZSBjYXNlLFxuXHQgICAgICAgIC8vIHdlIGVtaXQgdGhlIGBzdWl0ZUVuZGAgZXZlbnQgYW5kIHRyaWdnZXIgYG1vZHVsZURvbmVgIGNhbGxiYWNrLlxuXG5cdCAgICAgICAgdmFyIHBhcmVudCA9IG1vZHVsZS5wYXJlbnRNb2R1bGU7XG5cblx0ICAgICAgICB3aGlsZSAocGFyZW50ICYmIHBhcmVudC50ZXN0c1J1biA9PT0gbnVtYmVyT2ZUZXN0cyhwYXJlbnQpKSB7XG5cdCAgICAgICAgICBjb21wbGV0ZWRNb2R1bGVzLnB1c2gocGFyZW50KTtcblx0ICAgICAgICAgIHBhcmVudCA9IHBhcmVudC5wYXJlbnRNb2R1bGU7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcmV0dXJuIGNvbXBsZXRlZE1vZHVsZXMucmVkdWNlKGZ1bmN0aW9uIChwcm9taXNlQ2hhaW4sIGNvbXBsZXRlZE1vZHVsZSkge1xuXHQgICAgICAgICAgcmV0dXJuIHByb21pc2VDaGFpbi50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgICAgcmV0dXJuIGxvZ1N1aXRlRW5kKGNvbXBsZXRlZE1vZHVsZSk7XG5cdCAgICAgICAgICB9KTtcblx0ICAgICAgICB9LCBQcm9taXNlJDEucmVzb2x2ZShbXSkpO1xuXHQgICAgICB9XG5cdCAgICB9KS50aGVuKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgY29uZmlnLmN1cnJlbnQgPSB1bmRlZmluZWQ7XG5cdCAgICB9KTtcblxuXHQgICAgZnVuY3Rpb24gbG9nU3VpdGVFbmQobW9kdWxlKSB7XG5cdCAgICAgIC8vIFJlc2V0IGBtb2R1bGUuaG9va3NgIHRvIGVuc3VyZSB0aGF0IGFueXRoaW5nIHJlZmVyZW5jZWQgaW4gdGhlc2UgaG9va3Ncblx0ICAgICAgLy8gaGFzIGJlZW4gcmVsZWFzZWQgdG8gYmUgZ2FyYmFnZSBjb2xsZWN0ZWQuXG5cdCAgICAgIG1vZHVsZS5ob29rcyA9IHt9O1xuXHQgICAgICBlbWl0KFwic3VpdGVFbmRcIiwgbW9kdWxlLnN1aXRlUmVwb3J0LmVuZCh0cnVlKSk7XG5cdCAgICAgIHJldHVybiBydW5Mb2dnaW5nQ2FsbGJhY2tzKFwibW9kdWxlRG9uZVwiLCB7XG5cdCAgICAgICAgbmFtZTogbW9kdWxlLm5hbWUsXG5cdCAgICAgICAgdGVzdHM6IG1vZHVsZS50ZXN0cyxcblx0ICAgICAgICBmYWlsZWQ6IG1vZHVsZS5zdGF0cy5iYWQsXG5cdCAgICAgICAgcGFzc2VkOiBtb2R1bGUuc3RhdHMuYWxsIC0gbW9kdWxlLnN0YXRzLmJhZCxcblx0ICAgICAgICB0b3RhbDogbW9kdWxlLnN0YXRzLmFsbCxcblx0ICAgICAgICBydW50aW1lOiBub3coKSAtIG1vZHVsZS5zdGF0cy5zdGFydGVkXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sXG5cdCAgcHJlc2VydmVUZXN0RW52aXJvbm1lbnQ6IGZ1bmN0aW9uIHByZXNlcnZlVGVzdEVudmlyb25tZW50KCkge1xuXHQgICAgaWYgKHRoaXMucHJlc2VydmVFbnZpcm9ubWVudCkge1xuXHQgICAgICB0aGlzLm1vZHVsZS50ZXN0RW52aXJvbm1lbnQgPSB0aGlzLnRlc3RFbnZpcm9ubWVudDtcblx0ICAgICAgdGhpcy50ZXN0RW52aXJvbm1lbnQgPSBleHRlbmQoe30sIHRoaXMubW9kdWxlLnRlc3RFbnZpcm9ubWVudCk7XG5cdCAgICB9XG5cdCAgfSxcblx0ICBxdWV1ZTogZnVuY3Rpb24gcXVldWUoKSB7XG5cdCAgICB2YXIgdGVzdCA9IHRoaXM7XG5cblx0ICAgIGlmICghdGhpcy52YWxpZCgpKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gcnVuVGVzdCgpIHtcblx0ICAgICAgcmV0dXJuIFtmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgcmV0dXJuIHRlc3QuYmVmb3JlKCk7XG5cdCAgICAgIH1dLmNvbmNhdChfdG9Db25zdW1hYmxlQXJyYXkodGVzdC5ob29rcyhcImJlZm9yZVwiKSksIFtmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdGVzdC5wcmVzZXJ2ZVRlc3RFbnZpcm9ubWVudCgpO1xuXHQgICAgICB9XSwgX3RvQ29uc3VtYWJsZUFycmF5KHRlc3QuaG9va3MoXCJiZWZvcmVFYWNoXCIpKSwgW2Z1bmN0aW9uICgpIHtcblx0ICAgICAgICB0ZXN0LnJ1bigpO1xuXHQgICAgICB9XSwgX3RvQ29uc3VtYWJsZUFycmF5KHRlc3QuaG9va3MoXCJhZnRlckVhY2hcIikucmV2ZXJzZSgpKSwgX3RvQ29uc3VtYWJsZUFycmF5KHRlc3QuaG9va3MoXCJhZnRlclwiKS5yZXZlcnNlKCkpLCBbZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHRlc3QuYWZ0ZXIoKTtcblx0ICAgICAgfSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgIHJldHVybiB0ZXN0LmZpbmlzaCgpO1xuXHQgICAgICB9XSk7XG5cdCAgICB9XG5cblx0ICAgIHZhciBwcmV2aW91c0ZhaWxDb3VudCA9IGNvbmZpZy5zdG9yYWdlICYmICtjb25maWcuc3RvcmFnZS5nZXRJdGVtKFwicXVuaXQtdGVzdC1cIiArIHRoaXMubW9kdWxlLm5hbWUgKyBcIi1cIiArIHRoaXMudGVzdE5hbWUpOyAvLyBQcmlvcml0aXplIHByZXZpb3VzbHkgZmFpbGVkIHRlc3RzLCBkZXRlY3RlZCBmcm9tIHN0b3JhZ2VcblxuXHQgICAgdmFyIHByaW9yaXRpemUgPSBjb25maWcucmVvcmRlciAmJiAhIXByZXZpb3VzRmFpbENvdW50O1xuXHQgICAgdGhpcy5wcmV2aW91c0ZhaWx1cmUgPSAhIXByZXZpb3VzRmFpbENvdW50O1xuXHQgICAgUHJvY2Vzc2luZ1F1ZXVlLmFkZChydW5UZXN0LCBwcmlvcml0aXplLCBjb25maWcuc2VlZCk7IC8vIElmIHRoZSBxdWV1ZSBoYXMgYWxyZWFkeSBmaW5pc2hlZCwgd2UgbWFudWFsbHkgcHJvY2VzcyB0aGUgbmV3IHRlc3RcblxuXHQgICAgaWYgKFByb2Nlc3NpbmdRdWV1ZS5maW5pc2hlZCkge1xuXHQgICAgICBQcm9jZXNzaW5nUXVldWUuYWR2YW5jZSgpO1xuXHQgICAgfVxuXHQgIH0sXG5cdCAgcHVzaFJlc3VsdDogZnVuY3Rpb24gcHVzaFJlc3VsdChyZXN1bHRJbmZvKSB7XG5cdCAgICBpZiAodGhpcyAhPT0gY29uZmlnLmN1cnJlbnQpIHtcblx0ICAgICAgdGhyb3cgbmV3IEVycm9yKFwiQXNzZXJ0aW9uIG9jY3VycmVkIGFmdGVyIHRlc3QgaGFkIGZpbmlzaGVkLlwiKTtcblx0ICAgIH0gLy8gRGVzdHJ1Y3R1cmUgb2YgcmVzdWx0SW5mbyA9IHsgcmVzdWx0LCBhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlLCBuZWdhdGl2ZSB9XG5cblxuXHQgICAgdmFyIHNvdXJjZSxcblx0ICAgICAgICBkZXRhaWxzID0ge1xuXHQgICAgICBtb2R1bGU6IHRoaXMubW9kdWxlLm5hbWUsXG5cdCAgICAgIG5hbWU6IHRoaXMudGVzdE5hbWUsXG5cdCAgICAgIHJlc3VsdDogcmVzdWx0SW5mby5yZXN1bHQsXG5cdCAgICAgIG1lc3NhZ2U6IHJlc3VsdEluZm8ubWVzc2FnZSxcblx0ICAgICAgYWN0dWFsOiByZXN1bHRJbmZvLmFjdHVhbCxcblx0ICAgICAgdGVzdElkOiB0aGlzLnRlc3RJZCxcblx0ICAgICAgbmVnYXRpdmU6IHJlc3VsdEluZm8ubmVnYXRpdmUgfHwgZmFsc2UsXG5cdCAgICAgIHJ1bnRpbWU6IG5vdygpIC0gdGhpcy5zdGFydGVkLFxuXHQgICAgICB0b2RvOiAhIXRoaXMudG9kb1xuXHQgICAgfTtcblxuXHQgICAgaWYgKGhhc093bi5jYWxsKHJlc3VsdEluZm8sIFwiZXhwZWN0ZWRcIikpIHtcblx0ICAgICAgZGV0YWlscy5leHBlY3RlZCA9IHJlc3VsdEluZm8uZXhwZWN0ZWQ7XG5cdCAgICB9XG5cblx0ICAgIGlmICghcmVzdWx0SW5mby5yZXN1bHQpIHtcblx0ICAgICAgc291cmNlID0gcmVzdWx0SW5mby5zb3VyY2UgfHwgc291cmNlRnJvbVN0YWNrdHJhY2UoKTtcblxuXHQgICAgICBpZiAoc291cmNlKSB7XG5cdCAgICAgICAgZGV0YWlscy5zb3VyY2UgPSBzb3VyY2U7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgdGhpcy5sb2dBc3NlcnRpb24oZGV0YWlscyk7XG5cdCAgICB0aGlzLmFzc2VydGlvbnMucHVzaCh7XG5cdCAgICAgIHJlc3VsdDogISFyZXN1bHRJbmZvLnJlc3VsdCxcblx0ICAgICAgbWVzc2FnZTogcmVzdWx0SW5mby5tZXNzYWdlXG5cdCAgICB9KTtcblx0ICB9LFxuXHQgIHB1c2hGYWlsdXJlOiBmdW5jdGlvbiBwdXNoRmFpbHVyZShtZXNzYWdlLCBzb3VyY2UsIGFjdHVhbCkge1xuXHQgICAgaWYgKCEodGhpcyBpbnN0YW5jZW9mIFRlc3QpKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcInB1c2hGYWlsdXJlKCkgYXNzZXJ0aW9uIG91dHNpZGUgdGVzdCBjb250ZXh0LCB3YXMgXCIgKyBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgICB9XG5cblx0ICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgIHJlc3VsdDogZmFsc2UsXG5cdCAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UgfHwgXCJlcnJvclwiLFxuXHQgICAgICBhY3R1YWw6IGFjdHVhbCB8fCBudWxsLFxuXHQgICAgICBzb3VyY2U6IHNvdXJjZVxuXHQgICAgfSk7XG5cdCAgfSxcblxuXHQgIC8qKlxuXHQgICAqIExvZyBhc3NlcnRpb24gZGV0YWlscyB1c2luZyBib3RoIHRoZSBvbGQgUVVuaXQubG9nIGludGVyZmFjZSBhbmRcblx0ICAgKiBRVW5pdC5vbiggXCJhc3NlcnRpb25cIiApIGludGVyZmFjZS5cblx0ICAgKlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cdCAgbG9nQXNzZXJ0aW9uOiBmdW5jdGlvbiBsb2dBc3NlcnRpb24oZGV0YWlscykge1xuXHQgICAgcnVuTG9nZ2luZ0NhbGxiYWNrcyhcImxvZ1wiLCBkZXRhaWxzKTtcblx0ICAgIHZhciBhc3NlcnRpb24gPSB7XG5cdCAgICAgIHBhc3NlZDogZGV0YWlscy5yZXN1bHQsXG5cdCAgICAgIGFjdHVhbDogZGV0YWlscy5hY3R1YWwsXG5cdCAgICAgIGV4cGVjdGVkOiBkZXRhaWxzLmV4cGVjdGVkLFxuXHQgICAgICBtZXNzYWdlOiBkZXRhaWxzLm1lc3NhZ2UsXG5cdCAgICAgIHN0YWNrOiBkZXRhaWxzLnNvdXJjZSxcblx0ICAgICAgdG9kbzogZGV0YWlscy50b2RvXG5cdCAgICB9O1xuXHQgICAgdGhpcy50ZXN0UmVwb3J0LnB1c2hBc3NlcnRpb24oYXNzZXJ0aW9uKTtcblx0ICAgIGVtaXQoXCJhc3NlcnRpb25cIiwgYXNzZXJ0aW9uKTtcblx0ICB9LFxuXHQgIHJlc29sdmVQcm9taXNlOiBmdW5jdGlvbiByZXNvbHZlUHJvbWlzZShwcm9taXNlLCBwaGFzZSkge1xuXHQgICAgdmFyIHRoZW4sXG5cdCAgICAgICAgcmVzdW1lLFxuXHQgICAgICAgIG1lc3NhZ2UsXG5cdCAgICAgICAgdGVzdCA9IHRoaXM7XG5cblx0ICAgIGlmIChwcm9taXNlICE9IG51bGwpIHtcblx0ICAgICAgdGhlbiA9IHByb21pc2UudGhlbjtcblxuXHQgICAgICBpZiAob2JqZWN0VHlwZSh0aGVuKSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICAgICAgcmVzdW1lID0gaW50ZXJuYWxTdG9wKHRlc3QpO1xuXG5cdCAgICAgICAgaWYgKGNvbmZpZy5ub3RyeWNhdGNoKSB7XG5cdCAgICAgICAgICB0aGVuLmNhbGwocHJvbWlzZSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXN1bWUoKTtcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aGVuLmNhbGwocHJvbWlzZSwgZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICByZXN1bWUoKTtcblx0ICAgICAgICAgIH0sIGZ1bmN0aW9uIChlcnJvcikge1xuXHQgICAgICAgICAgICBtZXNzYWdlID0gXCJQcm9taXNlIHJlamVjdGVkIFwiICsgKCFwaGFzZSA/IFwiZHVyaW5nXCIgOiBwaGFzZS5yZXBsYWNlKC9FYWNoJC8sIFwiXCIpKSArIFwiIFxcXCJcIiArIHRlc3QudGVzdE5hbWUgKyBcIlxcXCI6IFwiICsgKGVycm9yICYmIGVycm9yLm1lc3NhZ2UgfHwgZXJyb3IpO1xuXHQgICAgICAgICAgICB0ZXN0LnB1c2hGYWlsdXJlKG1lc3NhZ2UsIGV4dHJhY3RTdGFja3RyYWNlKGVycm9yLCAwKSk7IC8vIEVsc2UgbmV4dCB0ZXN0IHdpbGwgY2FycnkgdGhlIHJlc3BvbnNpYmlsaXR5XG5cblx0ICAgICAgICAgICAgc2F2ZUdsb2JhbCgpOyAvLyBVbmJsb2NrXG5cblx0ICAgICAgICAgICAgaW50ZXJuYWxSZWNvdmVyKHRlc3QpO1xuXHQgICAgICAgICAgfSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfSxcblx0ICB2YWxpZDogZnVuY3Rpb24gdmFsaWQoKSB7XG5cdCAgICB2YXIgZmlsdGVyID0gY29uZmlnLmZpbHRlcixcblx0ICAgICAgICByZWdleEZpbHRlciA9IC9eKCE/KVxcLyhbXFx3XFxXXSopXFwvKGk/JCkvLmV4ZWMoZmlsdGVyKSxcblx0ICAgICAgICBtb2R1bGUgPSBjb25maWcubW9kdWxlICYmIGNvbmZpZy5tb2R1bGUudG9Mb3dlckNhc2UoKSxcblx0ICAgICAgICBmdWxsTmFtZSA9IHRoaXMubW9kdWxlLm5hbWUgKyBcIjogXCIgKyB0aGlzLnRlc3ROYW1lO1xuXG5cdCAgICBmdW5jdGlvbiBtb2R1bGVDaGFpbk5hbWVNYXRjaCh0ZXN0TW9kdWxlKSB7XG5cdCAgICAgIHZhciB0ZXN0TW9kdWxlTmFtZSA9IHRlc3RNb2R1bGUubmFtZSA/IHRlc3RNb2R1bGUubmFtZS50b0xvd2VyQ2FzZSgpIDogbnVsbDtcblxuXHQgICAgICBpZiAodGVzdE1vZHVsZU5hbWUgPT09IG1vZHVsZSkge1xuXHQgICAgICAgIHJldHVybiB0cnVlO1xuXHQgICAgICB9IGVsc2UgaWYgKHRlc3RNb2R1bGUucGFyZW50TW9kdWxlKSB7XG5cdCAgICAgICAgcmV0dXJuIG1vZHVsZUNoYWluTmFtZU1hdGNoKHRlc3RNb2R1bGUucGFyZW50TW9kdWxlKTtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICByZXR1cm4gZmFsc2U7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gbW9kdWxlQ2hhaW5JZE1hdGNoKHRlc3RNb2R1bGUpIHtcblx0ICAgICAgcmV0dXJuIGluQXJyYXkodGVzdE1vZHVsZS5tb2R1bGVJZCwgY29uZmlnLm1vZHVsZUlkKSB8fCB0ZXN0TW9kdWxlLnBhcmVudE1vZHVsZSAmJiBtb2R1bGVDaGFpbklkTWF0Y2godGVzdE1vZHVsZS5wYXJlbnRNb2R1bGUpO1xuXHQgICAgfSAvLyBJbnRlcm5hbGx5LWdlbmVyYXRlZCB0ZXN0cyBhcmUgYWx3YXlzIHZhbGlkXG5cblxuXHQgICAgaWYgKHRoaXMuY2FsbGJhY2sgJiYgdGhpcy5jYWxsYmFjay52YWxpZFRlc3QpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcubW9kdWxlSWQgJiYgY29uZmlnLm1vZHVsZUlkLmxlbmd0aCA+IDAgJiYgIW1vZHVsZUNoYWluSWRNYXRjaCh0aGlzLm1vZHVsZSkpIHtcblx0ICAgICAgcmV0dXJuIGZhbHNlO1xuXHQgICAgfVxuXG5cdCAgICBpZiAoY29uZmlnLnRlc3RJZCAmJiBjb25maWcudGVzdElkLmxlbmd0aCA+IDAgJiYgIWluQXJyYXkodGhpcy50ZXN0SWQsIGNvbmZpZy50ZXN0SWQpKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblxuXHQgICAgaWYgKG1vZHVsZSAmJiAhbW9kdWxlQ2hhaW5OYW1lTWF0Y2godGhpcy5tb2R1bGUpKSB7XG5cdCAgICAgIHJldHVybiBmYWxzZTtcblx0ICAgIH1cblxuXHQgICAgaWYgKCFmaWx0ZXIpIHtcblx0ICAgICAgcmV0dXJuIHRydWU7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiByZWdleEZpbHRlciA/IHRoaXMucmVnZXhGaWx0ZXIoISFyZWdleEZpbHRlclsxXSwgcmVnZXhGaWx0ZXJbMl0sIHJlZ2V4RmlsdGVyWzNdLCBmdWxsTmFtZSkgOiB0aGlzLnN0cmluZ0ZpbHRlcihmaWx0ZXIsIGZ1bGxOYW1lKTtcblx0ICB9LFxuXHQgIHJlZ2V4RmlsdGVyOiBmdW5jdGlvbiByZWdleEZpbHRlcihleGNsdWRlLCBwYXR0ZXJuLCBmbGFncywgZnVsbE5hbWUpIHtcblx0ICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAocGF0dGVybiwgZmxhZ3MpO1xuXHQgICAgdmFyIG1hdGNoID0gcmVnZXgudGVzdChmdWxsTmFtZSk7XG5cdCAgICByZXR1cm4gbWF0Y2ggIT09IGV4Y2x1ZGU7XG5cdCAgfSxcblx0ICBzdHJpbmdGaWx0ZXI6IGZ1bmN0aW9uIHN0cmluZ0ZpbHRlcihmaWx0ZXIsIGZ1bGxOYW1lKSB7XG5cdCAgICBmaWx0ZXIgPSBmaWx0ZXIudG9Mb3dlckNhc2UoKTtcblx0ICAgIGZ1bGxOYW1lID0gZnVsbE5hbWUudG9Mb3dlckNhc2UoKTtcblx0ICAgIHZhciBpbmNsdWRlID0gZmlsdGVyLmNoYXJBdCgwKSAhPT0gXCIhXCI7XG5cblx0ICAgIGlmICghaW5jbHVkZSkge1xuXHQgICAgICBmaWx0ZXIgPSBmaWx0ZXIuc2xpY2UoMSk7XG5cdCAgICB9IC8vIElmIHRoZSBmaWx0ZXIgbWF0Y2hlcywgd2UgbmVlZCB0byBob25vdXIgaW5jbHVkZVxuXG5cblx0ICAgIGlmIChmdWxsTmFtZS5pbmRleE9mKGZpbHRlcikgIT09IC0xKSB7XG5cdCAgICAgIHJldHVybiBpbmNsdWRlO1xuXHQgICAgfSAvLyBPdGhlcndpc2UsIGRvIHRoZSBvcHBvc2l0ZVxuXG5cblx0ICAgIHJldHVybiAhaW5jbHVkZTtcblx0ICB9XG5cdH07XG5cdGZ1bmN0aW9uIHB1c2hGYWlsdXJlKCkge1xuXHQgIGlmICghY29uZmlnLmN1cnJlbnQpIHtcblx0ICAgIHRocm93IG5ldyBFcnJvcihcInB1c2hGYWlsdXJlKCkgYXNzZXJ0aW9uIG91dHNpZGUgdGVzdCBjb250ZXh0LCBpbiBcIiArIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICB9IC8vIEdldHMgY3VycmVudCB0ZXN0IG9ialxuXG5cblx0ICB2YXIgY3VycmVudFRlc3QgPSBjb25maWcuY3VycmVudDtcblx0ICByZXR1cm4gY3VycmVudFRlc3QucHVzaEZhaWx1cmUuYXBwbHkoY3VycmVudFRlc3QsIGFyZ3VtZW50cyk7XG5cdH1cblxuXHRmdW5jdGlvbiBzYXZlR2xvYmFsKCkge1xuXHQgIGNvbmZpZy5wb2xsdXRpb24gPSBbXTtcblxuXHQgIGlmIChjb25maWcubm9nbG9iYWxzKSB7XG5cdCAgICBmb3IgKHZhciBrZXkgaW4gZ2xvYmFsX19kZWZhdWx0WydkZWZhdWx0J10pIHtcblx0ICAgICAgaWYgKGhhc093bi5jYWxsKGdsb2JhbF9fZGVmYXVsdFsnZGVmYXVsdCddLCBrZXkpKSB7XG5cdCAgICAgICAgLy8gSW4gT3BlcmEgc29tZXRpbWVzIERPTSBlbGVtZW50IGlkcyBzaG93IHVwIGhlcmUsIGlnbm9yZSB0aGVtXG5cdCAgICAgICAgaWYgKC9ecXVuaXQtdGVzdC1vdXRwdXQvLnRlc3Qoa2V5KSkge1xuXHQgICAgICAgICAgY29udGludWU7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgY29uZmlnLnBvbGx1dGlvbi5wdXNoKGtleSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9XG5cdH1cblxuXHRmdW5jdGlvbiBjaGVja1BvbGx1dGlvbigpIHtcblx0ICB2YXIgbmV3R2xvYmFscyxcblx0ICAgICAgZGVsZXRlZEdsb2JhbHMsXG5cdCAgICAgIG9sZCA9IGNvbmZpZy5wb2xsdXRpb247XG5cdCAgc2F2ZUdsb2JhbCgpO1xuXHQgIG5ld0dsb2JhbHMgPSBkaWZmKGNvbmZpZy5wb2xsdXRpb24sIG9sZCk7XG5cblx0ICBpZiAobmV3R2xvYmFscy5sZW5ndGggPiAwKSB7XG5cdCAgICBwdXNoRmFpbHVyZShcIkludHJvZHVjZWQgZ2xvYmFsIHZhcmlhYmxlKHMpOiBcIiArIG5ld0dsb2JhbHMuam9pbihcIiwgXCIpKTtcblx0ICB9XG5cblx0ICBkZWxldGVkR2xvYmFscyA9IGRpZmYob2xkLCBjb25maWcucG9sbHV0aW9uKTtcblxuXHQgIGlmIChkZWxldGVkR2xvYmFscy5sZW5ndGggPiAwKSB7XG5cdCAgICBwdXNoRmFpbHVyZShcIkRlbGV0ZWQgZ2xvYmFsIHZhcmlhYmxlKHMpOiBcIiArIGRlbGV0ZWRHbG9iYWxzLmpvaW4oXCIsIFwiKSk7XG5cdCAgfVxuXHR9IC8vIFdpbGwgYmUgZXhwb3NlZCBhcyBRVW5pdC50ZXN0XG5cblxuXHRmdW5jdGlvbiB0ZXN0KHRlc3ROYW1lLCBjYWxsYmFjaykge1xuXHQgIGlmIChmb2N1c2VkJDEpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICB2YXIgbmV3VGVzdCA9IG5ldyBUZXN0KHtcblx0ICAgIHRlc3ROYW1lOiB0ZXN0TmFtZSxcblx0ICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuXHQgIH0pO1xuXHQgIG5ld1Rlc3QucXVldWUoKTtcblx0fVxuXHRmdW5jdGlvbiB0b2RvKHRlc3ROYW1lLCBjYWxsYmFjaykge1xuXHQgIGlmIChmb2N1c2VkJDEpIHtcblx0ICAgIHJldHVybjtcblx0ICB9XG5cblx0ICB2YXIgbmV3VGVzdCA9IG5ldyBUZXN0KHtcblx0ICAgIHRlc3ROYW1lOiB0ZXN0TmFtZSxcblx0ICAgIGNhbGxiYWNrOiBjYWxsYmFjayxcblx0ICAgIHRvZG86IHRydWVcblx0ICB9KTtcblx0ICBuZXdUZXN0LnF1ZXVlKCk7XG5cdH0gLy8gV2lsbCBiZSBleHBvc2VkIGFzIFFVbml0LnNraXBcblxuXHRmdW5jdGlvbiBza2lwKHRlc3ROYW1lKSB7XG5cdCAgaWYgKGZvY3VzZWQkMSkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHZhciB0ZXN0ID0gbmV3IFRlc3Qoe1xuXHQgICAgdGVzdE5hbWU6IHRlc3ROYW1lLFxuXHQgICAgc2tpcDogdHJ1ZVxuXHQgIH0pO1xuXHQgIHRlc3QucXVldWUoKTtcblx0fSAvLyBXaWxsIGJlIGV4cG9zZWQgYXMgUVVuaXQub25seVxuXG5cdGZ1bmN0aW9uIG9ubHkodGVzdE5hbWUsIGNhbGxiYWNrKSB7XG5cdCAgaWYgKCFmb2N1c2VkJDEpIHtcblx0ICAgIGNvbmZpZy5xdWV1ZS5sZW5ndGggPSAwO1xuXHQgICAgZm9jdXNlZCQxID0gdHJ1ZTtcblx0ICB9XG5cblx0ICB2YXIgbmV3VGVzdCA9IG5ldyBUZXN0KHtcblx0ICAgIHRlc3ROYW1lOiB0ZXN0TmFtZSxcblx0ICAgIGNhbGxiYWNrOiBjYWxsYmFja1xuXHQgIH0pO1xuXHQgIG5ld1Rlc3QucXVldWUoKTtcblx0fSAvLyBSZXNldHMgY29uZmlnLnRpbWVvdXQgd2l0aCBhIG5ldyB0aW1lb3V0IGR1cmF0aW9uLlxuXG5cdGZ1bmN0aW9uIHJlc2V0VGVzdFRpbWVvdXQodGltZW91dER1cmF0aW9uKSB7XG5cdCAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0KTtcblx0ICBjb25maWcudGltZW91dCA9IHNldFRpbWVvdXQkMShjb25maWcudGltZW91dEhhbmRsZXIodGltZW91dER1cmF0aW9uKSwgdGltZW91dER1cmF0aW9uKTtcblx0fSAvLyBQdXQgYSBob2xkIG9uIHByb2Nlc3NpbmcgYW5kIHJldHVybiBhIGZ1bmN0aW9uIHRoYXQgd2lsbCByZWxlYXNlIGl0LlxuXG5cdGZ1bmN0aW9uIGludGVybmFsU3RvcCh0ZXN0KSB7XG5cdCAgdmFyIHJlbGVhc2VkID0gZmFsc2U7XG5cdCAgdGVzdC5zZW1hcGhvcmUgKz0gMTtcblx0ICBjb25maWcuYmxvY2tpbmcgPSB0cnVlOyAvLyBTZXQgYSByZWNvdmVyeSB0aW1lb3V0LCBpZiBzbyBjb25maWd1cmVkLlxuXG5cdCAgaWYgKGRlZmluZWQuc2V0VGltZW91dCkge1xuXHQgICAgdmFyIHRpbWVvdXREdXJhdGlvbjtcblxuXHQgICAgaWYgKHR5cGVvZiB0ZXN0LnRpbWVvdXQgPT09IFwibnVtYmVyXCIpIHtcblx0ICAgICAgdGltZW91dER1cmF0aW9uID0gdGVzdC50aW1lb3V0O1xuXHQgICAgfSBlbHNlIGlmICh0eXBlb2YgY29uZmlnLnRlc3RUaW1lb3V0ID09PSBcIm51bWJlclwiKSB7XG5cdCAgICAgIHRpbWVvdXREdXJhdGlvbiA9IGNvbmZpZy50ZXN0VGltZW91dDtcblx0ICAgIH1cblxuXHQgICAgaWYgKHR5cGVvZiB0aW1lb3V0RHVyYXRpb24gPT09IFwibnVtYmVyXCIgJiYgdGltZW91dER1cmF0aW9uID4gMCkge1xuXHQgICAgICBjbGVhclRpbWVvdXQoY29uZmlnLnRpbWVvdXQpO1xuXG5cdCAgICAgIGNvbmZpZy50aW1lb3V0SGFuZGxlciA9IGZ1bmN0aW9uICh0aW1lb3V0KSB7XG5cdCAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICAgIHB1c2hGYWlsdXJlKFwiVGVzdCB0b29rIGxvbmdlciB0aGFuIFwiLmNvbmNhdCh0aW1lb3V0LCBcIm1zOyB0ZXN0IHRpbWVkIG91dC5cIiksIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICAgICAgICAgIHJlbGVhc2VkID0gdHJ1ZTtcblx0ICAgICAgICAgIGludGVybmFsUmVjb3Zlcih0ZXN0KTtcblx0ICAgICAgICB9O1xuXHQgICAgICB9O1xuXG5cdCAgICAgIGNvbmZpZy50aW1lb3V0ID0gc2V0VGltZW91dCQxKGNvbmZpZy50aW1lb3V0SGFuZGxlcih0aW1lb3V0RHVyYXRpb24pLCB0aW1lb3V0RHVyYXRpb24pO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIHJldHVybiBmdW5jdGlvbiByZXN1bWUoKSB7XG5cdCAgICBpZiAocmVsZWFzZWQpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICByZWxlYXNlZCA9IHRydWU7XG5cdCAgICB0ZXN0LnNlbWFwaG9yZSAtPSAxO1xuXHQgICAgaW50ZXJuYWxTdGFydCh0ZXN0KTtcblx0ICB9O1xuXHR9IC8vIEZvcmNlZnVsbHkgcmVsZWFzZSBhbGwgcHJvY2Vzc2luZyBob2xkcy5cblxuXHRmdW5jdGlvbiBpbnRlcm5hbFJlY292ZXIodGVzdCkge1xuXHQgIHRlc3Quc2VtYXBob3JlID0gMDtcblx0ICBpbnRlcm5hbFN0YXJ0KHRlc3QpO1xuXHR9IC8vIFJlbGVhc2UgYSBwcm9jZXNzaW5nIGhvbGQsIHNjaGVkdWxpbmcgYSByZXN1bXB0aW9uIGF0dGVtcHQgaWYgbm8gaG9sZHMgcmVtYWluLlxuXG5cblx0ZnVuY3Rpb24gaW50ZXJuYWxTdGFydCh0ZXN0KSB7XG5cdCAgLy8gSWYgc2VtYXBob3JlIGlzIG5vbi1udW1lcmljLCB0aHJvdyBlcnJvclxuXHQgIGlmIChpc05hTih0ZXN0LnNlbWFwaG9yZSkpIHtcblx0ICAgIHRlc3Quc2VtYXBob3JlID0gMDtcblx0ICAgIHB1c2hGYWlsdXJlKFwiSW52YWxpZCB2YWx1ZSBvbiB0ZXN0LnNlbWFwaG9yZVwiLCBzb3VyY2VGcm9tU3RhY2t0cmFjZSgyKSk7XG5cdCAgICByZXR1cm47XG5cdCAgfSAvLyBEb24ndCBzdGFydCB1bnRpbCBlcXVhbCBudW1iZXIgb2Ygc3RvcC1jYWxsc1xuXG5cblx0ICBpZiAodGVzdC5zZW1hcGhvcmUgPiAwKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfSAvLyBUaHJvdyBhbiBFcnJvciBpZiBzdGFydCBpcyBjYWxsZWQgbW9yZSBvZnRlbiB0aGFuIHN0b3BcblxuXG5cdCAgaWYgKHRlc3Quc2VtYXBob3JlIDwgMCkge1xuXHQgICAgdGVzdC5zZW1hcGhvcmUgPSAwO1xuXHQgICAgcHVzaEZhaWx1cmUoXCJUcmllZCB0byByZXN0YXJ0IHRlc3Qgd2hpbGUgYWxyZWFkeSBzdGFydGVkICh0ZXN0J3Mgc2VtYXBob3JlIHdhcyAwIGFscmVhZHkpXCIsIHNvdXJjZUZyb21TdGFja3RyYWNlKDIpKTtcblx0ICAgIHJldHVybjtcblx0ICB9IC8vIEFkZCBhIHNsaWdodCBkZWxheSB0byBhbGxvdyBtb3JlIGFzc2VydGlvbnMgZXRjLlxuXG5cblx0ICBpZiAoZGVmaW5lZC5zZXRUaW1lb3V0KSB7XG5cdCAgICBpZiAoY29uZmlnLnRpbWVvdXQpIHtcblx0ICAgICAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0KTtcblx0ICAgIH1cblxuXHQgICAgY29uZmlnLnRpbWVvdXQgPSBzZXRUaW1lb3V0JDEoZnVuY3Rpb24gKCkge1xuXHQgICAgICBpZiAodGVzdC5zZW1hcGhvcmUgPiAwKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKGNvbmZpZy50aW1lb3V0KSB7XG5cdCAgICAgICAgY2xlYXJUaW1lb3V0KGNvbmZpZy50aW1lb3V0KTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGJlZ2luKCk7XG5cdCAgICB9KTtcblx0ICB9IGVsc2Uge1xuXHQgICAgYmVnaW4oKTtcblx0ICB9XG5cdH1cblxuXHRmdW5jdGlvbiBjb2xsZWN0VGVzdHMobW9kdWxlKSB7XG5cdCAgdmFyIHRlc3RzID0gW10uY29uY2F0KG1vZHVsZS50ZXN0cyk7XG5cblx0ICB2YXIgbW9kdWxlcyA9IF90b0NvbnN1bWFibGVBcnJheShtb2R1bGUuY2hpbGRNb2R1bGVzKTsgLy8gRG8gYSBicmVhZHRoLWZpcnN0IHRyYXZlcnNhbCBvZiB0aGUgY2hpbGQgbW9kdWxlc1xuXG5cblx0ICB3aGlsZSAobW9kdWxlcy5sZW5ndGgpIHtcblx0ICAgIHZhciBuZXh0TW9kdWxlID0gbW9kdWxlcy5zaGlmdCgpO1xuXHQgICAgdGVzdHMucHVzaC5hcHBseSh0ZXN0cywgbmV4dE1vZHVsZS50ZXN0cyk7XG5cdCAgICBtb2R1bGVzLnB1c2guYXBwbHkobW9kdWxlcywgX3RvQ29uc3VtYWJsZUFycmF5KG5leHRNb2R1bGUuY2hpbGRNb2R1bGVzKSk7XG5cdCAgfVxuXG5cdCAgcmV0dXJuIHRlc3RzO1xuXHR9XG5cblx0ZnVuY3Rpb24gbnVtYmVyT2ZUZXN0cyhtb2R1bGUpIHtcblx0ICByZXR1cm4gY29sbGVjdFRlc3RzKG1vZHVsZSkubGVuZ3RoO1xuXHR9XG5cblx0ZnVuY3Rpb24gbnVtYmVyT2ZVbnNraXBwZWRUZXN0cyhtb2R1bGUpIHtcblx0ICByZXR1cm4gY29sbGVjdFRlc3RzKG1vZHVsZSkuZmlsdGVyKGZ1bmN0aW9uICh0ZXN0KSB7XG5cdCAgICByZXR1cm4gIXRlc3Quc2tpcDtcblx0ICB9KS5sZW5ndGg7XG5cdH1cblxuXHRmdW5jdGlvbiBub3RpZnlUZXN0c1Jhbihtb2R1bGUsIHNraXBwZWQpIHtcblx0ICBtb2R1bGUudGVzdHNSdW4rKztcblxuXHQgIGlmICghc2tpcHBlZCkge1xuXHQgICAgbW9kdWxlLnVuc2tpcHBlZFRlc3RzUnVuKys7XG5cdCAgfVxuXG5cdCAgd2hpbGUgKG1vZHVsZSA9IG1vZHVsZS5wYXJlbnRNb2R1bGUpIHtcblx0ICAgIG1vZHVsZS50ZXN0c1J1bisrO1xuXG5cdCAgICBpZiAoIXNraXBwZWQpIHtcblx0ICAgICAgbW9kdWxlLnVuc2tpcHBlZFRlc3RzUnVuKys7XG5cdCAgICB9XG5cdCAgfVxuXHR9XG5cblx0dmFyIEFzc2VydCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7XG5cdCAgZnVuY3Rpb24gQXNzZXJ0KHRlc3RDb250ZXh0KSB7XG5cdCAgICBfY2xhc3NDYWxsQ2hlY2sodGhpcywgQXNzZXJ0KTtcblxuXHQgICAgdGhpcy50ZXN0ID0gdGVzdENvbnRleHQ7XG5cdCAgfSAvLyBBc3NlcnQgaGVscGVyc1xuXG5cblx0ICBfY3JlYXRlQ2xhc3MoQXNzZXJ0LCBbe1xuXHQgICAga2V5OiBcInRpbWVvdXRcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB0aW1lb3V0KGR1cmF0aW9uKSB7XG5cdCAgICAgIGlmICh0eXBlb2YgZHVyYXRpb24gIT09IFwibnVtYmVyXCIpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJZb3UgbXVzdCBwYXNzIGEgbnVtYmVyIGFzIHRoZSBkdXJhdGlvbiB0byBhc3NlcnQudGltZW91dFwiKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHRoaXMudGVzdC50aW1lb3V0ID0gZHVyYXRpb247IC8vIElmIGEgdGltZW91dCBoYXMgYmVlbiBzZXQsIGNsZWFyIGl0IGFuZCByZXNldCB3aXRoIHRoZSBuZXcgZHVyYXRpb25cblxuXHQgICAgICBpZiAoY29uZmlnLnRpbWVvdXQpIHtcblx0ICAgICAgICBjbGVhclRpbWVvdXQoY29uZmlnLnRpbWVvdXQpO1xuXG5cdCAgICAgICAgaWYgKGNvbmZpZy50aW1lb3V0SGFuZGxlciAmJiB0aGlzLnRlc3QudGltZW91dCA+IDApIHtcblx0ICAgICAgICAgIHJlc2V0VGVzdFRpbWVvdXQodGhpcy50ZXN0LnRpbWVvdXQpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfSAvLyBEb2N1bWVudHMgYSBcInN0ZXBcIiwgd2hpY2ggaXMgYSBzdHJpbmcgdmFsdWUsIGluIGEgdGVzdCBhcyBhIHBhc3NpbmcgYXNzZXJ0aW9uXG5cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwic3RlcFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIHN0ZXAobWVzc2FnZSkge1xuXHQgICAgICB2YXIgYXNzZXJ0aW9uTWVzc2FnZSA9IG1lc3NhZ2U7XG5cdCAgICAgIHZhciByZXN1bHQgPSAhIW1lc3NhZ2U7XG5cdCAgICAgIHRoaXMudGVzdC5zdGVwcy5wdXNoKG1lc3NhZ2UpO1xuXG5cdCAgICAgIGlmIChvYmplY3RUeXBlKG1lc3NhZ2UpID09PSBcInVuZGVmaW5lZFwiIHx8IG1lc3NhZ2UgPT09IFwiXCIpIHtcblx0ICAgICAgICBhc3NlcnRpb25NZXNzYWdlID0gXCJZb3UgbXVzdCBwcm92aWRlIGEgbWVzc2FnZSB0byBhc3NlcnQuc3RlcFwiO1xuXHQgICAgICB9IGVsc2UgaWYgKG9iamVjdFR5cGUobWVzc2FnZSkgIT09IFwic3RyaW5nXCIpIHtcblx0ICAgICAgICBhc3NlcnRpb25NZXNzYWdlID0gXCJZb3UgbXVzdCBwcm92aWRlIGEgc3RyaW5nIHZhbHVlIHRvIGFzc2VydC5zdGVwXCI7XG5cdCAgICAgICAgcmVzdWx0ID0gZmFsc2U7XG5cdCAgICAgIH1cblxuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuXHQgICAgICAgIG1lc3NhZ2U6IGFzc2VydGlvbk1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9IC8vIFZlcmlmaWVzIHRoZSBzdGVwcyBpbiBhIHRlc3QgbWF0Y2ggYSBnaXZlbiBhcnJheSBvZiBzdHJpbmcgdmFsdWVzXG5cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwidmVyaWZ5U3RlcHNcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB2ZXJpZnlTdGVwcyhzdGVwcywgbWVzc2FnZSkge1xuXHQgICAgICAvLyBTaW5jZSB0aGUgc3RlcHMgYXJyYXkgaXMganVzdCBzdHJpbmcgdmFsdWVzLCB3ZSBjYW4gY2xvbmUgd2l0aCBzbGljZVxuXHQgICAgICB2YXIgYWN0dWFsU3RlcHNDbG9uZSA9IHRoaXMudGVzdC5zdGVwcy5zbGljZSgpO1xuXHQgICAgICB0aGlzLmRlZXBFcXVhbChhY3R1YWxTdGVwc0Nsb25lLCBzdGVwcywgbWVzc2FnZSk7XG5cdCAgICAgIHRoaXMudGVzdC5zdGVwcy5sZW5ndGggPSAwO1xuXHQgICAgfSAvLyBTcGVjaWZ5IHRoZSBudW1iZXIgb2YgZXhwZWN0ZWQgYXNzZXJ0aW9ucyB0byBndWFyYW50ZWUgdGhhdCBmYWlsZWQgdGVzdFxuXHQgICAgLy8gKG5vIGFzc2VydGlvbnMgYXJlIHJ1biBhdCBhbGwpIGRvbid0IHNsaXAgdGhyb3VnaC5cblxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJleHBlY3RcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBleHBlY3QoYXNzZXJ0cykge1xuXHQgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA9PT0gMSkge1xuXHQgICAgICAgIHRoaXMudGVzdC5leHBlY3RlZCA9IGFzc2VydHM7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIHRoaXMudGVzdC5leHBlY3RlZDtcblx0ICAgICAgfVxuXHQgICAgfSAvLyBQdXQgYSBob2xkIG9uIHByb2Nlc3NpbmcgYW5kIHJldHVybiBhIGZ1bmN0aW9uIHRoYXQgd2lsbCByZWxlYXNlIGl0IGEgbWF4aW11bSBvZiBvbmNlLlxuXG5cdCAgfSwge1xuXHQgICAga2V5OiBcImFzeW5jXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gYXN5bmMoY291bnQpIHtcblx0ICAgICAgdmFyIHRlc3QgPSB0aGlzLnRlc3Q7XG5cdCAgICAgIHZhciBwb3BwZWQgPSBmYWxzZSxcblx0ICAgICAgICAgIGFjY2VwdENhbGxDb3VudCA9IGNvdW50O1xuXG5cdCAgICAgIGlmICh0eXBlb2YgYWNjZXB0Q2FsbENvdW50ID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICAgICAgYWNjZXB0Q2FsbENvdW50ID0gMTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciByZXN1bWUgPSBpbnRlcm5hbFN0b3AodGVzdCk7XG5cdCAgICAgIHJldHVybiBmdW5jdGlvbiBkb25lKCkge1xuXHQgICAgICAgIGlmIChjb25maWcuY3VycmVudCAhPT0gdGVzdCkge1xuXHQgICAgICAgICAgdGhyb3cgRXJyb3IoXCJhc3NlcnQuYXN5bmMgY2FsbGJhY2sgY2FsbGVkIGFmdGVyIHRlc3QgZmluaXNoZWQuXCIpO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChwb3BwZWQpIHtcblx0ICAgICAgICAgIHRlc3QucHVzaEZhaWx1cmUoXCJUb28gbWFueSBjYWxscyB0byB0aGUgYGFzc2VydC5hc3luY2AgY2FsbGJhY2tcIiwgc291cmNlRnJvbVN0YWNrdHJhY2UoMikpO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGFjY2VwdENhbGxDb3VudCAtPSAxO1xuXG5cdCAgICAgICAgaWYgKGFjY2VwdENhbGxDb3VudCA+IDApIHtcblx0ICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBwb3BwZWQgPSB0cnVlO1xuXHQgICAgICAgIHJlc3VtZSgpO1xuXHQgICAgICB9O1xuXHQgICAgfSAvLyBFeHBvcnRzIHRlc3QucHVzaCgpIHRvIHRoZSB1c2VyIEFQSVxuXHQgICAgLy8gQWxpYXMgb2YgcHVzaFJlc3VsdC5cblxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJwdXNoXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcHVzaChyZXN1bHQsIGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UsIG5lZ2F0aXZlKSB7XG5cdCAgICAgIExvZ2dlci53YXJuKFwiYXNzZXJ0LnB1c2ggaXMgZGVwcmVjYXRlZCBhbmQgd2lsbCBiZSByZW1vdmVkIGluIFFVbml0IDMuMC5cIiArIFwiIFBsZWFzZSB1c2UgYXNzZXJ0LnB1c2hSZXN1bHQgaW5zdGVhZCAoaHR0cHM6Ly9hcGkucXVuaXRqcy5jb20vYXNzZXJ0L3B1c2hSZXN1bHQpLlwiKTtcblx0ICAgICAgdmFyIGN1cnJlbnRBc3NlcnQgPSB0aGlzIGluc3RhbmNlb2YgQXNzZXJ0ID8gdGhpcyA6IGNvbmZpZy5jdXJyZW50LmFzc2VydDtcblx0ICAgICAgcmV0dXJuIGN1cnJlbnRBc3NlcnQucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiByZXN1bHQsXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdCAgICAgICAgbmVnYXRpdmU6IG5lZ2F0aXZlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJwdXNoUmVzdWx0XCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcHVzaFJlc3VsdChyZXN1bHRJbmZvKSB7XG5cdCAgICAgIC8vIERlc3RydWN0dXJlIG9mIHJlc3VsdEluZm8gPSB7IHJlc3VsdCwgYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSwgbmVnYXRpdmUgfVxuXHQgICAgICB2YXIgYXNzZXJ0ID0gdGhpcztcblx0ICAgICAgdmFyIGN1cnJlbnRUZXN0ID0gYXNzZXJ0IGluc3RhbmNlb2YgQXNzZXJ0ICYmIGFzc2VydC50ZXN0IHx8IGNvbmZpZy5jdXJyZW50OyAvLyBCYWNrd2FyZHMgY29tcGF0aWJpbGl0eSBmaXguXG5cdCAgICAgIC8vIEFsbG93cyB0aGUgZGlyZWN0IHVzZSBvZiBnbG9iYWwgZXhwb3J0ZWQgYXNzZXJ0aW9ucyBhbmQgUVVuaXQuYXNzZXJ0Lipcblx0ICAgICAgLy8gQWx0aG91Z2gsIGl0J3MgdXNlIGlzIG5vdCByZWNvbW1lbmRlZCBhcyBpdCBjYW4gbGVhayBhc3NlcnRpb25zXG5cdCAgICAgIC8vIHRvIG90aGVyIHRlc3RzIGZyb20gYXN5bmMgdGVzdHMsIGJlY2F1c2Ugd2Ugb25seSBnZXQgYSByZWZlcmVuY2UgdG8gdGhlIGN1cnJlbnQgdGVzdCxcblx0ICAgICAgLy8gbm90IGV4YWN0bHkgdGhlIHRlc3Qgd2hlcmUgYXNzZXJ0aW9uIHdlcmUgaW50ZW5kZWQgdG8gYmUgY2FsbGVkLlxuXG5cdCAgICAgIGlmICghY3VycmVudFRlc3QpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJhc3NlcnRpb24gb3V0c2lkZSB0ZXN0IGNvbnRleHQsIGluIFwiICsgc291cmNlRnJvbVN0YWNrdHJhY2UoMikpO1xuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKCEoYXNzZXJ0IGluc3RhbmNlb2YgQXNzZXJ0KSkge1xuXHQgICAgICAgIGFzc2VydCA9IGN1cnJlbnRUZXN0LmFzc2VydDtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBhc3NlcnQudGVzdC5wdXNoUmVzdWx0KHJlc3VsdEluZm8pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJva1wiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIG9rKHJlc3VsdCwgbWVzc2FnZSkge1xuXHQgICAgICBpZiAoIW1lc3NhZ2UpIHtcblx0ICAgICAgICBtZXNzYWdlID0gcmVzdWx0ID8gXCJva2F5XCIgOiBcImZhaWxlZCwgZXhwZWN0ZWQgYXJndW1lbnQgdG8gYmUgdHJ1dGh5LCB3YXM6IFwiLmNvbmNhdChkdW1wLnBhcnNlKHJlc3VsdCkpO1xuXHQgICAgICB9XG5cblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6ICEhcmVzdWx0LFxuXHQgICAgICAgIGFjdHVhbDogcmVzdWx0LFxuXHQgICAgICAgIGV4cGVjdGVkOiB0cnVlLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcIm5vdE9rXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gbm90T2socmVzdWx0LCBtZXNzYWdlKSB7XG5cdCAgICAgIGlmICghbWVzc2FnZSkge1xuXHQgICAgICAgIG1lc3NhZ2UgPSAhcmVzdWx0ID8gXCJva2F5XCIgOiBcImZhaWxlZCwgZXhwZWN0ZWQgYXJndW1lbnQgdG8gYmUgZmFsc3ksIHdhczogXCIuY29uY2F0KGR1bXAucGFyc2UocmVzdWx0KSk7XG5cdCAgICAgIH1cblxuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogIXJlc3VsdCxcblx0ICAgICAgICBhY3R1YWw6IHJlc3VsdCxcblx0ICAgICAgICBleHBlY3RlZDogZmFsc2UsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwidHJ1ZVwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIF90cnVlKHJlc3VsdCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogcmVzdWx0ID09PSB0cnVlLFxuXHQgICAgICAgIGFjdHVhbDogcmVzdWx0LFxuXHQgICAgICAgIGV4cGVjdGVkOiB0cnVlLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcImZhbHNlXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gX2ZhbHNlKHJlc3VsdCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogcmVzdWx0ID09PSBmYWxzZSxcblx0ICAgICAgICBhY3R1YWw6IHJlc3VsdCxcblx0ICAgICAgICBleHBlY3RlZDogZmFsc2UsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwiZXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBlcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcblx0ICAgICAgdmFyIHJlc3VsdCA9IGV4cGVjdGVkID09IGFjdHVhbDtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwibm90RXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBub3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBlcWVxZXFcblx0ICAgICAgdmFyIHJlc3VsdCA9IGV4cGVjdGVkICE9IGFjdHVhbDtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IHJlc3VsdCxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcblx0ICAgICAgICBuZWdhdGl2ZTogdHJ1ZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwicHJvcEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcHJvcEVxdWFsKGFjdHVhbCwgZXhwZWN0ZWQsIG1lc3NhZ2UpIHtcblx0ICAgICAgYWN0dWFsID0gb2JqZWN0VmFsdWVzKGFjdHVhbCk7XG5cdCAgICAgIGV4cGVjdGVkID0gb2JqZWN0VmFsdWVzKGV4cGVjdGVkKTtcblx0ICAgICAgdGhpcy5wdXNoUmVzdWx0KHtcblx0ICAgICAgICByZXN1bHQ6IGVxdWl2KGFjdHVhbCwgZXhwZWN0ZWQpLFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJub3RQcm9wRXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBub3RQcm9wRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICBhY3R1YWwgPSBvYmplY3RWYWx1ZXMoYWN0dWFsKTtcblx0ICAgICAgZXhwZWN0ZWQgPSBvYmplY3RWYWx1ZXMoZXhwZWN0ZWQpO1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogIWVxdWl2KGFjdHVhbCwgZXhwZWN0ZWQpLFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuXHQgICAgICAgIG5lZ2F0aXZlOiB0cnVlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJkZWVwRXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBkZWVwRXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogZXF1aXYoYWN0dWFsLCBleHBlY3RlZCksXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcIm5vdERlZXBFcXVhbFwiLFxuXHQgICAgdmFsdWU6IGZ1bmN0aW9uIG5vdERlZXBFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiAhZXF1aXYoYWN0dWFsLCBleHBlY3RlZCksXG5cdCAgICAgICAgYWN0dWFsOiBhY3R1YWwsXG5cdCAgICAgICAgZXhwZWN0ZWQ6IGV4cGVjdGVkLFxuXHQgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2UsXG5cdCAgICAgICAgbmVnYXRpdmU6IHRydWVcblx0ICAgICAgfSk7XG5cdCAgICB9XG5cdCAgfSwge1xuXHQgICAga2V5OiBcInN0cmljdEVxdWFsXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gc3RyaWN0RXF1YWwoYWN0dWFsLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB0aGlzLnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogZXhwZWN0ZWQgPT09IGFjdHVhbCxcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCxcblx0ICAgICAgICBleHBlY3RlZDogZXhwZWN0ZWQsXG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZVxuXHQgICAgICB9KTtcblx0ICAgIH1cblx0ICB9LCB7XG5cdCAgICBrZXk6IFwibm90U3RyaWN0RXF1YWxcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiBub3RTdHJpY3RFcXVhbChhY3R1YWwsIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIHRoaXMucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgcmVzdWx0OiBleHBlY3RlZCAhPT0gYWN0dWFsLFxuXHQgICAgICAgIGFjdHVhbDogYWN0dWFsLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlLFxuXHQgICAgICAgIG5lZ2F0aXZlOiB0cnVlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJ0aHJvd3NcIixcblx0ICAgIHZhbHVlOiBmdW5jdGlvbiB0aHJvd3MoYmxvY2ssIGV4cGVjdGVkLCBtZXNzYWdlKSB7XG5cdCAgICAgIHZhciBhY3R1YWwsXG5cdCAgICAgICAgICByZXN1bHQgPSBmYWxzZTtcblx0ICAgICAgdmFyIGN1cnJlbnRUZXN0ID0gdGhpcyBpbnN0YW5jZW9mIEFzc2VydCAmJiB0aGlzLnRlc3QgfHwgY29uZmlnLmN1cnJlbnQ7IC8vICdleHBlY3RlZCcgaXMgb3B0aW9uYWwgdW5sZXNzIGRvaW5nIHN0cmluZyBjb21wYXJpc29uXG5cblx0ICAgICAgaWYgKG9iamVjdFR5cGUoZXhwZWN0ZWQpID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgaWYgKG1lc3NhZ2UgPT0gbnVsbCkge1xuXHQgICAgICAgICAgbWVzc2FnZSA9IGV4cGVjdGVkO1xuXHQgICAgICAgICAgZXhwZWN0ZWQgPSBudWxsO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJ0aHJvd3MvcmFpc2VzIGRvZXMgbm90IGFjY2VwdCBhIHN0cmluZyB2YWx1ZSBmb3IgdGhlIGV4cGVjdGVkIGFyZ3VtZW50LlxcblwiICsgXCJVc2UgYSBub24tc3RyaW5nIG9iamVjdCB2YWx1ZSAoZS5nLiByZWdFeHApIGluc3RlYWQgaWYgaXQncyBuZWNlc3NhcnkuXCIpO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIGN1cnJlbnRUZXN0Lmlnbm9yZUdsb2JhbEVycm9ycyA9IHRydWU7XG5cblx0ICAgICAgdHJ5IHtcblx0ICAgICAgICBibG9jay5jYWxsKGN1cnJlbnRUZXN0LnRlc3RFbnZpcm9ubWVudCk7XG5cdCAgICAgIH0gY2F0Y2ggKGUpIHtcblx0ICAgICAgICBhY3R1YWwgPSBlO1xuXHQgICAgICB9XG5cblx0ICAgICAgY3VycmVudFRlc3QuaWdub3JlR2xvYmFsRXJyb3JzID0gZmFsc2U7XG5cblx0ICAgICAgaWYgKGFjdHVhbCkge1xuXHQgICAgICAgIHZhciBleHBlY3RlZFR5cGUgPSBvYmplY3RUeXBlKGV4cGVjdGVkKTsgLy8gV2UgZG9uJ3Qgd2FudCB0byB2YWxpZGF0ZSB0aHJvd24gZXJyb3JcblxuXHQgICAgICAgIGlmICghZXhwZWN0ZWQpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRydWU7IC8vIEV4cGVjdGVkIGlzIGEgcmVnZXhwXG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwicmVnZXhwXCIpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IGV4cGVjdGVkLnRlc3QoZXJyb3JTdHJpbmcoYWN0dWFsKSk7IC8vIExvZyB0aGUgc3RyaW5nIGZvcm0gb2YgdGhlIHJlZ2V4cFxuXG5cdCAgICAgICAgICBleHBlY3RlZCA9IFN0cmluZyhleHBlY3RlZCk7IC8vIEV4cGVjdGVkIGlzIGEgY29uc3RydWN0b3IsIG1heWJlIGFuIEVycm9yIGNvbnN0cnVjdG9yXG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwiZnVuY3Rpb25cIiAmJiBhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZCkge1xuXHQgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsgLy8gRXhwZWN0ZWQgaXMgYW4gRXJyb3Igb2JqZWN0XG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwib2JqZWN0XCIpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IGFjdHVhbCBpbnN0YW5jZW9mIGV4cGVjdGVkLmNvbnN0cnVjdG9yICYmIGFjdHVhbC5uYW1lID09PSBleHBlY3RlZC5uYW1lICYmIGFjdHVhbC5tZXNzYWdlID09PSBleHBlY3RlZC5tZXNzYWdlOyAvLyBMb2cgdGhlIHN0cmluZyBmb3JtIG9mIHRoZSBFcnJvciBvYmplY3RcblxuXHQgICAgICAgICAgZXhwZWN0ZWQgPSBlcnJvclN0cmluZyhleHBlY3RlZCk7IC8vIEV4cGVjdGVkIGlzIGEgdmFsaWRhdGlvbiBmdW5jdGlvbiB3aGljaCByZXR1cm5zIHRydWUgaWYgdmFsaWRhdGlvbiBwYXNzZWRcblx0ICAgICAgICB9IGVsc2UgaWYgKGV4cGVjdGVkVHlwZSA9PT0gXCJmdW5jdGlvblwiICYmIGV4cGVjdGVkLmNhbGwoe30sIGFjdHVhbCkgPT09IHRydWUpIHtcblx0ICAgICAgICAgIGV4cGVjdGVkID0gbnVsbDtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgY3VycmVudFRlc3QuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuXHQgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuXHQgICAgICAgIC8vIHVuZGVmaW5lZCBpZiBpdCBkaWRuJ3QgdGhyb3dcblx0ICAgICAgICBhY3R1YWw6IGFjdHVhbCAmJiBlcnJvclN0cmluZyhhY3R1YWwpLFxuXHQgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICBtZXNzYWdlOiBtZXNzYWdlXG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH0sIHtcblx0ICAgIGtleTogXCJyZWplY3RzXCIsXG5cdCAgICB2YWx1ZTogZnVuY3Rpb24gcmVqZWN0cyhwcm9taXNlLCBleHBlY3RlZCwgbWVzc2FnZSkge1xuXHQgICAgICB2YXIgcmVzdWx0ID0gZmFsc2U7XG5cdCAgICAgIHZhciBjdXJyZW50VGVzdCA9IHRoaXMgaW5zdGFuY2VvZiBBc3NlcnQgJiYgdGhpcy50ZXN0IHx8IGNvbmZpZy5jdXJyZW50OyAvLyAnZXhwZWN0ZWQnIGlzIG9wdGlvbmFsIHVubGVzcyBkb2luZyBzdHJpbmcgY29tcGFyaXNvblxuXG5cdCAgICAgIGlmIChvYmplY3RUeXBlKGV4cGVjdGVkKSA9PT0gXCJzdHJpbmdcIikge1xuXHQgICAgICAgIGlmIChtZXNzYWdlID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgIG1lc3NhZ2UgPSBleHBlY3RlZDtcblx0ICAgICAgICAgIGV4cGVjdGVkID0gdW5kZWZpbmVkO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICBtZXNzYWdlID0gXCJhc3NlcnQucmVqZWN0cyBkb2VzIG5vdCBhY2NlcHQgYSBzdHJpbmcgdmFsdWUgZm9yIHRoZSBleHBlY3RlZCBcIiArIFwiYXJndW1lbnQuXFxuVXNlIGEgbm9uLXN0cmluZyBvYmplY3QgdmFsdWUgKGUuZy4gdmFsaWRhdG9yIGZ1bmN0aW9uKSBpbnN0ZWFkIFwiICsgXCJpZiBuZWNlc3NhcnkuXCI7XG5cdCAgICAgICAgICBjdXJyZW50VGVzdC5hc3NlcnQucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgICAgIHJlc3VsdDogZmFsc2UsXG5cdCAgICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgICAgIH0pO1xuXHQgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHZhciB0aGVuID0gcHJvbWlzZSAmJiBwcm9taXNlLnRoZW47XG5cblx0ICAgICAgaWYgKG9iamVjdFR5cGUodGhlbikgIT09IFwiZnVuY3Rpb25cIikge1xuXHQgICAgICAgIHZhciBfbWVzc2FnZSA9IFwiVGhlIHZhbHVlIHByb3ZpZGVkIHRvIGBhc3NlcnQucmVqZWN0c2AgaW4gXCIgKyBcIlxcXCJcIiArIGN1cnJlbnRUZXN0LnRlc3ROYW1lICsgXCJcXFwiIHdhcyBub3QgYSBwcm9taXNlLlwiO1xuXG5cdCAgICAgICAgY3VycmVudFRlc3QuYXNzZXJ0LnB1c2hSZXN1bHQoe1xuXHQgICAgICAgICAgcmVzdWx0OiBmYWxzZSxcblx0ICAgICAgICAgIG1lc3NhZ2U6IF9tZXNzYWdlLFxuXHQgICAgICAgICAgYWN0dWFsOiBwcm9taXNlXG5cdCAgICAgICAgfSk7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgdmFyIGRvbmUgPSB0aGlzLmFzeW5jKCk7XG5cdCAgICAgIHJldHVybiB0aGVuLmNhbGwocHJvbWlzZSwgZnVuY3Rpb24gaGFuZGxlRnVsZmlsbG1lbnQoKSB7XG5cdCAgICAgICAgdmFyIG1lc3NhZ2UgPSBcIlRoZSBwcm9taXNlIHJldHVybmVkIGJ5IHRoZSBgYXNzZXJ0LnJlamVjdHNgIGNhbGxiYWNrIGluIFwiICsgXCJcXFwiXCIgKyBjdXJyZW50VGVzdC50ZXN0TmFtZSArIFwiXFxcIiBkaWQgbm90IHJlamVjdC5cIjtcblx0ICAgICAgICBjdXJyZW50VGVzdC5hc3NlcnQucHVzaFJlc3VsdCh7XG5cdCAgICAgICAgICByZXN1bHQ6IGZhbHNlLFxuXHQgICAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcblx0ICAgICAgICAgIGFjdHVhbDogcHJvbWlzZVxuXHQgICAgICAgIH0pO1xuXHQgICAgICAgIGRvbmUoKTtcblx0ICAgICAgfSwgZnVuY3Rpb24gaGFuZGxlUmVqZWN0aW9uKGFjdHVhbCkge1xuXHQgICAgICAgIHZhciBleHBlY3RlZFR5cGUgPSBvYmplY3RUeXBlKGV4cGVjdGVkKTsgLy8gV2UgZG9uJ3Qgd2FudCB0byB2YWxpZGF0ZVxuXG5cdCAgICAgICAgaWYgKGV4cGVjdGVkID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IHRydWU7IC8vIEV4cGVjdGVkIGlzIGEgcmVnZXhwXG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwicmVnZXhwXCIpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IGV4cGVjdGVkLnRlc3QoZXJyb3JTdHJpbmcoYWN0dWFsKSk7IC8vIExvZyB0aGUgc3RyaW5nIGZvcm0gb2YgdGhlIHJlZ2V4cFxuXG5cdCAgICAgICAgICBleHBlY3RlZCA9IFN0cmluZyhleHBlY3RlZCk7IC8vIEV4cGVjdGVkIGlzIGEgY29uc3RydWN0b3IsIG1heWJlIGFuIEVycm9yIGNvbnN0cnVjdG9yXG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwiZnVuY3Rpb25cIiAmJiBhY3R1YWwgaW5zdGFuY2VvZiBleHBlY3RlZCkge1xuXHQgICAgICAgICAgcmVzdWx0ID0gdHJ1ZTsgLy8gRXhwZWN0ZWQgaXMgYW4gRXJyb3Igb2JqZWN0XG5cdCAgICAgICAgfSBlbHNlIGlmIChleHBlY3RlZFR5cGUgPT09IFwib2JqZWN0XCIpIHtcblx0ICAgICAgICAgIHJlc3VsdCA9IGFjdHVhbCBpbnN0YW5jZW9mIGV4cGVjdGVkLmNvbnN0cnVjdG9yICYmIGFjdHVhbC5uYW1lID09PSBleHBlY3RlZC5uYW1lICYmIGFjdHVhbC5tZXNzYWdlID09PSBleHBlY3RlZC5tZXNzYWdlOyAvLyBMb2cgdGhlIHN0cmluZyBmb3JtIG9mIHRoZSBFcnJvciBvYmplY3RcblxuXHQgICAgICAgICAgZXhwZWN0ZWQgPSBlcnJvclN0cmluZyhleHBlY3RlZCk7IC8vIEV4cGVjdGVkIGlzIGEgdmFsaWRhdGlvbiBmdW5jdGlvbiB3aGljaCByZXR1cm5zIHRydWUgaWYgdmFsaWRhdGlvbiBwYXNzZWRcblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgaWYgKGV4cGVjdGVkVHlwZSA9PT0gXCJmdW5jdGlvblwiKSB7XG5cdCAgICAgICAgICAgIHJlc3VsdCA9IGV4cGVjdGVkLmNhbGwoe30sIGFjdHVhbCkgPT09IHRydWU7XG5cdCAgICAgICAgICAgIGV4cGVjdGVkID0gbnVsbDsgLy8gRXhwZWN0ZWQgaXMgc29tZSBvdGhlciBpbnZhbGlkIHR5cGVcblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIHJlc3VsdCA9IGZhbHNlO1xuXHQgICAgICAgICAgICBtZXNzYWdlID0gXCJpbnZhbGlkIGV4cGVjdGVkIHZhbHVlIHByb3ZpZGVkIHRvIGBhc3NlcnQucmVqZWN0c2AgXCIgKyBcImNhbGxiYWNrIGluIFxcXCJcIiArIGN1cnJlbnRUZXN0LnRlc3ROYW1lICsgXCJcXFwiOiBcIiArIGV4cGVjdGVkVHlwZSArIFwiLlwiO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGN1cnJlbnRUZXN0LmFzc2VydC5wdXNoUmVzdWx0KHtcblx0ICAgICAgICAgIHJlc3VsdDogcmVzdWx0LFxuXHQgICAgICAgICAgLy8gbGVhdmUgcmVqZWN0aW9uIHZhbHVlIG9mIHVuZGVmaW5lZCBhcy1pc1xuXHQgICAgICAgICAgYWN0dWFsOiBhY3R1YWwgJiYgZXJyb3JTdHJpbmcoYWN0dWFsKSxcblx0ICAgICAgICAgIGV4cGVjdGVkOiBleHBlY3RlZCxcblx0ICAgICAgICAgIG1lc3NhZ2U6IG1lc3NhZ2Vcblx0ICAgICAgICB9KTtcblx0ICAgICAgICBkb25lKCk7XG5cdCAgICAgIH0pO1xuXHQgICAgfVxuXHQgIH1dKTtcblxuXHQgIHJldHVybiBBc3NlcnQ7XG5cdH0oKTsgLy8gUHJvdmlkZSBhbiBhbHRlcm5hdGl2ZSB0byBhc3NlcnQudGhyb3dzKCksIGZvciBlbnZpcm9ubWVudHMgdGhhdCBjb25zaWRlciB0aHJvd3MgYSByZXNlcnZlZCB3b3JkXG5cdC8vIEtub3duIHRvIHVzIGFyZTogQ2xvc3VyZSBDb21waWxlciwgTmFyd2hhbFxuXHQvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgZG90LW5vdGF0aW9uXG5cblxuXHRBc3NlcnQucHJvdG90eXBlLnJhaXNlcyA9IEFzc2VydC5wcm90b3R5cGVbXCJ0aHJvd3NcIl07XG5cdC8qKlxuXHQgKiBDb252ZXJ0cyBhbiBlcnJvciBpbnRvIGEgc2ltcGxlIHN0cmluZyBmb3IgY29tcGFyaXNvbnMuXG5cdCAqXG5cdCAqIEBwYXJhbSB7RXJyb3J8T2JqZWN0fSBlcnJvclxuXHQgKiBAcmV0dXJuIHtTdHJpbmd9XG5cdCAqL1xuXG5cdGZ1bmN0aW9uIGVycm9yU3RyaW5nKGVycm9yKSB7XG5cdCAgdmFyIHJlc3VsdEVycm9yU3RyaW5nID0gZXJyb3IudG9TdHJpbmcoKTsgLy8gSWYgdGhlIGVycm9yIHdhc24ndCBhIHN1YmNsYXNzIG9mIEVycm9yIGJ1dCBzb21ldGhpbmcgbGlrZVxuXHQgIC8vIGFuIG9iamVjdCBsaXRlcmFsIHdpdGggbmFtZSBhbmQgbWVzc2FnZSBwcm9wZXJ0aWVzLi4uXG5cblx0ICBpZiAocmVzdWx0RXJyb3JTdHJpbmcuc3Vic3RyaW5nKDAsIDcpID09PSBcIltvYmplY3RcIikge1xuXHQgICAgdmFyIG5hbWUgPSBlcnJvci5uYW1lID8gZXJyb3IubmFtZS50b1N0cmluZygpIDogXCJFcnJvclwiO1xuXHQgICAgdmFyIG1lc3NhZ2UgPSBlcnJvci5tZXNzYWdlID8gZXJyb3IubWVzc2FnZS50b1N0cmluZygpIDogXCJcIjtcblxuXHQgICAgaWYgKG5hbWUgJiYgbWVzc2FnZSkge1xuXHQgICAgICByZXR1cm4gXCJcIi5jb25jYXQobmFtZSwgXCI6IFwiKS5jb25jYXQobWVzc2FnZSk7XG5cdCAgICB9IGVsc2UgaWYgKG5hbWUpIHtcblx0ICAgICAgcmV0dXJuIG5hbWU7XG5cdCAgICB9IGVsc2UgaWYgKG1lc3NhZ2UpIHtcblx0ICAgICAgcmV0dXJuIG1lc3NhZ2U7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICByZXR1cm4gXCJFcnJvclwiO1xuXHQgICAgfVxuXHQgIH0gZWxzZSB7XG5cdCAgICByZXR1cm4gcmVzdWx0RXJyb3JTdHJpbmc7XG5cdCAgfVxuXHR9XG5cblx0LyogZ2xvYmFsIG1vZHVsZSwgZXhwb3J0cywgZGVmaW5lICovXG5cdGZ1bmN0aW9uIGV4cG9ydFFVbml0KFFVbml0KSB7XG5cdCAgaWYgKGRlZmluZWQuZG9jdW1lbnQpIHtcblx0ICAgIC8vIFFVbml0IG1heSBiZSBkZWZpbmVkIHdoZW4gaXQgaXMgcHJlY29uZmlndXJlZCBidXQgdGhlbiBvbmx5IFFVbml0IGFuZCBRVW5pdC5jb25maWcgbWF5IGJlIGRlZmluZWQuXG5cdCAgICBpZiAod2luZG93JDEuUVVuaXQgJiYgd2luZG93JDEuUVVuaXQudmVyc2lvbikge1xuXHQgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJRVW5pdCBoYXMgYWxyZWFkeSBiZWVuIGRlZmluZWQuXCIpO1xuXHQgICAgfVxuXG5cdCAgICB3aW5kb3ckMS5RVW5pdCA9IFFVbml0O1xuXHQgIH0gLy8gRm9yIG5vZGVqc1xuXG5cblx0ICBpZiAodHlwZW9mIG1vZHVsZSAhPT0gXCJ1bmRlZmluZWRcIiAmJiBtb2R1bGUgJiYgbW9kdWxlLmV4cG9ydHMpIHtcblx0ICAgIG1vZHVsZS5leHBvcnRzID0gUVVuaXQ7IC8vIEZvciBjb25zaXN0ZW5jeSB3aXRoIENvbW1vbkpTIGVudmlyb25tZW50cycgZXhwb3J0c1xuXG5cdCAgICBtb2R1bGUuZXhwb3J0cy5RVW5pdCA9IFFVbml0O1xuXHQgIH0gLy8gRm9yIENvbW1vbkpTIHdpdGggZXhwb3J0cywgYnV0IHdpdGhvdXQgbW9kdWxlLmV4cG9ydHMsIGxpa2UgUmhpbm9cblxuXG5cdCAgaWYgKHR5cGVvZiBleHBvcnRzICE9PSBcInVuZGVmaW5lZFwiICYmIGV4cG9ydHMpIHtcblx0ICAgIGV4cG9ydHMuUVVuaXQgPSBRVW5pdDtcblx0ICB9XG5cblx0ICBpZiAodHlwZW9mIGRlZmluZSA9PT0gXCJmdW5jdGlvblwiICYmIGRlZmluZS5hbWQpIHtcblx0ICAgIGRlZmluZShmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHJldHVybiBRVW5pdDtcblx0ICAgIH0pO1xuXHQgICAgUVVuaXQuY29uZmlnLmF1dG9zdGFydCA9IGZhbHNlO1xuXHQgIH0gLy8gRm9yIFdlYi9TZXJ2aWNlIFdvcmtlcnNcblxuXG5cdCAgaWYgKHNlbGYkMSAmJiBzZWxmJDEuV29ya2VyR2xvYmFsU2NvcGUgJiYgc2VsZiQxIGluc3RhbmNlb2Ygc2VsZiQxLldvcmtlckdsb2JhbFNjb3BlKSB7XG5cdCAgICBzZWxmJDEuUVVuaXQgPSBRVW5pdDtcblx0ICB9XG5cdH1cblxuXHQvLyBlcnJvciBoYW5kbGluZyBzaG91bGQgYmUgc3VwcHJlc3NlZCBhbmQgZmFsc2Ugb3RoZXJ3aXNlLlxuXHQvLyBJbiB0aGlzIGNhc2UsIHdlIHdpbGwgb25seSBzdXBwcmVzcyBmdXJ0aGVyIGVycm9yIGhhbmRsaW5nIGlmIHRoZVxuXHQvLyBcImlnbm9yZUdsb2JhbEVycm9yc1wiIGNvbmZpZ3VyYXRpb24gb3B0aW9uIGlzIGVuYWJsZWQuXG5cblx0ZnVuY3Rpb24gb25FcnJvcihlcnJvcikge1xuXHQgIGZvciAodmFyIF9sZW4gPSBhcmd1bWVudHMubGVuZ3RoLCBhcmdzID0gbmV3IEFycmF5KF9sZW4gPiAxID8gX2xlbiAtIDEgOiAwKSwgX2tleSA9IDE7IF9rZXkgPCBfbGVuOyBfa2V5KyspIHtcblx0ICAgIGFyZ3NbX2tleSAtIDFdID0gYXJndW1lbnRzW19rZXldO1xuXHQgIH1cblxuXHQgIGlmIChjb25maWcuY3VycmVudCkge1xuXHQgICAgaWYgKGNvbmZpZy5jdXJyZW50Lmlnbm9yZUdsb2JhbEVycm9ycykge1xuXHQgICAgICByZXR1cm4gdHJ1ZTtcblx0ICAgIH1cblxuXHQgICAgcHVzaEZhaWx1cmUuYXBwbHkodm9pZCAwLCBbZXJyb3IubWVzc2FnZSwgZXJyb3Iuc3RhY2t0cmFjZSB8fCBlcnJvci5maWxlTmFtZSArIFwiOlwiICsgZXJyb3IubGluZU51bWJlcl0uY29uY2F0KGFyZ3MpKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdGVzdChcImdsb2JhbCBmYWlsdXJlXCIsIGV4dGVuZChmdW5jdGlvbiAoKSB7XG5cdCAgICAgIHB1c2hGYWlsdXJlLmFwcGx5KHZvaWQgMCwgW2Vycm9yLm1lc3NhZ2UsIGVycm9yLnN0YWNrdHJhY2UgfHwgZXJyb3IuZmlsZU5hbWUgKyBcIjpcIiArIGVycm9yLmxpbmVOdW1iZXJdLmNvbmNhdChhcmdzKSk7XG5cdCAgICB9LCB7XG5cdCAgICAgIHZhbGlkVGVzdDogdHJ1ZVxuXHQgICAgfSkpO1xuXHQgIH1cblxuXHQgIHJldHVybiBmYWxzZTtcblx0fVxuXG5cdGZ1bmN0aW9uIG9uVW5oYW5kbGVkUmVqZWN0aW9uKHJlYXNvbikge1xuXHQgIHZhciByZXN1bHRJbmZvID0ge1xuXHQgICAgcmVzdWx0OiBmYWxzZSxcblx0ICAgIG1lc3NhZ2U6IHJlYXNvbi5tZXNzYWdlIHx8IFwiZXJyb3JcIixcblx0ICAgIGFjdHVhbDogcmVhc29uLFxuXHQgICAgc291cmNlOiByZWFzb24uc3RhY2sgfHwgc291cmNlRnJvbVN0YWNrdHJhY2UoMylcblx0ICB9O1xuXHQgIHZhciBjdXJyZW50VGVzdCA9IGNvbmZpZy5jdXJyZW50O1xuXG5cdCAgaWYgKGN1cnJlbnRUZXN0KSB7XG5cdCAgICBjdXJyZW50VGVzdC5hc3NlcnQucHVzaFJlc3VsdChyZXN1bHRJbmZvKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdGVzdChcImdsb2JhbCBmYWlsdXJlXCIsIGV4dGVuZChmdW5jdGlvbiAoYXNzZXJ0KSB7XG5cdCAgICAgIGFzc2VydC5wdXNoUmVzdWx0KHJlc3VsdEluZm8pO1xuXHQgICAgfSwge1xuXHQgICAgICB2YWxpZFRlc3Q6IHRydWVcblx0ICAgIH0pKTtcblx0ICB9XG5cdH1cblxuXHR2YXIgUVVuaXQgPSB7fTtcblx0dmFyIGdsb2JhbFN1aXRlID0gbmV3IFN1aXRlUmVwb3J0KCk7IC8vIFRoZSBpbml0aWFsIFwiY3VycmVudE1vZHVsZVwiIHJlcHJlc2VudHMgdGhlIGdsb2JhbCAob3IgdG9wLWxldmVsKSBtb2R1bGUgdGhhdFxuXHQvLyBpcyBub3QgZXhwbGljaXRseSBkZWZpbmVkIGJ5IHRoZSB1c2VyLCB0aGVyZWZvcmUgd2UgYWRkIHRoZSBcImdsb2JhbFN1aXRlXCIgdG9cblx0Ly8gaXQgc2luY2UgZWFjaCBtb2R1bGUgaGFzIGEgc3VpdGVSZXBvcnQgYXNzb2NpYXRlZCB3aXRoIGl0LlxuXG5cdGNvbmZpZy5jdXJyZW50TW9kdWxlLnN1aXRlUmVwb3J0ID0gZ2xvYmFsU3VpdGU7XG5cdHZhciBnbG9iYWxTdGFydENhbGxlZCA9IGZhbHNlO1xuXHR2YXIgcnVuU3RhcnRlZCA9IGZhbHNlOyAvLyBGaWd1cmUgb3V0IGlmIHdlJ3JlIHJ1bm5pbmcgdGhlIHRlc3RzIGZyb20gYSBzZXJ2ZXIgb3Igbm90XG5cblx0UVVuaXQuaXNMb2NhbCA9ICEoZGVmaW5lZC5kb2N1bWVudCAmJiB3aW5kb3ckMS5sb2NhdGlvbi5wcm90b2NvbCAhPT0gXCJmaWxlOlwiKTsgLy8gRXhwb3NlIHRoZSBjdXJyZW50IFFVbml0IHZlcnNpb25cblxuXHRRVW5pdC52ZXJzaW9uID0gXCIyLjExLjNcIjtcblx0ZXh0ZW5kKFFVbml0LCB7XG5cdCAgb246IG9uLFxuXHQgIG1vZHVsZTogbW9kdWxlJDEsXG5cdCAgdGVzdDogdGVzdCxcblx0ICB0b2RvOiB0b2RvLFxuXHQgIHNraXA6IHNraXAsXG5cdCAgb25seTogb25seSxcblx0ICBzdGFydDogZnVuY3Rpb24gc3RhcnQoY291bnQpIHtcblx0ICAgIHZhciBnbG9iYWxTdGFydEFscmVhZHlDYWxsZWQgPSBnbG9iYWxTdGFydENhbGxlZDtcblxuXHQgICAgaWYgKCFjb25maWcuY3VycmVudCkge1xuXHQgICAgICBnbG9iYWxTdGFydENhbGxlZCA9IHRydWU7XG5cblx0ICAgICAgaWYgKHJ1blN0YXJ0ZWQpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYWxsZWQgc3RhcnQoKSB3aGlsZSB0ZXN0IGFscmVhZHkgc3RhcnRlZCBydW5uaW5nXCIpO1xuXHQgICAgICB9IGVsc2UgaWYgKGdsb2JhbFN0YXJ0QWxyZWFkeUNhbGxlZCB8fCBjb3VudCA+IDEpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYWxsZWQgc3RhcnQoKSBvdXRzaWRlIG9mIGEgdGVzdCBjb250ZXh0IHRvbyBtYW55IHRpbWVzXCIpO1xuXHQgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5hdXRvc3RhcnQpIHtcblx0ICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJDYWxsZWQgc3RhcnQoKSBvdXRzaWRlIG9mIGEgdGVzdCBjb250ZXh0IHdoZW4gXCIgKyBcIlFVbml0LmNvbmZpZy5hdXRvc3RhcnQgd2FzIHRydWVcIik7XG5cdCAgICAgIH0gZWxzZSBpZiAoIWNvbmZpZy5wYWdlTG9hZGVkKSB7XG5cdCAgICAgICAgLy8gVGhlIHBhZ2UgaXNuJ3QgY29tcGxldGVseSBsb2FkZWQgeWV0LCBzbyB3ZSBzZXQgYXV0b3N0YXJ0IGFuZCB0aGVuXG5cdCAgICAgICAgLy8gbG9hZCBpZiB3ZSdyZSBpbiBOb2RlIG9yIHdhaXQgZm9yIHRoZSBicm93c2VyJ3MgbG9hZCBldmVudC5cblx0ICAgICAgICBjb25maWcuYXV0b3N0YXJ0ID0gdHJ1ZTsgLy8gU3RhcnRzIGZyb20gTm9kZSBldmVuIGlmIC5sb2FkIHdhcyBub3QgcHJldmlvdXNseSBjYWxsZWQuIFdlIHN0aWxsIHJldHVyblxuXHQgICAgICAgIC8vIGVhcmx5IG90aGVyd2lzZSB3ZSdsbCB3aW5kIHVwIFwiYmVnaW5uaW5nXCIgdHdpY2UuXG5cblx0ICAgICAgICBpZiAoIWRlZmluZWQuZG9jdW1lbnQpIHtcblx0ICAgICAgICAgIFFVbml0LmxvYWQoKTtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICByZXR1cm47XG5cdCAgICAgIH1cblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcIlFVbml0LnN0YXJ0IGNhbm5vdCBiZSBjYWxsZWQgaW5zaWRlIGEgdGVzdCBjb250ZXh0LlwiKTtcblx0ICAgIH1cblxuXHQgICAgc2NoZWR1bGVCZWdpbigpO1xuXHQgIH0sXG5cdCAgY29uZmlnOiBjb25maWcsXG5cdCAgaXM6IGlzLFxuXHQgIG9iamVjdFR5cGU6IG9iamVjdFR5cGUsXG5cdCAgZXh0ZW5kOiBleHRlbmQsXG5cdCAgbG9hZDogZnVuY3Rpb24gbG9hZCgpIHtcblx0ICAgIGNvbmZpZy5wYWdlTG9hZGVkID0gdHJ1ZTsgLy8gSW5pdGlhbGl6ZSB0aGUgY29uZmlndXJhdGlvbiBvcHRpb25zXG5cblx0ICAgIGV4dGVuZChjb25maWcsIHtcblx0ICAgICAgc3RhdHM6IHtcblx0ICAgICAgICBhbGw6IDAsXG5cdCAgICAgICAgYmFkOiAwLFxuXHQgICAgICAgIHRlc3RDb3VudDogMFxuXHQgICAgICB9LFxuXHQgICAgICBzdGFydGVkOiAwLFxuXHQgICAgICB1cGRhdGVSYXRlOiAxMDAwLFxuXHQgICAgICBhdXRvc3RhcnQ6IHRydWUsXG5cdCAgICAgIGZpbHRlcjogXCJcIlxuXHQgICAgfSwgdHJ1ZSk7XG5cblx0ICAgIGlmICghcnVuU3RhcnRlZCkge1xuXHQgICAgICBjb25maWcuYmxvY2tpbmcgPSBmYWxzZTtcblxuXHQgICAgICBpZiAoY29uZmlnLmF1dG9zdGFydCkge1xuXHQgICAgICAgIHNjaGVkdWxlQmVnaW4oKTtcblx0ICAgICAgfVxuXHQgICAgfVxuXHQgIH0sXG5cdCAgc3RhY2s6IGZ1bmN0aW9uIHN0YWNrKG9mZnNldCkge1xuXHQgICAgb2Zmc2V0ID0gKG9mZnNldCB8fCAwKSArIDI7XG5cdCAgICByZXR1cm4gc291cmNlRnJvbVN0YWNrdHJhY2Uob2Zmc2V0KTtcblx0ICB9LFxuXHQgIG9uRXJyb3I6IG9uRXJyb3IsXG5cdCAgb25VbmhhbmRsZWRSZWplY3Rpb246IG9uVW5oYW5kbGVkUmVqZWN0aW9uXG5cdH0pO1xuXHRRVW5pdC5wdXNoRmFpbHVyZSA9IHB1c2hGYWlsdXJlO1xuXHRRVW5pdC5hc3NlcnQgPSBBc3NlcnQucHJvdG90eXBlO1xuXHRRVW5pdC5lcXVpdiA9IGVxdWl2O1xuXHRRVW5pdC5kdW1wID0gZHVtcDtcblx0cmVnaXN0ZXJMb2dnaW5nQ2FsbGJhY2tzKFFVbml0KTtcblxuXHRmdW5jdGlvbiBzY2hlZHVsZUJlZ2luKCkge1xuXHQgIHJ1blN0YXJ0ZWQgPSB0cnVlOyAvLyBBZGQgYSBzbGlnaHQgZGVsYXkgdG8gYWxsb3cgZGVmaW5pdGlvbiBvZiBtb3JlIG1vZHVsZXMgYW5kIHRlc3RzLlxuXG5cdCAgaWYgKGRlZmluZWQuc2V0VGltZW91dCkge1xuXHQgICAgc2V0VGltZW91dCQxKGZ1bmN0aW9uICgpIHtcblx0ICAgICAgYmVnaW4oKTtcblx0ICAgIH0pO1xuXHQgIH0gZWxzZSB7XG5cdCAgICBiZWdpbigpO1xuXHQgIH1cblx0fVxuXG5cdGZ1bmN0aW9uIHVuYmxvY2tBbmRBZHZhbmNlUXVldWUoKSB7XG5cdCAgY29uZmlnLmJsb2NraW5nID0gZmFsc2U7XG5cdCAgUHJvY2Vzc2luZ1F1ZXVlLmFkdmFuY2UoKTtcblx0fVxuXG5cdGZ1bmN0aW9uIGJlZ2luKCkge1xuXHQgIHZhciBpLFxuXHQgICAgICBsLFxuXHQgICAgICBtb2R1bGVzTG9nID0gW107IC8vIElmIHRoZSB0ZXN0IHJ1biBoYXNuJ3Qgb2ZmaWNpYWxseSBiZWd1biB5ZXRcblxuXHQgIGlmICghY29uZmlnLnN0YXJ0ZWQpIHtcblx0ICAgIC8vIFJlY29yZCB0aGUgdGltZSBvZiB0aGUgdGVzdCBydW4ncyBiZWdpbm5pbmdcblx0ICAgIGNvbmZpZy5zdGFydGVkID0gbm93KCk7IC8vIERlbGV0ZSB0aGUgbG9vc2UgdW5uYW1lZCBtb2R1bGUgaWYgdW51c2VkLlxuXG5cdCAgICBpZiAoY29uZmlnLm1vZHVsZXNbMF0ubmFtZSA9PT0gXCJcIiAmJiBjb25maWcubW9kdWxlc1swXS50ZXN0cy5sZW5ndGggPT09IDApIHtcblx0ICAgICAgY29uZmlnLm1vZHVsZXMuc2hpZnQoKTtcblx0ICAgIH0gLy8gQXZvaWQgdW5uZWNlc3NhcnkgaW5mb3JtYXRpb24gYnkgbm90IGxvZ2dpbmcgbW9kdWxlcycgdGVzdCBlbnZpcm9ubWVudHNcblxuXG5cdCAgICBmb3IgKGkgPSAwLCBsID0gY29uZmlnLm1vZHVsZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7XG5cdCAgICAgIG1vZHVsZXNMb2cucHVzaCh7XG5cdCAgICAgICAgbmFtZTogY29uZmlnLm1vZHVsZXNbaV0ubmFtZSxcblx0ICAgICAgICB0ZXN0czogY29uZmlnLm1vZHVsZXNbaV0udGVzdHNcblx0ICAgICAgfSk7XG5cdCAgICB9IC8vIFRoZSB0ZXN0IHJ1biBpcyBvZmZpY2lhbGx5IGJlZ2lubmluZyBub3dcblxuXG5cdCAgICBlbWl0KFwicnVuU3RhcnRcIiwgZ2xvYmFsU3VpdGUuc3RhcnQodHJ1ZSkpO1xuXHQgICAgcnVuTG9nZ2luZ0NhbGxiYWNrcyhcImJlZ2luXCIsIHtcblx0ICAgICAgdG90YWxUZXN0czogVGVzdC5jb3VudCxcblx0ICAgICAgbW9kdWxlczogbW9kdWxlc0xvZ1xuXHQgICAgfSkudGhlbih1bmJsb2NrQW5kQWR2YW5jZVF1ZXVlKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgdW5ibG9ja0FuZEFkdmFuY2VRdWV1ZSgpO1xuXHQgIH1cblx0fVxuXHRleHBvcnRRVW5pdChRVW5pdCk7XG5cblx0KGZ1bmN0aW9uICgpIHtcblx0ICBpZiAodHlwZW9mIHdpbmRvdyQxID09PSBcInVuZGVmaW5lZFwiIHx8IHR5cGVvZiBkb2N1bWVudCQxID09PSBcInVuZGVmaW5lZFwiKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgdmFyIGNvbmZpZyA9IFFVbml0LmNvbmZpZyxcblx0ICAgICAgaGFzT3duID0gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eTsgLy8gU3RvcmVzIGZpeHR1cmUgSFRNTCBmb3IgcmVzZXR0aW5nIGxhdGVyXG5cblx0ICBmdW5jdGlvbiBzdG9yZUZpeHR1cmUoKSB7XG5cdCAgICAvLyBBdm9pZCBvdmVyd3JpdGluZyB1c2VyLWRlZmluZWQgdmFsdWVzXG5cdCAgICBpZiAoaGFzT3duLmNhbGwoY29uZmlnLCBcImZpeHR1cmVcIikpIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICB2YXIgZml4dHVyZSA9IGRvY3VtZW50JDEuZ2V0RWxlbWVudEJ5SWQoXCJxdW5pdC1maXh0dXJlXCIpO1xuXG5cdCAgICBpZiAoZml4dHVyZSkge1xuXHQgICAgICBjb25maWcuZml4dHVyZSA9IGZpeHR1cmUuY2xvbmVOb2RlKHRydWUpO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIFFVbml0LmJlZ2luKHN0b3JlRml4dHVyZSk7IC8vIFJlc2V0cyB0aGUgZml4dHVyZSBET00gZWxlbWVudCBpZiBhdmFpbGFibGUuXG5cblx0ICBmdW5jdGlvbiByZXNldEZpeHR1cmUoKSB7XG5cdCAgICBpZiAoY29uZmlnLmZpeHR1cmUgPT0gbnVsbCkge1xuXHQgICAgICByZXR1cm47XG5cdCAgICB9XG5cblx0ICAgIHZhciBmaXh0dXJlID0gZG9jdW1lbnQkMS5nZXRFbGVtZW50QnlJZChcInF1bml0LWZpeHR1cmVcIik7XG5cblx0ICAgIHZhciByZXNldEZpeHR1cmVUeXBlID0gX3R5cGVvZihjb25maWcuZml4dHVyZSk7XG5cblx0ICAgIGlmIChyZXNldEZpeHR1cmVUeXBlID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgIC8vIHN1cHBvcnQgdXNlciBkZWZpbmVkIHZhbHVlcyBmb3IgYGNvbmZpZy5maXh0dXJlYFxuXHQgICAgICB2YXIgbmV3Rml4dHVyZSA9IGRvY3VtZW50JDEuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcblx0ICAgICAgbmV3Rml4dHVyZS5zZXRBdHRyaWJ1dGUoXCJpZFwiLCBcInF1bml0LWZpeHR1cmVcIik7XG5cdCAgICAgIG5ld0ZpeHR1cmUuaW5uZXJIVE1MID0gY29uZmlnLmZpeHR1cmU7XG5cdCAgICAgIGZpeHR1cmUucGFyZW50Tm9kZS5yZXBsYWNlQ2hpbGQobmV3Rml4dHVyZSwgZml4dHVyZSk7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB2YXIgY2xvbmVkRml4dHVyZSA9IGNvbmZpZy5maXh0dXJlLmNsb25lTm9kZSh0cnVlKTtcblx0ICAgICAgZml4dHVyZS5wYXJlbnROb2RlLnJlcGxhY2VDaGlsZChjbG9uZWRGaXh0dXJlLCBmaXh0dXJlKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBRVW5pdC50ZXN0U3RhcnQocmVzZXRGaXh0dXJlKTtcblx0fSkoKTtcblxuXHQoZnVuY3Rpb24gKCkge1xuXHQgIC8vIE9ubHkgaW50ZXJhY3Qgd2l0aCBVUkxzIHZpYSB3aW5kb3cubG9jYXRpb25cblx0ICB2YXIgbG9jYXRpb24gPSB0eXBlb2Ygd2luZG93JDEgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93JDEubG9jYXRpb247XG5cblx0ICBpZiAoIWxvY2F0aW9uKSB7XG5cdCAgICByZXR1cm47XG5cdCAgfVxuXG5cdCAgdmFyIHVybFBhcmFtcyA9IGdldFVybFBhcmFtcygpO1xuXHQgIFFVbml0LnVybFBhcmFtcyA9IHVybFBhcmFtczsgLy8gTWF0Y2ggbW9kdWxlL3Rlc3QgYnkgaW5jbHVzaW9uIGluIGFuIGFycmF5XG5cblx0ICBRVW5pdC5jb25maWcubW9kdWxlSWQgPSBbXS5jb25jYXQodXJsUGFyYW1zLm1vZHVsZUlkIHx8IFtdKTtcblx0ICBRVW5pdC5jb25maWcudGVzdElkID0gW10uY29uY2F0KHVybFBhcmFtcy50ZXN0SWQgfHwgW10pOyAvLyBFeGFjdCBjYXNlLWluc2Vuc2l0aXZlIG1hdGNoIG9mIHRoZSBtb2R1bGUgbmFtZVxuXG5cdCAgUVVuaXQuY29uZmlnLm1vZHVsZSA9IHVybFBhcmFtcy5tb2R1bGU7IC8vIFJlZ3VsYXIgZXhwcmVzc2lvbiBvciBjYXNlLWluc2Vuc3RpdmUgc3Vic3RyaW5nIG1hdGNoIGFnYWluc3QgXCJtb2R1bGVOYW1lOiB0ZXN0TmFtZVwiXG5cblx0ICBRVW5pdC5jb25maWcuZmlsdGVyID0gdXJsUGFyYW1zLmZpbHRlcjsgLy8gVGVzdCBvcmRlciByYW5kb21pemF0aW9uXG5cblx0ICBpZiAodXJsUGFyYW1zLnNlZWQgPT09IHRydWUpIHtcblx0ICAgIC8vIEdlbmVyYXRlIGEgcmFuZG9tIHNlZWQgaWYgdGhlIG9wdGlvbiBpcyBzcGVjaWZpZWQgd2l0aG91dCBhIHZhbHVlXG5cdCAgICBRVW5pdC5jb25maWcuc2VlZCA9IE1hdGgucmFuZG9tKCkudG9TdHJpbmcoMzYpLnNsaWNlKDIpO1xuXHQgIH0gZWxzZSBpZiAodXJsUGFyYW1zLnNlZWQpIHtcblx0ICAgIFFVbml0LmNvbmZpZy5zZWVkID0gdXJsUGFyYW1zLnNlZWQ7XG5cdCAgfSAvLyBBZGQgVVJMLXBhcmFtZXRlci1tYXBwZWQgY29uZmlnIHZhbHVlcyB3aXRoIFVJIGZvcm0gcmVuZGVyaW5nIGRhdGFcblxuXG5cdCAgUVVuaXQuY29uZmlnLnVybENvbmZpZy5wdXNoKHtcblx0ICAgIGlkOiBcImhpZGVwYXNzZWRcIixcblx0ICAgIGxhYmVsOiBcIkhpZGUgcGFzc2VkIHRlc3RzXCIsXG5cdCAgICB0b29sdGlwOiBcIk9ubHkgc2hvdyB0ZXN0cyBhbmQgYXNzZXJ0aW9ucyB0aGF0IGZhaWwuIFN0b3JlZCBhcyBxdWVyeS1zdHJpbmdzLlwiXG5cdCAgfSwge1xuXHQgICAgaWQ6IFwibm9nbG9iYWxzXCIsXG5cdCAgICBsYWJlbDogXCJDaGVjayBmb3IgR2xvYmFsc1wiLFxuXHQgICAgdG9vbHRpcDogXCJFbmFibGluZyB0aGlzIHdpbGwgdGVzdCBpZiBhbnkgdGVzdCBpbnRyb2R1Y2VzIG5ldyBwcm9wZXJ0aWVzIG9uIHRoZSBcIiArIFwiZ2xvYmFsIG9iamVjdCAoYHdpbmRvd2AgaW4gQnJvd3NlcnMpLiBTdG9yZWQgYXMgcXVlcnktc3RyaW5ncy5cIlxuXHQgIH0sIHtcblx0ICAgIGlkOiBcIm5vdHJ5Y2F0Y2hcIixcblx0ICAgIGxhYmVsOiBcIk5vIHRyeS1jYXRjaFwiLFxuXHQgICAgdG9vbHRpcDogXCJFbmFibGluZyB0aGlzIHdpbGwgcnVuIHRlc3RzIG91dHNpZGUgb2YgYSB0cnktY2F0Y2ggYmxvY2suIE1ha2VzIGRlYnVnZ2luZyBcIiArIFwiZXhjZXB0aW9ucyBpbiBJRSByZWFzb25hYmxlLiBTdG9yZWQgYXMgcXVlcnktc3RyaW5ncy5cIlxuXHQgIH0pO1xuXHQgIFFVbml0LmJlZ2luKGZ1bmN0aW9uICgpIHtcblx0ICAgIHZhciBpLFxuXHQgICAgICAgIG9wdGlvbixcblx0ICAgICAgICB1cmxDb25maWcgPSBRVW5pdC5jb25maWcudXJsQ29uZmlnO1xuXG5cdCAgICBmb3IgKGkgPSAwOyBpIDwgdXJsQ29uZmlnLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIC8vIE9wdGlvbnMgY2FuIGJlIGVpdGhlciBzdHJpbmdzIG9yIG9iamVjdHMgd2l0aCBub25lbXB0eSBcImlkXCIgcHJvcGVydGllc1xuXHQgICAgICBvcHRpb24gPSBRVW5pdC5jb25maWcudXJsQ29uZmlnW2ldO1xuXG5cdCAgICAgIGlmICh0eXBlb2Ygb3B0aW9uICE9PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgb3B0aW9uID0gb3B0aW9uLmlkO1xuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKFFVbml0LmNvbmZpZ1tvcHRpb25dID09PSB1bmRlZmluZWQpIHtcblx0ICAgICAgICBRVW5pdC5jb25maWdbb3B0aW9uXSA9IHVybFBhcmFtc1tvcHRpb25dO1xuXHQgICAgICB9XG5cdCAgICB9XG5cdCAgfSk7XG5cblx0ICBmdW5jdGlvbiBnZXRVcmxQYXJhbXMoKSB7XG5cdCAgICB2YXIgaSwgcGFyYW0sIG5hbWUsIHZhbHVlO1xuXHQgICAgdmFyIHVybFBhcmFtcyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG5cdCAgICB2YXIgcGFyYW1zID0gbG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpLnNwbGl0KFwiJlwiKTtcblx0ICAgIHZhciBsZW5ndGggPSBwYXJhbXMubGVuZ3RoO1xuXG5cdCAgICBmb3IgKGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgaWYgKHBhcmFtc1tpXSkge1xuXHQgICAgICAgIHBhcmFtID0gcGFyYW1zW2ldLnNwbGl0KFwiPVwiKTtcblx0ICAgICAgICBuYW1lID0gZGVjb2RlUXVlcnlQYXJhbShwYXJhbVswXSk7IC8vIEFsbG93IGp1c3QgYSBrZXkgdG8gdHVybiBvbiBhIGZsYWcsIGUuZy4sIHRlc3QuaHRtbD9ub2dsb2JhbHNcblxuXHQgICAgICAgIHZhbHVlID0gcGFyYW0ubGVuZ3RoID09PSAxIHx8IGRlY29kZVF1ZXJ5UGFyYW0ocGFyYW0uc2xpY2UoMSkuam9pbihcIj1cIikpO1xuXG5cdCAgICAgICAgaWYgKG5hbWUgaW4gdXJsUGFyYW1zKSB7XG5cdCAgICAgICAgICB1cmxQYXJhbXNbbmFtZV0gPSBbXS5jb25jYXQodXJsUGFyYW1zW25hbWVdLCB2YWx1ZSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHVybFBhcmFtc1tuYW1lXSA9IHZhbHVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gdXJsUGFyYW1zO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGRlY29kZVF1ZXJ5UGFyYW0ocGFyYW0pIHtcblx0ICAgIHJldHVybiBkZWNvZGVVUklDb21wb25lbnQocGFyYW0ucmVwbGFjZSgvXFwrL2csIFwiJTIwXCIpKTtcblx0ICB9XG5cdH0pKCk7XG5cblx0dmFyIGZ1enp5c29ydCA9IGNyZWF0ZUNvbW1vbmpzTW9kdWxlKGZ1bmN0aW9uIChtb2R1bGUpIHtcblxuXHQgIChmdW5jdGlvbiAocm9vdCwgVU1EKSB7XG5cdCAgICBpZiAoIG1vZHVsZS5leHBvcnRzKSBtb2R1bGUuZXhwb3J0cyA9IFVNRCgpO2Vsc2Ugcm9vdC5mdXp6eXNvcnQgPSBVTUQoKTtcblx0ICB9KShjb21tb25qc0dsb2JhbCwgZnVuY3Rpb24gVU1EKCkge1xuXHQgICAgZnVuY3Rpb24gZnV6enlzb3J0TmV3KGluc3RhbmNlT3B0aW9ucykge1xuXHQgICAgICB2YXIgZnV6enlzb3J0ID0ge1xuXHQgICAgICAgIHNpbmdsZTogZnVuY3Rpb24gKHNlYXJjaCwgdGFyZ2V0LCBvcHRpb25zKSB7XG5cdCAgICAgICAgICBpZiAoIXNlYXJjaCkgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgICBpZiAoIWlzT2JqKHNlYXJjaCkpIHNlYXJjaCA9IGZ1enp5c29ydC5nZXRQcmVwYXJlZFNlYXJjaChzZWFyY2gpO1xuXHQgICAgICAgICAgaWYgKCF0YXJnZXQpIHJldHVybiBudWxsO1xuXHQgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgIHZhciBhbGxvd1R5cG8gPSBvcHRpb25zICYmIG9wdGlvbnMuYWxsb3dUeXBvICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmFsbG93VHlwbyA6IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMuYWxsb3dUeXBvICE9PSB1bmRlZmluZWQgPyBpbnN0YW5jZU9wdGlvbnMuYWxsb3dUeXBvIDogdHJ1ZTtcblx0ICAgICAgICAgIHZhciBhbGdvcml0aG0gPSBhbGxvd1R5cG8gPyBmdXp6eXNvcnQuYWxnb3JpdGhtIDogZnV6enlzb3J0LmFsZ29yaXRobU5vVHlwbztcblx0ICAgICAgICAgIHJldHVybiBhbGdvcml0aG0oc2VhcmNoLCB0YXJnZXQsIHNlYXJjaFswXSk7IC8vIHZhciB0aHJlc2hvbGQgPSBvcHRpb25zICYmIG9wdGlvbnMudGhyZXNob2xkIHx8IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMudGhyZXNob2xkIHx8IC05MDA3MTk5MjU0NzQwOTkxXG5cdCAgICAgICAgICAvLyB2YXIgcmVzdWx0ID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hbMF0pXG5cdCAgICAgICAgICAvLyBpZihyZXN1bHQgPT09IG51bGwpIHJldHVybiBudWxsXG5cdCAgICAgICAgICAvLyBpZihyZXN1bHQuc2NvcmUgPCB0aHJlc2hvbGQpIHJldHVybiBudWxsXG5cdCAgICAgICAgICAvLyByZXR1cm4gcmVzdWx0XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBnbzogZnVuY3Rpb24gKHNlYXJjaCwgdGFyZ2V0cywgb3B0aW9ucykge1xuXHQgICAgICAgICAgaWYgKCFzZWFyY2gpIHJldHVybiBub1Jlc3VsdHM7XG5cdCAgICAgICAgICBzZWFyY2ggPSBmdXp6eXNvcnQucHJlcGFyZVNlYXJjaChzZWFyY2gpO1xuXHQgICAgICAgICAgdmFyIHNlYXJjaExvd2VyQ29kZSA9IHNlYXJjaFswXTtcblx0ICAgICAgICAgIHZhciB0aHJlc2hvbGQgPSBvcHRpb25zICYmIG9wdGlvbnMudGhyZXNob2xkIHx8IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMudGhyZXNob2xkIHx8IC05MDA3MTk5MjU0NzQwOTkxO1xuXHQgICAgICAgICAgdmFyIGxpbWl0ID0gb3B0aW9ucyAmJiBvcHRpb25zLmxpbWl0IHx8IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMubGltaXQgfHwgOTAwNzE5OTI1NDc0MDk5MTtcblx0ICAgICAgICAgIHZhciBhbGxvd1R5cG8gPSBvcHRpb25zICYmIG9wdGlvbnMuYWxsb3dUeXBvICE9PSB1bmRlZmluZWQgPyBvcHRpb25zLmFsbG93VHlwbyA6IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMuYWxsb3dUeXBvICE9PSB1bmRlZmluZWQgPyBpbnN0YW5jZU9wdGlvbnMuYWxsb3dUeXBvIDogdHJ1ZTtcblx0ICAgICAgICAgIHZhciBhbGdvcml0aG0gPSBhbGxvd1R5cG8gPyBmdXp6eXNvcnQuYWxnb3JpdGhtIDogZnV6enlzb3J0LmFsZ29yaXRobU5vVHlwbztcblx0ICAgICAgICAgIHZhciByZXN1bHRzTGVuID0gMDtcblx0ICAgICAgICAgIHZhciBsaW1pdGVkQ291bnQgPSAwO1xuXHQgICAgICAgICAgdmFyIHRhcmdldHNMZW4gPSB0YXJnZXRzLmxlbmd0aDsgLy8gVGhpcyBjb2RlIGlzIGNvcHkvcGFzdGVkIDMgdGltZXMgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMgW29wdGlvbnMua2V5cywgb3B0aW9ucy5rZXksIG5vIGtleXNdXG5cdCAgICAgICAgICAvLyBvcHRpb25zLmtleXNcblxuXHQgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5rZXlzKSB7XG5cdCAgICAgICAgICAgIHZhciBzY29yZUZuID0gb3B0aW9ucy5zY29yZUZuIHx8IGRlZmF1bHRTY29yZUZuO1xuXHQgICAgICAgICAgICB2YXIga2V5cyA9IG9wdGlvbnMua2V5cztcblx0ICAgICAgICAgICAgdmFyIGtleXNMZW4gPSBrZXlzLmxlbmd0aDtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gdGFyZ2V0c0xlbiAtIDE7IGkgPj0gMDsgLS1pKSB7XG5cdCAgICAgICAgICAgICAgdmFyIG9iaiA9IHRhcmdldHNbaV07XG5cdCAgICAgICAgICAgICAgdmFyIG9ialJlc3VsdHMgPSBuZXcgQXJyYXkoa2V5c0xlbik7XG5cblx0ICAgICAgICAgICAgICBmb3IgKHZhciBrZXlJID0ga2V5c0xlbiAtIDE7IGtleUkgPj0gMDsgLS1rZXlJKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIga2V5ID0ga2V5c1trZXlJXTtcblx0ICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSBnZXRWYWx1ZShvYmosIGtleSk7XG5cblx0ICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG5cdCAgICAgICAgICAgICAgICAgIG9ialJlc3VsdHNba2V5SV0gPSBudWxsO1xuXHQgICAgICAgICAgICAgICAgICBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgICAgICAgIG9ialJlc3VsdHNba2V5SV0gPSBhbGdvcml0aG0oc2VhcmNoLCB0YXJnZXQsIHNlYXJjaExvd2VyQ29kZSk7XG5cdCAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgb2JqUmVzdWx0cy5vYmogPSBvYmo7IC8vIGJlZm9yZSBzY29yZUZuIHNvIHNjb3JlRm4gY2FuIHVzZSBpdFxuXG5cdCAgICAgICAgICAgICAgdmFyIHNjb3JlID0gc2NvcmVGbihvYmpSZXN1bHRzKTtcblx0ICAgICAgICAgICAgICBpZiAoc2NvcmUgPT09IG51bGwpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIGlmIChzY29yZSA8IHRocmVzaG9sZCkgY29udGludWU7XG5cdCAgICAgICAgICAgICAgb2JqUmVzdWx0cy5zY29yZSA9IHNjb3JlO1xuXG5cdCAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgcS5hZGQob2JqUmVzdWx0cyk7XG5cdCAgICAgICAgICAgICAgICArK3Jlc3VsdHNMZW47XG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICsrbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgICAgICAgaWYgKHNjb3JlID4gcS5wZWVrKCkuc2NvcmUpIHEucmVwbGFjZVRvcChvYmpSZXN1bHRzKTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH0gLy8gb3B0aW9ucy5rZXlcblxuXHQgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zICYmIG9wdGlvbnMua2V5KSB7XG5cdCAgICAgICAgICAgIHZhciBrZXkgPSBvcHRpb25zLmtleTtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gdGFyZ2V0c0xlbiAtIDE7IGkgPj0gMDsgLS1pKSB7XG5cdCAgICAgICAgICAgICAgdmFyIG9iaiA9IHRhcmdldHNbaV07XG5cdCAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldFZhbHVlKG9iaiwga2V5KTtcblx0ICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgY29udGludWU7XG5cdCAgICAgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hMb3dlckNvZGUpO1xuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlOyAvLyBoYXZlIHRvIGNsb25lIHJlc3VsdCBzbyBkdXBsaWNhdGUgdGFyZ2V0cyBmcm9tIGRpZmZlcmVudCBvYmogY2FuIGVhY2ggcmVmZXJlbmNlIHRoZSBjb3JyZWN0IG9ialxuXG5cdCAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuXHQgICAgICAgICAgICAgICAgdGFyZ2V0OiByZXN1bHQudGFyZ2V0LFxuXHQgICAgICAgICAgICAgICAgX3RhcmdldExvd2VyQ29kZXM6IG51bGwsXG5cdCAgICAgICAgICAgICAgICBfbmV4dEJlZ2lubmluZ0luZGV4ZXM6IG51bGwsXG5cdCAgICAgICAgICAgICAgICBzY29yZTogcmVzdWx0LnNjb3JlLFxuXHQgICAgICAgICAgICAgICAgaW5kZXhlczogcmVzdWx0LmluZGV4ZXMsXG5cdCAgICAgICAgICAgICAgICBvYmo6IG9ialxuXHQgICAgICAgICAgICAgIH07IC8vIGhpZGRlblxuXG5cdCAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgcS5hZGQocmVzdWx0KTtcblx0ICAgICAgICAgICAgICAgICsrcmVzdWx0c0xlbjtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgKytsaW1pdGVkQ291bnQ7XG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjb3JlID4gcS5wZWVrKCkuc2NvcmUpIHEucmVwbGFjZVRvcChyZXN1bHQpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSAvLyBubyBrZXlzXG5cblx0ICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgIGZvciAodmFyIGkgPSB0YXJnZXRzTGVuIC0gMTsgaSA+PSAwOyAtLWkpIHtcblx0ICAgICAgICAgICAgICB2YXIgdGFyZ2V0ID0gdGFyZ2V0c1tpXTtcblx0ICAgICAgICAgICAgICBpZiAoIXRhcmdldCkgY29udGludWU7XG5cdCAgICAgICAgICAgICAgaWYgKCFpc09iaih0YXJnZXQpKSB0YXJnZXQgPSBmdXp6eXNvcnQuZ2V0UHJlcGFyZWQodGFyZ2V0KTtcblx0ICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hMb3dlckNvZGUpO1xuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT09IG51bGwpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlO1xuXG5cdCAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgcS5hZGQocmVzdWx0KTtcblx0ICAgICAgICAgICAgICAgICsrcmVzdWx0c0xlbjtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgKytsaW1pdGVkQ291bnQ7XG5cdCAgICAgICAgICAgICAgICBpZiAocmVzdWx0LnNjb3JlID4gcS5wZWVrKCkuc2NvcmUpIHEucmVwbGFjZVRvcChyZXN1bHQpO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICBpZiAocmVzdWx0c0xlbiA9PT0gMCkgcmV0dXJuIG5vUmVzdWx0cztcblx0ICAgICAgICAgIHZhciByZXN1bHRzID0gbmV3IEFycmF5KHJlc3VsdHNMZW4pO1xuXG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gcmVzdWx0c0xlbiAtIDE7IGkgPj0gMDsgLS1pKSByZXN1bHRzW2ldID0gcS5wb2xsKCk7XG5cblx0ICAgICAgICAgIHJlc3VsdHMudG90YWwgPSByZXN1bHRzTGVuICsgbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgcmV0dXJuIHJlc3VsdHM7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBnb0FzeW5jOiBmdW5jdGlvbiAoc2VhcmNoLCB0YXJnZXRzLCBvcHRpb25zKSB7XG5cdCAgICAgICAgICB2YXIgY2FuY2VsZWQgPSBmYWxzZTtcblx0ICAgICAgICAgIHZhciBwID0gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkge1xuXHQgICAgICAgICAgICBpZiAoIXNlYXJjaCkgcmV0dXJuIHJlc29sdmUobm9SZXN1bHRzKTtcblx0ICAgICAgICAgICAgc2VhcmNoID0gZnV6enlzb3J0LnByZXBhcmVTZWFyY2goc2VhcmNoKTtcblx0ICAgICAgICAgICAgdmFyIHNlYXJjaExvd2VyQ29kZSA9IHNlYXJjaFswXTtcblx0ICAgICAgICAgICAgdmFyIHEgPSBmYXN0cHJpb3JpdHlxdWV1ZSgpO1xuXHQgICAgICAgICAgICB2YXIgaUN1cnJlbnQgPSB0YXJnZXRzLmxlbmd0aCAtIDE7XG5cdCAgICAgICAgICAgIHZhciB0aHJlc2hvbGQgPSBvcHRpb25zICYmIG9wdGlvbnMudGhyZXNob2xkIHx8IGluc3RhbmNlT3B0aW9ucyAmJiBpbnN0YW5jZU9wdGlvbnMudGhyZXNob2xkIHx8IC05MDA3MTk5MjU0NzQwOTkxO1xuXHQgICAgICAgICAgICB2YXIgbGltaXQgPSBvcHRpb25zICYmIG9wdGlvbnMubGltaXQgfHwgaW5zdGFuY2VPcHRpb25zICYmIGluc3RhbmNlT3B0aW9ucy5saW1pdCB8fCA5MDA3MTk5MjU0NzQwOTkxO1xuXHQgICAgICAgICAgICB2YXIgYWxsb3dUeXBvID0gb3B0aW9ucyAmJiBvcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gb3B0aW9ucy5hbGxvd1R5cG8gOiBpbnN0YW5jZU9wdGlvbnMgJiYgaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyAhPT0gdW5kZWZpbmVkID8gaW5zdGFuY2VPcHRpb25zLmFsbG93VHlwbyA6IHRydWU7XG5cdCAgICAgICAgICAgIHZhciBhbGdvcml0aG0gPSBhbGxvd1R5cG8gPyBmdXp6eXNvcnQuYWxnb3JpdGhtIDogZnV6enlzb3J0LmFsZ29yaXRobU5vVHlwbztcblx0ICAgICAgICAgICAgdmFyIHJlc3VsdHNMZW4gPSAwO1xuXHQgICAgICAgICAgICB2YXIgbGltaXRlZENvdW50ID0gMDtcblxuXHQgICAgICAgICAgICBmdW5jdGlvbiBzdGVwKCkge1xuXHQgICAgICAgICAgICAgIGlmIChjYW5jZWxlZCkgcmV0dXJuIHJlamVjdCgnY2FuY2VsZWQnKTtcblx0ICAgICAgICAgICAgICB2YXIgc3RhcnRNcyA9IERhdGUubm93KCk7IC8vIFRoaXMgY29kZSBpcyBjb3B5L3Bhc3RlZCAzIHRpbWVzIGZvciBwZXJmb3JtYW5jZSByZWFzb25zIFtvcHRpb25zLmtleXMsIG9wdGlvbnMua2V5LCBubyBrZXlzXVxuXHQgICAgICAgICAgICAgIC8vIG9wdGlvbnMua2V5c1xuXG5cdCAgICAgICAgICAgICAgaWYgKG9wdGlvbnMgJiYgb3B0aW9ucy5rZXlzKSB7XG5cdCAgICAgICAgICAgICAgICB2YXIgc2NvcmVGbiA9IG9wdGlvbnMuc2NvcmVGbiB8fCBkZWZhdWx0U2NvcmVGbjtcblx0ICAgICAgICAgICAgICAgIHZhciBrZXlzID0gb3B0aW9ucy5rZXlzO1xuXHQgICAgICAgICAgICAgICAgdmFyIGtleXNMZW4gPSBrZXlzLmxlbmd0aDtcblxuXHQgICAgICAgICAgICAgICAgZm9yICg7IGlDdXJyZW50ID49IDA7IC0taUN1cnJlbnQpIHtcblx0ICAgICAgICAgICAgICAgICAgdmFyIG9iaiA9IHRhcmdldHNbaUN1cnJlbnRdO1xuXHQgICAgICAgICAgICAgICAgICB2YXIgb2JqUmVzdWx0cyA9IG5ldyBBcnJheShrZXlzTGVuKTtcblxuXHQgICAgICAgICAgICAgICAgICBmb3IgKHZhciBrZXlJID0ga2V5c0xlbiAtIDE7IGtleUkgPj0gMDsgLS1rZXlJKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIGtleSA9IGtleXNba2V5SV07XG5cdCAgICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldFZhbHVlKG9iaiwga2V5KTtcblxuXHQgICAgICAgICAgICAgICAgICAgIGlmICghdGFyZ2V0KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICBvYmpSZXN1bHRzW2tleUldID0gbnVsbDtcblx0ICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgICAgIGlmICghaXNPYmoodGFyZ2V0KSkgdGFyZ2V0ID0gZnV6enlzb3J0LmdldFByZXBhcmVkKHRhcmdldCk7XG5cdCAgICAgICAgICAgICAgICAgICAgb2JqUmVzdWx0c1trZXlJXSA9IGFsZ29yaXRobShzZWFyY2gsIHRhcmdldCwgc2VhcmNoTG93ZXJDb2RlKTtcblx0ICAgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICAgIG9ialJlc3VsdHMub2JqID0gb2JqOyAvLyBiZWZvcmUgc2NvcmVGbiBzbyBzY29yZUZuIGNhbiB1c2UgaXRcblxuXHQgICAgICAgICAgICAgICAgICB2YXIgc2NvcmUgPSBzY29yZUZuKG9ialJlc3VsdHMpO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoc2NvcmUgPT09IG51bGwpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoc2NvcmUgPCB0aHJlc2hvbGQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgICAgICBvYmpSZXN1bHRzLnNjb3JlID0gc2NvcmU7XG5cblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHEuYWRkKG9ialJlc3VsdHMpO1xuXHQgICAgICAgICAgICAgICAgICAgICsrcmVzdWx0c0xlbjtcblx0ICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgICAgICArK2xpbWl0ZWRDb3VudDtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoc2NvcmUgPiBxLnBlZWsoKS5zY29yZSkgcS5yZXBsYWNlVG9wKG9ialJlc3VsdHMpO1xuXHQgICAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgICAgaWYgKGlDdXJyZW50ICUgMTAwMFxuXHQgICAgICAgICAgICAgICAgICAvKml0ZW1zUGVyQ2hlY2sqL1xuXHQgICAgICAgICAgICAgICAgICA9PT0gMCkge1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChEYXRlLm5vdygpIC0gc3RhcnRNcyA+PSAxMFxuXHQgICAgICAgICAgICAgICAgICAgIC8qYXN5bmNJbnRlcnZhbCovXG5cdCAgICAgICAgICAgICAgICAgICAgKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIGlzTm9kZSA/IHNldEltbWVkaWF0ZShzdGVwKSA6IHNldFRpbWVvdXQoc3RlcCk7XG5cdCAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcblx0ICAgICAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgfSAvLyBvcHRpb25zLmtleVxuXG5cdCAgICAgICAgICAgICAgfSBlbHNlIGlmIChvcHRpb25zICYmIG9wdGlvbnMua2V5KSB7XG5cdCAgICAgICAgICAgICAgICB2YXIga2V5ID0gb3B0aW9ucy5rZXk7XG5cblx0ICAgICAgICAgICAgICAgIGZvciAoOyBpQ3VycmVudCA+PSAwOyAtLWlDdXJyZW50KSB7XG5cdCAgICAgICAgICAgICAgICAgIHZhciBvYmogPSB0YXJnZXRzW2lDdXJyZW50XTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHRhcmdldCA9IGdldFZhbHVlKG9iaiwga2V5KTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoIWlzT2JqKHRhcmdldCkpIHRhcmdldCA9IGZ1enp5c29ydC5nZXRQcmVwYXJlZCh0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hMb3dlckNvZGUpO1xuXHQgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zY29yZSA8IHRocmVzaG9sZCkgY29udGludWU7IC8vIGhhdmUgdG8gY2xvbmUgcmVzdWx0IHNvIGR1cGxpY2F0ZSB0YXJnZXRzIGZyb20gZGlmZmVyZW50IG9iaiBjYW4gZWFjaCByZWZlcmVuY2UgdGhlIGNvcnJlY3Qgb2JqXG5cblx0ICAgICAgICAgICAgICAgICAgcmVzdWx0ID0ge1xuXHQgICAgICAgICAgICAgICAgICAgIHRhcmdldDogcmVzdWx0LnRhcmdldCxcblx0ICAgICAgICAgICAgICAgICAgICBfdGFyZ2V0TG93ZXJDb2RlczogbnVsbCxcblx0ICAgICAgICAgICAgICAgICAgICBfbmV4dEJlZ2lubmluZ0luZGV4ZXM6IG51bGwsXG5cdCAgICAgICAgICAgICAgICAgICAgc2NvcmU6IHJlc3VsdC5zY29yZSxcblx0ICAgICAgICAgICAgICAgICAgICBpbmRleGVzOiByZXN1bHQuaW5kZXhlcyxcblx0ICAgICAgICAgICAgICAgICAgICBvYmo6IG9ialxuXHQgICAgICAgICAgICAgICAgICB9OyAvLyBoaWRkZW5cblxuXHQgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0c0xlbiA8IGxpbWl0KSB7XG5cdCAgICAgICAgICAgICAgICAgICAgcS5hZGQocmVzdWx0KTtcblx0ICAgICAgICAgICAgICAgICAgICArK3Jlc3VsdHNMZW47XG5cdCAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgICAgKytsaW1pdGVkQ291bnQ7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zY29yZSA+IHEucGVlaygpLnNjb3JlKSBxLnJlcGxhY2VUb3AocmVzdWx0KTtcblx0ICAgICAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgICAgIGlmIChpQ3VycmVudCAlIDEwMDBcblx0ICAgICAgICAgICAgICAgICAgLyppdGVtc1BlckNoZWNrKi9cblx0ICAgICAgICAgICAgICAgICAgPT09IDApIHtcblx0ICAgICAgICAgICAgICAgICAgICBpZiAoRGF0ZS5ub3coKSAtIHN0YXJ0TXMgPj0gMTBcblx0ICAgICAgICAgICAgICAgICAgICAvKmFzeW5jSW50ZXJ2YWwqL1xuXHQgICAgICAgICAgICAgICAgICAgICkge1xuXHQgICAgICAgICAgICAgICAgICAgICAgICBpc05vZGUgPyBzZXRJbW1lZGlhdGUoc3RlcCkgOiBzZXRUaW1lb3V0KHN0ZXApO1xuXHQgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cdCAgICAgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgICAgIH0gLy8gbm8ga2V5c1xuXG5cdCAgICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICAgIGZvciAoOyBpQ3VycmVudCA+PSAwOyAtLWlDdXJyZW50KSB7XG5cdCAgICAgICAgICAgICAgICAgIHZhciB0YXJnZXQgPSB0YXJnZXRzW2lDdXJyZW50XTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKCF0YXJnZXQpIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgICAgICBpZiAoIWlzT2JqKHRhcmdldCkpIHRhcmdldCA9IGZ1enp5c29ydC5nZXRQcmVwYXJlZCh0YXJnZXQpO1xuXHQgICAgICAgICAgICAgICAgICB2YXIgcmVzdWx0ID0gYWxnb3JpdGhtKHNlYXJjaCwgdGFyZ2V0LCBzZWFyY2hMb3dlckNvZGUpO1xuXHQgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdC5zY29yZSA8IHRocmVzaG9sZCkgY29udGludWU7XG5cblx0ICAgICAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPCBsaW1pdCkge1xuXHQgICAgICAgICAgICAgICAgICAgIHEuYWRkKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICAgICAgKytyZXN1bHRzTGVuO1xuXHQgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgICAgICsrbGltaXRlZENvdW50O1xuXHQgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHQuc2NvcmUgPiBxLnBlZWsoKS5zY29yZSkgcS5yZXBsYWNlVG9wKHJlc3VsdCk7XG5cdCAgICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgICBpZiAoaUN1cnJlbnQgJSAxMDAwXG5cdCAgICAgICAgICAgICAgICAgIC8qaXRlbXNQZXJDaGVjayovXG5cdCAgICAgICAgICAgICAgICAgID09PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAgICAgaWYgKERhdGUubm93KCkgLSBzdGFydE1zID49IDEwXG5cdCAgICAgICAgICAgICAgICAgICAgLyphc3luY0ludGVydmFsKi9cblx0ICAgICAgICAgICAgICAgICAgICApIHtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgaXNOb2RlID8gc2V0SW1tZWRpYXRlKHN0ZXApIDogc2V0VGltZW91dChzdGVwKTtcblx0ICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXHQgICAgICAgICAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgICAgaWYgKHJlc3VsdHNMZW4gPT09IDApIHJldHVybiByZXNvbHZlKG5vUmVzdWx0cyk7XG5cdCAgICAgICAgICAgICAgdmFyIHJlc3VsdHMgPSBuZXcgQXJyYXkocmVzdWx0c0xlbik7XG5cblx0ICAgICAgICAgICAgICBmb3IgKHZhciBpID0gcmVzdWx0c0xlbiAtIDE7IGkgPj0gMDsgLS1pKSByZXN1bHRzW2ldID0gcS5wb2xsKCk7XG5cblx0ICAgICAgICAgICAgICByZXN1bHRzLnRvdGFsID0gcmVzdWx0c0xlbiArIGxpbWl0ZWRDb3VudDtcblx0ICAgICAgICAgICAgICByZXNvbHZlKHJlc3VsdHMpO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgaXNOb2RlID8gc2V0SW1tZWRpYXRlKHN0ZXApIDogc3RlcCgpO1xuXHQgICAgICAgICAgfSk7XG5cblx0ICAgICAgICAgIHAuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICAgICAgICBjYW5jZWxlZCA9IHRydWU7XG5cdCAgICAgICAgICB9O1xuXG5cdCAgICAgICAgICByZXR1cm4gcDtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGhpZ2hsaWdodDogZnVuY3Rpb24gKHJlc3VsdCwgaE9wZW4sIGhDbG9zZSkge1xuXHQgICAgICAgICAgaWYgKHJlc3VsdCA9PT0gbnVsbCkgcmV0dXJuIG51bGw7XG5cdCAgICAgICAgICBpZiAoaE9wZW4gPT09IHVuZGVmaW5lZCkgaE9wZW4gPSAnPGI+Jztcblx0ICAgICAgICAgIGlmIChoQ2xvc2UgPT09IHVuZGVmaW5lZCkgaENsb3NlID0gJzwvYj4nO1xuXHQgICAgICAgICAgdmFyIGhpZ2hsaWdodGVkID0gJyc7XG5cdCAgICAgICAgICB2YXIgbWF0Y2hlc0luZGV4ID0gMDtcblx0ICAgICAgICAgIHZhciBvcGVuZWQgPSBmYWxzZTtcblx0ICAgICAgICAgIHZhciB0YXJnZXQgPSByZXN1bHQudGFyZ2V0O1xuXHQgICAgICAgICAgdmFyIHRhcmdldExlbiA9IHRhcmdldC5sZW5ndGg7XG5cdCAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3QgPSByZXN1bHQuaW5kZXhlcztcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXJnZXRMZW47ICsraSkge1xuXHQgICAgICAgICAgICB2YXIgY2hhciA9IHRhcmdldFtpXTtcblxuXHQgICAgICAgICAgICBpZiAobWF0Y2hlc0Jlc3RbbWF0Y2hlc0luZGV4XSA9PT0gaSkge1xuXHQgICAgICAgICAgICAgICsrbWF0Y2hlc0luZGV4O1xuXG5cdCAgICAgICAgICAgICAgaWYgKCFvcGVuZWQpIHtcblx0ICAgICAgICAgICAgICAgIG9wZW5lZCA9IHRydWU7XG5cdCAgICAgICAgICAgICAgICBoaWdobGlnaHRlZCArPSBoT3Blbjtcblx0ICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICBpZiAobWF0Y2hlc0luZGV4ID09PSBtYXRjaGVzQmVzdC5sZW5ndGgpIHtcblx0ICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkICs9IGNoYXIgKyBoQ2xvc2UgKyB0YXJnZXQuc3Vic3RyKGkgKyAxKTtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICBpZiAob3BlbmVkKSB7XG5cdCAgICAgICAgICAgICAgICBvcGVuZWQgPSBmYWxzZTtcblx0ICAgICAgICAgICAgICAgIGhpZ2hsaWdodGVkICs9IGhDbG9zZTtcblx0ICAgICAgICAgICAgICB9XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBoaWdobGlnaHRlZCArPSBjaGFyO1xuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICByZXR1cm4gaGlnaGxpZ2h0ZWQ7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBwcmVwYXJlOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cdCAgICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuO1xuXHQgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG5cdCAgICAgICAgICAgIF90YXJnZXRMb3dlckNvZGVzOiBmdXp6eXNvcnQucHJlcGFyZUxvd2VyQ29kZXModGFyZ2V0KSxcblx0ICAgICAgICAgICAgX25leHRCZWdpbm5pbmdJbmRleGVzOiBudWxsLFxuXHQgICAgICAgICAgICBzY29yZTogbnVsbCxcblx0ICAgICAgICAgICAgaW5kZXhlczogbnVsbCxcblx0ICAgICAgICAgICAgb2JqOiBudWxsXG5cdCAgICAgICAgICB9OyAvLyBoaWRkZW5cblx0ICAgICAgICB9LFxuXHQgICAgICAgIHByZXBhcmVTbG93OiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cdCAgICAgICAgICBpZiAoIXRhcmdldCkgcmV0dXJuO1xuXHQgICAgICAgICAgcmV0dXJuIHtcblx0ICAgICAgICAgICAgdGFyZ2V0OiB0YXJnZXQsXG5cdCAgICAgICAgICAgIF90YXJnZXRMb3dlckNvZGVzOiBmdXp6eXNvcnQucHJlcGFyZUxvd2VyQ29kZXModGFyZ2V0KSxcblx0ICAgICAgICAgICAgX25leHRCZWdpbm5pbmdJbmRleGVzOiBmdXp6eXNvcnQucHJlcGFyZU5leHRCZWdpbm5pbmdJbmRleGVzKHRhcmdldCksXG5cdCAgICAgICAgICAgIHNjb3JlOiBudWxsLFxuXHQgICAgICAgICAgICBpbmRleGVzOiBudWxsLFxuXHQgICAgICAgICAgICBvYmo6IG51bGxcblx0ICAgICAgICAgIH07IC8vIGhpZGRlblxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgcHJlcGFyZVNlYXJjaDogZnVuY3Rpb24gKHNlYXJjaCkge1xuXHQgICAgICAgICAgaWYgKCFzZWFyY2gpIHJldHVybjtcblx0ICAgICAgICAgIHJldHVybiBmdXp6eXNvcnQucHJlcGFyZUxvd2VyQ29kZXMoc2VhcmNoKTtcblx0ICAgICAgICB9LFxuXHQgICAgICAgIC8vIEJlbG93IHRoaXMgcG9pbnQgaXMgb25seSBpbnRlcm5hbCBjb2RlXG5cdCAgICAgICAgLy8gQmVsb3cgdGhpcyBwb2ludCBpcyBvbmx5IGludGVybmFsIGNvZGVcblx0ICAgICAgICAvLyBCZWxvdyB0aGlzIHBvaW50IGlzIG9ubHkgaW50ZXJuYWwgY29kZVxuXHQgICAgICAgIC8vIEJlbG93IHRoaXMgcG9pbnQgaXMgb25seSBpbnRlcm5hbCBjb2RlXG5cdCAgICAgICAgZ2V0UHJlcGFyZWQ6IGZ1bmN0aW9uICh0YXJnZXQpIHtcblx0ICAgICAgICAgIGlmICh0YXJnZXQubGVuZ3RoID4gOTk5KSByZXR1cm4gZnV6enlzb3J0LnByZXBhcmUodGFyZ2V0KTsgLy8gZG9uJ3QgY2FjaGUgaHVnZSB0YXJnZXRzXG5cblx0ICAgICAgICAgIHZhciB0YXJnZXRQcmVwYXJlZCA9IHByZXBhcmVkQ2FjaGUuZ2V0KHRhcmdldCk7XG5cdCAgICAgICAgICBpZiAodGFyZ2V0UHJlcGFyZWQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHRhcmdldFByZXBhcmVkO1xuXHQgICAgICAgICAgdGFyZ2V0UHJlcGFyZWQgPSBmdXp6eXNvcnQucHJlcGFyZSh0YXJnZXQpO1xuXHQgICAgICAgICAgcHJlcGFyZWRDYWNoZS5zZXQodGFyZ2V0LCB0YXJnZXRQcmVwYXJlZCk7XG5cdCAgICAgICAgICByZXR1cm4gdGFyZ2V0UHJlcGFyZWQ7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBnZXRQcmVwYXJlZFNlYXJjaDogZnVuY3Rpb24gKHNlYXJjaCkge1xuXHQgICAgICAgICAgaWYgKHNlYXJjaC5sZW5ndGggPiA5OTkpIHJldHVybiBmdXp6eXNvcnQucHJlcGFyZVNlYXJjaChzZWFyY2gpOyAvLyBkb24ndCBjYWNoZSBodWdlIHNlYXJjaGVzXG5cblx0ICAgICAgICAgIHZhciBzZWFyY2hQcmVwYXJlZCA9IHByZXBhcmVkU2VhcmNoQ2FjaGUuZ2V0KHNlYXJjaCk7XG5cdCAgICAgICAgICBpZiAoc2VhcmNoUHJlcGFyZWQgIT09IHVuZGVmaW5lZCkgcmV0dXJuIHNlYXJjaFByZXBhcmVkO1xuXHQgICAgICAgICAgc2VhcmNoUHJlcGFyZWQgPSBmdXp6eXNvcnQucHJlcGFyZVNlYXJjaChzZWFyY2gpO1xuXHQgICAgICAgICAgcHJlcGFyZWRTZWFyY2hDYWNoZS5zZXQoc2VhcmNoLCBzZWFyY2hQcmVwYXJlZCk7XG5cdCAgICAgICAgICByZXR1cm4gc2VhcmNoUHJlcGFyZWQ7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBhbGdvcml0aG06IGZ1bmN0aW9uIChzZWFyY2hMb3dlckNvZGVzLCBwcmVwYXJlZCwgc2VhcmNoTG93ZXJDb2RlKSB7XG5cdCAgICAgICAgICB2YXIgdGFyZ2V0TG93ZXJDb2RlcyA9IHByZXBhcmVkLl90YXJnZXRMb3dlckNvZGVzO1xuXHQgICAgICAgICAgdmFyIHNlYXJjaExlbiA9IHNlYXJjaExvd2VyQ29kZXMubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIHRhcmdldExlbiA9IHRhcmdldExvd2VyQ29kZXMubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIHNlYXJjaEkgPSAwOyAvLyB3aGVyZSB3ZSBhdFxuXG5cdCAgICAgICAgICB2YXIgdGFyZ2V0SSA9IDA7IC8vIHdoZXJlIHlvdSBhdFxuXG5cdCAgICAgICAgICB2YXIgdHlwb1NpbXBsZUkgPSAwO1xuXHQgICAgICAgICAgdmFyIG1hdGNoZXNTaW1wbGVMZW4gPSAwOyAvLyB2ZXJ5IGJhc2ljIGZ1enp5IG1hdGNoOyB0byByZW1vdmUgbm9uLW1hdGNoaW5nIHRhcmdldHMgQVNBUCFcblx0ICAgICAgICAgIC8vIHdhbGsgdGhyb3VnaCB0YXJnZXQuIGZpbmQgc2VxdWVudGlhbCBtYXRjaGVzLlxuXHQgICAgICAgICAgLy8gaWYgYWxsIGNoYXJzIGFyZW4ndCBmb3VuZCB0aGVuIGV4aXRcblxuXHQgICAgICAgICAgZm9yICg7Oykge1xuXHQgICAgICAgICAgICB2YXIgaXNNYXRjaCA9IHNlYXJjaExvd2VyQ29kZSA9PT0gdGFyZ2V0TG93ZXJDb2Rlc1t0YXJnZXRJXTtcblxuXHQgICAgICAgICAgICBpZiAoaXNNYXRjaCkge1xuXHQgICAgICAgICAgICAgIG1hdGNoZXNTaW1wbGVbbWF0Y2hlc1NpbXBsZUxlbisrXSA9IHRhcmdldEk7XG5cdCAgICAgICAgICAgICAgKytzZWFyY2hJO1xuXHQgICAgICAgICAgICAgIGlmIChzZWFyY2hJID09PSBzZWFyY2hMZW4pIGJyZWFrO1xuXHQgICAgICAgICAgICAgIHNlYXJjaExvd2VyQ29kZSA9IHNlYXJjaExvd2VyQ29kZXNbdHlwb1NpbXBsZUkgPT09IDAgPyBzZWFyY2hJIDogdHlwb1NpbXBsZUkgPT09IHNlYXJjaEkgPyBzZWFyY2hJICsgMSA6IHR5cG9TaW1wbGVJID09PSBzZWFyY2hJIC0gMSA/IHNlYXJjaEkgLSAxIDogc2VhcmNoSV07XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICArK3RhcmdldEk7XG5cblx0ICAgICAgICAgICAgaWYgKHRhcmdldEkgPj0gdGFyZ2V0TGVuKSB7XG5cdCAgICAgICAgICAgICAgLy8gRmFpbGVkIHRvIGZpbmQgc2VhcmNoSVxuXHQgICAgICAgICAgICAgIC8vIENoZWNrIGZvciB0eXBvIG9yIGV4aXRcblx0ICAgICAgICAgICAgICAvLyB3ZSBnbyBhcyBmYXIgYXMgcG9zc2libGUgYmVmb3JlIHRyeWluZyB0byB0cmFuc3Bvc2Vcblx0ICAgICAgICAgICAgICAvLyB0aGVuIHdlIHRyYW5zcG9zZSBiYWNrd2FyZHMgdW50aWwgd2UgcmVhY2ggdGhlIGJlZ2lubmluZ1xuXHQgICAgICAgICAgICAgIGZvciAoOzspIHtcblx0ICAgICAgICAgICAgICAgIGlmIChzZWFyY2hJIDw9IDEpIHJldHVybiBudWxsOyAvLyBub3QgYWxsb3dlZCB0byB0cmFuc3Bvc2UgZmlyc3QgY2hhclxuXG5cdCAgICAgICAgICAgICAgICBpZiAodHlwb1NpbXBsZUkgPT09IDApIHtcblx0ICAgICAgICAgICAgICAgICAgLy8gd2UgaGF2ZW4ndCB0cmllZCB0byB0cmFuc3Bvc2UgeWV0XG5cdCAgICAgICAgICAgICAgICAgIC0tc2VhcmNoSTtcblx0ICAgICAgICAgICAgICAgICAgdmFyIHNlYXJjaExvd2VyQ29kZU5ldyA9IHNlYXJjaExvd2VyQ29kZXNbc2VhcmNoSV07XG5cdCAgICAgICAgICAgICAgICAgIGlmIChzZWFyY2hMb3dlckNvZGUgPT09IHNlYXJjaExvd2VyQ29kZU5ldykgY29udGludWU7IC8vIGRvZXNuJ3QgbWFrZSBzZW5zZSB0byB0cmFuc3Bvc2UgYSByZXBlYXQgY2hhclxuXG5cdCAgICAgICAgICAgICAgICAgIHR5cG9TaW1wbGVJID0gc2VhcmNoSTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgIGlmICh0eXBvU2ltcGxlSSA9PT0gMSkgcmV0dXJuIG51bGw7IC8vIHJlYWNoZWQgdGhlIGVuZCBvZiB0aGUgbGluZSBmb3IgdHJhbnNwb3NpbmdcblxuXHQgICAgICAgICAgICAgICAgICAtLXR5cG9TaW1wbGVJO1xuXHQgICAgICAgICAgICAgICAgICBzZWFyY2hJID0gdHlwb1NpbXBsZUk7XG5cdCAgICAgICAgICAgICAgICAgIHNlYXJjaExvd2VyQ29kZSA9IHNlYXJjaExvd2VyQ29kZXNbc2VhcmNoSSArIDFdO1xuXHQgICAgICAgICAgICAgICAgICB2YXIgc2VhcmNoTG93ZXJDb2RlTmV3ID0gc2VhcmNoTG93ZXJDb2Rlc1tzZWFyY2hJXTtcblx0ICAgICAgICAgICAgICAgICAgaWYgKHNlYXJjaExvd2VyQ29kZSA9PT0gc2VhcmNoTG93ZXJDb2RlTmV3KSBjb250aW51ZTsgLy8gZG9lc24ndCBtYWtlIHNlbnNlIHRvIHRyYW5zcG9zZSBhIHJlcGVhdCBjaGFyXG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIG1hdGNoZXNTaW1wbGVMZW4gPSBzZWFyY2hJO1xuXHQgICAgICAgICAgICAgICAgdGFyZ2V0SSA9IG1hdGNoZXNTaW1wbGVbbWF0Y2hlc1NpbXBsZUxlbiAtIDFdICsgMTtcblx0ICAgICAgICAgICAgICAgIGJyZWFrO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXG5cdCAgICAgICAgICB2YXIgc2VhcmNoSSA9IDA7XG5cdCAgICAgICAgICB2YXIgdHlwb1N0cmljdEkgPSAwO1xuXHQgICAgICAgICAgdmFyIHN1Y2Nlc3NTdHJpY3QgPSBmYWxzZTtcblx0ICAgICAgICAgIHZhciBtYXRjaGVzU3RyaWN0TGVuID0gMDtcblx0ICAgICAgICAgIHZhciBuZXh0QmVnaW5uaW5nSW5kZXhlcyA9IHByZXBhcmVkLl9uZXh0QmVnaW5uaW5nSW5kZXhlcztcblx0ICAgICAgICAgIGlmIChuZXh0QmVnaW5uaW5nSW5kZXhlcyA9PT0gbnVsbCkgbmV4dEJlZ2lubmluZ0luZGV4ZXMgPSBwcmVwYXJlZC5fbmV4dEJlZ2lubmluZ0luZGV4ZXMgPSBmdXp6eXNvcnQucHJlcGFyZU5leHRCZWdpbm5pbmdJbmRleGVzKHByZXBhcmVkLnRhcmdldCk7XG5cdCAgICAgICAgICB2YXIgZmlyc3RQb3NzaWJsZUkgPSB0YXJnZXRJID0gbWF0Y2hlc1NpbXBsZVswXSA9PT0gMCA/IDAgOiBuZXh0QmVnaW5uaW5nSW5kZXhlc1ttYXRjaGVzU2ltcGxlWzBdIC0gMV07IC8vIE91ciB0YXJnZXQgc3RyaW5nIHN1Y2Nlc3NmdWxseSBtYXRjaGVkIGFsbCBjaGFyYWN0ZXJzIGluIHNlcXVlbmNlIVxuXHQgICAgICAgICAgLy8gTGV0J3MgdHJ5IGEgbW9yZSBhZHZhbmNlZCBhbmQgc3RyaWN0IHRlc3QgdG8gaW1wcm92ZSB0aGUgc2NvcmVcblx0ICAgICAgICAgIC8vIG9ubHkgY291bnQgaXQgYXMgYSBtYXRjaCBpZiBpdCdzIGNvbnNlY3V0aXZlIG9yIGEgYmVnaW5uaW5nIGNoYXJhY3RlciFcblxuXHQgICAgICAgICAgaWYgKHRhcmdldEkgIT09IHRhcmdldExlbikgZm9yICg7Oykge1xuXHQgICAgICAgICAgICBpZiAodGFyZ2V0SSA+PSB0YXJnZXRMZW4pIHtcblx0ICAgICAgICAgICAgICAvLyBXZSBmYWlsZWQgdG8gZmluZCBhIGdvb2Qgc3BvdCBmb3IgdGhpcyBzZWFyY2ggY2hhciwgZ28gYmFjayB0byB0aGUgcHJldmlvdXMgc2VhcmNoIGNoYXIgYW5kIGZvcmNlIGl0IGZvcndhcmRcblx0ICAgICAgICAgICAgICBpZiAoc2VhcmNoSSA8PSAwKSB7XG5cdCAgICAgICAgICAgICAgICAvLyBXZSBmYWlsZWQgdG8gcHVzaCBjaGFycyBmb3J3YXJkIGZvciBhIGJldHRlciBtYXRjaFxuXHQgICAgICAgICAgICAgICAgLy8gdHJhbnNwb3NlLCBzdGFydGluZyBmcm9tIHRoZSBiZWdpbm5pbmdcblx0ICAgICAgICAgICAgICAgICsrdHlwb1N0cmljdEk7XG5cdCAgICAgICAgICAgICAgICBpZiAodHlwb1N0cmljdEkgPiBzZWFyY2hMZW4gLSAyKSBicmVhaztcblx0ICAgICAgICAgICAgICAgIGlmIChzZWFyY2hMb3dlckNvZGVzW3R5cG9TdHJpY3RJXSA9PT0gc2VhcmNoTG93ZXJDb2Rlc1t0eXBvU3RyaWN0SSArIDFdKSBjb250aW51ZTsgLy8gZG9lc24ndCBtYWtlIHNlbnNlIHRvIHRyYW5zcG9zZSBhIHJlcGVhdCBjaGFyXG5cblx0ICAgICAgICAgICAgICAgIHRhcmdldEkgPSBmaXJzdFBvc3NpYmxlSTtcblx0ICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuXHQgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgIC0tc2VhcmNoSTtcblx0ICAgICAgICAgICAgICB2YXIgbGFzdE1hdGNoID0gbWF0Y2hlc1N0cmljdFstLW1hdGNoZXNTdHJpY3RMZW5dO1xuXHQgICAgICAgICAgICAgIHRhcmdldEkgPSBuZXh0QmVnaW5uaW5nSW5kZXhlc1tsYXN0TWF0Y2hdO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIHZhciBpc01hdGNoID0gc2VhcmNoTG93ZXJDb2Rlc1t0eXBvU3RyaWN0SSA9PT0gMCA/IHNlYXJjaEkgOiB0eXBvU3RyaWN0SSA9PT0gc2VhcmNoSSA/IHNlYXJjaEkgKyAxIDogdHlwb1N0cmljdEkgPT09IHNlYXJjaEkgLSAxID8gc2VhcmNoSSAtIDEgOiBzZWFyY2hJXSA9PT0gdGFyZ2V0TG93ZXJDb2Rlc1t0YXJnZXRJXTtcblxuXHQgICAgICAgICAgICAgIGlmIChpc01hdGNoKSB7XG5cdCAgICAgICAgICAgICAgICBtYXRjaGVzU3RyaWN0W21hdGNoZXNTdHJpY3RMZW4rK10gPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICAgICAgKytzZWFyY2hJO1xuXG5cdCAgICAgICAgICAgICAgICBpZiAoc2VhcmNoSSA9PT0gc2VhcmNoTGVuKSB7XG5cdCAgICAgICAgICAgICAgICAgIHN1Y2Nlc3NTdHJpY3QgPSB0cnVlO1xuXHQgICAgICAgICAgICAgICAgICBicmVhaztcblx0ICAgICAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICAgICAgKyt0YXJnZXRJO1xuXHQgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICB0YXJnZXRJID0gbmV4dEJlZ2lubmluZ0luZGV4ZXNbdGFyZ2V0SV07XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgICB7XG5cdCAgICAgICAgICAgIC8vIHRhbGx5IHVwIHRoZSBzY29yZSAmIGtlZXAgdHJhY2sgb2YgbWF0Y2hlcyBmb3IgaGlnaGxpZ2h0aW5nIGxhdGVyXG5cdCAgICAgICAgICAgIGlmIChzdWNjZXNzU3RyaWN0KSB7XG5cdCAgICAgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0ID0gbWF0Y2hlc1N0cmljdDtcblx0ICAgICAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3RMZW4gPSBtYXRjaGVzU3RyaWN0TGVuO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdCA9IG1hdGNoZXNTaW1wbGU7XG5cdCAgICAgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0TGVuID0gbWF0Y2hlc1NpbXBsZUxlbjtcblx0ICAgICAgICAgICAgfVxuXG5cdCAgICAgICAgICAgIHZhciBzY29yZSA9IDA7XG5cdCAgICAgICAgICAgIHZhciBsYXN0VGFyZ2V0SSA9IC0xO1xuXG5cdCAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VhcmNoTGVuOyArK2kpIHtcblx0ICAgICAgICAgICAgICB2YXIgdGFyZ2V0SSA9IG1hdGNoZXNCZXN0W2ldOyAvLyBzY29yZSBvbmx5IGdvZXMgZG93biBpZiB0aGV5J3JlIG5vdCBjb25zZWN1dGl2ZVxuXG5cdCAgICAgICAgICAgICAgaWYgKGxhc3RUYXJnZXRJICE9PSB0YXJnZXRJIC0gMSkgc2NvcmUgLT0gdGFyZ2V0STtcblx0ICAgICAgICAgICAgICBsYXN0VGFyZ2V0SSA9IHRhcmdldEk7XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBpZiAoIXN1Y2Nlc3NTdHJpY3QpIHtcblx0ICAgICAgICAgICAgICBzY29yZSAqPSAxMDAwO1xuXHQgICAgICAgICAgICAgIGlmICh0eXBvU2ltcGxlSSAhPT0gMCkgc2NvcmUgKz0gLTIwO1xuXHQgICAgICAgICAgICAgIC8qdHlwb1BlbmFsdHkqL1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGlmICh0eXBvU3RyaWN0SSAhPT0gMCkgc2NvcmUgKz0gLTIwO1xuXHQgICAgICAgICAgICAgIC8qdHlwb1BlbmFsdHkqL1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgc2NvcmUgLT0gdGFyZ2V0TGVuIC0gc2VhcmNoTGVuO1xuXHQgICAgICAgICAgICBwcmVwYXJlZC5zY29yZSA9IHNjb3JlO1xuXHQgICAgICAgICAgICBwcmVwYXJlZC5pbmRleGVzID0gbmV3IEFycmF5KG1hdGNoZXNCZXN0TGVuKTtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gbWF0Y2hlc0Jlc3RMZW4gLSAxOyBpID49IDA7IC0taSkgcHJlcGFyZWQuaW5kZXhlc1tpXSA9IG1hdGNoZXNCZXN0W2ldO1xuXG5cdCAgICAgICAgICAgIHJldHVybiBwcmVwYXJlZDtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9LFxuXHQgICAgICAgIGFsZ29yaXRobU5vVHlwbzogZnVuY3Rpb24gKHNlYXJjaExvd2VyQ29kZXMsIHByZXBhcmVkLCBzZWFyY2hMb3dlckNvZGUpIHtcblx0ICAgICAgICAgIHZhciB0YXJnZXRMb3dlckNvZGVzID0gcHJlcGFyZWQuX3RhcmdldExvd2VyQ29kZXM7XG5cdCAgICAgICAgICB2YXIgc2VhcmNoTGVuID0gc2VhcmNoTG93ZXJDb2Rlcy5sZW5ndGg7XG5cdCAgICAgICAgICB2YXIgdGFyZ2V0TGVuID0gdGFyZ2V0TG93ZXJDb2Rlcy5sZW5ndGg7XG5cdCAgICAgICAgICB2YXIgc2VhcmNoSSA9IDA7IC8vIHdoZXJlIHdlIGF0XG5cblx0ICAgICAgICAgIHZhciB0YXJnZXRJID0gMDsgLy8gd2hlcmUgeW91IGF0XG5cblx0ICAgICAgICAgIHZhciBtYXRjaGVzU2ltcGxlTGVuID0gMDsgLy8gdmVyeSBiYXNpYyBmdXp6eSBtYXRjaDsgdG8gcmVtb3ZlIG5vbi1tYXRjaGluZyB0YXJnZXRzIEFTQVAhXG5cdCAgICAgICAgICAvLyB3YWxrIHRocm91Z2ggdGFyZ2V0LiBmaW5kIHNlcXVlbnRpYWwgbWF0Y2hlcy5cblx0ICAgICAgICAgIC8vIGlmIGFsbCBjaGFycyBhcmVuJ3QgZm91bmQgdGhlbiBleGl0XG5cblx0ICAgICAgICAgIGZvciAoOzspIHtcblx0ICAgICAgICAgICAgdmFyIGlzTWF0Y2ggPSBzZWFyY2hMb3dlckNvZGUgPT09IHRhcmdldExvd2VyQ29kZXNbdGFyZ2V0SV07XG5cblx0ICAgICAgICAgICAgaWYgKGlzTWF0Y2gpIHtcblx0ICAgICAgICAgICAgICBtYXRjaGVzU2ltcGxlW21hdGNoZXNTaW1wbGVMZW4rK10gPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICAgICsrc2VhcmNoSTtcblx0ICAgICAgICAgICAgICBpZiAoc2VhcmNoSSA9PT0gc2VhcmNoTGVuKSBicmVhaztcblx0ICAgICAgICAgICAgICBzZWFyY2hMb3dlckNvZGUgPSBzZWFyY2hMb3dlckNvZGVzW3NlYXJjaEldO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgKyt0YXJnZXRJO1xuXHQgICAgICAgICAgICBpZiAodGFyZ2V0SSA+PSB0YXJnZXRMZW4pIHJldHVybiBudWxsOyAvLyBGYWlsZWQgdG8gZmluZCBzZWFyY2hJXG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHZhciBzZWFyY2hJID0gMDtcblx0ICAgICAgICAgIHZhciBzdWNjZXNzU3RyaWN0ID0gZmFsc2U7XG5cdCAgICAgICAgICB2YXIgbWF0Y2hlc1N0cmljdExlbiA9IDA7XG5cdCAgICAgICAgICB2YXIgbmV4dEJlZ2lubmluZ0luZGV4ZXMgPSBwcmVwYXJlZC5fbmV4dEJlZ2lubmluZ0luZGV4ZXM7XG5cdCAgICAgICAgICBpZiAobmV4dEJlZ2lubmluZ0luZGV4ZXMgPT09IG51bGwpIG5leHRCZWdpbm5pbmdJbmRleGVzID0gcHJlcGFyZWQuX25leHRCZWdpbm5pbmdJbmRleGVzID0gZnV6enlzb3J0LnByZXBhcmVOZXh0QmVnaW5uaW5nSW5kZXhlcyhwcmVwYXJlZC50YXJnZXQpO1xuXHQgICAgICAgICAgdmFyIGZpcnN0UG9zc2libGVJID0gdGFyZ2V0SSA9IG1hdGNoZXNTaW1wbGVbMF0gPT09IDAgPyAwIDogbmV4dEJlZ2lubmluZ0luZGV4ZXNbbWF0Y2hlc1NpbXBsZVswXSAtIDFdOyAvLyBPdXIgdGFyZ2V0IHN0cmluZyBzdWNjZXNzZnVsbHkgbWF0Y2hlZCBhbGwgY2hhcmFjdGVycyBpbiBzZXF1ZW5jZSFcblx0ICAgICAgICAgIC8vIExldCdzIHRyeSBhIG1vcmUgYWR2YW5jZWQgYW5kIHN0cmljdCB0ZXN0IHRvIGltcHJvdmUgdGhlIHNjb3JlXG5cdCAgICAgICAgICAvLyBvbmx5IGNvdW50IGl0IGFzIGEgbWF0Y2ggaWYgaXQncyBjb25zZWN1dGl2ZSBvciBhIGJlZ2lubmluZyBjaGFyYWN0ZXIhXG5cblx0ICAgICAgICAgIGlmICh0YXJnZXRJICE9PSB0YXJnZXRMZW4pIGZvciAoOzspIHtcblx0ICAgICAgICAgICAgaWYgKHRhcmdldEkgPj0gdGFyZ2V0TGVuKSB7XG5cdCAgICAgICAgICAgICAgLy8gV2UgZmFpbGVkIHRvIGZpbmQgYSBnb29kIHNwb3QgZm9yIHRoaXMgc2VhcmNoIGNoYXIsIGdvIGJhY2sgdG8gdGhlIHByZXZpb3VzIHNlYXJjaCBjaGFyIGFuZCBmb3JjZSBpdCBmb3J3YXJkXG5cdCAgICAgICAgICAgICAgaWYgKHNlYXJjaEkgPD0gMCkgYnJlYWs7IC8vIFdlIGZhaWxlZCB0byBwdXNoIGNoYXJzIGZvcndhcmQgZm9yIGEgYmV0dGVyIG1hdGNoXG5cblx0ICAgICAgICAgICAgICAtLXNlYXJjaEk7XG5cdCAgICAgICAgICAgICAgdmFyIGxhc3RNYXRjaCA9IG1hdGNoZXNTdHJpY3RbLS1tYXRjaGVzU3RyaWN0TGVuXTtcblx0ICAgICAgICAgICAgICB0YXJnZXRJID0gbmV4dEJlZ2lubmluZ0luZGV4ZXNbbGFzdE1hdGNoXTtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICB2YXIgaXNNYXRjaCA9IHNlYXJjaExvd2VyQ29kZXNbc2VhcmNoSV0gPT09IHRhcmdldExvd2VyQ29kZXNbdGFyZ2V0SV07XG5cblx0ICAgICAgICAgICAgICBpZiAoaXNNYXRjaCkge1xuXHQgICAgICAgICAgICAgICAgbWF0Y2hlc1N0cmljdFttYXRjaGVzU3RyaWN0TGVuKytdID0gdGFyZ2V0STtcblx0ICAgICAgICAgICAgICAgICsrc2VhcmNoSTtcblxuXHQgICAgICAgICAgICAgICAgaWYgKHNlYXJjaEkgPT09IHNlYXJjaExlbikge1xuXHQgICAgICAgICAgICAgICAgICBzdWNjZXNzU3RyaWN0ID0gdHJ1ZTtcblx0ICAgICAgICAgICAgICAgICAgYnJlYWs7XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgICsrdGFyZ2V0STtcblx0ICAgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgICAgdGFyZ2V0SSA9IG5leHRCZWdpbm5pbmdJbmRleGVzW3RhcmdldEldO1xuXHQgICAgICAgICAgICAgIH1cblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgICAge1xuXHQgICAgICAgICAgICAvLyB0YWxseSB1cCB0aGUgc2NvcmUgJiBrZWVwIHRyYWNrIG9mIG1hdGNoZXMgZm9yIGhpZ2hsaWdodGluZyBsYXRlclxuXHQgICAgICAgICAgICBpZiAoc3VjY2Vzc1N0cmljdCkge1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdCA9IG1hdGNoZXNTdHJpY3Q7XG5cdCAgICAgICAgICAgICAgdmFyIG1hdGNoZXNCZXN0TGVuID0gbWF0Y2hlc1N0cmljdExlbjtcblx0ICAgICAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgICAgICB2YXIgbWF0Y2hlc0Jlc3QgPSBtYXRjaGVzU2ltcGxlO1xuXHQgICAgICAgICAgICAgIHZhciBtYXRjaGVzQmVzdExlbiA9IG1hdGNoZXNTaW1wbGVMZW47XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICB2YXIgc2NvcmUgPSAwO1xuXHQgICAgICAgICAgICB2YXIgbGFzdFRhcmdldEkgPSAtMTtcblxuXHQgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHNlYXJjaExlbjsgKytpKSB7XG5cdCAgICAgICAgICAgICAgdmFyIHRhcmdldEkgPSBtYXRjaGVzQmVzdFtpXTsgLy8gc2NvcmUgb25seSBnb2VzIGRvd24gaWYgdGhleSdyZSBub3QgY29uc2VjdXRpdmVcblxuXHQgICAgICAgICAgICAgIGlmIChsYXN0VGFyZ2V0SSAhPT0gdGFyZ2V0SSAtIDEpIHNjb3JlIC09IHRhcmdldEk7XG5cdCAgICAgICAgICAgICAgbGFzdFRhcmdldEkgPSB0YXJnZXRJO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgaWYgKCFzdWNjZXNzU3RyaWN0KSBzY29yZSAqPSAxMDAwO1xuXHQgICAgICAgICAgICBzY29yZSAtPSB0YXJnZXRMZW4gLSBzZWFyY2hMZW47XG5cdCAgICAgICAgICAgIHByZXBhcmVkLnNjb3JlID0gc2NvcmU7XG5cdCAgICAgICAgICAgIHByZXBhcmVkLmluZGV4ZXMgPSBuZXcgQXJyYXkobWF0Y2hlc0Jlc3RMZW4pO1xuXG5cdCAgICAgICAgICAgIGZvciAodmFyIGkgPSBtYXRjaGVzQmVzdExlbiAtIDE7IGkgPj0gMDsgLS1pKSBwcmVwYXJlZC5pbmRleGVzW2ldID0gbWF0Y2hlc0Jlc3RbaV07XG5cblx0ICAgICAgICAgICAgcmV0dXJuIHByZXBhcmVkO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH0sXG5cdCAgICAgICAgcHJlcGFyZUxvd2VyQ29kZXM6IGZ1bmN0aW9uIChzdHIpIHtcblx0ICAgICAgICAgIHZhciBzdHJMZW4gPSBzdHIubGVuZ3RoO1xuXHQgICAgICAgICAgdmFyIGxvd2VyQ29kZXMgPSBbXTsgLy8gbmV3IEFycmF5KHN0ckxlbikgICAgc3BhcnNlIGFycmF5IGlzIHRvbyBzbG93XG5cblx0ICAgICAgICAgIHZhciBsb3dlciA9IHN0ci50b0xvd2VyQ2FzZSgpO1xuXG5cdCAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHN0ckxlbjsgKytpKSBsb3dlckNvZGVzW2ldID0gbG93ZXIuY2hhckNvZGVBdChpKTtcblxuXHQgICAgICAgICAgcmV0dXJuIGxvd2VyQ29kZXM7XG5cdCAgICAgICAgfSxcblx0ICAgICAgICBwcmVwYXJlQmVnaW5uaW5nSW5kZXhlczogZnVuY3Rpb24gKHRhcmdldCkge1xuXHQgICAgICAgICAgdmFyIHRhcmdldExlbiA9IHRhcmdldC5sZW5ndGg7XG5cdCAgICAgICAgICB2YXIgYmVnaW5uaW5nSW5kZXhlcyA9IFtdO1xuXHQgICAgICAgICAgdmFyIGJlZ2lubmluZ0luZGV4ZXNMZW4gPSAwO1xuXHQgICAgICAgICAgdmFyIHdhc1VwcGVyID0gZmFsc2U7XG5cdCAgICAgICAgICB2YXIgd2FzQWxwaGFudW0gPSBmYWxzZTtcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXJnZXRMZW47ICsraSkge1xuXHQgICAgICAgICAgICB2YXIgdGFyZ2V0Q29kZSA9IHRhcmdldC5jaGFyQ29kZUF0KGkpO1xuXHQgICAgICAgICAgICB2YXIgaXNVcHBlciA9IHRhcmdldENvZGUgPj0gNjUgJiYgdGFyZ2V0Q29kZSA8PSA5MDtcblx0ICAgICAgICAgICAgdmFyIGlzQWxwaGFudW0gPSBpc1VwcGVyIHx8IHRhcmdldENvZGUgPj0gOTcgJiYgdGFyZ2V0Q29kZSA8PSAxMjIgfHwgdGFyZ2V0Q29kZSA+PSA0OCAmJiB0YXJnZXRDb2RlIDw9IDU3O1xuXHQgICAgICAgICAgICB2YXIgaXNCZWdpbm5pbmcgPSBpc1VwcGVyICYmICF3YXNVcHBlciB8fCAhd2FzQWxwaGFudW0gfHwgIWlzQWxwaGFudW07XG5cdCAgICAgICAgICAgIHdhc1VwcGVyID0gaXNVcHBlcjtcblx0ICAgICAgICAgICAgd2FzQWxwaGFudW0gPSBpc0FscGhhbnVtO1xuXHQgICAgICAgICAgICBpZiAoaXNCZWdpbm5pbmcpIGJlZ2lubmluZ0luZGV4ZXNbYmVnaW5uaW5nSW5kZXhlc0xlbisrXSA9IGk7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHJldHVybiBiZWdpbm5pbmdJbmRleGVzO1xuXHQgICAgICAgIH0sXG5cdCAgICAgICAgcHJlcGFyZU5leHRCZWdpbm5pbmdJbmRleGVzOiBmdW5jdGlvbiAodGFyZ2V0KSB7XG5cdCAgICAgICAgICB2YXIgdGFyZ2V0TGVuID0gdGFyZ2V0Lmxlbmd0aDtcblx0ICAgICAgICAgIHZhciBiZWdpbm5pbmdJbmRleGVzID0gZnV6enlzb3J0LnByZXBhcmVCZWdpbm5pbmdJbmRleGVzKHRhcmdldCk7XG5cdCAgICAgICAgICB2YXIgbmV4dEJlZ2lubmluZ0luZGV4ZXMgPSBbXTsgLy8gbmV3IEFycmF5KHRhcmdldExlbikgICAgIHNwYXJzZSBhcnJheSBpcyB0b28gc2xvd1xuXG5cdCAgICAgICAgICB2YXIgbGFzdElzQmVnaW5uaW5nID0gYmVnaW5uaW5nSW5kZXhlc1swXTtcblx0ICAgICAgICAgIHZhciBsYXN0SXNCZWdpbm5pbmdJID0gMDtcblxuXHQgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0YXJnZXRMZW47ICsraSkge1xuXHQgICAgICAgICAgICBpZiAobGFzdElzQmVnaW5uaW5nID4gaSkge1xuXHQgICAgICAgICAgICAgIG5leHRCZWdpbm5pbmdJbmRleGVzW2ldID0gbGFzdElzQmVnaW5uaW5nO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGxhc3RJc0JlZ2lubmluZyA9IGJlZ2lubmluZ0luZGV4ZXNbKytsYXN0SXNCZWdpbm5pbmdJXTtcblx0ICAgICAgICAgICAgICBuZXh0QmVnaW5uaW5nSW5kZXhlc1tpXSA9IGxhc3RJc0JlZ2lubmluZyA9PT0gdW5kZWZpbmVkID8gdGFyZ2V0TGVuIDogbGFzdElzQmVnaW5uaW5nO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHJldHVybiBuZXh0QmVnaW5uaW5nSW5kZXhlcztcblx0ICAgICAgICB9LFxuXHQgICAgICAgIGNsZWFudXA6IGNsZWFudXAsXG5cdCAgICAgICAgbmV3OiBmdXp6eXNvcnROZXdcblx0ICAgICAgfTtcblx0ICAgICAgcmV0dXJuIGZ1enp5c29ydDtcblx0ICAgIH0gLy8gZnV6enlzb3J0TmV3XG5cdCAgICAvLyBUaGlzIHN0dWZmIGlzIG91dHNpZGUgZnV6enlzb3J0TmV3LCBiZWNhdXNlIGl0J3Mgc2hhcmVkIHdpdGggaW5zdGFuY2VzIG9mIGZ1enp5c29ydC5uZXcoKVxuXG5cblx0ICAgIHZhciBpc05vZGUgPSB0eXBlb2YgY29tbW9uanNSZXF1aXJlICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2Ygd2luZG93ID09PSAndW5kZWZpbmVkJzsgLy8gdmFyIE1BWF9JTlQgPSBOdW1iZXIuTUFYX1NBRkVfSU5URUdFUlxuXHQgICAgLy8gdmFyIE1JTl9JTlQgPSBOdW1iZXIuTUlOX1ZBTFVFXG5cblx0ICAgIHZhciBwcmVwYXJlZENhY2hlID0gbmV3IE1hcCgpO1xuXHQgICAgdmFyIHByZXBhcmVkU2VhcmNoQ2FjaGUgPSBuZXcgTWFwKCk7XG5cdCAgICB2YXIgbm9SZXN1bHRzID0gW107XG5cdCAgICBub1Jlc3VsdHMudG90YWwgPSAwO1xuXHQgICAgdmFyIG1hdGNoZXNTaW1wbGUgPSBbXTtcblx0ICAgIHZhciBtYXRjaGVzU3RyaWN0ID0gW107XG5cblx0ICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7XG5cdCAgICAgIHByZXBhcmVkQ2FjaGUuY2xlYXIoKTtcblx0ICAgICAgcHJlcGFyZWRTZWFyY2hDYWNoZS5jbGVhcigpO1xuXHQgICAgICBtYXRjaGVzU2ltcGxlID0gW107XG5cdCAgICAgIG1hdGNoZXNTdHJpY3QgPSBbXTtcblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gZGVmYXVsdFNjb3JlRm4oYSkge1xuXHQgICAgICB2YXIgbWF4ID0gLTkwMDcxOTkyNTQ3NDA5OTE7XG5cblx0ICAgICAgZm9yICh2YXIgaSA9IGEubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHtcblx0ICAgICAgICB2YXIgcmVzdWx0ID0gYVtpXTtcblx0ICAgICAgICBpZiAocmVzdWx0ID09PSBudWxsKSBjb250aW51ZTtcblx0ICAgICAgICB2YXIgc2NvcmUgPSByZXN1bHQuc2NvcmU7XG5cdCAgICAgICAgaWYgKHNjb3JlID4gbWF4KSBtYXggPSBzY29yZTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChtYXggPT09IC05MDA3MTk5MjU0NzQwOTkxKSByZXR1cm4gbnVsbDtcblx0ICAgICAgcmV0dXJuIG1heDtcblx0ICAgIH0gLy8gcHJvcCA9ICdrZXknICAgICAgICAgICAgICAyLjVtcyBvcHRpbWl6ZWQgZm9yIHRoaXMgY2FzZSwgc2VlbXMgdG8gYmUgYWJvdXQgYXMgZmFzdCBhcyBkaXJlY3Qgb2JqW3Byb3BdXG5cdCAgICAvLyBwcm9wID0gJ2tleTEua2V5MicgICAgICAgIDEwbXNcblx0ICAgIC8vIHByb3AgPSBbJ2tleTEnLCAna2V5MiddICAgMjdtc1xuXG5cblx0ICAgIGZ1bmN0aW9uIGdldFZhbHVlKG9iaiwgcHJvcCkge1xuXHQgICAgICB2YXIgdG1wID0gb2JqW3Byb3BdO1xuXHQgICAgICBpZiAodG1wICE9PSB1bmRlZmluZWQpIHJldHVybiB0bXA7XG5cdCAgICAgIHZhciBzZWdzID0gcHJvcDtcblx0ICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHByb3ApKSBzZWdzID0gcHJvcC5zcGxpdCgnLicpO1xuXHQgICAgICB2YXIgbGVuID0gc2Vncy5sZW5ndGg7XG5cdCAgICAgIHZhciBpID0gLTE7XG5cblx0ICAgICAgd2hpbGUgKG9iaiAmJiArK2kgPCBsZW4pIG9iaiA9IG9ialtzZWdzW2ldXTtcblxuXHQgICAgICByZXR1cm4gb2JqO1xuXHQgICAgfVxuXG5cdCAgICBmdW5jdGlvbiBpc09iaih4KSB7XG5cdCAgICAgIHJldHVybiB0eXBlb2YgeCA9PT0gJ29iamVjdCc7XG5cdCAgICB9IC8vIGZhc3RlciBhcyBhIGZ1bmN0aW9uXG5cdCAgICAvLyBIYWNrZWQgdmVyc2lvbiBvZiBodHRwczovL2dpdGh1Yi5jb20vbGVtaXJlL0Zhc3RQcmlvcml0eVF1ZXVlLmpzXG5cblxuXHQgICAgdmFyIGZhc3Rwcmlvcml0eXF1ZXVlID0gZnVuY3Rpb24gKCkge1xuXHQgICAgICB2YXIgciA9IFtdLFxuXHQgICAgICAgICAgbyA9IDAsXG5cdCAgICAgICAgICBlID0ge307XG5cblx0ICAgICAgZnVuY3Rpb24gbigpIHtcblx0ICAgICAgICBmb3IgKHZhciBlID0gMCwgbiA9IHJbZV0sIGMgPSAxOyBjIDwgbzspIHtcblx0ICAgICAgICAgIHZhciBmID0gYyArIDE7XG5cdCAgICAgICAgICBlID0gYywgZiA8IG8gJiYgcltmXS5zY29yZSA8IHJbY10uc2NvcmUgJiYgKGUgPSBmKSwgcltlIC0gMSA+PiAxXSA9IHJbZV0sIGMgPSAxICsgKGUgPDwgMSk7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgZm9yICh2YXIgYSA9IGUgLSAxID4+IDE7IGUgPiAwICYmIG4uc2NvcmUgPCByW2FdLnNjb3JlOyBhID0gKGUgPSBhKSAtIDEgPj4gMSkgcltlXSA9IHJbYV07XG5cblx0ICAgICAgICByW2VdID0gbjtcblx0ICAgICAgfVxuXG5cdCAgICAgIHJldHVybiBlLmFkZCA9IGZ1bmN0aW9uIChlKSB7XG5cdCAgICAgICAgdmFyIG4gPSBvO1xuXHQgICAgICAgIHJbbysrXSA9IGU7XG5cblx0ICAgICAgICBmb3IgKHZhciBjID0gbiAtIDEgPj4gMTsgbiA+IDAgJiYgZS5zY29yZSA8IHJbY10uc2NvcmU7IGMgPSAobiA9IGMpIC0gMSA+PiAxKSByW25dID0gcltjXTtcblxuXHQgICAgICAgIHJbbl0gPSBlO1xuXHQgICAgICB9LCBlLnBvbGwgPSBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgaWYgKDAgIT09IG8pIHtcblx0ICAgICAgICAgIHZhciBlID0gclswXTtcblx0ICAgICAgICAgIHJldHVybiByWzBdID0gclstLW9dLCBuKCksIGU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9LCBlLnBlZWsgPSBmdW5jdGlvbiAoZSkge1xuXHQgICAgICAgIGlmICgwICE9PSBvKSByZXR1cm4gclswXTtcblx0ICAgICAgfSwgZS5yZXBsYWNlVG9wID0gZnVuY3Rpb24gKG8pIHtcblx0ICAgICAgICByWzBdID0gbywgbigpO1xuXHQgICAgICB9LCBlO1xuXHQgICAgfTtcblxuXHQgICAgdmFyIHEgPSBmYXN0cHJpb3JpdHlxdWV1ZSgpOyAvLyByZXVzZSB0aGlzLCBleGNlcHQgZm9yIGFzeW5jLCBpdCBuZWVkcyB0byBtYWtlIGl0cyBvd25cblxuXHQgICAgcmV0dXJuIGZ1enp5c29ydE5ldygpO1xuXHQgIH0pOyAvLyBVTURcblx0ICAvLyBUT0RPOiAocGVyZm9ybWFuY2UpIHdhc20gdmVyc2lvbiE/XG5cdCAgLy8gVE9ETzogKHBlcmZvcm1hbmNlKSBsYXlvdXQgbWVtb3J5IGluIGFuIG9wdGltYWwgd2F5IHRvIGdvIGZhc3QgYnkgYXZvaWRpbmcgY2FjaGUgbWlzc2VzXG5cdCAgLy8gVE9ETzogKHBlcmZvcm1hbmNlKSBwcmVwYXJlZENhY2hlIGlzIGEgbWVtb3J5IGxlYWtcblx0ICAvLyBUT0RPOiAobGlrZSBzdWJsaW1lKSBiYWNrc2xhc2ggPT09IGZvcndhcmRzbGFzaFxuXHQgIC8vIFRPRE86IChwZXJmb3JtYW5jZSkgaSBoYXZlIG5vIGlkZWEgaG93IHdlbGwgb3B0aXptaWVkIHRoZSBhbGxvd2luZyB0eXBvcyBhbGdvcml0aG0gaXNcblxuXHR9KTtcblxuXHR2YXIgc3RhdHMgPSB7XG5cdCAgcGFzc2VkVGVzdHM6IDAsXG5cdCAgZmFpbGVkVGVzdHM6IDAsXG5cdCAgc2tpcHBlZFRlc3RzOiAwLFxuXHQgIHRvZG9UZXN0czogMFxuXHR9OyAvLyBFc2NhcGUgdGV4dCBmb3IgYXR0cmlidXRlIG9yIHRleHQgY29udGVudC5cblxuXHRmdW5jdGlvbiBlc2NhcGVUZXh0KHMpIHtcblx0ICBpZiAoIXMpIHtcblx0ICAgIHJldHVybiBcIlwiO1xuXHQgIH1cblxuXHQgIHMgPSBzICsgXCJcIjsgLy8gQm90aCBzaW5nbGUgcXVvdGVzIGFuZCBkb3VibGUgcXVvdGVzIChmb3IgYXR0cmlidXRlcylcblxuXHQgIHJldHVybiBzLnJlcGxhY2UoL1snXCI8PiZdL2csIGZ1bmN0aW9uIChzKSB7XG5cdCAgICBzd2l0Y2ggKHMpIHtcblx0ICAgICAgY2FzZSBcIidcIjpcblx0ICAgICAgICByZXR1cm4gXCImIzAzOTtcIjtcblxuXHQgICAgICBjYXNlIFwiXFxcIlwiOlxuXHQgICAgICAgIHJldHVybiBcIiZxdW90O1wiO1xuXG5cdCAgICAgIGNhc2UgXCI8XCI6XG5cdCAgICAgICAgcmV0dXJuIFwiJmx0O1wiO1xuXG5cdCAgICAgIGNhc2UgXCI+XCI6XG5cdCAgICAgICAgcmV0dXJuIFwiJmd0O1wiO1xuXG5cdCAgICAgIGNhc2UgXCImXCI6XG5cdCAgICAgICAgcmV0dXJuIFwiJmFtcDtcIjtcblx0ICAgIH1cblx0ICB9KTtcblx0fVxuXG5cdChmdW5jdGlvbiAoKSB7XG5cdCAgLy8gRG9uJ3QgbG9hZCB0aGUgSFRNTCBSZXBvcnRlciBvbiBub24tYnJvd3NlciBlbnZpcm9ubWVudHNcblx0ICBpZiAodHlwZW9mIHdpbmRvdyQxID09PSBcInVuZGVmaW5lZFwiIHx8ICF3aW5kb3ckMS5kb2N1bWVudCkge1xuXHQgICAgcmV0dXJuO1xuXHQgIH1cblxuXHQgIHZhciBjb25maWcgPSBRVW5pdC5jb25maWcsXG5cdCAgICAgIGhpZGRlblRlc3RzID0gW10sXG5cdCAgICAgIGRvY3VtZW50ID0gd2luZG93JDEuZG9jdW1lbnQsXG5cdCAgICAgIGNvbGxhcHNlTmV4dCA9IGZhbHNlLFxuXHQgICAgICBoYXNPd24gPSBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LFxuXHQgICAgICB1bmZpbHRlcmVkVXJsID0gc2V0VXJsKHtcblx0ICAgIGZpbHRlcjogdW5kZWZpbmVkLFxuXHQgICAgbW9kdWxlOiB1bmRlZmluZWQsXG5cdCAgICBtb2R1bGVJZDogdW5kZWZpbmVkLFxuXHQgICAgdGVzdElkOiB1bmRlZmluZWRcblx0ICB9KSxcblx0ICAgICAgbW9kdWxlc0xpc3QgPSBbXTtcblxuXHQgIGZ1bmN0aW9uIGFkZEV2ZW50KGVsZW0sIHR5cGUsIGZuKSB7XG5cdCAgICBlbGVtLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgZm4sIGZhbHNlKTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiByZW1vdmVFdmVudChlbGVtLCB0eXBlLCBmbikge1xuXHQgICAgZWxlbS5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBmYWxzZSk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYWRkRXZlbnRzKGVsZW1zLCB0eXBlLCBmbikge1xuXHQgICAgdmFyIGkgPSBlbGVtcy5sZW5ndGg7XG5cblx0ICAgIHdoaWxlIChpLS0pIHtcblx0ICAgICAgYWRkRXZlbnQoZWxlbXNbaV0sIHR5cGUsIGZuKTtcblx0ICAgIH1cblx0ICB9XG5cblx0ICBmdW5jdGlvbiBoYXNDbGFzcyhlbGVtLCBuYW1lKSB7XG5cdCAgICByZXR1cm4gKFwiIFwiICsgZWxlbS5jbGFzc05hbWUgKyBcIiBcIikuaW5kZXhPZihcIiBcIiArIG5hbWUgKyBcIiBcIikgPj0gMDtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhZGRDbGFzcyhlbGVtLCBuYW1lKSB7XG5cdCAgICBpZiAoIWhhc0NsYXNzKGVsZW0sIG5hbWUpKSB7XG5cdCAgICAgIGVsZW0uY2xhc3NOYW1lICs9IChlbGVtLmNsYXNzTmFtZSA/IFwiIFwiIDogXCJcIikgKyBuYW1lO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHRvZ2dsZUNsYXNzKGVsZW0sIG5hbWUsIGZvcmNlKSB7XG5cdCAgICBpZiAoZm9yY2UgfHwgdHlwZW9mIGZvcmNlID09PSBcInVuZGVmaW5lZFwiICYmICFoYXNDbGFzcyhlbGVtLCBuYW1lKSkge1xuXHQgICAgICBhZGRDbGFzcyhlbGVtLCBuYW1lKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIHJlbW92ZUNsYXNzKGVsZW0sIG5hbWUpO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHJlbW92ZUNsYXNzKGVsZW0sIG5hbWUpIHtcblx0ICAgIHZhciBzZXQgPSBcIiBcIiArIGVsZW0uY2xhc3NOYW1lICsgXCIgXCI7IC8vIENsYXNzIG5hbWUgbWF5IGFwcGVhciBtdWx0aXBsZSB0aW1lc1xuXG5cdCAgICB3aGlsZSAoc2V0LmluZGV4T2YoXCIgXCIgKyBuYW1lICsgXCIgXCIpID49IDApIHtcblx0ICAgICAgc2V0ID0gc2V0LnJlcGxhY2UoXCIgXCIgKyBuYW1lICsgXCIgXCIsIFwiIFwiKTtcblx0ICAgIH0gLy8gVHJpbSBmb3IgcHJldHRpbmVzc1xuXG5cblx0ICAgIGVsZW0uY2xhc3NOYW1lID0gdHlwZW9mIHNldC50cmltID09PSBcImZ1bmN0aW9uXCIgPyBzZXQudHJpbSgpIDogc2V0LnJlcGxhY2UoL15cXHMrfFxccyskL2csIFwiXCIpO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGlkKG5hbWUpIHtcblx0ICAgIHJldHVybiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCAmJiBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChuYW1lKTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhYm9ydFRlc3RzKCkge1xuXHQgICAgdmFyIGFib3J0QnV0dG9uID0gaWQoXCJxdW5pdC1hYm9ydC10ZXN0cy1idXR0b25cIik7XG5cblx0ICAgIGlmIChhYm9ydEJ1dHRvbikge1xuXHQgICAgICBhYm9ydEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG5cdCAgICAgIGFib3J0QnV0dG9uLmlubmVySFRNTCA9IFwiQWJvcnRpbmcuLi5cIjtcblx0ICAgIH1cblxuXHQgICAgUVVuaXQuY29uZmlnLnF1ZXVlLmxlbmd0aCA9IDA7XG5cdCAgICByZXR1cm4gZmFsc2U7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gaW50ZXJjZXB0TmF2aWdhdGlvbihldikge1xuXHQgICAgYXBwbHlVcmxQYXJhbXMoKTtcblxuXHQgICAgaWYgKGV2ICYmIGV2LnByZXZlbnREZWZhdWx0KSB7XG5cdCAgICAgIGV2LnByZXZlbnREZWZhdWx0KCk7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBmYWxzZTtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBnZXRVcmxDb25maWdIdG1sKCkge1xuXHQgICAgdmFyIGksXG5cdCAgICAgICAgaixcblx0ICAgICAgICB2YWwsXG5cdCAgICAgICAgZXNjYXBlZCxcblx0ICAgICAgICBlc2NhcGVkVG9vbHRpcCxcblx0ICAgICAgICBzZWxlY3Rpb24gPSBmYWxzZSxcblx0ICAgICAgICB1cmxDb25maWcgPSBjb25maWcudXJsQ29uZmlnLFxuXHQgICAgICAgIHVybENvbmZpZ0h0bWwgPSBcIlwiO1xuXG5cdCAgICBmb3IgKGkgPSAwOyBpIDwgdXJsQ29uZmlnLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIC8vIE9wdGlvbnMgY2FuIGJlIGVpdGhlciBzdHJpbmdzIG9yIG9iamVjdHMgd2l0aCBub25lbXB0eSBcImlkXCIgcHJvcGVydGllc1xuXHQgICAgICB2YWwgPSBjb25maWcudXJsQ29uZmlnW2ldO1xuXG5cdCAgICAgIGlmICh0eXBlb2YgdmFsID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgdmFsID0ge1xuXHQgICAgICAgICAgaWQ6IHZhbCxcblx0ICAgICAgICAgIGxhYmVsOiB2YWxcblx0ICAgICAgICB9O1xuXHQgICAgICB9XG5cblx0ICAgICAgZXNjYXBlZCA9IGVzY2FwZVRleHQodmFsLmlkKTtcblx0ICAgICAgZXNjYXBlZFRvb2x0aXAgPSBlc2NhcGVUZXh0KHZhbC50b29sdGlwKTtcblxuXHQgICAgICBpZiAoIXZhbC52YWx1ZSB8fCB0eXBlb2YgdmFsLnZhbHVlID09PSBcInN0cmluZ1wiKSB7XG5cdCAgICAgICAgdXJsQ29uZmlnSHRtbCArPSBcIjxsYWJlbCBmb3I9J3F1bml0LXVybGNvbmZpZy1cIiArIGVzY2FwZWQgKyBcIicgdGl0bGU9J1wiICsgZXNjYXBlZFRvb2x0aXAgKyBcIic+PGlucHV0IGlkPSdxdW5pdC11cmxjb25maWctXCIgKyBlc2NhcGVkICsgXCInIG5hbWU9J1wiICsgZXNjYXBlZCArIFwiJyB0eXBlPSdjaGVja2JveCdcIiArICh2YWwudmFsdWUgPyBcIiB2YWx1ZT0nXCIgKyBlc2NhcGVUZXh0KHZhbC52YWx1ZSkgKyBcIidcIiA6IFwiXCIpICsgKGNvbmZpZ1t2YWwuaWRdID8gXCIgY2hlY2tlZD0nY2hlY2tlZCdcIiA6IFwiXCIpICsgXCIgdGl0bGU9J1wiICsgZXNjYXBlZFRvb2x0aXAgKyBcIicgLz5cIiArIGVzY2FwZVRleHQodmFsLmxhYmVsKSArIFwiPC9sYWJlbD5cIjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB1cmxDb25maWdIdG1sICs9IFwiPGxhYmVsIGZvcj0ncXVuaXQtdXJsY29uZmlnLVwiICsgZXNjYXBlZCArIFwiJyB0aXRsZT0nXCIgKyBlc2NhcGVkVG9vbHRpcCArIFwiJz5cIiArIHZhbC5sYWJlbCArIFwiOiA8L2xhYmVsPjxzZWxlY3QgaWQ9J3F1bml0LXVybGNvbmZpZy1cIiArIGVzY2FwZWQgKyBcIicgbmFtZT0nXCIgKyBlc2NhcGVkICsgXCInIHRpdGxlPSdcIiArIGVzY2FwZWRUb29sdGlwICsgXCInPjxvcHRpb24+PC9vcHRpb24+XCI7XG5cblx0ICAgICAgICBpZiAoUVVuaXQuaXMoXCJhcnJheVwiLCB2YWwudmFsdWUpKSB7XG5cdCAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgdmFsLnZhbHVlLmxlbmd0aDsgaisrKSB7XG5cdCAgICAgICAgICAgIGVzY2FwZWQgPSBlc2NhcGVUZXh0KHZhbC52YWx1ZVtqXSk7XG5cdCAgICAgICAgICAgIHVybENvbmZpZ0h0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPSdcIiArIGVzY2FwZWQgKyBcIidcIiArIChjb25maWdbdmFsLmlkXSA9PT0gdmFsLnZhbHVlW2pdID8gKHNlbGVjdGlvbiA9IHRydWUpICYmIFwiIHNlbGVjdGVkPSdzZWxlY3RlZCdcIiA6IFwiXCIpICsgXCI+XCIgKyBlc2NhcGVkICsgXCI8L29wdGlvbj5cIjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgZm9yIChqIGluIHZhbC52YWx1ZSkge1xuXHQgICAgICAgICAgICBpZiAoaGFzT3duLmNhbGwodmFsLnZhbHVlLCBqKSkge1xuXHQgICAgICAgICAgICAgIHVybENvbmZpZ0h0bWwgKz0gXCI8b3B0aW9uIHZhbHVlPSdcIiArIGVzY2FwZVRleHQoaikgKyBcIidcIiArIChjb25maWdbdmFsLmlkXSA9PT0gaiA/IChzZWxlY3Rpb24gPSB0cnVlKSAmJiBcIiBzZWxlY3RlZD0nc2VsZWN0ZWQnXCIgOiBcIlwiKSArIFwiPlwiICsgZXNjYXBlVGV4dCh2YWwudmFsdWVbal0pICsgXCI8L29wdGlvbj5cIjtcblx0ICAgICAgICAgICAgfVxuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChjb25maWdbdmFsLmlkXSAmJiAhc2VsZWN0aW9uKSB7XG5cdCAgICAgICAgICBlc2NhcGVkID0gZXNjYXBlVGV4dChjb25maWdbdmFsLmlkXSk7XG5cdCAgICAgICAgICB1cmxDb25maWdIdG1sICs9IFwiPG9wdGlvbiB2YWx1ZT0nXCIgKyBlc2NhcGVkICsgXCInIHNlbGVjdGVkPSdzZWxlY3RlZCcgZGlzYWJsZWQ9J2Rpc2FibGVkJz5cIiArIGVzY2FwZWQgKyBcIjwvb3B0aW9uPlwiO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHVybENvbmZpZ0h0bWwgKz0gXCI8L3NlbGVjdD5cIjtcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gdXJsQ29uZmlnSHRtbDtcblx0ICB9IC8vIEhhbmRsZSBcImNsaWNrXCIgZXZlbnRzIG9uIHRvb2xiYXIgY2hlY2tib3hlcyBhbmQgXCJjaGFuZ2VcIiBmb3Igc2VsZWN0IG1lbnVzLlxuXHQgIC8vIFVwZGF0ZXMgdGhlIFVSTCB3aXRoIHRoZSBuZXcgc3RhdGUgb2YgYGNvbmZpZy51cmxDb25maWdgIHZhbHVlcy5cblxuXG5cdCAgZnVuY3Rpb24gdG9vbGJhckNoYW5nZWQoKSB7XG5cdCAgICB2YXIgdXBkYXRlZFVybCxcblx0ICAgICAgICB2YWx1ZSxcblx0ICAgICAgICB0ZXN0cyxcblx0ICAgICAgICBmaWVsZCA9IHRoaXMsXG5cdCAgICAgICAgcGFyYW1zID0ge307IC8vIERldGVjdCBpZiBmaWVsZCBpcyBhIHNlbGVjdCBtZW51IG9yIGEgY2hlY2tib3hcblxuXHQgICAgaWYgKFwic2VsZWN0ZWRJbmRleFwiIGluIGZpZWxkKSB7XG5cdCAgICAgIHZhbHVlID0gZmllbGQub3B0aW9uc1tmaWVsZC5zZWxlY3RlZEluZGV4XS52YWx1ZSB8fCB1bmRlZmluZWQ7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICB2YWx1ZSA9IGZpZWxkLmNoZWNrZWQgPyBmaWVsZC5kZWZhdWx0VmFsdWUgfHwgdHJ1ZSA6IHVuZGVmaW5lZDtcblx0ICAgIH1cblxuXHQgICAgcGFyYW1zW2ZpZWxkLm5hbWVdID0gdmFsdWU7XG5cdCAgICB1cGRhdGVkVXJsID0gc2V0VXJsKHBhcmFtcyk7IC8vIENoZWNrIGlmIHdlIGNhbiBhcHBseSB0aGUgY2hhbmdlIHdpdGhvdXQgYSBwYWdlIHJlZnJlc2hcblxuXHQgICAgaWYgKFwiaGlkZXBhc3NlZFwiID09PSBmaWVsZC5uYW1lICYmIFwicmVwbGFjZVN0YXRlXCIgaW4gd2luZG93JDEuaGlzdG9yeSkge1xuXHQgICAgICBRVW5pdC51cmxQYXJhbXNbZmllbGQubmFtZV0gPSB2YWx1ZTtcblx0ICAgICAgY29uZmlnW2ZpZWxkLm5hbWVdID0gdmFsdWUgfHwgZmFsc2U7XG5cdCAgICAgIHRlc3RzID0gaWQoXCJxdW5pdC10ZXN0c1wiKTtcblxuXHQgICAgICBpZiAodGVzdHMpIHtcblx0ICAgICAgICB2YXIgbGVuZ3RoID0gdGVzdHMuY2hpbGRyZW4ubGVuZ3RoO1xuXHQgICAgICAgIHZhciBjaGlsZHJlbiA9IHRlc3RzLmNoaWxkcmVuO1xuXG5cdCAgICAgICAgaWYgKGZpZWxkLmNoZWNrZWQpIHtcblx0ICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKyspIHtcblx0ICAgICAgICAgICAgdmFyIHRlc3QgPSBjaGlsZHJlbltpXTtcblx0ICAgICAgICAgICAgdmFyIGNsYXNzTmFtZSA9IHRlc3QgPyB0ZXN0LmNsYXNzTmFtZSA6IFwiXCI7XG5cdCAgICAgICAgICAgIHZhciBjbGFzc05hbWVIYXNQYXNzID0gY2xhc3NOYW1lLmluZGV4T2YoXCJwYXNzXCIpID4gLTE7XG5cdCAgICAgICAgICAgIHZhciBjbGFzc05hbWVIYXNTa2lwcGVkID0gY2xhc3NOYW1lLmluZGV4T2YoXCJza2lwcGVkXCIpID4gLTE7XG5cblx0ICAgICAgICAgICAgaWYgKGNsYXNzTmFtZUhhc1Bhc3MgfHwgY2xhc3NOYW1lSGFzU2tpcHBlZCkge1xuXHQgICAgICAgICAgICAgIGhpZGRlblRlc3RzLnB1c2godGVzdCk7XG5cdCAgICAgICAgICAgIH1cblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgdmFyIF9pdGVyYXRvciA9IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyKGhpZGRlblRlc3RzKSxcblx0ICAgICAgICAgICAgICBfc3RlcDtcblxuXHQgICAgICAgICAgdHJ5IHtcblx0ICAgICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHtcblx0ICAgICAgICAgICAgICB2YXIgaGlkZGVuVGVzdCA9IF9zdGVwLnZhbHVlO1xuXHQgICAgICAgICAgICAgIHRlc3RzLnJlbW92ZUNoaWxkKGhpZGRlblRlc3QpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9IGNhdGNoIChlcnIpIHtcblx0ICAgICAgICAgICAgX2l0ZXJhdG9yLmUoZXJyKTtcblx0ICAgICAgICAgIH0gZmluYWxseSB7XG5cdCAgICAgICAgICAgIF9pdGVyYXRvci5mKCk7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHdoaWxlICgodGVzdCA9IGhpZGRlblRlc3RzLnBvcCgpKSAhPSBudWxsKSB7XG5cdCAgICAgICAgICAgIHRlc3RzLmFwcGVuZENoaWxkKHRlc3QpO1xuXHQgICAgICAgICAgfVxuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHdpbmRvdyQxLmhpc3RvcnkucmVwbGFjZVN0YXRlKG51bGwsIFwiXCIsIHVwZGF0ZWRVcmwpO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgd2luZG93JDEubG9jYXRpb24gPSB1cGRhdGVkVXJsO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHNldFVybChwYXJhbXMpIHtcblx0ICAgIHZhciBrZXksXG5cdCAgICAgICAgYXJyVmFsdWUsXG5cdCAgICAgICAgaSxcblx0ICAgICAgICBxdWVyeXN0cmluZyA9IFwiP1wiLFxuXHQgICAgICAgIGxvY2F0aW9uID0gd2luZG93JDEubG9jYXRpb247XG5cdCAgICBwYXJhbXMgPSBRVW5pdC5leHRlbmQoUVVuaXQuZXh0ZW5kKHt9LCBRVW5pdC51cmxQYXJhbXMpLCBwYXJhbXMpO1xuXG5cdCAgICBmb3IgKGtleSBpbiBwYXJhbXMpIHtcblx0ICAgICAgLy8gU2tpcCBpbmhlcml0ZWQgb3IgdW5kZWZpbmVkIHByb3BlcnRpZXNcblx0ICAgICAgaWYgKGhhc093bi5jYWxsKHBhcmFtcywga2V5KSAmJiBwYXJhbXNba2V5XSAhPT0gdW5kZWZpbmVkKSB7XG5cdCAgICAgICAgLy8gT3V0cHV0IGEgcGFyYW1ldGVyIGZvciBlYWNoIHZhbHVlIG9mIHRoaXMga2V5XG5cdCAgICAgICAgLy8gKGJ1dCB1c3VhbGx5IGp1c3Qgb25lKVxuXHQgICAgICAgIGFyclZhbHVlID0gW10uY29uY2F0KHBhcmFtc1trZXldKTtcblxuXHQgICAgICAgIGZvciAoaSA9IDA7IGkgPCBhcnJWYWx1ZS5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgICAgcXVlcnlzdHJpbmcgKz0gZW5jb2RlVVJJQ29tcG9uZW50KGtleSk7XG5cblx0ICAgICAgICAgIGlmIChhcnJWYWx1ZVtpXSAhPT0gdHJ1ZSkge1xuXHQgICAgICAgICAgICBxdWVyeXN0cmluZyArPSBcIj1cIiArIGVuY29kZVVSSUNvbXBvbmVudChhcnJWYWx1ZVtpXSk7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIHF1ZXJ5c3RyaW5nICs9IFwiJlwiO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gbG9jYXRpb24ucHJvdG9jb2wgKyBcIi8vXCIgKyBsb2NhdGlvbi5ob3N0ICsgbG9jYXRpb24ucGF0aG5hbWUgKyBxdWVyeXN0cmluZy5zbGljZSgwLCAtMSk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYXBwbHlVcmxQYXJhbXMoKSB7XG5cdCAgICB2YXIgaSxcblx0ICAgICAgICBzZWxlY3RlZE1vZHVsZXMgPSBbXSxcblx0ICAgICAgICBtb2R1bGVzTGlzdCA9IGlkKFwicXVuaXQtbW9kdWxlZmlsdGVyLWRyb3Bkb3duLWxpc3RcIikuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSxcblx0ICAgICAgICBmaWx0ZXIgPSBpZChcInF1bml0LWZpbHRlci1pbnB1dFwiKS52YWx1ZTtcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IG1vZHVsZXNMaXN0Lmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIGlmIChtb2R1bGVzTGlzdFtpXS5jaGVja2VkKSB7XG5cdCAgICAgICAgc2VsZWN0ZWRNb2R1bGVzLnB1c2gobW9kdWxlc0xpc3RbaV0udmFsdWUpO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHdpbmRvdyQxLmxvY2F0aW9uID0gc2V0VXJsKHtcblx0ICAgICAgZmlsdGVyOiBmaWx0ZXIgPT09IFwiXCIgPyB1bmRlZmluZWQgOiBmaWx0ZXIsXG5cdCAgICAgIG1vZHVsZUlkOiBzZWxlY3RlZE1vZHVsZXMubGVuZ3RoID09PSAwID8gdW5kZWZpbmVkIDogc2VsZWN0ZWRNb2R1bGVzLFxuXHQgICAgICAvLyBSZW1vdmUgbW9kdWxlIGFuZCB0ZXN0SWQgZmlsdGVyXG5cdCAgICAgIG1vZHVsZTogdW5kZWZpbmVkLFxuXHQgICAgICB0ZXN0SWQ6IHVuZGVmaW5lZFxuXHQgICAgfSk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gdG9vbGJhclVybENvbmZpZ0NvbnRhaW5lcigpIHtcblx0ICAgIHZhciB1cmxDb25maWdDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0ICAgIHVybENvbmZpZ0NvbnRhaW5lci5pbm5lckhUTUwgPSBnZXRVcmxDb25maWdIdG1sKCk7XG5cdCAgICBhZGRDbGFzcyh1cmxDb25maWdDb250YWluZXIsIFwicXVuaXQtdXJsLWNvbmZpZ1wiKTtcblx0ICAgIGFkZEV2ZW50cyh1cmxDb25maWdDb250YWluZXIuZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJpbnB1dFwiKSwgXCJjaGFuZ2VcIiwgdG9vbGJhckNoYW5nZWQpO1xuXHQgICAgYWRkRXZlbnRzKHVybENvbmZpZ0NvbnRhaW5lci5nZXRFbGVtZW50c0J5VGFnTmFtZShcInNlbGVjdFwiKSwgXCJjaGFuZ2VcIiwgdG9vbGJhckNoYW5nZWQpO1xuXHQgICAgcmV0dXJuIHVybENvbmZpZ0NvbnRhaW5lcjtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBhYm9ydFRlc3RzQnV0dG9uKCkge1xuXHQgICAgdmFyIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdCAgICBidXR0b24uaWQgPSBcInF1bml0LWFib3J0LXRlc3RzLWJ1dHRvblwiO1xuXHQgICAgYnV0dG9uLmlubmVySFRNTCA9IFwiQWJvcnRcIjtcblx0ICAgIGFkZEV2ZW50KGJ1dHRvbiwgXCJjbGlja1wiLCBhYm9ydFRlc3RzKTtcblx0ICAgIHJldHVybiBidXR0b247XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gdG9vbGJhckxvb3NlRmlsdGVyKCkge1xuXHQgICAgdmFyIGZpbHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpLFxuXHQgICAgICAgIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpLFxuXHQgICAgICAgIGlucHV0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLFxuXHQgICAgICAgIGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XG5cdCAgICBhZGRDbGFzcyhmaWx0ZXIsIFwicXVuaXQtZmlsdGVyXCIpO1xuXHQgICAgbGFiZWwuaW5uZXJIVE1MID0gXCJGaWx0ZXI6IFwiO1xuXHQgICAgaW5wdXQudHlwZSA9IFwidGV4dFwiO1xuXHQgICAgaW5wdXQudmFsdWUgPSBjb25maWcuZmlsdGVyIHx8IFwiXCI7XG5cdCAgICBpbnB1dC5uYW1lID0gXCJmaWx0ZXJcIjtcblx0ICAgIGlucHV0LmlkID0gXCJxdW5pdC1maWx0ZXItaW5wdXRcIjtcblx0ICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBcIkdvXCI7XG5cdCAgICBsYWJlbC5hcHBlbmRDaGlsZChpbnB1dCk7XG5cdCAgICBmaWx0ZXIuYXBwZW5kQ2hpbGQobGFiZWwpO1xuXHQgICAgZmlsdGVyLmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiIFwiKSk7XG5cdCAgICBmaWx0ZXIuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcblx0ICAgIGFkZEV2ZW50KGZpbHRlciwgXCJzdWJtaXRcIiwgaW50ZXJjZXB0TmF2aWdhdGlvbik7XG5cdCAgICByZXR1cm4gZmlsdGVyO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIG1vZHVsZUxpc3RIdG1sKG1vZHVsZXMpIHtcblx0ICAgIHZhciBpLFxuXHQgICAgICAgIGNoZWNrZWQsXG5cdCAgICAgICAgaHRtbCA9IFwiXCI7XG5cblx0ICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzLmxlbmd0aDsgaSsrKSB7XG5cdCAgICAgIGlmIChtb2R1bGVzW2ldLm5hbWUgIT09IFwiXCIpIHtcblx0ICAgICAgICBjaGVja2VkID0gY29uZmlnLm1vZHVsZUlkLmluZGV4T2YobW9kdWxlc1tpXS5tb2R1bGVJZCkgPiAtMTtcblx0ICAgICAgICBodG1sICs9IFwiPGxpPjxsYWJlbCBjbGFzcz0nY2xpY2thYmxlXCIgKyAoY2hlY2tlZCA/IFwiIGNoZWNrZWRcIiA6IFwiXCIpICsgXCInPjxpbnB1dCB0eXBlPSdjaGVja2JveCcgXCIgKyBcInZhbHVlPSdcIiArIG1vZHVsZXNbaV0ubW9kdWxlSWQgKyBcIidcIiArIChjaGVja2VkID8gXCIgY2hlY2tlZD0nY2hlY2tlZCdcIiA6IFwiXCIpICsgXCIgLz5cIiArIGVzY2FwZVRleHQobW9kdWxlc1tpXS5uYW1lKSArIFwiPC9sYWJlbD48L2xpPlwiO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBodG1sO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIHRvb2xiYXJNb2R1bGVGaWx0ZXIoKSB7XG5cdCAgICB2YXIgY29tbWl0LFxuXHQgICAgICAgIHJlc2V0LFxuXHQgICAgICAgIG1vZHVsZUZpbHRlciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJmb3JtXCIpLFxuXHQgICAgICAgIGxhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpLFxuXHQgICAgICAgIG1vZHVsZVNlYXJjaCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJpbnB1dFwiKSxcblx0ICAgICAgICBkcm9wRG93biA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIiksXG5cdCAgICAgICAgYWN0aW9ucyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzcGFuXCIpLFxuXHQgICAgICAgIGFwcGx5QnV0dG9uID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJ1dHRvblwiKSxcblx0ICAgICAgICByZXNldEJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIiksXG5cdCAgICAgICAgYWxsTW9kdWxlc0xhYmVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpLFxuXHQgICAgICAgIGFsbENoZWNrYm94ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlucHV0XCIpLFxuXHQgICAgICAgIGRyb3BEb3duTGlzdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ1bFwiKSxcblx0ICAgICAgICBkaXJ0eSA9IGZhbHNlO1xuXHQgICAgbW9kdWxlU2VhcmNoLmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXItc2VhcmNoXCI7XG5cdCAgICBtb2R1bGVTZWFyY2guYXV0b2NvbXBsZXRlID0gXCJvZmZcIjtcblx0ICAgIGFkZEV2ZW50KG1vZHVsZVNlYXJjaCwgXCJpbnB1dFwiLCBzZWFyY2hJbnB1dCk7XG5cdCAgICBhZGRFdmVudChtb2R1bGVTZWFyY2gsIFwiaW5wdXRcIiwgc2VhcmNoRm9jdXMpO1xuXHQgICAgYWRkRXZlbnQobW9kdWxlU2VhcmNoLCBcImZvY3VzXCIsIHNlYXJjaEZvY3VzKTtcblx0ICAgIGFkZEV2ZW50KG1vZHVsZVNlYXJjaCwgXCJjbGlja1wiLCBzZWFyY2hGb2N1cyk7XG5cdCAgICBjb25maWcubW9kdWxlcy5mb3JFYWNoKGZ1bmN0aW9uIChtb2R1bGUpIHtcblx0ICAgICAgcmV0dXJuIG1vZHVsZS5uYW1lUHJlcGFyZWQgPSBmdXp6eXNvcnQucHJlcGFyZShtb2R1bGUubmFtZSk7XG5cdCAgICB9KTtcblx0ICAgIGxhYmVsLmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXItc2VhcmNoLWNvbnRhaW5lclwiO1xuXHQgICAgbGFiZWwuaW5uZXJIVE1MID0gXCJNb2R1bGU6IFwiO1xuXHQgICAgbGFiZWwuYXBwZW5kQ2hpbGQobW9kdWxlU2VhcmNoKTtcblx0ICAgIGFwcGx5QnV0dG9uLnRleHRDb250ZW50ID0gXCJBcHBseVwiO1xuXHQgICAgYXBwbHlCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHQgICAgcmVzZXRCdXR0b24udGV4dENvbnRlbnQgPSBcIlJlc2V0XCI7XG5cdCAgICByZXNldEJ1dHRvbi50eXBlID0gXCJyZXNldFwiO1xuXHQgICAgcmVzZXRCdXR0b24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHQgICAgYWxsQ2hlY2tib3gudHlwZSA9IFwiY2hlY2tib3hcIjtcblx0ICAgIGFsbENoZWNrYm94LmNoZWNrZWQgPSBjb25maWcubW9kdWxlSWQubGVuZ3RoID09PSAwO1xuXHQgICAgYWxsTW9kdWxlc0xhYmVsLmNsYXNzTmFtZSA9IFwiY2xpY2thYmxlXCI7XG5cblx0ICAgIGlmIChjb25maWcubW9kdWxlSWQubGVuZ3RoKSB7XG5cdCAgICAgIGFsbE1vZHVsZXNMYWJlbC5jbGFzc05hbWUgPSBcImNoZWNrZWRcIjtcblx0ICAgIH1cblxuXHQgICAgYWxsTW9kdWxlc0xhYmVsLmFwcGVuZENoaWxkKGFsbENoZWNrYm94KTtcblx0ICAgIGFsbE1vZHVsZXNMYWJlbC5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIkFsbCBtb2R1bGVzXCIpKTtcblx0ICAgIGFjdGlvbnMuaWQgPSBcInF1bml0LW1vZHVsZWZpbHRlci1hY3Rpb25zXCI7XG5cdCAgICBhY3Rpb25zLmFwcGVuZENoaWxkKGFwcGx5QnV0dG9uKTtcblx0ICAgIGFjdGlvbnMuYXBwZW5kQ2hpbGQocmVzZXRCdXR0b24pO1xuXHQgICAgYWN0aW9ucy5hcHBlbmRDaGlsZChhbGxNb2R1bGVzTGFiZWwpO1xuXHQgICAgY29tbWl0ID0gYWN0aW9ucy5maXJzdENoaWxkO1xuXHQgICAgcmVzZXQgPSBjb21taXQubmV4dFNpYmxpbmc7XG5cdCAgICBhZGRFdmVudChjb21taXQsIFwiY2xpY2tcIiwgYXBwbHlVcmxQYXJhbXMpO1xuXHQgICAgZHJvcERvd25MaXN0LmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXItZHJvcGRvd24tbGlzdFwiO1xuXHQgICAgZHJvcERvd25MaXN0LmlubmVySFRNTCA9IG1vZHVsZUxpc3RIdG1sKGNvbmZpZy5tb2R1bGVzKTtcblx0ICAgIGRyb3BEb3duLmlkID0gXCJxdW5pdC1tb2R1bGVmaWx0ZXItZHJvcGRvd25cIjtcblx0ICAgIGRyb3BEb3duLnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcblx0ICAgIGRyb3BEb3duLmFwcGVuZENoaWxkKGFjdGlvbnMpO1xuXHQgICAgZHJvcERvd24uYXBwZW5kQ2hpbGQoZHJvcERvd25MaXN0KTtcblx0ICAgIGFkZEV2ZW50KGRyb3BEb3duLCBcImNoYW5nZVwiLCBzZWxlY3Rpb25DaGFuZ2UpO1xuXHQgICAgc2VsZWN0aW9uQ2hhbmdlKCk7XG5cdCAgICBtb2R1bGVGaWx0ZXIuaWQgPSBcInF1bml0LW1vZHVsZWZpbHRlclwiO1xuXHQgICAgbW9kdWxlRmlsdGVyLmFwcGVuZENoaWxkKGxhYmVsKTtcblx0ICAgIG1vZHVsZUZpbHRlci5hcHBlbmRDaGlsZChkcm9wRG93bik7XG5cdCAgICBhZGRFdmVudChtb2R1bGVGaWx0ZXIsIFwic3VibWl0XCIsIGludGVyY2VwdE5hdmlnYXRpb24pO1xuXHQgICAgYWRkRXZlbnQobW9kdWxlRmlsdGVyLCBcInJlc2V0XCIsIGZ1bmN0aW9uICgpIHtcblx0ICAgICAgLy8gTGV0IHRoZSByZXNldCBoYXBwZW4sIHRoZW4gdXBkYXRlIHN0eWxlc1xuXHQgICAgICB3aW5kb3ckMS5zZXRUaW1lb3V0KHNlbGVjdGlvbkNoYW5nZSk7XG5cdCAgICB9KTsgLy8gRW5hYmxlcyBzaG93L2hpZGUgZm9yIHRoZSBkcm9wZG93blxuXG5cdCAgICBmdW5jdGlvbiBzZWFyY2hGb2N1cygpIHtcblx0ICAgICAgaWYgKGRyb3BEb3duLnN0eWxlLmRpc3BsYXkgIT09IFwibm9uZVwiKSB7XG5cdCAgICAgICAgcmV0dXJuO1xuXHQgICAgICB9XG5cblx0ICAgICAgZHJvcERvd24uc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcblx0ICAgICAgYWRkRXZlbnQoZG9jdW1lbnQsIFwiY2xpY2tcIiwgaGlkZUhhbmRsZXIpO1xuXHQgICAgICBhZGRFdmVudChkb2N1bWVudCwgXCJrZXlkb3duXCIsIGhpZGVIYW5kbGVyKTsgLy8gSGlkZSBvbiBFc2NhcGUga2V5ZG93biBvciBvdXRzaWRlLWNvbnRhaW5lciBjbGlja1xuXG5cdCAgICAgIGZ1bmN0aW9uIGhpZGVIYW5kbGVyKGUpIHtcblx0ICAgICAgICB2YXIgaW5Db250YWluZXIgPSBtb2R1bGVGaWx0ZXIuY29udGFpbnMoZS50YXJnZXQpO1xuXG5cdCAgICAgICAgaWYgKGUua2V5Q29kZSA9PT0gMjcgfHwgIWluQ29udGFpbmVyKSB7XG5cdCAgICAgICAgICBpZiAoZS5rZXlDb2RlID09PSAyNyAmJiBpbkNvbnRhaW5lcikge1xuXHQgICAgICAgICAgICBtb2R1bGVTZWFyY2guZm9jdXMoKTtcblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgZHJvcERvd24uc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xuXHQgICAgICAgICAgcmVtb3ZlRXZlbnQoZG9jdW1lbnQsIFwiY2xpY2tcIiwgaGlkZUhhbmRsZXIpO1xuXHQgICAgICAgICAgcmVtb3ZlRXZlbnQoZG9jdW1lbnQsIFwia2V5ZG93blwiLCBoaWRlSGFuZGxlcik7XG5cdCAgICAgICAgICBtb2R1bGVTZWFyY2gudmFsdWUgPSBcIlwiO1xuXHQgICAgICAgICAgc2VhcmNoSW5wdXQoKTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgZnVuY3Rpb24gZmlsdGVyTW9kdWxlcyhzZWFyY2hUZXh0KSB7XG5cdCAgICAgIGlmIChzZWFyY2hUZXh0ID09PSBcIlwiKSB7XG5cdCAgICAgICAgcmV0dXJuIGNvbmZpZy5tb2R1bGVzO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIGZ1enp5c29ydC5nbyhzZWFyY2hUZXh0LCBjb25maWcubW9kdWxlcywge1xuXHQgICAgICAgIGtleTogXCJuYW1lUHJlcGFyZWRcIixcblx0ICAgICAgICB0aHJlc2hvbGQ6IC0xMDAwMFxuXHQgICAgICB9KS5tYXAoZnVuY3Rpb24gKG1vZHVsZSkge1xuXHQgICAgICAgIHJldHVybiBtb2R1bGUub2JqO1xuXHQgICAgICB9KTtcblx0ICAgIH0gLy8gUHJvY2Vzc2VzIG1vZHVsZSBzZWFyY2ggYm94IGlucHV0XG5cblxuXHQgICAgdmFyIHNlYXJjaElucHV0VGltZW91dDtcblxuXHQgICAgZnVuY3Rpb24gc2VhcmNoSW5wdXQoKSB7XG5cdCAgICAgIHdpbmRvdyQxLmNsZWFyVGltZW91dChzZWFyY2hJbnB1dFRpbWVvdXQpO1xuXHQgICAgICBzZWFyY2hJbnB1dFRpbWVvdXQgPSB3aW5kb3ckMS5zZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHtcblx0ICAgICAgICB2YXIgc2VhcmNoVGV4dCA9IG1vZHVsZVNlYXJjaC52YWx1ZS50b0xvd2VyQ2FzZSgpLFxuXHQgICAgICAgICAgICBmaWx0ZXJlZE1vZHVsZXMgPSBmaWx0ZXJNb2R1bGVzKHNlYXJjaFRleHQpO1xuXHQgICAgICAgIGRyb3BEb3duTGlzdC5pbm5lckhUTUwgPSBtb2R1bGVMaXN0SHRtbChmaWx0ZXJlZE1vZHVsZXMpO1xuXHQgICAgICB9LCAyMDApO1xuXHQgICAgfSAvLyBQcm9jZXNzZXMgc2VsZWN0aW9uIGNoYW5nZXNcblxuXG5cdCAgICBmdW5jdGlvbiBzZWxlY3Rpb25DaGFuZ2UoZXZ0KSB7XG5cdCAgICAgIHZhciBpLFxuXHQgICAgICAgICAgaXRlbSxcblx0ICAgICAgICAgIGNoZWNrYm94ID0gZXZ0ICYmIGV2dC50YXJnZXQgfHwgYWxsQ2hlY2tib3gsXG5cdCAgICAgICAgICBtb2R1bGVzTGlzdCA9IGRyb3BEb3duTGlzdC5nZXRFbGVtZW50c0J5VGFnTmFtZShcImlucHV0XCIpLFxuXHQgICAgICAgICAgc2VsZWN0ZWROYW1lcyA9IFtdO1xuXHQgICAgICB0b2dnbGVDbGFzcyhjaGVja2JveC5wYXJlbnROb2RlLCBcImNoZWNrZWRcIiwgY2hlY2tib3guY2hlY2tlZCk7XG5cdCAgICAgIGRpcnR5ID0gZmFsc2U7XG5cblx0ICAgICAgaWYgKGNoZWNrYm94LmNoZWNrZWQgJiYgY2hlY2tib3ggIT09IGFsbENoZWNrYm94KSB7XG5cdCAgICAgICAgYWxsQ2hlY2tib3guY2hlY2tlZCA9IGZhbHNlO1xuXHQgICAgICAgIHJlbW92ZUNsYXNzKGFsbENoZWNrYm94LnBhcmVudE5vZGUsIFwiY2hlY2tlZFwiKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGZvciAoaSA9IDA7IGkgPCBtb2R1bGVzTGlzdC5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIGl0ZW0gPSBtb2R1bGVzTGlzdFtpXTtcblxuXHQgICAgICAgIGlmICghZXZ0KSB7XG5cdCAgICAgICAgICB0b2dnbGVDbGFzcyhpdGVtLnBhcmVudE5vZGUsIFwiY2hlY2tlZFwiLCBpdGVtLmNoZWNrZWQpO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoY2hlY2tib3ggPT09IGFsbENoZWNrYm94ICYmIGNoZWNrYm94LmNoZWNrZWQpIHtcblx0ICAgICAgICAgIGl0ZW0uY2hlY2tlZCA9IGZhbHNlO1xuXHQgICAgICAgICAgcmVtb3ZlQ2xhc3MoaXRlbS5wYXJlbnROb2RlLCBcImNoZWNrZWRcIik7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgZGlydHkgPSBkaXJ0eSB8fCBpdGVtLmNoZWNrZWQgIT09IGl0ZW0uZGVmYXVsdENoZWNrZWQ7XG5cblx0ICAgICAgICBpZiAoaXRlbS5jaGVja2VkKSB7XG5cdCAgICAgICAgICBzZWxlY3RlZE5hbWVzLnB1c2goaXRlbS5wYXJlbnROb2RlLnRleHRDb250ZW50KTtcblx0ICAgICAgICB9XG5cdCAgICAgIH1cblxuXHQgICAgICBjb21taXQuc3R5bGUuZGlzcGxheSA9IHJlc2V0LnN0eWxlLmRpc3BsYXkgPSBkaXJ0eSA/IFwiXCIgOiBcIm5vbmVcIjtcblx0ICAgICAgbW9kdWxlU2VhcmNoLnBsYWNlaG9sZGVyID0gc2VsZWN0ZWROYW1lcy5qb2luKFwiLCBcIikgfHwgYWxsQ2hlY2tib3gucGFyZW50Tm9kZS50ZXh0Q29udGVudDtcblx0ICAgICAgbW9kdWxlU2VhcmNoLnRpdGxlID0gXCJUeXBlIHRvIGZpbHRlciBsaXN0LiBDdXJyZW50IHNlbGVjdGlvbjpcXG5cIiArIChzZWxlY3RlZE5hbWVzLmpvaW4oXCJcXG5cIikgfHwgYWxsQ2hlY2tib3gucGFyZW50Tm9kZS50ZXh0Q29udGVudCk7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBtb2R1bGVGaWx0ZXI7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gdG9vbGJhckZpbHRlcnMoKSB7XG5cdCAgICB2YXIgdG9vbGJhckZpbHRlcnMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0ICAgIHRvb2xiYXJGaWx0ZXJzLmlkID0gXCJxdW5pdC10b29sYmFyLWZpbHRlcnNcIjtcblx0ICAgIHRvb2xiYXJGaWx0ZXJzLmFwcGVuZENoaWxkKHRvb2xiYXJMb29zZUZpbHRlcigpKTtcblx0ICAgIHRvb2xiYXJGaWx0ZXJzLmFwcGVuZENoaWxkKHRvb2xiYXJNb2R1bGVGaWx0ZXIoKSk7XG5cdCAgICByZXR1cm4gdG9vbGJhckZpbHRlcnM7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYXBwZW5kVG9vbGJhcigpIHtcblx0ICAgIHZhciB0b29sYmFyID0gaWQoXCJxdW5pdC10ZXN0cnVubmVyLXRvb2xiYXJcIik7XG5cblx0ICAgIGlmICh0b29sYmFyKSB7XG5cdCAgICAgIHRvb2xiYXIuYXBwZW5kQ2hpbGQodG9vbGJhclVybENvbmZpZ0NvbnRhaW5lcigpKTtcblx0ICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZCh0b29sYmFyRmlsdGVycygpKTtcblx0ICAgICAgdG9vbGJhci5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpKS5jbGFzc05hbWUgPSBcImNsZWFyZml4XCI7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYXBwZW5kSGVhZGVyKCkge1xuXHQgICAgdmFyIGhlYWRlciA9IGlkKFwicXVuaXQtaGVhZGVyXCIpO1xuXG5cdCAgICBpZiAoaGVhZGVyKSB7XG5cdCAgICAgIGhlYWRlci5pbm5lckhUTUwgPSBcIjxhIGhyZWY9J1wiICsgZXNjYXBlVGV4dCh1bmZpbHRlcmVkVXJsKSArIFwiJz5cIiArIGhlYWRlci5pbm5lckhUTUwgKyBcIjwvYT4gXCI7XG5cdCAgICB9XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYXBwZW5kQmFubmVyKCkge1xuXHQgICAgdmFyIGJhbm5lciA9IGlkKFwicXVuaXQtYmFubmVyXCIpO1xuXG5cdCAgICBpZiAoYmFubmVyKSB7XG5cdCAgICAgIGJhbm5lci5jbGFzc05hbWUgPSBcIlwiO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZFRlc3RSZXN1bHRzKCkge1xuXHQgICAgdmFyIHRlc3RzID0gaWQoXCJxdW5pdC10ZXN0c1wiKSxcblx0ICAgICAgICByZXN1bHQgPSBpZChcInF1bml0LXRlc3RyZXN1bHRcIiksXG5cdCAgICAgICAgY29udHJvbHM7XG5cblx0ICAgIGlmIChyZXN1bHQpIHtcblx0ICAgICAgcmVzdWx0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQocmVzdWx0KTtcblx0ICAgIH1cblxuXHQgICAgaWYgKHRlc3RzKSB7XG5cdCAgICAgIHRlc3RzLmlubmVySFRNTCA9IFwiXCI7XG5cdCAgICAgIHJlc3VsdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJwXCIpO1xuXHQgICAgICByZXN1bHQuaWQgPSBcInF1bml0LXRlc3RyZXN1bHRcIjtcblx0ICAgICAgcmVzdWx0LmNsYXNzTmFtZSA9IFwicmVzdWx0XCI7XG5cdCAgICAgIHRlc3RzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKHJlc3VsdCwgdGVzdHMpO1xuXHQgICAgICByZXN1bHQuaW5uZXJIVE1MID0gXCI8ZGl2IGlkPVxcXCJxdW5pdC10ZXN0cmVzdWx0LWRpc3BsYXlcXFwiPlJ1bm5pbmcuLi48YnIgLz4mIzE2MDs8L2Rpdj5cIiArIFwiPGRpdiBpZD1cXFwicXVuaXQtdGVzdHJlc3VsdC1jb250cm9sc1xcXCI+PC9kaXY+XCIgKyBcIjxkaXYgY2xhc3M9XFxcImNsZWFyZml4XFxcIj48L2Rpdj5cIjtcblx0ICAgICAgY29udHJvbHMgPSBpZChcInF1bml0LXRlc3RyZXN1bHQtY29udHJvbHNcIik7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb250cm9scykge1xuXHQgICAgICBjb250cm9scy5hcHBlbmRDaGlsZChhYm9ydFRlc3RzQnV0dG9uKCkpO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZEZpbHRlcmVkVGVzdCgpIHtcblx0ICAgIHZhciB0ZXN0SWQgPSBRVW5pdC5jb25maWcudGVzdElkO1xuXG5cdCAgICBpZiAoIXRlc3RJZCB8fCB0ZXN0SWQubGVuZ3RoIDw9IDApIHtcblx0ICAgICAgcmV0dXJuIFwiXCI7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBcIjxkaXYgaWQ9J3F1bml0LWZpbHRlcmVkVGVzdCc+UmVydW5uaW5nIHNlbGVjdGVkIHRlc3RzOiBcIiArIGVzY2FwZVRleHQodGVzdElkLmpvaW4oXCIsIFwiKSkgKyBcIiA8YSBpZD0ncXVuaXQtY2xlYXJGaWx0ZXInIGhyZWY9J1wiICsgZXNjYXBlVGV4dCh1bmZpbHRlcmVkVXJsKSArIFwiJz5SdW4gYWxsIHRlc3RzPC9hPjwvZGl2PlwiO1xuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZFVzZXJBZ2VudCgpIHtcblx0ICAgIHZhciB1c2VyQWdlbnQgPSBpZChcInF1bml0LXVzZXJBZ2VudFwiKTtcblxuXHQgICAgaWYgKHVzZXJBZ2VudCkge1xuXHQgICAgICB1c2VyQWdlbnQuaW5uZXJIVE1MID0gXCJcIjtcblx0ICAgICAgdXNlckFnZW50LmFwcGVuZENoaWxkKGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiUVVuaXQgXCIgKyBRVW5pdC52ZXJzaW9uICsgXCI7IFwiICsgbmF2aWdhdG9yLnVzZXJBZ2VudCkpO1xuXHQgICAgfVxuXHQgIH1cblxuXHQgIGZ1bmN0aW9uIGFwcGVuZEludGVyZmFjZSgpIHtcblx0ICAgIHZhciBxdW5pdCA9IGlkKFwicXVuaXRcIik7IC8vIEZvciBjb21wYXQgd2l0aCBRVW5pdCAxLjIsIGFuZCB0byBzdXBwb3J0IGZ1bGx5IGN1c3RvbSB0aGVtZSBIVE1MLFxuXHQgICAgLy8gd2Ugd2lsbCB1c2UgYW55IGV4aXN0aW5nIGVsZW1lbnRzIGlmIG5vIGlkPVwicXVuaXRcIiBlbGVtZW50IGV4aXN0cy5cblx0ICAgIC8vXG5cdCAgICAvLyBOb3RlIHRoYXQgd2UgZG9uJ3QgZmFpbCBvciBmYWxsYmFjayB0byBjcmVhdGluZyBpdCBvdXJzZWx2ZXMsXG5cdCAgICAvLyBiZWNhdXNlIG5vdCBoYXZpbmcgaWQ9XCJxdW5pdFwiIChhbmQgbm90IGhhdmluZyB0aGUgYmVsb3cgZWxlbWVudHMpXG5cdCAgICAvLyBzaW1wbHkgbWVhbnMgUVVuaXQgYWN0cyBoZWFkbGVzcywgYWxsb3dpbmcgdXNlcnMgdG8gdXNlIHRoZWlyIG93blxuXHQgICAgLy8gcmVwb3J0ZXJzLCBvciBmb3IgYSB0ZXN0IHJ1bm5lciB0byBsaXN0ZW4gZm9yIGV2ZW50cyBkaXJlY3RseSB3aXRob3V0XG5cdCAgICAvLyBoYXZpbmcgdGhlIEhUTUwgcmVwb3J0ZXIgYWN0aXZlbHkgcmVuZGVyIGFueXRoaW5nLlxuXG5cdCAgICBpZiAocXVuaXQpIHtcblx0ICAgICAgLy8gU2luY2UgUVVuaXQgMS4zLCB0aGVzZSBhcmUgY3JlYXRlZCBhdXRvbWF0aWNhbGx5IGlmIHRoZSBwYWdlXG5cdCAgICAgIC8vIGNvbnRhaW5zIGlkPVwicXVuaXRcIi5cblx0ICAgICAgcXVuaXQuaW5uZXJIVE1MID0gXCI8aDEgaWQ9J3F1bml0LWhlYWRlcic+XCIgKyBlc2NhcGVUZXh0KGRvY3VtZW50LnRpdGxlKSArIFwiPC9oMT5cIiArIFwiPGgyIGlkPSdxdW5pdC1iYW5uZXInPjwvaDI+XCIgKyBcIjxkaXYgaWQ9J3F1bml0LXRlc3RydW5uZXItdG9vbGJhcic+PC9kaXY+XCIgKyBhcHBlbmRGaWx0ZXJlZFRlc3QoKSArIFwiPGgyIGlkPSdxdW5pdC11c2VyQWdlbnQnPjwvaDI+XCIgKyBcIjxvbCBpZD0ncXVuaXQtdGVzdHMnPjwvb2w+XCI7XG5cdCAgICB9XG5cblx0ICAgIGFwcGVuZEhlYWRlcigpO1xuXHQgICAgYXBwZW5kQmFubmVyKCk7XG5cdCAgICBhcHBlbmRUZXN0UmVzdWx0cygpO1xuXHQgICAgYXBwZW5kVXNlckFnZW50KCk7XG5cdCAgICBhcHBlbmRUb29sYmFyKCk7XG5cdCAgfVxuXG5cdCAgZnVuY3Rpb24gYXBwZW5kVGVzdChuYW1lLCB0ZXN0SWQsIG1vZHVsZU5hbWUpIHtcblx0ICAgIHZhciB0aXRsZSxcblx0ICAgICAgICByZXJ1blRyaWdnZXIsXG5cdCAgICAgICAgdGVzdEJsb2NrLFxuXHQgICAgICAgIGFzc2VydExpc3QsXG5cdCAgICAgICAgdGVzdHMgPSBpZChcInF1bml0LXRlc3RzXCIpO1xuXG5cdCAgICBpZiAoIXRlc3RzKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgdGl0bGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3Ryb25nXCIpO1xuXHQgICAgdGl0bGUuaW5uZXJIVE1MID0gZ2V0TmFtZUh0bWwobmFtZSwgbW9kdWxlTmFtZSk7XG5cdCAgICByZXJ1blRyaWdnZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYVwiKTtcblx0ICAgIHJlcnVuVHJpZ2dlci5pbm5lckhUTUwgPSBcIlJlcnVuXCI7XG5cdCAgICByZXJ1blRyaWdnZXIuaHJlZiA9IHNldFVybCh7XG5cdCAgICAgIHRlc3RJZDogdGVzdElkXG5cdCAgICB9KTtcblx0ICAgIHRlc3RCbG9jayA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaVwiKTtcblx0ICAgIHRlc3RCbG9jay5hcHBlbmRDaGlsZCh0aXRsZSk7XG5cdCAgICB0ZXN0QmxvY2suYXBwZW5kQ2hpbGQocmVydW5UcmlnZ2VyKTtcblx0ICAgIHRlc3RCbG9jay5pZCA9IFwicXVuaXQtdGVzdC1vdXRwdXQtXCIgKyB0ZXN0SWQ7XG5cdCAgICBhc3NlcnRMaXN0ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcIm9sXCIpO1xuXHQgICAgYXNzZXJ0TGlzdC5jbGFzc05hbWUgPSBcInF1bml0LWFzc2VydC1saXN0XCI7XG5cdCAgICB0ZXN0QmxvY2suYXBwZW5kQ2hpbGQoYXNzZXJ0TGlzdCk7XG5cdCAgICB0ZXN0cy5hcHBlbmRDaGlsZCh0ZXN0QmxvY2spO1xuXHQgIH0gLy8gSFRNTCBSZXBvcnRlciBpbml0aWFsaXphdGlvbiBhbmQgbG9hZFxuXG5cblx0ICBRVW5pdC5iZWdpbihmdW5jdGlvbiAoZGV0YWlscykge1xuXHQgICAgdmFyIGksIG1vZHVsZU9iajsgLy8gU29ydCBtb2R1bGVzIGJ5IG5hbWUgZm9yIHRoZSBwaWNrZXJcblxuXHQgICAgZm9yIChpID0gMDsgaSA8IGRldGFpbHMubW9kdWxlcy5sZW5ndGg7IGkrKykge1xuXHQgICAgICBtb2R1bGVPYmogPSBkZXRhaWxzLm1vZHVsZXNbaV07XG5cblx0ICAgICAgaWYgKG1vZHVsZU9iai5uYW1lKSB7XG5cdCAgICAgICAgbW9kdWxlc0xpc3QucHVzaChtb2R1bGVPYmoubmFtZSk7XG5cdCAgICAgIH1cblx0ICAgIH1cblxuXHQgICAgbW9kdWxlc0xpc3Quc29ydChmdW5jdGlvbiAoYSwgYikge1xuXHQgICAgICByZXR1cm4gYS5sb2NhbGVDb21wYXJlKGIpO1xuXHQgICAgfSk7IC8vIEluaXRpYWxpemUgUVVuaXQgZWxlbWVudHNcblxuXHQgICAgYXBwZW5kSW50ZXJmYWNlKCk7XG5cdCAgfSk7XG5cdCAgUVVuaXQuZG9uZShmdW5jdGlvbiAoZGV0YWlscykge1xuXHQgICAgdmFyIGJhbm5lciA9IGlkKFwicXVuaXQtYmFubmVyXCIpLFxuXHQgICAgICAgIHRlc3RzID0gaWQoXCJxdW5pdC10ZXN0c1wiKSxcblx0ICAgICAgICBhYm9ydEJ1dHRvbiA9IGlkKFwicXVuaXQtYWJvcnQtdGVzdHMtYnV0dG9uXCIpLFxuXHQgICAgICAgIHRvdGFsVGVzdHMgPSBzdGF0cy5wYXNzZWRUZXN0cyArIHN0YXRzLnNraXBwZWRUZXN0cyArIHN0YXRzLnRvZG9UZXN0cyArIHN0YXRzLmZhaWxlZFRlc3RzLFxuXHQgICAgICAgIGh0bWwgPSBbdG90YWxUZXN0cywgXCIgdGVzdHMgY29tcGxldGVkIGluIFwiLCBkZXRhaWxzLnJ1bnRpbWUsIFwiIG1pbGxpc2Vjb25kcywgd2l0aCBcIiwgc3RhdHMuZmFpbGVkVGVzdHMsIFwiIGZhaWxlZCwgXCIsIHN0YXRzLnNraXBwZWRUZXN0cywgXCIgc2tpcHBlZCwgYW5kIFwiLCBzdGF0cy50b2RvVGVzdHMsIFwiIHRvZG8uPGJyIC8+XCIsIFwiPHNwYW4gY2xhc3M9J3Bhc3NlZCc+XCIsIGRldGFpbHMucGFzc2VkLCBcIjwvc3Bhbj4gYXNzZXJ0aW9ucyBvZiA8c3BhbiBjbGFzcz0ndG90YWwnPlwiLCBkZXRhaWxzLnRvdGFsLCBcIjwvc3Bhbj4gcGFzc2VkLCA8c3BhbiBjbGFzcz0nZmFpbGVkJz5cIiwgZGV0YWlscy5mYWlsZWQsIFwiPC9zcGFuPiBmYWlsZWQuXCJdLmpvaW4oXCJcIiksXG5cdCAgICAgICAgdGVzdCxcblx0ICAgICAgICBhc3NlcnRMaSxcblx0ICAgICAgICBhc3NlcnRMaXN0OyAvLyBVcGRhdGUgcmVtYWluaW5nIHRlc3RzIHRvIGFib3J0ZWRcblxuXHQgICAgaWYgKGFib3J0QnV0dG9uICYmIGFib3J0QnV0dG9uLmRpc2FibGVkKSB7XG5cdCAgICAgIGh0bWwgPSBcIlRlc3RzIGFib3J0ZWQgYWZ0ZXIgXCIgKyBkZXRhaWxzLnJ1bnRpbWUgKyBcIiBtaWxsaXNlY29uZHMuXCI7XG5cblx0ICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0ZXN0cy5jaGlsZHJlbi5sZW5ndGg7IGkrKykge1xuXHQgICAgICAgIHRlc3QgPSB0ZXN0cy5jaGlsZHJlbltpXTtcblxuXHQgICAgICAgIGlmICh0ZXN0LmNsYXNzTmFtZSA9PT0gXCJcIiB8fCB0ZXN0LmNsYXNzTmFtZSA9PT0gXCJydW5uaW5nXCIpIHtcblx0ICAgICAgICAgIHRlc3QuY2xhc3NOYW1lID0gXCJhYm9ydGVkXCI7XG5cdCAgICAgICAgICBhc3NlcnRMaXN0ID0gdGVzdC5nZXRFbGVtZW50c0J5VGFnTmFtZShcIm9sXCIpWzBdO1xuXHQgICAgICAgICAgYXNzZXJ0TGkgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwibGlcIik7XG5cdCAgICAgICAgICBhc3NlcnRMaS5jbGFzc05hbWUgPSBcImZhaWxcIjtcblx0ICAgICAgICAgIGFzc2VydExpLmlubmVySFRNTCA9IFwiVGVzdCBhYm9ydGVkLlwiO1xuXHQgICAgICAgICAgYXNzZXJ0TGlzdC5hcHBlbmRDaGlsZChhc3NlcnRMaSk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIGlmIChiYW5uZXIgJiYgKCFhYm9ydEJ1dHRvbiB8fCBhYm9ydEJ1dHRvbi5kaXNhYmxlZCA9PT0gZmFsc2UpKSB7XG5cdCAgICAgIGJhbm5lci5jbGFzc05hbWUgPSBzdGF0cy5mYWlsZWRUZXN0cyA/IFwicXVuaXQtZmFpbFwiIDogXCJxdW5pdC1wYXNzXCI7XG5cdCAgICB9XG5cblx0ICAgIGlmIChhYm9ydEJ1dHRvbikge1xuXHQgICAgICBhYm9ydEJ1dHRvbi5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKGFib3J0QnV0dG9uKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKHRlc3RzKSB7XG5cdCAgICAgIGlkKFwicXVuaXQtdGVzdHJlc3VsdC1kaXNwbGF5XCIpLmlubmVySFRNTCA9IGh0bWw7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb25maWcuYWx0ZXJ0aXRsZSAmJiBkb2N1bWVudC50aXRsZSkge1xuXHQgICAgICAvLyBTaG93IOKcliBmb3IgZ29vZCwg4pyUIGZvciBiYWQgc3VpdGUgcmVzdWx0IGluIHRpdGxlXG5cdCAgICAgIC8vIHVzZSBlc2NhcGUgc2VxdWVuY2VzIGluIGNhc2UgZmlsZSBnZXRzIGxvYWRlZCB3aXRoIG5vbi11dGYtOFxuXHQgICAgICAvLyBjaGFyc2V0XG5cdCAgICAgIGRvY3VtZW50LnRpdGxlID0gW3N0YXRzLmZhaWxlZFRlc3RzID8gXCJcXHUyNzE2XCIgOiBcIlxcdTI3MTRcIiwgZG9jdW1lbnQudGl0bGUucmVwbGFjZSgvXltcXHUyNzE0XFx1MjcxNl0gL2ksIFwiXCIpXS5qb2luKFwiIFwiKTtcblx0ICAgIH0gLy8gU2Nyb2xsIGJhY2sgdG8gdG9wIHRvIHNob3cgcmVzdWx0c1xuXG5cblx0ICAgIGlmIChjb25maWcuc2Nyb2xsdG9wICYmIHdpbmRvdyQxLnNjcm9sbFRvKSB7XG5cdCAgICAgIHdpbmRvdyQxLnNjcm9sbFRvKDAsIDApO1xuXHQgICAgfVxuXHQgIH0pO1xuXG5cdCAgZnVuY3Rpb24gZ2V0TmFtZUh0bWwobmFtZSwgbW9kdWxlKSB7XG5cdCAgICB2YXIgbmFtZUh0bWwgPSBcIlwiO1xuXG5cdCAgICBpZiAobW9kdWxlKSB7XG5cdCAgICAgIG5hbWVIdG1sID0gXCI8c3BhbiBjbGFzcz0nbW9kdWxlLW5hbWUnPlwiICsgZXNjYXBlVGV4dChtb2R1bGUpICsgXCI8L3NwYW4+OiBcIjtcblx0ICAgIH1cblxuXHQgICAgbmFtZUh0bWwgKz0gXCI8c3BhbiBjbGFzcz0ndGVzdC1uYW1lJz5cIiArIGVzY2FwZVRleHQobmFtZSkgKyBcIjwvc3Bhbj5cIjtcblx0ICAgIHJldHVybiBuYW1lSHRtbDtcblx0ICB9XG5cblx0ICBmdW5jdGlvbiBnZXRQcm9ncmVzc0h0bWwocnVudGltZSwgc3RhdHMsIHRvdGFsKSB7XG5cdCAgICB2YXIgY29tcGxldGVkID0gc3RhdHMucGFzc2VkVGVzdHMgKyBzdGF0cy5za2lwcGVkVGVzdHMgKyBzdGF0cy50b2RvVGVzdHMgKyBzdGF0cy5mYWlsZWRUZXN0cztcblx0ICAgIHJldHVybiBbXCI8YnIgLz5cIiwgY29tcGxldGVkLCBcIiAvIFwiLCB0b3RhbCwgXCIgdGVzdHMgY29tcGxldGVkIGluIFwiLCBydW50aW1lLCBcIiBtaWxsaXNlY29uZHMsIHdpdGggXCIsIHN0YXRzLmZhaWxlZFRlc3RzLCBcIiBmYWlsZWQsIFwiLCBzdGF0cy5za2lwcGVkVGVzdHMsIFwiIHNraXBwZWQsIGFuZCBcIiwgc3RhdHMudG9kb1Rlc3RzLCBcIiB0b2RvLlwiXS5qb2luKFwiXCIpO1xuXHQgIH1cblxuXHQgIFFVbml0LnRlc3RTdGFydChmdW5jdGlvbiAoZGV0YWlscykge1xuXHQgICAgdmFyIHJ1bm5pbmcsIGJhZDtcblx0ICAgIGFwcGVuZFRlc3QoZGV0YWlscy5uYW1lLCBkZXRhaWxzLnRlc3RJZCwgZGV0YWlscy5tb2R1bGUpO1xuXHQgICAgcnVubmluZyA9IGlkKFwicXVuaXQtdGVzdHJlc3VsdC1kaXNwbGF5XCIpO1xuXG5cdCAgICBpZiAocnVubmluZykge1xuXHQgICAgICBhZGRDbGFzcyhydW5uaW5nLCBcInJ1bm5pbmdcIik7XG5cdCAgICAgIGJhZCA9IFFVbml0LmNvbmZpZy5yZW9yZGVyICYmIGRldGFpbHMucHJldmlvdXNGYWlsdXJlO1xuXHQgICAgICBydW5uaW5nLmlubmVySFRNTCA9IFtiYWQgPyBcIlJlcnVubmluZyBwcmV2aW91c2x5IGZhaWxlZCB0ZXN0OiA8YnIgLz5cIiA6IFwiUnVubmluZzogPGJyIC8+XCIsIGdldE5hbWVIdG1sKGRldGFpbHMubmFtZSwgZGV0YWlscy5tb2R1bGUpLCBnZXRQcm9ncmVzc0h0bWwobm93KCkgLSBjb25maWcuc3RhcnRlZCwgc3RhdHMsIFRlc3QuY291bnQpXS5qb2luKFwiXCIpO1xuXHQgICAgfVxuXHQgIH0pO1xuXG5cdCAgZnVuY3Rpb24gc3RyaXBIdG1sKHN0cmluZykge1xuXHQgICAgLy8gU3RyaXAgdGFncywgaHRtbCBlbnRpdHkgYW5kIHdoaXRlc3BhY2VzXG5cdCAgICByZXR1cm4gc3RyaW5nLnJlcGxhY2UoLzxcXC8/W14+XSsoPnwkKS9nLCBcIlwiKS5yZXBsYWNlKC8mcXVvdDsvZywgXCJcIikucmVwbGFjZSgvXFxzKy9nLCBcIlwiKTtcblx0ICB9XG5cblx0ICBRVW5pdC5sb2coZnVuY3Rpb24gKGRldGFpbHMpIHtcblx0ICAgIHZhciBhc3NlcnRMaXN0LFxuXHQgICAgICAgIGFzc2VydExpLFxuXHQgICAgICAgIG1lc3NhZ2UsXG5cdCAgICAgICAgZXhwZWN0ZWQsXG5cdCAgICAgICAgYWN0dWFsLFxuXHQgICAgICAgIGRpZmYsXG5cdCAgICAgICAgc2hvd0RpZmYgPSBmYWxzZSxcblx0ICAgICAgICB0ZXN0SXRlbSA9IGlkKFwicXVuaXQtdGVzdC1vdXRwdXQtXCIgKyBkZXRhaWxzLnRlc3RJZCk7XG5cblx0ICAgIGlmICghdGVzdEl0ZW0pIHtcblx0ICAgICAgcmV0dXJuO1xuXHQgICAgfVxuXG5cdCAgICBtZXNzYWdlID0gZXNjYXBlVGV4dChkZXRhaWxzLm1lc3NhZ2UpIHx8IChkZXRhaWxzLnJlc3VsdCA/IFwib2theVwiIDogXCJmYWlsZWRcIik7XG5cdCAgICBtZXNzYWdlID0gXCI8c3BhbiBjbGFzcz0ndGVzdC1tZXNzYWdlJz5cIiArIG1lc3NhZ2UgKyBcIjwvc3Bhbj5cIjtcblx0ICAgIG1lc3NhZ2UgKz0gXCI8c3BhbiBjbGFzcz0ncnVudGltZSc+QCBcIiArIGRldGFpbHMucnVudGltZSArIFwiIG1zPC9zcGFuPlwiOyAvLyBUaGUgcHVzaEZhaWx1cmUgZG9lc24ndCBwcm92aWRlIGRldGFpbHMuZXhwZWN0ZWRcblx0ICAgIC8vIHdoZW4gaXQgY2FsbHMsIGl0J3MgaW1wbGljaXQgdG8gYWxzbyBub3Qgc2hvdyBleHBlY3RlZCBhbmQgZGlmZiBzdHVmZlxuXHQgICAgLy8gQWxzbywgd2UgbmVlZCB0byBjaGVjayBkZXRhaWxzLmV4cGVjdGVkIGV4aXN0ZW5jZSwgYXMgaXQgY2FuIGV4aXN0IGFuZCBiZSB1bmRlZmluZWRcblxuXHQgICAgaWYgKCFkZXRhaWxzLnJlc3VsdCAmJiBoYXNPd24uY2FsbChkZXRhaWxzLCBcImV4cGVjdGVkXCIpKSB7XG5cdCAgICAgIGlmIChkZXRhaWxzLm5lZ2F0aXZlKSB7XG5cdCAgICAgICAgZXhwZWN0ZWQgPSBcIk5PVCBcIiArIFFVbml0LmR1bXAucGFyc2UoZGV0YWlscy5leHBlY3RlZCk7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgZXhwZWN0ZWQgPSBRVW5pdC5kdW1wLnBhcnNlKGRldGFpbHMuZXhwZWN0ZWQpO1xuXHQgICAgICB9XG5cblx0ICAgICAgYWN0dWFsID0gUVVuaXQuZHVtcC5wYXJzZShkZXRhaWxzLmFjdHVhbCk7XG5cdCAgICAgIG1lc3NhZ2UgKz0gXCI8dGFibGU+PHRyIGNsYXNzPSd0ZXN0LWV4cGVjdGVkJz48dGg+RXhwZWN0ZWQ6IDwvdGg+PHRkPjxwcmU+XCIgKyBlc2NhcGVUZXh0KGV4cGVjdGVkKSArIFwiPC9wcmU+PC90ZD48L3RyPlwiO1xuXG5cdCAgICAgIGlmIChhY3R1YWwgIT09IGV4cGVjdGVkKSB7XG5cdCAgICAgICAgbWVzc2FnZSArPSBcIjx0ciBjbGFzcz0ndGVzdC1hY3R1YWwnPjx0aD5SZXN1bHQ6IDwvdGg+PHRkPjxwcmU+XCIgKyBlc2NhcGVUZXh0KGFjdHVhbCkgKyBcIjwvcHJlPjwvdGQ+PC90cj5cIjtcblxuXHQgICAgICAgIGlmICh0eXBlb2YgZGV0YWlscy5hY3R1YWwgPT09IFwibnVtYmVyXCIgJiYgdHlwZW9mIGRldGFpbHMuZXhwZWN0ZWQgPT09IFwibnVtYmVyXCIpIHtcblx0ICAgICAgICAgIGlmICghaXNOYU4oZGV0YWlscy5hY3R1YWwpICYmICFpc05hTihkZXRhaWxzLmV4cGVjdGVkKSkge1xuXHQgICAgICAgICAgICBzaG93RGlmZiA9IHRydWU7XG5cdCAgICAgICAgICAgIGRpZmYgPSBkZXRhaWxzLmFjdHVhbCAtIGRldGFpbHMuZXhwZWN0ZWQ7XG5cdCAgICAgICAgICAgIGRpZmYgPSAoZGlmZiA+IDAgPyBcIitcIiA6IFwiXCIpICsgZGlmZjtcblx0ICAgICAgICAgIH1cblx0ICAgICAgICB9IGVsc2UgaWYgKHR5cGVvZiBkZXRhaWxzLmFjdHVhbCAhPT0gXCJib29sZWFuXCIgJiYgdHlwZW9mIGRldGFpbHMuZXhwZWN0ZWQgIT09IFwiYm9vbGVhblwiKSB7XG5cdCAgICAgICAgICBkaWZmID0gUVVuaXQuZGlmZihleHBlY3RlZCwgYWN0dWFsKTsgLy8gZG9uJ3Qgc2hvdyBkaWZmIGlmIHRoZXJlIGlzIHplcm8gb3ZlcmxhcFxuXG5cdCAgICAgICAgICBzaG93RGlmZiA9IHN0cmlwSHRtbChkaWZmKS5sZW5ndGggIT09IHN0cmlwSHRtbChleHBlY3RlZCkubGVuZ3RoICsgc3RyaXBIdG1sKGFjdHVhbCkubGVuZ3RoO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIGlmIChzaG93RGlmZikge1xuXHQgICAgICAgICAgbWVzc2FnZSArPSBcIjx0ciBjbGFzcz0ndGVzdC1kaWZmJz48dGg+RGlmZjogPC90aD48dGQ+PHByZT5cIiArIGRpZmYgKyBcIjwvcHJlPjwvdGQ+PC90cj5cIjtcblx0ICAgICAgICB9XG5cdCAgICAgIH0gZWxzZSBpZiAoZXhwZWN0ZWQuaW5kZXhPZihcIltvYmplY3QgQXJyYXldXCIpICE9PSAtMSB8fCBleHBlY3RlZC5pbmRleE9mKFwiW29iamVjdCBPYmplY3RdXCIpICE9PSAtMSkge1xuXHQgICAgICAgIG1lc3NhZ2UgKz0gXCI8dHIgY2xhc3M9J3Rlc3QtbWVzc2FnZSc+PHRoPk1lc3NhZ2U6IDwvdGg+PHRkPlwiICsgXCJEaWZmIHN1cHByZXNzZWQgYXMgdGhlIGRlcHRoIG9mIG9iamVjdCBpcyBtb3JlIHRoYW4gY3VycmVudCBtYXggZGVwdGggKFwiICsgUVVuaXQuY29uZmlnLm1heERlcHRoICsgXCIpLjxwPkhpbnQ6IFVzZSA8Y29kZT5RVW5pdC5kdW1wLm1heERlcHRoPC9jb2RlPiB0byBcIiArIFwiIHJ1biB3aXRoIGEgaGlnaGVyIG1heCBkZXB0aCBvciA8YSBocmVmPSdcIiArIGVzY2FwZVRleHQoc2V0VXJsKHtcblx0ICAgICAgICAgIG1heERlcHRoOiAtMVxuXHQgICAgICAgIH0pKSArIFwiJz5cIiArIFwiUmVydW48L2E+IHdpdGhvdXQgbWF4IGRlcHRoLjwvcD48L3RkPjwvdHI+XCI7XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgbWVzc2FnZSArPSBcIjx0ciBjbGFzcz0ndGVzdC1tZXNzYWdlJz48dGg+TWVzc2FnZTogPC90aD48dGQ+XCIgKyBcIkRpZmYgc3VwcHJlc3NlZCBhcyB0aGUgZXhwZWN0ZWQgYW5kIGFjdHVhbCByZXN1bHRzIGhhdmUgYW4gZXF1aXZhbGVudFwiICsgXCIgc2VyaWFsaXphdGlvbjwvdGQ+PC90cj5cIjtcblx0ICAgICAgfVxuXG5cdCAgICAgIGlmIChkZXRhaWxzLnNvdXJjZSkge1xuXHQgICAgICAgIG1lc3NhZ2UgKz0gXCI8dHIgY2xhc3M9J3Rlc3Qtc291cmNlJz48dGg+U291cmNlOiA8L3RoPjx0ZD48cHJlPlwiICsgZXNjYXBlVGV4dChkZXRhaWxzLnNvdXJjZSkgKyBcIjwvcHJlPjwvdGQ+PC90cj5cIjtcblx0ICAgICAgfVxuXG5cdCAgICAgIG1lc3NhZ2UgKz0gXCI8L3RhYmxlPlwiOyAvLyBUaGlzIG9jY3VycyB3aGVuIHB1c2hGYWlsdXJlIGlzIHNldCBhbmQgd2UgaGF2ZSBhbiBleHRyYWN0ZWQgc3RhY2sgdHJhY2Vcblx0ICAgIH0gZWxzZSBpZiAoIWRldGFpbHMucmVzdWx0ICYmIGRldGFpbHMuc291cmNlKSB7XG5cdCAgICAgIG1lc3NhZ2UgKz0gXCI8dGFibGU+XCIgKyBcIjx0ciBjbGFzcz0ndGVzdC1zb3VyY2UnPjx0aD5Tb3VyY2U6IDwvdGg+PHRkPjxwcmU+XCIgKyBlc2NhcGVUZXh0KGRldGFpbHMuc291cmNlKSArIFwiPC9wcmU+PC90ZD48L3RyPlwiICsgXCI8L3RhYmxlPlwiO1xuXHQgICAgfVxuXG5cdCAgICBhc3NlcnRMaXN0ID0gdGVzdEl0ZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoXCJvbFwiKVswXTtcblx0ICAgIGFzc2VydExpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxpXCIpO1xuXHQgICAgYXNzZXJ0TGkuY2xhc3NOYW1lID0gZGV0YWlscy5yZXN1bHQgPyBcInBhc3NcIiA6IFwiZmFpbFwiO1xuXHQgICAgYXNzZXJ0TGkuaW5uZXJIVE1MID0gbWVzc2FnZTtcblx0ICAgIGFzc2VydExpc3QuYXBwZW5kQ2hpbGQoYXNzZXJ0TGkpO1xuXHQgIH0pO1xuXHQgIFFVbml0LnRlc3REb25lKGZ1bmN0aW9uIChkZXRhaWxzKSB7XG5cdCAgICB2YXIgdGVzdFRpdGxlLFxuXHQgICAgICAgIHRpbWUsXG5cdCAgICAgICAgdGVzdEl0ZW0sXG5cdCAgICAgICAgYXNzZXJ0TGlzdCxcblx0ICAgICAgICBzdGF0dXMsXG5cdCAgICAgICAgZ29vZCxcblx0ICAgICAgICBiYWQsXG5cdCAgICAgICAgdGVzdENvdW50cyxcblx0ICAgICAgICBza2lwcGVkLFxuXHQgICAgICAgIHNvdXJjZU5hbWUsXG5cdCAgICAgICAgdGVzdHMgPSBpZChcInF1bml0LXRlc3RzXCIpO1xuXG5cdCAgICBpZiAoIXRlc3RzKSB7XG5cdCAgICAgIHJldHVybjtcblx0ICAgIH1cblxuXHQgICAgdGVzdEl0ZW0gPSBpZChcInF1bml0LXRlc3Qtb3V0cHV0LVwiICsgZGV0YWlscy50ZXN0SWQpO1xuXHQgICAgcmVtb3ZlQ2xhc3ModGVzdEl0ZW0sIFwicnVubmluZ1wiKTtcblxuXHQgICAgaWYgKGRldGFpbHMuZmFpbGVkID4gMCkge1xuXHQgICAgICBzdGF0dXMgPSBcImZhaWxlZFwiO1xuXHQgICAgfSBlbHNlIGlmIChkZXRhaWxzLnRvZG8pIHtcblx0ICAgICAgc3RhdHVzID0gXCJ0b2RvXCI7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICBzdGF0dXMgPSBkZXRhaWxzLnNraXBwZWQgPyBcInNraXBwZWRcIiA6IFwicGFzc2VkXCI7XG5cdCAgICB9XG5cblx0ICAgIGFzc2VydExpc3QgPSB0ZXN0SXRlbS5nZXRFbGVtZW50c0J5VGFnTmFtZShcIm9sXCIpWzBdO1xuXHQgICAgZ29vZCA9IGRldGFpbHMucGFzc2VkO1xuXHQgICAgYmFkID0gZGV0YWlscy5mYWlsZWQ7IC8vIFRoaXMgdGVzdCBwYXNzZWQgaWYgaXQgaGFzIG5vIHVuZXhwZWN0ZWQgZmFpbGVkIGFzc2VydGlvbnNcblxuXHQgICAgdmFyIHRlc3RQYXNzZWQgPSBkZXRhaWxzLmZhaWxlZCA+IDAgPyBkZXRhaWxzLnRvZG8gOiAhZGV0YWlscy50b2RvO1xuXG5cdCAgICBpZiAodGVzdFBhc3NlZCkge1xuXHQgICAgICAvLyBDb2xsYXBzZSB0aGUgcGFzc2luZyB0ZXN0c1xuXHQgICAgICBhZGRDbGFzcyhhc3NlcnRMaXN0LCBcInF1bml0LWNvbGxhcHNlZFwiKTtcblx0ICAgIH0gZWxzZSBpZiAoY29uZmlnLmNvbGxhcHNlKSB7XG5cdCAgICAgIGlmICghY29sbGFwc2VOZXh0KSB7XG5cdCAgICAgICAgLy8gU2tpcCBjb2xsYXBzaW5nIHRoZSBmaXJzdCBmYWlsaW5nIHRlc3Rcblx0ICAgICAgICBjb2xsYXBzZU5leHQgPSB0cnVlO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIC8vIENvbGxhcHNlIHJlbWFpbmluZyB0ZXN0c1xuXHQgICAgICAgIGFkZENsYXNzKGFzc2VydExpc3QsIFwicXVuaXQtY29sbGFwc2VkXCIpO1xuXHQgICAgICB9XG5cdCAgICB9IC8vIFRoZSB0ZXN0SXRlbS5maXJzdENoaWxkIGlzIHRoZSB0ZXN0IG5hbWVcblxuXG5cdCAgICB0ZXN0VGl0bGUgPSB0ZXN0SXRlbS5maXJzdENoaWxkO1xuXHQgICAgdGVzdENvdW50cyA9IGJhZCA/IFwiPGIgY2xhc3M9J2ZhaWxlZCc+XCIgKyBiYWQgKyBcIjwvYj4sIFwiICsgXCI8YiBjbGFzcz0ncGFzc2VkJz5cIiArIGdvb2QgKyBcIjwvYj4sIFwiIDogXCJcIjtcblx0ICAgIHRlc3RUaXRsZS5pbm5lckhUTUwgKz0gXCIgPGIgY2xhc3M9J2NvdW50cyc+KFwiICsgdGVzdENvdW50cyArIGRldGFpbHMuYXNzZXJ0aW9ucy5sZW5ndGggKyBcIik8L2I+XCI7XG5cblx0ICAgIGlmIChkZXRhaWxzLnNraXBwZWQpIHtcblx0ICAgICAgc3RhdHMuc2tpcHBlZFRlc3RzKys7XG5cdCAgICAgIHRlc3RJdGVtLmNsYXNzTmFtZSA9IFwic2tpcHBlZFwiO1xuXHQgICAgICBza2lwcGVkID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImVtXCIpO1xuXHQgICAgICBza2lwcGVkLmNsYXNzTmFtZSA9IFwicXVuaXQtc2tpcHBlZC1sYWJlbFwiO1xuXHQgICAgICBza2lwcGVkLmlubmVySFRNTCA9IFwic2tpcHBlZFwiO1xuXHQgICAgICB0ZXN0SXRlbS5pbnNlcnRCZWZvcmUoc2tpcHBlZCwgdGVzdFRpdGxlKTtcblx0ICAgIH0gZWxzZSB7XG5cdCAgICAgIGFkZEV2ZW50KHRlc3RUaXRsZSwgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdG9nZ2xlQ2xhc3MoYXNzZXJ0TGlzdCwgXCJxdW5pdC1jb2xsYXBzZWRcIik7XG5cdCAgICAgIH0pO1xuXHQgICAgICB0ZXN0SXRlbS5jbGFzc05hbWUgPSB0ZXN0UGFzc2VkID8gXCJwYXNzXCIgOiBcImZhaWxcIjtcblxuXHQgICAgICBpZiAoZGV0YWlscy50b2RvKSB7XG5cdCAgICAgICAgdmFyIHRvZG9MYWJlbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJlbVwiKTtcblx0ICAgICAgICB0b2RvTGFiZWwuY2xhc3NOYW1lID0gXCJxdW5pdC10b2RvLWxhYmVsXCI7XG5cdCAgICAgICAgdG9kb0xhYmVsLmlubmVySFRNTCA9IFwidG9kb1wiO1xuXHQgICAgICAgIHRlc3RJdGVtLmNsYXNzTmFtZSArPSBcIiB0b2RvXCI7XG5cdCAgICAgICAgdGVzdEl0ZW0uaW5zZXJ0QmVmb3JlKHRvZG9MYWJlbCwgdGVzdFRpdGxlKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIHRpbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3BhblwiKTtcblx0ICAgICAgdGltZS5jbGFzc05hbWUgPSBcInJ1bnRpbWVcIjtcblx0ICAgICAgdGltZS5pbm5lckhUTUwgPSBkZXRhaWxzLnJ1bnRpbWUgKyBcIiBtc1wiO1xuXHQgICAgICB0ZXN0SXRlbS5pbnNlcnRCZWZvcmUodGltZSwgYXNzZXJ0TGlzdCk7XG5cblx0ICAgICAgaWYgKCF0ZXN0UGFzc2VkKSB7XG5cdCAgICAgICAgc3RhdHMuZmFpbGVkVGVzdHMrKztcblx0ICAgICAgfSBlbHNlIGlmIChkZXRhaWxzLnRvZG8pIHtcblx0ICAgICAgICBzdGF0cy50b2RvVGVzdHMrKztcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBzdGF0cy5wYXNzZWRUZXN0cysrO1xuXHQgICAgICB9XG5cdCAgICB9IC8vIFNob3cgdGhlIHNvdXJjZSBvZiB0aGUgdGVzdCB3aGVuIHNob3dpbmcgYXNzZXJ0aW9uc1xuXG5cblx0ICAgIGlmIChkZXRhaWxzLnNvdXJjZSkge1xuXHQgICAgICBzb3VyY2VOYW1lID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInBcIik7XG5cdCAgICAgIHNvdXJjZU5hbWUuaW5uZXJIVE1MID0gXCI8c3Ryb25nPlNvdXJjZTogPC9zdHJvbmc+XCIgKyBlc2NhcGVUZXh0KGRldGFpbHMuc291cmNlKTtcblx0ICAgICAgYWRkQ2xhc3Moc291cmNlTmFtZSwgXCJxdW5pdC1zb3VyY2VcIik7XG5cblx0ICAgICAgaWYgKHRlc3RQYXNzZWQpIHtcblx0ICAgICAgICBhZGRDbGFzcyhzb3VyY2VOYW1lLCBcInF1bml0LWNvbGxhcHNlZFwiKTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGFkZEV2ZW50KHRlc3RUaXRsZSwgXCJjbGlja1wiLCBmdW5jdGlvbiAoKSB7XG5cdCAgICAgICAgdG9nZ2xlQ2xhc3Moc291cmNlTmFtZSwgXCJxdW5pdC1jb2xsYXBzZWRcIik7XG5cdCAgICAgIH0pO1xuXHQgICAgICB0ZXN0SXRlbS5hcHBlbmRDaGlsZChzb3VyY2VOYW1lKTtcblx0ICAgIH1cblxuXHQgICAgaWYgKGNvbmZpZy5oaWRlcGFzc2VkICYmIChzdGF0dXMgPT09IFwicGFzc2VkXCIgfHwgZGV0YWlscy5za2lwcGVkKSkge1xuXHQgICAgICAvLyB1c2UgcmVtb3ZlQ2hpbGQgaW5zdGVhZCBvZiByZW1vdmUgYmVjYXVzZSBvZiBzdXBwb3J0XG5cdCAgICAgIGhpZGRlblRlc3RzLnB1c2godGVzdEl0ZW0pO1xuXHQgICAgICB0ZXN0cy5yZW1vdmVDaGlsZCh0ZXN0SXRlbSk7XG5cdCAgICB9XG5cdCAgfSk7IC8vIEF2b2lkIHJlYWR5U3RhdGUgaXNzdWUgd2l0aCBwaGFudG9tanNcblx0ICAvLyBSZWY6ICM4MThcblxuXHQgIHZhciBub3RQaGFudG9tID0gZnVuY3Rpb24gKHApIHtcblx0ICAgIHJldHVybiAhKHAgJiYgcC52ZXJzaW9uICYmIHAudmVyc2lvbi5tYWpvciA+IDApO1xuXHQgIH0od2luZG93JDEucGhhbnRvbSk7XG5cblx0ICBpZiAobm90UGhhbnRvbSAmJiBkb2N1bWVudC5yZWFkeVN0YXRlID09PSBcImNvbXBsZXRlXCIpIHtcblx0ICAgIFFVbml0LmxvYWQoKTtcblx0ICB9IGVsc2Uge1xuXHQgICAgYWRkRXZlbnQod2luZG93JDEsIFwibG9hZFwiLCBRVW5pdC5sb2FkKTtcblx0ICB9IC8vIFdyYXAgd2luZG93Lm9uZXJyb3IuIFdlIHdpbGwgY2FsbCB0aGUgb3JpZ2luYWwgd2luZG93Lm9uZXJyb3IgdG8gc2VlIGlmXG5cdCAgLy8gdGhlIGV4aXN0aW5nIGhhbmRsZXIgZnVsbHkgaGFuZGxlcyB0aGUgZXJyb3I7IGlmIG5vdCwgd2Ugd2lsbCBjYWxsIHRoZVxuXHQgIC8vIFFVbml0Lm9uRXJyb3IgZnVuY3Rpb24uXG5cblxuXHQgIHZhciBvcmlnaW5hbFdpbmRvd09uRXJyb3IgPSB3aW5kb3ckMS5vbmVycm9yOyAvLyBDb3ZlciB1bmNhdWdodCBleGNlcHRpb25zXG5cdCAgLy8gUmV0dXJuaW5nIHRydWUgd2lsbCBzdXBwcmVzcyB0aGUgZGVmYXVsdCBicm93c2VyIGhhbmRsZXIsXG5cdCAgLy8gcmV0dXJuaW5nIGZhbHNlIHdpbGwgbGV0IGl0IHJ1bi5cblxuXHQgIHdpbmRvdyQxLm9uZXJyb3IgPSBmdW5jdGlvbiAobWVzc2FnZSwgZmlsZU5hbWUsIGxpbmVOdW1iZXIsIGNvbHVtbk51bWJlciwgZXJyb3JPYmopIHtcblx0ICAgIHZhciByZXQgPSBmYWxzZTtcblxuXHQgICAgaWYgKG9yaWdpbmFsV2luZG93T25FcnJvcikge1xuXHQgICAgICBmb3IgKHZhciBfbGVuID0gYXJndW1lbnRzLmxlbmd0aCwgYXJncyA9IG5ldyBBcnJheShfbGVuID4gNSA/IF9sZW4gLSA1IDogMCksIF9rZXkgPSA1OyBfa2V5IDwgX2xlbjsgX2tleSsrKSB7XG5cdCAgICAgICAgYXJnc1tfa2V5IC0gNV0gPSBhcmd1bWVudHNbX2tleV07XG5cdCAgICAgIH1cblxuXHQgICAgICByZXQgPSBvcmlnaW5hbFdpbmRvd09uRXJyb3IuY2FsbC5hcHBseShvcmlnaW5hbFdpbmRvd09uRXJyb3IsIFt0aGlzLCBtZXNzYWdlLCBmaWxlTmFtZSwgbGluZU51bWJlciwgY29sdW1uTnVtYmVyLCBlcnJvck9ial0uY29uY2F0KGFyZ3MpKTtcblx0ICAgIH0gLy8gVHJlYXQgcmV0dXJuIHZhbHVlIGFzIHdpbmRvdy5vbmVycm9yIGl0c2VsZiBkb2VzLFxuXHQgICAgLy8gT25seSBkbyBvdXIgaGFuZGxpbmcgaWYgbm90IHN1cHByZXNzZWQuXG5cblxuXHQgICAgaWYgKHJldCAhPT0gdHJ1ZSkge1xuXHQgICAgICB2YXIgZXJyb3IgPSB7XG5cdCAgICAgICAgbWVzc2FnZTogbWVzc2FnZSxcblx0ICAgICAgICBmaWxlTmFtZTogZmlsZU5hbWUsXG5cdCAgICAgICAgbGluZU51bWJlcjogbGluZU51bWJlclxuXHQgICAgICB9OyAvLyBBY2NvcmRpbmcgdG9cblx0ICAgICAgLy8gaHR0cHM6Ly9ibG9nLnNlbnRyeS5pby8yMDE2LzAxLzA0L2NsaWVudC1qYXZhc2NyaXB0LXJlcG9ydGluZy13aW5kb3ctb25lcnJvcixcblx0ICAgICAgLy8gbW9zdCBtb2Rlcm4gYnJvd3NlcnMgc3VwcG9ydCBhbiBlcnJvck9iaiBhcmd1bWVudDsgdXNlIHRoYXQgdG9cblx0ICAgICAgLy8gZ2V0IGEgZnVsbCBzdGFjayB0cmFjZSBpZiBpdCdzIGF2YWlsYWJsZS5cblxuXHQgICAgICBpZiAoZXJyb3JPYmogJiYgZXJyb3JPYmouc3RhY2spIHtcblx0ICAgICAgICBlcnJvci5zdGFja3RyYWNlID0gZXh0cmFjdFN0YWNrdHJhY2UoZXJyb3JPYmosIDApO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0ID0gUVVuaXQub25FcnJvcihlcnJvcik7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiByZXQ7XG5cdCAgfTsgLy8gTGlzdGVuIGZvciB1bmhhbmRsZWQgcmVqZWN0aW9ucywgYW5kIGNhbGwgUVVuaXQub25VbmhhbmRsZWRSZWplY3Rpb25cblxuXG5cdCAgd2luZG93JDEuYWRkRXZlbnRMaXN0ZW5lcihcInVuaGFuZGxlZHJlamVjdGlvblwiLCBmdW5jdGlvbiAoZXZlbnQpIHtcblx0ICAgIFFVbml0Lm9uVW5oYW5kbGVkUmVqZWN0aW9uKGV2ZW50LnJlYXNvbik7XG5cdCAgfSk7XG5cdH0pKCk7XG5cblx0Lypcblx0ICogVGhpcyBmaWxlIGlzIGEgbW9kaWZpZWQgdmVyc2lvbiBvZiBnb29nbGUtZGlmZi1tYXRjaC1wYXRjaCdzIEphdmFTY3JpcHQgaW1wbGVtZW50YXRpb25cblx0ICogKGh0dHBzOi8vY29kZS5nb29nbGUuY29tL3AvZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2gvc291cmNlL2Jyb3dzZS90cnVuay9qYXZhc2NyaXB0L2RpZmZfbWF0Y2hfcGF0Y2hfdW5jb21wcmVzc2VkLmpzKSxcblx0ICogbW9kaWZpY2F0aW9ucyBhcmUgbGljZW5zZWQgYXMgbW9yZSBmdWxseSBzZXQgZm9ydGggaW4gTElDRU5TRS50eHQuXG5cdCAqXG5cdCAqIFRoZSBvcmlnaW5hbCBzb3VyY2Ugb2YgZ29vZ2xlLWRpZmYtbWF0Y2gtcGF0Y2ggaXMgYXR0cmlidXRhYmxlIGFuZCBsaWNlbnNlZCBhcyBmb2xsb3dzOlxuXHQgKlxuXHQgKiBDb3B5cmlnaHQgMjAwNiBHb29nbGUgSW5jLlxuXHQgKiBodHRwczovL2NvZGUuZ29vZ2xlLmNvbS9wL2dvb2dsZS1kaWZmLW1hdGNoLXBhdGNoL1xuXHQgKlxuXHQgKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuXHQgKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG5cdCAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuXHQgKlxuXHQgKiBodHRwczovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG5cdCAqXG5cdCAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZywgc29mdHdhcmVcblx0ICogZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuXHQgKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cblx0ICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuXHQgKiBsaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cblx0ICpcblx0ICogTW9yZSBJbmZvOlxuXHQgKiAgaHR0cHM6Ly9jb2RlLmdvb2dsZS5jb20vcC9nb29nbGUtZGlmZi1tYXRjaC1wYXRjaC9cblx0ICpcblx0ICogVXNhZ2U6IFFVbml0LmRpZmYoZXhwZWN0ZWQsIGFjdHVhbClcblx0ICpcblx0ICovXG5cblx0UVVuaXQuZGlmZiA9IGZ1bmN0aW9uICgpIHtcblx0ICBmdW5jdGlvbiBEaWZmTWF0Y2hQYXRjaCgpIHt9IC8vICBESUZGIEZVTkNUSU9OU1xuXG5cdCAgLyoqXG5cdCAgICogVGhlIGRhdGEgc3RydWN0dXJlIHJlcHJlc2VudGluZyBhIGRpZmYgaXMgYW4gYXJyYXkgb2YgdHVwbGVzOlxuXHQgICAqIFtbRElGRl9ERUxFVEUsICdIZWxsbyddLCBbRElGRl9JTlNFUlQsICdHb29kYnllJ10sIFtESUZGX0VRVUFMLCAnIHdvcmxkLiddXVxuXHQgICAqIHdoaWNoIG1lYW5zOiBkZWxldGUgJ0hlbGxvJywgYWRkICdHb29kYnllJyBhbmQga2VlcCAnIHdvcmxkLidcblx0ICAgKi9cblxuXG5cdCAgdmFyIERJRkZfREVMRVRFID0gLTEsXG5cdCAgICAgIERJRkZfSU5TRVJUID0gMSxcblx0ICAgICAgRElGRl9FUVVBTCA9IDAsXG5cdCAgICAgIGhhc093biA9IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHk7XG5cdCAgLyoqXG5cdCAgICogRmluZCB0aGUgZGlmZmVyZW5jZXMgYmV0d2VlbiB0d28gdGV4dHMuICBTaW1wbGlmaWVzIHRoZSBwcm9ibGVtIGJ5IHN0cmlwcGluZ1xuXHQgICAqIGFueSBjb21tb24gcHJlZml4IG9yIHN1ZmZpeCBvZmYgdGhlIHRleHRzIGJlZm9yZSBkaWZmaW5nLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBPbGQgc3RyaW5nIHRvIGJlIGRpZmZlZC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgTmV3IHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtib29sZWFuPX0gb3B0Q2hlY2tsaW5lcyBPcHRpb25hbCBzcGVlZHVwIGZsYWcuIElmIHByZXNlbnQgYW5kIGZhbHNlLFxuXHQgICAqICAgICB0aGVuIGRvbid0IHJ1biBhIGxpbmUtbGV2ZWwgZGlmZiBmaXJzdCB0byBpZGVudGlmeSB0aGUgY2hhbmdlZCBhcmVhcy5cblx0ICAgKiAgICAgRGVmYXVsdHMgdG8gdHJ1ZSwgd2hpY2ggZG9lcyBhIGZhc3Rlciwgc2xpZ2h0bHkgbGVzcyBvcHRpbWFsIGRpZmYuXG5cdCAgICogQHJldHVybiB7IUFycmF5LjwhRGlmZk1hdGNoUGF0Y2guRGlmZj59IEFycmF5IG9mIGRpZmYgdHVwbGVzLlxuXHQgICAqL1xuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLkRpZmZNYWluID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0Miwgb3B0Q2hlY2tsaW5lcykge1xuXHQgICAgdmFyIGRlYWRsaW5lLCBjaGVja2xpbmVzLCBjb21tb25sZW5ndGgsIGNvbW1vbnByZWZpeCwgY29tbW9uc3VmZml4LCBkaWZmczsgLy8gVGhlIGRpZmYgbXVzdCBiZSBjb21wbGV0ZSBpbiB1cCB0byAxIHNlY29uZC5cblxuXHQgICAgZGVhZGxpbmUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKSArIDEwMDA7IC8vIENoZWNrIGZvciBudWxsIGlucHV0cy5cblxuXHQgICAgaWYgKHRleHQxID09PSBudWxsIHx8IHRleHQyID09PSBudWxsKSB7XG5cdCAgICAgIHRocm93IG5ldyBFcnJvcihcIk51bGwgaW5wdXQuIChEaWZmTWFpbilcIik7XG5cdCAgICB9IC8vIENoZWNrIGZvciBlcXVhbGl0eSAoc3BlZWR1cCkuXG5cblxuXHQgICAgaWYgKHRleHQxID09PSB0ZXh0Mikge1xuXHQgICAgICBpZiAodGV4dDEpIHtcblx0ICAgICAgICByZXR1cm4gW1tESUZGX0VRVUFMLCB0ZXh0MV1dO1xuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIFtdO1xuXHQgICAgfVxuXG5cdCAgICBpZiAodHlwZW9mIG9wdENoZWNrbGluZXMgPT09IFwidW5kZWZpbmVkXCIpIHtcblx0ICAgICAgb3B0Q2hlY2tsaW5lcyA9IHRydWU7XG5cdCAgICB9XG5cblx0ICAgIGNoZWNrbGluZXMgPSBvcHRDaGVja2xpbmVzOyAvLyBUcmltIG9mZiBjb21tb24gcHJlZml4IChzcGVlZHVwKS5cblxuXHQgICAgY29tbW9ubGVuZ3RoID0gdGhpcy5kaWZmQ29tbW9uUHJlZml4KHRleHQxLCB0ZXh0Mik7XG5cdCAgICBjb21tb25wcmVmaXggPSB0ZXh0MS5zdWJzdHJpbmcoMCwgY29tbW9ubGVuZ3RoKTtcblx0ICAgIHRleHQxID0gdGV4dDEuc3Vic3RyaW5nKGNvbW1vbmxlbmd0aCk7XG5cdCAgICB0ZXh0MiA9IHRleHQyLnN1YnN0cmluZyhjb21tb25sZW5ndGgpOyAvLyBUcmltIG9mZiBjb21tb24gc3VmZml4IChzcGVlZHVwKS5cblxuXHQgICAgY29tbW9ubGVuZ3RoID0gdGhpcy5kaWZmQ29tbW9uU3VmZml4KHRleHQxLCB0ZXh0Mik7XG5cdCAgICBjb21tb25zdWZmaXggPSB0ZXh0MS5zdWJzdHJpbmcodGV4dDEubGVuZ3RoIC0gY29tbW9ubGVuZ3RoKTtcblx0ICAgIHRleHQxID0gdGV4dDEuc3Vic3RyaW5nKDAsIHRleHQxLmxlbmd0aCAtIGNvbW1vbmxlbmd0aCk7XG5cdCAgICB0ZXh0MiA9IHRleHQyLnN1YnN0cmluZygwLCB0ZXh0Mi5sZW5ndGggLSBjb21tb25sZW5ndGgpOyAvLyBDb21wdXRlIHRoZSBkaWZmIG9uIHRoZSBtaWRkbGUgYmxvY2suXG5cblx0ICAgIGRpZmZzID0gdGhpcy5kaWZmQ29tcHV0ZSh0ZXh0MSwgdGV4dDIsIGNoZWNrbGluZXMsIGRlYWRsaW5lKTsgLy8gUmVzdG9yZSB0aGUgcHJlZml4IGFuZCBzdWZmaXguXG5cblx0ICAgIGlmIChjb21tb25wcmVmaXgpIHtcblx0ICAgICAgZGlmZnMudW5zaGlmdChbRElGRl9FUVVBTCwgY29tbW9ucHJlZml4XSk7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjb21tb25zdWZmaXgpIHtcblx0ICAgICAgZGlmZnMucHVzaChbRElGRl9FUVVBTCwgY29tbW9uc3VmZml4XSk7XG5cdCAgICB9XG5cblx0ICAgIHRoaXMuZGlmZkNsZWFudXBNZXJnZShkaWZmcyk7XG5cdCAgICByZXR1cm4gZGlmZnM7XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBSZWR1Y2UgdGhlIG51bWJlciBvZiBlZGl0cyBieSBlbGltaW5hdGluZyBvcGVyYXRpb25hbGx5IHRyaXZpYWwgZXF1YWxpdGllcy5cblx0ICAgKiBAcGFyYW0geyFBcnJheS48IURpZmZNYXRjaFBhdGNoLkRpZmY+fSBkaWZmcyBBcnJheSBvZiBkaWZmIHR1cGxlcy5cblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDbGVhbnVwRWZmaWNpZW5jeSA9IGZ1bmN0aW9uIChkaWZmcykge1xuXHQgICAgdmFyIGNoYW5nZXMsIGVxdWFsaXRpZXMsIGVxdWFsaXRpZXNMZW5ndGgsIGxhc3RlcXVhbGl0eSwgcG9pbnRlciwgcHJlSW5zLCBwcmVEZWwsIHBvc3RJbnMsIHBvc3REZWw7XG5cdCAgICBjaGFuZ2VzID0gZmFsc2U7XG5cdCAgICBlcXVhbGl0aWVzID0gW107IC8vIFN0YWNrIG9mIGluZGljZXMgd2hlcmUgZXF1YWxpdGllcyBhcmUgZm91bmQuXG5cblx0ICAgIGVxdWFsaXRpZXNMZW5ndGggPSAwOyAvLyBLZWVwaW5nIG91ciBvd24gbGVuZ3RoIHZhciBpcyBmYXN0ZXIgaW4gSlMuXG5cblx0ICAgIC8qKiBAdHlwZSB7P3N0cmluZ30gKi9cblxuXHQgICAgbGFzdGVxdWFsaXR5ID0gbnVsbDsgLy8gQWx3YXlzIGVxdWFsIHRvIGRpZmZzW2VxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdXVsxXVxuXG5cdCAgICBwb2ludGVyID0gMDsgLy8gSW5kZXggb2YgY3VycmVudCBwb3NpdGlvbi5cblx0ICAgIC8vIElzIHRoZXJlIGFuIGluc2VydGlvbiBvcGVyYXRpb24gYmVmb3JlIHRoZSBsYXN0IGVxdWFsaXR5LlxuXG5cdCAgICBwcmVJbnMgPSBmYWxzZTsgLy8gSXMgdGhlcmUgYSBkZWxldGlvbiBvcGVyYXRpb24gYmVmb3JlIHRoZSBsYXN0IGVxdWFsaXR5LlxuXG5cdCAgICBwcmVEZWwgPSBmYWxzZTsgLy8gSXMgdGhlcmUgYW4gaW5zZXJ0aW9uIG9wZXJhdGlvbiBhZnRlciB0aGUgbGFzdCBlcXVhbGl0eS5cblxuXHQgICAgcG9zdElucyA9IGZhbHNlOyAvLyBJcyB0aGVyZSBhIGRlbGV0aW9uIG9wZXJhdGlvbiBhZnRlciB0aGUgbGFzdCBlcXVhbGl0eS5cblxuXHQgICAgcG9zdERlbCA9IGZhbHNlO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuXHQgICAgICAvLyBFcXVhbGl0eSBmb3VuZC5cblx0ICAgICAgaWYgKGRpZmZzW3BvaW50ZXJdWzBdID09PSBESUZGX0VRVUFMKSB7XG5cdCAgICAgICAgaWYgKGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aCA8IDQgJiYgKHBvc3RJbnMgfHwgcG9zdERlbCkpIHtcblx0ICAgICAgICAgIC8vIENhbmRpZGF0ZSBmb3VuZC5cblx0ICAgICAgICAgIGVxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCsrXSA9IHBvaW50ZXI7XG5cdCAgICAgICAgICBwcmVJbnMgPSBwb3N0SW5zO1xuXHQgICAgICAgICAgcHJlRGVsID0gcG9zdERlbDtcblx0ICAgICAgICAgIGxhc3RlcXVhbGl0eSA9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAvLyBOb3QgYSBjYW5kaWRhdGUsIGFuZCBjYW4gbmV2ZXIgYmVjb21lIG9uZS5cblx0ICAgICAgICAgIGVxdWFsaXRpZXNMZW5ndGggPSAwO1xuXHQgICAgICAgICAgbGFzdGVxdWFsaXR5ID0gbnVsbDtcblx0ICAgICAgICB9XG5cblx0ICAgICAgICBwb3N0SW5zID0gcG9zdERlbCA9IGZhbHNlOyAvLyBBbiBpbnNlcnRpb24gb3IgZGVsZXRpb24uXG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgaWYgKGRpZmZzW3BvaW50ZXJdWzBdID09PSBESUZGX0RFTEVURSkge1xuXHQgICAgICAgICAgcG9zdERlbCA9IHRydWU7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHBvc3RJbnMgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgICAvKlxuXHQgICAgICAgICAqIEZpdmUgdHlwZXMgdG8gYmUgc3BsaXQ6XG5cdCAgICAgICAgICogPGlucz5BPC9pbnM+PGRlbD5CPC9kZWw+WFk8aW5zPkM8L2lucz48ZGVsPkQ8L2RlbD5cblx0ICAgICAgICAgKiA8aW5zPkE8L2lucz5YPGlucz5DPC9pbnM+PGRlbD5EPC9kZWw+XG5cdCAgICAgICAgICogPGlucz5BPC9pbnM+PGRlbD5CPC9kZWw+WDxpbnM+QzwvaW5zPlxuXHQgICAgICAgICAqIDxpbnM+QTwvZGVsPlg8aW5zPkM8L2lucz48ZGVsPkQ8L2RlbD5cblx0ICAgICAgICAgKiA8aW5zPkE8L2lucz48ZGVsPkI8L2RlbD5YPGRlbD5DPC9kZWw+XG5cdCAgICAgICAgICovXG5cblxuXHQgICAgICAgIGlmIChsYXN0ZXF1YWxpdHkgJiYgKHByZUlucyAmJiBwcmVEZWwgJiYgcG9zdElucyAmJiBwb3N0RGVsIHx8IGxhc3RlcXVhbGl0eS5sZW5ndGggPCAyICYmIHByZUlucyArIHByZURlbCArIHBvc3RJbnMgKyBwb3N0RGVsID09PSAzKSkge1xuXHQgICAgICAgICAgLy8gRHVwbGljYXRlIHJlY29yZC5cblx0ICAgICAgICAgIGRpZmZzLnNwbGljZShlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSwgMCwgW0RJRkZfREVMRVRFLCBsYXN0ZXF1YWxpdHldKTsgLy8gQ2hhbmdlIHNlY29uZCBjb3B5IHRvIGluc2VydC5cblxuXHQgICAgICAgICAgZGlmZnNbZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoIC0gMV0gKyAxXVswXSA9IERJRkZfSU5TRVJUO1xuXHQgICAgICAgICAgZXF1YWxpdGllc0xlbmd0aC0tOyAvLyBUaHJvdyBhd2F5IHRoZSBlcXVhbGl0eSB3ZSBqdXN0IGRlbGV0ZWQ7XG5cblx0ICAgICAgICAgIGxhc3RlcXVhbGl0eSA9IG51bGw7XG5cblx0ICAgICAgICAgIGlmIChwcmVJbnMgJiYgcHJlRGVsKSB7XG5cdCAgICAgICAgICAgIC8vIE5vIGNoYW5nZXMgbWFkZSB3aGljaCBjb3VsZCBhZmZlY3QgcHJldmlvdXMgZW50cnksIGtlZXAgZ29pbmcuXG5cdCAgICAgICAgICAgIHBvc3RJbnMgPSBwb3N0RGVsID0gdHJ1ZTtcblx0ICAgICAgICAgICAgZXF1YWxpdGllc0xlbmd0aCA9IDA7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBlcXVhbGl0aWVzTGVuZ3RoLS07IC8vIFRocm93IGF3YXkgdGhlIHByZXZpb3VzIGVxdWFsaXR5LlxuXG5cdCAgICAgICAgICAgIHBvaW50ZXIgPSBlcXVhbGl0aWVzTGVuZ3RoID4gMCA/IGVxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdIDogLTE7XG5cdCAgICAgICAgICAgIHBvc3RJbnMgPSBwb3N0RGVsID0gZmFsc2U7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXIrKztcblx0ICAgIH1cblxuXHQgICAgaWYgKGNoYW5nZXMpIHtcblx0ICAgICAgdGhpcy5kaWZmQ2xlYW51cE1lcmdlKGRpZmZzKTtcblx0ICAgIH1cblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIENvbnZlcnQgYSBkaWZmIGFycmF5IGludG8gYSBwcmV0dHkgSFRNTCByZXBvcnQuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gZGlmZnMgQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHBhcmFtIHtpbnRlZ2VyfSBzdHJpbmcgdG8gYmUgYmVhdXRpZmllZC5cblx0ICAgKiBAcmV0dXJuIHtzdHJpbmd9IEhUTUwgcmVwcmVzZW50YXRpb24uXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmUHJldHR5SHRtbCA9IGZ1bmN0aW9uIChkaWZmcykge1xuXHQgICAgdmFyIG9wLFxuXHQgICAgICAgIGRhdGEsXG5cdCAgICAgICAgeCxcblx0ICAgICAgICBodG1sID0gW107XG5cblx0ICAgIGZvciAoeCA9IDA7IHggPCBkaWZmcy5sZW5ndGg7IHgrKykge1xuXHQgICAgICBvcCA9IGRpZmZzW3hdWzBdOyAvLyBPcGVyYXRpb24gKGluc2VydCwgZGVsZXRlLCBlcXVhbClcblxuXHQgICAgICBkYXRhID0gZGlmZnNbeF1bMV07IC8vIFRleHQgb2YgY2hhbmdlLlxuXG5cdCAgICAgIHN3aXRjaCAob3ApIHtcblx0ICAgICAgICBjYXNlIERJRkZfSU5TRVJUOlxuXHQgICAgICAgICAgaHRtbFt4XSA9IFwiPGlucz5cIiArIGVzY2FwZVRleHQoZGF0YSkgKyBcIjwvaW5zPlwiO1xuXHQgICAgICAgICAgYnJlYWs7XG5cblx0ICAgICAgICBjYXNlIERJRkZfREVMRVRFOlxuXHQgICAgICAgICAgaHRtbFt4XSA9IFwiPGRlbD5cIiArIGVzY2FwZVRleHQoZGF0YSkgKyBcIjwvZGVsPlwiO1xuXHQgICAgICAgICAgYnJlYWs7XG5cblx0ICAgICAgICBjYXNlIERJRkZfRVFVQUw6XG5cdCAgICAgICAgICBodG1sW3hdID0gXCI8c3Bhbj5cIiArIGVzY2FwZVRleHQoZGF0YSkgKyBcIjwvc3Bhbj5cIjtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICB9XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBodG1sLmpvaW4oXCJcIik7XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBEZXRlcm1pbmUgdGhlIGNvbW1vbiBwcmVmaXggb2YgdHdvIHN0cmluZ3MuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIEZpcnN0IHN0cmluZy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgU2Vjb25kIHN0cmluZy5cblx0ICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBjb21tb24gdG8gdGhlIHN0YXJ0IG9mIGVhY2hcblx0ICAgKiAgICAgc3RyaW5nLlxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkNvbW1vblByZWZpeCA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIpIHtcblx0ICAgIHZhciBwb2ludGVybWlkLCBwb2ludGVybWF4LCBwb2ludGVybWluLCBwb2ludGVyc3RhcnQ7IC8vIFF1aWNrIGNoZWNrIGZvciBjb21tb24gbnVsbCBjYXNlcy5cblxuXHQgICAgaWYgKCF0ZXh0MSB8fCAhdGV4dDIgfHwgdGV4dDEuY2hhckF0KDApICE9PSB0ZXh0Mi5jaGFyQXQoMCkpIHtcblx0ICAgICAgcmV0dXJuIDA7XG5cdCAgICB9IC8vIEJpbmFyeSBzZWFyY2guXG5cdCAgICAvLyBQZXJmb3JtYW5jZSBhbmFseXNpczogaHR0cHM6Ly9uZWlsLmZyYXNlci5uYW1lL25ld3MvMjAwNy8xMC8wOS9cblxuXG5cdCAgICBwb2ludGVybWluID0gMDtcblx0ICAgIHBvaW50ZXJtYXggPSBNYXRoLm1pbih0ZXh0MS5sZW5ndGgsIHRleHQyLmxlbmd0aCk7XG5cdCAgICBwb2ludGVybWlkID0gcG9pbnRlcm1heDtcblx0ICAgIHBvaW50ZXJzdGFydCA9IDA7XG5cblx0ICAgIHdoaWxlIChwb2ludGVybWluIDwgcG9pbnRlcm1pZCkge1xuXHQgICAgICBpZiAodGV4dDEuc3Vic3RyaW5nKHBvaW50ZXJzdGFydCwgcG9pbnRlcm1pZCkgPT09IHRleHQyLnN1YnN0cmluZyhwb2ludGVyc3RhcnQsIHBvaW50ZXJtaWQpKSB7XG5cdCAgICAgICAgcG9pbnRlcm1pbiA9IHBvaW50ZXJtaWQ7XG5cdCAgICAgICAgcG9pbnRlcnN0YXJ0ID0gcG9pbnRlcm1pbjtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICBwb2ludGVybWF4ID0gcG9pbnRlcm1pZDtcblx0ICAgICAgfVxuXG5cdCAgICAgIHBvaW50ZXJtaWQgPSBNYXRoLmZsb29yKChwb2ludGVybWF4IC0gcG9pbnRlcm1pbikgLyAyICsgcG9pbnRlcm1pbik7XG5cdCAgICB9XG5cblx0ICAgIHJldHVybiBwb2ludGVybWlkO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRGV0ZXJtaW5lIHRoZSBjb21tb24gc3VmZml4IG9mIHR3byBzdHJpbmdzLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIFNlY29uZCBzdHJpbmcuXG5cdCAgICogQHJldHVybiB7bnVtYmVyfSBUaGUgbnVtYmVyIG9mIGNoYXJhY3RlcnMgY29tbW9uIHRvIHRoZSBlbmQgb2YgZWFjaCBzdHJpbmcuXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ29tbW9uU3VmZml4ID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0Mikge1xuXHQgICAgdmFyIHBvaW50ZXJtaWQsIHBvaW50ZXJtYXgsIHBvaW50ZXJtaW4sIHBvaW50ZXJlbmQ7IC8vIFF1aWNrIGNoZWNrIGZvciBjb21tb24gbnVsbCBjYXNlcy5cblxuXHQgICAgaWYgKCF0ZXh0MSB8fCAhdGV4dDIgfHwgdGV4dDEuY2hhckF0KHRleHQxLmxlbmd0aCAtIDEpICE9PSB0ZXh0Mi5jaGFyQXQodGV4dDIubGVuZ3RoIC0gMSkpIHtcblx0ICAgICAgcmV0dXJuIDA7XG5cdCAgICB9IC8vIEJpbmFyeSBzZWFyY2guXG5cdCAgICAvLyBQZXJmb3JtYW5jZSBhbmFseXNpczogaHR0cHM6Ly9uZWlsLmZyYXNlci5uYW1lL25ld3MvMjAwNy8xMC8wOS9cblxuXG5cdCAgICBwb2ludGVybWluID0gMDtcblx0ICAgIHBvaW50ZXJtYXggPSBNYXRoLm1pbih0ZXh0MS5sZW5ndGgsIHRleHQyLmxlbmd0aCk7XG5cdCAgICBwb2ludGVybWlkID0gcG9pbnRlcm1heDtcblx0ICAgIHBvaW50ZXJlbmQgPSAwO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlcm1pbiA8IHBvaW50ZXJtaWQpIHtcblx0ICAgICAgaWYgKHRleHQxLnN1YnN0cmluZyh0ZXh0MS5sZW5ndGggLSBwb2ludGVybWlkLCB0ZXh0MS5sZW5ndGggLSBwb2ludGVyZW5kKSA9PT0gdGV4dDIuc3Vic3RyaW5nKHRleHQyLmxlbmd0aCAtIHBvaW50ZXJtaWQsIHRleHQyLmxlbmd0aCAtIHBvaW50ZXJlbmQpKSB7XG5cdCAgICAgICAgcG9pbnRlcm1pbiA9IHBvaW50ZXJtaWQ7XG5cdCAgICAgICAgcG9pbnRlcmVuZCA9IHBvaW50ZXJtaW47XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcG9pbnRlcm1heCA9IHBvaW50ZXJtaWQ7XG5cdCAgICAgIH1cblxuXHQgICAgICBwb2ludGVybWlkID0gTWF0aC5mbG9vcigocG9pbnRlcm1heCAtIHBvaW50ZXJtaW4pIC8gMiArIHBvaW50ZXJtaW4pO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gcG9pbnRlcm1pZDtcblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIEZpbmQgdGhlIGRpZmZlcmVuY2VzIGJldHdlZW4gdHdvIHRleHRzLiAgQXNzdW1lcyB0aGF0IHRoZSB0ZXh0cyBkbyBub3Rcblx0ICAgKiBoYXZlIGFueSBjb21tb24gcHJlZml4IG9yIHN1ZmZpeC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgT2xkIHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIE5ldyBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7Ym9vbGVhbn0gY2hlY2tsaW5lcyBTcGVlZHVwIGZsYWcuICBJZiBmYWxzZSwgdGhlbiBkb24ndCBydW4gYVxuXHQgICAqICAgICBsaW5lLWxldmVsIGRpZmYgZmlyc3QgdG8gaWRlbnRpZnkgdGhlIGNoYW5nZWQgYXJlYXMuXG5cdCAgICogICAgIElmIHRydWUsIHRoZW4gcnVuIGEgZmFzdGVyLCBzbGlnaHRseSBsZXNzIG9wdGltYWwgZGlmZi5cblx0ICAgKiBAcGFyYW0ge251bWJlcn0gZGVhZGxpbmUgVGltZSB3aGVuIHRoZSBkaWZmIHNob3VsZCBiZSBjb21wbGV0ZSBieS5cblx0ICAgKiBAcmV0dXJuIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDb21wdXRlID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0MiwgY2hlY2tsaW5lcywgZGVhZGxpbmUpIHtcblx0ICAgIHZhciBkaWZmcywgbG9uZ3RleHQsIHNob3J0dGV4dCwgaSwgaG0sIHRleHQxQSwgdGV4dDJBLCB0ZXh0MUIsIHRleHQyQiwgbWlkQ29tbW9uLCBkaWZmc0EsIGRpZmZzQjtcblxuXHQgICAgaWYgKCF0ZXh0MSkge1xuXHQgICAgICAvLyBKdXN0IGFkZCBzb21lIHRleHQgKHNwZWVkdXApLlxuXHQgICAgICByZXR1cm4gW1tESUZGX0lOU0VSVCwgdGV4dDJdXTtcblx0ICAgIH1cblxuXHQgICAgaWYgKCF0ZXh0Mikge1xuXHQgICAgICAvLyBKdXN0IGRlbGV0ZSBzb21lIHRleHQgKHNwZWVkdXApLlxuXHQgICAgICByZXR1cm4gW1tESUZGX0RFTEVURSwgdGV4dDFdXTtcblx0ICAgIH1cblxuXHQgICAgbG9uZ3RleHQgPSB0ZXh0MS5sZW5ndGggPiB0ZXh0Mi5sZW5ndGggPyB0ZXh0MSA6IHRleHQyO1xuXHQgICAgc2hvcnR0ZXh0ID0gdGV4dDEubGVuZ3RoID4gdGV4dDIubGVuZ3RoID8gdGV4dDIgOiB0ZXh0MTtcblx0ICAgIGkgPSBsb25ndGV4dC5pbmRleE9mKHNob3J0dGV4dCk7XG5cblx0ICAgIGlmIChpICE9PSAtMSkge1xuXHQgICAgICAvLyBTaG9ydGVyIHRleHQgaXMgaW5zaWRlIHRoZSBsb25nZXIgdGV4dCAoc3BlZWR1cCkuXG5cdCAgICAgIGRpZmZzID0gW1tESUZGX0lOU0VSVCwgbG9uZ3RleHQuc3Vic3RyaW5nKDAsIGkpXSwgW0RJRkZfRVFVQUwsIHNob3J0dGV4dF0sIFtESUZGX0lOU0VSVCwgbG9uZ3RleHQuc3Vic3RyaW5nKGkgKyBzaG9ydHRleHQubGVuZ3RoKV1dOyAvLyBTd2FwIGluc2VydGlvbnMgZm9yIGRlbGV0aW9ucyBpZiBkaWZmIGlzIHJldmVyc2VkLlxuXG5cdCAgICAgIGlmICh0ZXh0MS5sZW5ndGggPiB0ZXh0Mi5sZW5ndGgpIHtcblx0ICAgICAgICBkaWZmc1swXVswXSA9IGRpZmZzWzJdWzBdID0gRElGRl9ERUxFVEU7XG5cdCAgICAgIH1cblxuXHQgICAgICByZXR1cm4gZGlmZnM7XG5cdCAgICB9XG5cblx0ICAgIGlmIChzaG9ydHRleHQubGVuZ3RoID09PSAxKSB7XG5cdCAgICAgIC8vIFNpbmdsZSBjaGFyYWN0ZXIgc3RyaW5nLlxuXHQgICAgICAvLyBBZnRlciB0aGUgcHJldmlvdXMgc3BlZWR1cCwgdGhlIGNoYXJhY3RlciBjYW4ndCBiZSBhbiBlcXVhbGl0eS5cblx0ICAgICAgcmV0dXJuIFtbRElGRl9ERUxFVEUsIHRleHQxXSwgW0RJRkZfSU5TRVJULCB0ZXh0Ml1dO1xuXHQgICAgfSAvLyBDaGVjayB0byBzZWUgaWYgdGhlIHByb2JsZW0gY2FuIGJlIHNwbGl0IGluIHR3by5cblxuXG5cdCAgICBobSA9IHRoaXMuZGlmZkhhbGZNYXRjaCh0ZXh0MSwgdGV4dDIpO1xuXG5cdCAgICBpZiAoaG0pIHtcblx0ICAgICAgLy8gQSBoYWxmLW1hdGNoIHdhcyBmb3VuZCwgc29ydCBvdXQgdGhlIHJldHVybiBkYXRhLlxuXHQgICAgICB0ZXh0MUEgPSBobVswXTtcblx0ICAgICAgdGV4dDFCID0gaG1bMV07XG5cdCAgICAgIHRleHQyQSA9IGhtWzJdO1xuXHQgICAgICB0ZXh0MkIgPSBobVszXTtcblx0ICAgICAgbWlkQ29tbW9uID0gaG1bNF07IC8vIFNlbmQgYm90aCBwYWlycyBvZmYgZm9yIHNlcGFyYXRlIHByb2Nlc3NpbmcuXG5cblx0ICAgICAgZGlmZnNBID0gdGhpcy5EaWZmTWFpbih0ZXh0MUEsIHRleHQyQSwgY2hlY2tsaW5lcywgZGVhZGxpbmUpO1xuXHQgICAgICBkaWZmc0IgPSB0aGlzLkRpZmZNYWluKHRleHQxQiwgdGV4dDJCLCBjaGVja2xpbmVzLCBkZWFkbGluZSk7IC8vIE1lcmdlIHRoZSByZXN1bHRzLlxuXG5cdCAgICAgIHJldHVybiBkaWZmc0EuY29uY2F0KFtbRElGRl9FUVVBTCwgbWlkQ29tbW9uXV0sIGRpZmZzQik7XG5cdCAgICB9XG5cblx0ICAgIGlmIChjaGVja2xpbmVzICYmIHRleHQxLmxlbmd0aCA+IDEwMCAmJiB0ZXh0Mi5sZW5ndGggPiAxMDApIHtcblx0ICAgICAgcmV0dXJuIHRoaXMuZGlmZkxpbmVNb2RlKHRleHQxLCB0ZXh0MiwgZGVhZGxpbmUpO1xuXHQgICAgfVxuXG5cdCAgICByZXR1cm4gdGhpcy5kaWZmQmlzZWN0KHRleHQxLCB0ZXh0MiwgZGVhZGxpbmUpO1xuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRG8gdGhlIHR3byB0ZXh0cyBzaGFyZSBhIHN1YnN0cmluZyB3aGljaCBpcyBhdCBsZWFzdCBoYWxmIHRoZSBsZW5ndGggb2YgdGhlXG5cdCAgICogbG9uZ2VyIHRleHQ/XG5cdCAgICogVGhpcyBzcGVlZHVwIGNhbiBwcm9kdWNlIG5vbi1taW5pbWFsIGRpZmZzLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBGaXJzdCBzdHJpbmcuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIFNlY29uZCBzdHJpbmcuXG5cdCAgICogQHJldHVybiB7QXJyYXkuPHN0cmluZz59IEZpdmUgZWxlbWVudCBBcnJheSwgY29udGFpbmluZyB0aGUgcHJlZml4IG9mXG5cdCAgICogICAgIHRleHQxLCB0aGUgc3VmZml4IG9mIHRleHQxLCB0aGUgcHJlZml4IG9mIHRleHQyLCB0aGUgc3VmZml4IG9mXG5cdCAgICogICAgIHRleHQyIGFuZCB0aGUgY29tbW9uIG1pZGRsZS4gIE9yIG51bGwgaWYgdGhlcmUgd2FzIG5vIG1hdGNoLlxuXHQgICAqIEBwcml2YXRlXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmSGFsZk1hdGNoID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0Mikge1xuXHQgICAgdmFyIGxvbmd0ZXh0LCBzaG9ydHRleHQsIGRtcCwgdGV4dDFBLCB0ZXh0MkIsIHRleHQyQSwgdGV4dDFCLCBtaWRDb21tb24sIGhtMSwgaG0yLCBobTtcblx0ICAgIGxvbmd0ZXh0ID0gdGV4dDEubGVuZ3RoID4gdGV4dDIubGVuZ3RoID8gdGV4dDEgOiB0ZXh0Mjtcblx0ICAgIHNob3J0dGV4dCA9IHRleHQxLmxlbmd0aCA+IHRleHQyLmxlbmd0aCA/IHRleHQyIDogdGV4dDE7XG5cblx0ICAgIGlmIChsb25ndGV4dC5sZW5ndGggPCA0IHx8IHNob3J0dGV4dC5sZW5ndGggKiAyIDwgbG9uZ3RleHQubGVuZ3RoKSB7XG5cdCAgICAgIHJldHVybiBudWxsOyAvLyBQb2ludGxlc3MuXG5cdCAgICB9XG5cblx0ICAgIGRtcCA9IHRoaXM7IC8vICd0aGlzJyBiZWNvbWVzICd3aW5kb3cnIGluIGEgY2xvc3VyZS5cblxuXHQgICAgLyoqXG5cdCAgICAgKiBEb2VzIGEgc3Vic3RyaW5nIG9mIHNob3J0dGV4dCBleGlzdCB3aXRoaW4gbG9uZ3RleHQgc3VjaCB0aGF0IHRoZSBzdWJzdHJpbmdcblx0ICAgICAqIGlzIGF0IGxlYXN0IGhhbGYgdGhlIGxlbmd0aCBvZiBsb25ndGV4dD9cblx0ICAgICAqIENsb3N1cmUsIGJ1dCBkb2VzIG5vdCByZWZlcmVuY2UgYW55IGV4dGVybmFsIHZhcmlhYmxlcy5cblx0ICAgICAqIEBwYXJhbSB7c3RyaW5nfSBsb25ndGV4dCBMb25nZXIgc3RyaW5nLlxuXHQgICAgICogQHBhcmFtIHtzdHJpbmd9IHNob3J0dGV4dCBTaG9ydGVyIHN0cmluZy5cblx0ICAgICAqIEBwYXJhbSB7bnVtYmVyfSBpIFN0YXJ0IGluZGV4IG9mIHF1YXJ0ZXIgbGVuZ3RoIHN1YnN0cmluZyB3aXRoaW4gbG9uZ3RleHQuXG5cdCAgICAgKiBAcmV0dXJuIHtBcnJheS48c3RyaW5nPn0gRml2ZSBlbGVtZW50IEFycmF5LCBjb250YWluaW5nIHRoZSBwcmVmaXggb2Zcblx0ICAgICAqICAgICBsb25ndGV4dCwgdGhlIHN1ZmZpeCBvZiBsb25ndGV4dCwgdGhlIHByZWZpeCBvZiBzaG9ydHRleHQsIHRoZSBzdWZmaXhcblx0ICAgICAqICAgICBvZiBzaG9ydHRleHQgYW5kIHRoZSBjb21tb24gbWlkZGxlLiAgT3IgbnVsbCBpZiB0aGVyZSB3YXMgbm8gbWF0Y2guXG5cdCAgICAgKiBAcHJpdmF0ZVxuXHQgICAgICovXG5cblx0ICAgIGZ1bmN0aW9uIGRpZmZIYWxmTWF0Y2hJKGxvbmd0ZXh0LCBzaG9ydHRleHQsIGkpIHtcblx0ICAgICAgdmFyIHNlZWQsIGosIGJlc3RDb21tb24sIHByZWZpeExlbmd0aCwgc3VmZml4TGVuZ3RoLCBiZXN0TG9uZ3RleHRBLCBiZXN0TG9uZ3RleHRCLCBiZXN0U2hvcnR0ZXh0QSwgYmVzdFNob3J0dGV4dEI7IC8vIFN0YXJ0IHdpdGggYSAxLzQgbGVuZ3RoIHN1YnN0cmluZyBhdCBwb3NpdGlvbiBpIGFzIGEgc2VlZC5cblxuXHQgICAgICBzZWVkID0gbG9uZ3RleHQuc3Vic3RyaW5nKGksIGkgKyBNYXRoLmZsb29yKGxvbmd0ZXh0Lmxlbmd0aCAvIDQpKTtcblx0ICAgICAgaiA9IC0xO1xuXHQgICAgICBiZXN0Q29tbW9uID0gXCJcIjtcblxuXHQgICAgICB3aGlsZSAoKGogPSBzaG9ydHRleHQuaW5kZXhPZihzZWVkLCBqICsgMSkpICE9PSAtMSkge1xuXHQgICAgICAgIHByZWZpeExlbmd0aCA9IGRtcC5kaWZmQ29tbW9uUHJlZml4KGxvbmd0ZXh0LnN1YnN0cmluZyhpKSwgc2hvcnR0ZXh0LnN1YnN0cmluZyhqKSk7XG5cdCAgICAgICAgc3VmZml4TGVuZ3RoID0gZG1wLmRpZmZDb21tb25TdWZmaXgobG9uZ3RleHQuc3Vic3RyaW5nKDAsIGkpLCBzaG9ydHRleHQuc3Vic3RyaW5nKDAsIGopKTtcblxuXHQgICAgICAgIGlmIChiZXN0Q29tbW9uLmxlbmd0aCA8IHN1ZmZpeExlbmd0aCArIHByZWZpeExlbmd0aCkge1xuXHQgICAgICAgICAgYmVzdENvbW1vbiA9IHNob3J0dGV4dC5zdWJzdHJpbmcoaiAtIHN1ZmZpeExlbmd0aCwgaikgKyBzaG9ydHRleHQuc3Vic3RyaW5nKGosIGogKyBwcmVmaXhMZW5ndGgpO1xuXHQgICAgICAgICAgYmVzdExvbmd0ZXh0QSA9IGxvbmd0ZXh0LnN1YnN0cmluZygwLCBpIC0gc3VmZml4TGVuZ3RoKTtcblx0ICAgICAgICAgIGJlc3RMb25ndGV4dEIgPSBsb25ndGV4dC5zdWJzdHJpbmcoaSArIHByZWZpeExlbmd0aCk7XG5cdCAgICAgICAgICBiZXN0U2hvcnR0ZXh0QSA9IHNob3J0dGV4dC5zdWJzdHJpbmcoMCwgaiAtIHN1ZmZpeExlbmd0aCk7XG5cdCAgICAgICAgICBiZXN0U2hvcnR0ZXh0QiA9IHNob3J0dGV4dC5zdWJzdHJpbmcoaiArIHByZWZpeExlbmd0aCk7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgaWYgKGJlc3RDb21tb24ubGVuZ3RoICogMiA+PSBsb25ndGV4dC5sZW5ndGgpIHtcblx0ICAgICAgICByZXR1cm4gW2Jlc3RMb25ndGV4dEEsIGJlc3RMb25ndGV4dEIsIGJlc3RTaG9ydHRleHRBLCBiZXN0U2hvcnR0ZXh0QiwgYmVzdENvbW1vbl07XG5cdCAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICAgIH1cblx0ICAgIH0gLy8gRmlyc3QgY2hlY2sgaWYgdGhlIHNlY29uZCBxdWFydGVyIGlzIHRoZSBzZWVkIGZvciBhIGhhbGYtbWF0Y2guXG5cblxuXHQgICAgaG0xID0gZGlmZkhhbGZNYXRjaEkobG9uZ3RleHQsIHNob3J0dGV4dCwgTWF0aC5jZWlsKGxvbmd0ZXh0Lmxlbmd0aCAvIDQpKTsgLy8gQ2hlY2sgYWdhaW4gYmFzZWQgb24gdGhlIHRoaXJkIHF1YXJ0ZXIuXG5cblx0ICAgIGhtMiA9IGRpZmZIYWxmTWF0Y2hJKGxvbmd0ZXh0LCBzaG9ydHRleHQsIE1hdGguY2VpbChsb25ndGV4dC5sZW5ndGggLyAyKSk7XG5cblx0ICAgIGlmICghaG0xICYmICFobTIpIHtcblx0ICAgICAgcmV0dXJuIG51bGw7XG5cdCAgICB9IGVsc2UgaWYgKCFobTIpIHtcblx0ICAgICAgaG0gPSBobTE7XG5cdCAgICB9IGVsc2UgaWYgKCFobTEpIHtcblx0ICAgICAgaG0gPSBobTI7XG5cdCAgICB9IGVsc2Uge1xuXHQgICAgICAvLyBCb3RoIG1hdGNoZWQuICBTZWxlY3QgdGhlIGxvbmdlc3QuXG5cdCAgICAgIGhtID0gaG0xWzRdLmxlbmd0aCA+IGhtMls0XS5sZW5ndGggPyBobTEgOiBobTI7XG5cdCAgICB9IC8vIEEgaGFsZi1tYXRjaCB3YXMgZm91bmQsIHNvcnQgb3V0IHRoZSByZXR1cm4gZGF0YS5cblxuXG5cdCAgICBpZiAodGV4dDEubGVuZ3RoID4gdGV4dDIubGVuZ3RoKSB7XG5cdCAgICAgIHRleHQxQSA9IGhtWzBdO1xuXHQgICAgICB0ZXh0MUIgPSBobVsxXTtcblx0ICAgICAgdGV4dDJBID0gaG1bMl07XG5cdCAgICAgIHRleHQyQiA9IGhtWzNdO1xuXHQgICAgfSBlbHNlIHtcblx0ICAgICAgdGV4dDJBID0gaG1bMF07XG5cdCAgICAgIHRleHQyQiA9IGhtWzFdO1xuXHQgICAgICB0ZXh0MUEgPSBobVsyXTtcblx0ICAgICAgdGV4dDFCID0gaG1bM107XG5cdCAgICB9XG5cblx0ICAgIG1pZENvbW1vbiA9IGhtWzRdO1xuXHQgICAgcmV0dXJuIFt0ZXh0MUEsIHRleHQxQiwgdGV4dDJBLCB0ZXh0MkIsIG1pZENvbW1vbl07XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBEbyBhIHF1aWNrIGxpbmUtbGV2ZWwgZGlmZiBvbiBib3RoIHN0cmluZ3MsIHRoZW4gcmVkaWZmIHRoZSBwYXJ0cyBmb3Jcblx0ICAgKiBncmVhdGVyIGFjY3VyYWN5LlxuXHQgICAqIFRoaXMgc3BlZWR1cCBjYW4gcHJvZHVjZSBub24tbWluaW1hbCBkaWZmcy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgT2xkIHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIE5ldyBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWFkbGluZSBUaW1lIHdoZW4gdGhlIGRpZmYgc2hvdWxkIGJlIGNvbXBsZXRlIGJ5LlxuXHQgICAqIEByZXR1cm4geyFBcnJheS48IURpZmZNYXRjaFBhdGNoLkRpZmY+fSBBcnJheSBvZiBkaWZmIHR1cGxlcy5cblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkxpbmVNb2RlID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0MiwgZGVhZGxpbmUpIHtcblx0ICAgIHZhciBhLCBkaWZmcywgbGluZWFycmF5LCBwb2ludGVyLCBjb3VudEluc2VydCwgY291bnREZWxldGUsIHRleHRJbnNlcnQsIHRleHREZWxldGUsIGo7IC8vIFNjYW4gdGhlIHRleHQgb24gYSBsaW5lLWJ5LWxpbmUgYmFzaXMgZmlyc3QuXG5cblx0ICAgIGEgPSB0aGlzLmRpZmZMaW5lc1RvQ2hhcnModGV4dDEsIHRleHQyKTtcblx0ICAgIHRleHQxID0gYS5jaGFyczE7XG5cdCAgICB0ZXh0MiA9IGEuY2hhcnMyO1xuXHQgICAgbGluZWFycmF5ID0gYS5saW5lQXJyYXk7XG5cdCAgICBkaWZmcyA9IHRoaXMuRGlmZk1haW4odGV4dDEsIHRleHQyLCBmYWxzZSwgZGVhZGxpbmUpOyAvLyBDb252ZXJ0IHRoZSBkaWZmIGJhY2sgdG8gb3JpZ2luYWwgdGV4dC5cblxuXHQgICAgdGhpcy5kaWZmQ2hhcnNUb0xpbmVzKGRpZmZzLCBsaW5lYXJyYXkpOyAvLyBFbGltaW5hdGUgZnJlYWsgbWF0Y2hlcyAoZS5nLiBibGFuayBsaW5lcylcblxuXHQgICAgdGhpcy5kaWZmQ2xlYW51cFNlbWFudGljKGRpZmZzKTsgLy8gUmVkaWZmIGFueSByZXBsYWNlbWVudCBibG9ja3MsIHRoaXMgdGltZSBjaGFyYWN0ZXItYnktY2hhcmFjdGVyLlxuXHQgICAgLy8gQWRkIGEgZHVtbXkgZW50cnkgYXQgdGhlIGVuZC5cblxuXHQgICAgZGlmZnMucHVzaChbRElGRl9FUVVBTCwgXCJcIl0pO1xuXHQgICAgcG9pbnRlciA9IDA7XG5cdCAgICBjb3VudERlbGV0ZSA9IDA7XG5cdCAgICBjb3VudEluc2VydCA9IDA7XG5cdCAgICB0ZXh0RGVsZXRlID0gXCJcIjtcblx0ICAgIHRleHRJbnNlcnQgPSBcIlwiO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuXHQgICAgICBzd2l0Y2ggKGRpZmZzW3BvaW50ZXJdWzBdKSB7XG5cdCAgICAgICAgY2FzZSBESUZGX0lOU0VSVDpcblx0ICAgICAgICAgIGNvdW50SW5zZXJ0Kys7XG5cdCAgICAgICAgICB0ZXh0SW5zZXJ0ICs9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgICAgYnJlYWs7XG5cblx0ICAgICAgICBjYXNlIERJRkZfREVMRVRFOlxuXHQgICAgICAgICAgY291bnREZWxldGUrKztcblx0ICAgICAgICAgIHRleHREZWxldGUgKz0gZGlmZnNbcG9pbnRlcl1bMV07XG5cdCAgICAgICAgICBicmVhaztcblxuXHQgICAgICAgIGNhc2UgRElGRl9FUVVBTDpcblx0ICAgICAgICAgIC8vIFVwb24gcmVhY2hpbmcgYW4gZXF1YWxpdHksIGNoZWNrIGZvciBwcmlvciByZWR1bmRhbmNpZXMuXG5cdCAgICAgICAgICBpZiAoY291bnREZWxldGUgPj0gMSAmJiBjb3VudEluc2VydCA+PSAxKSB7XG5cdCAgICAgICAgICAgIC8vIERlbGV0ZSB0aGUgb2ZmZW5kaW5nIHJlY29yZHMgYW5kIGFkZCB0aGUgbWVyZ2VkIG9uZXMuXG5cdCAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydCwgY291bnREZWxldGUgKyBjb3VudEluc2VydCk7XG5cdCAgICAgICAgICAgIHBvaW50ZXIgPSBwb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydDtcblx0ICAgICAgICAgICAgYSA9IHRoaXMuRGlmZk1haW4odGV4dERlbGV0ZSwgdGV4dEluc2VydCwgZmFsc2UsIGRlYWRsaW5lKTtcblxuXHQgICAgICAgICAgICBmb3IgKGogPSBhLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7XG5cdCAgICAgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIsIDAsIGFbal0pO1xuXHQgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgcG9pbnRlciA9IHBvaW50ZXIgKyBhLmxlbmd0aDtcblx0ICAgICAgICAgIH1cblxuXHQgICAgICAgICAgY291bnRJbnNlcnQgPSAwO1xuXHQgICAgICAgICAgY291bnREZWxldGUgPSAwO1xuXHQgICAgICAgICAgdGV4dERlbGV0ZSA9IFwiXCI7XG5cdCAgICAgICAgICB0ZXh0SW5zZXJ0ID0gXCJcIjtcblx0ICAgICAgICAgIGJyZWFrO1xuXHQgICAgICB9XG5cblx0ICAgICAgcG9pbnRlcisrO1xuXHQgICAgfVxuXG5cdCAgICBkaWZmcy5wb3AoKTsgLy8gUmVtb3ZlIHRoZSBkdW1teSBlbnRyeSBhdCB0aGUgZW5kLlxuXG5cdCAgICByZXR1cm4gZGlmZnM7XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBGaW5kIHRoZSAnbWlkZGxlIHNuYWtlJyBvZiBhIGRpZmYsIHNwbGl0IHRoZSBwcm9ibGVtIGluIHR3b1xuXHQgICAqIGFuZCByZXR1cm4gdGhlIHJlY3Vyc2l2ZWx5IGNvbnN0cnVjdGVkIGRpZmYuXG5cdCAgICogU2VlIE15ZXJzIDE5ODYgcGFwZXI6IEFuIE8oTkQpIERpZmZlcmVuY2UgQWxnb3JpdGhtIGFuZCBJdHMgVmFyaWF0aW9ucy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgT2xkIHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQyIE5ldyBzdHJpbmcgdG8gYmUgZGlmZmVkLlxuXHQgICAqIEBwYXJhbSB7bnVtYmVyfSBkZWFkbGluZSBUaW1lIGF0IHdoaWNoIHRvIGJhaWwgaWYgbm90IHlldCBjb21wbGV0ZS5cblx0ICAgKiBAcmV0dXJuIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZCaXNlY3QgPSBmdW5jdGlvbiAodGV4dDEsIHRleHQyLCBkZWFkbGluZSkge1xuXHQgICAgdmFyIHRleHQxTGVuZ3RoLCB0ZXh0Mkxlbmd0aCwgbWF4RCwgdk9mZnNldCwgdkxlbmd0aCwgdjEsIHYyLCB4LCBkZWx0YSwgZnJvbnQsIGsxc3RhcnQsIGsxZW5kLCBrMnN0YXJ0LCBrMmVuZCwgazJPZmZzZXQsIGsxT2Zmc2V0LCB4MSwgeDIsIHkxLCB5MiwgZCwgazEsIGsyOyAvLyBDYWNoZSB0aGUgdGV4dCBsZW5ndGhzIHRvIHByZXZlbnQgbXVsdGlwbGUgY2FsbHMuXG5cblx0ICAgIHRleHQxTGVuZ3RoID0gdGV4dDEubGVuZ3RoO1xuXHQgICAgdGV4dDJMZW5ndGggPSB0ZXh0Mi5sZW5ndGg7XG5cdCAgICBtYXhEID0gTWF0aC5jZWlsKCh0ZXh0MUxlbmd0aCArIHRleHQyTGVuZ3RoKSAvIDIpO1xuXHQgICAgdk9mZnNldCA9IG1heEQ7XG5cdCAgICB2TGVuZ3RoID0gMiAqIG1heEQ7XG5cdCAgICB2MSA9IG5ldyBBcnJheSh2TGVuZ3RoKTtcblx0ICAgIHYyID0gbmV3IEFycmF5KHZMZW5ndGgpOyAvLyBTZXR0aW5nIGFsbCBlbGVtZW50cyB0byAtMSBpcyBmYXN0ZXIgaW4gQ2hyb21lICYgRmlyZWZveCB0aGFuIG1peGluZ1xuXHQgICAgLy8gaW50ZWdlcnMgYW5kIHVuZGVmaW5lZC5cblxuXHQgICAgZm9yICh4ID0gMDsgeCA8IHZMZW5ndGg7IHgrKykge1xuXHQgICAgICB2MVt4XSA9IC0xO1xuXHQgICAgICB2Mlt4XSA9IC0xO1xuXHQgICAgfVxuXG5cdCAgICB2MVt2T2Zmc2V0ICsgMV0gPSAwO1xuXHQgICAgdjJbdk9mZnNldCArIDFdID0gMDtcblx0ICAgIGRlbHRhID0gdGV4dDFMZW5ndGggLSB0ZXh0Mkxlbmd0aDsgLy8gSWYgdGhlIHRvdGFsIG51bWJlciBvZiBjaGFyYWN0ZXJzIGlzIG9kZCwgdGhlbiB0aGUgZnJvbnQgcGF0aCB3aWxsIGNvbGxpZGVcblx0ICAgIC8vIHdpdGggdGhlIHJldmVyc2UgcGF0aC5cblxuXHQgICAgZnJvbnQgPSBkZWx0YSAlIDIgIT09IDA7IC8vIE9mZnNldHMgZm9yIHN0YXJ0IGFuZCBlbmQgb2YgayBsb29wLlxuXHQgICAgLy8gUHJldmVudHMgbWFwcGluZyBvZiBzcGFjZSBiZXlvbmQgdGhlIGdyaWQuXG5cblx0ICAgIGsxc3RhcnQgPSAwO1xuXHQgICAgazFlbmQgPSAwO1xuXHQgICAgazJzdGFydCA9IDA7XG5cdCAgICBrMmVuZCA9IDA7XG5cblx0ICAgIGZvciAoZCA9IDA7IGQgPCBtYXhEOyBkKyspIHtcblx0ICAgICAgLy8gQmFpbCBvdXQgaWYgZGVhZGxpbmUgaXMgcmVhY2hlZC5cblx0ICAgICAgaWYgKG5ldyBEYXRlKCkuZ2V0VGltZSgpID4gZGVhZGxpbmUpIHtcblx0ICAgICAgICBicmVhaztcblx0ICAgICAgfSAvLyBXYWxrIHRoZSBmcm9udCBwYXRoIG9uZSBzdGVwLlxuXG5cblx0ICAgICAgZm9yIChrMSA9IC1kICsgazFzdGFydDsgazEgPD0gZCAtIGsxZW5kOyBrMSArPSAyKSB7XG5cdCAgICAgICAgazFPZmZzZXQgPSB2T2Zmc2V0ICsgazE7XG5cblx0ICAgICAgICBpZiAoazEgPT09IC1kIHx8IGsxICE9PSBkICYmIHYxW2sxT2Zmc2V0IC0gMV0gPCB2MVtrMU9mZnNldCArIDFdKSB7XG5cdCAgICAgICAgICB4MSA9IHYxW2sxT2Zmc2V0ICsgMV07XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIHgxID0gdjFbazFPZmZzZXQgLSAxXSArIDE7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgeTEgPSB4MSAtIGsxO1xuXG5cdCAgICAgICAgd2hpbGUgKHgxIDwgdGV4dDFMZW5ndGggJiYgeTEgPCB0ZXh0Mkxlbmd0aCAmJiB0ZXh0MS5jaGFyQXQoeDEpID09PSB0ZXh0Mi5jaGFyQXQoeTEpKSB7XG5cdCAgICAgICAgICB4MSsrO1xuXHQgICAgICAgICAgeTErKztcblx0ICAgICAgICB9XG5cblx0ICAgICAgICB2MVtrMU9mZnNldF0gPSB4MTtcblxuXHQgICAgICAgIGlmICh4MSA+IHRleHQxTGVuZ3RoKSB7XG5cdCAgICAgICAgICAvLyBSYW4gb2ZmIHRoZSByaWdodCBvZiB0aGUgZ3JhcGguXG5cdCAgICAgICAgICBrMWVuZCArPSAyO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoeTEgPiB0ZXh0Mkxlbmd0aCkge1xuXHQgICAgICAgICAgLy8gUmFuIG9mZiB0aGUgYm90dG9tIG9mIHRoZSBncmFwaC5cblx0ICAgICAgICAgIGsxc3RhcnQgKz0gMjtcblx0ICAgICAgICB9IGVsc2UgaWYgKGZyb250KSB7XG5cdCAgICAgICAgICBrMk9mZnNldCA9IHZPZmZzZXQgKyBkZWx0YSAtIGsxO1xuXG5cdCAgICAgICAgICBpZiAoazJPZmZzZXQgPj0gMCAmJiBrMk9mZnNldCA8IHZMZW5ndGggJiYgdjJbazJPZmZzZXRdICE9PSAtMSkge1xuXHQgICAgICAgICAgICAvLyBNaXJyb3IgeDIgb250byB0b3AtbGVmdCBjb29yZGluYXRlIHN5c3RlbS5cblx0ICAgICAgICAgICAgeDIgPSB0ZXh0MUxlbmd0aCAtIHYyW2syT2Zmc2V0XTtcblxuXHQgICAgICAgICAgICBpZiAoeDEgPj0geDIpIHtcblx0ICAgICAgICAgICAgICAvLyBPdmVybGFwIGRldGVjdGVkLlxuXHQgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRpZmZCaXNlY3RTcGxpdCh0ZXh0MSwgdGV4dDIsIHgxLCB5MSwgZGVhZGxpbmUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9IC8vIFdhbGsgdGhlIHJldmVyc2UgcGF0aCBvbmUgc3RlcC5cblxuXG5cdCAgICAgIGZvciAoazIgPSAtZCArIGsyc3RhcnQ7IGsyIDw9IGQgLSBrMmVuZDsgazIgKz0gMikge1xuXHQgICAgICAgIGsyT2Zmc2V0ID0gdk9mZnNldCArIGsyO1xuXG5cdCAgICAgICAgaWYgKGsyID09PSAtZCB8fCBrMiAhPT0gZCAmJiB2MltrMk9mZnNldCAtIDFdIDwgdjJbazJPZmZzZXQgKyAxXSkge1xuXHQgICAgICAgICAgeDIgPSB2MltrMk9mZnNldCArIDFdO1xuXHQgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICB4MiA9IHYyW2syT2Zmc2V0IC0gMV0gKyAxO1xuXHQgICAgICAgIH1cblxuXHQgICAgICAgIHkyID0geDIgLSBrMjtcblxuXHQgICAgICAgIHdoaWxlICh4MiA8IHRleHQxTGVuZ3RoICYmIHkyIDwgdGV4dDJMZW5ndGggJiYgdGV4dDEuY2hhckF0KHRleHQxTGVuZ3RoIC0geDIgLSAxKSA9PT0gdGV4dDIuY2hhckF0KHRleHQyTGVuZ3RoIC0geTIgLSAxKSkge1xuXHQgICAgICAgICAgeDIrKztcblx0ICAgICAgICAgIHkyKys7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgdjJbazJPZmZzZXRdID0geDI7XG5cblx0ICAgICAgICBpZiAoeDIgPiB0ZXh0MUxlbmd0aCkge1xuXHQgICAgICAgICAgLy8gUmFuIG9mZiB0aGUgbGVmdCBvZiB0aGUgZ3JhcGguXG5cdCAgICAgICAgICBrMmVuZCArPSAyO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoeTIgPiB0ZXh0Mkxlbmd0aCkge1xuXHQgICAgICAgICAgLy8gUmFuIG9mZiB0aGUgdG9wIG9mIHRoZSBncmFwaC5cblx0ICAgICAgICAgIGsyc3RhcnQgKz0gMjtcblx0ICAgICAgICB9IGVsc2UgaWYgKCFmcm9udCkge1xuXHQgICAgICAgICAgazFPZmZzZXQgPSB2T2Zmc2V0ICsgZGVsdGEgLSBrMjtcblxuXHQgICAgICAgICAgaWYgKGsxT2Zmc2V0ID49IDAgJiYgazFPZmZzZXQgPCB2TGVuZ3RoICYmIHYxW2sxT2Zmc2V0XSAhPT0gLTEpIHtcblx0ICAgICAgICAgICAgeDEgPSB2MVtrMU9mZnNldF07XG5cdCAgICAgICAgICAgIHkxID0gdk9mZnNldCArIHgxIC0gazFPZmZzZXQ7IC8vIE1pcnJvciB4MiBvbnRvIHRvcC1sZWZ0IGNvb3JkaW5hdGUgc3lzdGVtLlxuXG5cdCAgICAgICAgICAgIHgyID0gdGV4dDFMZW5ndGggLSB4MjtcblxuXHQgICAgICAgICAgICBpZiAoeDEgPj0geDIpIHtcblx0ICAgICAgICAgICAgICAvLyBPdmVybGFwIGRldGVjdGVkLlxuXHQgICAgICAgICAgICAgIHJldHVybiB0aGlzLmRpZmZCaXNlY3RTcGxpdCh0ZXh0MSwgdGV4dDIsIHgxLCB5MSwgZGVhZGxpbmUpO1xuXHQgICAgICAgICAgICB9XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cdCAgICB9IC8vIERpZmYgdG9vayB0b28gbG9uZyBhbmQgaGl0IHRoZSBkZWFkbGluZSBvclxuXHQgICAgLy8gbnVtYmVyIG9mIGRpZmZzIGVxdWFscyBudW1iZXIgb2YgY2hhcmFjdGVycywgbm8gY29tbW9uYWxpdHkgYXQgYWxsLlxuXG5cblx0ICAgIHJldHVybiBbW0RJRkZfREVMRVRFLCB0ZXh0MV0sIFtESUZGX0lOU0VSVCwgdGV4dDJdXTtcblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIEdpdmVuIHRoZSBsb2NhdGlvbiBvZiB0aGUgJ21pZGRsZSBzbmFrZScsIHNwbGl0IHRoZSBkaWZmIGluIHR3byBwYXJ0c1xuXHQgICAqIGFuZCByZWN1cnNlLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MSBPbGQgc3RyaW5nIHRvIGJlIGRpZmZlZC5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgTmV3IHN0cmluZyB0byBiZSBkaWZmZWQuXG5cdCAgICogQHBhcmFtIHtudW1iZXJ9IHggSW5kZXggb2Ygc3BsaXQgcG9pbnQgaW4gdGV4dDEuXG5cdCAgICogQHBhcmFtIHtudW1iZXJ9IHkgSW5kZXggb2Ygc3BsaXQgcG9pbnQgaW4gdGV4dDIuXG5cdCAgICogQHBhcmFtIHtudW1iZXJ9IGRlYWRsaW5lIFRpbWUgYXQgd2hpY2ggdG8gYmFpbCBpZiBub3QgeWV0IGNvbXBsZXRlLlxuXHQgICAqIEByZXR1cm4geyFBcnJheS48IURpZmZNYXRjaFBhdGNoLkRpZmY+fSBBcnJheSBvZiBkaWZmIHR1cGxlcy5cblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkJpc2VjdFNwbGl0ID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0MiwgeCwgeSwgZGVhZGxpbmUpIHtcblx0ICAgIHZhciB0ZXh0MWEsIHRleHQxYiwgdGV4dDJhLCB0ZXh0MmIsIGRpZmZzLCBkaWZmc2I7XG5cdCAgICB0ZXh0MWEgPSB0ZXh0MS5zdWJzdHJpbmcoMCwgeCk7XG5cdCAgICB0ZXh0MmEgPSB0ZXh0Mi5zdWJzdHJpbmcoMCwgeSk7XG5cdCAgICB0ZXh0MWIgPSB0ZXh0MS5zdWJzdHJpbmcoeCk7XG5cdCAgICB0ZXh0MmIgPSB0ZXh0Mi5zdWJzdHJpbmcoeSk7IC8vIENvbXB1dGUgYm90aCBkaWZmcyBzZXJpYWxseS5cblxuXHQgICAgZGlmZnMgPSB0aGlzLkRpZmZNYWluKHRleHQxYSwgdGV4dDJhLCBmYWxzZSwgZGVhZGxpbmUpO1xuXHQgICAgZGlmZnNiID0gdGhpcy5EaWZmTWFpbih0ZXh0MWIsIHRleHQyYiwgZmFsc2UsIGRlYWRsaW5lKTtcblx0ICAgIHJldHVybiBkaWZmcy5jb25jYXQoZGlmZnNiKTtcblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIFJlZHVjZSB0aGUgbnVtYmVyIG9mIGVkaXRzIGJ5IGVsaW1pbmF0aW5nIHNlbWFudGljYWxseSB0cml2aWFsIGVxdWFsaXRpZXMuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gZGlmZnMgQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICovXG5cblxuXHQgIERpZmZNYXRjaFBhdGNoLnByb3RvdHlwZS5kaWZmQ2xlYW51cFNlbWFudGljID0gZnVuY3Rpb24gKGRpZmZzKSB7XG5cdCAgICB2YXIgY2hhbmdlcywgZXF1YWxpdGllcywgZXF1YWxpdGllc0xlbmd0aCwgbGFzdGVxdWFsaXR5LCBwb2ludGVyLCBsZW5ndGhJbnNlcnRpb25zMiwgbGVuZ3RoRGVsZXRpb25zMiwgbGVuZ3RoSW5zZXJ0aW9uczEsIGxlbmd0aERlbGV0aW9uczEsIGRlbGV0aW9uLCBpbnNlcnRpb24sIG92ZXJsYXBMZW5ndGgxLCBvdmVybGFwTGVuZ3RoMjtcblx0ICAgIGNoYW5nZXMgPSBmYWxzZTtcblx0ICAgIGVxdWFsaXRpZXMgPSBbXTsgLy8gU3RhY2sgb2YgaW5kaWNlcyB3aGVyZSBlcXVhbGl0aWVzIGFyZSBmb3VuZC5cblxuXHQgICAgZXF1YWxpdGllc0xlbmd0aCA9IDA7IC8vIEtlZXBpbmcgb3VyIG93biBsZW5ndGggdmFyIGlzIGZhc3RlciBpbiBKUy5cblxuXHQgICAgLyoqIEB0eXBlIHs/c3RyaW5nfSAqL1xuXG5cdCAgICBsYXN0ZXF1YWxpdHkgPSBudWxsOyAvLyBBbHdheXMgZXF1YWwgdG8gZGlmZnNbZXF1YWxpdGllc1tlcXVhbGl0aWVzTGVuZ3RoIC0gMV1dWzFdXG5cblx0ICAgIHBvaW50ZXIgPSAwOyAvLyBJbmRleCBvZiBjdXJyZW50IHBvc2l0aW9uLlxuXHQgICAgLy8gTnVtYmVyIG9mIGNoYXJhY3RlcnMgdGhhdCBjaGFuZ2VkIHByaW9yIHRvIHRoZSBlcXVhbGl0eS5cblxuXHQgICAgbGVuZ3RoSW5zZXJ0aW9uczEgPSAwO1xuXHQgICAgbGVuZ3RoRGVsZXRpb25zMSA9IDA7IC8vIE51bWJlciBvZiBjaGFyYWN0ZXJzIHRoYXQgY2hhbmdlZCBhZnRlciB0aGUgZXF1YWxpdHkuXG5cblx0ICAgIGxlbmd0aEluc2VydGlvbnMyID0gMDtcblx0ICAgIGxlbmd0aERlbGV0aW9uczIgPSAwO1xuXG5cdCAgICB3aGlsZSAocG9pbnRlciA8IGRpZmZzLmxlbmd0aCkge1xuXHQgICAgICBpZiAoZGlmZnNbcG9pbnRlcl1bMF0gPT09IERJRkZfRVFVQUwpIHtcblx0ICAgICAgICAvLyBFcXVhbGl0eSBmb3VuZC5cblx0ICAgICAgICBlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGgrK10gPSBwb2ludGVyO1xuXHQgICAgICAgIGxlbmd0aEluc2VydGlvbnMxID0gbGVuZ3RoSW5zZXJ0aW9uczI7XG5cdCAgICAgICAgbGVuZ3RoRGVsZXRpb25zMSA9IGxlbmd0aERlbGV0aW9uczI7XG5cdCAgICAgICAgbGVuZ3RoSW5zZXJ0aW9uczIgPSAwO1xuXHQgICAgICAgIGxlbmd0aERlbGV0aW9uczIgPSAwO1xuXHQgICAgICAgIGxhc3RlcXVhbGl0eSA9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICB9IGVsc2Uge1xuXHQgICAgICAgIC8vIEFuIGluc2VydGlvbiBvciBkZWxldGlvbi5cblx0ICAgICAgICBpZiAoZGlmZnNbcG9pbnRlcl1bMF0gPT09IERJRkZfSU5TRVJUKSB7XG5cdCAgICAgICAgICBsZW5ndGhJbnNlcnRpb25zMiArPSBkaWZmc1twb2ludGVyXVsxXS5sZW5ndGg7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGxlbmd0aERlbGV0aW9uczIgKz0gZGlmZnNbcG9pbnRlcl1bMV0ubGVuZ3RoO1xuXHQgICAgICAgIH0gLy8gRWxpbWluYXRlIGFuIGVxdWFsaXR5IHRoYXQgaXMgc21hbGxlciBvciBlcXVhbCB0byB0aGUgZWRpdHMgb24gYm90aFxuXHQgICAgICAgIC8vIHNpZGVzIG9mIGl0LlxuXG5cblx0ICAgICAgICBpZiAobGFzdGVxdWFsaXR5ICYmIGxhc3RlcXVhbGl0eS5sZW5ndGggPD0gTWF0aC5tYXgobGVuZ3RoSW5zZXJ0aW9uczEsIGxlbmd0aERlbGV0aW9uczEpICYmIGxhc3RlcXVhbGl0eS5sZW5ndGggPD0gTWF0aC5tYXgobGVuZ3RoSW5zZXJ0aW9uczIsIGxlbmd0aERlbGV0aW9uczIpKSB7XG5cdCAgICAgICAgICAvLyBEdXBsaWNhdGUgcmVjb3JkLlxuXHQgICAgICAgICAgZGlmZnMuc3BsaWNlKGVxdWFsaXRpZXNbZXF1YWxpdGllc0xlbmd0aCAtIDFdLCAwLCBbRElGRl9ERUxFVEUsIGxhc3RlcXVhbGl0eV0pOyAvLyBDaGFuZ2Ugc2Vjb25kIGNvcHkgdG8gaW5zZXJ0LlxuXG5cdCAgICAgICAgICBkaWZmc1tlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSArIDFdWzBdID0gRElGRl9JTlNFUlQ7IC8vIFRocm93IGF3YXkgdGhlIGVxdWFsaXR5IHdlIGp1c3QgZGVsZXRlZC5cblxuXHQgICAgICAgICAgZXF1YWxpdGllc0xlbmd0aC0tOyAvLyBUaHJvdyBhd2F5IHRoZSBwcmV2aW91cyBlcXVhbGl0eSAoaXQgbmVlZHMgdG8gYmUgcmVldmFsdWF0ZWQpLlxuXG5cdCAgICAgICAgICBlcXVhbGl0aWVzTGVuZ3RoLS07XG5cdCAgICAgICAgICBwb2ludGVyID0gZXF1YWxpdGllc0xlbmd0aCA+IDAgPyBlcXVhbGl0aWVzW2VxdWFsaXRpZXNMZW5ndGggLSAxXSA6IC0xOyAvLyBSZXNldCB0aGUgY291bnRlcnMuXG5cblx0ICAgICAgICAgIGxlbmd0aEluc2VydGlvbnMxID0gMDtcblx0ICAgICAgICAgIGxlbmd0aERlbGV0aW9uczEgPSAwO1xuXHQgICAgICAgICAgbGVuZ3RoSW5zZXJ0aW9uczIgPSAwO1xuXHQgICAgICAgICAgbGVuZ3RoRGVsZXRpb25zMiA9IDA7XG5cdCAgICAgICAgICBsYXN0ZXF1YWxpdHkgPSBudWxsO1xuXHQgICAgICAgICAgY2hhbmdlcyA9IHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcG9pbnRlcisrO1xuXHQgICAgfSAvLyBOb3JtYWxpemUgdGhlIGRpZmYuXG5cblxuXHQgICAgaWYgKGNoYW5nZXMpIHtcblx0ICAgICAgdGhpcy5kaWZmQ2xlYW51cE1lcmdlKGRpZmZzKTtcblx0ICAgIH0gLy8gRmluZCBhbnkgb3ZlcmxhcHMgYmV0d2VlbiBkZWxldGlvbnMgYW5kIGluc2VydGlvbnMuXG5cdCAgICAvLyBlLmc6IDxkZWw+YWJjeHh4PC9kZWw+PGlucz54eHhkZWY8L2lucz5cblx0ICAgIC8vICAgLT4gPGRlbD5hYmM8L2RlbD54eHg8aW5zPmRlZjwvaW5zPlxuXHQgICAgLy8gZS5nOiA8ZGVsPnh4eGFiYzwvZGVsPjxpbnM+ZGVmeHh4PC9pbnM+XG5cdCAgICAvLyAgIC0+IDxpbnM+ZGVmPC9pbnM+eHh4PGRlbD5hYmM8L2RlbD5cblx0ICAgIC8vIE9ubHkgZXh0cmFjdCBhbiBvdmVybGFwIGlmIGl0IGlzIGFzIGJpZyBhcyB0aGUgZWRpdCBhaGVhZCBvciBiZWhpbmQgaXQuXG5cblxuXHQgICAgcG9pbnRlciA9IDE7XG5cblx0ICAgIHdoaWxlIChwb2ludGVyIDwgZGlmZnMubGVuZ3RoKSB7XG5cdCAgICAgIGlmIChkaWZmc1twb2ludGVyIC0gMV1bMF0gPT09IERJRkZfREVMRVRFICYmIGRpZmZzW3BvaW50ZXJdWzBdID09PSBESUZGX0lOU0VSVCkge1xuXHQgICAgICAgIGRlbGV0aW9uID0gZGlmZnNbcG9pbnRlciAtIDFdWzFdO1xuXHQgICAgICAgIGluc2VydGlvbiA9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgIG92ZXJsYXBMZW5ndGgxID0gdGhpcy5kaWZmQ29tbW9uT3ZlcmxhcChkZWxldGlvbiwgaW5zZXJ0aW9uKTtcblx0ICAgICAgICBvdmVybGFwTGVuZ3RoMiA9IHRoaXMuZGlmZkNvbW1vbk92ZXJsYXAoaW5zZXJ0aW9uLCBkZWxldGlvbik7XG5cblx0ICAgICAgICBpZiAob3ZlcmxhcExlbmd0aDEgPj0gb3ZlcmxhcExlbmd0aDIpIHtcblx0ICAgICAgICAgIGlmIChvdmVybGFwTGVuZ3RoMSA+PSBkZWxldGlvbi5sZW5ndGggLyAyIHx8IG92ZXJsYXBMZW5ndGgxID49IGluc2VydGlvbi5sZW5ndGggLyAyKSB7XG5cdCAgICAgICAgICAgIC8vIE92ZXJsYXAgZm91bmQuICBJbnNlcnQgYW4gZXF1YWxpdHkgYW5kIHRyaW0gdGhlIHN1cnJvdW5kaW5nIGVkaXRzLlxuXHQgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciwgMCwgW0RJRkZfRVFVQUwsIGluc2VydGlvbi5zdWJzdHJpbmcoMCwgb3ZlcmxhcExlbmd0aDEpXSk7XG5cdCAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVsxXSA9IGRlbGV0aW9uLnN1YnN0cmluZygwLCBkZWxldGlvbi5sZW5ndGggLSBvdmVybGFwTGVuZ3RoMSk7XG5cdCAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVsxXSA9IGluc2VydGlvbi5zdWJzdHJpbmcob3ZlcmxhcExlbmd0aDEpO1xuXHQgICAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGlmIChvdmVybGFwTGVuZ3RoMiA+PSBkZWxldGlvbi5sZW5ndGggLyAyIHx8IG92ZXJsYXBMZW5ndGgyID49IGluc2VydGlvbi5sZW5ndGggLyAyKSB7XG5cdCAgICAgICAgICAgIC8vIFJldmVyc2Ugb3ZlcmxhcCBmb3VuZC5cblx0ICAgICAgICAgICAgLy8gSW5zZXJ0IGFuIGVxdWFsaXR5IGFuZCBzd2FwIGFuZCB0cmltIHRoZSBzdXJyb3VuZGluZyBlZGl0cy5cblx0ICAgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIsIDAsIFtESUZGX0VRVUFMLCBkZWxldGlvbi5zdWJzdHJpbmcoMCwgb3ZlcmxhcExlbmd0aDIpXSk7XG5cdCAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgLSAxXVswXSA9IERJRkZfSU5TRVJUO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMV0gPSBpbnNlcnRpb24uc3Vic3RyaW5nKDAsIGluc2VydGlvbi5sZW5ndGggLSBvdmVybGFwTGVuZ3RoMik7XG5cdCAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgKyAxXVswXSA9IERJRkZfREVMRVRFO1xuXHQgICAgICAgICAgICBkaWZmc1twb2ludGVyICsgMV1bMV0gPSBkZWxldGlvbi5zdWJzdHJpbmcob3ZlcmxhcExlbmd0aDIpO1xuXHQgICAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICB9XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgcG9pbnRlcisrO1xuXHQgICAgICB9XG5cblx0ICAgICAgcG9pbnRlcisrO1xuXHQgICAgfVxuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogRGV0ZXJtaW5lIGlmIHRoZSBzdWZmaXggb2Ygb25lIHN0cmluZyBpcyB0aGUgcHJlZml4IG9mIGFub3RoZXIuXG5cdCAgICogQHBhcmFtIHtzdHJpbmd9IHRleHQxIEZpcnN0IHN0cmluZy5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDIgU2Vjb25kIHN0cmluZy5cblx0ICAgKiBAcmV0dXJuIHtudW1iZXJ9IFRoZSBudW1iZXIgb2YgY2hhcmFjdGVycyBjb21tb24gdG8gdGhlIGVuZCBvZiB0aGUgZmlyc3Rcblx0ICAgKiAgICAgc3RyaW5nIGFuZCB0aGUgc3RhcnQgb2YgdGhlIHNlY29uZCBzdHJpbmcuXG5cdCAgICogQHByaXZhdGVcblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDb21tb25PdmVybGFwID0gZnVuY3Rpb24gKHRleHQxLCB0ZXh0Mikge1xuXHQgICAgdmFyIHRleHQxTGVuZ3RoLCB0ZXh0Mkxlbmd0aCwgdGV4dExlbmd0aCwgYmVzdCwgbGVuZ3RoLCBwYXR0ZXJuLCBmb3VuZDsgLy8gQ2FjaGUgdGhlIHRleHQgbGVuZ3RocyB0byBwcmV2ZW50IG11bHRpcGxlIGNhbGxzLlxuXG5cdCAgICB0ZXh0MUxlbmd0aCA9IHRleHQxLmxlbmd0aDtcblx0ICAgIHRleHQyTGVuZ3RoID0gdGV4dDIubGVuZ3RoOyAvLyBFbGltaW5hdGUgdGhlIG51bGwgY2FzZS5cblxuXHQgICAgaWYgKHRleHQxTGVuZ3RoID09PSAwIHx8IHRleHQyTGVuZ3RoID09PSAwKSB7XG5cdCAgICAgIHJldHVybiAwO1xuXHQgICAgfSAvLyBUcnVuY2F0ZSB0aGUgbG9uZ2VyIHN0cmluZy5cblxuXG5cdCAgICBpZiAodGV4dDFMZW5ndGggPiB0ZXh0Mkxlbmd0aCkge1xuXHQgICAgICB0ZXh0MSA9IHRleHQxLnN1YnN0cmluZyh0ZXh0MUxlbmd0aCAtIHRleHQyTGVuZ3RoKTtcblx0ICAgIH0gZWxzZSBpZiAodGV4dDFMZW5ndGggPCB0ZXh0Mkxlbmd0aCkge1xuXHQgICAgICB0ZXh0MiA9IHRleHQyLnN1YnN0cmluZygwLCB0ZXh0MUxlbmd0aCk7XG5cdCAgICB9XG5cblx0ICAgIHRleHRMZW5ndGggPSBNYXRoLm1pbih0ZXh0MUxlbmd0aCwgdGV4dDJMZW5ndGgpOyAvLyBRdWljayBjaGVjayBmb3IgdGhlIHdvcnN0IGNhc2UuXG5cblx0ICAgIGlmICh0ZXh0MSA9PT0gdGV4dDIpIHtcblx0ICAgICAgcmV0dXJuIHRleHRMZW5ndGg7XG5cdCAgICB9IC8vIFN0YXJ0IGJ5IGxvb2tpbmcgZm9yIGEgc2luZ2xlIGNoYXJhY3RlciBtYXRjaFxuXHQgICAgLy8gYW5kIGluY3JlYXNlIGxlbmd0aCB1bnRpbCBubyBtYXRjaCBpcyBmb3VuZC5cblx0ICAgIC8vIFBlcmZvcm1hbmNlIGFuYWx5c2lzOiBodHRwczovL25laWwuZnJhc2VyLm5hbWUvbmV3cy8yMDEwLzExLzA0L1xuXG5cblx0ICAgIGJlc3QgPSAwO1xuXHQgICAgbGVuZ3RoID0gMTtcblxuXHQgICAgd2hpbGUgKHRydWUpIHtcblx0ICAgICAgcGF0dGVybiA9IHRleHQxLnN1YnN0cmluZyh0ZXh0TGVuZ3RoIC0gbGVuZ3RoKTtcblx0ICAgICAgZm91bmQgPSB0ZXh0Mi5pbmRleE9mKHBhdHRlcm4pO1xuXG5cdCAgICAgIGlmIChmb3VuZCA9PT0gLTEpIHtcblx0ICAgICAgICByZXR1cm4gYmVzdDtcblx0ICAgICAgfVxuXG5cdCAgICAgIGxlbmd0aCArPSBmb3VuZDtcblxuXHQgICAgICBpZiAoZm91bmQgPT09IDAgfHwgdGV4dDEuc3Vic3RyaW5nKHRleHRMZW5ndGggLSBsZW5ndGgpID09PSB0ZXh0Mi5zdWJzdHJpbmcoMCwgbGVuZ3RoKSkge1xuXHQgICAgICAgIGJlc3QgPSBsZW5ndGg7XG5cdCAgICAgICAgbGVuZ3RoKys7XG5cdCAgICAgIH1cblx0ICAgIH1cblx0ICB9O1xuXHQgIC8qKlxuXHQgICAqIFNwbGl0IHR3byB0ZXh0cyBpbnRvIGFuIGFycmF5IG9mIHN0cmluZ3MuICBSZWR1Y2UgdGhlIHRleHRzIHRvIGEgc3RyaW5nIG9mXG5cdCAgICogaGFzaGVzIHdoZXJlIGVhY2ggVW5pY29kZSBjaGFyYWN0ZXIgcmVwcmVzZW50cyBvbmUgbGluZS5cblx0ICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dDEgRmlyc3Qgc3RyaW5nLlxuXHQgICAqIEBwYXJhbSB7c3RyaW5nfSB0ZXh0MiBTZWNvbmQgc3RyaW5nLlxuXHQgICAqIEByZXR1cm4ge3tjaGFyczE6IHN0cmluZywgY2hhcnMyOiBzdHJpbmcsIGxpbmVBcnJheTogIUFycmF5LjxzdHJpbmc+fX1cblx0ICAgKiAgICAgQW4gb2JqZWN0IGNvbnRhaW5pbmcgdGhlIGVuY29kZWQgdGV4dDEsIHRoZSBlbmNvZGVkIHRleHQyIGFuZFxuXHQgICAqICAgICB0aGUgYXJyYXkgb2YgdW5pcXVlIHN0cmluZ3MuXG5cdCAgICogICAgIFRoZSB6ZXJvdGggZWxlbWVudCBvZiB0aGUgYXJyYXkgb2YgdW5pcXVlIHN0cmluZ3MgaXMgaW50ZW50aW9uYWxseSBibGFuay5cblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkxpbmVzVG9DaGFycyA9IGZ1bmN0aW9uICh0ZXh0MSwgdGV4dDIpIHtcblx0ICAgIHZhciBsaW5lQXJyYXksIGxpbmVIYXNoLCBjaGFyczEsIGNoYXJzMjtcblx0ICAgIGxpbmVBcnJheSA9IFtdOyAvLyBFLmcuIGxpbmVBcnJheVs0XSA9PT0gJ0hlbGxvXFxuJ1xuXG5cdCAgICBsaW5lSGFzaCA9IHt9OyAvLyBFLmcuIGxpbmVIYXNoWydIZWxsb1xcbiddID09PSA0XG5cdCAgICAvLyAnXFx4MDAnIGlzIGEgdmFsaWQgY2hhcmFjdGVyLCBidXQgdmFyaW91cyBkZWJ1Z2dlcnMgZG9uJ3QgbGlrZSBpdC5cblx0ICAgIC8vIFNvIHdlJ2xsIGluc2VydCBhIGp1bmsgZW50cnkgdG8gYXZvaWQgZ2VuZXJhdGluZyBhIG51bGwgY2hhcmFjdGVyLlxuXG5cdCAgICBsaW5lQXJyYXlbMF0gPSBcIlwiO1xuXHQgICAgLyoqXG5cdCAgICAgKiBTcGxpdCBhIHRleHQgaW50byBhbiBhcnJheSBvZiBzdHJpbmdzLiAgUmVkdWNlIHRoZSB0ZXh0cyB0byBhIHN0cmluZyBvZlxuXHQgICAgICogaGFzaGVzIHdoZXJlIGVhY2ggVW5pY29kZSBjaGFyYWN0ZXIgcmVwcmVzZW50cyBvbmUgbGluZS5cblx0ICAgICAqIE1vZGlmaWVzIGxpbmVhcnJheSBhbmQgbGluZWhhc2ggdGhyb3VnaCBiZWluZyBhIGNsb3N1cmUuXG5cdCAgICAgKiBAcGFyYW0ge3N0cmluZ30gdGV4dCBTdHJpbmcgdG8gZW5jb2RlLlxuXHQgICAgICogQHJldHVybiB7c3RyaW5nfSBFbmNvZGVkIHN0cmluZy5cblx0ICAgICAqIEBwcml2YXRlXG5cdCAgICAgKi9cblxuXHQgICAgZnVuY3Rpb24gZGlmZkxpbmVzVG9DaGFyc011bmdlKHRleHQpIHtcblx0ICAgICAgdmFyIGNoYXJzLCBsaW5lU3RhcnQsIGxpbmVFbmQsIGxpbmVBcnJheUxlbmd0aCwgbGluZTtcblx0ICAgICAgY2hhcnMgPSBcIlwiOyAvLyBXYWxrIHRoZSB0ZXh0LCBwdWxsaW5nIG91dCBhIHN1YnN0cmluZyBmb3IgZWFjaCBsaW5lLlxuXHQgICAgICAvLyB0ZXh0LnNwbGl0KCdcXG4nKSB3b3VsZCB3b3VsZCB0ZW1wb3JhcmlseSBkb3VibGUgb3VyIG1lbW9yeSBmb290cHJpbnQuXG5cdCAgICAgIC8vIE1vZGlmeWluZyB0ZXh0IHdvdWxkIGNyZWF0ZSBtYW55IGxhcmdlIHN0cmluZ3MgdG8gZ2FyYmFnZSBjb2xsZWN0LlxuXG5cdCAgICAgIGxpbmVTdGFydCA9IDA7XG5cdCAgICAgIGxpbmVFbmQgPSAtMTsgLy8gS2VlcGluZyBvdXIgb3duIGxlbmd0aCB2YXJpYWJsZSBpcyBmYXN0ZXIgdGhhbiBsb29raW5nIGl0IHVwLlxuXG5cdCAgICAgIGxpbmVBcnJheUxlbmd0aCA9IGxpbmVBcnJheS5sZW5ndGg7XG5cblx0ICAgICAgd2hpbGUgKGxpbmVFbmQgPCB0ZXh0Lmxlbmd0aCAtIDEpIHtcblx0ICAgICAgICBsaW5lRW5kID0gdGV4dC5pbmRleE9mKFwiXFxuXCIsIGxpbmVTdGFydCk7XG5cblx0ICAgICAgICBpZiAobGluZUVuZCA9PT0gLTEpIHtcblx0ICAgICAgICAgIGxpbmVFbmQgPSB0ZXh0Lmxlbmd0aCAtIDE7XG5cdCAgICAgICAgfVxuXG5cdCAgICAgICAgbGluZSA9IHRleHQuc3Vic3RyaW5nKGxpbmVTdGFydCwgbGluZUVuZCArIDEpO1xuXHQgICAgICAgIGxpbmVTdGFydCA9IGxpbmVFbmQgKyAxO1xuXG5cdCAgICAgICAgaWYgKGhhc093bi5jYWxsKGxpbmVIYXNoLCBsaW5lKSkge1xuXHQgICAgICAgICAgY2hhcnMgKz0gU3RyaW5nLmZyb21DaGFyQ29kZShsaW5lSGFzaFtsaW5lXSk7XG5cdCAgICAgICAgfSBlbHNlIHtcblx0ICAgICAgICAgIGNoYXJzICs9IFN0cmluZy5mcm9tQ2hhckNvZGUobGluZUFycmF5TGVuZ3RoKTtcblx0ICAgICAgICAgIGxpbmVIYXNoW2xpbmVdID0gbGluZUFycmF5TGVuZ3RoO1xuXHQgICAgICAgICAgbGluZUFycmF5W2xpbmVBcnJheUxlbmd0aCsrXSA9IGxpbmU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcmV0dXJuIGNoYXJzO1xuXHQgICAgfVxuXG5cdCAgICBjaGFyczEgPSBkaWZmTGluZXNUb0NoYXJzTXVuZ2UodGV4dDEpO1xuXHQgICAgY2hhcnMyID0gZGlmZkxpbmVzVG9DaGFyc011bmdlKHRleHQyKTtcblx0ICAgIHJldHVybiB7XG5cdCAgICAgIGNoYXJzMTogY2hhcnMxLFxuXHQgICAgICBjaGFyczI6IGNoYXJzMixcblx0ICAgICAgbGluZUFycmF5OiBsaW5lQXJyYXlcblx0ICAgIH07XG5cdCAgfTtcblx0ICAvKipcblx0ICAgKiBSZWh5ZHJhdGUgdGhlIHRleHQgaW4gYSBkaWZmIGZyb20gYSBzdHJpbmcgb2YgbGluZSBoYXNoZXMgdG8gcmVhbCBsaW5lcyBvZlxuXHQgICAqIHRleHQuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPCFEaWZmTWF0Y2hQYXRjaC5EaWZmPn0gZGlmZnMgQXJyYXkgb2YgZGlmZiB0dXBsZXMuXG5cdCAgICogQHBhcmFtIHshQXJyYXkuPHN0cmluZz59IGxpbmVBcnJheSBBcnJheSBvZiB1bmlxdWUgc3RyaW5ncy5cblx0ICAgKiBAcHJpdmF0ZVxuXHQgICAqL1xuXG5cblx0ICBEaWZmTWF0Y2hQYXRjaC5wcm90b3R5cGUuZGlmZkNoYXJzVG9MaW5lcyA9IGZ1bmN0aW9uIChkaWZmcywgbGluZUFycmF5KSB7XG5cdCAgICB2YXIgeCwgY2hhcnMsIHRleHQsIHk7XG5cblx0ICAgIGZvciAoeCA9IDA7IHggPCBkaWZmcy5sZW5ndGg7IHgrKykge1xuXHQgICAgICBjaGFycyA9IGRpZmZzW3hdWzFdO1xuXHQgICAgICB0ZXh0ID0gW107XG5cblx0ICAgICAgZm9yICh5ID0gMDsgeSA8IGNoYXJzLmxlbmd0aDsgeSsrKSB7XG5cdCAgICAgICAgdGV4dFt5XSA9IGxpbmVBcnJheVtjaGFycy5jaGFyQ29kZUF0KHkpXTtcblx0ICAgICAgfVxuXG5cdCAgICAgIGRpZmZzW3hdWzFdID0gdGV4dC5qb2luKFwiXCIpO1xuXHQgICAgfVxuXHQgIH07XG5cdCAgLyoqXG5cdCAgICogUmVvcmRlciBhbmQgbWVyZ2UgbGlrZSBlZGl0IHNlY3Rpb25zLiAgTWVyZ2UgZXF1YWxpdGllcy5cblx0ICAgKiBBbnkgZWRpdCBzZWN0aW9uIGNhbiBtb3ZlIGFzIGxvbmcgYXMgaXQgZG9lc24ndCBjcm9zcyBhbiBlcXVhbGl0eS5cblx0ICAgKiBAcGFyYW0geyFBcnJheS48IURpZmZNYXRjaFBhdGNoLkRpZmY+fSBkaWZmcyBBcnJheSBvZiBkaWZmIHR1cGxlcy5cblx0ICAgKi9cblxuXG5cdCAgRGlmZk1hdGNoUGF0Y2gucHJvdG90eXBlLmRpZmZDbGVhbnVwTWVyZ2UgPSBmdW5jdGlvbiAoZGlmZnMpIHtcblx0ICAgIHZhciBwb2ludGVyLCBjb3VudERlbGV0ZSwgY291bnRJbnNlcnQsIHRleHRJbnNlcnQsIHRleHREZWxldGUsIGNvbW1vbmxlbmd0aCwgY2hhbmdlcywgZGlmZlBvaW50ZXIsIHBvc2l0aW9uO1xuXHQgICAgZGlmZnMucHVzaChbRElGRl9FUVVBTCwgXCJcIl0pOyAvLyBBZGQgYSBkdW1teSBlbnRyeSBhdCB0aGUgZW5kLlxuXG5cdCAgICBwb2ludGVyID0gMDtcblx0ICAgIGNvdW50RGVsZXRlID0gMDtcblx0ICAgIGNvdW50SW5zZXJ0ID0gMDtcblx0ICAgIHRleHREZWxldGUgPSBcIlwiO1xuXHQgICAgdGV4dEluc2VydCA9IFwiXCI7XG5cblx0ICAgIHdoaWxlIChwb2ludGVyIDwgZGlmZnMubGVuZ3RoKSB7XG5cdCAgICAgIHN3aXRjaCAoZGlmZnNbcG9pbnRlcl1bMF0pIHtcblx0ICAgICAgICBjYXNlIERJRkZfSU5TRVJUOlxuXHQgICAgICAgICAgY291bnRJbnNlcnQrKztcblx0ICAgICAgICAgIHRleHRJbnNlcnQgKz0gZGlmZnNbcG9pbnRlcl1bMV07XG5cdCAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICBicmVhaztcblxuXHQgICAgICAgIGNhc2UgRElGRl9ERUxFVEU6XG5cdCAgICAgICAgICBjb3VudERlbGV0ZSsrO1xuXHQgICAgICAgICAgdGV4dERlbGV0ZSArPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICAgIHBvaW50ZXIrKztcblx0ICAgICAgICAgIGJyZWFrO1xuXG5cdCAgICAgICAgY2FzZSBESUZGX0VRVUFMOlxuXHQgICAgICAgICAgLy8gVXBvbiByZWFjaGluZyBhbiBlcXVhbGl0eSwgY2hlY2sgZm9yIHByaW9yIHJlZHVuZGFuY2llcy5cblx0ICAgICAgICAgIGlmIChjb3VudERlbGV0ZSArIGNvdW50SW5zZXJ0ID4gMSkge1xuXHQgICAgICAgICAgICBpZiAoY291bnREZWxldGUgIT09IDAgJiYgY291bnRJbnNlcnQgIT09IDApIHtcblx0ICAgICAgICAgICAgICAvLyBGYWN0b3Igb3V0IGFueSBjb21tb24gcHJlZml4ZXMuXG5cdCAgICAgICAgICAgICAgY29tbW9ubGVuZ3RoID0gdGhpcy5kaWZmQ29tbW9uUHJlZml4KHRleHRJbnNlcnQsIHRleHREZWxldGUpO1xuXG5cdCAgICAgICAgICAgICAgaWYgKGNvbW1vbmxlbmd0aCAhPT0gMCkge1xuXHQgICAgICAgICAgICAgICAgaWYgKHBvaW50ZXIgLSBjb3VudERlbGV0ZSAtIGNvdW50SW5zZXJ0ID4gMCAmJiBkaWZmc1twb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydCAtIDFdWzBdID09PSBESUZGX0VRVUFMKSB7XG5cdCAgICAgICAgICAgICAgICAgIGRpZmZzW3BvaW50ZXIgLSBjb3VudERlbGV0ZSAtIGNvdW50SW5zZXJ0IC0gMV1bMV0gKz0gdGV4dEluc2VydC5zdWJzdHJpbmcoMCwgY29tbW9ubGVuZ3RoKTtcblx0ICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cdCAgICAgICAgICAgICAgICAgIGRpZmZzLnNwbGljZSgwLCAwLCBbRElGRl9FUVVBTCwgdGV4dEluc2VydC5zdWJzdHJpbmcoMCwgY29tbW9ubGVuZ3RoKV0pO1xuXHQgICAgICAgICAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICAgICAgICB9XG5cblx0ICAgICAgICAgICAgICAgIHRleHRJbnNlcnQgPSB0ZXh0SW5zZXJ0LnN1YnN0cmluZyhjb21tb25sZW5ndGgpO1xuXHQgICAgICAgICAgICAgICAgdGV4dERlbGV0ZSA9IHRleHREZWxldGUuc3Vic3RyaW5nKGNvbW1vbmxlbmd0aCk7XG5cdCAgICAgICAgICAgICAgfSAvLyBGYWN0b3Igb3V0IGFueSBjb21tb24gc3VmZml4aWVzLlxuXG5cblx0ICAgICAgICAgICAgICBjb21tb25sZW5ndGggPSB0aGlzLmRpZmZDb21tb25TdWZmaXgodGV4dEluc2VydCwgdGV4dERlbGV0ZSk7XG5cblx0ICAgICAgICAgICAgICBpZiAoY29tbW9ubGVuZ3RoICE9PSAwKSB7XG5cdCAgICAgICAgICAgICAgICBkaWZmc1twb2ludGVyXVsxXSA9IHRleHRJbnNlcnQuc3Vic3RyaW5nKHRleHRJbnNlcnQubGVuZ3RoIC0gY29tbW9ubGVuZ3RoKSArIGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgICAgICAgICAgdGV4dEluc2VydCA9IHRleHRJbnNlcnQuc3Vic3RyaW5nKDAsIHRleHRJbnNlcnQubGVuZ3RoIC0gY29tbW9ubGVuZ3RoKTtcblx0ICAgICAgICAgICAgICAgIHRleHREZWxldGUgPSB0ZXh0RGVsZXRlLnN1YnN0cmluZygwLCB0ZXh0RGVsZXRlLmxlbmd0aCAtIGNvbW1vbmxlbmd0aCk7XG5cdCAgICAgICAgICAgICAgfVxuXHQgICAgICAgICAgICB9IC8vIERlbGV0ZSB0aGUgb2ZmZW5kaW5nIHJlY29yZHMgYW5kIGFkZCB0aGUgbWVyZ2VkIG9uZXMuXG5cblxuXHQgICAgICAgICAgICBpZiAoY291bnREZWxldGUgPT09IDApIHtcblx0ICAgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciAtIGNvdW50SW5zZXJ0LCBjb3VudERlbGV0ZSArIGNvdW50SW5zZXJ0LCBbRElGRl9JTlNFUlQsIHRleHRJbnNlcnRdKTtcblx0ICAgICAgICAgICAgfSBlbHNlIGlmIChjb3VudEluc2VydCA9PT0gMCkge1xuXHQgICAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyIC0gY291bnREZWxldGUsIGNvdW50RGVsZXRlICsgY291bnRJbnNlcnQsIFtESUZGX0RFTEVURSwgdGV4dERlbGV0ZV0pO1xuXHQgICAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICAgIGRpZmZzLnNwbGljZShwb2ludGVyIC0gY291bnREZWxldGUgLSBjb3VudEluc2VydCwgY291bnREZWxldGUgKyBjb3VudEluc2VydCwgW0RJRkZfREVMRVRFLCB0ZXh0RGVsZXRlXSwgW0RJRkZfSU5TRVJULCB0ZXh0SW5zZXJ0XSk7XG5cdCAgICAgICAgICAgIH1cblxuXHQgICAgICAgICAgICBwb2ludGVyID0gcG9pbnRlciAtIGNvdW50RGVsZXRlIC0gY291bnRJbnNlcnQgKyAoY291bnREZWxldGUgPyAxIDogMCkgKyAoY291bnRJbnNlcnQgPyAxIDogMCkgKyAxO1xuXHQgICAgICAgICAgfSBlbHNlIGlmIChwb2ludGVyICE9PSAwICYmIGRpZmZzW3BvaW50ZXIgLSAxXVswXSA9PT0gRElGRl9FUVVBTCkge1xuXHQgICAgICAgICAgICAvLyBNZXJnZSB0aGlzIGVxdWFsaXR5IHdpdGggdGhlIHByZXZpb3VzIG9uZS5cblx0ICAgICAgICAgICAgZGlmZnNbcG9pbnRlciAtIDFdWzFdICs9IGRpZmZzW3BvaW50ZXJdWzFdO1xuXHQgICAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciwgMSk7XG5cdCAgICAgICAgICB9IGVsc2Uge1xuXHQgICAgICAgICAgICBwb2ludGVyKys7XG5cdCAgICAgICAgICB9XG5cblx0ICAgICAgICAgIGNvdW50SW5zZXJ0ID0gMDtcblx0ICAgICAgICAgIGNvdW50RGVsZXRlID0gMDtcblx0ICAgICAgICAgIHRleHREZWxldGUgPSBcIlwiO1xuXHQgICAgICAgICAgdGV4dEluc2VydCA9IFwiXCI7XG5cdCAgICAgICAgICBicmVhaztcblx0ICAgICAgfVxuXHQgICAgfVxuXG5cdCAgICBpZiAoZGlmZnNbZGlmZnMubGVuZ3RoIC0gMV1bMV0gPT09IFwiXCIpIHtcblx0ICAgICAgZGlmZnMucG9wKCk7IC8vIFJlbW92ZSB0aGUgZHVtbXkgZW50cnkgYXQgdGhlIGVuZC5cblx0ICAgIH0gLy8gU2Vjb25kIHBhc3M6IGxvb2sgZm9yIHNpbmdsZSBlZGl0cyBzdXJyb3VuZGVkIG9uIGJvdGggc2lkZXMgYnkgZXF1YWxpdGllc1xuXHQgICAgLy8gd2hpY2ggY2FuIGJlIHNoaWZ0ZWQgc2lkZXdheXMgdG8gZWxpbWluYXRlIGFuIGVxdWFsaXR5LlxuXHQgICAgLy8gZS5nOiBBPGlucz5CQTwvaW5zPkMgLT4gPGlucz5BQjwvaW5zPkFDXG5cblxuXHQgICAgY2hhbmdlcyA9IGZhbHNlO1xuXHQgICAgcG9pbnRlciA9IDE7IC8vIEludGVudGlvbmFsbHkgaWdub3JlIHRoZSBmaXJzdCBhbmQgbGFzdCBlbGVtZW50IChkb24ndCBuZWVkIGNoZWNraW5nKS5cblxuXHQgICAgd2hpbGUgKHBvaW50ZXIgPCBkaWZmcy5sZW5ndGggLSAxKSB7XG5cdCAgICAgIGlmIChkaWZmc1twb2ludGVyIC0gMV1bMF0gPT09IERJRkZfRVFVQUwgJiYgZGlmZnNbcG9pbnRlciArIDFdWzBdID09PSBESUZGX0VRVUFMKSB7XG5cdCAgICAgICAgZGlmZlBvaW50ZXIgPSBkaWZmc1twb2ludGVyXVsxXTtcblx0ICAgICAgICBwb3NpdGlvbiA9IGRpZmZQb2ludGVyLnN1YnN0cmluZyhkaWZmUG9pbnRlci5sZW5ndGggLSBkaWZmc1twb2ludGVyIC0gMV1bMV0ubGVuZ3RoKTsgLy8gVGhpcyBpcyBhIHNpbmdsZSBlZGl0IHN1cnJvdW5kZWQgYnkgZXF1YWxpdGllcy5cblxuXHQgICAgICAgIGlmIChwb3NpdGlvbiA9PT0gZGlmZnNbcG9pbnRlciAtIDFdWzFdKSB7XG5cdCAgICAgICAgICAvLyBTaGlmdCB0aGUgZWRpdCBvdmVyIHRoZSBwcmV2aW91cyBlcXVhbGl0eS5cblx0ICAgICAgICAgIGRpZmZzW3BvaW50ZXJdWzFdID0gZGlmZnNbcG9pbnRlciAtIDFdWzFdICsgZGlmZnNbcG9pbnRlcl1bMV0uc3Vic3RyaW5nKDAsIGRpZmZzW3BvaW50ZXJdWzFdLmxlbmd0aCAtIGRpZmZzW3BvaW50ZXIgLSAxXVsxXS5sZW5ndGgpO1xuXHQgICAgICAgICAgZGlmZnNbcG9pbnRlciArIDFdWzFdID0gZGlmZnNbcG9pbnRlciAtIDFdWzFdICsgZGlmZnNbcG9pbnRlciArIDFdWzFdO1xuXHQgICAgICAgICAgZGlmZnMuc3BsaWNlKHBvaW50ZXIgLSAxLCAxKTtcblx0ICAgICAgICAgIGNoYW5nZXMgPSB0cnVlO1xuXHQgICAgICAgIH0gZWxzZSBpZiAoZGlmZlBvaW50ZXIuc3Vic3RyaW5nKDAsIGRpZmZzW3BvaW50ZXIgKyAxXVsxXS5sZW5ndGgpID09PSBkaWZmc1twb2ludGVyICsgMV1bMV0pIHtcblx0ICAgICAgICAgIC8vIFNoaWZ0IHRoZSBlZGl0IG92ZXIgdGhlIG5leHQgZXF1YWxpdHkuXG5cdCAgICAgICAgICBkaWZmc1twb2ludGVyIC0gMV1bMV0gKz0gZGlmZnNbcG9pbnRlciArIDFdWzFdO1xuXHQgICAgICAgICAgZGlmZnNbcG9pbnRlcl1bMV0gPSBkaWZmc1twb2ludGVyXVsxXS5zdWJzdHJpbmcoZGlmZnNbcG9pbnRlciArIDFdWzFdLmxlbmd0aCkgKyBkaWZmc1twb2ludGVyICsgMV1bMV07XG5cdCAgICAgICAgICBkaWZmcy5zcGxpY2UocG9pbnRlciArIDEsIDEpO1xuXHQgICAgICAgICAgY2hhbmdlcyA9IHRydWU7XG5cdCAgICAgICAgfVxuXHQgICAgICB9XG5cblx0ICAgICAgcG9pbnRlcisrO1xuXHQgICAgfSAvLyBJZiBzaGlmdHMgd2VyZSBtYWRlLCB0aGUgZGlmZiBuZWVkcyByZW9yZGVyaW5nIGFuZCBhbm90aGVyIHNoaWZ0IHN3ZWVwLlxuXG5cblx0ICAgIGlmIChjaGFuZ2VzKSB7XG5cdCAgICAgIHRoaXMuZGlmZkNsZWFudXBNZXJnZShkaWZmcyk7XG5cdCAgICB9XG5cdCAgfTtcblxuXHQgIHJldHVybiBmdW5jdGlvbiAobywgbikge1xuXHQgICAgdmFyIGRpZmYsIG91dHB1dCwgdGV4dDtcblx0ICAgIGRpZmYgPSBuZXcgRGlmZk1hdGNoUGF0Y2goKTtcblx0ICAgIG91dHB1dCA9IGRpZmYuRGlmZk1haW4obywgbik7XG5cdCAgICBkaWZmLmRpZmZDbGVhbnVwRWZmaWNpZW5jeShvdXRwdXQpO1xuXHQgICAgdGV4dCA9IGRpZmYuZGlmZlByZXR0eUh0bWwob3V0cHV0KTtcblx0ICAgIHJldHVybiB0ZXh0O1xuXHQgIH07XG5cdH0oKTtcblxufSgoZnVuY3Rpb24oKSB7IHJldHVybiB0aGlzOyB9KCkpKSk7XG4iLCJ2YXIgbmV4dFRpY2sgPSByZXF1aXJlKCdwcm9jZXNzL2Jyb3dzZXIuanMnKS5uZXh0VGljaztcbnZhciBhcHBseSA9IEZ1bmN0aW9uLnByb3RvdHlwZS5hcHBseTtcbnZhciBzbGljZSA9IEFycmF5LnByb3RvdHlwZS5zbGljZTtcbnZhciBpbW1lZGlhdGVJZHMgPSB7fTtcbnZhciBuZXh0SW1tZWRpYXRlSWQgPSAwO1xuXG4vLyBET00gQVBJcywgZm9yIGNvbXBsZXRlbmVzc1xuXG5leHBvcnRzLnNldFRpbWVvdXQgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0VGltZW91dCwgd2luZG93LCBhcmd1bWVudHMpLCBjbGVhclRpbWVvdXQpO1xufTtcbmV4cG9ydHMuc2V0SW50ZXJ2YWwgPSBmdW5jdGlvbigpIHtcbiAgcmV0dXJuIG5ldyBUaW1lb3V0KGFwcGx5LmNhbGwoc2V0SW50ZXJ2YWwsIHdpbmRvdywgYXJndW1lbnRzKSwgY2xlYXJJbnRlcnZhbCk7XG59O1xuZXhwb3J0cy5jbGVhclRpbWVvdXQgPVxuZXhwb3J0cy5jbGVhckludGVydmFsID0gZnVuY3Rpb24odGltZW91dCkgeyB0aW1lb3V0LmNsb3NlKCk7IH07XG5cbmZ1bmN0aW9uIFRpbWVvdXQoaWQsIGNsZWFyRm4pIHtcbiAgdGhpcy5faWQgPSBpZDtcbiAgdGhpcy5fY2xlYXJGbiA9IGNsZWFyRm47XG59XG5UaW1lb3V0LnByb3RvdHlwZS51bnJlZiA9IFRpbWVvdXQucHJvdG90eXBlLnJlZiA9IGZ1bmN0aW9uKCkge307XG5UaW1lb3V0LnByb3RvdHlwZS5jbG9zZSA9IGZ1bmN0aW9uKCkge1xuICB0aGlzLl9jbGVhckZuLmNhbGwod2luZG93LCB0aGlzLl9pZCk7XG59O1xuXG4vLyBEb2VzIG5vdCBzdGFydCB0aGUgdGltZSwganVzdCBzZXRzIHVwIHRoZSBtZW1iZXJzIG5lZWRlZC5cbmV4cG9ydHMuZW5yb2xsID0gZnVuY3Rpb24oaXRlbSwgbXNlY3MpIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IG1zZWNzO1xufTtcblxuZXhwb3J0cy51bmVucm9sbCA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuICBpdGVtLl9pZGxlVGltZW91dCA9IC0xO1xufTtcblxuZXhwb3J0cy5fdW5yZWZBY3RpdmUgPSBleHBvcnRzLmFjdGl2ZSA9IGZ1bmN0aW9uKGl0ZW0pIHtcbiAgY2xlYXJUaW1lb3V0KGl0ZW0uX2lkbGVUaW1lb3V0SWQpO1xuXG4gIHZhciBtc2VjcyA9IGl0ZW0uX2lkbGVUaW1lb3V0O1xuICBpZiAobXNlY3MgPj0gMCkge1xuICAgIGl0ZW0uX2lkbGVUaW1lb3V0SWQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uIG9uVGltZW91dCgpIHtcbiAgICAgIGlmIChpdGVtLl9vblRpbWVvdXQpXG4gICAgICAgIGl0ZW0uX29uVGltZW91dCgpO1xuICAgIH0sIG1zZWNzKTtcbiAgfVxufTtcblxuLy8gVGhhdCdzIG5vdCBob3cgbm9kZS5qcyBpbXBsZW1lbnRzIGl0IGJ1dCB0aGUgZXhwb3NlZCBhcGkgaXMgdGhlIHNhbWUuXG5leHBvcnRzLnNldEltbWVkaWF0ZSA9IHR5cGVvZiBzZXRJbW1lZGlhdGUgPT09IFwiZnVuY3Rpb25cIiA/IHNldEltbWVkaWF0ZSA6IGZ1bmN0aW9uKGZuKSB7XG4gIHZhciBpZCA9IG5leHRJbW1lZGlhdGVJZCsrO1xuICB2YXIgYXJncyA9IGFyZ3VtZW50cy5sZW5ndGggPCAyID8gZmFsc2UgOiBzbGljZS5jYWxsKGFyZ3VtZW50cywgMSk7XG5cbiAgaW1tZWRpYXRlSWRzW2lkXSA9IHRydWU7XG5cbiAgbmV4dFRpY2soZnVuY3Rpb24gb25OZXh0VGljaygpIHtcbiAgICBpZiAoaW1tZWRpYXRlSWRzW2lkXSkge1xuICAgICAgLy8gZm4uY2FsbCgpIGlzIGZhc3RlciBzbyB3ZSBvcHRpbWl6ZSBmb3IgdGhlIGNvbW1vbiB1c2UtY2FzZVxuICAgICAgLy8gQHNlZSBodHRwOi8vanNwZXJmLmNvbS9jYWxsLWFwcGx5LXNlZ3VcbiAgICAgIGlmIChhcmdzKSB7XG4gICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZm4uY2FsbChudWxsKTtcbiAgICAgIH1cbiAgICAgIC8vIFByZXZlbnQgaWRzIGZyb20gbGVha2luZ1xuICAgICAgZXhwb3J0cy5jbGVhckltbWVkaWF0ZShpZCk7XG4gICAgfVxuICB9KTtcblxuICByZXR1cm4gaWQ7XG59O1xuXG5leHBvcnRzLmNsZWFySW1tZWRpYXRlID0gdHlwZW9mIGNsZWFySW1tZWRpYXRlID09PSBcImZ1bmN0aW9uXCIgPyBjbGVhckltbWVkaWF0ZSA6IGZ1bmN0aW9uKGlkKSB7XG4gIGRlbGV0ZSBpbW1lZGlhdGVJZHNbaWRdO1xufTsiLCIvKlxuICAgIEkxOE5Eb21haW4gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIEkxOE5Eb21haW4gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHV0VG9BdXRvRGVmaW5lSGVscGVyID0gZnVuY3Rpb24oIHNjb3BlLCBhdXRvRGVmaW5lSGVscGVyICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbmV3U3RyaW5nID0gc3RyaW5nO1xuICAgICAgICB2YXIgY29uZiA9IGNvbnRleHQuZ2V0Q29uZigpO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIHRoZSBkb21haW5zIGRlZmluZWQgcHJldmlvdXNseVxuICAgICAgICB2YXIgcHJldmlvdXNWYWx1ZSA9IHNjb3BlLmdldCggY29uZi5pMThuRG9tYWluVmFyTmFtZSApO1xuICAgICAgICBpZiAoIHByZXZpb3VzVmFsdWUgKSB7XG4gICAgICAgICAgICBuZXdTdHJpbmcgKz0gY29uZi5pbkRlZmluZURlbGltaXRlciArIGNvbmYuaTE4bkRvbWFpblZhck5hbWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBicmFja2V0cyBpZiBub3QgcHJlc2VudFxuICAgICAgICBpZiAoIG5ld1N0cmluZ1sgMCBdICE9PSAnWycgKXtcbiAgICAgICAgICAgIG5ld1N0cmluZyA9ICdbJyArIG5ld1N0cmluZyArICddJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQWRkIGkxOG5Eb21haW5WYXJOYW1lIHRvIHRoZSBhdXRvRGVmaW5lSGVscGVyXG4gICAgICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KFxuICAgICAgICAgICAgY29uZi5pMThuRG9tYWluVmFyTmFtZSxcbiAgICAgICAgICAgIG5ld1N0cmluZ1xuICAgICAgICApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwdXRUb0F1dG9EZWZpbmVIZWxwZXI6IHB1dFRvQXV0b0RlZmluZUhlbHBlcixcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IEkxOE5Eb21haW4uaWRcbiAgICB9O1xufTtcblxuSTE4TkRvbWFpbi5pZCA9ICdpMThuOmRvbWFpbic7XG5cbkkxOE5Eb21haW4uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHJldHVybiBzdHJpbmc/IG5ldyBJMThORG9tYWluKCBzdHJpbmcudHJpbSgpICk6IG51bGw7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEkxOE5Eb21haW47XG4iLCIvKlxuICAgIEkxOG5MYW5ndWFnZSBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xuXG52YXIgSTE4Tkxhbmd1YWdlID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIHB1dFRvQXV0b0RlZmluZUhlbHBlciA9IGZ1bmN0aW9uKCBhdXRvRGVmaW5lSGVscGVyICl7XG5cbiAgICAgICAgLy8gQWRkIGkxOG5MYW5ndWFnZVZhck5hbWUgdG8gdGhlIGF1dG9EZWZpbmVIZWxwZXJcbiAgICAgICAgYXV0b0RlZmluZUhlbHBlci5wdXQoXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5pMThuTGFuZ3VhZ2VWYXJOYW1lLFxuICAgICAgICAgICAgc3RyaW5nXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIkkxOE5MYW5ndWFnZTogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwdXRUb0F1dG9EZWZpbmVIZWxwZXI6IHB1dFRvQXV0b0RlZmluZUhlbHBlcixcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IEkxOE5MYW5ndWFnZS5pZFxuICAgIH07XG59O1xuXG5JMThOTGFuZ3VhZ2UuaWQgPSAnaTE4bjpsYW5ndWFnZSc7XG5cbkkxOE5MYW5ndWFnZS5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgcmV0dXJuIHN0cmluZz8gbmV3IEkxOE5MYW5ndWFnZSggc3RyaW5nLnRyaW0oKSApOiBudWxsO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBJMThOTGFuZ3VhZ2U7XG4iLCIvKlxuICAgIE1FVEFMRGVmaW5lTWFjcm8gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIE1FVEFMRGVmaW5lTWFjcm8gPSBmdW5jdGlvbiggbmFtZVRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSwgbm9kZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gSGlkZSBtYWNybyBkZWZpbml0aW9uc1xuICAgICAgICBub2RlLnN0eWxlLmRpc3BsYXkgPSAnbm9uZSc7XG5cbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiTUVUQUxEZWZpbmVNYWNybzogXCIgKyBuYW1lO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogTUVUQUxEZWZpbmVNYWNyby5pZFxuICAgIH07XG59O1xuXG5NRVRBTERlZmluZU1hY3JvLmlkID0gJ21ldGFsOmRlZmluZS1tYWNybyc7XG5cbk1FVEFMRGVmaW5lTWFjcm8uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHJldHVybiBuZXcgTUVUQUxEZWZpbmVNYWNybyggc3RyaW5nLnRyaW0oKSApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBNRVRBTERlZmluZU1hY3JvO1xuIiwiLypcbiAgICBNRVRBTEZpbGxTbG90IGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBNRVRBTEZpbGxTbG90ID0gZnVuY3Rpb24oIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfdXNlTWFjcm9Ob2RlICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBfc3RyaW5nO1xuICAgIHZhciBleHByZXNzaW9uID0gX2V4cHJlc3Npb247XG4gICAgdmFyIHVzZU1hY3JvTm9kZSA9IF91c2VNYWNyb05vZGU7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggdW5kZWZpbmVkLCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCBwYXJzZXJVcGRhdGVyICl7XG4gICAgICAgIHBhcnNlclVwZGF0ZXIudXBkYXRlTm9kZSggdXNlTWFjcm9Ob2RlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJNRVRBTEZpbGxTbG90OiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBNRVRBTEZpbGxTbG90LmlkXG4gICAgfTtcbn07XG5cbk1FVEFMRmlsbFNsb3QuaWQgPSAnbWV0YWw6ZmlsbC1zbG90JztcblxuTUVUQUxGaWxsU2xvdC5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHVzZU1hY3JvTm9kZSApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBNRVRBTEZpbGxTbG90KCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzdHJpbmcgKSxcbiAgICAgICAgICAgIHVzZU1hY3JvTm9kZVxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE1FVEFMRmlsbFNsb3Q7XG4iLCIvKlxuICAgIE1FVEFMVXNlTWFjcm8gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlSW5kZXguanMnICk7XG52YXIgYXR0cmlidXRlQ2FjaGUgPSByZXF1aXJlKCAnLi4vLi4vY2FjaGUvYXR0cmlidXRlQ2FjaGUuanMnICk7XG52YXIgVEFMRGVmaW5lID0gcmVxdWlyZSggJy4uL1RBTC90YWxEZWZpbmUuanMnICk7XG52YXIgTUVUQUxGaWxsU2xvdCA9IHJlcXVpcmUoICcuL21ldGFsRmlsbFNsb3QuanMnICk7XG52YXIgcmVzb2x2ZXIgPSByZXF1aXJlKCAnLi4vLi4vcmVzb2x2ZXIuanMnICk7XG5cbnZhciBNRVRBTFVzZU1hY3JvID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIG1hY3JvRXhwcmVzc2lvblRvQXBwbHksIGRlZmluZVRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIG1hY3JvRXhwcmVzc2lvbiA9IG1hY3JvRXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIGRlZmluZSA9IGRlZmluZVRvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUsIGF1dG9EZWZpbmVIZWxwZXIsIGluZGV4RXhwcmVzc2lvbnMgKXtcblxuICAgICAgICAvLyBJbml0IHNvbWUgdmFyc1xuICAgICAgICB2YXIgbWFjcm9LZXkgPSByZXNvbHZlci5nZXRNYWNyb0tleSggbWFjcm9FeHByZXNzaW9uLCBzY29wZSApO1xuICAgICAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xuICAgICAgICB2YXIgbmV3Tm9kZSA9IHJlc29sdmVyLmdldE5vZGUoIG1hY3JvS2V5LCBzY29wZSApOyBcbiAgICAgICAgXG4gICAgICAgIC8vIEhpZGUgdXNlIG1hY3JvIG5vZGVcbiAgICAgICAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuXG4gICAgICAgIC8vIFJlbW92ZSBzdHlsZSBhdHRyaWJ1dGUgdG8gZm9yY2Ugc2hvd2luZyB0aGUgbmV3IG5vZGVcbiAgICAgICAgbmV3Tm9kZS5yZW1vdmVBdHRyaWJ1dGUoICdzdHlsZScgKTtcblxuICAgICAgICAvLyBVcGRhdGUgZGVmaW5lIGFuZCBhdXRvRGVmaW5lIGF0dHJpYnV0ZXMgb2YgdGhlIG5ldyBub2RlXG4gICAgICAgIHVwZGF0ZU5ld05vZGVBdHRyaWJ1dGVzKCBtYWNyb0tleSwgbmV3Tm9kZSwgYXV0b0RlZmluZUhlbHBlciwgdGFncywgbm9kZSwgaW5kZXhFeHByZXNzaW9ucyApO1xuICAgICAgICBcbiAgICAgICAgLy8gRmlsbCBzbG90c1xuICAgICAgICBmaWxsU2xvdHMoIHNjb3BlLCBub2RlLCB0YWdzLCBuZXdOb2RlLCBpbmRleEV4cHJlc3Npb25zICk7XG5cbiAgICAgICAgLy8gQWRkIHRoZSBtYWNybyBub2RlXG4gICAgICAgIG5vZGUucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoIG5ld05vZGUsIG5vZGUubmV4dFNpYmxpbmcgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBuZXdOb2RlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZU5ld05vZGVBdHRyaWJ1dGVzID0gZnVuY3Rpb24oIG1hY3JvS2V5LCBuZXdOb2RlLCBhdXRvRGVmaW5lSGVscGVyLCB0YWdzLCBub2RlLCBpbmRleEV4cHJlc3Npb25zICl7XG5cbiAgICAgICAgLy8gVXBkYXRlIHRoZSB0YWxEZWZpbmUgYXR0cmlidXRlXG4gICAgICAgIFRBTERlZmluZS51cGRhdGVBdHRyaWJ1dGUoIG5ld05vZGUsIGRlZmluZSApO1xuICAgICAgICBcbiAgICAgICAgLy8gVXBkYXRlIHRoZSB0YWxBdXRvRGVmaW5lIGF0dHJpYnV0ZVxuICAgICAgICB2YXIgbWFjcm9EYXRhID0gcmVzb2x2ZXIuZ2V0TWFjcm9EYXRhKCBtYWNyb0tleSApO1xuICAgICAgICBpZiAoIG1hY3JvRGF0YS51cmwgKXtcbiAgICAgICAgICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHRlcm5hbE1hY3JvVXJsVmFyTmFtZSwgXG4gICAgICAgICAgICAgICAgXCInXCIgKyBtYWNyb0RhdGEudXJsICsgXCInXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnVwZGF0ZU5vZGUoIG5ld05vZGUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gU2V0IHJlbGF0ZWQgaWQgYXR0cmlidXRlIGlmIG5lZWRlZFxuICAgICAgICBpZiAoIGluZGV4RXhwcmVzc2lvbnMgKXtcbiAgICAgICAgICAgIG5ld05vZGUuc2V0QXR0cmlidXRlKCBcbiAgICAgICAgICAgICAgICB0YWdzLnJlbGF0ZWRJZCwgXG4gICAgICAgICAgICAgICAgbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaWQgKSBcbiAgICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBmaWxsU2xvdHMgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUsIHRhZ3MsIG5ld05vZGUsIGluZGV4RXhwcmVzc2lvbnMgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsaXN0ID0gbm9kZS5xdWVyeVNlbGVjdG9yQWxsKCBcbiAgICAgICAgICAgIFwiW1wiICsgcmVzb2x2ZXIuZmlsdGVyU2VsZWN0b3IoIHRhZ3MubWV0YWxGaWxsU2xvdCApICsgXCJdXCJcbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGVsZW1lbnQ7XG4gICAgICAgIHZhciBwb3MgPSAwO1xuICAgICAgICB3aGlsZSAoIGVsZW1lbnQgPSBsaXN0WyBwb3MrKyBdICkge1xuICAgICAgICAgICAgdmFyIHNsb3RJZEV4cHJlc3Npb25TdHJpbmcgPSBlbGVtZW50LmdldEF0dHJpYnV0ZSggdGFncy5tZXRhbEZpbGxTbG90ICk7XG4gICAgICAgICAgICB2YXIgc2xvdElkRXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzbG90SWRFeHByZXNzaW9uU3RyaW5nICk7XG4gICAgICAgICAgICB2YXIgc2xvdElkID0gc2xvdElkRXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcblxuICAgICAgICAgICAgLy8gSW5kZXggZmlsbCBzbG90IGVsZW1lbnRcbiAgICAgICAgICAgIGlmICggaW5kZXhFeHByZXNzaW9ucyApe1xuICAgICAgICAgICAgICAgIHZhciBtZXRhbEZpbGxTbG90ID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXG4gICAgICAgICAgICAgICAgICAgIE1FVEFMRmlsbFNsb3QsIFxuICAgICAgICAgICAgICAgICAgICBzbG90SWRFeHByZXNzaW9uU3RyaW5nLCBcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudCxcbiAgICAgICAgICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gTUVUQUxGaWxsU2xvdC5idWlsZCggc2xvdElkRXhwcmVzc2lvblN0cmluZywgbm9kZSApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVJbmRleC5hZGQoIGVsZW1lbnQsIG1ldGFsRmlsbFNsb3QsIHNjb3BlICk7ICAgXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIC8vIERvIG5vdGhpbmcgaWYgc2xvdElkRXhwcmVzc2lvbiBldmFsdWF0ZXMgdG8gZmFsc2VcbiAgICAgICAgICAgIGlmICggISBzbG90SWQgKXtcbiAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHZhciBzbG90Q29udGVudCA9IGVsZW1lbnQuY2xvbmVOb2RlKCB0cnVlICk7XG4gICAgICAgICAgICB2YXIgY3VycmVudE5vZGUgPSBuZXdOb2RlLnF1ZXJ5U2VsZWN0b3IoIFxuICAgICAgICAgICAgICAgIFwiW1wiICsgcmVzb2x2ZXIuZmlsdGVyU2VsZWN0b3IoIHRhZ3MubWV0YWxEZWZpbmVTbG90ICkgKyBcIj0nXCIgKyBzbG90SWQgKyBcIiddXCJcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBpZiAoICEgY3VycmVudE5vZGUgKXtcbiAgICAgICAgICAgICAgICB0aHJvdyAnU2xvdCBcIicgKyBzbG90SWQgKyAnXCIgaW4gZXhwcmVzc2lvbiBcIicgKyBzbG90SWRFeHByZXNzaW9uU3RyaW5nICsnXCIgbm90IGZvdW5kISc7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjdXJyZW50Tm9kZS5wYXJlbnROb2RlLmluc2VydEJlZm9yZSggXG4gICAgICAgICAgICAgICAgc2xvdENvbnRlbnQsIFxuICAgICAgICAgICAgICAgIGN1cnJlbnROb2RlLm5leHRTaWJsaW5nXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgc2xvdENvbnRlbnQucmVtb3ZlQXR0cmlidXRlKCB0YWdzLm1ldGFsRmlsbFNsb3QgKTtcbiAgICAgICAgICAgIHNsb3RDb250ZW50LnNldEF0dHJpYnV0ZSggdGFncy5pZCwgY29udGV4dC5uZXh0RXhwcmVzc2lvbkNvdW50ZXIoKSApOyAvLyBTZXQgYSBuZXcgaWQgYXR0cmlidXRlIHRvIGF2b2lkIGlkIGNvbmZsaWN0c1xuICAgICAgICAgICAgY3VycmVudE5vZGUucmVtb3ZlKCk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBtYWNyb0V4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiggcGFyc2VyVXBkYXRlciwgbm9kZSApe1xuICAgICAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIG5vZGUgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIk1FVEFMVXNlTWFjcm86IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IE1FVEFMVXNlTWFjcm8uaWRcbiAgICB9O1xufTtcblxuTUVUQUxVc2VNYWNyby5pZCA9ICdtZXRhbDp1c2UtbWFjcm8nO1xuXG5NRVRBTFVzZU1hY3JvLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZywgc3RyaW5nRGVmaW5lICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICByZXR1cm4gbmV3IE1FVEFMVXNlTWFjcm8oIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0cmluZy50cmltKCkgKSxcbiAgICAgICAgICAgIHN0cmluZ0RlZmluZT8gc3RyaW5nRGVmaW5lLnRyaW0oKTogdW5kZWZpbmVkXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTUVUQUxVc2VNYWNybztcbiIsIi8qIFxuICAgIGNvbnRlbnRIZWxwZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuXG4gICAgdmFyIGZvcm1JbnB1dEhhc0JvZHkgPSB7XG4gICAgICAgIEJVVFRPTjogMSxcbiAgICAgICAgTEFCRUw6IDEsXG4gICAgICAgIExFR0VORDogMSxcbiAgICAgICAgRklFTERTRVQ6IDEsXG4gICAgICAgIE9QVElPTjogMVxuICAgIH07XG4gICAgXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIHRhZywgc3RyaW5nLCBjb25zdHJ1Y3RvckZ1bmN0aW9uICkge1xuXG4gICAgICAgIC8vIFByb2Nlc3MgaXRcbiAgICAgICAgdmFyIGNvbnRlbnQgPSBzdHJpbmcudHJpbSgpO1xuXG4gICAgICAgIC8vIENoZWNrIGlmIGlzIGFuIEhUTUwgZXhwcmVzc2lvblxuICAgICAgICB2YXIgc3RydWN0dXJlID0gY29udGVudC5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5odG1sU3RydWN0dXJlRXhwcmVzc2lvblByZWZpeCArICcgJyApID09PSAwO1xuICAgICAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IHN0cnVjdHVyZT8gXG4gICAgICAgICAgICBjb250ZW50LnN1YnN0ciggMSArIGNvbnRleHQuZ2V0Q29uZigpLmh0bWxTdHJ1Y3R1cmVFeHByZXNzaW9uUHJlZml4Lmxlbmd0aCApOiBcbiAgICAgICAgICAgIGNvbnRlbnQ7XG4gICAgICAgIGlmICggISBleHByZXNzaW9uU3RyaW5nICl7XG4gICAgICAgICAgICB0aHJvdyB0YWcgKyAnIGV4cHJlc3Npb24gdm9pZC4nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29uc3RydWN0b3JGdW5jdGlvbihcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBleHByZXNzaW9uU3RyaW5nICksXG4gICAgICAgICAgICBzdHJ1Y3R1cmUsXG4gICAgICAgICAgICBleHByZXNzaW9uU3RyaW5nXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlTm9kZSA9IGZ1bmN0aW9uKCBub2RlLCBzdHJ1Y3R1cmUsIGV2YWx1YXRlZCApe1xuXG4gICAgICAgIC8vIENoZWNrIGRlZmF1bHRcbiAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5pc0RlZmF1bHQoIGV2YWx1YXRlZCApICl7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIG5vdGhpbmdcbiAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5pc05vdGhpbmcoIGV2YWx1YXRlZCApICl7XG4gICAgICAgICAgICBldmFsdWF0ZWQgPSBcIlwiO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQWRkIGl0IHRvIG5vZGVcbiAgICAgICAgbm9kZS5pbm5lckhUTUwgPSBldmFsdWF0ZWQ7XG4gICAgICAgIGlmICggISBzdHJ1Y3R1cmUgKSB7XG4gICAgICAgICAgICBub2RlWyBcImZvcm1cIiBpbiBub2RlICYmICFmb3JtSW5wdXRIYXNCb2R5WyBub2RlLnRhZ05hbWUgXSA/IFwidmFsdWVcIjogXCJpbm5lclRleHRcIiBdID0gZXZhbHVhdGVkO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBidWlsZDogYnVpbGQsXG4gICAgICAgIHVwZGF0ZU5vZGU6IHVwZGF0ZU5vZGVcbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgVEFMQXR0cmlidXRlcyBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vdXRpbHMuanMnICk7XG5cbnZhciBUQUxBdHRyaWJ1dGVzID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGF0dHJpYnV0ZUl0ZW1zVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgYXR0cmlidXRlSXRlbXMgPSBhdHRyaWJ1dGVJdGVtc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUsIGF0dHJpYnV0ZU5hbWUgKXtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZUl0ZW1zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZUl0ZW0gPSBhdHRyaWJ1dGVJdGVtc1sgaSBdO1xuICAgICAgICAgICAgdmFyIG5hbWUgPSBhdHRyaWJ1dGVJdGVtLm5hbWU7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICggISBhdHRyaWJ1dGVOYW1lIHx8IG5hbWUgPT09IGF0dHJpYnV0ZU5hbWUgKXtcbiAgICAgICAgICAgICAgICB2YXIgdmFsdWUgPSBhdHRyaWJ1dGVJdGVtLmV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG5cbiAgICAgICAgICAgICAgICBpZiAoIG5hbWUgKXtcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc1NpbXBsZUF0dHJpYnV0ZUl0ZW0oIG5vZGUsIG5hbWUsIHZhbHVlICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgcHJvY2Vzc01hcEF0dHJpYnV0ZUl0ZW0oIG5vZGUsIHZhbHVlICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBwcm9jZXNzTWFwQXR0cmlidXRlSXRlbSA9IGZ1bmN0aW9uKCBub2RlLCBtYXAgKXtcbiAgICBcbiAgICAgICAgLy8gRG8gbm90aGluZyBpZiBtYXAgaXMgbnVsbFxuICAgICAgICBpZiAoICEgbWFwICl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggISB1dGlscy5pc1BsYWluT2JqZWN0KCBtYXAgKSApe1xuICAgICAgICAgICAgdGhyb3cgJ0ludmFsaWQgYXR0cmlidXRlIHZhbHVlOiBcIicgKyBtYXAgKyAnXCIuIE9iamVjdCBleHBlY3RlZC4nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgbmFtZSBpbiBtYXAgKXtcbiAgICAgICAgICAgIHZhciB2YWx1ZSA9IG1hcFsgbmFtZSBdO1xuICAgICAgICAgICAgcHJvY2Vzc1NpbXBsZUF0dHJpYnV0ZUl0ZW0oIG5vZGUsIG5hbWUsIHZhbHVlICk7XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBwcm9jZXNzU2ltcGxlQXR0cmlidXRlSXRlbSA9IGZ1bmN0aW9uKCBub2RlLCBuYW1lLCB2YWx1ZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gQm9vbGVhbiBhdHRyaWJ1dGVzXG4gICAgICAgIGlmICggY29udGV4dC5pc0Jvb2xlYW5BdHRyaWJ1dGUoIG5hbWUgKSApe1xuICAgICAgICAgICAgaWYgKCB2YWx1ZSApe1xuICAgICAgICAgICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCBuYW1lLCAnJyApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggbmFtZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBJZiB2YWx1ZSBpcyB1bmRlZmluZWQgZG9uJ3QgcGFyc2VyIHRoZSBhdHRyaWJ1dGVcbiAgICAgICAgaWYgKCB2YWx1ZSA9PSB1bmRlZmluZWQgKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAvLyBBbHQgYXR0cmlidXRlc1xuICAgICAgICBpZiAoIGNvbnRleHQuaXNBbHRBdHRyaWJ1dGUoIG5hbWUgKSApIHtcbiAgICAgICAgICAgIHN3aXRjaCAoIG5hbWUgKSB7XG4gICAgICAgICAgICBjYXNlIFwiaW5uZXJIVE1MXCI6XG4gICAgICAgICAgICAgICAgdGhyb3cgbm9kZTsgLy8gc2hvdWxkIHVzZSBcInF0ZXh0XCJcbiAgICAgICAgICAgIGNhc2UgXCJzdHlsZVwiOlxuICAgICAgICAgICAgICAgIG5vZGUuc3R5bGUuY3NzVGV4dCA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgLypcbiAgICAgICAgICAgIGNhc2UgXCJ0ZXh0XCI6XG4gICAgICAgICAgICAgICAgbm9kZVsgcXVlcnlTZWxlY3RvckFsbCA/IG5hbWUgOiBpbm5lclRleHQgXSA9IHZhbHVlO1xuICAgICAgICAgICAgICAgIGJyZWFrOyAvLyBvcHRpb24udGV4dCB1bnN0YWJsZSBpbiBJRVxuICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGNhc2UgXCJjbGFzc1wiOlxuICAgICAgICAgICAgICAgIG5hbWUgPSBcImNsYXNzTmFtZVwiO1xuICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICBub2RlWyBuYW1lIF0gPSB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfSBcblxuICAgICAgICAvLyBSZWd1bGFyIGF0dHJpYnV0ZXNcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIG5hbWUsIHZhbHVlICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcblxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBvYmplY3QgPSB7fTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGF0dHJpYnV0ZUl0ZW1zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGF0dHJpYnV0ZUl0ZW0gPSBhdHRyaWJ1dGVJdGVtc1sgaSBdO1xuICAgICAgICAgICAgdmFyIGRlcGVuZHNPbkxpc3QgPSBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggdW5kZWZpbmVkLCBzY29wZSwgYXR0cmlidXRlSXRlbS5leHByZXNzaW9uICk7XG4gICAgICAgICAgICBpZiAoIGRlcGVuZHNPbkxpc3QgJiYgZGVwZW5kc09uTGlzdC5sZW5ndGggPiAwICl7XG4gICAgICAgICAgICAgICAgb2JqZWN0WyBhdHRyaWJ1dGVJdGVtLm5hbWUgXSA9IGRlcGVuZHNPbkxpc3Q7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggT2JqZWN0LmtleXMoIG9iamVjdCApLmxlbmd0aCA+IDAgKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBvYmplY3QgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiggcGFyc2VyVXBkYXRlciwgbm9kZSwgc2NvcGUsIGluZGV4SXRlbSApe1xuICAgICAgICBwcm9jZXNzKCBzY29wZSwgbm9kZSwgaW5kZXhJdGVtLmdyb3VwSWQgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTEF0dHJpYnV0ZXM6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IFRBTEF0dHJpYnV0ZXMuaWRcbiAgICB9O1xufTtcblxuVEFMQXR0cmlidXRlcy5pZCA9ICd0YWw6YXR0cmlidXRlcyc7XG5cblRBTEF0dHJpYnV0ZXMuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuXG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBhdHRyaWJ1dGVJdGVtcyA9IFtdO1xuICAgIHZhciBleHByZXNzaW9uU3RyaW5nID0gc3RyaW5nLnRyaW0oKTtcbiAgICB2YXIgdG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgZXhwcmVzc2lvblN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5hdHRyaWJ1dGVEZWxpbWl0ZXIsIFxuICAgICAgICAgICAgdHJ1ZSApO1xuXG4gICAgd2hpbGUgKCB0b2tlbnMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB2YXIgYXR0cmlidXRlID0gdG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgdmFyIHNwYWNlID0gYXR0cmlidXRlLmluZGV4T2YoIGNvbnRleHQuZ2V0Q29uZigpLmluQXR0cmlidXRlRGVsaW1pdGVyICk7XG4gICAgICAgIGlmICggc3BhY2UgPT09IC0xICkge1xuICAgICAgICAgICAgYXR0cmlidXRlSXRlbXMucHVzaCh7XG4gICAgICAgICAgICAgICAgbmFtZTogdW5kZWZpbmVkLFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb246IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBhdHRyaWJ1dGUgKVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgdmFyIG5hbWUgPSBhdHRyaWJ1dGUuc3Vic3RyaW5nKCAwLCBzcGFjZSApO1xuICAgICAgICB2YXIgdmFsdWVFeHByZXNzaW9uID0gYXR0cmlidXRlLnN1YnN0cmluZyggc3BhY2UgKyAxICkudHJpbSgpO1xuXG4gICAgICAgIGF0dHJpYnV0ZUl0ZW1zLnB1c2goe1xuICAgICAgICAgICAgbmFtZTogbmFtZSxcbiAgICAgICAgICAgIGV4cHJlc3Npb246IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCB2YWx1ZUV4cHJlc3Npb24gKVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIG5ldyBUQUxBdHRyaWJ1dGVzKCBzdHJpbmcsIGF0dHJpYnV0ZUl0ZW1zICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTEF0dHJpYnV0ZXM7XG4iLCIvKlxuICAgIFRBTENvbmRpdGlvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIFRBTENvbmRpdGlvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVCb29sZWFuKCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgICAgICBcbiAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmNvbmRpdGlvblJlc3VsdCwgcmVzdWx0ICk7XG4gICAgICAgIG5vZGUuc3R5bGUuZGlzcGxheSA9IHJlc3VsdCA/ICcnIDogJ25vbmUnO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIHVuZGVmaW5lZCwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiggcGFyc2VyVXBkYXRlciwgbm9kZSApe1xuICAgICAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIG5vZGUsIHRydWUgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGFibGVGcm9tQWN0aW9uID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBzY29wZSA9IHBhcnNlclVwZGF0ZXIuZ2V0Tm9kZVNjb3BlKCBub2RlICk7XG4gICAgICAgIHZhciByZXN1bHQgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZUJvb2xlYW4oIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgICAgIHZhciB2YWx1ZUZyb21UYWcgPSAndHJ1ZScgPT09IG5vZGUuZ2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5jb25kaXRpb25SZXN1bHQgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQgIT09IHZhbHVlRnJvbVRhZztcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTENvbmRpdGlvbjogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHVwZGF0YWJsZUZyb21BY3Rpb246IHVwZGF0YWJsZUZyb21BY3Rpb24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMQ29uZGl0aW9uLmlkXG4gICAgfTtcbn07XG5cblRBTENvbmRpdGlvbi5pZCA9ICd0YWw6Y29uZGl0aW9uJztcblxuVEFMQ29uZGl0aW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBUQUxDb25kaXRpb24oIFxuICAgICAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc3RyaW5nICkgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMQ29uZGl0aW9uO1xuIiwiLypcbiAgICBUQUxDb250ZW50IGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciBjb250ZW50SGVscGVyID0gcmVxdWlyZSggJy4vY29udGVudEhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBUQUxDb250ZW50ID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5LCBzdHJ1Y3R1cmVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIHN0cnVjdHVyZSA9IHN0cnVjdHVyZVRvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUgKXtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBjb250ZW50SGVscGVyLnVwZGF0ZU5vZGUoIFxuICAgICAgICAgICAgbm9kZSwgXG4gICAgICAgICAgICBzdHJ1Y3R1cmUsIFxuICAgICAgICAgICAgZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVUb05vdE51bGwoIHNjb3BlLCBleHByZXNzaW9uICkgXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlclVwZGF0ZXIsIG5vZGUsIHNjb3BlICl7XG4gICAgICAgIHByb2Nlc3MoIHNjb3BlLCBub2RlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxDb250ZW50OiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxDb250ZW50LmlkXG4gICAgfTtcbn07XG5cblRBTENvbnRlbnQuaWQgPSAndGFsOmNvbnRlbnQnO1xuXG5UQUxDb250ZW50LmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICByZXR1cm4gY29udGVudEhlbHBlci5idWlsZCggXG4gICAgICAgICdUQUxDb250ZW50JyxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBmdW5jdGlvbiggX3N0cmluZywgX2V4cHJlc3Npb24sIF9zdHJ1Y3R1cmUgKXtcbiAgICAgICAgICAgIHJldHVybiBuZXcgVEFMQ29udGVudCggX3N0cmluZywgX2V4cHJlc3Npb24sIF9zdHJ1Y3R1cmUgKTtcbiAgICAgICAgfVxuICAgICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTENvbnRlbnQ7XG4iLCIvKlxuICAgIFRBTERlY2xhcmUgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xuXG52YXIgVEFMRGVjbGFyZSA9IGZ1bmN0aW9uKCBfc3RyaW5nLCBfZGVjbGFyZUl0ZW1zICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBfc3RyaW5nO1xuICAgIHZhciBkZWNsYXJlSXRlbXMgPSBfZGVjbGFyZUl0ZW1zO1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBhdXRvRGVmaW5lSGVscGVyICl7XG5cbiAgICAgICAgcHV0VmFyaWFibGVzKCBzY29wZSwgYXV0b0RlZmluZUhlbHBlciApO1xuXG4gICAgICAgIHJldHVybiBwcm9jZXNzRGVjbGFyZUl0ZW1zKCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHB1dFZhcmlhYmxlcyA9IGZ1bmN0aW9uKCBzY29wZSwgYXV0b0RlZmluZUhlbHBlciApIHtcbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBzdHJpY3RNb2RlVmFyTmFtZSB0byB0aGUgYXV0b0RlZmluZUhlbHBlciBpZiBuZWVkZWRcbiAgICAgICAgdmFyIHN0cmljdE1vZGVWYXJOYW1lID0gY29udGV4dC5nZXRDb25mKCkuc3RyaWN0TW9kZVZhck5hbWU7XG4gICAgICAgIGlmICggdHJ1ZSAhPT0gc2NvcGUuZ2V0KCBzdHJpY3RNb2RlVmFyTmFtZSApICl7XG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dCggc3RyaWN0TW9kZVZhck5hbWUsICd0cnVlJyApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBkZWNsYXJlZCBhbmQgcmVxdWlyZWRcbiAgICAgICAgdmFyIGRlY2xhcmVkVmFyc1Zhck5hbWUgPSBjb250ZXh0LmdldENvbmYoKS5kZWNsYXJlZFZhcnNWYXJOYW1lO1xuICAgICAgICB2YXIgZGVjbGFyZWQgPSBzY29wZS5nZXQoIGRlY2xhcmVkVmFyc1Zhck5hbWUgKSB8fCBbXTtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGVjbGFyZUl0ZW1zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGRlY2xhcmVJdGVtID0gZGVjbGFyZUl0ZW1zWyBpIF07XG4gICAgICAgICAgICBkZWNsYXJlZC5wdXNoKCBkZWNsYXJlSXRlbS5uYW1lICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEFkZCBkZWNsYXJlZFZhcnNWYXJOYW1lIHRvIHRoZSBhdXRvRGVmaW5lSGVscGVyXG4gICAgICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KCBcbiAgICAgICAgICAgIGRlY2xhcmVkVmFyc1Zhck5hbWUsIFxuICAgICAgICAgICAgZXhwcmVzc2lvbnNVdGlscy5idWlsZExpc3QoIGRlY2xhcmVkLCB0cnVlIClcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwcm9jZXNzRGVjbGFyZUl0ZW1zID0gZnVuY3Rpb24oIHNjb3BlICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGVycm9yc0FycmF5ID0gW107XG5cbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGVjbGFyZUl0ZW1zLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGRlY2xhcmVJdGVtID0gZGVjbGFyZUl0ZW1zWyBpIF07XG4gICAgICAgICAgICB2YXIgZXJyb3JzID0gY2hlY2tEZWNsYXJlSXRlbShcbiAgICAgICAgICAgICAgICBzY29wZSxcbiAgICAgICAgICAgICAgICBkZWNsYXJlSXRlbS5uYW1lLFxuICAgICAgICAgICAgICAgIGRlY2xhcmVJdGVtLnR5cGUsXG4gICAgICAgICAgICAgICAgZGVjbGFyZUl0ZW0ucmVxdWlyZWQsXG4gICAgICAgICAgICAgICAgZGVjbGFyZUl0ZW0uZGVmYXVsdFZhbHVlU3RyaW5nLFxuICAgICAgICAgICAgICAgIGRlY2xhcmVJdGVtLmRlZmF1bHRWYWx1ZUV4cHJlc3Npb25cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBlcnJvcnNBcnJheSA9IGVycm9yc0FycmF5LmNvbmNhdCggZXJyb3JzICk7XG4gICAgICAgIH1cblxuICAgICAgICBwcm9jZXNzRXJyb3JzQXJyYXkoIGVycm9yc0FycmF5ICk7XG5cbiAgICAgICAgcmV0dXJuIGVycm9yc0FycmF5Lmxlbmd0aCA9PT0gMDtcbiAgICB9O1xuXG4gICAgdmFyIGNoZWNrRGVjbGFyZUl0ZW0gPSBmdW5jdGlvbiggc2NvcGUsIG5hbWUsIHR5cGUsIHJlcXVpcmVkLCBkZWZhdWx0VmFsdWVTdHJpbmcsIGRlZmF1bHRWYWx1ZUV4cHJlc3Npb24gKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgZXJyb3JzQXJyYXkgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIHZhciB2YWx1ZSA9IHNjb3BlLmdldCggbmFtZSApO1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IGRlZmF1bHQgdmFsdWUgaWYgbmVlZGVkXG4gICAgICAgIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCAmJiBkZWZhdWx0VmFsdWVFeHByZXNzaW9uICE9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgIHZhciBzZXREZWZhdWx0VmFsdWVFcnJvciA9IHNldERlZmF1bHRWYWx1ZSggc2NvcGUsIG5hbWUsIHR5cGUsIGRlZmF1bHRWYWx1ZVN0cmluZywgZGVmYXVsdFZhbHVlRXhwcmVzc2lvbiApO1xuICAgICAgICAgICAgaWYgKCBzZXREZWZhdWx0VmFsdWVFcnJvciApe1xuICAgICAgICAgICAgICAgIGVycm9yc0FycmF5LnB1c2goIHNldERlZmF1bHRWYWx1ZUVycm9yICk7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGVycm9yc0FycmF5O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdmFsdWUgPSBzY29wZS5nZXQoIG5hbWUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgdHlwZVxuICAgICAgICB2YXIgdHlwZUNoZWNrRXJyb3IgPSBjaGVja1R5cGUoIG5hbWUsIHR5cGUsIHZhbHVlICk7XG4gICAgICAgIGlmICggdHlwZUNoZWNrRXJyb3IgKXtcbiAgICAgICAgICAgIGVycm9yc0FycmF5LnB1c2goIHR5cGVDaGVja0Vycm9yICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIHJlcXVpcmVkXG4gICAgICAgIHZhciByZXF1aXJlZENoZWNrRXJyb3IgPSBjaGVja1JlcXVpcmVkKCBuYW1lLCByZXF1aXJlZCwgdmFsdWUgKTtcbiAgICAgICAgaWYgKCByZXF1aXJlZENoZWNrRXJyb3IgKXtcbiAgICAgICAgICAgIGVycm9yc0FycmF5LnB1c2goIHJlcXVpcmVkQ2hlY2tFcnJvciApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXJyb3JzQXJyYXk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgY2hlY2tUeXBlID0gZnVuY3Rpb24oIG5hbWUsIGV4cGVjdGVkVHlwZSwgdmFsdWUgKSB7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgZXhwZWN0ZWRUeXBlICl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciByZWFsVHlwZSA9IGdldFR5cGVPZiggdmFsdWUgKTtcbiAgICAgICAgcmV0dXJuIHJlYWxUeXBlID09PSBleHBlY3RlZFR5cGUudG9Mb3dlckNhc2UoKT8gXG4gICAgICAgICAgICBmYWxzZTogXG4gICAgICAgICAgICAnRXhwZWN0ZWQgdmFsdWUgdHlwZSAoJyArIGV4cGVjdGVkVHlwZS50b0xvd2VyQ2FzZSgpICsgJykgb2YgJyArIG5hbWUgKyAnIHByb3BlcnR5IGRvZXMgbm90IG1hdGNoIHR5cGUgKCcgKyByZWFsVHlwZSArICcpLCB2YWx1ZSBpcyBcIicgKyB2YWx1ZSArICdcIi4nO1xuICAgIH07XG4gICAgXG4gICAgLypcbiAgICAgICAgdHlwZU9mKCk7ICAgICAgICAgICAgICAgICAgIC8vIHVuZGVmaW5lZFxuICAgICAgICB0eXBlT2YobnVsbCk7ICAgICAgICAgICAgICAgLy8gbnVsbFxuICAgICAgICB0eXBlT2YoTmFOKTsgICAgICAgICAgICAgICAgLy8gbnVtYmVyXG4gICAgICAgIHR5cGVPZig1KTsgICAgICAgICAgICAgICAgICAvLyBudW1iZXJcbiAgICAgICAgdHlwZU9mKFtdKTsgICAgICAgICAgICAgICAgIC8vIGFycmF5XG4gICAgICAgIHR5cGVPZignJyk7ICAgICAgICAgICAgICAgICAvLyBzdHJpbmdcbiAgICAgICAgdHlwZU9mKGZ1bmN0aW9uICgpIHt9KTsgICAgIC8vIGZ1bmN0aW9uXG4gICAgICAgIHR5cGVPZigvYS8pICAgICAgICAgICAgICAgICAvLyByZWdleHBcbiAgICAgICAgdHlwZU9mKG5ldyBEYXRlKCkpICAgICAgICAgIC8vIGRhdGVcbiAgICAgICAgdHlwZU9mKG5ldyBFcnJvcikgICAgICAgICAgIC8vIGVycm9yXG4gICAgICAgIHR5cGVPZihQcm9taXNlLnJlc29sdmUoKSkgICAvLyBwcm9taXNlXG4gICAgICAgIHR5cGVPZihmdW5jdGlvbiAqKCkge30pICAgICAvLyBnZW5lcmF0b3JmdW5jdGlvblxuICAgICAgICB0eXBlT2YobmV3IFdlYWtNYXAoKSkgICAgICAgLy8gd2Vha21hcFxuICAgICAgICB0eXBlT2YobmV3IE1hcCgpKSAgICAgICAgICAgLy8gbWFwXG4gICAgICAgIHR5cGVPZih7fSk7ICAgICAgICAgICAgICAgICAvLyBvYmplY3RcbiAgICAgICAgdHlwZU9mKG5ldyBNeUNvbnN0cnVjdG9yKCkpIC8vIE15Q29uc3RydWN0b3JcbiAgICAqL1xuICAgIHZhciBnZXRUeXBlT2YgPSBmdW5jdGlvbiggdmFsdWUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciB0ZW1wID0ge30udG9TdHJpbmcuY2FsbCggdmFsdWUgKS5zcGxpdCgnICcpWyAxIF0uc2xpY2UoIDAsIC0xICkudG9Mb3dlckNhc2UoKTtcbiAgICAgICAgcmV0dXJuIHRlbXAgPT09ICdvYmplY3QnPyBcbiAgICAgICAgICAgIHZhbHVlLmNvbnN0cnVjdG9yLm5hbWUudG9Mb3dlckNhc2UoKTogXG4gICAgICAgICAgICB0ZW1wO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGNoZWNrUmVxdWlyZWQgPSBmdW5jdGlvbiggbmFtZSwgcmVxdWlyZWQsIHZhbHVlICkge1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWUgPT09IHJlcXVpcmVkICYmIHZhbHVlID09PSB1bmRlZmluZWQ/IFxuICAgICAgICAgICAgJ1JlcXVpcmVkIHZhbHVlIG11c3Qgbm90IGJlIHVuZGVmaW5lZDogJyArIG5hbWU6XG4gICAgICAgICAgICBmYWxzZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBzZXREZWZhdWx0VmFsdWUgPSBmdW5jdGlvbiggc2NvcGUsIG5hbWUsIHR5cGUsIGRlZmF1bHRWYWx1ZVN0cmluZywgZGVmYXVsdFZhbHVlRXhwcmVzc2lvbiApIHtcbiAgICAgICAgXG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICB2YXIgZGVmYXVsdFZhbHVlID0gZGVmYXVsdFZhbHVlRXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgIHNjb3BlLnNldCggbmFtZSwgZGVmYXVsdFZhbHVlICk7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICBcbiAgICAgICAgfSBjYXRjaCAoIGUgKSB7XG4gICAgICAgICAgICByZXR1cm4gJ0Vycm9yIHRyeWluZyB0byBldmFsdWF0ZSBkZWZhdWx0IHZhbHVlIG9mIGZpZWxkICcgKyBuYW1lICsgJywgZXhwcmVzc2lvbiBbJyArIGRlZmF1bHRWYWx1ZVN0cmluZyArICddOiAnICsgZTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdmFyIHByb2Nlc3NFcnJvcnNBcnJheSA9IGZ1bmN0aW9uKCBlcnJvcnNBcnJheSApIHtcblxuICAgICAgICBpZiAoIGVycm9yc0FycmF5Lmxlbmd0aCA9PT0gMCApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB0aHJvdyBlcnJvcnNBcnJheTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gTm90aGluZyB0byBkb1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFwiVEFMRGVjbGFyZTogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMRGVjbGFyZS5pZFxuICAgIH07XG59O1xuXG5UQUxEZWNsYXJlLmlkID0gJ3RhbDpkZWNsYXJlJztcblxuVEFMRGVjbGFyZS5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG5cbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG5cbiAgICB2YXIgZGVjbGFyZUl0ZW1zID0gW107XG4gICAgdmFyIG9taXRUeXBlcyA9IFsgJ3VuZGVmaW5lZCcsICdudWxsJyBdO1xuICAgIFxuICAgIHZhciB0b2tlbnMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgIHN0cmluZy50cmltKCksIFxuICAgICAgICBjb250ZXh0LmdldENvbmYoKS5kZWNsYXJlRGVsaW1pdGVyLCBcbiAgICAgICAgdHJ1ZSBcbiAgICApO1xuXG4gICAgd2hpbGUgKCB0b2tlbnMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGluUHJvcFRva2VucyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHRva2Vucy5uZXh0VG9rZW4oKS50cmltKCksIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuaW5EZWNsYXJlRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIHRydWUgXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICB2YXIgbmFtZSA9IHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIHR5cGUgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBkZWZhdWx0VmFsdWVTdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciByZXF1aXJlZCA9IGZhbHNlO1xuICAgICAgICB2YXIgc3RhdGUgPSAxO1xuICAgICAgICB3aGlsZSAoIGluUHJvcFRva2Vucy5oYXNNb3JlVG9rZW5zKCkgKXtcbiAgICAgICAgICAgIHZhciBjdXJyZW50VG9rZW4gPSBpblByb3BUb2tlbnMubmV4dFRva2VuKCk7XG4gICAgICAgICAgICBpZiAoIFRBTERlY2xhcmUudG9rZW5Jc1JlcXVpcmVkKCBjdXJyZW50VG9rZW4gKSApe1xuICAgICAgICAgICAgICAgIHJlcXVpcmVkID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHN3aXRjaCAoIHN0YXRlICkge1xuICAgICAgICAgICAgICAgIGNhc2UgMTpcbiAgICAgICAgICAgICAgICAgICAgbmFtZSA9IGN1cnJlbnRUb2tlbjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAyOlxuICAgICAgICAgICAgICAgICAgICBpZiAoIC0xID09PSBvbWl0VHlwZXMuaW5kZXhPZiggY3VycmVudFRva2VuLnRvTG93ZXJDYXNlKCkgKSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZSA9IGN1cnJlbnRUb2tlbjsgICBcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlIDM6XG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHRWYWx1ZVN0cmluZyA9IGN1cnJlbnRUb2tlbjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgJ1RvbyBtYW55IGFyZ3VtZW50cyBpbiB0YWxEZWNsYXJlIGl0ZW06ICcgKyBzdHJpbmcudHJpbSgpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgKytzdGF0ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gVGhlIG5hbWUgaXMgdGhlIG9ubHkgcmVxdWlyZWQgZWxlbWVudFxuICAgICAgICBpZiAoICEgbmFtZSApe1xuICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGRlY2xhcmVJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgIG5hbWU6IG5hbWUsXG4gICAgICAgICAgICB0eXBlOiB0eXBlLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHJlcXVpcmVkLFxuICAgICAgICAgICAgZGVmYXVsdFZhbHVlU3RyaW5nOiBkZWZhdWx0VmFsdWVTdHJpbmcsXG4gICAgICAgICAgICBkZWZhdWx0VmFsdWVFeHByZXNzaW9uOiBkZWZhdWx0VmFsdWVTdHJpbmcgPT0gdW5kZWZpbmVkPyB1bmRlZmluZWQ6IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBkZWZhdWx0VmFsdWVTdHJpbmcgKVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFRBTERlY2xhcmUoIHN0cmluZywgZGVjbGFyZUl0ZW1zICk7XG59O1xuXG5UQUxEZWNsYXJlLnRva2VuSXNSZXF1aXJlZCA9IGZ1bmN0aW9uKCB0b2tlbiApIHtcbiAgICByZXR1cm4gXCJyZXF1aXJlZFwiID09PSB0b2tlbi50b0xvd2VyQ2FzZSgpO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxEZWNsYXJlO1xuIiwiLypcbiAgICBUQUxEZWZpbmUgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG5cbnZhciBUQUxEZWZpbmUgPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZGVmaW5lSXRlbXNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBkZWZpbmVJdGVtcyA9IGRlZmluZUl0ZW1zVG9BcHBseTtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSwgZm9yY2VHbG9iYWwgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIFVwZGF0ZSBzY29wZVxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBkZWZpbmVJdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBkZWZpbmVJdGVtID0gZGVmaW5lSXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHNjb3BlLnNldCggXG4gICAgICAgICAgICAgICAgICAgIGRlZmluZUl0ZW0ubmFtZSwgXG4gICAgICAgICAgICAgICAgICAgIGRlZmluZUl0ZW0ubm9jYWxsPyBkZWZpbmVJdGVtLmV4cHJlc3Npb246IGRlZmluZUl0ZW0uZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKSwgXG4gICAgICAgICAgICAgICAgICAgIGZvcmNlR2xvYmFsIHx8IGRlZmluZUl0ZW0uZ2xvYmFsLFxuICAgICAgICAgICAgICAgICAgICBkZWZpbmVJdGVtLm5vY2FsbCxcbiAgICAgICAgICAgICAgICAgICAgZGVmaW5lSXRlbS5leHByZXNzaW9uXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTERlZmluZTogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwcm9jZXNzOiBwcm9jZXNzLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdXBkYXRlOiB1cGRhdGUsXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZyxcbiAgICAgICAgdHlwZTogVEFMRGVmaW5lLmlkXG4gICAgfTtcbn07XG5cblRBTERlZmluZS5pZCA9ICd0YWw6ZGVmaW5lJztcblxuVEFMRGVmaW5lLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcblxuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcblxuICAgIHZhciBkZWZpbmVJdGVtcyA9IFtdO1xuICAgIHZhciBleHByZXNzaW9uU3RyaW5nID0gc3RyaW5nLnRyaW0oKTtcbiAgICB2YXIgdG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICBleHByZXNzaW9uU3RyaW5nLCBcbiAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZGVmaW5lRGVsaW1pdGVyLCBcbiAgICAgICAgdHJ1ZSApO1xuXG4gICAgd2hpbGUgKCB0b2tlbnMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB2YXIgdmFyaWFibGUgPSB0b2tlbnMubmV4dFRva2VuKCkudHJpbSgpO1xuICAgICAgICB2YXIgc3BhY2UgPSB2YXJpYWJsZS5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5pbkRlZmluZURlbGltaXRlciApO1xuICAgICAgICBpZiAoIHNwYWNlID09PSAtMSApIHtcbiAgICAgICAgICAgIHRocm93ICdCYWQgdmFyaWFibGUgZGVmaW5pdGlvbjogJyArIHZhcmlhYmxlO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG5vY2FsbCA9IGZhbHNlO1xuICAgICAgICB2YXIgZ2xvYmFsID0gZmFsc2U7XG4gICAgICAgIHZhciBjdXJyZW50VG9rZW4gPSB2YXJpYWJsZS5zdWJzdHJpbmcoIDAsIHNwYWNlICk7XG4gICAgICAgIHZhciBuZXh0VG9rZW5zID0gdmFyaWFibGUuc3Vic3RyaW5nKCBzcGFjZSArIDEgKS50cmltKCk7XG4gICAgICAgIHZhciB0b2tlbkRvbmUgPSBmYWxzZTtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHNwZWNpYWxUb2tlbiA9IGZhbHNlO1xuICAgICAgICAgICAgaWYgKCBjb250ZXh0LmdldENvbmYoKS5nbG9iYWxWYXJpYWJsZUV4cHJlc3Npb25QcmVmaXggPT09IGN1cnJlbnRUb2tlbiApe1xuICAgICAgICAgICAgICAgIGdsb2JhbCA9IHRydWU7XG4gICAgICAgICAgICAgICAgc3BlY2lhbFRva2VuID0gdHJ1ZTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNvbnRleHQuZ2V0Q29uZigpLm5vY2FsbFZhcmlhYmxlRXhwcmVzc2lvblByZWZpeCA9PT0gY3VycmVudFRva2VuICl7XG4gICAgICAgICAgICAgICAgbm9jYWxsID0gdHJ1ZTsgIFxuICAgICAgICAgICAgICAgIHNwZWNpYWxUb2tlbiA9IHRydWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIHNwZWNpYWxUb2tlbiApe1xuICAgICAgICAgICAgICAgIHNwYWNlID0gbmV4dFRva2Vucy5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5pbkRlZmluZURlbGltaXRlciApO1xuICAgICAgICAgICAgICAgIGN1cnJlbnRUb2tlbiA9IG5leHRUb2tlbnMuc3Vic3RyaW5nKCAwLCBzcGFjZSApO1xuICAgICAgICAgICAgICAgIG5leHRUb2tlbnMgPSBuZXh0VG9rZW5zLnN1YnN0cmluZyggc3BhY2UgKyAxICkudHJpbSgpO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBkZWZpbmVJdGVtcy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogY3VycmVudFRva2VuLFxuICAgICAgICAgICAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uQnVpbGRlci5idWlsZCggbmV4dFRva2VucyApLFxuICAgICAgICAgICAgICAgICAgICBnbG9iYWw6IGdsb2JhbCxcbiAgICAgICAgICAgICAgICAgICAgbm9jYWxsOiBub2NhbGxcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgICAgICB0b2tlbkRvbmUgPSB0cnVlO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0gd2hpbGUoICEgdG9rZW5Eb25lICYmIHNwYWNlICE9PSAtMSApO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgVEFMRGVmaW5lKCBzdHJpbmcsIGRlZmluZUl0ZW1zICk7XG59O1xuXG5cblRBTERlZmluZS5hcHBlbmRTdHJpbmdzID0gZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIHJlc3VsdCA9IGFyZ3VtZW50c1sgMCBdO1xuICAgIFxuICAgIGZvciAoIHZhciBjID0gMTsgYyA8IGFyZ3VtZW50cy5sZW5ndGg7ICsrYyApe1xuICAgICAgICB2YXIgc3RyaW5nID0gYXJndW1lbnRzWyBjIF07XG4gICAgICAgIGlmICggc3RyaW5nICl7XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQ/IHJlc3VsdCArIGNvbnRleHQuZ2V0Q29uZigpLmRlZmluZURlbGltaXRlciArIHN0cmluZzogc3RyaW5nO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5UQUxEZWZpbmUudXBkYXRlQXR0cmlidXRlID0gZnVuY3Rpb24oIG5vZGUsIGRlZmluZVRvQWRkICl7XG5cbiAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xuICAgIHZhciBub2RlRGVmaW5lID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsRGVmaW5lICk7XG4gICAgdmFyIGZ1bGxEZWZpbmUgPSBUQUxEZWZpbmUuYXBwZW5kU3RyaW5ncyggZGVmaW5lVG9BZGQsIG5vZGVEZWZpbmUgKTtcblxuICAgIGlmICggZnVsbERlZmluZSApe1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggdGFncy50YWxEZWZpbmUsIGZ1bGxEZWZpbmUgKTtcbiAgICB9XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRBTERlZmluZTtcbiIsIi8qXG4gICAgVEFMT21pdFRhZyBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQm9vbGVhbkxpdGVyYWwgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvcGF0aC9saXRlcmFscy9ib29sZWFuTGl0ZXJhbC5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xuXG52YXIgVEFMT21pdFRhZyA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHNjb3BlLCBub2RlLCBwYXJzZXJOb2RlUmVuZGVyZXIgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICBpZiAoICEgcmVzdWx0ICl7XG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFByb2Nlc3MgdGhlIGNvbnRlbnRzXG4gICAgICAgIHBhcnNlck5vZGVSZW5kZXJlci5kZWZhdWx0Q29udGVudCggbm9kZSApO1xuICAgICAgICBcbiAgICAgICAgLy8gTW92ZSBjaGlsZHJlbiBmcm9tIGN1cnJlbnQgbm9kZSB0byBpdHMgcGFyZW50IGFuZCB0aGVuIHJlbW92ZSBpdFxuICAgICAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xuICAgICAgICB2YXIgcGFyZW50Tm9kZSA9IG5vZGUucGFyZW50Tm9kZTtcbiAgICAgICAgd2hpbGUgKCBub2RlLmZpcnN0Q2hpbGQgKSB7XG4gICAgICAgICAgICBpZiAoIG5vZGUuZmlyc3RDaGlsZC5ub2RlVHlwZSA9PT0gMSApe1xuICAgICAgICAgICAgICAgIG5vZGUuZmlyc3RDaGlsZC5zZXRBdHRyaWJ1dGUoIHRhZ3MucWR1cCwgMSApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcGFyZW50Tm9kZS5hcHBlbmRDaGlsZCggbm9kZS5maXJzdENoaWxkICk7XG4gICAgICAgIH1cbiAgICAgICAgcGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggbm9kZSApO1xuXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIHVuZGVmaW5lZCwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvLyBOb3RoaW5nIHRvIGRvXG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJUQUxPbWl0VGFnOiBcIiArIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxPbWl0VGFnLmlkXG4gICAgfTtcbn07XG5cblRBTE9taXRUYWcuaWQgPSAndGFsOm9taXQtdGFnJztcblxuVEFMT21pdFRhZy5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uU3RyaW5nID0gc3RyaW5nLnRyaW0oKTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25TdHJpbmcgPT0gJyc/XG4gICAgICAgICAgICBuZXcgQm9vbGVhbkxpdGVyYWwoIHRydWUgKTpcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBleHByZXNzaW9uU3RyaW5nICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBUQUxPbWl0VGFnKCBzdHJpbmcsIGV4cHJlc3Npb24gKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMT21pdFRhZztcbiIsIi8qXG4gICAgVEFMT25FcnJvciBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGNvbnRlbnRIZWxwZXIgPSByZXF1aXJlKCAnLi9jb250ZW50SGVscGVyLmpzJyApO1xuXG52YXIgVEFMT25FcnJvciA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBzdHJ1Y3R1cmVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBzdHJ1Y3R1cmUgPSBzdHJ1Y3R1cmVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBwdXRUb0F1dG9EZWZpbmVIZWxwZXIgPSBmdW5jdGlvbiggYXV0b0RlZmluZUhlbHBlciApe1xuXG4gICAgICAgIC8vIEFkZCBvbkVycm9yVmFyTmFtZSB0byB0aGUgYXV0b0RlZmluZUhlbHBlclxuICAgICAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLm9uRXJyb3JWYXJOYW1lLFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgdHJ1ZVxuICAgICAgICApO1xuICAgICAgICBcbiAgICAgICAgLy8gQWRkIG9uRXJyb3JTdHJ1Y3R1cmVWYXJOYW1lIHRvIHRoZSBhdXRvRGVmaW5lSGVscGVyXG4gICAgICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkub25FcnJvclN0cnVjdHVyZVZhck5hbWUsXG4gICAgICAgICAgICBzdHJ1Y3R1cmUsXG4gICAgICAgICAgICBmYWxzZVxuICAgICAgICApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHVwZGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vIE5vdGhpbmcgdG8gZG9cbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTE9uRXJyb3I6IFwiICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHV0VG9BdXRvRGVmaW5lSGVscGVyOiBwdXRUb0F1dG9EZWZpbmVIZWxwZXIsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxPbkVycm9yLmlkXG4gICAgfTtcbn07XG5cblRBTE9uRXJyb3IuaWQgPSAndGFsOm9uLWVycm9yJztcblxuVEFMT25FcnJvci5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG5cbiAgICByZXR1cm4gY29udGVudEhlbHBlci5idWlsZCggXG4gICAgICAgICdUQUxPbkVycm9yJyxcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBmdW5jdGlvbiggX3N0cmluZywgX2V4cHJlc3Npb24sIF9zdHJ1Y3R1cmUsIF9leHByZXNzaW9uU3RyaW5nICl7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRBTE9uRXJyb3IoIF9leHByZXNzaW9uU3RyaW5nLCBfc3RydWN0dXJlICk7XG4gICAgICAgIH1cbiAgICApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxPbkVycm9yO1xuIiwiLypcbiAgICBUQUxSZXBlYXQgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vZXhwcmVzc2lvbnMvZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbnZhciBMb29wID0gcmVxdWlyZSggJy4uLy4uL3BhcnNlcnMvbG9vcC5qcycgKTtcblxudmFyIFRBTFJlcGVhdCA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCB2YXJOYW1lVG9BcHBseSwgZXhwcmVzc2lvblN0cmluZ1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIHZhck5hbWUgPSB2YXJOYW1lVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvblN0cmluZyA9IGV4cHJlc3Npb25TdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIGV4cHJlc3Npb25TdHJpbmcgKTtcbiAgICB2YXIgbG9vcDtcbiAgICBcbiAgICB2YXIgcHJvY2VzcyA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBsb29wID0gbmV3IExvb3AoIHZhck5hbWUsIGV4cHJlc3Npb25TdHJpbmcsIHNjb3BlICk7XG4gICAgICAgIHJldHVybiBsb29wO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIHVuZGVmaW5lZCwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cGRhdGUgPSBmdW5jdGlvbiggcGFyc2VyVXBkYXRlciwgbm9kZSApe1xuICAgICAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIG5vZGUgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBcIlRBTFJlcGVhdDogXCIgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0RXhwcmVzc2lvblN0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uU3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldFZhck5hbWUgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gdmFyTmFtZTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHByb2Nlc3M6IHByb2Nlc3MsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB1cGRhdGU6IHVwZGF0ZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nLFxuICAgICAgICB0eXBlOiBUQUxSZXBlYXQuaWQsXG4gICAgICAgIGdldEV4cHJlc3Npb25TdHJpbmc6IGdldEV4cHJlc3Npb25TdHJpbmcsXG4gICAgICAgIGdldFZhck5hbWU6IGdldFZhck5hbWVcbiAgICB9O1xufTtcblxuVEFMUmVwZWF0LmlkID0gJ3RhbDpyZXBlYXQnO1xuXG5UQUxSZXBlYXQuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uU3RyaW5nID0gc3RyaW5nLnRyaW0oKTtcbiAgICB2YXIgc3BhY2UgPSBleHByZXNzaW9uU3RyaW5nLmluZGV4T2YoICcgJyApO1xuICAgIGlmICggc3BhY2UgPT09IC0xICkge1xuICAgICAgICB0aHJvdyAnQmFkIHJlcGVhdCBleHByZXNzaW9uOiAnICsgZXhwcmVzc2lvblN0cmluZztcbiAgICB9XG4gICAgdmFyIHZhck5hbWUgPSBleHByZXNzaW9uU3RyaW5nLnN1YnN0cmluZyggMCwgc3BhY2UgKTtcbiAgICB2YXIgbG9vcEV4cHJlc3Npb24gPSBleHByZXNzaW9uU3RyaW5nLnN1YnN0cmluZyggc3BhY2UgKyAxICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBUQUxSZXBlYXQoIHN0cmluZywgdmFyTmFtZSwgbG9vcEV4cHJlc3Npb24gKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVEFMUmVwZWF0O1xuIiwiLypcbiAgICBUQUxSZXBsYWNlIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi8uLi9leHByZXNzaW9ucy9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciBjb250ZW50SGVscGVyID0gcmVxdWlyZSggJy4vY29udGVudEhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uLy4uL2V4cHJlc3Npb25zL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBUQUxSZXBsYWNlID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5LCBzdHJ1Y3R1cmVUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIHN0cnVjdHVyZSA9IHN0cnVjdHVyZVRvQXBwbHk7XG4gICAgXG4gICAgdmFyIHByb2Nlc3MgPSBmdW5jdGlvbiggc2NvcGUsIG5vZGUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEV2YWx1YXRlXG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZVRvTm90TnVsbCggc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICAgICAgXG4gICAgICAgIC8vIENoZWNrIGRlZmF1bHRcbiAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5pc0RlZmF1bHQoIGV2YWx1YXRlZCApICl7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIENoZWNrIG5vdGhpbmdcbiAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5pc05vdGhpbmcoIGV2YWx1YXRlZCApICl7XG4gICAgICAgICAgICBldmFsdWF0ZWQgPSBcIlwiO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIHN0cnVjdHVyZSApe1xuICAgICAgICAgICAgLy8gUmVwbGFjZSBIVE1MXG4gICAgICAgICAgICBub2RlLm91dGVySFRNTCA9IGV2YWx1YXRlZDtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gUmVwbGFjZSBvcmlnaW5hbCBub2RlIGJ5IG5ldyB0ZXh0IG5vZGVcbiAgICAgICAgICAgIHZhciB0ZXh0Tm9kZSA9IG5vZGUub3duZXJEb2N1bWVudC5jcmVhdGVUZXh0Tm9kZSggZXZhbHVhdGVkICk7XG4gICAgICAgICAgICBub2RlLnBhcmVudE5vZGUucmVwbGFjZUNoaWxkKCB0ZXh0Tm9kZSwgbm9kZSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgLy9yZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCB1bmRlZmluZWQsIHNjb3BlLCBleHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgLy8gTm90aGluZyB0byBkb1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICdUQUxSZXBsYWNlOiAnICsgc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgcHJvY2VzczogcHJvY2VzcyxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHVwZGF0ZTogdXBkYXRlLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmcsXG4gICAgICAgIHR5cGU6IFRBTFJlcGxhY2UuaWRcbiAgICB9O1xufTtcblxuVEFMUmVwbGFjZS5pZCA9ICd0YWw6cmVwbGFjZSc7XG5cblRBTFJlcGxhY2UuYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuXG4gICAgcmV0dXJuIGNvbnRlbnRIZWxwZXIuYnVpbGQoIFxuICAgICAgICAnVEFMUmVwbGFjZScsXG4gICAgICAgIHN0cmluZyxcbiAgICAgICAgZnVuY3Rpb24oIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfc3RydWN0dXJlICl7XG4gICAgICAgICAgICByZXR1cm4gbmV3IFRBTFJlcGxhY2UoIF9zdHJpbmcsIF9leHByZXNzaW9uLCBfc3RydWN0dXJlICk7XG4gICAgICAgIH1cbiAgICApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUQUxSZXBsYWNlO1xuIiwiLyogXG4gICAgYXR0cmlidXRlSW5kZXggc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHZhciBtYXA7XG4gICAgXG4gICAgdmFyIHJlc2V0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgbWFwID0ge307XG4gICAgfTtcbiAgICByZXNldCgpO1xuICAgIFxuICAgIHZhciBhZGQgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICBhZGRMaXN0KFxuICAgICAgICAgICAgbm9kZSxcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlLFxuICAgICAgICAgICAgYXR0cmlidXRlSW5zdGFuY2UuZGVwZW5kc09uKCBzY29wZSApXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYWRkTGlzdCA9IGZ1bmN0aW9uKCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgbGlzdCwgZ3JvdXBJZCApe1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIGFkZEFueSggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGxpc3RbIGkgXSwgZ3JvdXBJZCApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICB2YXIgYWRkT2JqZWN0ID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCBpdGVtICl7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgZ3JvdXBJZCBpbiBpdGVtICl7XG4gICAgICAgICAgICBhZGRBbnkoIG5vZGUsIGF0dHJpYnV0ZUluc3RhbmNlLCBpdGVtWyBncm91cElkIF0sIGdyb3VwSWQgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdmFyIGFkZEFueSA9IGZ1bmN0aW9uKCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgaXRlbSwgZ3JvdXBJZCApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCB1dGlscy5pc1BsYWluT2JqZWN0KCBpdGVtICkgKXtcbiAgICAgICAgICAgIGFkZE9iamVjdCggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIGl0ZW0gKTtcbiAgICAgICAgfSBlbHNlIGlmICggQXJyYXkuaXNBcnJheSggaXRlbSApICl7XG4gICAgICAgICAgICBhZGRMaXN0KCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgaXRlbSwgZ3JvdXBJZCApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgYWRkVmFyKCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgaXRlbSwgZ3JvdXBJZCApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICAvKlxuICAgIHZhciBhZGRWYXIgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlSW5zdGFuY2UsIHZhck5hbWUsIGdyb3VwSWQgICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IG1hcFsgdmFyTmFtZSBdO1xuICAgICAgICBpZiAoICEgbGlzdCApe1xuICAgICAgICAgICAgbGlzdCA9IFtdO1xuICAgICAgICAgICAgbWFwWyB2YXJOYW1lIF0gPSBsaXN0O1xuICAgICAgICB9XG5cbiAgICAgICAgbGlzdC5wdXNoKFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUluc3RhbmNlOiBhdHRyaWJ1dGVJbnN0YW5jZSxcbiAgICAgICAgICAgICAgICBub2RlSWQ6IG5vZGUuZ2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5pZCApLFxuICAgICAgICAgICAgICAgIGdyb3VwSWQ6IGdyb3VwSWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9O1xuICAgICovXG4gICAgdmFyIGFkZFZhciA9IGZ1bmN0aW9uKCBub2RlLCBhdHRyaWJ1dGVJbnN0YW5jZSwgdmFyTmFtZSwgZ3JvdXBJZCAgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsaXN0ID0gbWFwWyB2YXJOYW1lIF07XG4gICAgICAgIGlmICggISBsaXN0ICl7XG4gICAgICAgICAgICBsaXN0ID0gW107XG4gICAgICAgICAgICBtYXBbIHZhck5hbWUgXSA9IGxpc3Q7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBuZXdJdGVtID0ge1xuICAgICAgICAgICAgYXR0cmlidXRlSW5zdGFuY2U6IGF0dHJpYnV0ZUluc3RhbmNlLFxuICAgICAgICAgICAgbm9kZUlkOiBub2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKSxcbiAgICAgICAgICAgIGdyb3VwSWQ6IGdyb3VwSWRcbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIC8vdmFyIGluZGV4ID0gbGlzdC5maW5kSW5kZXgoIGl0ZW0gPT4gdXRpbHMuZGVlcEVxdWFsKCBpdGVtLCBuZXdJdGVtICkgKTtcbiAgICAgICAgdmFyIGluZGV4ID0gbGlzdC5maW5kSW5kZXgoIFxuICAgICAgICAgICAgZnVuY3Rpb24oIGl0ZW0gKSB7IFxuICAgICAgICAgICAgICAgIHJldHVybiB1dGlscy5kZWVwRXF1YWwoIGl0ZW0sIG5ld0l0ZW0gKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCBpbmRleCA9PT0gLTEgKXtcbiAgICAgICAgICAgIGxpc3QucHVzaCggbmV3SXRlbSApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbGlzdFsgaW5kZXggXSA9IG5ld0l0ZW07XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRWYXJzTGlzdCA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgaXRlbXMgPSBtYXBbIHZhck5hbWUgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIFJldHVybiBhbiBlbXB0eSBsaXN0IGlmIG5lZWRlZFxuICAgICAgICBpZiAoIGl0ZW1zID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgIHJldHVybiBbXTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gUmVtb3ZlIGl0ZW1zIHdpdGggcmVtb3ZlZCBub2Rlc1xuICAgICAgICBjbGVhbkl0ZW1zKCBpdGVtcyApO1xuICAgICAgICBcbiAgICAgICAgLy8gV2UgbXVzdCBidWlsZCBhbm90aGVyIGxpc3QgdG8gYXZvaWQgc3luYyBlcnJvcnNcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KCBpdGVtcyApO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgLy9UT0RPIGZpbmROb2RlQnlJZCBkdXBsaWNhdGVkXG4gICAgdmFyIGZpbmROb2RlQnlJZCA9IGZ1bmN0aW9uICggbm9kZUlkICkge1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBcbiAgICAgICAgICAgICdbJyArIGNvbnRleHQuZ2V0VGFncygpLmlkICsgJz1cIicgKyBub2RlSWQgKyAnXCJdJyBcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBpdGVtcyBhbmQgcmVtb3ZlIHRoZW0gd2hlbiBub2RlIGRvZXMgbm90IGV4aXN0IGluIERPTVxuICAgIHZhciBjbGVhbkl0ZW1zID0gZnVuY3Rpb24oIGl0ZW1zICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgaW5kZXhlc1RvUmVtb3ZlID0gW107XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCBsaXN0IG9mIGl0ZW1zIHRvIHJlbW92ZVxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7ICsraSApe1xuICAgICAgICAgICAgdmFyIGl0ZW0gPSBpdGVtc1sgaSBdO1xuICAgICAgICAgICAgdmFyIG5vZGUgPSBmaW5kTm9kZUJ5SWQoIGl0ZW0ubm9kZUlkICk7XG4gICAgICAgICAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICAgICAgICAgIGluZGV4ZXNUb1JlbW92ZS5wdXNoKCBpICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFJlbW92ZSBpdGVtc1xuICAgICAgICBmb3IgKCB2YXIgaiA9IGluZGV4ZXNUb1JlbW92ZS5sZW5ndGggLSAxOyBqID49IDAgOyAtLWogKXtcbiAgICAgICAgICAgIHZhciBpbmRleFRvUmVtb3ZlID0gaW5kZXhlc1RvUmVtb3ZlWyBqIF07XG4gICAgICAgICAgICBpdGVtcy5zcGxpY2UoIGluZGV4VG9SZW1vdmUsIDEgKTtcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIC8qXG4gICAgdmFyIHJlbW92ZVZhciA9IGZ1bmN0aW9uKCB2YXJOYW1lLCBub2RlSWQgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsaXN0ID0gbWFwWyB2YXJOYW1lIF07XG5cbiAgICAgICAgdmFyIGZpbHRlcmVkID0gbGlzdC5maWx0ZXIoXG4gICAgICAgICAgICBmdW5jdGlvbiggdmFsdWUsIGluZGV4LCBhcnIgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdmFsdWUubm9kZUlkICE9PSBub2RlSWQ7XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG5cbiAgICAgICAgbWFwWyB2YXJOYW1lIF0gPSBmaWx0ZXJlZDtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZW1vdmVWYXJGcm9tTm9kZXMgPSBmdW5jdGlvbiggdmFyTmFtZSwgbm9kZUlkcyApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGxpc3QgPSBtYXBbIHZhck5hbWUgXTtcblxuICAgICAgICB2YXIgZmlsdGVyZWQgPSBsaXN0LmZpbHRlcihcbiAgICAgICAgICAgIGZ1bmN0aW9uKCB2YWx1ZSwgaW5kZXgsIGFyciApe1xuICAgICAgICAgICAgICAgIHJldHVybiBub2RlSWRzLmluZGV4T2YoIHZhbHVlLm5vZGVJZCApID09PSAtMTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoIGZpbHRlcmVkLmxlbmd0aCA9PT0gMCApe1xuICAgICAgICAgICAgZGVsZXRlIG1hcFsgdmFyTmFtZSBdO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbWFwWyB2YXJOYW1lIF0gPSBmaWx0ZXJlZDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRBbGxOb2RlSWRzID0gZnVuY3Rpb24oIHRhcmdldCApe1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHRoZSBsaXN0XG4gICAgICAgIHZhciBsaXN0ID0gdGFyZ2V0LnF1ZXJ5U2VsZWN0b3JBbGwoICdbJyArIGNvbnRleHQuZ2V0VGFncygpLmlkICsgJ10nICk7XG5cbiAgICAgICAgLy8gSXRlcmF0ZSB0aGUgbGlzdFxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIHZhciBub2RlSWRBdHRyaWJ1dGVOYW1lID0gY29udGV4dC5nZXRUYWdzKCkuaWQ7XG4gICAgICAgIHZhciBub2RlO1xuICAgICAgICB2YXIgcG9zID0gMDtcbiAgICAgICAgd2hpbGUgKCBub2RlID0gbGlzdFsgcG9zKysgXSApIHtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBcbiAgICAgICAgICAgICAgICBub2RlLmdldEF0dHJpYnV0ZSggbm9kZUlkQXR0cmlidXRlTmFtZSApIFxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZW1vdmVOb2RlID0gZnVuY3Rpb24oIG5vZGUgKXtcblxuICAgICAgICB2YXIgbm9kZUlkcyA9IGdldEFsbE5vZGVJZHMoIG5vZGUgKTtcblxuICAgICAgICB2YXIgbm9kZUlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoIGNvbnRleHQuZ2V0VGFncygpLmlkICk7XG4gICAgICAgIG5vZGVJZHMucHVzaCggbm9kZUlkICk7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgdmFyTmFtZSBpbiBtYXAgKXtcbiAgICAgICAgICAgIHJlbW92ZVZhckZyb21Ob2RlcyggdmFyTmFtZSwgbm9kZUlkcyApO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVtb3ZlTXVsdGlwbGVOb2RlcyA9IGZ1bmN0aW9uKCBub2RlSWRzICl7XG5cbiAgICAgICAgZm9yICggdmFyIHZhck5hbWUgaW4gbWFwICl7XG4gICAgICAgICAgICByZW1vdmVWYXJGcm9tTm9kZXMoIHZhck5hbWUsIG5vZGVJZHMgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgKi9cbiAgICByZXR1cm4ge1xuICAgICAgICBhZGQ6IGFkZCxcbiAgICAgICAgZ2V0VmFyc0xpc3Q6IGdldFZhcnNMaXN0LFxuICAgICAgICAvL3JlbW92ZVZhcjogcmVtb3ZlVmFyLFxuICAgICAgICAvL3JlbW92ZU5vZGU6IHJlbW92ZU5vZGUsXG4gICAgICAgIC8vcmVtb3ZlTXVsdGlwbGVOb2RlczogcmVtb3ZlTXVsdGlwbGVOb2RlcyxcbiAgICAgICAgcmVzZXQ6IHJlc2V0XG4gICAgfTtcbn0pKCk7XG4iLCIvKlxuICAgIGF0dHJpYnV0ZUNhY2hlIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQ2FjaGVIZWxwZXIgPSByZXF1aXJlKCAnLi9jYWNoZUhlbHBlci5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgbG9nID0gcmVxdWlyZSggJy4uL2xvZ0hlbHBlci5qcycgKTtcbnZhciBhdHRyaWJ1dGVJbmRleCA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL2F0dHJpYnV0ZUluZGV4LmpzJyApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcbiAgICB2YXIgbWFwO1xuICAgIFxuICAgIHZhciByZXNldCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIG1hcCA9IHt9O1xuICAgIH07XG4gICAgcmVzZXQoKTtcbiAgICBcbiAgICB2YXIgZ2V0ID0gZnVuY3Rpb24oIGF0dHJpYnV0ZSwgc3RyaW5nICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIGF0dHJpYnV0ZU1hcCA9IG1hcFsgYXR0cmlidXRlIF07XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgYXR0cmlidXRlTWFwICl7XG4gICAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICAgXG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGVNYXBbIENhY2hlSGVscGVyLmhhc2hDb2RlKCBzdHJpbmcgKSBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHB1dCA9IGZ1bmN0aW9uKCBhdHRyaWJ1dGUsIHN0cmluZywgdmFsdWUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBhdHRyaWJ1dGVNYXAgPSBtYXBbIGF0dHJpYnV0ZSBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGF0dHJpYnV0ZU1hcCApe1xuICAgICAgICAgICAgYXR0cmlidXRlTWFwID0ge307XG4gICAgICAgICAgICBtYXBbIGF0dHJpYnV0ZSBdID0gYXR0cmlidXRlTWFwO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBhdHRyaWJ1dGVNYXBbIENhY2hlSGVscGVyLmhhc2hDb2RlKCBzdHJpbmcgKSBdID0gdmFsdWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaW5kZXggPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlLCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCBub2RlICl7XG4gICAgICAgICAgICBsb2cuZGVidWcoICdNdXN0IGluZGV4IScgKTtcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluZGV4LmFkZCggbm9kZSwgYXR0cmlidXRlLCBzY29wZSApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoICdOb3QgaW5kZXhlZCEnICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBhdHRyaWJ1dGU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0QnlEZXRhaWxzID0gZnVuY3Rpb24oIGF0dHJpYnV0ZVR5cGUsIHN0cmluZywgYnVpbGRGdW5jdGlvbiwgZm9yY2UsIG5vZGUsIHNjb3BlICkge1xuICAgICAgICBcbiAgICAgICAgbG9nLmRlYnVnKCBcbiAgICAgICAgICAgICdSZXF1ZXN0IGJ1aWxkaW5nIG9mIFpQVCBhdHRyaWJ1dGUgXCInICsgc3RyaW5nICsgJ1wiLCBmb3JjZSBcIicgKyBmb3JjZSArICdcIicgKTtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmcm9tIGNhY2hlIGlmIHBvc3NpYmxlXG4gICAgICAgIGlmICggZm9yY2UgfHwgISBjb250ZXh0LmdldENvbmYoKS5hdHRyaWJ1dGVDYWNoZU9uICl7XG4gICAgICAgICAgICBsb2cuZGVidWcoICdDYWNoZSBPRkYhJyApO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBsb2cuZGVidWcoICdDYWNoZSBPTiEnICk7XG4gICAgICAgICAgICB2YXIgZnJvbUNhY2hlID0gZ2V0KCBhdHRyaWJ1dGVUeXBlLCBzdHJpbmcgKTtcbiAgICAgICAgICAgIGlmICggZnJvbUNhY2hlICl7XG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnKCAnRm91bmQgaW4gY2FjaGUhJyApO1xuICAgICAgICAgICAgICAgIC8vcmV0dXJuIGZyb21DYWNoZTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5kZXgoIG5vZGUsIGZyb21DYWNoZSwgc2NvcGUgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnKCAnTk9UIGZvdW5kIGluIGNhY2hlIScgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRm9yY2UgYnVpbGQgYW5kIHB1dCBpbnRvIGNhY2hlXG4gICAgICAgIGxvZy5kZWJ1ZyggJ011c3QgYnVpbGQhJyApO1xuICAgICAgICB2YXIgYnVpbGRlZCA9IGJ1aWxkRnVuY3Rpb24oKTtcbiAgICAgICAgcHV0KCBhdHRyaWJ1dGVUeXBlLCBzdHJpbmcsIGJ1aWxkZWQgKTtcbiAgICAgICAgLy9yZXR1cm4gYnVpbGRlZDtcbiAgICAgICAgcmV0dXJuIGluZGV4KCBub2RlLCBidWlsZGVkLCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldEJ5QXR0cmlidXRlQ2xhc3MgPSBmdW5jdGlvbiggYXR0cmlidXRlSW5zdGFuY2UsIHN0cmluZywgbm9kZSwgaW5kZXhFeHByZXNzaW9ucywgc2NvcGUsIGNvbnN0cnVjdG9yICkge1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGdldEJ5RGV0YWlscyggXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5zdGFuY2UuaWQsIFxuICAgICAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICAgICAgY29uc3RydWN0b3IgfHwgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGF0dHJpYnV0ZUluc3RhbmNlLmJ1aWxkKCBzdHJpbmcgKTtcbiAgICAgICAgICAgICAgICB9LCBcbiAgICAgICAgICAgICAgICBmYWxzZSxcbiAgICAgICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zPyBub2RlOiB1bmRlZmluZWQsXG4gICAgICAgICAgICAgICAgc2NvcGVcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIC8vZ2V0QnlEZXRhaWxzOiBnZXRCeURldGFpbHMsXG4gICAgICAgIGdldEJ5QXR0cmlidXRlQ2xhc3M6IGdldEJ5QXR0cmlidXRlQ2xhc3MsXG4gICAgICAgIHJlc2V0OiByZXNldFxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBjYWNoZUhlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgaGFzaENvZGUgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuXG4gICAgICAgIGlmICggQXJyYXkucHJvdG90eXBlLnJlZHVjZSApIHtcbiAgICAgICAgICAgIHJldHVybiBzdHJpbmcuc3BsaXQoIFwiXCIgKS5yZWR1Y2UoXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oIGEsIGIgKXtcbiAgICAgICAgICAgICAgICAgICAgYSA9ICggKCBhIDw8IDUgKSAtIGEgKSArIGIuY2hhckNvZGVBdCggMCApO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYSZhXG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAwICk7XG4gICAgICAgIH1cblxuICAgICAgICB2YXIgaGFzaCA9IDA7XG4gICAgICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApe1xuICAgICAgICAgICAgcmV0dXJuIGhhc2g7XG4gICAgICAgIH1cbiAgICAgICAgZm9yICggdmFyIGkgPSAwLCBsZW4gPSBzdHJpbmcubGVuZ3RoOyBpIDwgbGVuOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgY2hyID0gc3RyaW5nLmNoYXJDb2RlQXQoIGkgKTtcbiAgICAgICAgICAgIGhhc2ggPSAoICggaGFzaCA8PCA1ICkgLSBoYXNoICkgKyBjaHI7XG4gICAgICAgICAgICBoYXNoIHw9IDA7IC8vIENvbnZlcnQgdG8gMzJiaXQgaW50ZWdlclxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gaGFzaDtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGhhc2hDb2RlOiBoYXNoQ29kZVxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBleHByZXNzaW9uQ2FjaGUgc2luZ2xldG9uIGNsYXNzXG4qL1xubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIENhY2hlSGVscGVyID0gcmVxdWlyZSggJy4vY2FjaGVIZWxwZXIuanMnICk7XG4gICAgdmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcbiAgICB2YXIgbG9nID0gcmVxdWlyZSggJy4uL2xvZ0hlbHBlci5qcycgKTtcbiAgICBcbiAgICB2YXIgbWFwID0ge307XG4gICAgXG4gICAgdmFyIGdldCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgICAgIHJldHVybiBtYXBbIENhY2hlSGVscGVyLmhhc2hDb2RlKCBzdHJpbmcgKSBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHB1dCA9IGZ1bmN0aW9uKCBzdHJpbmcsIHZhbHVlICl7XG4gICAgICAgIG1hcFsgQ2FjaGVIZWxwZXIuaGFzaENvZGUoIHN0cmluZyApIF0gPSB2YWx1ZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIHN0cmluZywgYnVpbGRGdW5jdGlvbiwgZm9yY2UgKSB7XG4gICAgICAgIFxuICAgICAgICBsb2cuZGVidWcoIFxuICAgICAgICAgICAgJ1JlcXVlc3QgYnVpbGRpbmcgb2YgZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIsIGZvcmNlIFwiJyArIGZvcmNlICsgJ1wiJyApO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGZyb20gY2FjaGUgaWYgcG9zc2libGVcbiAgICAgICAgaWYgKCAhIGZvcmNlICYmIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25DYWNoZU9uICl7XG4gICAgICAgICAgICBsb2cuZGVidWcoICdDYWNoZSBPTiEnICk7XG4gICAgICAgICAgICB2YXIgZnJvbUNhY2hlID0gZ2V0KCBzdHJpbmcgKTtcbiAgICAgICAgICAgIGlmICggZnJvbUNhY2hlICl7XG4gICAgICAgICAgICAgICAgbG9nLmRlYnVnKCAnRm91bmQgaW4gY2FjaGUhJyApO1xuICAgICAgICAgICAgICAgIHJldHVybiBmcm9tQ2FjaGU7XG4gICAgICAgICAgICB9IFxuICAgICAgICAgICAgbG9nLmRlYnVnKCAnTk9UIGZvdW5kIGluIGNhY2hlIScgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgbG9nLmRlYnVnKCAnQ2FjaGUgT0ZGIScgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRm9yY2UgYnVpbGQgYW5kIHB1dCBpbnRvIGNhY2hlXG4gICAgICAgIGxvZy5kZWJ1ZyggJ011c3QgYnVpbGQhJyApO1xuICAgICAgICB2YXIgYnVpbGRlZCA9IGJ1aWxkRnVuY3Rpb24oKTtcbiAgICAgICAgcHV0KCBzdHJpbmcsIGJ1aWxkZWQgKTtcbiAgICAgICAgcmV0dXJuIGJ1aWxkZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgY2xlYW4gPSBmdW5jdGlvbiggKSB7XG4gICAgICAgIG1hcCA9IHt9O1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0OiBwcm9jZXNzLFxuICAgICAgICBjbGVhbjogY2xlYW5cbiAgICB9O1xufSkoKTtcbiIsIi8qIFxuICAgIGNvbnRleHQgc2luZ2xldG9uIGNsYXNzXG4qL1xuXG52YXIgbG9nNGphdmFzY3JpcHQgPSByZXF1aXJlKCAnbG9nNGphdmFzY3JpcHQnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi91dGlscy5qcycgKTtcbnZhciBMb29wSXRlbSA9IHJlcXVpcmUoICcuL3BhcnNlcnMvbG9vcEl0ZW0uanMnICk7XG52YXIgQ1NTQW5pbWF0aW9uTWFuYWdlciA9IHJlcXVpcmUoICcuL3BhcnNlcnMvZGljdGlvbmFyeUFjdGlvbnMvY3NzQW5pbWF0aW9uTWFuYWdlci5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgLyogVGFncyAqL1xuICAgIHZhciBkZWZhdWx0VGFncyA9IHtcbiAgICAgICAgdGFsQ29uZGl0aW9uOiAgICAgXCJkYXRhLWNvbmRpdGlvblwiLFxuICAgICAgICB0YWxSZXBlYXQ6ICAgICAgICBcImRhdGEtcmVwZWF0XCIsXG4gICAgICAgIHRhbEF0dHJpYnV0ZXM6ICAgIFwiZGF0YS1hdHRyaWJ1dGVzXCIsXG4gICAgICAgIHRhbENvbnRlbnQ6ICAgICAgIFwiZGF0YS1jb250ZW50XCIsXG4gICAgICAgIHRhbERlZmluZTogICAgICAgIFwiZGF0YS1kZWZpbmVcIixcbiAgICAgICAgdGFsQXV0b0RlZmluZTogICAgXCJkYXRhLXRhdXRvLWRlZmluZVwiLFxuICAgICAgICB0YWxPbWl0VGFnOiAgICAgICBcImRhdGEtb21pdC10YWdcIixcbiAgICAgICAgdGFsUmVwbGFjZTogICAgICAgXCJkYXRhLXJlcGxhY2VcIixcbiAgICAgICAgdGFsT25FcnJvcjogICAgICAgXCJkYXRhLW9uLWVycm9yXCIsXG4gICAgICAgIHRhbERlY2xhcmU6ICAgICAgICAgXCJkYXRhLWRlY2xhcmVcIixcbiAgICAgICAgbWV0YWxEZWZpbmVNYWNybzogXCJkYXRhLWRlZmluZS1tYWNyb1wiLFxuICAgICAgICBtZXRhbFVzZU1hY3JvOiAgICBcImRhdGEtdXNlLW1hY3JvXCIsXG4gICAgICAgIG1ldGFsRGVmaW5lU2xvdDogIFwiZGF0YS1kZWZpbmUtc2xvdFwiLFxuICAgICAgICBtZXRhbEZpbGxTbG90OiAgICBcImRhdGEtZmlsbC1zbG90XCIsXG4gICAgICAgIG1ldGFsTWFjcm86ICAgICAgIFwiZGF0YS1tbWFjcm9cIixcbiAgICAgICAgaTE4bkRvbWFpbjogICAgICAgXCJkYXRhLWRvbWFpblwiLFxuICAgICAgICBpMThuTGFuZ3VhZ2U6ICAgICBcImRhdGEtbGFuZ3VhZ2VcIixcbiAgICAgICAgLy9zY29wZUtleTogICAgICAgICBcImRhdGEtc2NvcGUta2V5XCIsXG4gICAgICAgIHJvb3RLZXk6ICAgICAgICAgIFwiZGF0YS1yb290LWtleVwiLFxuICAgICAgICBxZHVwOiAgICAgICAgICAgICBcImRhdGEtcWR1cFwiLFxuICAgICAgICBpZDogICAgICAgICAgICAgICBcImRhdGEtaWRcIixcbiAgICAgICAgcmVsYXRlZElkOiAgICAgICAgXCJkYXRhLXJlbGF0ZWQtaWRcIixcbiAgICAgICAgY29uZGl0aW9uUmVzdWx0OiAgXCJkYXRhLWNvbmRpdGlvbi1yZXN1bHRcIlxuICAgIH07XG4gICAgdmFyIG9yaWdpbmFsVGFncyA9IHtcbiAgICAgICAgdGFsQ29uZGl0aW9uOiAgICAgXCJ0YWw6Y29uZGl0aW9uXCIsXG4gICAgICAgIHRhbFJlcGVhdDogICAgICAgIFwidGFsOnJlcGVhdFwiLFxuICAgICAgICB0YWxBdHRyaWJ1dGVzOiAgICBcInRhbDphdHRyaWJ1dGVzXCIsXG4gICAgICAgIHRhbENvbnRlbnQ6ICAgICAgIFwidGFsOmNvbnRlbnRcIixcbiAgICAgICAgdGFsRGVmaW5lOiAgICAgICAgXCJ0YWw6ZGVmaW5lXCIsXG4gICAgICAgIHRhbEF1dG9EZWZpbmU6ICAgIFwidGFsOmF1dG8tZGVmaW5lXCIsXG4gICAgICAgIHRhbE9taXRUYWc6ICAgICAgIFwidGFsOm9taXQtdGFnXCIsXG4gICAgICAgIHRhbFJlcGxhY2U6ICAgICAgIFwidGFsOnJlcGxhY2VcIixcbiAgICAgICAgdGFsT25FcnJvcjogICAgICAgXCJ0YWw6b24tZXJyb3JcIixcbiAgICAgICAgdGFsRGVjbGFyZTogICAgICAgXCJ0YWw6ZGVjbGFyZVwiLFxuICAgICAgICBtZXRhbERlZmluZU1hY3JvOiBcIm1ldGFsOmRlZmluZS1tYWNyb1wiLFxuICAgICAgICBtZXRhbFVzZU1hY3JvOiAgICBcIm1ldGFsOnVzZS1tYWNyb1wiLFxuICAgICAgICBtZXRhbERlZmluZVNsb3Q6ICBcIm1ldGFsOmRlZmluZS1zbG90XCIsXG4gICAgICAgIG1ldGFsRmlsbFNsb3Q6ICAgIFwibWV0YWw6ZmlsbC1zbG90XCIsXG4gICAgICAgIG1ldGFsTWFjcm86ICAgICAgIFwiZGF0YS1tbWFjcm9cIixcbiAgICAgICAgaTE4bkRvbWFpbjogICAgICAgXCJpMThuOmRvbWFpblwiLFxuICAgICAgICBpMThuTGFuZ3VhZ2U6ICAgICBcImkxOG46bGFuZ3VhZ2VcIixcbiAgICAgICAgLy9zY29wZUtleTogICAgICAgICBcImRhdGEtc2NvcGUta2V5XCIsXG4gICAgICAgIHJvb3RLZXk6ICAgICAgICAgIFwiZGF0YS1yb290LWtleVwiLFxuICAgICAgICBxZHVwOiAgICAgICAgICAgICBcImRhdGEtcWR1cFwiLFxuICAgICAgICBpZDogICAgICAgICAgICAgICBcImRhdGEtaWRcIixcbiAgICAgICAgcmVsYXRlZElkOiAgICAgICAgXCJkYXRhLXJlbGF0ZWQtaWRcIixcbiAgICAgICAgY29uZGl0aW9uUmVzdWx0OiAgXCJkYXRhLWNvbmRpdGlvbi1yZXN1bHRcIlxuICAgIH07XG4gICAgdmFyIHRhZ3MgPSBkZWZhdWx0VGFncztcbiAgICB2YXIgdGFsID0gJyc7XG4gICAgXG4gICAgdmFyIGdldFRhZ3MgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgcmV0dXJuIHRhZ3M7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgc2V0VGFncyA9IGZ1bmN0aW9uICggdGFnc1RvU2V0ICl7XG4gICAgICAgIHRhZ3MgPSB0YWdzVG9TZXQ7XG4gICAgICAgIHRhbCA9ICcnO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldFRhbCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBpZiAoIHRhbCA9PT0gJycgKXtcbiAgICAgICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgICAgIHZhciBub3RJbmNsdWRlID0gdGFncy5xZHVwO1xuICAgICAgICAgICAgZm9yICggdmFyIHByb3BlcnR5IGluIHRhZ3MgKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBub3RJbmNsdWRlID09PSB0YWdzWyBwcm9wZXJ0eSBdICl7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoIGMrKyA+IDApe1xuICAgICAgICAgICAgICAgICAgICB0YWwgKz0gXCIsXCI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHRhbCArPSBcIipbXCIgKyB0YWdzWyBwcm9wZXJ0eSBdICsgXCJdXCI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0YWw7XG4gICAgfTtcbiAgICB2YXIgdXNlT3JpZ2luYWxUYWdzID0gZnVuY3Rpb24oKXtcbiAgICAgICAgc2V0VGFncyggb3JpZ2luYWxUYWdzICk7XG4gICAgfTtcbiAgICAvKiBFbmQgVGFncyAqL1xuICAgIFxuICAgIC8qIEZvcm1hdHRlcnMgKi9cbiAgICB2YXIgZm9ybWF0dGVycyA9IHt9O1xuICAgIGZvcm1hdHRlcnMubG93ZXJDYXNlID0gZnVuY3Rpb24gKCB2YWx1ZSApe1xuICAgICAgICByZXR1cm4gdmFsdWUudG9Mb2NhbGVMb3dlckNhc2UoKTtcbiAgICB9O1xuICAgIGZvcm1hdHRlcnMudXBwZXJDYXNlID0gZnVuY3Rpb24gKCB2YWx1ZSApe1xuICAgICAgICByZXR1cm4gdmFsdWUudG9Mb2NhbGVVcHBlckNhc2UoKTtcbiAgICB9O1xuICAgIGZvcm1hdHRlcnMubG9jYWxlRGF0ZSA9IGZ1bmN0aW9uICggdmFsdWUgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvTG9jYWxlRGF0ZVN0cmluZztcbiAgICB9O1xuICAgIGZvcm1hdHRlcnMubG9jYWxlVGltZSA9IGZ1bmN0aW9uICggdmFsdWUgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlLnRvTG9jYWxlVGltZVN0cmluZztcbiAgICB9O1xuICAgIGZvcm1hdHRlcnMubG9jYWxlU3RyaW5nID0gZnVuY3Rpb24gKCB2YWx1ZSwgbG9jYWxlICl7XG4gICAgICAgIHJldHVybiBsb2NhbGU/IFxuICAgICAgICAgICAgICAgdmFsdWUudG9Mb2NhbGVTdHJpbmcoIHZhbHVlLCBsb2NhbGUgKTogXG4gICAgICAgICAgICAgICB2YWx1ZS50b0xvY2FsZVN0cmluZyggdmFsdWUgKTtcbiAgICB9O1xuICAgIGZvcm1hdHRlcnMuZml4ID0gZnVuY3Rpb24gKCBudW1iZXIsIGZpeFRvICl7XG4gICAgICAgIHJldHVybiBudW1iZXIudG9GaXhlZCggZml4VG8gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRGb3JtYXR0ZXIgPSBmdW5jdGlvbiAoIGlkICl7XG4gICAgICAgIHJldHVybiBmb3JtYXR0ZXJzWyBpZCBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHJlZ2lzdGVyRm9ybWF0dGVyID0gZnVuY3Rpb24gKCBpZCwgZm9ybWF0dGVyICl7XG4gICAgICAgIGZvcm1hdHRlcnNbIGlkIF0gPSBmb3JtYXR0ZXI7XG4gICAgfTtcbiAgICB2YXIgdW5yZWdpc3RlckZvcm1hdHRlciA9IGZ1bmN0aW9uICggaWQgKXtcbiAgICAgICAgZGVsZXRlIGZvcm1hdHRlcnNbIGlkIF07XG4gICAgfTtcbiAgICAvKiBFbmQgRm9ybWF0dGVycyAqL1xuICAgIFxuICAgIC8qIENvbmYgKi9cbiAgICB2YXIgRVhQUkVTU0lPTl9TVUZGSVggPSAnOic7XG4gICAgdmFyIFBSSVZBVEVfVkFSU19QUkVGSVggPSAnXyc7XG4gICAgdmFyIGRlZmF1bHRDb25mID0ge1xuICAgICAgICBwYXRoRGVsaW1pdGVyOiAgICAgICAgICAnfCcsXG4gICAgICAgIHBhdGhTZWdtZW50RGVsaW1pdGVyOiAgICcvJyxcbiAgICAgICAgZXhwcmVzc2lvbkRlbGltaXRlcjogICAgJyAnLFxuICAgICAgICBpbnRlcnZhbERlbGltaXRlcjogICAgICAnOicsXG4gICAgICAgIHByb3BlcnR5RGVsaW1pdGVyOiAgICAgICcvJyxcbiAgICAgICAgZGVmaW5lRGVsaW1pdGVyOiAgICAgICAgJzsnLFxuICAgICAgICBpbkRlZmluZURlbGltaXRlcjogICAgICAnICcsXG4gICAgICAgIGF0dHJpYnV0ZURlbGltaXRlcjogICAgICc7JyxcbiAgICAgICAgaW5BdHRyaWJ1dGVEZWxpbWl0ZXI6ICAgJyAnLFxuICAgICAgICBkb21haW5EZWxpbWl0ZXI6ICAgICAgICAnICcsXG4gICAgICAgIGkxOG5PcHRpb25zRGVsaW1pdGVyOiAgICc7JyxcbiAgICAgICAgaW5JMThuT3B0aW9uc0RlbGltaXRlcjogJyAnLFxuICAgICAgICBhcmd1bWVudHNEZWxpbWl0ZXI6ICAgICAnLCcsXG4gICAgICAgIG1hY3JvRGVsaW1pdGVyOiAgICAgICAgICdAJyxcbiAgICAgICAgZGVjbGFyZURlbGltaXRlcjogICAgICAgICAnOycsXG4gICAgICAgIGluRGVjbGFyZURlbGltaXRlcjogICAgICAgJyAnLFxuICAgICAgICBcbiAgICAgICAgaTE4bkNvbmZSZXNvdXJjZUlkOiAgICAgIFwiL0NPTkYvXCIsXG4gICAgICAgIFxuICAgICAgICBodG1sU3RydWN0dXJlRXhwcmVzc2lvblByZWZpeDogIFwic3RydWN0dXJlXCIsXG4gICAgICAgIGdsb2JhbFZhcmlhYmxlRXhwcmVzc2lvblByZWZpeDogXCJnbG9iYWxcIixcbiAgICAgICAgbm9jYWxsVmFyaWFibGVFeHByZXNzaW9uUHJlZml4OiBcIm5vY2FsbFwiLFxuICAgICAgICBcbiAgICAgICAgdGVtcGxhdGVFcnJvclZhck5hbWU6ICAgIFwiZXJyb3JcIixcbiAgICAgICAgb25FcnJvclZhck5hbWU6ICAgICAgICAgIFBSSVZBVEVfVkFSU19QUkVGSVggKyBcIm9uLWVycm9yXCIsXG4gICAgICAgIG9uRXJyb3JTdHJ1Y3R1cmVWYXJOYW1lOiBQUklWQVRFX1ZBUlNfUFJFRklYICsgXCJvbi1lcnJvci1zdHJ1Y3R1cmVcIixcbiAgICAgICAgaTE4bkRvbWFpblZhck5hbWU6ICAgICAgIFBSSVZBVEVfVkFSU19QUkVGSVggKyBcImkxOG5Eb21haW5cIixcbiAgICAgICAgaTE4bkxhbmd1YWdlVmFyTmFtZTogICAgIFBSSVZBVEVfVkFSU19QUkVGSVggKyBcImkxOG5MYW5ndWFnZVwiLFxuICAgICAgICBleHRlcm5hbE1hY3JvVXJsVmFyTmFtZTogUFJJVkFURV9WQVJTX1BSRUZJWCArIFwiZXh0ZXJuYWxNYWNyb1VybFwiLFxuICAgICAgICBzdHJpY3RNb2RlVmFyTmFtZTogICAgICAgUFJJVkFURV9WQVJTX1BSRUZJWCArIFwic3RyaWN0TW9kZVwiLFxuICAgICAgICBkZWNsYXJlZFZhcnNWYXJOYW1lOiAgICAgUFJJVkFURV9WQVJTX1BSRUZJWCArIFwiZGVjbGFyZWRWYXJzXCIsXG4gICAgICAgIHJlcGVhdFZhck5hbWU6ICAgICAgICAgICBQUklWQVRFX1ZBUlNfUFJFRklYICsgXCJyZXBlYXRcIixcbiAgICAgICAgXG4gICAgICAgIHdpbmRvd1Zhck5hbWU6ICAgICAgICAgICBcIndpbmRvd1wiLFxuICAgICAgICBjb250ZXh0VmFyTmFtZTogICAgICAgICAgXCJjb250ZXh0XCIsXG4gICAgICAgIFxuICAgICAgICBub3RoaW5nVmFyTmFtZTogICAgICAgICAgXCJub3RoaW5nXCIsXG4gICAgICAgIGRlZmF1bHRWYXJOYW1lOiAgICAgICAgICBcImRlZmF1bHRcIixcbiAgICAgICAgbm90aGluZ1ZhclZhbHVlOiAgICAgICAgIFwiX19fbm90aGluZ19fX1wiLFxuICAgICAgICBkZWZhdWx0VmFyVmFsdWU6ICAgICAgICAgXCJfX19kZWZhdWx0X19fXCIsXG4gICAgICAgIFxuICAgICAgICBsb2dnaW5nT246ICAgIGZhbHNlLFxuICAgICAgICBsb2dnaW5nTGV2ZWw6IGxvZzRqYXZhc2NyaXB0LkxldmVsLkVSUk9SLFxuXG4gICAgICAgIGV4dGVybmFsTWFjcm9QcmVmaXhVUkw6IFwiXCIsXG4gICAgICAgIHZhcmlhYmxlTmFtZVJFOiAgICAgICAgIC9eW0EtWmEtejAtOV8vLV0rJC8sXG4gICAgICAgIGV4cHJlc3Npb25DYWNoZU9uOiAgICAgIHRydWUsXG4gICAgICAgIGF0dHJpYnV0ZUNhY2hlT246ICAgICAgIHRydWUsXG5cbiAgICAgICAgZXhwcmVzc2lvblN1ZmZpeDogICAgIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBzdHJpbmdFeHByZXNzaW9uOiAgICAgXCJzdHJpbmdcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBleGlzdHNFeHByZXNzaW9uOiAgICAgXCJleGlzdHNcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBub3RFeHByZXNzaW9uOiAgICAgICAgXCJub3RcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBqYXZhU2NyaXB0RXhwcmVzc2lvbjogXCJqc1wiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIGVxdWFsc0V4cHJlc3Npb246ICAgICBcImVxXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgZ3JlYXRlckV4cHJlc3Npb246ICAgIFwiZ3RcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBsb3dlckV4cHJlc3Npb246ICAgICAgXCJsdFwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIGFkZEV4cHJlc3Npb246ICAgICAgICBcIitcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBzdWJFeHByZXNzaW9uOiAgICAgICAgXCItXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgbXVsRXhwcmVzc2lvbjogICAgICAgIFwiKlwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIGRpdkV4cHJlc3Npb246ICAgICAgICBcIi9cIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBtb2RFeHByZXNzaW9uOiAgICAgICAgXCIlXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgb3JFeHByZXNzaW9uOiAgICAgICAgIFwib3JcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBhbmRFeHByZXNzaW9uOiAgICAgICAgXCJhbmRcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBjb25kRXhwcmVzc2lvbjogICAgICAgXCJjb25kXCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgZm9ybWF0RXhwcmVzc2lvbjogICAgIFwiZm9ybWF0XCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgdHJFeHByZXNzaW9uOiAgICAgICAgIFwidHJcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICB0ck51bWJlckV4cHJlc3Npb246ICAgXCJ0ck51bWJlclwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIHRyQ3VycmVuY3lFeHByZXNzaW9uOiBcInRyQ3VycmVuY3lcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICB0ckRhdGVUaW1lRXhwcmVzc2lvbjogXCJ0ckRhdGVcIiArIEVYUFJFU1NJT05fU1VGRklYLFxuICAgICAgICBpbkV4cHJlc3Npb246ICAgICAgICAgXCJpblwiICsgRVhQUkVTU0lPTl9TVUZGSVgsXG4gICAgICAgIHF1ZXJ5RXhwcmVzc2lvbjogICAgICBcInF1ZXJ5XCIgKyBFWFBSRVNTSU9OX1NVRkZJWCxcbiAgICAgICAgcGF0aEV4cHJlc3Npb246ICAgICAgIFwiXCIsXG4gICAgICAgIFxuICAgICAgICBmaXJzdEluZGV4SWRlbnRpZmllcjogXCJfZmlyc3RfXCIsXG4gICAgICAgIGxhc3RJbmRleElkZW50aWZpZXI6ICBcIl9sYXN0X1wiXG4gICAgfTtcbiAgICB2YXIgY29uZiA9IGRlZmF1bHRDb25mO1xuICAgIFxuICAgIHZhciBnZXRDb25mID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIHJldHVybiBjb25mO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHNldENvbmYgPSBmdW5jdGlvbiAoIGNvbmZUb1NldCApe1xuICAgICAgICBjb25mID0gY29uZlRvU2V0O1xuICAgIH07XG4gICAgLyogRW5kIGNvbmYgKi9cbiAgICBcbiAgICAvKiBMb2dnZXIgKi9cbiAgICB2YXIgbG9nZ2VyO1xuICAgIHZhciBnZXREZWZhdWx0TG9nZ2VyID0gZnVuY3Rpb24gKCl7XG4gICAgICAgIFxuICAgICAgICB2YXIgZGVmYXVsdExvZ2dlciA9IGxvZzRqYXZhc2NyaXB0LmdldERlZmF1bHRMb2dnZXIoKTtcbiAgICAgICAgXG4gICAgICAgIGRlZmF1bHRMb2dnZXIuc2V0TGV2ZWwoIGdldENvbmYoKS5sb2dnaW5nTGV2ZWwgKTtcbiAgICAgICAgLy9kZWZhdWx0TG9nZ2VyLnJlbW92ZUFsbEFwcGVuZGVycygpO1xuICAgICAgICAvL2RlZmF1bHRMb2dnZXIuYWRkQXBwZW5kZXIoIG5ldyBsb2c0amF2YXNjcmlwdC5Ccm93c2VyQ29uc29sZUFwcGVuZGVyKCB0cnVlICkgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBkZWZhdWx0TG9nZ2VyO1xuICAgIH07XG4gICAgdmFyIGdldExvZ2dlciA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciAmJiBnZXRDb25mKCkubG9nZ2luZ09uICl7XG4gICAgICAgICAgICBsb2dnZXIgPSBnZXREZWZhdWx0TG9nZ2VyKCk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBsb2dnZXI7XG4gICAgfTtcbiAgICB2YXIgc2V0TG9nZ2VyID0gZnVuY3Rpb24gKCBsb2dnZXJUb1NldCApe1xuICAgICAgICBsb2dnZXIgPSBsb2dnZXJUb1NldDtcbiAgICB9O1xuICAgIC8qIEVuZCBMb2dnZXIgKi9cbiAgICBcbiAgICAvKiBcbiAgICAgICAgQm9vbGVhbiBhdHRyaWJ1dGVzOlxuICAgICAgICBUaGUgcHJlc2VuY2Ugb2YgYSBib29sZWFuIGF0dHJpYnV0ZSBvbiBhbiBlbGVtZW50IHJlcHJlc2VudHMgdGhlIHRydWUgdmFsdWUsIGFuZCB0aGUgYWJzZW5jZSBvZiB0aGUgYXR0cmlidXRlIHJlcHJlc2VudHMgdGhlIGZhbHNlIHZhbHVlLlxuICAgICovXG4gICAgdmFyIGJvb2xlYW5BdHRyaWJ1dGVzID0ge1xuICAgICAgICBjaGVja2VkOiAxLFxuICAgICAgICBjb21wYWN0OiAxLFxuICAgICAgICBkZWNsYXJlOiAxLFxuICAgICAgICBkZWZlcjogMSxcbiAgICAgICAgZGlzYWJsZWQ6IDEsXG4gICAgICAgIGlzbWFwOiAxLFxuICAgICAgICBtdWx0aXBsZTogMSxcbiAgICAgICAgbm9ocmVmOiAxLFxuICAgICAgICBub3Jlc2l6ZTogMSxcbiAgICAgICAgbm9zaGFkZTogMSxcbiAgICAgICAgbm93cmFwOiAxLFxuICAgICAgICByZWFkb25seTogMSxcbiAgICAgICAgc2VsZWN0ZWQ6IDFcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRCb29sZWFuQXR0cmlidXRlcyA9IGZ1bmN0aW9uICgpe1xuICAgICAgICByZXR1cm4gYm9vbGVhbkF0dHJpYnV0ZXM7XG4gICAgfTtcbiAgICB2YXIgc2V0Qm9vbGVhbkF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoIGJvb2xlYW5BdHRyaWJ1dGVzVG9TZXQgKXtcbiAgICAgICAgYm9vbGVhbkF0dHJpYnV0ZXMgPSBib29sZWFuQXR0cmlidXRlc1RvU2V0O1xuICAgIH07XG4gICAgdmFyIGlzQm9vbGVhbkF0dHJpYnV0ZSA9IGZ1bmN0aW9uICggYXR0cmlidXRlICl7XG4gICAgICAgIHJldHVybiBib29sZWFuQXR0cmlidXRlc1sgYXR0cmlidXRlIF0gPT09IDE7XG4gICAgfTtcbiAgICAvKiBFbmQgQm9vbGVhbiBhdHRyaWJ1dGVzICovXG4gICAgXG4gICAgLyogXG4gICAgICAgIEFsdCBhdHRyaWJ1dGVzOlxuICAgICAgICBBdHRyaWJ1dGVzIHdoaWNoIGRvbid0IHN1cHBvcnQgc2V0QXR0cmlidXRlKCkuXG4gICAgKi9cbiAgICB2YXIgYWx0QXR0cmlidXRlcyA9IHtcbiAgICAgICAgY2xhc3NOYW1lOiAxLFxuICAgICAgICBjbGFzczogMSxcbiAgICAgICAgaHJlZjogMSxcbiAgICAgICAgaHRtbEZvcjogMSxcbiAgICAgICAgaWQ6IDEsXG4gICAgICAgIGlubmVySFRNTDogMSxcbiAgICAgICAgbGFiZWw6IDEsXG4gICAgICAgIHN0eWxlOiAxLFxuICAgICAgICBzcmM6IDEsXG4gICAgICAgIHRleHQ6IDEsXG4gICAgICAgIHRpdGxlOiAxLFxuICAgICAgICB2YWx1ZTogMVxuICAgIH07XG4gICAgLy8gQWxsIGJvb2xlYW5BdHRyaWJ1dGVzIGFyZSBhbHNvIGFsdEF0dHJpYnV0ZXNcbiAgICB1dGlscy5leHRlbmQoIGFsdEF0dHJpYnV0ZXMsIGJvb2xlYW5BdHRyaWJ1dGVzICk7XG4gICAgXG4gICAgdmFyIGdldEFsdEF0dHJpYnV0ZXMgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgcmV0dXJuIGFsdEF0dHJpYnV0ZXM7XG4gICAgfTtcbiAgICB2YXIgc2V0QWx0QXR0cmlidXRlcyA9IGZ1bmN0aW9uICggYWx0QXR0cmlidXRlc1RvU2V0ICl7XG4gICAgICAgIGFsdEF0dHJpYnV0ZXMgPSBhbHRBdHRyaWJ1dGVzVG9TZXQ7XG4gICAgfTtcbiAgICB2YXIgaXNBbHRBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoIGF0dHJpYnV0ZSApe1xuICAgICAgICByZXR1cm4gYWx0QXR0cmlidXRlc1sgYXR0cmlidXRlIF0gPT09IDE7XG4gICAgfTtcbiAgICAvKiBFbmQgQWx0IGF0dHJpYnV0ZXMgKi9cbiAgICBcbiAgICAvKiBFcnJvcnMgKi9cbiAgICB2YXIgZGVmYXVsdEVycm9yRnVuY3Rpb24gPSBmdW5jdGlvbiggZXJyb3IgKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgbXNnID0gQXJyYXkuaXNBcnJheSggZXJyb3IgKT9cbiAgICAgICAgICAgIGVycm9yLmpvaW4oICdcXG4nICk6XG4gICAgICAgICAgICBlcnJvcjtcbiAgICAgICAgXG4gICAgICAgIHdpbmRvdy5hbGVydCggbXNnICk7XG4gICAgICAgIFxuICAgICAgICB0aHJvdyBtc2c7XG4gICAgfTtcbiAgICB2YXIgZXJyb3JGdW5jdGlvbiA9IGRlZmF1bHRFcnJvckZ1bmN0aW9uO1xuICAgIHZhciBzZXRFcnJvckZ1bmN0aW9uID0gZnVuY3Rpb24oIF9lcnJvckZ1bmN0aW9uICl7XG4gICAgICAgIHNlbGYuZXJyb3JGdW5jdGlvbiA9IF9lcnJvckZ1bmN0aW9uO1xuICAgIH07XG4gICAgdmFyIGFzeW5jRXJyb3IgPSBmdW5jdGlvbiggdXJsLCBlcnJvck1lc3NhZ2UsIGZhaWxDYWxsYmFjayApe1xuXG4gICAgICAgIHZhciBtc2cgPSAnRXJyb3IgdHJ5aW5nIHRvIGdldCAnICsgdXJsICsgJzogJyArIGVycm9yTWVzc2FnZTtcbiAgICAgICAgaWYgKCBmYWlsQ2FsbGJhY2sgKXtcbiAgICAgICAgICAgIGZhaWxDYWxsYmFjayggbXNnICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBlcnJvckZ1bmN0aW9uKCBtc2cgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgLyogRW5kIGVycm9ycyAqL1xuICAgIFxuICAgIC8qIFJlcGVhdCAqL1xuICAgIHZhciByZXBlYXQgPSBmdW5jdGlvbiggaW5kZXgsIGxlbmd0aCwgb2Zmc2V0ICl7XG4gICAgICAgIHJldHVybiBuZXcgTG9vcEl0ZW0oIGluZGV4LCBsZW5ndGgsIG9mZnNldCApO1xuICAgIH07XG4gICAgLyogRW5kIHJlcGVhdCovXG4gICAgXG4gICAgLyogRm9sZGVyIGRpY3Rpb25hcmllcyAqL1xuICAgIHZhciBmb2xkZXJEaWN0aW9uYXJpZXMgPSBbXTtcbiAgICB2YXIgc2V0Rm9sZGVyRGljdGlvbmFyaWVzID0gZnVuY3Rpb24oIF9mb2xkZXJEaWN0aW9uYXJpZXMgKXtcbiAgICAgICAgZm9sZGVyRGljdGlvbmFyaWVzID0gX2ZvbGRlckRpY3Rpb25hcmllcztcbiAgICB9O1xuICAgIHZhciBnZXRGb2xkZXJEaWN0aW9uYXJpZXMgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gZm9sZGVyRGljdGlvbmFyaWVzO1xuICAgIH07XG4gICAgLyogRW5kIGZvbGRlciBkaWN0aW9uYXJpZXMgKi9cbiAgICBcbiAgICAvKiBTdHJpY3QgbW9kZSAgKi9cbiAgICB2YXIgc3RyaWN0TW9kZSA9IGZhbHNlO1xuICAgIHZhciBzZXRTdHJpY3RNb2RlID0gZnVuY3Rpb24oIF9zdHJpY3RNb2RlICl7XG4gICAgICAgIHN0cmljdE1vZGUgPSBfc3RyaWN0TW9kZTtcbiAgICB9O1xuICAgIHZhciBpc1N0cmljdE1vZGUgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaWN0TW9kZTtcbiAgICB9O1xuICAgIC8qIEVuZCBzdHJpY3QgbW9kZSAgKi9cbiAgICBcbiAgICAvKiBFeHByZXNzaW9uIGNvdW50ZXIgKi9cbiAgICB2YXIgZXhwcmVzc2lvbkNvdW50ZXIgPSAwO1xuICAgIHZhciBuZXh0RXhwcmVzc2lvbkNvdW50ZXIgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gKytleHByZXNzaW9uQ291bnRlcjtcbiAgICB9O1xuICAgIHZhciBzZXRFeHByZXNzaW9uQ291bnRlciA9IGZ1bmN0aW9uKCBfZXhwcmVzc2lvbkNvdW50ZXIgKXtcbiAgICAgICAgZXhwcmVzc2lvbkNvdW50ZXIgPSBfZXhwcmVzc2lvbkNvdW50ZXI7XG4gICAgfTtcbiAgICAvKiBFbmQgZXhwcmVzc2lvbiBjb3VudGVyICovXG4gICAgXG4gICAgLyogUnVuIGNvdW50ZXIgKi9cbiAgICB2YXIgcnVuQ291bnRlciA9IDA7XG4gICAgdmFyIG5leHRSdW5Db3VudGVyID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICsrcnVuQ291bnRlcjtcbiAgICB9O1xuICAgIC8qIEVuZCBydW4gY291bnRlciAqL1xuICAgIFxuICAgIC8qIEFuaW1hdGlvbiBtYW5hZ2VycyAqL1xuICAgIHZhciBkZWZhdWx0QW5pbWF0aW9uTWFuYWdlciA9IENTU0FuaW1hdGlvbk1hbmFnZXI7XG4gICAgdmFyIGFuaW1hdGlvbk1hbmFnZXIgPSBkZWZhdWx0QW5pbWF0aW9uTWFuYWdlcjtcbiAgICB2YXIgZ2V0QW5pbWF0aW9uTWFuYWdlciA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBhbmltYXRpb25NYW5hZ2VyO1xuICAgIH07XG4gICAgdmFyIHNldEFuaW1hdGlvbk1hbmFnZXIgPSBmdW5jdGlvbiggX2FuaW1hdGlvbk1hbmFnZXIgKXtcbiAgICAgICAgYW5pbWF0aW9uTWFuYWdlciA9IF9hbmltYXRpb25NYW5hZ2VyO1xuICAgIH07XG4gICAgLyogRW5kIGFuaW1hdGlvbiBtYW5hZ2VycyovXG4gICAgXG4gICAgdmFyIHNlbGYgPSB7XG4gICAgICAgIGdldFRhZ3M6IGdldFRhZ3MsXG4gICAgICAgIHNldFRhZ3M6IHNldFRhZ3MsXG4gICAgICAgIGdldFRhbDogZ2V0VGFsLFxuICAgICAgICBnZXRGb3JtYXR0ZXI6IGdldEZvcm1hdHRlcixcbiAgICAgICAgcmVnaXN0ZXJGb3JtYXR0ZXI6IHJlZ2lzdGVyRm9ybWF0dGVyLFxuICAgICAgICB1bnJlZ2lzdGVyRm9ybWF0dGVyOiB1bnJlZ2lzdGVyRm9ybWF0dGVyLFxuICAgICAgICBnZXRDb25mOiBnZXRDb25mLFxuICAgICAgICBzZXRDb25mOiBzZXRDb25mLFxuICAgICAgICBnZXRMb2dnZXI6IGdldExvZ2dlcixcbiAgICAgICAgc2V0TG9nZ2VyOiBzZXRMb2dnZXIsXG4gICAgICAgIHVzZU9yaWdpbmFsVGFnczogdXNlT3JpZ2luYWxUYWdzLFxuICAgICAgICBnZXRCb29sZWFuQXR0cmlidXRlczogZ2V0Qm9vbGVhbkF0dHJpYnV0ZXMsXG4gICAgICAgIHNldEJvb2xlYW5BdHRyaWJ1dGVzOiBzZXRCb29sZWFuQXR0cmlidXRlcyxcbiAgICAgICAgaXNCb29sZWFuQXR0cmlidXRlOiBpc0Jvb2xlYW5BdHRyaWJ1dGUsXG4gICAgICAgIGdldEFsdEF0dHJpYnV0ZXM6IGdldEFsdEF0dHJpYnV0ZXMsXG4gICAgICAgIHNldEFsdEF0dHJpYnV0ZXM6IHNldEFsdEF0dHJpYnV0ZXMsXG4gICAgICAgIGlzQWx0QXR0cmlidXRlOiBpc0FsdEF0dHJpYnV0ZSxcbiAgICAgICAgZXJyb3JGdW5jdGlvbjogZXJyb3JGdW5jdGlvbixcbiAgICAgICAgc2V0RXJyb3JGdW5jdGlvbjogc2V0RXJyb3JGdW5jdGlvbixcbiAgICAgICAgYXN5bmNFcnJvcjogYXN5bmNFcnJvcixcbiAgICAgICAgcmVwZWF0OiByZXBlYXQsXG4gICAgICAgIHNldEZvbGRlckRpY3Rpb25hcmllczogc2V0Rm9sZGVyRGljdGlvbmFyaWVzLFxuICAgICAgICBnZXRGb2xkZXJEaWN0aW9uYXJpZXM6IGdldEZvbGRlckRpY3Rpb25hcmllcyxcbiAgICAgICAgc2V0U3RyaWN0TW9kZTogc2V0U3RyaWN0TW9kZSxcbiAgICAgICAgaXNTdHJpY3RNb2RlOiBpc1N0cmljdE1vZGUsXG4gICAgICAgIG5leHRFeHByZXNzaW9uQ291bnRlcjogbmV4dEV4cHJlc3Npb25Db3VudGVyLFxuICAgICAgICBzZXRFeHByZXNzaW9uQ291bnRlcjogc2V0RXhwcmVzc2lvbkNvdW50ZXIsXG4gICAgICAgIG5leHRSdW5Db3VudGVyOiBuZXh0UnVuQ291bnRlcixcbiAgICAgICAgZ2V0QW5pbWF0aW9uTWFuYWdlcjogZ2V0QW5pbWF0aW9uTWFuYWdlcixcbiAgICAgICAgc2V0QW5pbWF0aW9uTWFuYWdlcjogc2V0QW5pbWF0aW9uTWFuYWdlclxuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHNlbGY7XG59KSgpO1xuIiwiLypcbiAgICBBZGRFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgYXJpdGhtZXRoaWNIZWxwZXIgPSByZXF1aXJlKCAnLi9hcml0aG1ldGhpY0hlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBBZGRFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgcmV0dXJuIGFyaXRobWV0aGljSGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QsIFxuICAgICAgICAgICAgQWRkRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCB0b3RhbCwgdmFsdWUgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWwgKyB2YWx1ZTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5BZGRFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5BZGRFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5hZGRFeHByZXNzaW9uO1xufTtcbkFkZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiA9ICdhZGQnO1xuQWRkRXhwcmVzc2lvbi5nZXRJZCA9IEFkZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbjtcblxuQWRkRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYXJpdGhtZXRoaWNIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgQWRkRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uIFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IEFkZEV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQWRkRXhwcmVzc2lvbjtcbiIsIi8qIFxuICAgIGFyaXRobWV0aGljSGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG4gICAgdmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbiAgICB2YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZywgdGFnICkge1xuICAgICAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG5cbiAgICAgICAgaWYgKCBzdHJpbmcubGVuZ3RoID09PSAwICkge1xuICAgICAgICAgICAgdGhyb3cgdGFnICsgXCIgZXhwcmVzc2lvbiB2b2lkLlwiO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICBmYWxzZSBcbiAgICAgICAgKTtcblxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGRMaXN0KCBzZWdtZW50cyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHN0cmluZywgc2NvcGUsIGV4cHJlc3Npb25MaXN0LCBtYXRoT3BlcmF0aW9uLCBhcml0aG1ldGhpY0Z1bmN0aW9uICkge1xuICAgICAgICBcbiAgICAgICAgLy8gRXZhbHVhdGUgc2VnbWVudHNcbiAgICAgICAgdmFyIHJlc3VsdCA9IDA7XG4gICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGV4cHJlc3Npb25MaXN0Lmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uTGlzdFsgaSBdO1xuICAgICAgICAgICAgdmFyIGV2YWx1YXRlZCA9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICggISBBcnJheS5pc0FycmF5KCBldmFsdWF0ZWQgKSApeyBcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIG51bWVyaWMgdmFsdWVcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBwcm9jZXNzSW50ZWdlciggXG4gICAgICAgICAgICAgICAgICAgIGMrKywgXG4gICAgICAgICAgICAgICAgICAgIGV2YWx1YXRlZCwgXG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCwgXG4gICAgICAgICAgICAgICAgICAgIGFyaXRobWV0aGljRnVuY3Rpb24sIFxuICAgICAgICAgICAgICAgICAgICBtYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbiApO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAvLyBQcm9jZXNzIGFycmF5IG9mIG51bWVyaWNcbiAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaiA9IDA7IGogPCBldmFsdWF0ZWQubGVuZ3RoOyBqKysgKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHByb2Nlc3NJbnRlZ2VyKCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGMrKywgXG4gICAgICAgICAgICAgICAgICAgICAgICBldmFsdWF0ZWRbIGogXSwgXG4gICAgICAgICAgICAgICAgICAgICAgICByZXN1bHQsIFxuICAgICAgICAgICAgICAgICAgICAgICAgYXJpdGhtZXRoaWNGdW5jdGlvbiwgXG4gICAgICAgICAgICAgICAgICAgICAgICBtYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb24gKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggYyA8IDIgKSB7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgaW4gZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIuIE9ubHkgb25lIGVsZW1lbnQgaW4gZXZhbHVhdGlvbiBvZiBcIicgKyBtYXRoT3BlcmF0aW9uIFxuICAgICAgICAgICAgICAgICsgJ1wiIGV4cHJlc3Npb24sIHBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIG1vcmUuJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBwcm9jZXNzSW50ZWdlciA9IGZ1bmN0aW9uKCBjLCB2YWx1ZSwgcmVzdWx0LCBhcml0aG1ldGhpY0Z1bmN0aW9uLCBtYXRoT3BlcmF0aW9uLCBleHByZXNzaW9uICl7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgZXZhbHVhdGVIZWxwZXIuaXNOdW1iZXIoIHZhbHVlICkgKSB7XG4gICAgICAgICAgICB0aHJvdyBcIkVycm9yIHRyeWluZyBkb2luZyBtYXRoIG9wZXJhdGlvbiwgdmFsdWUgJ1wiICsgdmFsdWUgXG4gICAgICAgICAgICAgICAgICAgICsgXCInIGlzIG5vdCBhIHZhbGlkIG51bWJlciBpbiBleHByZXNzaW9uICdcIiArIG1hdGhPcGVyYXRpb24gKyAnICcgKyBleHByZXNzaW9uICsgXCInXCI7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gYyA9PSAwPyBOdW1iZXIoIHZhbHVlICk6IGFyaXRobWV0aGljRnVuY3Rpb24oIHJlc3VsdCwgTnVtYmVyKCB2YWx1ZSApICk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBidWlsZDogYnVpbGQsXG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZVxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBEaXZpZGVFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgYXJpdGhtZXRoaWNIZWxwZXIgPSByZXF1aXJlKCAnLi9hcml0aG1ldGhpY0hlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBEaXZpZGVFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgcmV0dXJuIGFyaXRobWV0aGljSGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QsIFxuICAgICAgICAgICAgRGl2aWRlRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCB0b3RhbCwgdmFsdWUgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWwgLyB2YWx1ZTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb25MaXN0ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkRpdmlkZUV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbkRpdmlkZUV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmRpdkV4cHJlc3Npb247XG59O1xuRGl2aWRlRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uID0gJ2RpdmlkZSc7XG5EaXZpZGVFeHByZXNzaW9uLmdldElkID0gRGl2aWRlRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uO1xuXG5EaXZpZGVFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBhcml0aG1ldGhpY0hlbHBlci5idWlsZCggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBEaXZpZGVFeHByZXNzaW9uLm1hdGhPcGVyYXRpb24gXG4gICAgKTtcblxuICAgIHJldHVybiBuZXcgRGl2aWRlRXhwcmVzc2lvbiggc3RyaW5nLCBleHByZXNzaW9uTGlzdCApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBEaXZpZGVFeHByZXNzaW9uO1xuIiwiLypcbiAgICBNb2RFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgYXJpdGhtZXRoaWNIZWxwZXIgPSByZXF1aXJlKCAnLi9hcml0aG1ldGhpY0hlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBNb2RFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgcmV0dXJuIGFyaXRobWV0aGljSGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QsIFxuICAgICAgICAgICAgTW9kRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCB0b3RhbCwgdmFsdWUgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWwgJSB2YWx1ZTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Nb2RFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5Nb2RFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5tb2RFeHByZXNzaW9uO1xufTtcbk1vZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiA9ICdtb2QnO1xuTW9kRXhwcmVzc2lvbi5nZXRJZCA9IE1vZEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbjtcblxuTW9kRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYXJpdGhtZXRoaWNIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgTW9kRXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uIFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IE1vZEV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTW9kRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgTXVsdGlwbHlFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgYXJpdGhtZXRoaWNIZWxwZXIgPSByZXF1aXJlKCAnLi9hcml0aG1ldGhpY0hlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBNdWx0aXBseUV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbkxpc3RUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGV4cHJlc3Npb25MaXN0VG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcblxuICAgICAgICByZXR1cm4gYXJpdGhtZXRoaWNIZWxwZXIuZXZhbHVhdGUoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICBleHByZXNzaW9uTGlzdCwgXG4gICAgICAgICAgICBNdWx0aXBseUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiwgXG4gICAgICAgICAgICBmdW5jdGlvbiggdG90YWwsIHZhbHVlICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRvdGFsICogdmFsdWU7XG4gICAgICAgICAgICB9IFxuICAgICAgICApO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5NdWx0aXBseUV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbk11bHRpcGx5RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkubXVsRXhwcmVzc2lvbjtcbn07XG5NdWx0aXBseUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiA9ICdtdWx0aXBseSc7XG5NdWx0aXBseUV4cHJlc3Npb24uZ2V0SWQgPSBNdWx0aXBseUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbjtcblxuTXVsdGlwbHlFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBhcml0aG1ldGhpY0hlbHBlci5idWlsZCggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBNdWx0aXBseUV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBNdWx0aXBseUV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTXVsdGlwbHlFeHByZXNzaW9uO1xuIiwiLypcbiAgICBTdWJzdHJhY3RFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgYXJpdGhtZXRoaWNIZWxwZXIgPSByZXF1aXJlKCAnLi9hcml0aG1ldGhpY0hlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBTdWJzdHJhY3RFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgcmV0dXJuIGFyaXRobWV0aGljSGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgIHN0cmluZyxcbiAgICAgICAgICAgIHNjb3BlLFxuICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QsIFxuICAgICAgICAgICAgU3Vic3RyYWN0RXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uLCBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCB0b3RhbCwgdmFsdWUgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdG90YWwgLSB2YWx1ZTtcbiAgICAgICAgICAgIH0gXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5TdWJzdHJhY3RFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5TdWJzdHJhY3RFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5zdWJFeHByZXNzaW9uO1xufTtcblN1YnN0cmFjdEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbiA9ICdzdWJzdHJhY3QnO1xuU3Vic3RyYWN0RXhwcmVzc2lvbi5nZXRJZCA9IFN1YnN0cmFjdEV4cHJlc3Npb24ubWF0aE9wZXJhdGlvbjtcblxuU3Vic3RyYWN0RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYXJpdGhtZXRoaWNIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgU3Vic3RyYWN0RXhwcmVzc2lvbi5tYXRoT3BlcmF0aW9uIFxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IFN1YnN0cmFjdEV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU3Vic3RyYWN0RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgQW5kRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIEFuZEV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbkxpc3RUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGV4cHJlc3Npb25MaXN0VG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcblxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBleHByZXNzaW9uTGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkxpc3RbIGkgXTtcbiAgICAgICAgICAgIGlmICggISBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZUJvb2xlYW4oIHNjb3BlLCBleHByZXNzaW9uICkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb25MaXN0ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkFuZEV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbkFuZEV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmFuZEV4cHJlc3Npb247XG59O1xuQW5kRXhwcmVzc2lvbi5nZXRJZCA9IEFuZEV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5BbmRFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgYm9vbEhlbHBlciA9IHJlcXVpcmUoICcuL2Jvb2xIZWxwZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gYm9vbEhlbHBlci5idWlsZCggc3RyaW5nLCAnQW5kJyApO1xuXG4gICAgcmV0dXJuIG5ldyBBbmRFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFuZEV4cHJlc3Npb247XG4iLCIvKiBcbiAgICBib29sSGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHsgICAgXG4gICAgdmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbiAgICB2YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgYnVpbGQgPSBmdW5jdGlvbiggcywgdGFnICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBzdHJpbmcubGVuZ3RoID09PSAwICkge1xuICAgICAgICAgICAgdGhyb3cgdGFnICsgJyBleHByZXNzaW9uIHZvaWQuJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25EZWxpbWl0ZXIsIFxuICAgICAgICAgICAgICAgIGZhbHNlICk7XG4gICAgICAgIGlmICggc2VnbWVudHMuY291bnRUb2tlbnMoKSA9PT0gMSApIHtcbiAgICAgICAgICAgIHRocm93ICdTeW50YXggZXJyb3IgaW4gZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIuIE9ubHkgb25lIGVsZW1lbnQgaW4gJyArIHRhZyArICcgZXhwcmVzc2lvbiwgcGxlYXNlIGFkZCBhdCBsZWFzdCBvbmUgbW9yZS4nO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGRMaXN0KCBzZWdtZW50cyApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGQ6IGJ1aWxkXG4gICAgfTtcbn0pKCk7XG4iLCIvKlxuICAgIENvbmRFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcblxudmFyIENvbmRFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb24xVG9BcHBseSwgZXhwcmVzc2lvbjJUb0FwcGx5LCBleHByZXNzaW9uM1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24xID0gZXhwcmVzc2lvbjFUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uMiA9IGV4cHJlc3Npb24yVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbjMgPSBleHByZXNzaW9uM1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVCb29sZWFuKCBzY29wZSwgZXhwcmVzc2lvbjEgKT9cbiAgICAgICAgICAgIGV4cHJlc3Npb24yLmV2YWx1YXRlKCBzY29wZSApOlxuICAgICAgICAgICAgZXhwcmVzc2lvbjMuZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uMSwgZXhwcmVzc2lvbjIsIGV4cHJlc3Npb24zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkNvbmRFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5Db25kRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuY29uZEV4cHJlc3Npb247XG59O1xuQ29uZEV4cHJlc3Npb24uZ2V0SWQgPSBDb25kRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkNvbmRFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHMgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcblxuICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgdGhyb3cgJ0NvbmQgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgfVxuXG4gICAgdmFyIHNlZ21lbnRzID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25EZWxpbWl0ZXIsIFxuICAgICAgICAgICAgZmFsc2UgKTtcbiAgICBpZiAoIHNlZ21lbnRzLmNvdW50VG9rZW5zKCkgIT09IDMgKSB7XG4gICAgICAgIHRocm93ICdTeW50YXggZXJyb3IgaW4gY29uZCBleHByZXNzaW9uIFwiJyArIHN0cmluZyArICdcIi4gMyBlbGVtZW50IGFyZSBuZWVkZWQuJztcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IENvbmRFeHByZXNzaW9uKCBcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKSwgXG4gICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzZWdtZW50cy5uZXh0VG9rZW4oKSApLCBcbiAgICAgICAgZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICkgXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQ29uZEV4cHJlc3Npb247XG4iLCIvKlxuICAgIE5vdEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBOb3RFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiAhIGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlQm9vbGVhbiggc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Ob3RFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5Ob3RFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5ub3RFeHByZXNzaW9uO1xufTtcbk5vdEV4cHJlc3Npb24uZ2V0SWQgPSBOb3RFeHByZXNzaW9uLmdldFByZWZpeDtcblxuTm90RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0cmluZyApO1xuICAgIFxuICAgIHJldHVybiBuZXcgTm90RXhwcmVzc2lvbiggc3RyaW5nLCBleHByZXNzaW9uICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE5vdEV4cHJlc3Npb247XG4iLCIvKlxuICAgIE9yRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIE9yRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uTGlzdFRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gZXhwcmVzc2lvbkxpc3RUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGV4cHJlc3Npb25MaXN0Lmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uTGlzdFsgaSBdO1xuICAgICAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZUJvb2xlYW4oIHNjb3BlLCBleHByZXNzaW9uICkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuT3JFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5PckV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLm9yRXhwcmVzc2lvbjtcbn07XG5PckV4cHJlc3Npb24uZ2V0SWQgPSBPckV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5PckV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHZhciBib29sSGVscGVyID0gcmVxdWlyZSggJy4vYm9vbEhlbHBlci5qcycgKTtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBib29sSGVscGVyLmJ1aWxkKCBzdHJpbmcsICdPcicgKTtcblxuICAgIHJldHVybiBuZXcgT3JFeHByZXNzaW9uKCBzdHJpbmcsIGV4cHJlc3Npb25MaXN0ICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9yRXhwcmVzc2lvbjtcbiIsIi8qIFxuICAgIGNvbXBhcmlzb25IZWxwZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG4gICAgdmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbiAgICB2YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIHMsIHRhZyApIHtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgICAgICBcbiAgICAgICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBzdHJpbmcubGVuZ3RoID09PSAwICkge1xuICAgICAgICAgICAgdGhyb3cgdGFnICsgJyBleHByZXNzaW9uIHZvaWQuJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25EZWxpbWl0ZXIsIFxuICAgICAgICAgICAgICAgIGZhbHNlICk7XG4gICAgICAgIGlmICggc2VnbWVudHMuY291bnRUb2tlbnMoKSAhPT0gMiApIHtcbiAgICAgICAgICAgIHRocm93ICdXcm9uZyBudW1iZXIgb2YgZWxlbWVudHMgaW4gZXhwcmVzc2lvbiBcIicgKyBzdHJpbmcgKyAnXCIsICcgKyB0YWcgKyAnIGV4cHJlc3Npb25zIG9ubHkgc3VwcG9ydCB0d28uJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBleHByZXNzaW9uMSA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzZWdtZW50cy5uZXh0VG9rZW4oKSApO1xuICAgICAgICB2YXIgZXhwcmVzc2lvbjIgPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBleHByZXNzaW9uMTogZXhwcmVzc2lvbjEsXG4gICAgICAgICAgICBleHByZXNzaW9uMjogZXhwcmVzc2lvbjJcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSwgdmFsdWVFeHByZXNzaW9uMSwgdmFsdWVFeHByZXNzaW9uMiApIHtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBudW1iZXIxOiBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZU51bWJlciggc2NvcGUsIHZhbHVlRXhwcmVzc2lvbjEgKSxcbiAgICAgICAgICAgIG51bWJlcjI6IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlTnVtYmVyKCBzY29wZSwgdmFsdWVFeHByZXNzaW9uMiApXG4gICAgICAgIH07XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBidWlsZDogYnVpbGQsXG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZVxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBFcXVhbHNFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIEVxdWFsc0V4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgYXJnc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGFyZ3MgPSBhcmdzVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIGFyZzAgPSBhcmdzWyAwIF07XG4gICAgICAgIHZhciByZXN1bHQwID0gYXJnMC5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMTsgaSA8IGFyZ3MubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgYXJnID0gYXJnc1sgaSBdO1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGFyZy5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgIGlmICggcmVzdWx0MCAhPSByZXN1bHQgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBhcmdzICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG5cbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuRXF1YWxzRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuRXF1YWxzRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuZXF1YWxzRXhwcmVzc2lvbjtcbn07XG5FcXVhbHNFeHByZXNzaW9uLmdldElkID0gRXF1YWxzRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkVxdWFsc0V4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgIFxuICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgdGhyb3cgJ0VxdWFscyBleHByZXNzaW9uIHZvaWQuJztcbiAgICB9XG5cbiAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvbkRlbGltaXRlciwgXG4gICAgICAgICAgICBmYWxzZSApO1xuICAgIGlmICggc2VnbWVudHMuY291bnRUb2tlbnMoKSA9PT0gMSApIHtcbiAgICAgICAgdGhyb3cgJ09ubHkgb25lIGVsZW1lbnQgaW4gZXF1YWxzIGV4cHJlc3Npb24gXCInICsgc3RyaW5nICsgJ1wiLCBwbGVhc2UgYWRkIGF0IGxlYXN0IG9uZSBtb3JlLic7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBFcXVhbHNFeHByZXNzaW9uKCBcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZExpc3QoIHNlZ21lbnRzICkgXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRXF1YWxzRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgR3JlYXRlckV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBjb21wYXJpc29uSGVscGVyID0gcmVxdWlyZSggJy4vY29tcGFyaXNvbkhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBHcmVhdGVyRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uMVRvQXBwbHksIGV4cHJlc3Npb24yVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbjEgPSBleHByZXNzaW9uMVRvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24yID0gZXhwcmVzc2lvbjJUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgbnVtYmVycyA9IGNvbXBhcmlzb25IZWxwZXIuZXZhbHVhdGUoIHNjb3BlLCBleHByZXNzaW9uMSwgZXhwcmVzc2lvbjIgKTtcbiAgICAgICAgcmV0dXJuIG51bWJlcnMubnVtYmVyMSA+IG51bWJlcnMubnVtYmVyMjtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbjEsIGV4cHJlc3Npb24yICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkdyZWF0ZXJFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5HcmVhdGVyRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuZ3JlYXRlckV4cHJlc3Npb247XG59O1xuR3JlYXRlckV4cHJlc3Npb24uZ2V0SWQgPSBHcmVhdGVyRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkdyZWF0ZXJFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgZGF0YSA9IGNvbXBhcmlzb25IZWxwZXIuYnVpbGQoIHN0cmluZywgJ2dyZWF0ZXInICk7XG5cbiAgICByZXR1cm4gbmV3IEdyZWF0ZXJFeHByZXNzaW9uKCBzdHJpbmcsIGRhdGEuZXhwcmVzc2lvbjEsIGRhdGEuZXhwcmVzc2lvbjIgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gR3JlYXRlckV4cHJlc3Npb247XG4iLCIvKlxuICAgIEluRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBJbkV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbkxpc3RUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGV4cHJlc3Npb25MaXN0VG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIGV4cHJlc3Npb24wID0gZXhwcmVzc2lvbkxpc3RbIDAgXTtcbiAgICAgICAgdmFyIGV2YWx1YXRlZDAgPSBleHByZXNzaW9uMC5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMTsgaSA8IGV4cHJlc3Npb25MaXN0Lmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uTGlzdFsgaSBdO1xuICAgICAgICAgICAgdmFyIGV2YWx1YXRlZCA9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggZXZhbHVhdGVkICkgKXsgXG4gICAgICAgICAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgZXZhbHVhdGVkLmxlbmd0aDsgaisrICkge1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGV2YWx1YXRlZDAgPT0gZXZhbHVhdGVkWyBqIF0gKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIGV2YWx1YXRlZDAgPT0gZXZhbHVhdGVkICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbkxpc3QgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuSW5FeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5JbkV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmluRXhwcmVzc2lvbjtcbn07XG5JbkV4cHJlc3Npb24uZ2V0SWQgPSBJbkV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5JbkV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgIFxuICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgdGhyb3cgJ0luIGV4cHJlc3Npb24gdm9pZC4nO1xuICAgIH1cblxuICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlIFxuICAgICk7XG4gICAgaWYgKCBzZWdtZW50cy5jb3VudFRva2VucygpID09PSAxICkge1xuICAgICAgICB0aHJvdyAnT25seSBvbmUgZWxlbWVudCBpbiBpbiBleHByZXNzaW9uIFwiJyArIHN0cmluZyArICdcIiwgcGxlYXNlIGFkZCBhdCBsZWFzdCBvbmUgbW9yZS4nO1xuICAgIH1cblxuICAgIHJldHVybiBuZXcgSW5FeHByZXNzaW9uKCBcbiAgICAgICAgc3RyaW5nLFxuICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZExpc3QoIHNlZ21lbnRzICkgXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSW5FeHByZXNzaW9uO1xuIiwiLypcbiAgICBMb3dlckV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBjb21wYXJpc29uSGVscGVyID0gcmVxdWlyZSggJy4vY29tcGFyaXNvbkhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBMb3dlckV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbjFUb0FwcGx5LCBleHByZXNzaW9uMlRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24xID0gZXhwcmVzc2lvbjFUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uMiA9IGV4cHJlc3Npb24yVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIG51bWJlcnMgPSBjb21wYXJpc29uSGVscGVyLmV2YWx1YXRlKCBzY29wZSwgZXhwcmVzc2lvbjEsIGV4cHJlc3Npb24yICk7XG4gICAgICAgIHJldHVybiBudW1iZXJzLm51bWJlcjEgPCBudW1iZXJzLm51bWJlcjI7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uMSwgZXhwcmVzc2lvbjIgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuTG93ZXJFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5Mb3dlckV4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLmxvd2VyRXhwcmVzc2lvbjtcbn07XG5Mb3dlckV4cHJlc3Npb24uZ2V0SWQgPSBMb3dlckV4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5Mb3dlckV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBkYXRhID0gY29tcGFyaXNvbkhlbHBlci5idWlsZCggc3RyaW5nLCAnbG93ZXInICk7XG5cbiAgICByZXR1cm4gbmV3IExvd2VyRXhwcmVzc2lvbiggc3RyaW5nLCBkYXRhLmV4cHJlc3Npb24xLCBkYXRhLmV4cHJlc3Npb24yICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IExvd2VyRXhwcmVzc2lvbjtcbiIsIi8qIFxuICAgIGV2YWx1YXRlSGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGVUb05vdE51bGwgPSBmdW5jdGlvbiggc2NvcGUsIGV4cHJlc3Npb24gKSB7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICByZXR1cm4gZXZhbHVhdGVkID09IHVuZGVmaW5lZD8gJ3VuZGVmaW5lZCc6IGV2YWx1YXRlZDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZUJvb2xlYW4gPSBmdW5jdGlvbiggc2NvcGUsIGV4cHJlc3Npb24gKSB7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBldmFsdWF0ZWQgPT09IHVuZGVmaW5lZFxuICAgICAgICAgICAgfHwgZXZhbHVhdGVkID09IG51bGxcbiAgICAgICAgICAgIHx8IGV2YWx1YXRlZCA9PSAnZmFsc2UnIFxuICAgICAgICAgICAgfHwgZXZhbHVhdGVkID09IGZhbHNlIFxuICAgICAgICAgICAgfHwgZXZhbHVhdGVkID09IDAgKXtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGVOdW1iZXIgPSBmdW5jdGlvbiggc2NvcGUsIGV4cHJlc3Npb24sIGVycm9yTWVzc2FnZVRvQXBwbHkgKSB7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGlzTnVtYmVyKCBldmFsdWF0ZWQgKSApe1xuICAgICAgICAgICAgdmFyIGVycm9yTWVzc2FnZSA9IFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZVRvQXBwbHk/IFxuICAgICAgICAgICAgICAgIGVycm9yTWVzc2FnZVRvQXBwbHk6IFxuICAgICAgICAgICAgICAgICdFeHByZXNzaW9uIFwiJyArIGV4cHJlc3Npb24gKyAnXCIgaXMgbm90IGEgdmFsaWQgbnVtYmVyLic7XG4gICAgICAgICAgICB0aHJvdyBlcnJvck1lc3NhZ2U7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBldmFsdWF0ZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaXNOdW1iZXIgPSBmdW5jdGlvbiggc3RyaW5nICl7XG4gICAgICAgIHJldHVybiAhIGlzTmFOKCBwYXJzZUZsb2F0KCBzdHJpbmcgKSApIHx8ICEgaXNGaW5pdGUoIHN0cmluZyApO1xuICAgIH07XG4gICAgLypcbiAgICB2YXIgZXZhbHVhdGVJbnRlZ2VyID0gZnVuY3Rpb24oIHNjb3BlLCBleHByZXNzaW9uLCBlcnJvck1lc3NhZ2VUb0FwcGx5ICkge1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBpc0ludGVnZXIoIGV2YWx1YXRlZCApICl7XG4gICAgICAgICAgICB2YXIgZXJyb3JNZXNzYWdlID0gXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlVG9BcHBseT8gXG4gICAgICAgICAgICAgICAgZXJyb3JNZXNzYWdlVG9BcHBseTogXG4gICAgICAgICAgICAgICAgJ0V4cHJlc3Npb24gXCInICsgZXhwcmVzc2lvbiArICdcIiBpcyBub3QgYSB2YWxpZCBpbnRlZ2VyLidcbiAgICAgICAgICAgIHRocm93IGVycm9yTWVzc2FnZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlZDtcbiAgICB9OyovXG4gICAgLypcbiAgICB2YXIgaXNJbnRlZ2VyID0gZnVuY3Rpb24oIHN0cmluZyApe1xuICAgICAgICByZXR1cm4gISBpc05hTiggcGFyc2VJbnQoIHN0cmluZyApICkgfHwgISBpc0Zpbml0ZSggc3RyaW5nICk7XG4gICAgfTsqL1xuICAgIFxuICAgIHZhciBldmFsdWF0ZUV4cHJlc3Npb25MaXN0ID0gZnVuY3Rpb24gKCBsaXN0LCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gbGlzdFsgaSBdO1xuICAgICAgICAgICAgcmVzdWx0LnB1c2goIGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICkgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBpc0RlZmF1bHQgPSBmdW5jdGlvbiggdmFsdWUgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlID09PSBjb250ZXh0LmdldENvbmYoKS5kZWZhdWx0VmFyVmFsdWU7XG4gICAgfTtcbiAgICB2YXIgaXNOb3RoaW5nID0gZnVuY3Rpb24oIHZhbHVlICl7XG4gICAgICAgIHJldHVybiB2YWx1ZSA9PT0gY29udGV4dC5nZXRDb25mKCkubm90aGluZ1ZhclZhbHVlO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGVUb05vdE51bGw6IGV2YWx1YXRlVG9Ob3ROdWxsLFxuICAgICAgICBldmFsdWF0ZUJvb2xlYW46IGV2YWx1YXRlQm9vbGVhbixcbiAgICAgICAgZXZhbHVhdGVOdW1iZXI6IGV2YWx1YXRlTnVtYmVyLFxuICAgICAgICAvL2V2YWx1YXRlSW50ZWdlcjogZXZhbHVhdGVJbnRlZ2VyLFxuICAgICAgICBpc051bWJlcjogaXNOdW1iZXIsXG4gICAgICAgIC8vaXNJbnRlZ2VyOiBpc0ludGVnZXIsXG4gICAgICAgIGV2YWx1YXRlRXhwcmVzc2lvbkxpc3Q6IGV2YWx1YXRlRXhwcmVzc2lvbkxpc3QsXG4gICAgICAgIGlzRGVmYXVsdDogaXNEZWZhdWx0LFxuICAgICAgICBpc05vdGhpbmc6IGlzTm90aGluZ1xuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBFeGlzdHNFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG5cbnZhciBFeGlzdHNFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZCAhPT0gZXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoICggZSApe1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb24gKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuRXhpc3RzRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuRXhpc3RzRXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkuZXhpc3RzRXhwcmVzc2lvbjtcbn07XG5FeGlzdHNFeHByZXNzaW9uLmdldElkID0gRXhpc3RzRXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkV4aXN0c0V4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHN0cmluZyApO1xuICAgIHJldHVybiBuZXcgRXhpc3RzRXhwcmVzc2lvbiggc3RyaW5nLCBleHByZXNzaW9uICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEV4aXN0c0V4cHJlc3Npb247XG4iLCIvKiBcbiAgICBleHByZXNzaW9uQnVpbGRlciBzaW5nbGV0b24gY2xhc3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuICAgIHZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbiAgICB2YXIgUGF0aEV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9wYXRoL3BhdGhFeHByZXNzaW9uLmpzJyApO1xuICAgIHZhciBleHByZXNzaW9uQ2FjaGUgPSByZXF1aXJlKCAnLi4vY2FjaGUvZXhwcmVzc2lvbkNhY2hlLmpzJyApO1xuICAgIC8qdmFyIGxvZyA9IHJlcXVpcmUoICcuLi9sb2dIZWxwZXIuanMnICk7Ki9cbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbk1hbmFnZXJzID0ge307XG4gICAgdmFyIHdpdGhvdXRQcmVmaXhFeHByZXNzaW9uTWFuYWdlcnMgPSB7fTtcbiAgICB2YXIgREVGQVVMVF9JRCA9IFBhdGhFeHByZXNzaW9uLmdldElkKCk7XG4gICAgXG4gICAgLyogUmVnaXN0ZXIgZXhwcmVzc2lvbiBtYW5hZ2VycyAqL1xuICAgIHZhciByZWdpc3RlciA9IGZ1bmN0aW9uKCBleHByZXNzaW9uc01hbmFnZXIsIGlkICkge1xuICAgICAgICBleHByZXNzaW9uTWFuYWdlcnNbIGlkIHx8IGV4cHJlc3Npb25zTWFuYWdlci5nZXRQcmVmaXgoKSB8fCBleHByZXNzaW9uc01hbmFnZXIuZ2V0SWQoKSBdID0gZXhwcmVzc2lvbnNNYW5hZ2VyO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGV4cHJlc3Npb25zTWFuYWdlci5yZW1vdmVQcmVmaXggJiYgZXhwcmVzc2lvbnNNYW5hZ2VyLmdldFByZWZpeCgpICl7XG4gICAgICAgICAgICB3aXRob3V0UHJlZml4RXhwcmVzc2lvbk1hbmFnZXJzWyBleHByZXNzaW9uc01hbmFnZXIuZ2V0UHJlZml4KCkgXSA9IGV4cHJlc3Npb25zTWFuYWdlcjtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdmFyIHVucmVnaXN0ZXIgPSBmdW5jdGlvbiggZXhwcmVzc2lvbnNNYW5hZ2VyLCBpZCApIHtcbiAgICAgICAgZGVsZXRlIGV4cHJlc3Npb25NYW5hZ2Vyc1sgaWQgfHwgZXhwcmVzc2lvbnNNYW5hZ2VyLmdldFByZWZpeCgpIHx8IGV4cHJlc3Npb25zTWFuYWdlci5nZXRJZCgpIF07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVnaXN0ZXJHZW5lcmFsUHVycG9zZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9leGlzdHNFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9mb3JtYXRFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9zdHJpbmdFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9wYXRoL3BhdGhFeHByZXNzaW9uLmpzJyApICk7XG4gICAgfTtcbiAgICB2YXIgcmVnaXN0ZXJDb21wYXJpc29uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2NvbXBhcmlzb24vZXF1YWxzRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vY29tcGFyaXNvbi9ncmVhdGVyRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vY29tcGFyaXNvbi9sb3dlckV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2NvbXBhcmlzb24vaW5FeHByZXNzaW9uLmpzJyApICk7XG4gICAgfTtcbiAgICB2YXIgcmVnaXN0ZXJBcml0aG1ldGljID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2FyaXRobWV0aGljL2FkZEV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2FyaXRobWV0aGljL3N1YnN0cmFjdEV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2FyaXRobWV0aGljL211bHRpcGx5RXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vYXJpdGhtZXRoaWMvZGl2aWRlRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vYXJpdGhtZXRoaWMvbW9kRXhwcmVzc2lvbi5qcycgKSApO1xuICAgIH07XG4gICAgdmFyIHJlZ2lzdGVyTG9naWNhbCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9ib29sL2FuZEV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2Jvb2wvY29uZEV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2Jvb2wvbm90RXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vYm9vbC9vckV4cHJlc3Npb24uanMnICkgKTtcbiAgICB9O1xuICAgIHZhciByZWdpc3RlckkxOG4gPSBmdW5jdGlvbigpe1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vaTE4bi90ckN1cnJlbmN5RXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vaTE4bi90ckRhdGVUaW1lRXhwcmVzc2lvbi5qcycgKSApO1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vaTE4bi90ck51bWJlckV4cHJlc3Npb24uanMnICkgKTtcbiAgICAgICAgcmVnaXN0ZXIoIHJlcXVpcmUoICcuL2kxOG4vdHJTdHJpbmdFeHByZXNzaW9uLmpzJyApICk7XG4gICAgfTtcbiAgICB2YXIgcmVnaXN0ZXJTY3JpcHRpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZWdpc3RlciggcmVxdWlyZSggJy4vc2NyaXB0aW5nL2phdmFzY3JpcHRFeHByZXNzaW9uLmpzJyApICk7XG4gICAgICAgIHJlZ2lzdGVyKCByZXF1aXJlKCAnLi9zY3JpcHRpbmcvcXVlcnlFeHByZXNzaW9uLmpzJyApICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVnaXN0ZXJBbGwgPSBmdW5jdGlvbigpe1xuICAgICAgICByZWdpc3RlckdlbmVyYWxQdXJwb3NlKCk7XG4gICAgICAgIHJlZ2lzdGVyQ29tcGFyaXNvbigpO1xuICAgICAgICByZWdpc3RlckFyaXRobWV0aWMoKTtcbiAgICAgICAgcmVnaXN0ZXJMb2dpY2FsKCk7XG4gICAgICAgIHJlZ2lzdGVySTE4bigpO1xuICAgICAgICByZWdpc3RlclNjcmlwdGluZygpO1xuICAgIH0oKTtcbiAgICAvKiBFbmQgUmVnaXN0ZXIgZXhwcmVzc2lvbiBtYW5hZ2VycyAqL1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcsIGZvcmNlICkge1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbkNhY2hlLmdldChcbiAgICAgICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmb3JjZUJ1aWxkKCBzdHJpbmcgKTtcbiAgICAgICAgICAgICAgICB9LCBcbiAgICAgICAgICAgICAgICBmb3JjZVxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGZvcmNlQnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgICAgICB2YXIgZWZmZWN0aXZlU3RyaW5nID0gcmVtb3ZlUGFyZW50aGVzaXNJZkFueSggc3RyaW5nLnRyaW0oKSApO1xuICAgICAgICB2YXIgaW5kZXggPSBlZmZlY3RpdmVTdHJpbmcuaW5kZXhPZiggY29udGV4dC5nZXRDb25mKCkuZXhwcmVzc2lvblN1ZmZpeCApO1xuICAgICAgICB2YXIgaWQgPSB1bmRlZmluZWQ7XG4gICAgICAgIHZhciBpc0RlZmF1bHQgPSBmYWxzZTtcbiAgICAgICAgXG4gICAgICAgIC8vIElzIHRoZSBkZWZhdWx0IGV4cHJlc3Npb24gdHlwZT8gSXMgcmVnaXN0ZXJlZD9cbiAgICAgICAgaWYgKCBpbmRleCAhPT0gLTEgKXtcbiAgICAgICAgICAgIGlkID0gZWZmZWN0aXZlU3RyaW5nLnN1YnN0cmluZyggMCwgaW5kZXggKSAgKyAnOic7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIElmIHRoZSBpZCBpcyBub3QgcmVzaXN0ZXJlZCBtdXN0IGJlIGEgcGF0aFxuICAgICAgICAgICAgaXNEZWZhdWx0ID0gISBleHByZXNzaW9uTWFuYWdlcnMuaGFzT3duUHJvcGVydHkoIGlkICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBpc0RlZmF1bHQgPSB0cnVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZW1vdmUgcHJlZml4IGFuZCBzZXQgaWQgaWYgaXQgaXMgZGVmYXVsdCBleHByZXNzaW9uIHR5cGVcbiAgICAgICAgdmFyIHJlbW92ZVByZWZpeCA9IGZhbHNlO1xuICAgICAgICB2YXIgZXhwcmVzc2lvbk1hbmFnZXIgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICggaXNEZWZhdWx0ICl7XG4gICAgICAgICAgICAvKmlkID0gREVGQVVMVF9JRDsqL1xuICAgICAgICAgICAgZXhwcmVzc2lvbk1hbmFnZXIgPSBnZXRXaXRob3V0UHJlZml4RXhwcmVzc2lvbk1hbmFnZXIoIGVmZmVjdGl2ZVN0cmluZyApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmVtb3ZlUHJlZml4ID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHRoZSBleHByZXNzaW9uIG1hbmFnZXIgYW5kIGJ1aWxkIHRoZSBleHByZXNzaW9uXG4gICAgICAgIGV4cHJlc3Npb25NYW5hZ2VyID0gZXhwcmVzc2lvbk1hbmFnZXIgfHwgZXhwcmVzc2lvbk1hbmFnZXJzWyBpZCBdO1xuICAgICAgICB2YXIgZmluYWxTdHJpbmcgPSB1bmRlZmluZWQ7XG4gICAgICAgIGlmICggcmVtb3ZlUHJlZml4ICYmIGV4cHJlc3Npb25NYW5hZ2VyLnJlbW92ZVByZWZpeCApe1xuICAgICAgICAgICAgZmluYWxTdHJpbmcgPSBlZmZlY3RpdmVTdHJpbmcuc3Vic3RyKCBpZC5sZW5ndGggKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGZpbmFsU3RyaW5nID0gZWZmZWN0aXZlU3RyaW5nO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uTWFuYWdlci5idWlsZCggZmluYWxTdHJpbmcgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRXaXRob3V0UHJlZml4RXhwcmVzc2lvbk1hbmFnZXIgPSBmdW5jdGlvbiggc3RyaW5nICl7XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgcHJlZml4IGluIHdpdGhvdXRQcmVmaXhFeHByZXNzaW9uTWFuYWdlcnMgKSB7XG4gICAgICAgICAgICBpZiAoIHN0cmluZy5pbmRleE9mKCBwcmVmaXggKSA9PT0gMCApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gd2l0aG91dFByZWZpeEV4cHJlc3Npb25NYW5hZ2Vyc1sgcHJlZml4IF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBleHByZXNzaW9uTWFuYWdlcnNbIERFRkFVTFRfSUQgXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZExpc3QgPSBmdW5jdGlvbiggc2VnbWVudHMgKSB7XG4gICAgICAgIHZhciBsaXN0ID0gW107XG4gICAgICAgIFxuICAgICAgICB3aGlsZSAoIHNlZ21lbnRzLmhhc01vcmVUb2tlbnMoKSApIHtcbiAgICAgICAgICAgIGxpc3QucHVzaChcbiAgICAgICAgICAgICAgICBidWlsZCggXG4gICAgICAgICAgICAgICAgICAgIHNlZ21lbnRzLm5leHRUb2tlbigpLnRyaW0oKSAgKSApO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGxpc3Q7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcmVtb3ZlUHJlZml4ID0gZnVuY3Rpb24oIHN0cmluZywgcHJlZml4ICkge1xuICAgICAgICByZXR1cm4gc3RyaW5nLnN1YnN0ciggcHJlZml4Lmxlbmd0aCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHJlbW92ZVByZWZpeEFuZEJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZywgcHJlZml4ICkge1xuICAgICAgICByZXR1cm4gYnVpbGQoXG4gICAgICAgICAgICAgICAgc3RyaW5nLnN1YnN0ciggcHJlZml4Lmxlbmd0aCApKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZW1vdmVQYXJlbnRoZXNpc0lmQW55ID0gZnVuY3Rpb24oIHRva2VuICl7XG4gICAgICAgIHZhciBlZmZlY3RpdmVUb2tlbiA9IHRva2VuLnRyaW0oKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggZWZmZWN0aXZlVG9rZW4gPT0gJycgKXtcbiAgICAgICAgICAgIHJldHVybiBlZmZlY3RpdmVUb2tlbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCBlZmZlY3RpdmVUb2tlbi5jaGFyQXQoIDAgKSA9PT0gJygnICl7XG4gICAgICAgICAgICByZXR1cm4gcmVtb3ZlUGFyZW50aGVzaXNJZkFueSggXG4gICAgICAgICAgICAgICAgICAgICAgICBlZmZlY3RpdmVUb2tlbi5zdWJzdHJpbmcoIDEsIGVmZmVjdGl2ZVRva2VuLmxhc3RJbmRleE9mKCAnKScgKSApLnRyaW0oKSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZWZmZWN0aXZlVG9rZW47XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZW5kc1dpdGggPSBmdW5jdGlvbiggc3RyLCBzdWZmaXggKSB7XG4gICAgICAgIHJldHVybiBzdHIuaW5kZXhPZiggc3VmZml4LCBzdHIubGVuZ3RoIC0gc3VmZml4Lmxlbmd0aCApICE9PSAtMTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRBcmd1bWVudHNGcm9tU3RyaW5nID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICAgICAgXG4gICAgICAgIC8vIFBhcnNlIGFuZCBldmFsdWF0ZSBhcmd1bWVudHM7IHRoZW4gcHVzaCB0aGVtIHRvIGFuIGFycmF5XG4gICAgICAgIHZhciB0b2tlbnMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5hcmd1bWVudHNEZWxpbWl0ZXIsIFxuICAgICAgICAgICAgICAgIHRydWUgKTtcbiAgICAgICAgdmFyIGFyZ3MgPSBbXTtcbiAgICAgICAgd2hpbGUgKCB0b2tlbnMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRTdHJpbmcgPSB0b2tlbnMubmV4dFRva2VuKCkudHJpbSgpO1xuICAgICAgICAgICAgYXJncy5wdXNoKCBcbiAgICAgICAgICAgICAgICAgICAgYnVpbGQoIGN1cnJlbnRTdHJpbmcgKSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gYXJncztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHJlZ2lzdGVyOiByZWdpc3RlcixcbiAgICAgICAgdW5yZWdpc3RlcjogdW5yZWdpc3RlcixcbiAgICAgICAgcmVnaXN0ZXJBbGw6IHJlZ2lzdGVyQWxsLFxuICAgICAgICBidWlsZDogYnVpbGQsXG4gICAgICAgIGJ1aWxkTGlzdDogYnVpbGRMaXN0LFxuICAgICAgICByZW1vdmVQcmVmaXg6IHJlbW92ZVByZWZpeCxcbiAgICAgICAgcmVtb3ZlUHJlZml4QW5kQnVpbGQ6IHJlbW92ZVByZWZpeEFuZEJ1aWxkLFxuICAgICAgICByZW1vdmVQYXJlbnRoZXNpc0lmQW55OiByZW1vdmVQYXJlbnRoZXNpc0lmQW55LFxuICAgICAgICBlbmRzV2l0aDogZW5kc1dpdGgsXG4gICAgICAgIGdldEFyZ3VtZW50c0Zyb21TdHJpbmc6IGdldEFyZ3VtZW50c0Zyb21TdHJpbmdcbiAgICB9O1xufSkoKTtcbiIsIi8qIFxuICAgIENsYXNzIEV4cHJlc3Npb25Ub2tlbml6ZXIgXG4qL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiggZXhwLCBkZWxpbWl0ZXIsIGVzY2FwZSApIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICB2YXIgcmVtb3ZlUGFyZW50aGVzaXNJZkFueSA9IGV4cHJlc3Npb25CdWlsZGVyLnJlbW92ZVBhcmVudGhlc2lzSWZBbnk7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHAudHJpbSgpO1xuXG4gICAgdmFyIGl0ZXJhdG9yO1xuICAgIHZhciBjdXJySW5kZXggPSAwO1xuICAgIHZhciBkZWxpbWl0ZXJDb3VudCA9IDA7XG4gICAgdmFyIGRlbGltaXRlcnMgPSBbXTtcbiAgICBcbiAgICB2YXIgbWFrZUl0ZXJhdG9yID0gZnVuY3Rpb24oIGFycmF5ICl7XG4gICAgICAgIHZhciBuZXh0SW5kZXggPSAwO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIG5leHQ6IGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIG5leHRJbmRleCA8IGFycmF5Lmxlbmd0aCA/XG4gICAgICAgICAgICAgICAgICAgYXJyYXkgWyBuZXh0SW5kZXgrKyBdIDpcbiAgICAgICAgICAgICAgICAgICB1bmRlZmluZWQ7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgaGFzTmV4dDogZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gbmV4dEluZGV4IDwgYXJyYXkubGVuZ3RoO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGFuYWx5emUgPSBmdW5jdGlvbigpe1xuICAgICAgICB2YXIgYXZvaWRSZXBlYXRlZFNlcGFyYXRvcnMgPSBkZWxpbWl0ZXIgPT09ICcgJztcbiAgICAgICAgXG4gICAgICAgIC8vIEdvIGFoZWFkIGFuZCBmaW5kIGRlbGltaXRlcnMsIGlmIGFueSwgYXQgY29uc3RydWN0aW9uIHRpbWVcbiAgICAgICAgdmFyIHBhcmVudExldmVsID0gMDtcbiAgICAgICAgdmFyIGluUXVvdGUgPSBmYWxzZTtcbiAgICAgICAgdmFyIHByZXZpb3VzQ2ggPSAnJztcbiAgICAgICAgXG4gICAgICAgIC8vIFNjYW4gZm9yIGRlbGltaXRlcnNcbiAgICAgICAgdmFyIGxlbmd0aCA9IGV4cHJlc3Npb24ubGVuZ3RoO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBjaCA9IGV4cHJlc3Npb24uY2hhckF0KCBpICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIGlmICggY2ggPT09IGRlbGltaXRlciApIHtcbiAgICAgICAgICAgICAgICAvLyBJZiBkZWxpbWl0ZXIgaXMgbm90IGJ1cmllZCBpbiBwYXJlbnRoZXNlcyBvciBhIHF1b3RlXG4gICAgICAgICAgICAgICAgaWYgKCBwYXJlbnRMZXZlbCA9PT0gMCAmJiAhIGluUXVvdGUgICkge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBhdm9pZFJlcGVhdGVkU2VwYXJhdG9ycyAmJiAoIHByZXZpb3VzQ2ggPT09IGRlbGltaXRlciB8fCBwcmV2aW91c0NoID09PSAnXFxuJyApICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgIHZhciBuZXh0Q2ggPSAoIGkgKyAxIDwgbGVuZ3RoICkgPyBleHByZXNzaW9uLmNoYXJBdCggaSArIDEgKSA6ICcnO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gQW5kIGlmIGRlbGltaXRlciBpcyBub3QgZXNjYXBlZFxuICAgICAgICAgICAgICAgICAgICBpZiAoICEgKCBlc2NhcGUgJiYgbmV4dENoID09PSBkZWxpbWl0ZXIgKSApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGRlbGltaXRlckNvdW50Kys7XG4gICAgICAgICAgICAgICAgICAgICAgICBkZWxpbWl0ZXJzLnB1c2goIGkgKTtcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIC8vIFNvbWV3aGF0IGluZWZmaWNpZW50IHdheSB0byBwYXJlIHRoZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gZXNjYXBlZCBkZWxpbWl0ZXIgZG93biB0byBhIHNpbmdsZVxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gY2hhcmFjdGVyIHdpdGhvdXQgYnJlYWtpbmcgb3VyIHN0cmlkZVxuICAgICAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb24uc3Vic3RyaW5nKCAwLCBpICsgMSApICsgZXhwcmVzc2lvbi5zdWJzdHJpbmcoIGkgKyAyICk7XG4gICAgICAgICAgICAgICAgICAgICAgICBsZW5ndGgtLTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIC8vIEluY3JlbWVudCBwYXJlbnRoZXNpcyBsZXZlbFxuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICcoJyB8fCBjaCA9PT0gJ1snICkge1xuICAgICAgICAgICAgICAgIHBhcmVudExldmVsKys7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEZWNyZW1lbnQgcGFyZW50aGVzaXMgbGV2ZWxcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoIGNoID09PSAnKScgfHwgY2ggPT09ICddJyApIHtcbiAgICAgICAgICAgICAgICBwYXJlbnRMZXZlbC0tO1xuICAgICAgICAgICAgICAgIC8vIElmIHVubWF0Y2hlZCByaWdodCBwYXJlbnRoZXNpc1xuICAgICAgICAgICAgICAgIGlmICggcGFyZW50TGV2ZWwgPCAwICkge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyAnU3ludGF4IGVycm9yLiBVbm1hdGNoZWQgcmlnaHQgcGFyZW50aGVzaXM6ICcgKyBleHByZXNzaW9uO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFN0YXJ0IG9yIGVuZCBxdW90ZVxuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICdcXCcnICkge1xuICAgICAgICAgICAgICAgIGluUXVvdGUgPSAhIGluUXVvdGU7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHByZXZpb3VzQ2ggPSBjaDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gSWYgdW5tYXRjaGVkIGxlZnQgcGFyZW50aGVzaXNcbiAgICAgICAgaWYgKCBwYXJlbnRMZXZlbCA+IDAgKSB7XG4gICAgICAgICAgICB0aHJvdyAnU3ludGF4IGVycm9yOiB1bm1hdGNoZWQgbGVmdCBwYXJlbnRoZXNpczogJyArIGV4cHJlc3Npb247XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIElmIHJ1bmF3YXkgcXVvdGVcbiAgICAgICAgaWYgKCBpblF1b3RlICkge1xuICAgICAgICAgICAgdGhyb3cgJ1N5bnRheCBlcnJvcjogcnVuYXdheSBxdW90YXRpb246ICcgKyBleHByZXNzaW9uO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpdGVyYXRvciA9IG1ha2VJdGVyYXRvciggZGVsaW1pdGVycyApO1xuICAgIH0oKTtcbiAgICBcbiAgICB2YXIgaGFzTW9yZVRva2VucyA9IGZ1bmN0aW9uKCApIHtcbiAgICAgICAgcmV0dXJuIGN1cnJJbmRleCA8IGV4cHJlc3Npb24ubGVuZ3RoO1xuICAgIH07XG4gICAgXG4gICAgdmFyIG5leHRUb2tlbiA9IGZ1bmN0aW9uKCApIHtcbiAgICAgICAgdmFyIHRva2VuO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBpdGVyYXRvci5oYXNOZXh0KCkgKSB7XG4gICAgICAgICAgICB2YXIgbmV4dCA9IGl0ZXJhdG9yLm5leHQoKTtcbiAgICAgICAgICAgIHZhciBkZWxpbSA9IHBhcnNlSW50KCBuZXh0ICk7XG4gICAgICAgICAgICB0b2tlbiA9IGV4cHJlc3Npb24uc3Vic3RyaW5nKCBjdXJySW5kZXgsIGRlbGltICkudHJpbSgpO1xuICAgICAgICAgICAgY3VyckluZGV4ID0gZGVsaW0gKyAxO1xuICAgICAgICAgICAgZGVsaW1pdGVyQ291bnQtLTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgcmV0dXJuIHJlbW92ZVBhcmVudGhlc2lzSWZBbnkoIHRva2VuICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRva2VuID0gZXhwcmVzc2lvbi5zdWJzdHJpbmcoIGN1cnJJbmRleCApLnRyaW0oKTtcbiAgICAgICAgY3VyckluZGV4ID0gZXhwcmVzc2lvbi5sZW5ndGg7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVtb3ZlUGFyZW50aGVzaXNJZkFueSggdG9rZW4gKTtcbiAgICB9O1xuICAgICAgICBcbiAgICB2YXIgY291bnRUb2tlbnMgPSBmdW5jdGlvbiggKSB7XG4gICAgICAgIGlmICggaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICAgICAgcmV0dXJuIGRlbGltaXRlckNvdW50ICsgMTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gMDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBuZXh0VG9rZW5JZkFueSA9IGZ1bmN0aW9uKCBkZWZhdWx0VmFsdWUgKSB7XG4gICAgICAgIHJldHVybiBoYXNNb3JlVG9rZW5zKCk/IG5leHRUb2tlbigpOiBkZWZhdWx0VmFsdWU7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBoYXNNb3JlVG9rZW5zOiBoYXNNb3JlVG9rZW5zLFxuICAgICAgICBuZXh0VG9rZW46IG5leHRUb2tlbixcbiAgICAgICAgY291bnRUb2tlbnM6IGNvdW50VG9rZW5zLFxuICAgICAgICBuZXh0VG9rZW5JZkFueTogbmV4dFRva2VuSWZBbnlcbiAgICB9O1xufTtcbiIsIi8qIFxuICAgIGV4cHJlc3Npb25zVXRpbHMgc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuL2V2YWx1YXRlSGVscGVyLmpzJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uL3V0aWxzLmpzJyApO1xudmFyIERlcHNEYXRhSXRlbSA9IHJlcXVpcmUoICcuLi9wYXJzZXJzL2RlcHNEYXRhSXRlbS5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIGJ1aWxkTGl0ZXJhbCA9IGZ1bmN0aW9uKCB2YWx1ZSApIHtcbiAgICAgICAgcmV0dXJuIGV2YWx1YXRlSGVscGVyLmlzTnVtYmVyKCB2YWx1ZSApPyBcIlwiICsgdmFsdWU6IFwiJ1wiICsgdmFsdWUgKyBcIidcIjtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZExpc3QgPSBmdW5jdGlvbiggaXRlbXMsIGFzU3RyaW5ncyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSAnWyc7XG4gICAgICAgIHZhciBzZXBhcmF0b3IgPSBhc1N0cmluZ3M/IFwiJ1wiOiBcIlwiO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgaXRlbXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICByZXN1bHQgKz0gc2VwYXJhdG9yICsgaXRlbXNbIGkgXSArIHNlcGFyYXRvciArIFwiIFwiO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXN1bHQgKz0gJ10nO1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGJ1aWxkRGVwZW5kc09uTGlzdCA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIFxuICAgICAgICB2YXIgZGVwc0RhdGFJdGVtID0gYXJndW1lbnRzWyAwIF07XG4gICAgICAgIGlmICggISBkZXBzRGF0YUl0ZW0gKXtcbiAgICAgICAgICAgIGRlcHNEYXRhSXRlbSA9IG5ldyBEZXBzRGF0YUl0ZW0oKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIHNjb3BlID0gYXJndW1lbnRzWyAxIF07XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgYXJnQ291bnRlciA9IDI7IGFyZ0NvdW50ZXIgPCBhcmd1bWVudHMubGVuZ3RoOyBhcmdDb3VudGVyKysgKXtcbiAgICAgICAgICAgIHZhciBsaXN0ID0gYXJndW1lbnRzWyBhcmdDb3VudGVyIF07XG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KCBcbiAgICAgICAgICAgICAgICBnZXREZXBlbmRzT25Gcm9tTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgbGlzdCApXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldERlcGVuZHNPbkZyb21MaXN0ID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGFyZyApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGFyZyApe1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCAhIEFycmF5LmlzQXJyYXkoIGFyZyApICl7XG4gICAgICAgICAgICByZXR1cm4gZ2V0RGVwZW5kc09uRnJvbU5vbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGFyZyApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IGFyZztcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBpdGVtID0gbGlzdFsgaSBdO1xuICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggXG4gICAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheSggaXRlbSApPyBnZXREZXBlbmRzT25Gcm9tTGlzdCggc2NvcGUsIGl0ZW0gKTogZ2V0RGVwZW5kc09uRnJvbU5vbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGl0ZW0gKVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0RGVwZW5kc09uRnJvbU5vbkxpc3QgPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgaXRlbSApe1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuICEgdXRpbHMuaXNGdW5jdGlvbiggaXRlbS5kZXBlbmRzT24gKSB8fCAoIHV0aWxzLmlzRnVuY3Rpb24oIGl0ZW0uZ2V0VmFyTmFtZSApICYmIGRlcHNEYXRhSXRlbSA9PT0gaXRlbS5nZXRWYXJOYW1lKCkgKT8gXG4gICAgICAgICAgICBbXTogXG4gICAgICAgICAgICBpdGVtLmRlcGVuZHNPbiggZGVwc0RhdGFJdGVtLCBzY29wZSApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgYnVpbGRMaXRlcmFsOiBidWlsZExpdGVyYWwsXG4gICAgICAgIGJ1aWxkTGlzdDogYnVpbGRMaXN0LFxuICAgICAgICBidWlsZERlcGVuZHNPbkxpc3Q6IGJ1aWxkRGVwZW5kc09uTGlzdFxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICBGb3JtYXRFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgRXhwcmVzc2lvblRva2VuaXplciA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi9ldmFsdWF0ZUhlbHBlci5qcycgKTtcblxudmFyIEZvcm1hdEV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZm9ybWF0dGVyRXhwcmVzc2lvblRvQXBwbHksIGFyZ3NFeHByZXNzaW9uc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGZvcm1hdHRlckV4cHJlc3Npb24gPSBmb3JtYXR0ZXJFeHByZXNzaW9uVG9BcHBseTtcbiAgICB2YXIgYXJnc0V4cHJlc3Npb25zID0gYXJnc0V4cHJlc3Npb25zVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIC8vIEdldCBmb3JtYXR0ZXJcbiAgICAgICAgdmFyIGZvcm1hdHRlciA9IGV2YWx1YXRlRm9ybWF0dGVyKCBzY29wZSwgZm9ybWF0dGVyRXhwcmVzc2lvbiApO1xuICAgICAgICBcbiAgICAgICAgLy8gR2V0IGFyZ3VtZW50c1xuICAgICAgICB2YXIgYXJncyA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlRXhwcmVzc2lvbkxpc3QoIGFyZ3NFeHByZXNzaW9ucywgc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBmb3JtYXR0ZXIuYXBwbHkoIGZvcm1hdHRlciwgYXJncyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlRm9ybWF0dGVyID0gZnVuY3Rpb24oIHNjb3BlLCBleHByZXNzaW9uICkge1xuICAgICAgICBcbiAgICAgICAgLy8gVHJ5IHRvIGdldCBhIGJ1aWx0LWluIGZvcm1hdHRlclxuICAgICAgICB2YXIgZm9ybWF0dGVyID0gY29udGV4dC5nZXRGb3JtYXR0ZXIoIGV4cHJlc3Npb24gKTtcbiAgICAgICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgYSBmdW5jdGlvbiB3aXRoIGEgbmFtZVxuICAgICAgICBpZiAoICEgaXNWYWxpZEZvcm1hdHRlciggZm9ybWF0dGVyICkgKXtcbiAgICAgICAgICAgIGZvcm1hdHRlciA9IHNjb3BlLmdldCggZXhwcmVzc2lvbiApO1xuICAgICAgICB9XG4gICAgXG4gICAgICAgIC8vIFRyeSB0byBnZXQgYSBmdW5jdGlvbiBldmFsdWF0aW5nIHRoZSBleHByZXNzaW9uXG4gICAgICAgIGlmICggISBpc1ZhbGlkRm9ybWF0dGVyKCBmb3JtYXR0ZXIgKSApe1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICAgICAgICAgICAgICB2YXIgZm9ybWF0dGVyRXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBleHByZXNzaW9uICk7XG4gICAgICAgICAgICAgICAgdmFyIHZhbHVlID0gZm9ybWF0dGVyRXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICByZXR1cm4gZXZhbHVhdGVGb3JtYXR0ZXIoIHNjb3BlLCB2YWx1ZSApO1xuXG4gICAgICAgICAgICB9IGNhdGNoKCBlICl7XG4gICAgICAgICAgICAgICAgLy8gTm90aGluZyB0byBkb1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBSZXR1cm4gdGhlIGZvcm1hdHRlciBvbmx5IGlmIGl0IGlzIHZhbGlkXG4gICAgICAgIGlmICggaXNWYWxpZEZvcm1hdHRlciggZm9ybWF0dGVyICkgKXtcbiAgICAgICAgICAgIHJldHVybiBmb3JtYXR0ZXI7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHRocm93ICdObyB2YWxpZCBmb3JtYXR0ZXIgZm91bmQ6ICcgKyBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaXNWYWxpZEZvcm1hdHRlciA9IGZ1bmN0aW9uKCBmb3JtYXR0ZXIgKXtcbiAgICAgICAgcmV0dXJuIGZvcm1hdHRlciAmJiB1dGlscy5pc0Z1bmN0aW9uKCBmb3JtYXR0ZXIgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGZvcm1hdHRlckV4cHJlc3Npb24sIGFyZ3NFeHByZXNzaW9ucyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5Gb3JtYXRFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5Gb3JtYXRFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5mb3JtYXRFeHByZXNzaW9uO1xufTtcbkZvcm1hdEV4cHJlc3Npb24uZ2V0SWQgPSBGb3JtYXRFeHByZXNzaW9uLmdldFByZWZpeDtcblxuRm9ybWF0RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzLnRyaW0oKTtcbiAgICBpZiAoIHN0cmluZy5sZW5ndGggPT09IDAgKSB7XG4gICAgICAgIHRocm93ICdGb3JtYXQgZXhwcmVzc2lvbiB2b2lkLic7XG4gICAgfVxuXG4gICAgdmFyIHNlZ21lbnRzID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmV4cHJlc3Npb25EZWxpbWl0ZXIsIFxuICAgICAgICAgICAgZmFsc2UgKTtcbiAgICB2YXIgbnVtYmVyT2ZUb2tlbnMgPSBzZWdtZW50cy5jb3VudFRva2VucygpO1xuICAgIGlmICggbnVtYmVyT2ZUb2tlbnMgPT09IDEgKSB7XG4gICAgICAgIHRocm93ICdPbmx5IG9uZSBlbGVtZW50IGluIGZvcm1hdCBleHByZXNzaW9uOiBcIicgKyBzdHJpbmcgKyAnXCIuIFBsZWFzZSBhZGQgYXQgbGVhc3Qgb25lIG1vcmUuJztcbiAgICB9XG5cbiAgICAvLyBHZXQgZm9ybWF0dGVyXG4gICAgdmFyIGZvcm1hdHRlciA9IHNlZ21lbnRzLm5leHRUb2tlbigpLnRyaW0oKTtcblxuICAgIC8vIEdldCBhcmd1bWVudHNcbiAgICB2YXIgYXJnc0V4cHJlc3Npb25zID0gW107XG4gICAgd2hpbGUgKCBzZWdtZW50cy5oYXNNb3JlVG9rZW5zKCkgKSB7XG4gICAgICAgIHZhciBhcmdFeHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIHNlZ21lbnRzLm5leHRUb2tlbigpICk7XG4gICAgICAgIGFyZ3NFeHByZXNzaW9ucy5wdXNoKCBhcmdFeHByZXNzaW9uICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBGb3JtYXRFeHByZXNzaW9uKCBzdHJpbmcsIGZvcm1hdHRlciwgYXJnc0V4cHJlc3Npb25zICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEZvcm1hdEV4cHJlc3Npb247XG4iLCIvKlxuICAgIFRyQ3VycmVuY3lFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgdHJIZWxwZXIgPSByZXF1aXJlKCAnLi90ckhlbHBlci5qcycgKTtcblxudmFyIFRyQ3VycmVuY3lFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5LCBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5LCBzdWJmb3JtYXRUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIGFyZ3NFeHByZXNzaW9ucyA9IGFyZ3NFeHByZXNzaW9uc1RvQXBwbHk7XG4gICAgdmFyIHN1YmZvcm1hdCA9IHN1YmZvcm1hdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSB0ckhlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb24sIFxuICAgICAgICAgICAgICAgIGFyZ3NFeHByZXNzaW9ucywgXG4gICAgICAgICAgICAgICAgJ2N1cnJlbmN5JywgXG4gICAgICAgICAgICAgICAgc3ViZm9ybWF0ICk7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIHRySGVscGVyLmRlcGVuZHNPbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiwgYXJnc0V4cHJlc3Npb25zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblRyQ3VycmVuY3lFeHByZXNzaW9uLnJlbW92ZVByZWZpeCA9IHRydWU7XG5UckN1cnJlbmN5RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gY29udGV4dC5nZXRDb25mKCkudHJDdXJyZW5jeUV4cHJlc3Npb247XG59O1xuVHJDdXJyZW5jeUV4cHJlc3Npb24uZ2V0SWQgPSBUckN1cnJlbmN5RXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cblRyQ3VycmVuY3lFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgdHJEYXRhID0gdHJIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgVHJDdXJyZW5jeUV4cHJlc3Npb24uZ2V0UHJlZml4KCksIFxuICAgICAgICAgICAgMiwgXG4gICAgICAgICAgICAzLCBcbiAgICAgICAgICAgIHRydWUgKTtcblxuICAgIHJldHVybiBuZXcgVHJDdXJyZW5jeUV4cHJlc3Npb24oIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIHRyRGF0YS5leHByZXNzaW9uLCBcbiAgICAgICAgICAgIHRyRGF0YS5hcmdzRXhwcmVzc2lvbnMsIFxuICAgICAgICAgICAgdHJEYXRhLnN1YmZvcm1hdCApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBUckN1cnJlbmN5RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgVHJEYXRlVGltZUV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciB0ckhlbHBlciA9IHJlcXVpcmUoICcuL3RySGVscGVyLmpzJyApO1xuXG52YXIgVHJEYXRlVGltZUV4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvblRvQXBwbHksIGFyZ3NFeHByZXNzaW9uc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uVG9BcHBseTtcbiAgICB2YXIgYXJnc0V4cHJlc3Npb25zID0gYXJnc0V4cHJlc3Npb25zVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgdmFyIGV2YWx1YXRlZCA9IHRySGVscGVyLmV2YWx1YXRlKCBcbiAgICAgICAgICAgICAgICBzY29wZSwgXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvbiwgXG4gICAgICAgICAgICAgICAgYXJnc0V4cHJlc3Npb25zLCBcbiAgICAgICAgICAgICAgICAnZGF0ZXRpbWUnLCBcbiAgICAgICAgICAgICAgICBudWxsICk7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZWQ7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gdHJIZWxwZXIuZGVwZW5kc09uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uLCBhcmdzRXhwcmVzc2lvbnMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuVHJEYXRlVGltZUV4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblRyRGF0ZVRpbWVFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS50ckRhdGVUaW1lRXhwcmVzc2lvbjtcbn07XG5UckRhdGVUaW1lRXhwcmVzc2lvbi5nZXRJZCA9IFRyRGF0ZVRpbWVFeHByZXNzaW9uLmdldFByZWZpeDtcblxuVHJEYXRlVGltZUV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciB0ckRhdGEgPSB0ckhlbHBlci5idWlsZCggXG4gICAgICAgICAgICBzdHJpbmcsXG4gICAgICAgICAgICBUckRhdGVUaW1lRXhwcmVzc2lvbi5nZXRQcmVmaXgoKSwgXG4gICAgICAgICAgICAxLCBcbiAgICAgICAgICAgIDIsIFxuICAgICAgICAgICAgZmFsc2UgKTtcblxuICAgIHJldHVybiBuZXcgVHJEYXRlVGltZUV4cHJlc3Npb24oIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIHRyRGF0YS5leHByZXNzaW9uLCBcbiAgICAgICAgICAgIHRyRGF0YS5hcmdzRXhwcmVzc2lvbnMgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJEYXRlVGltZUV4cHJlc3Npb247XG4iLCIvKiBcbiAgICB0ckhlbHBlciBzaW5nbGV0b24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgaTE4bkhlbHBlciA9IHJlcXVpcmUoICcuLi8uLi9pMThuL2kxOG5IZWxwZXIuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIFZhcmlhYmxlRXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuLi9wYXRoL3ZhcmlhYmxlRXhwcmVzc2lvbi5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZywgdGFnLCBtaW5FbGVtZW50cywgbWF4RWxlbWVudHMsIHVzZVN1YmZvcm1hdCApIHtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgICAgICBcbiAgICAgICAgaWYgKCBzdHJpbmcubGVuZ3RoID09PSAwICkge1xuICAgICAgICAgICAgdGhyb3cgdGFnICsgJyBleHByZXNzaW9uIHZvaWQuJztcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgICAgICBzdHJpbmcudHJpbSgpLCBcbiAgICAgICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgICAgICBmYWxzZSApO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgbnVtYmVyIG9mIHRva2Vuc1xuICAgICAgICB2YXIgY291bnQgPSBzZWdtZW50cy5jb3VudFRva2VucygpO1xuICAgICAgICBpZiAoIGNvdW50IDwgbWluRWxlbWVudHMgKSB7XG4gICAgICAgICAgICB0aHJvdyAnVG9vIGZldyBlbGVtZW50cyBpbiAnICsgdGFnICsgJyBleHByZXNzaW9uIChtaW5pbXVtIGlzICcgKyBtaW5FbGVtZW50cyBcbiAgICAgICAgICAgICAgICAgICAgKyAnLCAnICsgY291bnQgKyAnIHByZXNlbnQpOiAnICsgc3RyaW5nLnRyaW0oKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIGNvdW50ID4gbWF4RWxlbWVudHMgKSB7XG4gICAgICAgICAgICB0aHJvdyAnVG9vIG1hbnkgZWxlbWVudHMgaW4gJyArIHRhZyArICcgZXhwcmVzc2lvbiAobWF4aW11bSBpcyAnICsgbWF4RWxlbWVudHMgXG4gICAgICAgICAgICAgICAgICAgICsgJywgJyArIGNvdW50ICsgJyBwcmVzZW50KTonICsgc3RyaW5nLnRyaW0oKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gR2V0IHRva2Vuc1xuICAgICAgICB2YXIgc3ViZm9ybWF0ID0gdXNlU3ViZm9ybWF0PyBcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKTogXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkO1xuICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCkgKTtcbiAgICAgICAgdmFyIGFyZ3NTZWdtZW50ID0gc2VnbWVudHMuaGFzTW9yZVRva2VucygpPyBcbiAgICAgICAgICAgICAgICBzZWdtZW50cy5uZXh0VG9rZW4oKS50cmltKCk6IFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBleHByZXNzaW9uOiBleHByZXNzaW9uLFxuICAgICAgICAgICAgYXJnc0V4cHJlc3Npb25zOiBidWlsZEkxOG5BcmdzKCBhcmdzU2VnbWVudCApLFxuICAgICAgICAgICAgc3ViZm9ybWF0OiBzdWJmb3JtYXRcbiAgICAgICAgfTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZEkxOG5BcmdzID0gZnVuY3Rpb24oIHNlZ21lbnQgKXtcbiAgICAgICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgICAgICBcbiAgICAgICAgdmFyIGFyZ3MgPSB7fTtcbiAgICAgICAgaWYgKCAhIHNlZ21lbnQgKXtcbiAgICAgICAgICAgIHJldHVybiBhcmdzO1xuICAgICAgICB9XG4gICAgICAgIHZhciB0b2tlbnMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICAgICAgc2VnbWVudCwgXG4gICAgICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuaTE4bk9wdGlvbnNEZWxpbWl0ZXIsIFxuICAgICAgICAgICAgICAgIHRydWVcbiAgICAgICAgKTtcbiAgICAgICAgd2hpbGUgKCB0b2tlbnMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICAgICAgdmFyIHRva2VuID0gdG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBhcmdzVG9rZW5zID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgICAgICAgICB0b2tlbiwgXG4gICAgICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmluSTE4bk9wdGlvbnNEZWxpbWl0ZXIsIFxuICAgICAgICAgICAgICAgICAgICB0cnVlIFxuICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIGlmICggYXJnc1Rva2Vucy5jb3VudFRva2VucygpICE9PSAyICkge1xuICAgICAgICAgICAgICAgIHRocm93ICcyIGVsZW1lbnRzIGFyZSBuZWVkZWQgaW4gaTE4biBleHByZXNzaW9uLic7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBhcmdLZXkgPSBhcmdzVG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgICAgIHZhciBhcmdFeHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIFxuICAgICAgICAgICAgICAgICAgICBhcmdzVG9rZW5zLm5leHRUb2tlbigpLnRyaW0oKSApO1xuICAgICAgICAgICAgYXJnc1sgYXJnS2V5IF0gPSBhcmdFeHByZXNzaW9uO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBhcmdzO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlSTE4bkFyZ3MgPSBmdW5jdGlvbiggc2NvcGUsIGkxOG5BcmdzICl7XG4gICAgICAgIHZhciB2YWx1ZXMgPSB7fTtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBhcmdLZXkgaW4gaTE4bkFyZ3MgKSB7XG4gICAgICAgICAgICB2YXIgYXJnRXhwcmVzc2lvbiA9IGkxOG5BcmdzWyBhcmdLZXkgXTtcbiAgICAgICAgICAgIHZhciBhcmdWYWx1ZSA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlVG9Ob3ROdWxsKCBzY29wZSwgYXJnRXhwcmVzc2lvbiApO1xuICAgICAgICAgICAgdmFsdWVzWyBhcmdLZXkgXSA9IGFyZ1ZhbHVlO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gdmFsdWVzO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlLCB2YWx1ZUV4cHJlc3Npb24sIGFyZ3NFeHByZXNzaW9ucywgZm9ybWF0LCBzdWJmb3JtYXQgKSB7XG4gICAgICAgIHZhciBhcmdWYWx1ZXMgPSBldmFsdWF0ZUkxOG5BcmdzKCBzY29wZSwgYXJnc0V4cHJlc3Npb25zICk7XG4gICAgICAgIHZhciBzdWJmb3JtYXRFdmFsdWF0ZWQgPSBcbiAgICAgICAgICAgICAgICBzdWJmb3JtYXQ/IFxuICAgICAgICAgICAgICAgIGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlVG9Ob3ROdWxsKCBzY29wZSwgc3ViZm9ybWF0ICk6IFxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZDtcbiAgICAgICAgdmFyIHZhbHVlRXZhbHVhdGVkID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVUb05vdE51bGwoIHNjb3BlLCB2YWx1ZUV4cHJlc3Npb24gKTtcbiAgICAgICAgdmFyIGV2YWx1YXRlZCA9IHRyYW5zbGF0ZSggXG4gICAgICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgICAgIHZhbHVlRXZhbHVhdGVkLCBcbiAgICAgICAgICAgICAgICBhcmdWYWx1ZXMsIFxuICAgICAgICAgICAgICAgIGZvcm1hdCwgXG4gICAgICAgICAgICAgICAgc3ViZm9ybWF0RXZhbHVhdGVkICk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRyYW5zbGF0ZSA9IGZ1bmN0aW9uKCBzY29wZSwgaWQsIGkxOG5BcmdzLCBmb3JtYXQsIHN1YmZvcm1hdCApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGkxOG5MaXN0ID0gc2NvcGUuZ2V0KCBjb250ZXh0LmdldENvbmYoKS5pMThuRG9tYWluVmFyTmFtZSApO1xuICAgICAgICB2YXIgbGFuZ3VhZ2UgPSBzY29wZS5nZXQoIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5MYW5ndWFnZVZhck5hbWUgKTtcbiAgICAgICAgcmV0dXJuIGkxOG5IZWxwZXIudHIoIFxuICAgICAgICAgICAgaTE4bkxpc3QsIFxuICAgICAgICAgICAgaWQsIFxuICAgICAgICAgICAgaTE4bkFyZ3MsIFxuICAgICAgICAgICAgZm9ybWF0LCBcbiAgICAgICAgICAgIHN1YmZvcm1hdCxcbiAgICAgICAgICAgIGxhbmd1YWdlIFxuICAgICAgICApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uLCBhcmdzRXhwcmVzc2lvbnMgKXtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggXG4gICAgICAgICAgICBkZXBzRGF0YUl0ZW0sIFxuICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgbmV3IFZhcmlhYmxlRXhwcmVzc2lvbiggY29udGV4dC5nZXRDb25mKCkuaTE4bkRvbWFpblZhck5hbWUgKSxcbiAgICAgICAgICAgIG5ldyBWYXJpYWJsZUV4cHJlc3Npb24oIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5MYW5ndWFnZVZhck5hbWUgKSxcbiAgICAgICAgICAgIGV4cHJlc3Npb24sIFxuICAgICAgICAgICAgYXJnc0V4cHJlc3Npb25zXG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBidWlsZDogYnVpbGQsXG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT25cbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgVHJOdW1iZXJFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgdHJIZWxwZXIgPSByZXF1aXJlKCAnLi90ckhlbHBlci5qcycgKTtcblxudmFyIFRyTnVtYmVyRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSwgYXJnc0V4cHJlc3Npb25zVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBhcmdzRXhwcmVzc2lvbnMgPSBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICB2YXIgZXZhbHVhdGVkID0gdHJIZWxwZXIuZXZhbHVhdGUoIFxuICAgICAgICAgICAgICAgIHNjb3BlLCBcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uLCBcbiAgICAgICAgICAgICAgICBhcmdzRXhwcmVzc2lvbnMsIFxuICAgICAgICAgICAgICAgICdudW1iZXInLCBcbiAgICAgICAgICAgICAgICBudWxsIFxuICAgICAgICApO1xuICAgICAgICByZXR1cm4gZXZhbHVhdGVkO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIHRySGVscGVyLmRlcGVuZHNPbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiwgYXJnc0V4cHJlc3Npb25zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblRyTnVtYmVyRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuVHJOdW1iZXJFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS50ck51bWJlckV4cHJlc3Npb247XG59O1xuVHJOdW1iZXJFeHByZXNzaW9uLmdldElkID0gVHJOdW1iZXJFeHByZXNzaW9uLmdldFByZWZpeDtcblxuVHJOdW1iZXJFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgdHJEYXRhID0gdHJIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgVHJOdW1iZXJFeHByZXNzaW9uLmdldFByZWZpeCgpLCBcbiAgICAgICAgICAgIDEsIFxuICAgICAgICAgICAgMiwgXG4gICAgICAgICAgICBmYWxzZSBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBUck51bWJlckV4cHJlc3Npb24oIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIHRyRGF0YS5leHByZXNzaW9uLCBcbiAgICAgICAgICAgIHRyRGF0YS5hcmdzRXhwcmVzc2lvbnMgXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJOdW1iZXJFeHByZXNzaW9uO1xuIiwiLypcbiAgICBUclN0cmluZ0V4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciB0ckhlbHBlciA9IHJlcXVpcmUoICcuL3RySGVscGVyLmpzJyApO1xuXG52YXIgVHJTdHJpbmdFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25Ub0FwcGx5LCBhcmdzRXhwcmVzc2lvbnNUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIGFyZ3NFeHByZXNzaW9ucyA9IGFyZ3NFeHByZXNzaW9uc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWQgPSB0ckhlbHBlci5ldmFsdWF0ZSggXG4gICAgICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgICAgIGV4cHJlc3Npb24sIFxuICAgICAgICAgICAgICAgIGFyZ3NFeHByZXNzaW9ucywgXG4gICAgICAgICAgICAgICAgJ3N0cmluZycsIFxuICAgICAgICAgICAgICAgIG51bGwgXG4gICAgICAgICk7XG4gICAgICAgIHJldHVybiBldmFsdWF0ZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIHRySGVscGVyLmRlcGVuZHNPbiggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiwgYXJnc0V4cHJlc3Npb25zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblRyU3RyaW5nRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuVHJTdHJpbmdFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS50ckV4cHJlc3Npb247XG59O1xuVHJTdHJpbmdFeHByZXNzaW9uLmdldElkID0gVHJTdHJpbmdFeHByZXNzaW9uLmdldFByZWZpeDtcblxuVHJTdHJpbmdFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICB2YXIgdHJEYXRhID0gdHJIZWxwZXIuYnVpbGQoIFxuICAgICAgICAgICAgc3RyaW5nLFxuICAgICAgICAgICAgVHJTdHJpbmdFeHByZXNzaW9uLmdldFByZWZpeCgpLCBcbiAgICAgICAgICAgIDEsIFxuICAgICAgICAgICAgMiwgXG4gICAgICAgICAgICBmYWxzZSBcbiAgICApO1xuXG4gICAgcmV0dXJuIG5ldyBUclN0cmluZ0V4cHJlc3Npb24oIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIHRyRGF0YS5leHByZXNzaW9uLCBcbiAgICAgICAgICAgIHRyRGF0YS5hcmdzRXhwcmVzc2lvbnMgXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gVHJTdHJpbmdFeHByZXNzaW9uO1xuIiwiLypcbiAgICBBcnJheUV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIEFycmF5RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBhcnJheUJhc2VUb0FwcGx5LCBpbmRleGVzVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgYXJyYXlCYXNlID0gYXJyYXlCYXNlVG9BcHBseTtcbiAgICB2YXIgaW5kZXhlcyA9IGluZGV4ZXNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gRXZhbHVhdGUgYW5kIGNoZWNrIGFycmF5IGJhc2VzIGFuZCBpbmRleGVzXG4gICAgICAgIHZhciBldmFsdWF0ZWRBcnJheUJhc2UgPSBhcnJheUJhc2UuZXZhbHVhdGUoIHNjb3BlICk7XG5cbiAgICAgICAgLy8gSXRlcmF0ZSBpbmRleGVzXG4gICAgICAgIHZhciByZXN1bHQgPSBldmFsdWF0ZWRBcnJheUJhc2U7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGluZGV4ZXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEdldCBhbmQgZXZhbHVhdGUgaW5kZXggYXMgaW50ZWdlclxuICAgICAgICAgICAgdmFyIGluZGV4RXhwcmVzc2lvbiA9IGluZGV4ZXNbIGkgXTtcblxuICAgICAgICAgICAgLy8gRXZhbHVhdGUgYXJyYXkgYWNjZXNzXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHRbIGluZGV4RXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKSBdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICAvLyBCdWlsZCB0aGUgYXJyYXlCYXNlRGVwZW5kc09uXG4gICAgICAgIHZhciBhcnJheUJhc2VEZXBlbmRzT24gPSBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgYXJyYXlCYXNlICk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGlzIG11c3QgYmUgcmFyZSFcbiAgICAgICAgaWYgKCBhcnJheUJhc2VEZXBlbmRzT24ubGVuZ3RoID09PSAwICl7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH0gZWxzZSBpZiAoIGFycmF5QmFzZURlcGVuZHNPbi5sZW5ndGggPiAxICl7XG4gICAgICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGFycmF5QmFzZSwgaW5kZXhlcyApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBKb2luIGFsbCB0b2dldGhlclxuICAgICAgICB2YXIgZGVwID0gYXJyYXlCYXNlRGVwZW5kc09uWyAwIF07XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGluZGV4ZXMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIHZhciBpbmRleEV4cHJlc3Npb24gPSBpbmRleGVzWyBpIF07XG4gICAgICAgICAgICB2YXIgaW5kZXhFdmFsdWF0ZWQgPSBpbmRleEV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICBkZXAgKz0gJ1snICsgaW5kZXhFdmFsdWF0ZWQgKyAnXSc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBbIGRlcCBdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGFycmF5QmFzZSArICdbJyArIGluZGV4ZXMgKyAnXSc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuQXJyYXlFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIGFycmF5QmFzZSwgYWNjZXNzb3IgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBpbmRleGVzID0gW107XG4gICAgXG4gICAgdmFyIGRvbmUgPSBmYWxzZTtcbiAgICB3aGlsZSAoICEgZG9uZSApe1xuXG4gICAgICAgIC8vIEFycmF5IGFjY2Vzc29yIG11c3QgYmVnaW4gYW5kIGVuZCB3aXRoIGJyYWNrZXRzXG4gICAgICAgIHZhciBjbG9zZSA9IGFjY2Vzc29yLmluZGV4T2YoICddJyApO1xuICAgICAgICBpZiAoIGFjY2Vzc29yLmNoYXJBdCggMCApICE9PSAnWycgfHwgY2xvc2UgPT09IC0xICkge1xuICAgICAgICAgICAgdGhyb3cgJ0JhZCBhcnJheSBhY2Nlc3NvcjogJyAgKyBhY2Nlc3NvcjtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEdldCBpbmRleCBhbmQgYWRkIHRvIGluZGV4ZXNcbiAgICAgICAgdmFyIGluZGV4ID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIFxuICAgICAgICAgICAgICAgIGFjY2Vzc29yLnN1YnN0cmluZyggMSwgY2xvc2UgKSBcbiAgICAgICAgKTtcbiAgICAgICAgaW5kZXhlcy5wdXNoKCBpbmRleCApO1xuXG4gICAgICAgIC8vIGNvbnRpbnVlIHByb2Nlc3NpbmcgYXJyYXkgYWNjZXNzIGZvciBtdWx0aWRpbWVuc2lvbmFsIGFycmF5c1xuICAgICAgICBjbG9zZSsrO1xuICAgICAgICBpZiAoIGFjY2Vzc29yLmxlbmd0aCA+IGNsb3NlICkge1xuICAgICAgICAgICAgYWNjZXNzb3IgPSBhY2Nlc3Nvci5zdWJzdHJpbmcoIGNsb3NlICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBkb25lID0gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbmV3IEFycmF5RXhwcmVzc2lvbiggYXJyYXlCYXNlLCBpbmRleGVzICk7XG59O1xuXG5BcnJheUV4cHJlc3Npb24uYnVpbGRBcnJheURhdGEgPSBmdW5jdGlvbiggdG9rZW4gKSB7XG4gICAgXG4gICAgdmFyIGJyYWNrZXQgPSBBcnJheUV4cHJlc3Npb24uZmluZEFycmF5QWNjZXNzb3IoIHRva2VuICk7XG4gICAgXG4gICAgaWYgKCBicmFja2V0IDw9IDAgKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGFycmF5QWNjZXNzb3I6IHRva2VuLnN1YnN0cmluZyggYnJhY2tldCApLnRyaW0oKSxcbiAgICAgICAgdG9rZW46IHRva2VuLnN1YnN0cmluZyggMCwgYnJhY2tldCApLnRyaW0oKVxuICAgIH07XG59O1xuXG5BcnJheUV4cHJlc3Npb24uZmluZEFycmF5QWNjZXNzb3IgPSBmdW5jdGlvbiggdG9rZW4gKSB7XG4gICAgdmFyIFNDQU5OSU5HID0gMDtcbiAgICB2YXIgSU5fUEFSRU4gPSAxO1xuICAgIHZhciBJTl9RVU9URSA9IDI7XG5cbiAgICB2YXIgbGVuZ3RoID0gdG9rZW4ubGVuZ3RoO1xuICAgIHZhciBzdGF0ZSA9IFNDQU5OSU5HO1xuICAgIHZhciBwYXJlbkRlcHRoID0gMDtcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyApIHtcbiAgICAgICAgdmFyIGNoID0gdG9rZW4uY2hhckF0KCBpICk7XG4gICAgICAgIHN3aXRjaCggc3RhdGUgKSB7XG4gICAgICAgIGNhc2UgSU5fUEFSRU46XG4gICAgICAgICAgICBpZiAoIGNoID09PSAnKScgKSB7XG4gICAgICAgICAgICAgICAgcGFyZW5EZXB0aC0tO1xuICAgICAgICAgICAgICAgIGlmICggcGFyZW5EZXB0aCA9PT0gMCApIHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdGUgPSBTQ0FOTklORztcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBjaCA9PT0gJygnICkge1xuICAgICAgICAgICAgICAgIHBhcmVuRGVwdGgrKztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIGNhc2UgSU5fUVVPVEU6XG4gICAgICAgICAgICBpZiAoIGNoID09PSAnXFwnJyApIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFNDQU5OSU5HO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG5cbiAgICAgICAgY2FzZSBTQ0FOTklORzpcbiAgICAgICAgICAgIGlmICggY2ggPT09ICdcXCcnICkge1xuICAgICAgICAgICAgICAgIHN0YXRlID0gSU5fUVVPVEU7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKCBjaCA9PT0gJygnICkge1xuICAgICAgICAgICAgICAgIHBhcmVuRGVwdGgrKztcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IElOX1BBUkVOO1xuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICdbJyApIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAtMTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXlFeHByZXNzaW9uO1xuIiwiLypcbiAgICBGdW5jdGlvbkV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xuXG52YXIgRnVuY3Rpb25FeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIG5hbWVUb0FwcGx5LCBhcmdzVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgbmFtZSA9IG5hbWVUb0FwcGx5O1xuICAgIHZhciBhcmdzID0gYXJnc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWRBcmdzID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVFeHByZXNzaW9uTGlzdCggYXJncywgc2NvcGUgKTtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBzY29wZS5nZXQoIG5hbWUgKTtcbiAgICAgICAgcmV0dXJuICEgZWxlbWVudD8gdW5kZWZpbmVkOiBlbGVtZW50LmFwcGx5KCBlbGVtZW50LCBldmFsdWF0ZWRBcmdzICk7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkZ1bmN0aW9uRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgdmFyIGV4cHJlc3Npb25CdWlsZGVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25CdWlsZGVyLmpzJyApO1xuICAgIFxuICAgIHZhciBsZWZ0UGFyZW50ID0gc3RyaW5nLmluZGV4T2YoICcoJyApO1xuICAgIGlmICggbGVmdFBhcmVudCA9PT0gLTEgKSB7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfVxuICAgIFxuICAgIGlmICggISBleHByZXNzaW9uQnVpbGRlci5lbmRzV2l0aCggc3RyaW5nLCAnKScgKSApIHtcbiAgICAgICAgdGhyb3cgJ1N5bnRheCBlcnJvci4gQmFkIGZ1bmN0aW9uIGNhbGw6ICcgKyBzdHJpbmc7XG4gICAgfVxuICAgIHZhciBmdW5jdGlvbk5hbWUgPSBzdHJpbmcuc3Vic3RyaW5nKCAwLCBsZWZ0UGFyZW50ICkudHJpbSgpO1xuICAgIHZhciBhcmdzU3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZyggbGVmdFBhcmVudCArIDEsIHN0cmluZy5sZW5ndGggLSAxICk7XG4gICAgdmFyIGFyZ3MgPSBleHByZXNzaW9uQnVpbGRlci5nZXRBcmd1bWVudHNGcm9tU3RyaW5nKCBhcmdzU3RyaW5nICk7XG5cbiAgICByZXR1cm4gbmV3IEZ1bmN0aW9uRXhwcmVzc2lvbiggc3RyaW5nLCBmdW5jdGlvbk5hbWUsIGFyZ3MgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRnVuY3Rpb25FeHByZXNzaW9uO1xuIiwiLypcbiAgICBJbmRpcmVjdGlvbkV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEluZGlyZWN0aW9uRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBuYW1lVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgbmFtZSA9IG5hbWVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSwgcGFyZW50ICl7XG4gICAgICAgIHJldHVybiBwYXJlbnRbIHNjb3BlLmdldCggbmFtZSApIF07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuICc/JyArIG5hbWU7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuSW5kaXJlY3Rpb25FeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICBpZiAoIHN0cmluZy5jaGFyQXQoIDAgKSAhPT0gJz8nICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbmV3IEluZGlyZWN0aW9uRXhwcmVzc2lvbiggc3RyaW5nLnN1YnN0cmluZyggMSApICk7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEluZGlyZWN0aW9uRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgTGlzdEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIFJhbmdlRXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL3JhbmdlRXhwcmVzc2lvbi5qcycgKTtcblxudmFyIExpc3RFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGl0ZW1zVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgaXRlbXMgPSBpdGVtc1RvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgICAgIFxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBleHByZXNzaW9uID0gaXRlbXNbIGkgXTtcbiAgICAgICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIGV2YWx1YXRlZCApICl7IFxuICAgICAgICAgICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoIGV2YWx1YXRlZCApO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICByZXN1bHQucHVzaCggZXZhbHVhdGVkICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgaXRlbXMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBzdHJpbmc7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBldmFsdWF0ZTogZXZhbHVhdGUsXG4gICAgICAgIGRlcGVuZHNPbjogZGVwZW5kc09uLFxuICAgICAgICB0b1N0cmluZzogdG9TdHJpbmdcbiAgICB9O1xufTtcblxuTGlzdEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgaWYgKCBzLmNoYXJBdCggMCApICE9PSAnWycgfHwgcy5jaGFyQXQoIHMubGVuZ3RoIC0gMSApICE9PSAgJ10nICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICB2YXIgc3RyaW5nID0gcy5zdWJzdHJpbmcoIDEsIHMubGVuZ3RoIC0gMSApO1xuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5leHByZXNzaW9uRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIHRydWUgKTtcblxuICAgIHdoaWxlICggc2VnbWVudHMuaGFzTW9yZVRva2VucygpICkge1xuICAgICAgICB2YXIgc2VnbWVudCA9IHNlZ21lbnRzLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICAgICAgdmFyIHJhbmdlID0gUmFuZ2VFeHByZXNzaW9uLmJ1aWxkKCBzZWdtZW50ICk7XG5cbiAgICAgICAgaXRlbXMucHVzaChcbiAgICAgICAgICAgIHJhbmdlP1xuICAgICAgICAgICAgcmFuZ2U6XG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudCApXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIG5ldyBMaXN0RXhwcmVzc2lvbiggc3RyaW5nLCBpdGVtcyApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBMaXN0RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgQm9vbGVhbkxpdGVyYWwgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEJvb2xlYW5MaXRlcmFsID0gZnVuY3Rpb24oIGxpdGVyYWxUb0FwcGx5ICkge1xuXG4gICAgdmFyIGxpdGVyYWwgPSBsaXRlcmFsVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGxpdGVyYWw7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gXCJcIiArIGxpdGVyYWw7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIFtdO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbkJvb2xlYW5MaXRlcmFsLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICBpZiAoICd0cnVlJyA9PT0gc3RyaW5nICkge1xuICAgICAgICByZXR1cm4gbmV3IEJvb2xlYW5MaXRlcmFsKCB0cnVlICk7XG4gICAgfVxuICAgIGlmICggJ2ZhbHNlJyA9PT0gc3RyaW5nICkge1xuICAgICAgICByZXR1cm4gbmV3IEJvb2xlYW5MaXRlcmFsKCBmYWxzZSApO1xuICAgIH1cbiAgICByZXR1cm4gdW5kZWZpbmVkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBCb29sZWFuTGl0ZXJhbDtcbiIsIi8qXG4gICAgTnVtZXJpY0xpdGVyYWwgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIE51bWVyaWNMaXRlcmFsID0gZnVuY3Rpb24oIGxpdGVyYWxUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBsaXRlcmFsID0gbGl0ZXJhbFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBsaXRlcmFsO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBbXTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBsaXRlcmFsO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbk51bWVyaWNMaXRlcmFsLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICBpZiAoIGlzRmluaXRlKCBzdHJpbmcgKSApe1xuICAgICAgICB2YXIgaW50ZWdlclZhbHVlID0gcGFyc2VJbnQoIHN0cmluZyApO1xuICAgICAgICBpZiAoIGludGVnZXJWYWx1ZSA9PSBzdHJpbmcgKXtcbiAgICAgICAgICAgIHJldHVybiBuZXcgTnVtZXJpY0xpdGVyYWwoIGludGVnZXJWYWx1ZSApO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIGZsb2F0VmFsdWUgPSBwYXJzZUZsb2F0KCBzdHJpbmcgKTtcbiAgICAgICAgaWYgKCBmbG9hdFZhbHVlID09IHN0cmluZyApe1xuICAgICAgICAgICAgcmV0dXJuIG5ldyBOdW1lcmljTGl0ZXJhbCggZmxvYXRWYWx1ZSApO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTnVtZXJpY0xpdGVyYWw7XG4iLCIvKlxuICAgIFN0cmluZ0xpdGVyYWwgY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIFN0cmluZ0xpdGVyYWwgPSBmdW5jdGlvbiggbGl0ZXJhbFRvQXBwbHkgKSB7XG5cbiAgICB2YXIgbGl0ZXJhbCA9IGxpdGVyYWxUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICByZXR1cm4gbGl0ZXJhbDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gW107XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gbGl0ZXJhbDtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5TdHJpbmdMaXRlcmFsLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICBcbiAgICBpZiAoIHN0cmluZy5jaGFyQXQoIDAgKSA9PT0gXCInXCIgJiYgc3RyaW5nLmNoYXJBdCggc3RyaW5nLmxlbmd0aCAtIDEgKSA9PT0gIFwiJ1wiICkge1xuICAgICAgICByZXR1cm4gbmV3IFN0cmluZ0xpdGVyYWwoIFxuICAgICAgICAgICAgc3RyaW5nLnN1YnN0cmluZyggMSwgc3RyaW5nLmxlbmd0aCAtIDEgKSApO1xuICAgIH1cblxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFN0cmluZ0xpdGVyYWw7XG4iLCIvKlxuICAgIE1ldGhvZEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGV2YWx1YXRlSGVscGVyID0gcmVxdWlyZSggJy4uL2V2YWx1YXRlSGVscGVyLmpzJyApO1xuXG52YXIgTWV0aG9kRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBuYW1lVG9BcHBseSwgYXJnc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICB2YXIgYXJncyA9IGFyZ3NUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSwgcGFyZW50ICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWRBcmdzID0gZXZhbHVhdGVIZWxwZXIuZXZhbHVhdGVFeHByZXNzaW9uTGlzdCggYXJncywgc2NvcGUgKTtcbiAgICAgICAgcmV0dXJuIHBhcmVudFsgbmFtZSBdLmFwcGx5KCBwYXJlbnQsIGV2YWx1YXRlZEFyZ3MgKTtcbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB1bmRlZmluZWQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cbk1ldGhvZEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICB2YXIgbGVmdFBhcmVudCA9IHN0cmluZy5pbmRleE9mKCAnKCcgKTtcbiAgICBpZiAoIGxlZnRQYXJlbnQgPT09IC0xICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICBpZiAoICEgZXhwcmVzc2lvbkJ1aWxkZXIuZW5kc1dpdGgoIHN0cmluZywgJyknICkgKSB7XG4gICAgICAgIHRocm93ICdTeW50YXggZXJyb3IuIEJhZCBtZXRob2QgY2FsbDogJyArIHN0cmluZztcbiAgICB9XG4gICAgXG4gICAgdmFyIG1ldGhvZE5hbWUgPSBzdHJpbmcuc3Vic3RyaW5nKCAwLCBsZWZ0UGFyZW50ICkudHJpbSgpO1xuICAgIHZhciBhcmdzU3RyaW5nID0gc3RyaW5nLnN1YnN0cmluZyggbGVmdFBhcmVudCArIDEsIHN0cmluZy5sZW5ndGggLSAxICk7XG4gICAgdmFyIGFyZ3MgPSBleHByZXNzaW9uQnVpbGRlci5nZXRBcmd1bWVudHNGcm9tU3RyaW5nKCBhcmdzU3RyaW5nICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBNZXRob2RFeHByZXNzaW9uKCBzdHJpbmcsIG1ldGhvZE5hbWUsIGFyZ3MgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTWV0aG9kRXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgUGF0aEV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBFeHByZXNzaW9uVG9rZW5pemVyID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25Ub2tlbml6ZXIuanMnICk7XG52YXIgU3RyaW5nTGl0ZXJhbCA9IHJlcXVpcmUoICcuL2xpdGVyYWxzL3N0cmluZ0xpdGVyYWwuanMnICk7XG52YXIgUGF0aFNlZ21lbnRFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vcGF0aFNlZ21lbnRFeHByZXNzaW9uLmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIFBhdGhFeHByZXNzaW9uID0gZnVuY3Rpb24oIHN0cmluZ1RvQXBwbHksIGV4cHJlc3Npb25MaXN0VG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbkxpc3QgPSBleHByZXNzaW9uTGlzdFRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG5cbiAgICAgICAgdmFyIGV4Y2VwdGlvbiA9IHVuZGVmaW5lZDtcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGV4cHJlc3Npb25MaXN0Lmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25MaXN0WyBpIF07XG4gICAgICAgICAgICAgICAgdmFyIHJlc3VsdCA9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgICAgICAgICAgaWYgKCByZXN1bHQgIT0gbnVsbCApe1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2goIGUgKSB7XG4gICAgICAgICAgICAgICAgZXhjZXB0aW9uID0gZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgaWYgKCBleGNlcHRpb24gKSB7XG4gICAgICAgICAgICB0aHJvdyBleGNlcHRpb247XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBudWxsO1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBleHByZXNzaW9uTGlzdCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5QYXRoRXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSBmYWxzZTtcblBhdGhFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5wYXRoRXhwcmVzc2lvbjtcbn07XG5QYXRoRXhwcmVzc2lvbi5nZXRJZCA9IGZ1bmN0aW9uKCkgeyBcbiAgICByZXR1cm4gJ3BhdGgnO1xufTtcblxuUGF0aEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggcyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHMudHJpbSgpO1xuICAgIFxuICAgIC8vIEJsYW5rIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGJsYW5rIHN0cmluZ1xuICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgcmV0dXJuIFN0cmluZ0xpdGVyYWwuYnVpbGQoICcnICk7XG4gICAgfVxuICAgIFxuICAgIHZhciBzZWdtZW50cyA9IG5ldyBFeHByZXNzaW9uVG9rZW5pemVyKCBcbiAgICAgICAgICAgIHN0cmluZywgXG4gICAgICAgICAgICBjb250ZXh0LmdldENvbmYoKS5wYXRoRGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG5cbiAgICAvLyBJZiB0aGVyZSBpcyBvbmx5IDEgbXVzdCBiZSBhIHBhdGggc2VnbWVudFxuICAgIGlmICggc2VnbWVudHMuY291bnRUb2tlbnMoKSA9PT0gMSApIHtcbiAgICAgICAgcmV0dXJuIFBhdGhTZWdtZW50RXhwcmVzc2lvbi5idWlsZCggc3RyaW5nICk7XG4gICAgfVxuXG4gICAgLy8gSWYgdGhlcmUgYXJlIG1vcmUgdGhhbiAxIHRoZXkgY2FuIGJlIGFueSBleHByZXNzaW9uIGluc3RhbmNlXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gW107XG4gICAgd2hpbGUgKCBzZWdtZW50cy5oYXNNb3JlVG9rZW5zKCkgKSB7XG4gICAgICAgIHZhciBuZXh0VG9rZW4gPSBzZWdtZW50cy5uZXh0VG9rZW4oKTtcbiAgICAgICAgaWYgKCAhIG5leHRUb2tlbiApe1xuICAgICAgICAgICAgdGhyb3cgJ051bGwgdG9rZW4gaW5zaWRlIHBhdGggZXhwcmVzc2lvbjogJyArIHN0cmluZztcbiAgICAgICAgfVxuICAgICAgICBleHByZXNzaW9uTGlzdC5wdXNoKCBcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBcbiAgICAgICAgICAgICAgICBuZXh0VG9rZW5cbiAgICAgICAgICAgICkgXG4gICAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiBuZXcgUGF0aEV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUGF0aEV4cHJlc3Npb247XG4iLCIvKlxuICAgIFBhdGhTZWdtZW50RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgQXJyYXlFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vYXJyYXlFeHByZXNzaW9uLmpzJyApO1xudmFyIFN0cmluZ0xpdGVyYWwgPSByZXF1aXJlKCAnLi9saXRlcmFscy9zdHJpbmdMaXRlcmFsLmpzJyApO1xudmFyIE51bWVyaWNMaXRlcmFsID0gcmVxdWlyZSggJy4vbGl0ZXJhbHMvbnVtZXJpY0xpdGVyYWwuanMnICk7XG52YXIgQm9vbGVhbkxpdGVyYWwgPSByZXF1aXJlKCAnLi9saXRlcmFscy9ib29sZWFuTGl0ZXJhbC5qcycgKTtcbnZhciBMaXN0RXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL2xpc3RFeHByZXNzaW9uLmpzJyApO1xudmFyIEZ1bmN0aW9uRXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL2Z1bmN0aW9uRXhwcmVzc2lvbi5qcycgKTtcbnZhciBWYXJpYWJsZUV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi92YXJpYWJsZUV4cHJlc3Npb24uanMnICk7XG52YXIgSW5kaXJlY3Rpb25FeHByZXNzaW9uID0gcmVxdWlyZSggJy4vaW5kaXJlY3Rpb25FeHByZXNzaW9uLmpzJyApO1xudmFyIE1ldGhvZEV4cHJlc3Npb24gPSByZXF1aXJlKCAnLi9tZXRob2RFeHByZXNzaW9uLmpzJyApO1xudmFyIFByb3BlcnR5RXhwcmVzc2lvbiA9IHJlcXVpcmUoICcuL3Byb3BlcnR5RXhwcmVzc2lvbi5qcycgKTtcblxudmFyIFBhdGhTZWdtZW50RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBpdGVtc1RvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIHN0cmluZyA9IHN0cmluZ1RvQXBwbHk7XG4gICAgdmFyIGl0ZW1zID0gaXRlbXNUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHRva2VuID0gaXRlbXNbIDAgXTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IHRva2VuLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIC8vIE9ubHkgbGFzdCBlbGVtZW50IGNhbiBiZSBudWxsXG4gICAgICAgICAgICBpZiAoIHJlc3VsdCA9PSBudWxsICkge1xuICAgICAgICAgICAgICAgIHRocm93ICdFcnJvciBldmFsdWF0aW5nIFwiJyArIHN0cmluZyArICdcIjogXCInICArIHRva2VuICsgJ1wiIGlzIG51bGwnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdG9rZW4gPSBpdGVtc1sgaSBdO1xuICAgICAgICAgICAgcmVzdWx0ID0gdG9rZW4uZXZhbHVhdGUoIHNjb3BlLCByZXN1bHQgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGZpcnN0U2VnbWVudERlcGVuZHNPbiA9IGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBpdGVtc1sgMCBdICk7XG4gICAgICAgIGlmICggZmlyc3RTZWdtZW50RGVwZW5kc09uLmxlbmd0aCA9PT0gMCApe1xuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9IGVsc2UgaWYgKCBmaXJzdFNlZ21lbnREZXBlbmRzT24ubGVuZ3RoID4gMSApe1xuICAgICAgICAgICAgcmV0dXJuIGZpcnN0U2VnbWVudERlcGVuZHNPbjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFyIHRlbXAgPSBmaXJzdFNlZ21lbnREZXBlbmRzT25bIDAgXTtcbiAgICAgICAgdmFyIHJlc3VsdCA9IFsgdGVtcCBdO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDE7IGkgPCBpdGVtcy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciB0b2tlbiA9IGl0ZW1zWyBpIF07XG4gICAgICAgICAgICB2YXIgdG9rZW5EZXBlbmRzT24gPSB0b2tlbi5kZXBlbmRzT24oIHRlbXAgKTtcbiAgICAgICAgICAgIGlmICggISB0b2tlbkRlcGVuZHNPbiApe1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIC8vcmV0dXJuIHRlbXA7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRlbXAgKz0gdG9rZW5EZXBlbmRzT247XG4gICAgICAgICAgICByZXN1bHQucHVzaCggdGVtcCApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5QYXRoU2VnbWVudEV4cHJlc3Npb24uYnVpbGQgPSBmdW5jdGlvbiggc3RyaW5nICkge1xuICAgIFxuICAgIHZhciBpdGVtcyA9IFtdO1xuICAgIFxuICAgIC8vIEJsYW5rIGV4cHJlc3Npb24gZXZhbHVhdGVzIHRvIGJsYW5rIHN0cmluZ1xuICAgIGlmICggc3RyaW5nLmxlbmd0aCA9PT0gMCApIHtcbiAgICAgICAgaXRlbXMucHVzaCggXG4gICAgICAgICAgICBTdHJpbmdMaXRlcmFsLmJ1aWxkKCAnJyApICk7XG4gICAgICAgIHJldHVybiBpdGVtcztcbiAgICB9XG5cbiAgICAvLyBCdWlsZCBmaXJzdCB0b2tlblxuICAgIHZhciBwYXRoID0gbmV3IEV4cHJlc3Npb25Ub2tlbml6ZXIoIFxuICAgICAgICAgICAgc3RyaW5nLCBcbiAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLnBhdGhTZWdtZW50RGVsaW1pdGVyLCBcbiAgICAgICAgICAgIGZhbHNlICk7XG4gICAgdmFyIHRva2VuID0gcGF0aC5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgaXRlbXMucHVzaChcbiAgICAgICAgICAgIFBhdGhTZWdtZW50RXhwcmVzc2lvbi5idWlsZEZpcnN0UGF0aFRva2VuKCB0b2tlbiApICk7XG5cbiAgICAvLyBUcmF2ZXJzZSB0aGUgcGF0aFxuICAgIHdoaWxlICggcGF0aC5oYXNNb3JlVG9rZW5zKCkgKSB7XG4gICAgICAgIHRva2VuID0gcGF0aC5uZXh0VG9rZW4oKS50cmltKCk7XG4gICAgICAgIGl0ZW1zLnB1c2goXG4gICAgICAgICAgICBQYXRoU2VnbWVudEV4cHJlc3Npb24uYnVpbGROZXh0UGF0aFRva2VuKCB0b2tlbiApICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiBuZXcgUGF0aFNlZ21lbnRFeHByZXNzaW9uKCBzdHJpbmcsIGl0ZW1zICk7XG59O1xuXG5QYXRoU2VnbWVudEV4cHJlc3Npb24uYnVpbGRGaXJzdFBhdGhUb2tlbiA9IGZ1bmN0aW9uKCB0ICl7XG5cbiAgICAvLyBTZXBhcmF0ZSBpZGVudGlmaWVyIGZyb20gYW55IGFycmF5IGFjY2Vzc29yc1xuICAgIHZhciBhcnJheURhdGEgPSBBcnJheUV4cHJlc3Npb24uYnVpbGRBcnJheURhdGEoIHQgKTtcbiAgICB2YXIgYXJyYXlBY2Nlc3NvciA9IGFycmF5RGF0YT8gYXJyYXlEYXRhLmFycmF5QWNjZXNzb3I6IHVuZGVmaW5lZDtcbiAgICB2YXIgdG9rZW4gPSBhcnJheURhdGE/IGFycmF5RGF0YS50b2tlbjogdDtcblxuICAgIC8vIEZpcnN0IHRva2VuIG11c3QgY29tZSBmcm9tIGRpY3Rpb25hcnkgb3IgYmUgYSBsaXRlcmFsXG5cbiAgICAvLyBGaXJzdCBzZWUgaWYgaXQncyBhIHN0cmluZyBsaXRlcmFsXG4gICAgdmFyIHJlc3VsdCA9IFN0cmluZ0xpdGVyYWwuYnVpbGQoIHRva2VuICk7XG5cbiAgICAvLyBJZiBpdCdzIG5vdCwgdHJ5IHRvIHNlZSBpZiBpdCdzIGEgbnVtYmVyXG4gICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgcmVzdWx0ID0gTnVtZXJpY0xpdGVyYWwuYnVpbGQoIHRva2VuICk7XG5cbiAgICAgICAgLy8gTWF5YmUgaXQncyBhIGJvb2xlYW4gbGl0ZXJhbFxuICAgICAgICBpZiAoIHJlc3VsdCA9PT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgcmVzdWx0ID0gQm9vbGVhbkxpdGVyYWwuYnVpbGQoIHRva2VuICk7XG5cbiAgICAgICAgICAgIC8vIEEgbGlzdD9cbiAgICAgICAgICAgIGlmICggcmVzdWx0ID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgICAgICByZXN1bHQgPSBMaXN0RXhwcmVzc2lvbi5idWlsZCggdG9rZW4gKTtcblxuICAgICAgICAgICAgICAgIC8vIEEgZnVuY3Rpb24gY2FsbD9cbiAgICAgICAgICAgICAgICBpZiAoIHJlc3VsdCA9PT0gdW5kZWZpbmVkICkge1xuICAgICAgICAgICAgICAgICAgICByZXN1bHQgPSBGdW5jdGlvbkV4cHJlc3Npb24uYnVpbGQoIHRva2VuICk7XG5cbiAgICAgICAgICAgICAgICAgICAgLy8gTXVzdCBiZSBhbiBvYmplY3QgaW4gc2NvcGVcbiAgICAgICAgICAgICAgICAgICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IFZhcmlhYmxlRXhwcmVzc2lvbi5idWlsZCggdG9rZW4gKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gTm90IHJlY29nbml6ZWQgZXhwcmVzc2lvblxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aHJvdyAnVW5rbm93biBleHByZXNzaW9uOiAnICsgdG9rZW47XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoIGFycmF5QWNjZXNzb3IgIT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgcmVzdWx0ID0gQXJyYXlFeHByZXNzaW9uLmJ1aWxkKCByZXN1bHQsIGFycmF5QWNjZXNzb3IgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuUGF0aFNlZ21lbnRFeHByZXNzaW9uLmJ1aWxkTmV4dFBhdGhUb2tlbiA9IGZ1bmN0aW9uKCB0ICl7XG4gICAgXG4gICAgLy8gU2VwYXJhdGUgaWRlbnRpZmllciBmcm9tIGFueSBhcnJheSBhY2Nlc3NvcnNcbiAgICB2YXIgYXJyYXlEYXRhID0gQXJyYXlFeHByZXNzaW9uLmJ1aWxkQXJyYXlEYXRhKCB0ICk7XG4gICAgdmFyIGFycmF5QWNjZXNzb3IgPSBhcnJheURhdGE/IGFycmF5RGF0YS5hcnJheUFjY2Vzc29yOiB1bmRlZmluZWQ7XG4gICAgdmFyIHRva2VuID0gYXJyYXlEYXRhPyBhcnJheURhdGEudG9rZW46IHQ7XG5cbiAgICAvLyBUZXN0IGZvciBpbmRpcmVjdGlvblxuICAgIHZhciByZXN1bHQgPSBJbmRpcmVjdGlvbkV4cHJlc3Npb24uYnVpbGQoIHRva2VuICk7XG4gICAgXG4gICAgLy8gQSBtZXRob2QgY2FsbD9cbiAgICBpZiAoIHJlc3VsdCA9PT0gdW5kZWZpbmVkICkge1xuICAgICAgICByZXN1bHQgPSBNZXRob2RFeHByZXNzaW9uLmJ1aWxkKCB0b2tlbiApO1xuXG4gICAgICAgIC8vIEEgcHJvcGVydHlcbiAgICAgICAgaWYgKCByZXN1bHQgPT09IHVuZGVmaW5lZCApIHtcbiAgICAgICAgICAgIHJlc3VsdCA9IFByb3BlcnR5RXhwcmVzc2lvbi5idWlsZCggdG9rZW4gKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGlmICggYXJyYXlBY2Nlc3NvciAhPT0gdW5kZWZpbmVkICkge1xuICAgICAgICByZXN1bHQgPSBBcnJheUV4cHJlc3Npb24uYnVpbGQoIHJlc3VsdCwgYXJyYXlBY2Nlc3NvciApO1xuICAgIH1cblxuICAgIHJldHVybiByZXN1bHQ7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IFBhdGhTZWdtZW50RXhwcmVzc2lvbjtcbiIsIi8qXG4gICAgUHJvcGVydHlFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBQcm9wZXJ0eUV4cHJlc3Npb24gPSBmdW5jdGlvbiggbmFtZVRvQXBwbHkgKSB7XG4gICAgXG4gICAgdmFyIG5hbWUgPSBuYW1lVG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUsIHBhcmVudCApe1xuICAgICAgICByZXR1cm4gcGFyZW50WyBuYW1lIF07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIHBhcmVudCApe1xuICAgICAgICByZXR1cm4gJy4nICsgbmFtZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0b1N0cmluZyA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiBuYW1lO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblByb3BlcnR5RXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9wZXJ0eUV4cHJlc3Npb24oIHN0cmluZyApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBQcm9wZXJ0eUV4cHJlc3Npb247XG4iLCIvKlxuICAgIFJhbmdlRXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIEV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvblRva2VuaXplci5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4uL2V4cHJlc3Npb25zVXRpbHMuanMnICk7XG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXZhbHVhdGVIZWxwZXIuanMnICk7XG52YXIgTnVtZXJpY0xpdGVyYWwgPSByZXF1aXJlKCAnLi9saXRlcmFscy9udW1lcmljTGl0ZXJhbC5qcycgKTtcblxudmFyIFJhbmdlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBzdGFydEV4cHJlc3Npb25Ub0FwcGx5LCBlbmRFeHByZXNzaW9uVG9BcHBseSwgc3RlcEV4cHJlc3Npb25Ub0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBzdGFydEV4cHJlc3Npb24gPSBzdGFydEV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIHZhciBlbmRFeHByZXNzaW9uID0gZW5kRXhwcmVzc2lvblRvQXBwbHk7XG4gICAgdmFyIHN0ZXBFeHByZXNzaW9uID0gc3RlcEV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gRXZhbHVhdGUgYWxsIGV4cHJlc3Npb25zXG4gICAgICAgIHZhciBzdGFydCA9IGV2YWx1YXRlSGVscGVyLmV2YWx1YXRlTnVtYmVyKCBzY29wZSwgc3RhcnRFeHByZXNzaW9uICk7XG4gICAgICAgIHZhciBlbmQgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZU51bWJlciggc2NvcGUsIGVuZEV4cHJlc3Npb24gKTtcbiAgICAgICAgdmFyIHN0ZXAgPSBldmFsdWF0ZUhlbHBlci5ldmFsdWF0ZU51bWJlciggc2NvcGUsIHN0ZXBFeHByZXNzaW9uICk7XG4gICAgICAgIFxuICAgICAgICAvLyBUaGUgcmFuZ2UgaXMgdmFsaWQsIGV2YWx1YXRlIGl0XG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcbiAgICAgICAgdmFyIGZvcndhcmQgPSBzdGVwID4gMDsgXG4gICAgICAgIFxuICAgICAgICB2YXIgYyA9IHN0YXJ0O1xuICAgICAgICB3aGlsZSggZm9yd2FyZD8gYyA8PSBlbmQ6IGMgPj0gZW5kICl7XG4gICAgICAgICAgICByZXN1bHQucHVzaCggYyApO1xuICAgICAgICAgICAgYyArPSBzdGVwO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG5cbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBzdGFydEV4cHJlc3Npb24sIGVuZEV4cHJlc3Npb24sIHN0ZXBFeHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblJhbmdlRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzICkge1xuICAgIHZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbiAgICBcbiAgICBpZiAoICEgcyApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgc3RyaW5nID0gcy50cmltKCk7XG4gICAgXG4gICAgLy8gSWYgaXQgY29udGFpbnMgc3BhY2VzIGl0IGlzIG5vdCBhIHZhbGlkIHJhbmdlXG4gICAgaWYgKCBzdHJpbmcuaW5kZXhPZiggJyAnICkgIT09IC0xICkge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICBcbiAgICB2YXIgc2VnbWVudHMgPSBuZXcgRXhwcmVzc2lvblRva2VuaXplciggXG4gICAgICAgICAgICBzdHJpbmcsIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkuaW50ZXJ2YWxEZWxpbWl0ZXIsIFxuICAgICAgICAgICAgZmFsc2UgKTtcblxuICAgIHZhciBudW1iZXJPZlRva2VucyA9IHNlZ21lbnRzLmNvdW50VG9rZW5zKCk7XG4gICAgaWYgKCBudW1iZXJPZlRva2VucyAhPT0gMiAmJiBudW1iZXJPZlRva2VucyAhPT0gMyApIHtcbiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB9XG5cbiAgICB2YXIgUkFOR0VfREVGQVVMVF9TVEFSVCA9IDA7XG4gICAgdmFyIFJBTkdFX0RFRkFVTFRfU1RFUCA9IDE7XG4gICAgXG4gICAgLy8gQnVpbGQgc3RhcnQgZXhwcmVzc2lvblxuICAgIHZhciBzdGFydCA9IHNlZ21lbnRzLm5leHRUb2tlbigpLnRyaW0oKTtcbiAgICB2YXIgc3RhcnRFeHByZXNzaW9uID0gc3RhcnQgPT0gJyc/IFxuICAgICAgICAgICAgTnVtZXJpY0xpdGVyYWwuYnVpbGQoIFJBTkdFX0RFRkFVTFRfU1RBUlQgKTogXG4gICAgICAgICAgICBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc3RhcnQgKTtcblxuICAgIC8vIEJ1aWxkIGVuZCBleHByZXNzaW9uXG4gICAgdmFyIGVuZEV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc2VnbWVudHMubmV4dFRva2VuKCkgKTtcblxuICAgIC8vIEJ1aWxkIHN0ZXAgZXhwcmVzc2lvblxuICAgIHZhciBzdGVwRXhwcmVzc2lvbiA9IG51bWJlck9mVG9rZW5zID09PSAzPyBcbiAgICAgICAgICAgIGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBzZWdtZW50cy5uZXh0VG9rZW4oKSApOlxuICAgICAgICAgICAgTnVtZXJpY0xpdGVyYWwuYnVpbGQoIFJBTkdFX0RFRkFVTFRfU1RFUCApO1xuICAgIFxuICAgIHJldHVybiBuZXcgUmFuZ2VFeHByZXNzaW9uKCBzdHJpbmcsIHN0YXJ0RXhwcmVzc2lvbiwgZW5kRXhwcmVzc2lvbiwgc3RlcEV4cHJlc3Npb24gKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gUmFuZ2VFeHByZXNzaW9uO1xuIiwiLypcbiAgICBWYXJpYWJsZUV4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIFZhcmlhYmxlRXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBuYW1lVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgbmFtZSA9IG5hbWVUb0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIHNjb3BlLmlzVmFsaWRWYXJpYWJsZSggbmFtZSApICl7XG4gICAgICAgICAgICB0aHJvdyAnTm90IGRlY2xhcmVkIHZhcmlhYmxlIGZvdW5kIHVzaW5nIHN0cmljdCBtb2RlOicgKyBuYW1lO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc2NvcGUuZ2V0KCBuYW1lICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBkZXBzRGF0YUl0ZW0ubXVzdEFkZFZhciggbmFtZSApICl7XG4gICAgICAgICAgICByZXR1cm4gW107XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBleHByZXNzaW9uID0gc2NvcGUuZ2V0VmFyRXhwcmVzc2lvbiggbmFtZSApO1xuICAgICAgICBpZiAoICEgZXhwcmVzc2lvbiApe1xuICAgICAgICAgICAgZGVwc0RhdGFJdGVtLmFkZDFOb25FeHByZXNzaW9uVmFyKCBuYW1lICk7XG4gICAgICAgICAgICByZXR1cm4gWyBuYW1lIF07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGRlcHNEYXRhSXRlbS5hZGQxRXhwcmVzc2lvblZhciggbmFtZSApO1xuICAgICAgICB2YXIgcmVzdWx0ID0gZXhwcmVzc2lvbi5kZXBlbmRzT24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKTtcbiAgICAgICAgZGVwc0RhdGFJdGVtLmFkZEFsbFZhcnMoIHJlc3VsdCwgc2NvcGUgKTtcbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRWYXJOYW1lID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIG5hbWU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gbmFtZTtcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgZ2V0VmFyTmFtZTogZ2V0VmFyTmFtZSxcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblZhcmlhYmxlRXhwcmVzc2lvbi5idWlsZCA9IGZ1bmN0aW9uKCBzdHJpbmcgKSB7XG4gICAgXG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLnZhcmlhYmxlTmFtZVJFLnRlc3QoIHN0cmluZyApP1xuICAgICAgICBuZXcgVmFyaWFibGVFeHByZXNzaW9uKCBzdHJpbmcgKTpcbiAgICAgICAgdW5kZWZpbmVkO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBWYXJpYWJsZUV4cHJlc3Npb247XG4iLCIvKlxuICAgIEphdmFzY3JpcHRFeHByZXNzaW9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG52YXIgZXhwcmVzc2lvbnNVdGlscyA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9uc1V0aWxzLmpzJyApO1xudmFyIFN0cmluZ0V4cHJlc3Npb24gPSByZXF1aXJlKCAnLi4vc3RyaW5nRXhwcmVzc2lvbi5qcycgKTtcblxudmFyIEphdmFzY3JpcHRFeHByZXNzaW9uID0gZnVuY3Rpb24oIGV4cHJlc3Npb25Ub0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmdFeHByZXNzaW9uID0gZXhwcmVzc2lvblRvQXBwbHk7XG4gICAgXG4gICAgdmFyIGV2YWx1YXRlID0gZnVuY3Rpb24oIHNjb3BlICl7XG4gICAgICAgIHZhciBldmFsdWF0ZWRTdHJpbmcgPSBzdHJpbmdFeHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICByZXR1cm4gZXZhbCggZXZhbHVhdGVkU3RyaW5nICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVwZW5kc09uID0gZnVuY3Rpb24oIGRlcHNEYXRhSXRlbSwgc2NvcGUgKXtcbiAgICAgICAgcmV0dXJuIGV4cHJlc3Npb25zVXRpbHMuYnVpbGREZXBlbmRzT25MaXN0KCBkZXBzRGF0YUl0ZW0sIHNjb3BlLCBzdHJpbmdFeHByZXNzaW9uICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nRXhwcmVzc2lvbjtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGV2YWx1YXRlOiBldmFsdWF0ZSxcbiAgICAgICAgZGVwZW5kc09uOiBkZXBlbmRzT24sXG4gICAgICAgIHRvU3RyaW5nOiB0b1N0cmluZ1xuICAgIH07XG59O1xuXG5KYXZhc2NyaXB0RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuXG5KYXZhc2NyaXB0RXhwcmVzc2lvbi5nZXRQcmVmaXggPSBmdW5jdGlvbigpIHtcbiAgICBpZiAoIEphdmFzY3JpcHRFeHByZXNzaW9uLnByZWZpeCA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgIEphdmFzY3JpcHRFeHByZXNzaW9uLnByZWZpeCA9IGNvbnRleHQuZ2V0Q29uZigpLmphdmFTY3JpcHRFeHByZXNzaW9uO1xuICAgIH1cbiAgICByZXR1cm4gSmF2YXNjcmlwdEV4cHJlc3Npb24ucHJlZml4O1xufTtcblxuSmF2YXNjcmlwdEV4cHJlc3Npb24uZ2V0SWQgPSBKYXZhc2NyaXB0RXhwcmVzc2lvbi5nZXRQcmVmaXg7XG5cbkphdmFzY3JpcHRFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICByZXR1cm4gbmV3IEphdmFzY3JpcHRFeHByZXNzaW9uKFxuICAgICAgICAgICAgU3RyaW5nRXhwcmVzc2lvbi5idWlsZCggc3RyaW5nICkgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gSmF2YXNjcmlwdEV4cHJlc3Npb247XG4iLCIvKlxuICAgIFF1ZXJ5RXhwcmVzc2lvbiBjbGFzc1xuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi8uLi9jb250ZXh0LmpzJyApO1xudmFyIGV4cHJlc3Npb25zVXRpbHMgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIFF1ZXJ5RXhwcmVzc2lvbiA9IGZ1bmN0aW9uKCBzdHJpbmdUb0FwcGx5LCBleHByZXNzaW9uVG9BcHBseSApIHtcbiAgICBcbiAgICB2YXIgc3RyaW5nID0gc3RyaW5nVG9BcHBseTtcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25Ub0FwcGx5O1xuICAgIFxuICAgIHZhciBldmFsdWF0ZSA9IGZ1bmN0aW9uKCBzY29wZSApe1xuICAgICAgICBcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIHZhciBldmFsdWF0ZWQgPSBleHByZXNzaW9uLmV2YWx1YXRlKCBzY29wZSApO1xuICAgICAgICAgICAgdmFyIGVsZW1lbnRMaXN0ID0gd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIGV2YWx1YXRlZCApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBlbGVtZW50TGlzdCB3aXRoIGxlbmd0aCAxXG4gICAgICAgICAgICBpZiAoIGVsZW1lbnRMaXN0Lmxlbmd0aCA9PT0gMSApe1xuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50TGlzdFsgMCBdLmlubmVyVGV4dDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gZWxlbWVudExpc3Qgd2l0aCBsZW5ndGggPiAxXG4gICAgICAgICAgICB2YXIgdGV4dHMgPSBbXTtcbiAgICAgICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGVsZW1lbnRMaXN0Lmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICAgICAgdGV4dHMucHVzaCggZWxlbWVudExpc3RbIGkgXS5pbm5lclRleHQgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0ZXh0cztcbiAgICAgICAgICAgIFxuICAgICAgICB9IGNhdGNoICggZSApe1xuICAgICAgICAgICAgcmV0dXJuICdRdWVyeSBleHByZXNzaW9uIGVycm9yIGluIFwiJyArIHN0cmluZyArICdcIjogJyArIGU7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgdmFyIGRlcGVuZHNPbiA9IGZ1bmN0aW9uKCBkZXBzRGF0YUl0ZW0sIHNjb3BlICl7XG4gICAgICAgIHJldHVybiBleHByZXNzaW9uc1V0aWxzLmJ1aWxkRGVwZW5kc09uTGlzdCggZGVwc0RhdGFJdGVtLCBzY29wZSwgZXhwcmVzc2lvbiApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHRvU3RyaW5nID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHN0cmluZztcbiAgICB9O1xuXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblF1ZXJ5RXhwcmVzc2lvbi5yZW1vdmVQcmVmaXggPSB0cnVlO1xuUXVlcnlFeHByZXNzaW9uLmdldFByZWZpeCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBjb250ZXh0LmdldENvbmYoKS5xdWVyeUV4cHJlc3Npb247XG59O1xuUXVlcnlFeHByZXNzaW9uLmdldElkID0gUXVlcnlFeHByZXNzaW9uLmdldFByZWZpeDtcblxuUXVlcnlFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbkJ1aWxkZXIuanMnICk7XG4gICAgXG4gICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uQnVpbGRlci5idWlsZCggc3RyaW5nICk7XG4gICAgXG4gICAgcmV0dXJuIG5ldyBRdWVyeUV4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbiApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBRdWVyeUV4cHJlc3Npb247XG4iLCIvKlxuICAgIFN0cmluZ0V4cHJlc3Npb24gY2xhc3NcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcbnZhciBTdHJpbmdMaXRlcmFsID0gcmVxdWlyZSggJy4vcGF0aC9saXRlcmFscy9zdHJpbmdMaXRlcmFsLmpzJyApO1xudmFyIFBhdGhFeHByZXNzaW9uID0gcmVxdWlyZSggJy4vcGF0aC9wYXRoRXhwcmVzc2lvbi5qcycgKTtcbnZhciBleHByZXNzaW9uc1V0aWxzID0gcmVxdWlyZSggJy4vZXhwcmVzc2lvbnNVdGlscy5qcycgKTtcblxudmFyIFN0cmluZ0V4cHJlc3Npb24gPSBmdW5jdGlvbiggc3RyaW5nVG9BcHBseSwgZXhwcmVzc2lvbkxpc3RUb0FwcGx5ICkge1xuICAgIFxuICAgIHZhciBzdHJpbmcgPSBzdHJpbmdUb0FwcGx5O1xuICAgIHZhciBleHByZXNzaW9uTGlzdCA9IGV4cHJlc3Npb25MaXN0VG9BcHBseTtcbiAgICBcbiAgICB2YXIgZXZhbHVhdGUgPSBmdW5jdGlvbiggc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciByZXN1bHQgPSAnJztcbiAgICAgICAgXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGV4cHJlc3Npb25MaXN0Lmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgdmFyIGV4cHJlc3Npb24gPSBleHByZXNzaW9uTGlzdFsgaSBdO1xuICAgICAgICAgICAgcmVzdWx0ICs9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcblxuICAgIHZhciBkZXBlbmRzT24gPSBmdW5jdGlvbiggZGVwc0RhdGFJdGVtLCBzY29wZSApe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbnNVdGlscy5idWlsZERlcGVuZHNPbkxpc3QoIGRlcHNEYXRhSXRlbSwgc2NvcGUsIGV4cHJlc3Npb25MaXN0ICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdG9TdHJpbmcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gc3RyaW5nO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZXZhbHVhdGU6IGV2YWx1YXRlLFxuICAgICAgICBkZXBlbmRzT246IGRlcGVuZHNPbixcbiAgICAgICAgdG9TdHJpbmc6IHRvU3RyaW5nXG4gICAgfTtcbn07XG5cblN0cmluZ0V4cHJlc3Npb24ucmVtb3ZlUHJlZml4ID0gdHJ1ZTtcblN0cmluZ0V4cHJlc3Npb24uZ2V0UHJlZml4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIGNvbnRleHQuZ2V0Q29uZigpLnN0cmluZ0V4cHJlc3Npb247XG59O1xuU3RyaW5nRXhwcmVzc2lvbi5nZXRJZCA9IFN0cmluZ0V4cHJlc3Npb24uZ2V0UHJlZml4O1xuXG5TdHJpbmdFeHByZXNzaW9uLmJ1aWxkID0gZnVuY3Rpb24oIHN0cmluZyApIHtcbiAgICB2YXIgU1RBVEVfU0NBTk5JTkcgPSAwO1xuICAgIHZhciBTVEFURV9BVF9ET0xMQVIgPSAxO1xuICAgIHZhciBTVEFURV9JTl9FWFBSRVNTSU9OID0gMjtcbiAgICB2YXIgU1RBVEVfSU5fQlJBQ0tFVEVEX0VYUFJFU1NJT04gPSAzO1xuXG4gICAgdmFyIGV4cHJlc3Npb25MaXN0ID0gW107XG4gICAgdmFyIGxpdGVyYWwgPSAnJztcbiAgICB2YXIgc3ViZXhwcmVzc2lvbiA9ICcnO1xuICAgIHZhciBzdGF0ZSA9IFNUQVRFX1NDQU5OSU5HO1xuXG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgc3RyaW5nLmxlbmd0aDsgaSsrICkge1xuICAgICAgICB2YXIgY2ggPSBzdHJpbmcuY2hhckF0KCBpICk7XG5cbiAgICAgICAgc3dpdGNoICggc3RhdGUgKSB7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgIC8vIEluIHRoZSBzdHJpbmcgcGFydCBvZiB0aGUgZXhwcmVzc2lvblxuICAgICAgICBjYXNlIFNUQVRFX1NDQU5OSU5HOlxuICAgICAgICAgICAgLy8gRm91bmQgYSBkb2xsYXIgc2lnblxuICAgICAgICAgICAgaWYgKCBjaCA9PT0gJyQnICkge1xuICAgICAgICAgICAgICAgIHN0YXRlID0gU1RBVEVfQVRfRE9MTEFSO1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gSnVzdCBrZWVwIGFwcGVuZGluZyB0byBidWZmZXJcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgbGl0ZXJhbCArPSBjaDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIC8vIE5leHQgY2hhcmFjdGVyIGFmdGVyIGRvbGxhciBzaWduXG4gICAgICAgIGNhc2UgU1RBVEVfQVRfRE9MTEFSOlxuICAgICAgICAgICAgLy8gQW4gZXNjYXBlZCBkb2xsYXIgc2lnblxuICAgICAgICAgICAgaWYgKCBjaCA9PT0gJyQnICkge1xuICAgICAgICAgICAgICAgIGxpdGVyYWwgKz0gJyQnO1xuICAgICAgICAgICAgICAgIHN0YXRlID0gU1RBVEVfU0NBTk5JTkc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBCZWdpbm5pbmcgb2YgYSBicmFja2V0ZWQgZXhwcmVzc2lvblxuICAgICAgICAgICAgfSBlbHNlIGlmICggY2ggPT09ICd7JyApIHtcbiAgICAgICAgICAgICAgICAvLyBSZXNldCBzdWJleHByZXNzaW9uIGFuZCBjaGFuZ2Ugc3RhdGVcbiAgICAgICAgICAgICAgICBzdWJleHByZXNzaW9uID0gJyc7XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBTVEFURV9JTl9CUkFDS0VURURfRVhQUkVTU0lPTjtcblxuICAgICAgICAgICAgICAgIC8vIEFkZCBsaXRlcmFsIGFuZCByZXNldCBpdCBpZiBuZWVkZWRcbiAgICAgICAgICAgICAgICBpZiAoIGxpdGVyYWwgKXtcbiAgICAgICAgICAgICAgICAgICAgZXhwcmVzc2lvbkxpc3QucHVzaCggXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3IFN0cmluZ0xpdGVyYWwoIGxpdGVyYWwgKSBcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgbGl0ZXJhbCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIEJlZ2lubmluZyBvZiBhIG5vbiBicmFja2V0ZWQgZXhwcmVzc2lvblxuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdWJleHByZXNzaW9uICs9IGNoO1xuICAgICAgICAgICAgICAgIHN0YXRlID0gU1RBVEVfSU5fRVhQUkVTU0lPTjtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAvLyBBZGQgbGl0ZXJhbCBhbmQgcmVzZXQgaXQgaWYgbmVlZGVkXG4gICAgICAgICAgICAgICAgaWYgKCBsaXRlcmFsICl7XG4gICAgICAgICAgICAgICAgICAgIGV4cHJlc3Npb25MaXN0LnB1c2goIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBTdHJpbmdMaXRlcmFsKCBsaXRlcmFsIClcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICAgICAgbGl0ZXJhbCA9ICcnO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuXG4gICAgICAgIC8vIEluIHN1YmV4cHJlc3Npb25cbiAgICAgICAgY2FzZSBTVEFURV9JTl9CUkFDS0VURURfRVhQUkVTU0lPTjpcbiAgICAgICAgY2FzZSBTVEFURV9JTl9FWFBSRVNTSU9OOlxuICAgICAgICAgICAgLy8gQ2hlY2sgZm9yIGVuZFxuICAgICAgICAgICAgaWYgKCAoIHN0YXRlID09PSBTVEFURV9JTl9CUkFDS0VURURfRVhQUkVTU0lPTiAmJiBjaCA9PT0gJ30nIClcbiAgICAgICAgICAgICAgICAgICAgfHwgKCBzdGF0ZSA9PT0gU1RBVEVfSU5fRVhQUkVTU0lPTiAmJiBjaCA9PSAnICcgKSApIHtcbiAgICAgICAgICAgICAgICBleHByZXNzaW9uTGlzdC5wdXNoKCBcbiAgICAgICAgICAgICAgICAgICAgICAgIFBhdGhFeHByZXNzaW9uLmJ1aWxkKCBzdWJleHByZXNzaW9uICkgXG4gICAgICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgICAgIGlmICggc3RhdGUgPT09IFNUQVRFX0lOX0VYUFJFU1NJT04gKSB7XG4gICAgICAgICAgICAgICAgICAgIGxpdGVyYWwgKz0gY2g7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHN0YXRlID0gU1RBVEVfU0NBTk5JTkc7XG4gICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBLZWVwIGFwcGVuZGluZyB0byBzdWJleHByZXNzaW9uXG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHN1YmV4cHJlc3Npb24gKz0gY2g7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICAvLyBFbmRlZCBpbiB1bmNsb3NlZCBicmFja2V0XG4gICAgaWYgKCBzdGF0ZSA9PT0gU1RBVEVfSU5fQlJBQ0tFVEVEX0VYUFJFU1NJT04gKSB7XG4gICAgICAgIHRocm93ICdVbmNsb3NlZCBsZWZ0IGN1cmx5IGJyYWNlOiAnICsgc3RyaW5nO1xuICAgICAgICBcbiAgICAvLyBFbmRlZCBhdCBleHByZXNzaW9uXG4gICAgfSBlbHNlIGlmICggc3RhdGUgPT0gU1RBVEVfSU5fRVhQUkVTU0lPTiApIHtcbiAgICAgICAgZXhwcmVzc2lvbkxpc3QucHVzaCggXG4gICAgICAgICAgICAgICAgUGF0aEV4cHJlc3Npb24uYnVpbGQoIHN1YmV4cHJlc3Npb24gKSBcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICBpZiAoIGxpdGVyYWwgKXtcbiAgICAgICAgZXhwcmVzc2lvbkxpc3QucHVzaCggXG4gICAgICAgICAgICAgICAgbmV3IFN0cmluZ0xpdGVyYWwoIGxpdGVyYWwgKSBcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFN0cmluZ0V4cHJlc3Npb24oIHN0cmluZywgZXhwcmVzc2lvbkxpc3QgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU3RyaW5nRXhwcmVzc2lvbjtcbiIsIi8qIFxuICAgIEkxOG4gY2xhc3MgXG4gICAgRXh0ZXJuYWwgZGVwZW5kZW5jaWVzOiBJbnRsIChzdXBwb3J0ZWQgYnkgcmVjZW50IGJyb3dzZXJzKSBhbmQgTWVzc2FnZUZvcm1hdFxuKi9cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24oIGxhbmd1YWdlSWQsIHJlcyApIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgTWVzc2FnZUZvcm1hdCA9IHJlcXVpcmUoICdtZXNzYWdlZm9ybWF0JyApO1xuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG4gICAgdmFyIHV0aWxzID0gcmVxdWlyZSggJy4uL3V0aWxzLmpzJyApO1xuICAgIFxuICAgIHZhciByZXNvdXJjZXMgPSByZXM7XG4gICAgdmFyIG1mID0gbmV3IE1lc3NhZ2VGb3JtYXQoIGxhbmd1YWdlSWQgKTtcbiAgICB2YXIgY2FjaGUgPSB7fTtcbiAgICB2YXIgbnVtYmVyRm9ybWF0Q2FjaGUgPSB7fTtcbiAgICB2YXIgZGF0ZVRpbWVGb3JtYXRDYWNoZSA9IHt9O1xuICAgIC8qdmFyIENPTkZfUkVTT1VSQ0VfSUQgPSAnL0NPTkYvJzsqL1xuICAgIHZhciBDT05GX1JFU09VUkNFX0lEID0gY29udGV4dC5nZXRDb25mKCkuaTE4bkNvbmZSZXNvdXJjZUlkO1xuICAgIFxuICAgIHZhciBnZXRMYW5ndWFnZSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIC8vcmV0dXJuIHJlc291cmNlc1sgY29udGV4dC5nZXRDb25mKCkuaTE4bkNvbmZSZXNvdXJjZUlkIF0ubGFuZ3VhZ2U7XG4gICAgICAgIHJldHVybiByZXNvdXJjZXNbIENPTkZfUkVTT1VSQ0VfSUQgXS5sYW5ndWFnZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRMb2NhbGUgPSBmdW5jdGlvbigpe1xuICAgICAgICAvL3JldHVybiByZXNvdXJjZXNbIGNvbnRleHQuZ2V0Q29uZigpLmkxOG5Db25mUmVzb3VyY2VJZCBdLmxvY2FsZTtcbiAgICAgICAgcmV0dXJuIHJlc291cmNlc1sgQ09ORl9SRVNPVVJDRV9JRCBdLmxvY2FsZTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBleGlzdHMgPSBmdW5jdGlvbiggaWQgKSB7XG4gICAgICAgIHJldHVybiByZXNvdXJjZXNbIGlkIF0gIT09IHVuZGVmaW5lZDtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0ciA9IGZ1bmN0aW9uKCBpZCwgcGFyYW1zLCBmb3JtYXQsIHN1YmZvcm1hdCApIHtcbiAgICAgICAgXG4gICAgICAgIHN3aXRjaCAoIGZvcm1hdCApIHtcbiAgICAgICAgY2FzZSAnc3RyaW5nJzpcbiAgICAgICAgICAgIHJldHVybiB0clN0cmluZyggaWQsIHBhcmFtcyApO1xuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgcmV0dXJuIHRyTnVtYmVyKCBpZCwgcGFyYW1zICk7XG4gICAgICAgIGNhc2UgJ2N1cnJlbmN5JzpcbiAgICAgICAgICAgIHJldHVybiB0ckN1cnJlbmN5KCBpZCwgcGFyYW1zLCBzdWJmb3JtYXQgKTtcbiAgICAgICAgY2FzZSAnZGF0ZXRpbWUnOlxuICAgICAgICAgICAgcmV0dXJuIHRyRGF0ZVRpbWUoIGlkLCBwYXJhbXMgKTtcbiAgICAgICAgfSBcbiAgICAgICAgXG4gICAgICAgIHRocm93ICdJMThuIGZvcm1hdCB0eXBlIG5vdCBzdXBwb3J0ZWQ6ICcgKyBmb3JtYXQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHJTdHJpbmcgPSBmdW5jdGlvbiggaWQsIHBhcmFtcyApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBtZnVuYyA9IGNhY2hlWyBpZCBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIG1mdW5jICl7XG4gICAgICAgICAgICBtZnVuYyA9IG1mLmNvbXBpbGUoIHJlc291cmNlc1sgaWQgXSApO1xuICAgICAgICAgICAgY2FjaGVbIGlkIF0gPSBtZnVuYztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG1mdW5jKCBwYXJhbXMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBnZXRTb3VyY2UgPSBmdW5jdGlvbiggcGFyYW1zICl7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gcGFyYW1zICYmIHV0aWxzLmlzRnVuY3Rpb24oIHBhcmFtcy50b1NvdXJjZSApP1xuICAgICAgICAgICAgcGFyYW1zLnRvU291cmNlKCk6XG4gICAgICAgICAgICAnJztcbiAgICB9O1xuICAgIFxuICAgIHZhciB0ck51bWJlciA9IGZ1bmN0aW9uKCB2YWx1ZSwgcGFyYW1zICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIHNvdXJjZSA9IGdldFNvdXJjZSggcGFyYW1zICk7XG4gICAgICAgIHZhciBudW1iZXJGb3JtYXQgPSBudW1iZXJGb3JtYXRDYWNoZVsgc291cmNlIF07XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbnVtYmVyRm9ybWF0ICl7XG4gICAgICAgICAgICBudW1iZXJGb3JtYXQgPSBuZXcgSW50bC5OdW1iZXJGb3JtYXQoIGdldExvY2FsZSgpLCBwYXJhbXMgKTtcbiAgICAgICAgICAgIG51bWJlckZvcm1hdENhY2hlWyBzb3VyY2UgXSA9IG51bWJlckZvcm1hdDtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIG51bWJlckZvcm1hdC5mb3JtYXQoIHZhbHVlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHJDdXJyZW5jeSA9IGZ1bmN0aW9uKCB2YWx1ZSwgcGFyYW1zLCB0aGVDdXJyZW5jeSApIHtcbiAgICAgICAgXG4gICAgICAgIHBhcmFtcy5zdHlsZSA9ICdjdXJyZW5jeSc7XG4gICAgICAgIHBhcmFtcy5jdXJyZW5jeSA9IHRoZUN1cnJlbmN5O1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIHRyTnVtYmVyKCB2YWx1ZSwgcGFyYW1zICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdHJEYXRlVGltZSA9IGZ1bmN0aW9uKCB2YWx1ZSwgcGFyYW1zICkge1xuICAgICAgICBcbiAgICAgICAgdmFyIHNvdXJjZSA9IGdldFNvdXJjZSggcGFyYW1zICk7XG4gICAgICAgIHZhciBkYXRlVGltZUZvcm1hdCA9IGRhdGVUaW1lRm9ybWF0Q2FjaGVbIHNvdXJjZSBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGRhdGVUaW1lRm9ybWF0ICl7XG4gICAgICAgICAgICBkYXRlVGltZUZvcm1hdCA9IG5ldyBJbnRsLkRhdGVUaW1lRm9ybWF0KCBnZXRMb2NhbGUoKSwgcGFyYW1zICk7XG4gICAgICAgICAgICBkYXRlVGltZUZvcm1hdENhY2hlWyBzb3VyY2UgXSA9IGRhdGVUaW1lRm9ybWF0O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gZGF0ZVRpbWVGb3JtYXQuZm9ybWF0KCB2YWx1ZSApO1xuICAgIH07XG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgZ2V0TGFuZ3VhZ2U6IGdldExhbmd1YWdlLFxuICAgICAgICBnZXRMb2NhbGU6IGdldExvY2FsZSxcbiAgICAgICAgZXhpc3RzOiBleGlzdHMsXG4gICAgICAgIHRyOiB0clxuICAgIH07XG59O1xuIiwiLyogXG4gICAgSTE4bkJ1bmRsZSBjbGFzcyBcbiovXG5tb2R1bGUuZXhwb3J0cyA9IGZ1bmN0aW9uKCApIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgaTE4bkxpc3QgPSB7fTtcbiAgICB2YXIgZmlyc3QgPSB1bmRlZmluZWQ7XG5cbiAgICB2YXIgYWRkID0gZnVuY3Rpb24oIGkxOG4gKXtcbiAgICAgICAgaTE4bkxpc3RbIGkxOG4uZ2V0TGFuZ3VhZ2UoKSBdID0gaTE4bjtcbiAgICAgICAgaWYgKCAhIGZpcnN0ICl7XG4gICAgICAgICAgICBmaXJzdCA9IGkxOG47XG4gICAgICAgIH1cbiAgICB9O1xuICAgIFxuICAgIHZhciBleGlzdHMgPSBmdW5jdGlvbiggaWQgKXtcbiAgICAgICAgcmV0dXJuIGZpcnN0LmV4aXN0cyggaWQgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB0ciA9IGZ1bmN0aW9uKCBpZCwgcGFyYW1zLCBmb3JtYXQsIHN1YmZvcm1hdCwgbGFuZ3VhZ2UgKSB7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbGFuZ3VhZ2UgKXtcbiAgICAgICAgICAgIHRocm93ICdMYW5ndWFnZSBub3QgZGVmaW5lZCEgUGxlYXNlLCB1c2UgZGF0YS1pTGFuZ3VhZ2UgdG8gZGVmaW5lIGl0IGJlZm9yZSB0cnlpbmcgdG8gdHJhbnNsYXRlIGFueXRoaW5nISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBpMThuID0gaTE4bkxpc3RbIGxhbmd1YWdlIF07XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgaTE4biApe1xuICAgICAgICAgICAgdGhyb3cgJ0xhbmd1YWdlIFwiJyArIGxhbmd1YWdlICsgJ1wiIG5vdCBmb3VuZCBpbiBJMThuQnVuZGxlISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiBpMThuLnRyKCBpZCwgcGFyYW1zLCBmb3JtYXQsIHN1YmZvcm1hdCApO1xuICAgIH07XG5cbiAgICAvLyBJbml0IVxuICAgIGZvciAoIHZhciBjID0gMDsgYyA8IGFyZ3VtZW50cy5sZW5ndGg7IGMrKyApIHtcbiAgICAgICAgYWRkKCBhcmd1bWVudHNbIGMgXSApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBhZGQ6IGFkZCxcbiAgICAgICAgZXhpc3RzOiBleGlzdHMsXG4gICAgICAgIHRyOiB0clxuICAgIH07XG59O1xuIiwiLyogXG4gICAgaTE4bkhlbHBlciBzaW5nbGV0b24gY2xhc3MgXG4qL1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uL3V0aWxzLmpzJyApO1xudmFyIEkxOG4gPSByZXF1aXJlKCAnLi9pMThuLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIHRyID0gZnVuY3Rpb24gKCBpMThuTGlzdCwgaWQsIHBhcmFtcywgZm9ybWF0LCBzdWJmb3JtYXQsIGxhbmd1YWdlICl7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgaTE4bkxpc3QgKSB7XG4gICAgICAgICAgICByZXR1cm4gJ05vIEkxOG4gaW5zdGFuY2UgZGVmaW5lZCEnO1xuICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgdmFyIGxlbmd0aCA9IGkxOG5MaXN0Lmxlbmd0aDtcbiAgICAgICAgaWYgKCAhIGxlbmd0aCApe1xuICAgICAgICAgICAgcmV0dXJuICdWb2lkIEkxOG4gbGlzdCEnO1xuICAgICAgICB9XG5cbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgbGVuZ3RoOyBpKysgKSB7XG4gICAgICAgICAgICB2YXIgaTE4biA9IGkxOG5MaXN0WyBpIF07XG4gICAgICAgICAgICBpZiAoIGZvcm1hdCAhPT0gJ3N0cmluZycgfHwgaTE4bi5leGlzdHMoIGlkICkgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gaTE4bi50ciggaWQsIHBhcmFtcywgZm9ybWF0LCBzdWJmb3JtYXQsIGxhbmd1YWdlICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiAnSTE4biByZXNvdXJjZSBcIicgKyBpZCArICdcIiBub3QgZm91bmQhJztcbiAgICB9O1xuICAgIFxuICAgIHZhciBsb2FkQXN5bmMgPSBmdW5jdGlvbiggcmVtb3RlTGlzdCwgY2FsbGJhY2ssIGZhaWxDYWxsYmFjayApe1xuICAgICAgICBcbiAgICAgICAgbG9hZEFzeW5jSXRlbSggXG4gICAgICAgICAgICB7fSwgXG4gICAgICAgICAgICBjYWxsYmFjaywgXG4gICAgICAgICAgICBmYWlsQ2FsbGJhY2ssXG4gICAgICAgICAgICByZW1vdGVMaXN0LCBcbiAgICAgICAgICAgIHJlbW90ZUxpc3QubGVuZ3RoIC0gMSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGxvYWRBc3luY0l0ZW0gPSBmdW5jdGlvbiggbWFwLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrLCByZW1vdGVMaXN0LCBjdXJyZW50SW5kZXggKXtcbiAgICAgICAgXG4gICAgICAgIHZhciB1cmwgPSByZW1vdGVMaXN0WyBjdXJyZW50SW5kZXggXTtcbiAgICAgICAgdXRpbHMuZ2V0SlNPTiggXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdXJsOiB1cmwsXG4gICAgICAgICAgICAgICAgZG9uZTogZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcFsgdXJsIF0gPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRJbmRleCA+IDAgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRBc3luY0l0ZW0oIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2ssIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxDYWxsYmFjayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVMaXN0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLWN1cnJlbnRJbmRleCApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soIG1hcCApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBmYWlsOiBmdW5jdGlvbigganF4aHIsIHRleHRTdGF0dXMsIGVycm9yICkge1xuICAgICAgICAgICAgICAgICAgICBjb250ZXh0LmFzeW5jRXJyb3IoIHVybCwgZXJyb3IsIGZhaWxDYWxsYmFjayApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICB9O1xuICAgIC8qXG4gICAgdmFyIGxvYWRBc3luY0l0ZW0gPSBmdW5jdGlvbiggbWFwLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrLCByZW1vdGVMaXN0LCBjdXJyZW50SW5kZXggKXtcbiAgICAgICAgXG4gICAgICAgIHZhciB1cmwgPSByZW1vdGVMaXN0WyBjdXJyZW50SW5kZXggXTtcbiAgICAgICAgJC5nZXRKU09OKCB1cmwgKVxuICAgICAgICAgICAgLmRvbmUoXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oIGRhdGEgKSB7XG4gICAgICAgICAgICAgICAgICAgIG1hcFsgdXJsIF0gPSBkYXRhO1xuICAgICAgICAgICAgICAgICAgICBpZiAoIGN1cnJlbnRJbmRleCA+IDAgKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxvYWRBc3luY0l0ZW0oIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1hcCwgXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2ssIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZhaWxDYWxsYmFjayxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZW1vdGVMaXN0LCBcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtLWN1cnJlbnRJbmRleCApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soIG1hcCApO1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKVxuICAgICAgICAgICAgLmZhaWwoXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oIGpxeGhyLCB0ZXh0U3RhdHVzLCBlcnJvciApIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5hc3luY0Vycm9yKCB1cmwsIGVycm9yLCBmYWlsQ2FsbGJhY2sgKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICApO1xuICAgIH07XG4gICAgKi9cbiAgICBcbiAgICB2YXIgbG9hZEFzeW5jQXV0byA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5LCBpMThuLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrICl7XG4gICAgICAgIFxuICAgICAgICAvLyBSZXR1cm4gaWYgaXQgaXMgbm90aGluZyB0byBkb1xuICAgICAgICBpZiAoICEgaTE4biB8fCAhIGkxOG4uZmlsZXMgfHwgISBPYmplY3Qua2V5cyggaTE4bi5maWxlcyApLmxlbmd0aCApe1xuICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQganNvbkZpbGVzIGFycmF5XG4gICAgICAgIHZhciBudW1iZXJPZkxhbmd1YWdlcyA9IE9iamVjdC5rZXlzKCBpMThuLmZpbGVzICkubGVuZ3RoO1xuICAgICAgICB2YXIganNvbkZpbGVzID0gW107XG4gICAgICAgIHZhciB1cmxQcmVmaXggPSBpMThuLnVybFByZWZpeCB8fCAnJztcbiAgICAgICAgZm9yICggdmFyIGxhbmcgaW4gaTE4bi5maWxlcyApe1xuICAgICAgICAgICAgdmFyIGxhbmdGaWxlcyA9IGkxOG4uZmlsZXNbIGxhbmcgXTtcbiAgICAgICAgICAgIGZvciAoIHZhciBpbmRleCBpbiBsYW5nRmlsZXMgKXtcbiAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGxhbmdGaWxlc1sgaW5kZXggXTtcbiAgICAgICAgICAgICAgICB2YXIgdXJsID0gdXJsUHJlZml4ICsgZmlsZTtcbiAgICAgICAgICAgICAgICBqc29uRmlsZXMucHVzaCggdXJsICk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIFVzZSBsb2FkQXN5bmMgbWV0aG9kIHRvIGxvYWQgYWxsIGpzb25GaWxlczsgdGhlbiByZWdpc3RlciBJMThuIGluc3RhbmNlcyBhbmQgYXJyYXlzXG4gICAgICAgIGxvYWRBc3luYyggXG4gICAgICAgICAgICBqc29uRmlsZXMsIFxuICAgICAgICAgICAgZnVuY3Rpb24oIGkxOG5NYXAgKXtcbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBmb3IgKCB2YXIgbGFuZyBpbiBpMThuLmZpbGVzICl7XG4gICAgICAgICAgICAgICAgICAgIHZhciBsYW5nRmlsZXMgPSBpMThuLmZpbGVzWyBsYW5nIF07XG4gICAgICAgICAgICAgICAgICAgIHZhciBpMThuSW5zdGFuY2VBcnJheSA9IFtdO1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgLy8gUmVnaXN0ZXIgYXJyYXkgdmFyc1xuICAgICAgICAgICAgICAgICAgICBkaWN0aW9uYXJ5WyBidWlsZEkxOG5JbnN0YW5jZUFycmF5TmFtZSggbGFuZyApIF0gPSBpMThuSW5zdGFuY2VBcnJheTtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCBudW1iZXJPZkxhbmd1YWdlcyA9PT0gMSApe1xuICAgICAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyeVsgJ2kxOG5BcnJheScgXSA9IGkxOG5JbnN0YW5jZUFycmF5O1xuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICAgICBmb3IgKCB2YXIgaW5kZXggaW4gbGFuZ0ZpbGVzICl7XG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZSA9IGxhbmdGaWxlc1sgaW5kZXggXTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB1cmwgPSB1cmxQcmVmaXggKyBmaWxlO1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGkxOG5JbnN0YW5jZSA9IG5ldyBJMThuKCBsYW5nLCBpMThuTWFwWyB1cmwgXSApO1xuICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBSZWdpc3RlciBpMThuIGluc3RhbmNlc1xuICAgICAgICAgICAgICAgICAgICAgICAgZGljdGlvbmFyeVsgYnVpbGRJMThuSW5zdGFuY2VOYW1lKCBmaWxlICkgXSA9IGkxOG5JbnN0YW5jZTtcbiAgICAgICAgICAgICAgICAgICAgICAgIGkxOG5JbnN0YW5jZUFycmF5LnVuc2hpZnQoIGkxOG5JbnN0YW5jZSApOyAvLyBBZGQgdG8gdGhlIGJlZ2lubmluZyBvZiB0aGUgYXJyYXlcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGZhaWxDYWxsYmFjayBcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZEkxOG5JbnN0YW5jZUFycmF5TmFtZSA9IGZ1bmN0aW9uKCBsYW5nICl7XG4gICAgICAgIHJldHVybiAnaTE4bicgKyBsYW5nLnRvVXBwZXJDYXNlKCkgKyAnQXJyYXknO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGJ1aWxkSTE4bkluc3RhbmNlTmFtZSA9IGZ1bmN0aW9uKCBmaWxlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgZmlsZVdpdGhvdXRFeHRlbnNpb24gPSBmaWxlLnN1YnN0ciggMCwgZmlsZS5sYXN0SW5kZXhPZiggJy4nICkgKTtcbiAgICAgICAgcmV0dXJuICdpMThuJyArIGZpbGVXaXRob3V0RXh0ZW5zaW9uLnRvVXBwZXJDYXNlKCk7XG4gICAgfTtcblxuICAgIHJldHVybiB7XG4gICAgICAgIHRyOiB0cixcbiAgICAgICAgbG9hZEFzeW5jOiBsb2FkQXN5bmMsXG4gICAgICAgIGxvYWRBc3luY0F1dG86IGxvYWRBc3luY0F1dG9cbiAgICB9O1xufSkoKTtcbiIsIi8qXG4gICAgbG9nSGVscGVyIHNpbmdsZXRvbiBjbGFzc1xuKi9cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4vY29udGV4dC5qcycgKTtcbiAgICBcbiAgICB2YXIgdHJhY2UgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIudHJhY2UuYXBwbHkoIGxvZ2dlciwgYXJndW1lbnRzICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZGVidWcgPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIuZGVidWcuYXBwbHkoIGxvZ2dlciwgYXJndW1lbnRzICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgaW5mbyA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBcbiAgICAgICAgdmFyIGxvZ2dlciA9IGNvbnRleHQuZ2V0TG9nZ2VyKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbG9nZ2VyICl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGxvZ2dlci5pbmZvLmFwcGx5KCBsb2dnZXIsIGFyZ3VtZW50cyApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIHdhcm4gPSBmdW5jdGlvbiAoKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBsb2dnZXIgPSBjb250ZXh0LmdldExvZ2dlcigpO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGxvZ2dlciApe1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBsb2dnZXIud2Fybi5hcHBseSggbG9nZ2VyLCBhcmd1bWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBlcnJvciA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBcbiAgICAgICAgdmFyIGxvZ2dlciA9IGNvbnRleHQuZ2V0TG9nZ2VyKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbG9nZ2VyICl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGxvZ2dlci5lcnJvci5hcHBseSggbG9nZ2VyLCBhcmd1bWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBmYXRhbCA9IGZ1bmN0aW9uICgpe1xuICAgICAgICBcbiAgICAgICAgdmFyIGxvZ2dlciA9IGNvbnRleHQuZ2V0TG9nZ2VyKCk7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgbG9nZ2VyICl7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGxvZ2dlci5mYXRhbC5hcHBseSggbG9nZ2VyLCBhcmd1bWVudHMgKTtcbiAgICB9O1xuICAgIFxuICAgIC8qXG4gICAgdmFyIGZhdGFsQW5kVGhyb3cgPSBmdW5jdGlvbiAoIG1lc3NhZ2UgKXtcbiAgICAgICAgXG4gICAgICAgIGZhdGFsLmFwcGx5KCB0aGlzLCBhcmd1bWVudHMgKTtcbiAgICAgICAgdGhyb3cgbWVzc2FnZTtcbiAgICB9OyovXG4gICAgXG4gICAgcmV0dXJuIHtcbiAgICAgICAgdHJhY2U6IHRyYWNlLFxuICAgICAgICBkZWJ1ZzogZGVidWcsXG4gICAgICAgIGluZm86IGluZm8sXG4gICAgICAgIHdhcm46IHdhcm4sXG4gICAgICAgIGVycm9yOiBlcnJvcixcbiAgICAgICAgZmF0YWw6IGZhdGFsXG4gICAgICAgIC8vZmF0YWxBbmRUaHJvdzogZmF0YWxBbmRUaHJvd1xuICAgIH07XG59KSgpO1xuIiwiLypcclxuICAgIEV4cG9ydGVkIGZ1bmN0aW9uc1xyXG4qL1xyXG5leHBvcnRzLnJ1biA9IGZ1bmN0aW9uKCBvcHRpb25zICl7XHJcbiAgICBcclxuICAgIHZhciBwYXJzZXIgPSByZXF1aXJlKCAnLi9wYXJzZXJzL3BhcnNlci5qcycgKTtcclxuICAgIHJldHVybiBwYXJzZXIucnVuKCBvcHRpb25zICk7XHJcbn07XHJcblxyXG4vKiBEZWNsYXJlIGV4cG9ydHMgKi9cclxuZXhwb3J0cy5JMThuID0gcmVxdWlyZSggJy4vaTE4bi9pMThuLmpzJyApO1xyXG5leHBvcnRzLkkxOG5CdW5kbGUgPSByZXF1aXJlKCAnLi9pMThuL2kxOG5CdW5kbGUuanMnICk7XHJcbmV4cG9ydHMuaTE4bkhlbHBlciA9IHJlcXVpcmUoICcuL2kxOG4vaTE4bkhlbHBlci5qcycgKTtcclxuZXhwb3J0cy5jb250ZXh0ID0gcmVxdWlyZSggJy4vY29udGV4dC5qcycgKTtcclxuZXhwb3J0cy5sb2dIZWxwZXIgPSByZXF1aXJlKCAnLi9sb2dIZWxwZXIuanMnICk7XHJcbmV4cG9ydHMuZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcclxuZXhwb3J0cy5ldmFsdWF0ZUhlbHBlciA9IHJlcXVpcmUoICcuL2V4cHJlc3Npb25zL2V2YWx1YXRlSGVscGVyLmpzJyApO1xyXG5leHBvcnRzLkV4cHJlc3Npb25Ub2tlbml6ZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9ucy9leHByZXNzaW9uVG9rZW5pemVyLmpzJyApO1xyXG5leHBvcnRzLlJlYWN0aXZlRGljdGlvbmFyeSA9IHJlcXVpcmUoICcuL3Njb3Blcy9yZWFjdGl2ZURpY3Rpb25hcnkuanMnICk7XHJcbmV4cG9ydHMudmVyc2lvbiA9IHJlcXVpcmUoICcuL3ZlcnNpb24uanMnICk7XHJcblxyXG4vKiBTdXBwb3J0IFJlcXVpcmVKUyBtb2R1bGUgcGF0dGVybiAqL1xyXG5pZiAoIHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZCApIHtcclxuICAgIGRlZmluZSggJ3pwdC5ydW4nLCBleHBvcnRzLnJ1biApO1xyXG4gICAgZGVmaW5lKCAnenB0LkkxOG4nLCBleHBvcnRzLkkxOG4gKTtcclxuICAgIGRlZmluZSggJ3pwdC5JMThuQnVuZGxlJywgZXhwb3J0cy5JMThuQnVuZGxlICk7XHJcbiAgICBkZWZpbmUoICd6cHQuaTE4bkhlbHBlcicsIGV4cG9ydHMuaTE4bkhlbHBlciApO1xyXG4gICAgZGVmaW5lKCAnenB0LmNvbnRleHQnLCBleHBvcnRzLmNvbnRleHQgKTtcclxuICAgIGRlZmluZSggJ3pwdC5sb2dIZWxwZXInLCBleHBvcnRzLmxvZ0hlbHBlciApO1xyXG4gICAgZGVmaW5lKCAnenB0LmV4cHJlc3Npb25CdWlsZGVyJywgZXhwb3J0cy5leHByZXNzaW9uQnVpbGRlciApO1xyXG4gICAgZGVmaW5lKCAnenB0LmV2YWx1YXRlSGVscGVyJywgZXhwb3J0cy5ldmFsdWF0ZUhlbHBlciApO1xyXG4gICAgZGVmaW5lKCAnenB0LkV4cHJlc3Npb25Ub2tlbml6ZXInLCBleHBvcnRzLkV4cHJlc3Npb25Ub2tlbml6ZXIgKTtcclxuICAgIGRlZmluZSggJ3pwdC5SZWFjdGl2ZURpY3Rpb25hcnknLCBleHBvcnRzLlJlYWN0aXZlRGljdGlvbmFyeSApO1xyXG4gICAgZGVmaW5lKCAnenB0LnZlcnNpb24nLCBleHBvcnRzLnZlcnNpb24gKTtcclxufVxyXG4iLCIvKiBcbiAgICBDbGFzcyBBdXRvRGVmaW5lSGVscGVyIFxuKi9cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgVEFMRGVmaW5lID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbERlZmluZS5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoIG5vZGUgKSB7XG4gICAgXCJ1c2Ugc3RyaWN0XCI7XG4gICAgXG4gICAgdmFyIGRlZmluZURlbGltaXRlciA9IGNvbnRleHQuZ2V0Q29uZigpLmRlZmluZURlbGltaXRlcjtcbiAgICB2YXIgaW5EZWZpbmVEZWxpbWl0ZXIgPSBjb250ZXh0LmdldENvbmYoKS5pbkRlZmluZURlbGltaXRlcjtcbiAgICB2YXIgbm9jYWxsRXhwcmVzc2lvblByZWZpeCA9IGNvbnRleHQuZ2V0Q29uZigpLm5vY2FsbFZhcmlhYmxlRXhwcmVzc2lvblByZWZpeDtcbiAgICB2YXIgdGFsQXV0b0RlZmluZSA9IGNvbnRleHQuZ2V0VGFncygpLnRhbEF1dG9EZWZpbmU7XG5cbiAgICB2YXIgYnVmZmVyID0gJyc7XG4gICAgaWYgKCBub2RlICYmIG5vZGUuZ2V0QXR0cmlidXRlKCB0YWxBdXRvRGVmaW5lICkgKXtcbiAgICAgICAgYnVmZmVyID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhbEF1dG9EZWZpbmUgKTtcbiAgICB9XG4gICAgXG4gICAgdmFyIHB1dCA9IGZ1bmN0aW9uKCBuYW1lLCBzdHJpbmcsIG5vY2FsbCApe1xuICAgICAgICBcbiAgICAgICAgaWYgKCBidWZmZXIgIT09ICcnICl7XG4gICAgICAgICAgICBidWZmZXIgKz0gZGVmaW5lRGVsaW1pdGVyO1xuICAgICAgICB9XG4gICAgICAgIGJ1ZmZlciArPSAobm9jYWxsPyBub2NhbGxFeHByZXNzaW9uUHJlZml4ICsgaW5EZWZpbmVEZWxpbWl0ZXI6ICcnKSArIG5hbWUgKyBpbkRlZmluZURlbGltaXRlciArIHN0cmluZztcbiAgICB9O1xuXG4gICAgdmFyIHVwZGF0ZU5vZGUgPSBmdW5jdGlvbiggbm9kZSApe1xuXG4gICAgICAgIGlmICggYnVmZmVyICl7XG4gICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggdGFsQXV0b0RlZmluZSwgYnVmZmVyICk7XG4gICAgICAgICAgICByZXR1cm4gYnVmZmVyO1xuICAgICAgICB9XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBwdXQ6IHB1dCxcbiAgICAgICAgdXBkYXRlTm9kZTogdXBkYXRlTm9kZVxuICAgIH07XG59O1xuIiwiLyogXG4gICAgQ2xhc3MgRGVwc0RhdGFJdGVtIFxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgRGVwc0RhdGFJdGVtID0gZnVuY3Rpb24oKSB7XG4gICAgXG4gICAgdGhpcy5ub25FeHByZXNzaW9uVmFycyA9IHt9O1xuICAgIHRoaXMuZXhwcmVzc2lvblZhcnMgPSB7fTtcbn07XG5cbkRlcHNEYXRhSXRlbS5wcm90b3R5cGUubXVzdEFkZFZhciA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XG4gICAgcmV0dXJuIHRoaXMubm9uRXhwcmVzc2lvblZhcnNbIHZhck5hbWUgXSA9PT0gdW5kZWZpbmVkICYmIHRoaXMuZXhwcmVzc2lvblZhcnNbIHZhck5hbWUgXSA9PT0gdW5kZWZpbmVkO1xufTtcblxuRGVwc0RhdGFJdGVtLnByb3RvdHlwZS5hZGRBbGxWYXJzID0gZnVuY3Rpb24oIHZhck5hbWVzLCBzY29wZSApe1xuICAgIFxuICAgIGZvciAoIHZhciBuYW1lIGluIHZhck5hbWVzICl7XG4gICAgICAgIHRoaXMuYWRkMVZhciggdmFyTmFtZXNbIG5hbWUgXSwgc2NvcGUgKTtcbiAgICB9XG59O1xuXG5EZXBzRGF0YUl0ZW0ucHJvdG90eXBlLmFkZDFFeHByZXNzaW9uVmFyID0gZnVuY3Rpb24oIHZhck5hbWUgKXtcbiAgICB0aGlzLmV4cHJlc3Npb25WYXJzWyB2YXJOYW1lIF0gPSB0cnVlO1xufTtcblxuRGVwc0RhdGFJdGVtLnByb3RvdHlwZS5hZGQxTm9uRXhwcmVzc2lvblZhciA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XG4gICAgdGhpcy5ub25FeHByZXNzaW9uVmFyc1sgdmFyTmFtZSBdID0gdHJ1ZTtcbn07XG5cbkRlcHNEYXRhSXRlbS5wcm90b3R5cGUuYWRkMVZhciA9IGZ1bmN0aW9uKCB2YXJOYW1lLCBzY29wZSApe1xuXG4gICAgdmFyIG1hcCA9IHNjb3BlLmlzTG9jYWxWYXIoIHZhck5hbWUgKT8gdGhpcy5leHByZXNzaW9uVmFyczogdGhpcy5ub25FeHByZXNzaW9uVmFycztcbiAgICBtYXBbIHZhck5hbWUgXSA9IHRydWU7XG5cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gRGVwc0RhdGFJdGVtO1xuIiwiLyogXG4gICAgQ2xhc3MgQWJzdHJhY3RBY3Rpb25cbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uLy4uL3V0aWxzLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcblxudmFyIEFic3RyYWN0QWN0aW9uID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcbiAgICBcbiAgICB0aGlzLmlkID0gb2JqZWN0LmlkO1xuICAgIHRoaXMudmFyID0gb2JqZWN0LnZhcjtcbiAgICB0aGlzLmN1cnJlbnRFbGVtZW50ID0gb2JqZWN0LmN1cnJlbnRFbGVtZW50O1xuICAgIHRoaXMuYW5pbWF0aW9uID0gb2JqZWN0LmFuaW1hdGlvbjtcbiAgICB0aGlzLmFuaW1hdGlvbkNhbGxiYWNrID0gb2JqZWN0LmFuaW1hdGlvbkNhbGxiYWNrO1xuICAgIGlmICggb2JqZWN0LnNlYXJjaCApe1xuICAgICAgICBpZiAoIHRoaXMuaWQgfHwgdGhpcy52YXIgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciBpbiBhY3Rpb246IHlvdSBjYW4gbm90IHNldCBhIHNlYXJjaCBhbmQgdGhlbiBhbmQgaWQ6IGlmIHlvdSBzZXQgYSBzZWFyY2ggWlBULUpTIHdpbGwgc2V0IHRoZSBpZCBmb3IgeW91ISc7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5pbml0aWFsaXplVXNpbmdTZWFyY2goIG9iamVjdC5zZWFyY2gsIGRpY3Rpb25hcnkgKTtcbiAgICB9XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUuaW5pdGlhbGl6ZVVzaW5nU2VhcmNoID0gZnVuY3Rpb24oIHNlYXJjaCwgZGljdGlvbmFyeSApe1xuXG4gICAgdGhpcy5pZCA9ICcnO1xuICAgIHRoaXMudmFyID0gZGljdGlvbmFyeTtcbiAgICBcbiAgICAvLyBJdGVyYXRlIHNlYXJjaCBpdGVtcyBhbmQgYnVpbGQgaWQgYW5kIHZhclxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHNlYXJjaC5sZW5ndGg7ICsraSApe1xuICAgICAgICB2YXIgaXRlbSA9IHNlYXJjaFsgaSBdO1xuICAgICAgICBcbiAgICAgICAgLy8gUmVwbGFjZSBpdGVtIGlzIGl0IGEgc2VhcmNoIG9iamVjdCwgJ19maXJzdF8nIG9yICdfbGFzdF8nXG4gICAgICAgIGlmICggdXRpbHMuaXNQbGFpbk9iamVjdCggaXRlbSApICl7XG4gICAgICAgICAgICBpdGVtID0gdGhpcy5zZWFyY2goIHRoaXMudmFyLCBpdGVtICk7XG4gICAgICAgIH0gZWxzZSBpZiAoIGl0ZW0gPT09IGNvbnRleHQuZ2V0Q29uZigpLmZpcnN0SW5kZXhJZGVudGlmaWVyICl7XG4gICAgICAgICAgICBpdGVtID0gMDtcbiAgICAgICAgfSBlbHNlIGlmICggaXRlbSA9PT0gY29udGV4dC5nZXRDb25mKCkubGFzdEluZGV4SWRlbnRpZmllciApe1xuICAgICAgICAgICAgaXRlbSA9IHRoaXMudmFyLmxlbmd0aCAtIDE7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEJ1aWxkIHRoZSBpZFxuICAgICAgICBpZiAoIE51bWJlci5pc0ludGVnZXIoIGl0ZW0gKSApe1xuICAgICAgICAgICAgdGhpcy5pZCArPSAnWycgKyBpdGVtICsgJ10nO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgdmFyIHNlcGFyYXRvciA9IGkgPT09IDA/ICcnOiAnLic7XG4gICAgICAgICAgICB0aGlzLmlkICs9IHNlcGFyYXRvciArIGl0ZW07XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEJ1aWxkIHRoZSB2YXJcbiAgICAgICAgdGhpcy52YXIgPSB0aGlzLnZhclsgaXRlbSBdO1xuICAgIH1cbn07XG5cbkFic3RyYWN0QWN0aW9uLnByb3RvdHlwZS5zZWFyY2ggPSBmdW5jdGlvbiggbGlzdCwgZXhwcmVzc2lvbkVsZW1lbnQgKXtcbiAgICBcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsaXN0Lmxlbmd0aDsgKytpICl7XG4gICAgICAgIHZhciByZWNvcmQgPSBsaXN0WyBpIF07XG4gICAgICAgIGlmICggQWJzdHJhY3RBY3Rpb24uZWxlbWVudE1hY2hlcyggcmVjb3JkLCBleHByZXNzaW9uRWxlbWVudCApICl7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0aHJvdyAnTm8gcmVjb3JkIGZvdW5kIG1hdGNoaW5nIHlvdXIgY3JpdGVyaWEhJztcbn07XG5cbkFic3RyYWN0QWN0aW9uLmVsZW1lbnRNYWNoZXMgPSBmdW5jdGlvbiggZWxlbWVudCwgZXhwcmVzc2lvbkVsZW1lbnQgKXtcbiAgICBcbiAgICBpZiAoIGV4cHJlc3Npb25FbGVtZW50ID09IHVuZGVmaW5lZCApe1xuICAgICAgICB0aHJvdyAnRXhwcmVzc2lvbiB0byBtYXRjaCBtdXN0IG5vdCBiZSBudWxsISc7XG4gICAgfVxuXG4gICAgaWYgKCBBcnJheS5pc0FycmF5KCBleHByZXNzaW9uRWxlbWVudCApICl7XG4gICAgICAgIHRocm93ICdFeHByZXNzaW9uICcgKyB1dGlscy5nZW5lcmljVG9TdHJpbmcoIGV4cHJlc3Npb25FbGVtZW50ICkgKyAnIHRvIG1hdGNoIG11c3Qgbm90IGJlIGFuIGFycmF5ISc7XG4gICAgfVxuXG4gICAgaWYgKCB1dGlscy5pc1BsYWluT2JqZWN0KCBleHByZXNzaW9uRWxlbWVudCApICl7XG4gICAgICAgIGZvciAoIHZhciBpIGluIGV4cHJlc3Npb25FbGVtZW50ICl7XG4gICAgICAgICAgICBpZiAoIGV4cHJlc3Npb25FbGVtZW50WyBpIF0gIT09IGVsZW1lbnRbIGkgXSApe1xuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG5cbiAgICAvLyBNdXN0IGJlIG51bWVyaWMgb3Igc3RyaW5nXG4gICAgcmV0dXJuIGVsZW1lbnQgPT09IGV4cHJlc3Npb25FbGVtZW50O1xufTtcblxuQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlLmdldFZhbHVlID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcbiAgICByZXR1cm4gdGhpcy52YXIgPT09IHVuZGVmaW5lZD9cbiAgICAgICAgZGljdGlvbmFyeVsgdGhpcy5pZCBdOlxuICAgICAgICB0aGlzLnZhcjtcbn07XG5cbkFic3RyYWN0QWN0aW9uLnByb3RvdHlwZS5yZXNvbHZlVGhpc05vZGUgPSBmdW5jdGlvbiggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyICl7XG4gICAgXG4gICAgLy92YXIgYXR0cmlidXRlSW5zdGFuY2UgPSBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2U7XG4gICAgdmFyIG5vZGUgPSBwYXJzZXJVcGRhdGVyLmZpbmROb2RlQnlJZCggaW5kZXhJdGVtLm5vZGVJZCApO1xuICAgIGlmICggISBub2RlICl7XG4gICAgICAgIC8vIFJlbW92ZWQgbm9kZSFcbiAgICAgICAgcGFyc2VyVXBkYXRlci5hZGRSZW1vdmVkVG9TdGF0aXN0aWNzKCk7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcGFyc2VyVXBkYXRlci5hZGRVcGRhdGVkVG9TdGF0aXN0aWNzKCk7XG4gICAgXG4gICAgLy8gUmV0dXJuIHRoZSBub2RlXG4gICAgcmV0dXJuIG5vZGU7XG59O1xuXG5BYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUuYXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQgPSBmdW5jdGlvbiggYXR0cmlidXRlSW5zdGFuY2UgKXtcbiAgICB0aHJvdyAnRXJyb3I6IGF0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkIG11c3QgYmUgaW1wbGVtZW50ZWQhJztcbn07XG5cbkFic3RyYWN0QWN0aW9uLnByb3RvdHlwZS51cGRhdGVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oKXtcbiAgICB0aHJvdyAnRXJyb3I6IHVwZGF0ZURpY3Rpb25hcnkgbXVzdCBiZSBpbXBsZW1lbnRlZCEnO1xufTtcblxuQWJzdHJhY3RBY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUhUTUwgPSBmdW5jdGlvbigpe1xuICAgIHRocm93ICdFcnJvcjogdXBkYXRlSFRNTCBtdXN0IGJlIGltcGxlbWVudGVkISc7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFic3RyYWN0QWN0aW9uO1xuIiwiLyogXG4gICAgQ2xhc3MgQWJzdHJhY3RBcnJheUFjdGlvblxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQWJzdHJhY3RBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdEFjdGlvbi5qcycgKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi8uLi91dGlscy5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uLy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBBYnN0cmFjdEFycmF5QWN0aW9uID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcbiAgICBBYnN0cmFjdEFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICB0aGlzLmluZGV4ID0gb2JqZWN0LmluZGV4O1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBBYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUgKTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5nZXRJbmRleE51bWVyaWNWYWx1ZSA9IGZ1bmN0aW9uKCBpbmRleCApe1xuICAgIFxuICAgIGlmICggaW5kZXggPT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkOyAgIFxuICAgIH1cbiAgICBcbiAgICBpZiAoIGluZGV4ID09PSBjb250ZXh0LmdldENvbmYoKS5maXJzdEluZGV4SWRlbnRpZmllciApe1xuICAgICAgICByZXR1cm4gMDtcbiAgICB9IGVsc2UgaWYgKCBpbmRleCA9PT0gY29udGV4dC5nZXRDb25mKCkubGFzdEluZGV4SWRlbnRpZmllciApe1xuICAgICAgICByZXR1cm4gLTE7IC8vIFRoaXMgbWVhbnMgaXQgaXMgdGhlIGxhc3RcbiAgICB9XG4gICAgcmV0dXJuIGluZGV4O1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUuZ2V0SW5kZXhOdW1lcmljVmFsdWUgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBBYnN0cmFjdEFycmF5QWN0aW9uLmdldEluZGV4TnVtZXJpY1ZhbHVlKCB0aGlzLmluZGV4ICk7XG59O1xuXG5BYnN0cmFjdEFycmF5QWN0aW9uLnByb3RvdHlwZS5nZXRJbmRleFRvVXNlID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcblxuICAgIGlmICggdGhpcy5pbmRleCA9PT0gdW5kZWZpbmVkICYmIHRoaXMuY3VycmVudEVsZW1lbnQgPT09IHVuZGVmaW5lZCApe1xuICAgICAgICB0aHJvdyAnaW5kZXggb3IgY3VycmVudEVsZW1lbnQgbXVzdCBiZSBkZWZpbmVkIGluICcgKyB0aGlzLmlkICsgJyBhcnJheSBhY3Rpb24hJztcbiAgICB9XG4gICAgXG4gICAgLy8gQ2hlY2sgaWYgaXQgdXNlcyB0aGUgaW5kZXhcbiAgICB2YXIgaW5kZXhOdW1lcmljVmFsdWUgPSB0aGlzLmdldEluZGV4TnVtZXJpY1ZhbHVlKCk7XG4gICAgaWYgKCBpbmRleE51bWVyaWNWYWx1ZSAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHJldHVybiBpbmRleE51bWVyaWNWYWx1ZTtcbiAgICB9XG5cbiAgICAvLyBNdXN0IHVzZSBjdXJyZW50RWxlbWVudFxuICAgIHZhciBhcnJheVZhbHVlID0gdGhpcy5nZXRWYWx1ZSggZGljdGlvbmFyeSApO1xuICAgIFxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGFycmF5VmFsdWUubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdmFyIGVsZW1lbnQgPSBhcnJheVZhbHVlWyBpIF07XG4gICAgICAgIGlmICggQWJzdHJhY3RBY3Rpb24uZWxlbWVudE1hY2hlcyggZWxlbWVudCwgdGhpcy5jdXJyZW50RWxlbWVudCApICl7XG4gICAgICAgICAgICByZXR1cm4gaTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICB0aHJvdyAnY3VycmVudEVsZW1lbnQgJyArIHV0aWxzLmdlbmVyaWNUb1N0cmluZyggdGhpcy5jdXJyZW50RWxlbWVudCApICsgJyBub3QgZm91bmQgaW4gJyArIHRoaXMuaWQgKyAnIGFycmF5IGFjdGlvbiEnO1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUuYXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQgPSBmdW5jdGlvbiggYXR0cmlidXRlSW5zdGFuY2UgKXtcbiAgICByZXR1cm4gQWJzdHJhY3RBcnJheUFjdGlvbi5zdGF0aWNBdHRyaWJ1dGVJbnN0YW5jZUlzUmVsYXRlZCggYXR0cmlidXRlSW5zdGFuY2UgKTtcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24uc3RhdGljQXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQgPSBmdW5jdGlvbiggYXR0cmlidXRlSW5zdGFuY2UgKXtcbiAgICByZXR1cm4gYXR0cmlidXRlSW5zdGFuY2UudHlwZSA9PT0gJ3RhbDpyZXBlYXQnO1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCl7XG4gICAgdGhyb3cgJ0Vycm9yOiB1cGRhdGVEaWN0aW9uYXJ5IG11c3QgYmUgaW1wbGVtZW50ZWQhJztcbn07XG5cbkFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlLnVwZGF0ZUhUTUwgPSBmdW5jdGlvbigpe1xuICAgIHRocm93ICdFcnJvcjogdXBkYXRlSFRNTCBtdXN0IGJlIGltcGxlbWVudGVkISc7XG59O1xuXG5BYnN0cmFjdEFycmF5QWN0aW9uLnByb3RvdHlwZS5yZXNvbHZlQ2hpbGROb2RlID0gZnVuY3Rpb24oIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciApe1xuICAgIFxuICAgIC8vdmFyIGF0dHJpYnV0ZUluc3RhbmNlID0gaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlO1xuICAgIHZhciBub2RlID0gcGFyc2VyVXBkYXRlci5maW5kTm9kZUJ5SWQoIGluZGV4SXRlbS5ub2RlSWQgKTtcbiAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICAvLyBSZW1vdmVkIG5vZGUhXG4gICAgICAgIHBhcnNlclVwZGF0ZXIuYWRkUmVtb3ZlZFRvU3RhdGlzdGljcygpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHBhcnNlclVwZGF0ZXIuYWRkVXBkYXRlZFRvU3RhdGlzdGljcygpO1xuICAgIFxuICAgIC8vIFJldHVybiB0aGUgbm9kZVxuICAgIHJldHVybiB0aGlzLmluZGV4VG9Vc2UgPT09IC0xP1xuICAgICAgICBudWxsOlxuICAgICAgICB0aGlzLmdldEluZGV4T2ZMb29wKCBub2RlLnBhcmVudE5vZGUsIGluZGV4SXRlbS5ub2RlSWQsIHRoaXMuaW5kZXhUb1VzZSApO1xufTtcblxuQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUuZ2V0SW5kZXhPZkxvb3AgPSBmdW5jdGlvbiggcGFyZW50Tm9kZSwgbm9kZUlkLCBpbmRleEluTG9vcCApe1xuICAgIFxuICAgIHZhciBudW1iZXJPZkNoaWxkcmVuID0gcGFyZW50Tm9kZS5jaGlsZEVsZW1lbnRDb3VudDtcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBudW1iZXJPZkNoaWxkcmVuOyArK2kgKXtcbiAgICAgICAgdmFyIGNoaWxkTm9kZSA9IHBhcmVudE5vZGUuY2hpbGRyZW5bIGkgXTtcbiAgICAgICAgdmFyIGN1cnJlbnROb2RlSWQgPSBjaGlsZE5vZGUuZ2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5pZCApO1xuICAgICAgICBpZiAoIGN1cnJlbnROb2RlSWQgPT09IG5vZGVJZCApe1xuICAgICAgICAgICAgcmV0dXJuIHBhcmVudE5vZGUuY2hpbGRyZW5bIDEgKyBpICsgaW5kZXhJbkxvb3AgXTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gbnVsbDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQWJzdHJhY3RBcnJheUFjdGlvbjtcbiIsIi8qIFxuICAgIENsYXNzIEFic3RyYWN0T2JqZWN0QWN0aW9uXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBBYnN0cmFjdEFjdGlvbiA9IHJlcXVpcmUoICcuL2Fic3RyYWN0QWN0aW9uLmpzJyApO1xuXG52YXIgQWJzdHJhY3RPYmplY3RBY3Rpb24gPSBmdW5jdGlvbiggb2JqZWN0LCBkaWN0aW9uYXJ5ICkge1xuICAgIEFic3RyYWN0QWN0aW9uLmNhbGwoIHRoaXMsIG9iamVjdCwgZGljdGlvbmFyeSApO1xuICAgIFxuICAgIHRoaXMucHJvcGVydHkgPSBvYmplY3QucHJvcGVydHk7XG4gICAgdGhpcy5pZCArPSAnLicgKyBvYmplY3QucHJvcGVydHk7XG59O1xuXG5BYnN0cmFjdE9iamVjdEFjdGlvbi5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBBYnN0cmFjdEFjdGlvbi5wcm90b3R5cGUgKTtcblxuQWJzdHJhY3RPYmplY3RBY3Rpb24ucHJvdG90eXBlLmF0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkID0gZnVuY3Rpb24oIGF0dHJpYnV0ZUluc3RhbmNlICl7XG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5BYnN0cmFjdE9iamVjdEFjdGlvbi5wcm90b3R5cGUudXBkYXRlSFRNTCA9IGZ1bmN0aW9uKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIsIGFjdGlvbkluc3RhbmNlICl7XG4gICAgXG4gICAgLy8gTXVzdCBnZXQgdGhlIG5vZGVcbiAgICB2YXIgbm9kZSA9IHRoaXMucmVzb2x2ZVRoaXNOb2RlKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIgKTtcbiAgICBpZiAoICEgbm9kZSApe1xuICAgICAgICB0aHJvdyAnTm8gbm9kZSBmb3VuZCB0byB1cGRhdGUnO1xuICAgIH1cbiAgICBcbiAgICAvLyBVcGRhdGUgdGhlIHNlbGVjdGVkIG5vZGVcbiAgICBwYXJzZXJVcGRhdGVyLnVwZGF0ZU5vZGUoIG5vZGUgKTtcbiAgICBcbiAgICAvLyBSdW4gYW5pbWF0aW9uXG4gICAgcGFyc2VyVXBkYXRlci5ydW5BbmltYXRpb24oIGFjdGlvbkluc3RhbmNlLCBub2RlICk7XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFic3RyYWN0T2JqZWN0QWN0aW9uO1xuIiwiLyogXG4gICAgQ2xhc3MgQXJyYXlDcmVhdGVcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0QXJyYXlBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdEFycmF5QWN0aW9uLmpzJyApO1xudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vLi4vY29udGV4dC5qcycgKTtcbnZhciBQYXJzZXJOb2RlUmVuZGVyZXIgPSByZXF1aXJlKCAnLi4vLi4vcGFyc2Vycy9wYXJzZXJOb2RlUmVuZGVyZXIuanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vdXRpbHMuanMnICk7XG5cbnZhciBBcnJheUNyZWF0ZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RBcnJheUFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICB0aGlzLm5ld0VsZW1lbnQgPSBvYmplY3QubmV3RWxlbWVudDtcbn07XG5cbkFycmF5Q3JlYXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlICk7XG5cbkFycmF5Q3JlYXRlLnByb3RvdHlwZS51cGRhdGVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcbiAgICBcbiAgICB0aGlzLmluZGV4VG9Vc2UgPSB0aGlzLmdldEluZGV4VG9Vc2UoIGRpY3Rpb25hcnkgKTtcbiAgICB2YXIgYXJyYXlWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICBpZiAoIHRoaXMuaW5kZXhUb1VzZSA9PT0gLTEgKXtcbiAgICAgICAgdGhpcy5yZXNvbHZlZEluZGV4ID0gYXJyYXlWYWx1ZS5sZW5ndGg7XG4gICAgICAgIGFycmF5VmFsdWUucHVzaCggdGhpcy5uZXdFbGVtZW50ICk7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5yZXNvbHZlZEluZGV4ID0gdGhpcy5pbmRleFRvVXNlO1xuICAgICAgICBhcnJheVZhbHVlLnNwbGljZSggdGhpcy5pbmRleFRvVXNlLCAwLCB0aGlzLm5ld0VsZW1lbnQgKTtcbiAgICB9XG59O1xuXG5BcnJheUNyZWF0ZS5wcm90b3R5cGUudXBkYXRlSFRNTCA9IGZ1bmN0aW9uKCBpbmRleEl0ZW0sIHBhcnNlclVwZGF0ZXIsIGFjdGlvbkluc3RhbmNlICl7XG4gICAgXG4gICAgLy8gTXVzdCBnZXQgdGhlIG5vZGVUb1VwZGF0ZVxuICAgIHZhciBub2RlID0gdGhpcy5yZXNvbHZlVGhpc05vZGUoIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciApO1xuICAgIGlmICggISBub2RlICl7XG4gICAgICAgIHRocm93ICdObyBub2RlIGZvdW5kIHRvIGNsb25lJztcbiAgICB9XG4gICAgXG4gICAgLy8gSW5pdCBzb21lIHZhcnNcbiAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xuICAgIHZhciBwYXJlbnROb2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgIFxuICAgIC8vIENsb25lIGFuZCBjb25maWd1cmUgdGhlIG5vZGVcbiAgICB2YXIgdG1wTm9kZSA9IFBhcnNlck5vZGVSZW5kZXJlci5jbG9uZUFuZENvbmZpZ3VyZU5vZGUoIFxuICAgICAgICBub2RlLCBcbiAgICAgICAgdHJ1ZSwgXG4gICAgICAgIHRhZ3MsIFxuICAgICAgICBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5pZCApIFxuICAgICk7XG4gICAgUGFyc2VyTm9kZVJlbmRlcmVyLmNvbmZpZ3VyZU5vZGVGb3JOZXdJdGVtKCBcbiAgICAgICAgdG1wTm9kZSwgXG4gICAgICAgIHRhZ3MsIFxuICAgICAgICBwYXJlbnROb2RlLCBcbiAgICAgICAgaW5kZXhJdGVtLCBcbiAgICAgICAgdGhpcy5yZXNvbHZlZEluZGV4XG4gICAgKTtcbiAgICBcbiAgICAvLyBJbnNlcnQgaXRcbiAgICB2YXIgc2libGluZyA9IHRoaXMuaW5kZXhUb1VzZSA9PT0gLTE/XG4gICAgICAgIG51bGw6XG4gICAgICAgIHBhcmVudE5vZGUuY2hpbGRyZW5bIDEgKyB0aGlzLmluZGV4VG9Vc2UgXTtcbiAgICBwYXJlbnROb2RlLmluc2VydEJlZm9yZSggdG1wTm9kZSwgc2libGluZyApO1xuICAgIFxuICAgIC8vIFVwZGF0ZSB0aGUgc2VsZWN0ZWQgbm9kZVxuICAgIHBhcnNlclVwZGF0ZXIudXBkYXRlTm9kZSggdG1wTm9kZSApO1xuICAgIFxuICAgIC8vIFJ1biBhbmltYXRpb25cbiAgICBwYXJzZXJVcGRhdGVyLnJ1bkFuaW1hdGlvbiggYWN0aW9uSW5zdGFuY2UsIHRtcE5vZGUgKTtcbiAgICBcbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5cbkFycmF5Q3JlYXRlLmJ1aWxkTXVsdGlwbGUgPSBmdW5jdGlvbiggb2JqZWN0LCBkaWN0aW9uYXJ5ICl7XG5cbiAgICB2YXIgYWN0aW9ucyA9IFtdO1xuICAgIFxuICAgIC8vIENvcHkgbmV3RWxlbWVudHMgdG8gYSBuZXcgYXJyYXlcbiAgICB2YXIgbmV3RWxlbWVudHMgPSB1dGlscy5jb3B5QXJyYXkoIG9iamVjdC5uZXdFbGVtZW50ICk7XG4gICAgXG4gICAgLy8gQ29uZmlndXJlIHRoZSBvYmplY3QsIGNyZWF0ZSB0aGUgZmlyc3QgaW5zdGFuY2UgYW5kIGFkZCBpdCB0byB0aGUgbGlzdFxuICAgIG9iamVjdC5uZXdFbGVtZW50ID0gbmV3RWxlbWVudHNbIDAgXTtcbiAgICB2YXIgZmlyc3RBY3Rpb25JbnN0YW5jZSA9IG5ldyBBcnJheUNyZWF0ZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgYWN0aW9ucy5wdXNoKCBmaXJzdEFjdGlvbkluc3RhbmNlICk7XG4gICAgXG4gICAgLy8gR2V0IHRoZSBmaXJzdEluZGV4IGFuZCBpZiB0aGUgbmV3IGVsbWVudHMgbXVzdCBiZSB0aGUgbGFzdFxuICAgIHZhciBmaXJzdEluZGV4ID0gZmlyc3RBY3Rpb25JbnN0YW5jZS5nZXRJbmRleE51bWVyaWNWYWx1ZSgpO1xuICAgIHZhciBpc0xhc3QgPSAtMSA9PT0gZmlyc3RJbmRleDtcbiAgICAgICAgXG4gICAgLy8gQnVpbGQgYWN0aW9ucyBsaXN0XG4gICAgZm9yICggdmFyIGkgPSAxOyBpIDwgbmV3RWxlbWVudHMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdmFyIG5ld0VsZW1lbnQgPSBuZXdFbGVtZW50c1sgaSBdO1xuICAgICAgICBcbiAgICAgICAgLy8gQ2xvbmUgdGhlIG9iamVjdCBhbmQgY29uZmlndXJlIHRoZSBuZXdFbGVtZW50IGFuZCB0aGUgaW5kZXhcbiAgICAgICAgdmFyIG5ld09iamVjdCA9IHV0aWxzLmRlZXBFeHRlbmQoIG9iamVjdCApO1xuICAgICAgICBuZXdPYmplY3QubmV3RWxlbWVudCA9IG5ld0VsZW1lbnQ7XG4gICAgICAgIG5ld09iamVjdC5pbmRleCA9IGlzTGFzdD9cbiAgICAgICAgICAgIC0xOlxuICAgICAgICAgICAgZmlyc3RJbmRleCArIGk7XG4gICAgICAgIFxuICAgICAgICAvLyBJbnN0YW5jZSB0aGUgYWN0aW9uIGluc3RhbmNlIGFuZCBhZGQgaXQgdG8gdGhlIGxpc3RcbiAgICAgICAgdmFyIG5ld0FjdGlvbkluc3RhbmNlID0gbmV3IEFycmF5Q3JlYXRlKCBuZXdPYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICAgICAgYWN0aW9ucy5wdXNoKCBuZXdBY3Rpb25JbnN0YW5jZSApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gYWN0aW9ucztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXlDcmVhdGU7XG4iLCIvKiBcbiAgICBDbGFzcyBBcnJheURlbGV0ZVxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQWJzdHJhY3RBcnJheUFjdGlvbiA9IHJlcXVpcmUoICcuL2Fic3RyYWN0QXJyYXlBY3Rpb24uanMnICk7XG52YXIgdXRpbHMgPSByZXF1aXJlKCAnLi4vLi4vdXRpbHMuanMnICk7XG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vLi4vYXR0cmlidXRlcy9hdHRyaWJ1dGVJbmRleC5qcycgKTtcbnZhciBub2RlUmVtb3ZlciA9IHJlcXVpcmUoICcuLi9ub2RlUmVtb3Zlci5qcycgKTtcblxudmFyIEFycmF5RGVsZXRlID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcbiAgICBBYnN0cmFjdEFycmF5QWN0aW9uLmNhbGwoIHRoaXMsIG9iamVjdCwgZGljdGlvbmFyeSApO1xufTtcblxuQXJyYXlEZWxldGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQWJzdHJhY3RBcnJheUFjdGlvbi5wcm90b3R5cGUgKTtcblxuQXJyYXlEZWxldGUucHJvdG90eXBlLnVwZGF0ZURpY3Rpb25hcnkgPSBmdW5jdGlvbiggZGljdGlvbmFyeSApe1xuXG4gICAgdGhpcy5pbmRleFRvVXNlID0gdGhpcy5nZXRJbmRleFRvVXNlKCBkaWN0aW9uYXJ5ICk7XG4gICAgdmFyIGFycmF5VmFsdWUgPSB0aGlzLmdldFZhbHVlKCBkaWN0aW9uYXJ5ICk7XG4gICAgYXJyYXlWYWx1ZS5zcGxpY2UoIHRoaXMuaW5kZXhUb1VzZSwgMSApO1xufTtcblxuQXJyYXlEZWxldGUucHJvdG90eXBlLnVwZGF0ZUhUTUwgPSBmdW5jdGlvbiggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyLCBhY3Rpb25JbnN0YW5jZSwgY29udGludWVEYXRhICl7XG4gICAgXG4gICAgLy8gTXVzdCBnZXQgdGhlIG5vZGVUb1VwZGF0ZVxuICAgIHZhciBub2RlVG9EZWxldGUgPSB0aGlzLnJlc29sdmVDaGlsZE5vZGUoIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciApO1xuICAgIGlmICggISBub2RlVG9EZWxldGUgKXtcbiAgICAgICAgdGhyb3cgJ05vIG5vZGUgZm91bmQgdG8gYmUgZGVsZXRlZCBhdCB0aGlzIGluZGV4OiAnICsgdGhpcy5pbmRleFRvVXNlO1xuICAgIH1cbiAgICBcbiAgICAvLyBSdW4gYW5pbWF0aW9uXG4gICAgcGFyc2VyVXBkYXRlci5ydW5BbmltYXRpb24oIFxuICAgICAgICBhY3Rpb25JbnN0YW5jZSwgXG4gICAgICAgIG5vZGVUb0RlbGV0ZSwgXG4gICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIC8vIFJlbW92ZSB0aGUgc2VsZWN0ZWQgbm9kZSBmcm9tIHRoZSBpbmRleCBhbmQgZnJvbSBIVE1MXG4gICAgICAgICAgICAvL2F0dHJpYnV0ZUluZGV4LnJlbW92ZU5vZGUoIG5vZGVUb0RlbGV0ZSApOyBcbiAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZU5vZGUoIG5vZGVUb0RlbGV0ZSApO1xuICAgICAgICAgICAgLy9UT0RPIHVwZGF0ZSBuZXh0IHNpYmxpbmdzP1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBDb250aW51ZVxuICAgICAgICAgICAgcGFyc2VyVXBkYXRlci5jb250aW51ZVVwZGF0ZUhUTUwoIGNvbnRpbnVlRGF0YSApO1xuICAgICAgICB9IFxuICAgICk7XG4gICAgXG4gICAgLy9yZXR1cm4gdHJ1ZTtcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5BcnJheURlbGV0ZS5idWlsZE11bHRpcGxlID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApe1xuXG4gICAgdmFyIGFjdGlvbnMgPSBbXTtcbiAgICB2YXIgcHJvcGVydHkgPSBvYmplY3QuaW5kZXg/ICdpbmRleCc6ICdjdXJyZW50RWxlbWVudCc7XG5cbiAgICAvLyBDb3B5IGluZGV4ZXMgdG8gYSBuZXcgYXJyYXlcbiAgICB2YXIgYWxsSXRlbXMgPSB1dGlscy5jb3B5QXJyYXkoIG9iamVjdFsgcHJvcGVydHkgXSApO1xuICAgIFxuICAgIC8vIEJ1aWxkIGFjdGlvbnMgbGlzdFxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGFsbEl0ZW1zLmxlbmd0aDsgKytpICl7XG4gICAgICAgIHZhciBpdGVtID0gYWxsSXRlbXNbIGkgXTtcbiAgICAgICAgXG4gICAgICAgIC8vIENsb25lIHRoZSBvYmplY3QgYW5kIGNvbmZpZ3VyZSB0aGUgaW5kZXhcbiAgICAgICAgdmFyIG5ld09iamVjdCA9IHV0aWxzLmRlZXBFeHRlbmQoIG9iamVjdCApO1xuICAgICAgICBuZXdPYmplY3RbIHByb3BlcnR5IF0gPSBpdGVtO1xuICAgICAgICBcbiAgICAgICAgLy8gSW5zdGFuY2UgdGhlIGFjdGlvbiBpbnN0YW5jZSBhbmQgYWRkIGl0IHRvIHRoZSBsaXN0XG4gICAgICAgIHZhciBuZXdBY3Rpb25JbnN0YW5jZSA9IG5ldyBBcnJheURlbGV0ZSggbmV3T2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgICAgIG5ld0FjdGlvbkluc3RhbmNlLmluZGV4ID0gbmV3QWN0aW9uSW5zdGFuY2UuZ2V0SW5kZXhUb1VzZSggZGljdGlvbmFyeSApO1xuICAgICAgICBhY3Rpb25zLnB1c2goIG5ld0FjdGlvbkluc3RhbmNlICk7XG4gICAgfVxuICAgIFxuICAgIC8vIFNvcnQgYWN0aW9uc1xuICAgIGFjdGlvbnMuc29ydChcbiAgICAgICAgZnVuY3Rpb24oIGEsIGIgKXsgcmV0dXJuIGIuaW5kZXggLSBhLmluZGV4OyB9XG4gICAgKTtcbiAgICBcbiAgICByZXR1cm4gYWN0aW9ucztcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gQXJyYXlEZWxldGU7XG4iLCIvKiBcbiAgICBDbGFzcyBBcnJheVVwZGF0ZVxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQWJzdHJhY3RBcnJheUFjdGlvbiA9IHJlcXVpcmUoICcuL2Fic3RyYWN0QXJyYXlBY3Rpb24uanMnICk7XG5cbnZhciBBcnJheVVwZGF0ZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RBcnJheUFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICB0aGlzLm5ld0VsZW1lbnQgPSBvYmplY3QubmV3RWxlbWVudDtcbn07XG5cbkFycmF5VXBkYXRlLnByb3RvdHlwZSA9IE9iamVjdC5jcmVhdGUoIEFic3RyYWN0QXJyYXlBY3Rpb24ucHJvdG90eXBlICk7XG5cbkFycmF5VXBkYXRlLnByb3RvdHlwZS51cGRhdGVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcbiAgICBcbiAgICB0aGlzLmluZGV4VG9Vc2UgPSB0aGlzLmdldEluZGV4VG9Vc2UoIGRpY3Rpb25hcnkgKTtcbiAgICB2YXIgYXJyYXlWYWx1ZSA9IHRoaXMuZ2V0VmFsdWUoIGRpY3Rpb25hcnkgKTtcbiAgICBhcnJheVZhbHVlWyB0aGlzLmluZGV4VG9Vc2UgXSA9IHRoaXMubmV3RWxlbWVudDtcbn07XG5cbkFycmF5VXBkYXRlLnByb3RvdHlwZS51cGRhdGVIVE1MID0gZnVuY3Rpb24oIGluZGV4SXRlbSwgcGFyc2VyVXBkYXRlciwgYWN0aW9uSW5zdGFuY2UgKXtcbiAgICBcbiAgICAvLyBNdXN0IGdldCB0aGUgbm9kZVRvVXBkYXRlXG4gICAgdmFyIG5vZGVUb1VwZGF0ZSA9IHRoaXMucmVzb2x2ZUNoaWxkTm9kZSggaW5kZXhJdGVtLCBwYXJzZXJVcGRhdGVyICk7XG4gICAgaWYgKCAhIG5vZGVUb1VwZGF0ZSApe1xuICAgICAgICB0aHJvdyAnTm8gbm9kZSBmb3VuZCB0byBiZSB1cGRhdGVkIGF0IHRoaXMgaW5kZXg6ICcgKyB0aGlzLmluZGV4VG9Vc2U7XG4gICAgfVxuICAgIFxuICAgIC8vIFVwZGF0ZSB0aGUgc2VsZWN0ZWQgbm9kZVxuICAgIHBhcnNlclVwZGF0ZXIudXBkYXRlTm9kZSggbm9kZVRvVXBkYXRlLCB0cnVlICk7XG4gICAgXG4gICAgLy8gUnVuIGFuaW1hdGlvblxuICAgIHBhcnNlclVwZGF0ZXIucnVuQW5pbWF0aW9uKCBhY3Rpb25JbnN0YW5jZSwgbm9kZVRvVXBkYXRlICk7XG4gICAgXG4gICAgcmV0dXJuIHRydWU7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IEFycmF5VXBkYXRlO1xuIiwiLyogXHJcbiAgICBDbGFzcyBDU1NBbmltYXRpb25NYW5hZ2VyIFxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xyXG4gICAgXHJcbiAgICB2YXIgYW5pbWF0ZSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5QWN0aW9uLCBub2RlLCBjYWxsYmFjayApIHtcclxuICAgICAgICBcclxuICAgICAgICAvLyBSdW4gY2FsbGJhY2sgYW5kIHJldHVybiBpZiB0aGVyZSBpcyBubyBhbmltYXRpb25cclxuICAgICAgICBpZiAoICEgZGljdGlvbmFyeUFjdGlvbi5hbmltYXRpb24gKXtcclxuICAgICAgICAgICAgaWYgKCBjYWxsYmFjayApe1xyXG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBTZXQgdGhlIGFuaW1hdGlvblxyXG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gJ25vbmUnO1xyXG4gICAgICAgIHNldFRpbWVvdXQoXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgLy8gU2V0IHRoZSBhbmltYXRpb25lbmQgbGlzdGVuZXJcclxuICAgICAgICAgICAgICAgIHZhciBhbmltYXRpb25lbmRDYWxsYmFjayA9IGZ1bmN0aW9uKCBldmVudCApe1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICggY2FsbGJhY2sgKXtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICAgICAgLy9ub2RlLnJlbW92ZUV2ZW50TGlzdGVuZXIoICdhbmltYXRpb25lbmQnLCBhbmltYXRpb25lbmRDYWxsYmFjayApO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5hZGRFdmVudExpc3RlbmVyKCAnYW5pbWF0aW9uZW5kJywgYW5pbWF0aW9uZW5kQ2FsbGJhY2sgKTtcclxuXHJcbiAgICAgICAgICAgICAgICAvLyBTZXQgdGhlIGFuaW1hdGlvblxyXG4gICAgICAgICAgICAgICAgbm9kZS5zdHlsZS5hbmltYXRpb24gPSBkaWN0aW9uYXJ5QWN0aW9uLmFuaW1hdGlvbjtcclxuICAgICAgICAgICAgfSwgXHJcbiAgICAgICAgICAgIDEwXHJcbiAgICAgICAgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciByZXNldCA9IGZ1bmN0aW9uKCBub2RlICkge1xyXG4gICAgICAgIG5vZGUuc3R5bGUuYW5pbWF0aW9uID0gJ25vbmUnO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHNlbGYgPSB7XHJcbiAgICAgICAgYW5pbWF0ZTogYW5pbWF0ZSxcclxuICAgICAgICByZXNldDogcmVzZXRcclxuICAgIH07XHJcbiAgICBcclxuICAgIHJldHVybiBzZWxmO1xyXG59KSgpO1xyXG4iLCIvKiBcclxuICAgIENsYXNzIGRpY3Rpb25hcnlBY3Rpb25CdWlsZGVyIFxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBBcnJheVVwZGF0ZSA9IHJlcXVpcmUoICcuL2FycmF5VXBkYXRlLmpzJyApO1xyXG52YXIgQXJyYXlEZWxldGUgPSByZXF1aXJlKCAnLi9hcnJheURlbGV0ZS5qcycgKTtcclxudmFyIEFycmF5Q3JlYXRlID0gcmVxdWlyZSggJy4vYXJyYXlDcmVhdGUuanMnICk7XHJcbnZhciBPYmplY3RVcGRhdGUgPSByZXF1aXJlKCAnLi9vYmplY3RVcGRhdGUuanMnICk7XHJcbnZhciBPYmplY3REZWxldGUgPSByZXF1aXJlKCAnLi9vYmplY3REZWxldGUuanMnICk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgdmFyIGJ1aWxkID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcclxuICAgICAgICBcclxuICAgICAgICBzd2l0Y2ggKCBvYmplY3QuYWN0aW9uICkge1xyXG4gICAgICAgIGNhc2UgJ3VwZGF0ZUFycmF5JzpcclxuICAgICAgICAgICAgcmV0dXJuIG5ldyBBcnJheVVwZGF0ZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XHJcbiAgICAgICAgY2FzZSAnZGVsZXRlQXJyYXknOlxyXG4gICAgICAgICAgICByZXR1cm4gQXJyYXkuaXNBcnJheSggb2JqZWN0LmluZGV4ICkgfHwgQXJyYXkuaXNBcnJheSggb2JqZWN0LmN1cnJlbnRFbGVtZW50ICk/IFxyXG4gICAgICAgICAgICAgICAgQXJyYXlEZWxldGUuYnVpbGRNdWx0aXBsZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk6XHJcbiAgICAgICAgICAgICAgICBuZXcgQXJyYXlEZWxldGUoIG9iamVjdCwgZGljdGlvbmFyeSApO1xyXG4gICAgICAgIGNhc2UgJ2NyZWF0ZUFycmF5JzpcclxuICAgICAgICAgICAgcmV0dXJuIEFycmF5LmlzQXJyYXkoIG9iamVjdC5uZXdFbGVtZW50ICk/IFxyXG4gICAgICAgICAgICAgICAgQXJyYXlDcmVhdGUuYnVpbGRNdWx0aXBsZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk6XHJcbiAgICAgICAgICAgICAgICBuZXcgQXJyYXlDcmVhdGUoIG9iamVjdCwgZGljdGlvbmFyeSApO1xyXG4gICAgICAgIGNhc2UgJ3VwZGF0ZU9iamVjdCc6XHJcbiAgICAgICAgICAgIHJldHVybiBvYmplY3QuZWRpdGVkUHJvcGVydGllcyB8fCBvYmplY3QuZGVsZXRlZFByb3BlcnRpZXM/XHJcbiAgICAgICAgICAgICAgICBPYmplY3RVcGRhdGUuYnVpbGRNdWx0aXBsZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk6XHJcbiAgICAgICAgICAgICAgICBuZXcgT2JqZWN0VXBkYXRlKCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcclxuICAgICAgICBjYXNlICdkZWxldGVPYmplY3QnOlxyXG4gICAgICAgICAgICByZXR1cm4gbmV3IE9iamVjdERlbGV0ZSggb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XHJcbiAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgdGhyb3cgJ1Vua25vd24gZGljdGlvbmFyeSBhY3Rpb246ICcgKyBvYmplY3QuYWN0aW9uO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIGJ1aWxkOiBidWlsZFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgcmV0dXJuIHNlbGY7XHJcbn0pKCk7XHJcbiIsIi8qIFxuICAgIENsYXNzIE9iamVjdERlbGV0ZVxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgQWJzdHJhY3RPYmplY3RBY3Rpb24gPSByZXF1aXJlKCAnLi9hYnN0cmFjdE9iamVjdEFjdGlvbi5qcycgKTtcblxudmFyIE9iamVjdERlbGV0ZSA9IGZ1bmN0aW9uKCBvYmplY3QsIGRpY3Rpb25hcnkgKSB7XG4gICAgQWJzdHJhY3RPYmplY3RBY3Rpb24uY2FsbCggdGhpcywgb2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG59O1xuXG5PYmplY3REZWxldGUucHJvdG90eXBlID0gT2JqZWN0LmNyZWF0ZSggQWJzdHJhY3RPYmplY3RBY3Rpb24ucHJvdG90eXBlICk7XG5cbk9iamVjdERlbGV0ZS5wcm90b3R5cGUudXBkYXRlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgXG4gICAgdmFyIG9iamVjdFZhbHVlID0gdGhpcy5nZXRWYWx1ZSggZGljdGlvbmFyeSApO1xuICAgIGRlbGV0ZSBvYmplY3RWYWx1ZVsgdGhpcy5wcm9wZXJ0eSBdO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBPYmplY3REZWxldGU7XG4iLCIvKiBcbiAgICBDbGFzcyBPYmplY3RVcGRhdGVcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIEFic3RyYWN0T2JqZWN0QWN0aW9uID0gcmVxdWlyZSggJy4vYWJzdHJhY3RPYmplY3RBY3Rpb24uanMnICk7XG52YXIgT2JqZWN0RGVsZXRlID0gcmVxdWlyZSggJy4vb2JqZWN0RGVsZXRlLmpzJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uLy4uL3V0aWxzLmpzJyApO1xuXG52YXIgT2JqZWN0VXBkYXRlID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApIHtcbiAgICBBYnN0cmFjdE9iamVjdEFjdGlvbi5jYWxsKCB0aGlzLCBvYmplY3QsIGRpY3Rpb25hcnkgKTtcbiAgICBcbiAgICB0aGlzLm5ld0VsZW1lbnQgPSBvYmplY3QubmV3RWxlbWVudDtcbn07XG5cbk9iamVjdFVwZGF0ZS5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKCBBYnN0cmFjdE9iamVjdEFjdGlvbi5wcm90b3R5cGUgKTtcblxuT2JqZWN0VXBkYXRlLnByb3RvdHlwZS51cGRhdGVEaWN0aW9uYXJ5ID0gZnVuY3Rpb24oIGRpY3Rpb25hcnkgKXtcbiAgICBcbiAgICB2YXIgb2JqZWN0VmFsdWUgPSB0aGlzLmdldFZhbHVlKCBkaWN0aW9uYXJ5ICk7XG4gICAgb2JqZWN0VmFsdWVbIHRoaXMucHJvcGVydHkgXSA9IHRoaXMubmV3RWxlbWVudDtcbn07XG5cbk9iamVjdFVwZGF0ZS5idWlsZE11bHRpcGxlID0gZnVuY3Rpb24oIG9iamVjdCwgZGljdGlvbmFyeSApe1xuXG4gICAgdmFyIGFjdGlvbnMgPSBbXTtcbiAgICB2YXIgY2xvbmVkT2JqZWN0ID0gdXRpbHMuZGVlcEV4dGVuZCggb2JqZWN0ICk7XG4gICAgXG4gICAgLy8gQ29weSBlZGl0ZWRQcm9wZXJ0aWVzIGFuZCBkZWxldGVkUHJvcGVydGllc1xuICAgIHZhciBlZGl0ZWRQcm9wZXJ0aWVzID0gY2xvbmVkT2JqZWN0LmVkaXRlZFByb3BlcnRpZXM7XG4gICAgdmFyIGRlbGV0ZWRQcm9wZXJ0aWVzID0gY2xvbmVkT2JqZWN0LmRlbGV0ZWRQcm9wZXJ0aWVzO1xuICAgIFxuICAgIC8vIERlbGV0ZSB0aGVtXG4gICAgZGVsZXRlIGNsb25lZE9iamVjdC5lZGl0ZWRQcm9wZXJ0aWVzO1xuICAgIGRlbGV0ZSBjbG9uZWRPYmplY3QuZGVsZXRlZFByb3BlcnRpZXM7XG4gICAgICAgIFxuICAgIC8vIEJ1aWxkIGFjdGlvbnMgbGlzdCBmb3IgZWRpdGVkUHJvcGVydGllc1xuICAgIGlmICggZWRpdGVkUHJvcGVydGllcyApe1xuICAgICAgICBjbG9uZWRPYmplY3QuYWN0aW9uID0gJ3VwZGF0ZU9iamVjdCc7XG4gICAgICAgIGZvciAoIHZhciBlZGl0ZWRQcm9wZXJ0aWVzSWQgaW4gZWRpdGVkUHJvcGVydGllcyApe1xuICAgICAgICAgICAgdmFyIGVkaXRlZFByb3BlcnRpZXNWYWx1ZSA9IGVkaXRlZFByb3BlcnRpZXNbIGVkaXRlZFByb3BlcnRpZXNJZCBdO1xuXG4gICAgICAgICAgICAvLyBDbG9uZSB0aGUgb2JqZWN0IGFuZCBjb25maWd1cmUgcHJvcGVydHkgYW5kIG5ld0VsZW1lbnRcbiAgICAgICAgICAgIHZhciBuZXdPYmplY3QgPSB1dGlscy5kZWVwRXh0ZW5kKCBjbG9uZWRPYmplY3QgKTtcbiAgICAgICAgICAgIG5ld09iamVjdC5wcm9wZXJ0eSA9IGVkaXRlZFByb3BlcnRpZXNJZDtcbiAgICAgICAgICAgIG5ld09iamVjdC5uZXdFbGVtZW50ID0gZWRpdGVkUHJvcGVydGllc1ZhbHVlO1xuXG4gICAgICAgICAgICAvLyBJbnN0YW5jZSB0aGUgYWN0aW9uIGluc3RhbmNlIGFuZCBhZGQgaXQgdG8gdGhlIGxpc3RcbiAgICAgICAgICAgIHZhciBuZXdBY3Rpb25JbnN0YW5jZSA9IG5ldyBPYmplY3RVcGRhdGUoIG5ld09iamVjdCwgZGljdGlvbmFyeSApO1xuICAgICAgICAgICAgYWN0aW9ucy5wdXNoKCBuZXdBY3Rpb25JbnN0YW5jZSApO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIEJ1aWxkIGFjdGlvbnMgbGlzdCBmb3IgZGVsZXRlZFByb3BlcnRpZXNcbiAgICBpZiAoIGRlbGV0ZWRQcm9wZXJ0aWVzICl7XG4gICAgICAgIGNsb25lZE9iamVjdC5hY3Rpb24gPSAnZGVsZXRlT2JqZWN0JztcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgZGVsZXRlZFByb3BlcnRpZXMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIHZhciBkZWxldGVkUHJvcGVydGllc0l0ZW0gPSBkZWxldGVkUHJvcGVydGllc1sgaSBdO1xuXG4gICAgICAgICAgICAvLyBDbG9uZSB0aGUgb2JqZWN0IGFuZCBjb25maWd1cmUgcHJvcGVydHlcbiAgICAgICAgICAgIG5ld09iamVjdCA9IHV0aWxzLmRlZXBFeHRlbmQoIGNsb25lZE9iamVjdCApO1xuICAgICAgICAgICAgbmV3T2JqZWN0LnByb3BlcnR5ID0gZGVsZXRlZFByb3BlcnRpZXNJdGVtO1xuXG4gICAgICAgICAgICAvLyBJbnN0YW5jZSB0aGUgYWN0aW9uIGluc3RhbmNlIGFuZCBhZGQgaXQgdG8gdGhlIGxpc3RcbiAgICAgICAgICAgIG5ld0FjdGlvbkluc3RhbmNlID0gbmV3IE9iamVjdERlbGV0ZSggbmV3T2JqZWN0LCBkaWN0aW9uYXJ5ICk7XG4gICAgICAgICAgICBhY3Rpb25zLnB1c2goIG5ld0FjdGlvbkluc3RhbmNlICk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIGFjdGlvbnM7XG59O1xuXG5tb2R1bGUuZXhwb3J0cyA9IE9iamVjdFVwZGF0ZTtcbiIsIi8qIFxuICAgIENsYXNzIExvb3AgXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBBdXRvRGVmaW5lSGVscGVyID0gcmVxdWlyZSggJy4vYXV0b0RlZmluZUhlbHBlci5qcycgKTtcbnZhciBleHByZXNzaW9uQnVpbGRlciA9IHJlcXVpcmUoICcuLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG5cbnZhciBMb29wID0gZnVuY3Rpb24gKCBfaXRlbVZhcmlhYmxlTmFtZSwgX2V4cHJlc3Npb25TdHJpbmcsIHNjb3BlICkge1xuICAgIFxuICAgIHZhciBpdGVtVmFyaWFibGVOYW1lID0gX2l0ZW1WYXJpYWJsZU5hbWU7XG4gICAgdmFyIGV4cHJlc3Npb25TdHJpbmcgPSBfZXhwcmVzc2lvblN0cmluZztcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbiA9IGV4cHJlc3Npb25CdWlsZGVyLmJ1aWxkKCBleHByZXNzaW9uU3RyaW5nICk7XG4gICAgdmFyIGdldEV4cHJlc3Npb24gPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gZXhwcmVzc2lvbjtcbiAgICB9O1xuICAgIFxuICAgIHZhciBpdGVtcyA9IGV4cHJlc3Npb24uZXZhbHVhdGUoIHNjb3BlICk7XG4gICAgdmFyIGdldEl0ZW1zID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIGl0ZW1zO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGN1cnJlbnRJbmRleCA9IC0xO1xuICAgIHZhciBtYXhJbmRleCA9IGl0ZW1zPyBpdGVtcy5sZW5ndGggLSAxOiAtMTtcbiAgICBcbiAgICB2YXIgb2Zmc2V0ID0gMDtcbiAgICB2YXIgc2V0T2Zmc2V0ID0gZnVuY3Rpb24oIF9vZmZzZXQgKXtcbiAgICAgICAgb2Zmc2V0ID0gX29mZnNldDtcbiAgICB9O1xuICAgIFxuICAgIHZhciByZXBlYXQgPSBmdW5jdGlvbigpe1xuICAgICAgICBcbiAgICAgICAgaWYgKCBjdXJyZW50SW5kZXgrKyA8IG1heEluZGV4ICkge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICByZXR1cm4gTG9vcC5idWlsZEF1dG9EZWZpbmVIZWxwZXIoIFxuICAgICAgICAgICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUsIFxuICAgICAgICAgICAgICAgIGN1cnJlbnRJbmRleCwgXG4gICAgICAgICAgICAgICAgZXhwcmVzc2lvblN0cmluZywgXG4gICAgICAgICAgICAgICAgaXRlbXMubGVuZ3RoLCBcbiAgICAgICAgICAgICAgICBvZmZzZXQgXG4gICAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIHNldE9mZnNldDogc2V0T2Zmc2V0LFxuICAgICAgICByZXBlYXQ6cmVwZWF0LFxuICAgICAgICBnZXRJdGVtczogZ2V0SXRlbXMsXG4gICAgICAgIGdldEV4cHJlc3Npb246IGdldEV4cHJlc3Npb25cbiAgICB9O1xufTtcblxuTG9vcC5idWlsZEF1dG9EZWZpbmVIZWxwZXIgPSBmdW5jdGlvbiggaXRlbVZhcmlhYmxlTmFtZSwgaXRlbUluZGV4LCBleHByZXNzaW9uU3RyaW5nLCBudW1iZXJPZkl0ZW1zLCBvZmZzZXQgKXtcbiAgICBcbiAgICB2YXIgYXV0b0RlZmluZUhlbHBlciA9IG5ldyBBdXRvRGVmaW5lSGVscGVyKCk7XG5cbiAgICAvLyBEZWNsYXJlIGl0ZW0taW5kZXgsIGl0ZW0tYWxsLCBpdGVtIGFuZCBpdGVtLXJlcGVhdCB2YXJpYWJsZXNcbiAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgaXRlbVZhcmlhYmxlTmFtZSArICctaW5kZXgnLFxuICAgICAgICBpdGVtSW5kZXhcbiAgICApO1xuICAgIGF1dG9EZWZpbmVIZWxwZXIucHV0KFxuICAgICAgICBpdGVtVmFyaWFibGVOYW1lICsgJy1hbGwnLFxuICAgICAgICBleHByZXNzaW9uU3RyaW5nXG4gICAgKTtcbiAgICBhdXRvRGVmaW5lSGVscGVyLnB1dChcbiAgICAgICAgaXRlbVZhcmlhYmxlTmFtZSxcbiAgICAgICAgaXRlbVZhcmlhYmxlTmFtZSArICctYWxsJyArICdbJyArIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLWluZGV4JyArICddJ1xuICAgICk7XG4gICAgYXV0b0RlZmluZUhlbHBlci5wdXQoXG4gICAgICAgIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLXJlcGVhdCcsXG4gICAgICAgIFwiY29udGV4dC9yZXBlYXQoXCIgXG4gICAgICAgICAgICArIGl0ZW1WYXJpYWJsZU5hbWUgKyBcIi1pbmRleFwiICsgXCIsXCJcbiAgICAgICAgICAgICsgbnVtYmVyT2ZJdGVtcyArIFwiLFwiXG4gICAgICAgICAgICArIG9mZnNldFxuICAgICAgICAgICAgKyBcIilcIlxuICAgICk7XG5cbiAgICByZXR1cm4gYXV0b0RlZmluZUhlbHBlcjtcbn07XG5cbkxvb3Auc2V0QXV0b0RlZmluZUF0dHJpYnV0ZSA9IGZ1bmN0aW9uKCBub2RlLCBpdGVtVmFyaWFibGVOYW1lLCBpdGVtSW5kZXgsIGV4cHJlc3Npb25TdHJpbmcsIG51bWJlck9mSXRlbXMsIG9mZnNldCApe1xuICAgIFxuICAgIC8vIFNldCBpdGVtLWluZGV4LCBpdGVtLWFsbCwgaXRlbSBhbmQgaXRlbS1yZXBlYXQgYXR0cmlidXRlc1xuICAgIG5vZGUuc2V0QXR0cmlidXRlKCBcbiAgICAgICAgY29udGV4dC5nZXRUYWdzKCkudGFsQXV0b0RlZmluZSxcbiAgICAgICAgaXRlbVZhcmlhYmxlTmFtZSArICctaW5kZXggJyArIGl0ZW1JbmRleCArICc7J1xuICAgICAgICAgICAgKyBpdGVtVmFyaWFibGVOYW1lICsgJy1hbGwgJyArIGV4cHJlc3Npb25TdHJpbmcgKyAnOydcbiAgICAgICAgICAgICsgaXRlbVZhcmlhYmxlTmFtZSArICcgJyArIGl0ZW1WYXJpYWJsZU5hbWUgKyctYWxsWycgKyBpdGVtVmFyaWFibGVOYW1lICsgJy1pbmRleF07J1xuICAgICAgICAgICAgKyBpdGVtVmFyaWFibGVOYW1lICsgJy1yZXBlYXQgY29udGV4dC9yZXBlYXQoJyArIGl0ZW1WYXJpYWJsZU5hbWUgKyAnLWluZGV4LCcgKyBudW1iZXJPZkl0ZW1zICsgJywnICsgb2Zmc2V0ICsgJyknXG4gICAgKTtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTG9vcDtcbiIsIi8qIFxuICAgIENsYXNzIExvb3BJdGVtXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBMb29wSXRlbSA9IGZ1bmN0aW9uICggX2N1cnJlbnRJbmRleCwgX2l0ZW1zTGVuZ3RoLCBfb2Zmc2V0ICkge1xuICAgIFxuICAgIHRoaXMuY3VycmVudEluZGV4ID0gX2N1cnJlbnRJbmRleDtcbiAgICB0aGlzLml0ZW1zTGVuZ3RoID0gX2l0ZW1zTGVuZ3RoO1xuICAgIHRoaXMub2Zmc2V0ID0gX29mZnNldDtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uKCApIHtcbiAgICByZXR1cm4gdGhpcy5vZmZzZXQgKyB0aGlzLmN1cnJlbnRJbmRleDtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5udW1iZXIgPSBmdW5jdGlvbiggKSB7XG4gICAgcmV0dXJuIHRoaXMuaW5kZXgoKSArIDE7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUuZXZlbiA9IGZ1bmN0aW9uKCApIHtcbiAgICByZXR1cm4gdGhpcy5pbmRleCgpICUgMiA9PT0gMDtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5vZGQgPSBmdW5jdGlvbiAoICkge1xuICAgIHJldHVybiB0aGlzLmluZGV4KCkgJSAyID09PSAxO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLnN0YXJ0ID0gZnVuY3Rpb24gKCApIHtcbiAgICByZXR1cm4gdGhpcy5pbmRleCgpID09PSAwO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLmVuZCA9IGZ1bmN0aW9uICggKSB7XG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEluZGV4ID09PSB0aGlzLml0ZW1zTGVuZ3RoIC0gMTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5sZW5ndGggPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMub2Zmc2V0ICsgdGhpcy5pdGVtc0xlbmd0aDtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5sZXR0ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIHRoaXMuZm9ybWF0TGV0dGVyKCB0aGlzLmluZGV4KCksICdhJyApO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLkxldHRlciA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtYXRMZXR0ZXIoIHRoaXMuaW5kZXgoKSwgJ0EnICk7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUuZm9ybWF0TGV0dGVyID0gZnVuY3Rpb24gKCBpaSwgc3RhcnRDaGFyICkge1xuICAgIHZhciBpID0gaWk7XG4gICAgdmFyIGJ1ZmZlciA9ICcnO1xuICAgIHZhciBzdGFydCA9IHN0YXJ0Q2hhci5jaGFyQ29kZUF0KCAwICk7IFxuICAgIHZhciBkaWdpdCA9IGkgJSAyNjtcbiAgICBidWZmZXIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSggc3RhcnQgKyBkaWdpdCApO1xuXG4gICAgd2hpbGUoIGkgPiAyNSApIHtcbiAgICAgICAgaSAvPSAyNjtcbiAgICAgICAgZGlnaXQgPSAoaSAtIDEgKSAlIDI2O1xuICAgICAgICBidWZmZXIgKz0gU3RyaW5nLmZyb21DaGFyQ29kZSggc3RhcnQgKyBkaWdpdCApO1xuICAgIH1cblxuICAgIHJldHVybiBidWZmZXIuc3BsaXQoJycpLnJldmVyc2UoKS5qb2luKCcnKTtcbn07XG5cbkxvb3BJdGVtLnByb3RvdHlwZS5yb21hbiA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gdGhpcy5mb3JtYXRSb21hbiggdGhpcy5pbmRleCgpICsgMSwgMCApO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLlJvbWFuID0gZnVuY3Rpb24gKCkge1xuICAgIHJldHVybiB0aGlzLmZvcm1hdFJvbWFuKCB0aGlzLmluZGV4KCkgKyAxLCAxICk7XG59O1xuXG5Mb29wSXRlbS5wcm90b3R5cGUuZm9ybWF0Um9tYW4gPSBmdW5jdGlvbiAoIG5uLCBjYXBpdGFsICkge1xuICAgIHZhciBuID0gbm47XG5cbiAgICAvLyBDYW4ndCByZXByZXNlbnQgYW55IG51bWJlciA0MDAwIG9yIGdyZWF0ZXJcbiAgICBpZiAoIG4gPj0gNDAwMCApIHtcbiAgICAgICAgcmV0dXJuICdPdmVyZmxvdyBmb3JtYXR0aW5nIHJvbWFuISc7XG4gICAgfVxuXG4gICAgdmFyIGJ1ZiA9ICcnO1xuICAgIGZvciAoIHZhciBkZWNhZGUgPSAwOyBuICE9PSAwOyBkZWNhZGUrKyApIHtcbiAgICAgICAgdmFyIGRpZ2l0ID0gbiAlIDEwO1xuICAgICAgICBpZiAoIGRpZ2l0ID4gMCApIHtcbiAgICAgICAgICAgIGRpZ2l0LS07XG4gICAgICAgICAgICBidWYgKz0gdGhpcy5yb21hbkFycmF5IFsgZGVjYWRlIF1bIGRpZ2l0IF1bIGNhcGl0YWwgXTtcbiAgICAgICAgfVxuICAgICAgICBuID0gKG4gLyAxMCkgPj4gMDtcbiAgICB9XG5cbiAgICByZXR1cm4gYnVmLnNwbGl0KCAnJyApLnJldmVyc2UoKS5qb2luKCAnJyApO1xufTtcblxuTG9vcEl0ZW0ucHJvdG90eXBlLnJvbWFuQXJyYXkgPSBbXG4gICAgLyogT25lJ3MgcGxhY2UgKi9cbiAgICBbXG4gICAgICAgIFsgXCJpXCIsIFwiSVwiIF0sXG4gICAgICAgIFsgXCJpaVwiLCBcIklJXCIgXSwgXG4gICAgICAgIFsgXCJpaWlcIiwgXCJJSUlcIiBdLFxuICAgICAgICBbIFwidmlcIiwgXCJWSVwiIF0sXG4gICAgICAgIFsgXCJ2XCIsIFwiVlwiIF0sXG4gICAgICAgIFsgXCJpdlwiLCBcIklWXCIgXSxcbiAgICAgICAgWyBcImlpdlwiLCBcIklJVlwiIF0sXG4gICAgICAgIFsgXCJpaWl2XCIsIFwiSUlJVlwiIF0sXG4gICAgICAgIFsgXCJ4aVwiLCBcIlhJXCIgXVxuICAgIF0sXG5cbiAgICAvKiAxMCdzIHBsYWNlICovXG4gICAgW1xuICAgICAgICBbIFwieFwiLCBcIlhcIiBdLFxuICAgICAgICBbIFwieHhcIiwgXCJYWFwiIF0sXG4gICAgICAgIFsgXCJ4eHhcIiwgXCJYWFhcIiBdLFxuICAgICAgICBbIFwibHhcIiwgXCJMWFwiIF0sXG4gICAgICAgIFsgXCJsXCIsIFwiTFwiIF0sXG4gICAgICAgIFsgXCJ4bFwiLCBcIlhMXCIgXSxcbiAgICAgICAgWyBcInh4bFwiLCBcIlhYTFwiIF0sXG4gICAgICAgIFsgXCJ4eHhsXCIsIFwiWFhYTFwiIF0sXG4gICAgICAgIFsgXCJjeFwiLCBcIkNYXCIgXVxuICAgIF0sXG5cbiAgICAvKiAxMDAncyBwbGFjZSAqL1xuICAgIFtcbiAgICAgICAgWyBcImNcIiwgXCJDXCIgXSxcbiAgICAgICAgWyBcImNjXCIsIFwiQ0NcIiBdLFxuICAgICAgICBbIFwiY2NjXCIsIFwiQ0NDXCIgXSxcbiAgICAgICAgWyBcImRjXCIsIFwiRENcIiBdLFxuICAgICAgICBbIFwiZFwiLCBcIkRcIiBdLFxuICAgICAgICBbIFwiY2RcIiwgXCJDRFwiIF0sXG4gICAgICAgIFsgXCJjY2RcIiwgXCJDQ0RcIiBdLFxuICAgICAgICBbIFwiY2NjZFwiLCBcIkNDQ0RcIiBdLFxuICAgICAgICBbIFwibWNcIiwgXCJNQ1wiIF1cbiAgICBdLFxuXG4gICAgLyogMTAwMCdzIHBsYWNlICovXG4gICAgW1xuICAgICAgICBbIFwibVwiLCBcIk1cIiBdLFxuICAgICAgICBbIFwibW1cIiwgXCJNTVwiIF0sXG4gICAgICAgIFsgXCJtbW1cIiwgXCJNTU1cIiBdXG4gICAgXVxuXTtcblxubW9kdWxlLmV4cG9ydHMgPSBMb29wSXRlbTtcbiIsIi8qIFxuICAgIENsYXNzIE5vZGVBdHRyaWJ1dGVzIFxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xuXG52YXIgTm9kZUF0dHJpYnV0ZXMgPSBmdW5jdGlvbiggbm9kZSwgaW5kZXhFeHByZXNzaW9ucyApIHtcbiAgICBcbiAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xuICAgIFxuICAgIC8vIHRhbCBuYW1lc3BhY2VcbiAgICB0aGlzLnRhbERlZmluZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbERlZmluZSApO1xuICAgIHRoaXMudGFsQ29uZGl0aW9uID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsQ29uZGl0aW9uICk7XG4gICAgdGhpcy50YWxSZXBlYXQgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxSZXBlYXQgKTtcbiAgICB0aGlzLnRhbENvbnRlbnQgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxDb250ZW50ICk7XG4gICAgdGhpcy50YWxBdHRyaWJ1dGVzID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsQXR0cmlidXRlcyApO1xuICAgIHRoaXMudGFsT21pdFRhZyA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbE9taXRUYWcgKTtcbiAgICB0aGlzLnRhbFJlcGxhY2UgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy50YWxSZXBsYWNlICk7XG4gICAgdGhpcy50YWxPbkVycm9yID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MudGFsT25FcnJvciApO1xuICAgIHRoaXMudGFsRGVjbGFyZSA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLnRhbERlY2xhcmUgKTtcbiAgICAvL3RoaXMudGFsVGFnID0gdW5kZWZpbmVkO1xuICAgIFxuICAgIC8vIG1ldGFsIG5hbWVzcGFjZVxuICAgIHRoaXMubWV0YWxEZWZpbmVNYWNybyA9IG5vZGUuZ2V0QXR0cmlidXRlKCB0YWdzLm1ldGFsRGVmaW5lTWFjcm8gKTtcbiAgICB0aGlzLm1ldGFsVXNlTWFjcm8gPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5tZXRhbFVzZU1hY3JvICk7XG4gICAgdGhpcy5tZXRhbERlZmluZVNsb3QgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5tZXRhbERlZmluZVNsb3QgKTtcbiAgICB0aGlzLm1ldGFsRmlsbFNsb3QgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5tZXRhbEZpbGxTbG90ICk7XG4gICAgXG4gICAgLy8gaTE4biBuYW1lc3BhY2VcbiAgICB0aGlzLmkxOG5Eb21haW4gPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5pMThuRG9tYWluICk7XG4gICAgdGhpcy5pMThuTGFuZ3VhZ2UgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFncy5pMThuTGFuZ3VhZ2UgKTtcbiAgICBcbiAgICAvLyBGb3IgaW50ZXJuYWwgdXNlXG4gICAgdGhpcy5xZHVwID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MucWR1cCApO1xuICAgIFxuICAgIC8vIEluaXQgdGhpcy5pZCBhbmQgc2V0IHRoZSBub2RlIGlkIGlmIGluZGV4RXhwcmVzc2lvbnMgaXMgdHJ1ZSwgc29tZSBhdHRyaWJ1dGUgaXMgc2V0IGFuZCBpdCBpcyB1bmRlZmluZWRcbiAgICBpZiAoIGluZGV4RXhwcmVzc2lvbnMgJiYgdGhpcy5pc0R5bmFtaWNDb250ZW50T24oKSApe1xuICAgICAgICB0aGlzLmlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaWQgKTtcbiAgICAgICAgaWYgKCAhIHRoaXMuaWQgKXtcbiAgICAgICAgICAgIC8vdGhpcy5pZCA9IHV0aWxzLmdlbmVyYXRlSWQoIDYgKTtcbiAgICAgICAgICAgIHRoaXMuaWQgPSBjb250ZXh0Lm5leHRFeHByZXNzaW9uQ291bnRlcigpO1xuICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoIHRhZ3MuaWQsIHRoaXMuaWQgKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cbk5vZGVBdHRyaWJ1dGVzLnByb3RvdHlwZS5pc0R5bmFtaWNDb250ZW50T24gPSBmdW5jdGlvbigpIHtcbiAgICBcbiAgICByZXR1cm4gdGhpcy50YWxEZWZpbmUgXG4gICAgICAgIHx8IHRoaXMudGFsQ29uZGl0aW9uXG4gICAgICAgIHx8IHRoaXMudGFsUmVwZWF0XG4gICAgICAgIHx8IHRoaXMudGFsQ29udGVudFxuICAgICAgICB8fCB0aGlzLnRhbEF0dHJpYnV0ZXNcbiAgICAgICAgfHwgdGhpcy50YWxPbWl0VGFnIFxuICAgICAgICB8fCB0aGlzLnRhbFJlcGxhY2VcbiAgICAgICAgfHwgdGhpcy50YWxPbkVycm9yXG4gICAgICAgIHx8IHRoaXMudGFsRGVjbGFyZVxuICAgICAgICAvL3x8IHRoaXMudGFsVGFnXG4gICAgICAgIC8vfHwgdGhpcy5tZXRhbERlZmluZU1hY3JvIFxuICAgICAgICB8fCB0aGlzLm1ldGFsVXNlTWFjcm8gXG4gICAgICAgIC8vfHwgdGhpcy5tZXRhbERlZmluZVNsb3QgXG4gICAgICAgIHx8IHRoaXMubWV0YWxGaWxsU2xvdCBcbiAgICAgICAgfHwgdGhpcy5pMThuRG9tYWluXG4gICAgICAgIHx8IHRoaXMuaTE4bkxhbmd1YWdlO1xuICAgICAgICAvL3x8IHRoaXMucWR1cDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gTm9kZUF0dHJpYnV0ZXM7XG4iLCIvKiBcclxuICAgIENsYXNzIE5vZGVSZW1vdmVyIFxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcclxuICAgIFxyXG4gICAgdmFyIHRhZ3MgPSBjb250ZXh0LmdldFRhZ3MoKTtcclxuICAgIFxyXG4gICAgdmFyIHJlbW92ZUdlbmVyYXRlZE5vZGVzID0gZnVuY3Rpb24oIHRhcmdldCApIHtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJcyBtdWx0aXJvb3Q/XHJcbiAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCB0YXJnZXQgKSApeyBcclxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHNldmVyYWwgcm9vdHNcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICAgICAgZm9yICggdmFyIGMgPSAwOyBjIDwgdGFyZ2V0Lmxlbmd0aDsgYysrICkge1xyXG4gICAgICAgICAgICAgICAgcmVzdWx0ID0gcmVzdWx0LmNvbmNhdCggXHJcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlTm9kZXMoIHRhcmdldFsgYyBdIClcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVGhlcmUgaXMgb25seSBvbmUgcm9vdFxyXG4gICAgICAgIHJldHVybiByZW1vdmVOb2RlcyggdGFyZ2V0ICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVtb3ZlTm9kZXMgPSBmdW5jdGlvbiggdGFyZ2V0ICkge1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZXN1bHQgPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KCByZW1vdmVOb2Rlc0J5VGFnKCB0YXJnZXQsIHRhZ3MucWR1cCApICk7ICAgICAgIC8vIFJlbW92ZSBhbGwgZ2VuZXJhdGVkIG5vZGVzIChyZXBlYXRzKVxyXG4gICAgICAgIHJlc3VsdCA9IHJlc3VsdC5jb25jYXQoIHJlbW92ZU5vZGVzQnlUYWcoIHRhcmdldCwgdGFncy5tZXRhbE1hY3JvICkgKTsgLy8gUmVtb3ZlIGFsbCBnZW5lcmF0ZWQgbm9kZXMgKG1hY3JvcylcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHJlbW92ZU5vZGVzQnlUYWcgPSBmdW5jdGlvbiggdGFyZ2V0LCB0YWcgKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgbGlzdCA9IHRhcmdldC5xdWVyeVNlbGVjdG9yQWxsKCBcIipbXCIgKyB0YWcgKyBcIl1cIiApO1xyXG4gICAgICAgIHJldHVybiByZW1vdmVMaXN0KCBsaXN0ICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcmVtb3ZlUmVsYXRlZE5vZGVzID0gZnVuY3Rpb24oIHRhcmdldCApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBsaXN0ID0gdGFyZ2V0LnBhcmVudE5vZGUucXVlcnlTZWxlY3RvckFsbCggXHJcbiAgICAgICAgICAgICdbJyArIGNvbnRleHQuZ2V0VGFncygpLnJlbGF0ZWRJZCArICc9XCInICsgdGFyZ2V0LmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKSArICdcIl0nIFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHJlbW92ZUxpc3QoIGxpc3QgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciByZW1vdmVMaXN0ID0gZnVuY3Rpb24oIGxpc3QgKXtcclxuXHJcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBub2RlO1xyXG4gICAgICAgIHZhciBwb3MgPSAwO1xyXG4gICAgICAgIHdoaWxlICggbm9kZSA9IGxpc3RbIHBvcysrIF0gKSB7XHJcbiAgICAgICAgICAgIC8vIEFkZCBub2RlSWQgdG8gcmVzdWx0IGlmIG5lZWRlZFxyXG4gICAgICAgICAgICB2YXIgbm9kZUlkID0gZ2V0Tm9kZUlkKCBub2RlICk7XHJcbiAgICAgICAgICAgIGlmICggbm9kZUlkICE9PSB1bmRlZmluZWQgKXtcclxuICAgICAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBub2RlSWQgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gQWRkIHRoZSBub2RlSWRzIG9mIGl0cyBjaGlsZHJlblxyXG4gICAgICAgICAgICBhZGROb2RlSWRzVG9MaXN0KCBub2RlLCByZXN1bHQgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFJlbW92ZSBub2RlXHJcbiAgICAgICAgICAgIG5vZGUucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggbm9kZSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGFkZE5vZGVJZHNUb0xpc3QgPSBmdW5jdGlvbiggdGFyZ2V0LCByZXN1bHQgKXtcclxuICAgICAgICBcclxuICAgICAgICAvLyBHZXQgdGhlIG5vZGVzIHdpdGggZGF0YS1pZFxyXG4gICAgICAgIHZhciBub2RlSWRBdHRyaWJ1dGVOYW1lID0gY29udGV4dC5nZXRUYWdzKCkuaWQ7XHJcbiAgICAgICAgdmFyIGxpc3QgPSB0YXJnZXQucXVlcnlTZWxlY3RvckFsbCggJ1snICsgbm9kZUlkQXR0cmlidXRlTmFtZSArICddJyApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEl0ZXJhdGUgdGhlIGxpc3RcclxuICAgICAgICB2YXIgbm9kZTtcclxuICAgICAgICB2YXIgcG9zID0gMDtcclxuICAgICAgICB3aGlsZSAoIG5vZGUgPSBsaXN0WyBwb3MrKyBdICkge1xyXG4gICAgICAgICAgICByZXN1bHQucHVzaCggXHJcbiAgICAgICAgICAgICAgICBub2RlLmdldEF0dHJpYnV0ZSggbm9kZUlkQXR0cmlidXRlTmFtZSApIFxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBnZXROb2RlSWQgPSBmdW5jdGlvbiggbm9kZSApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBub2RlSWRBdHRyaWJ1dGVOYW1lID0gY29udGV4dC5nZXRUYWdzKCkuaWQ7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIG5vZGUuaGFzQXR0cmlidXRlKCBub2RlSWRBdHRyaWJ1dGVOYW1lICk/XHJcbiAgICAgICAgICAgIG5vZGUuZ2V0QXR0cmlidXRlKCBub2RlSWRBdHRyaWJ1dGVOYW1lICk6XHJcbiAgICAgICAgICAgIHVuZGVmaW5lZDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciByZW1vdmVOb2RlID0gZnVuY3Rpb24oIG5vZGUgKXtcclxuICAgICAgICB2YXIgbm9kZUlkID0gZ2V0Tm9kZUlkKCBub2RlICk7XHJcbiAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgaWYgKCBwYXJlbnROb2RlICl7XHJcbiAgICAgICAgICAgIHBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoIG5vZGUgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIG5vZGVJZDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciByZW1vdmVNdWx0aXBsZU5vZGVzID0gZnVuY3Rpb24oIG5vZGUsIG11c3RSZW1vdmVHZW5lcmF0ZWROb2RlcyApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciByZXN1bHQgPSByZW1vdmVSZWxhdGVkTm9kZXMoIG5vZGUgKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoIG11c3RSZW1vdmVHZW5lcmF0ZWROb2RlcyApe1xyXG4gICAgICAgICAgICByZXN1bHQgPSByZXN1bHQuY29uY2F0KFxyXG4gICAgICAgICAgICAgICAgcmVtb3ZlR2VuZXJhdGVkTm9kZXMoIG5vZGUgKVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcmVzdWx0O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHNlbGYgPSB7XHJcbiAgICAgICAgcmVtb3ZlR2VuZXJhdGVkTm9kZXM6IHJlbW92ZUdlbmVyYXRlZE5vZGVzLFxyXG4gICAgICAgIC8vcmVtb3ZlUmVsYXRlZE5vZGVzOiByZW1vdmVSZWxhdGVkTm9kZXMsXHJcbiAgICAgICAgcmVtb3ZlTm9kZTogcmVtb3ZlTm9kZSxcclxuICAgICAgICByZW1vdmVNdWx0aXBsZU5vZGVzOiByZW1vdmVNdWx0aXBsZU5vZGVzXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufSkoKTtcclxuIiwiLyogXHJcbiAgICBDbGFzcyBQYXJzZXIgXHJcbiovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcclxudmFyIFBhcnNlclJlbmRlcmVyID0gcmVxdWlyZSggJy4vcGFyc2VyUmVuZGVyZXIuanMnICk7XHJcbnZhciBQYXJzZXJVcGRhdGVyID0gcmVxdWlyZSggJy4vcGFyc2VyVXBkYXRlci5qcycgKTtcclxudmFyIFBhcnNlclByZWxvYWRlciA9IHJlcXVpcmUoICcuL3BhcnNlclByZWxvYWRlci5qcycgKTtcclxudmFyIFJlYWN0aXZlRGljdGlvbmFyeSA9IHJlcXVpcmUoICcuLi9zY29wZXMvcmVhY3RpdmVEaWN0aW9uYXJ5LmpzJyApO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oKSB7XHJcbiAgICBcclxuICAgIHZhciBwYXJzZXJPcHRpb25zID0ge1xyXG4gICAgICAgIGNvbW1hbmQ6IHVuZGVmaW5lZCwgLy8gcHJlbG9hZCwgZnVsbFJlbmRlciBvciBwYXJ0aWFsUmVuZGVyXHJcbiAgICAgICAgcm9vdDogdW5kZWZpbmVkLFxyXG4gICAgICAgIGRpY3Rpb25hcnk6IHt9LFxyXG4gICAgICAgIGluZGV4RXhwcmVzc2lvbnM6IHRydWVcclxuICAgICAgICAvL25vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsXHJcbiAgICAgICAgLy90YXJnZXQsXHJcbiAgICAgICAgLy9kZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLFxyXG4gICAgICAgIC8vaTE4bixcclxuICAgICAgICAvL2NhbGxiYWNrLFxyXG4gICAgICAgIC8vZmFpbENhbGxiYWNrLFxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHVwZGF0ZVBhcnNlck9wdGlvbnMgPSBmdW5jdGlvbiggb3B0aW9ucyApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHBhcnNlck9wdGlvbnMuY29tbWFuZCA9IG9wdGlvbnMuY29tbWFuZCB8fCAnZnVsbFJlbmRlcic7XHJcbiAgICAgICAgcGFyc2VyT3B0aW9ucy5yb290ID0gb3B0aW9ucy5yb290ID09PSB1bmRlZmluZWQ/IHBhcnNlck9wdGlvbnMucm9vdDogb3B0aW9ucy5yb290O1xyXG4gICAgICAgIHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeSA9ICggb3B0aW9ucy5kaWN0aW9uYXJ5IGluc3RhbmNlb2YgUmVhY3RpdmVEaWN0aW9uYXJ5P1xyXG4gICAgICAgICAgICBvcHRpb25zLmRpY3Rpb25hcnkuX2dldE5vblJlYWN0aXZlRGljdGlvbmFyeSgpOiBcclxuICAgICAgICAgICAgb3B0aW9ucy5kaWN0aW9uYXJ5IClcclxuICAgICAgICAgICAgfHwgcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5O1xyXG4gICAgICAgIC8vcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5ID0gb3B0aW9ucy5kaWN0aW9uYXJ5IHx8IHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeTtcclxuICAgICAgICBwYXJzZXJPcHRpb25zLmluZGV4RXhwcmVzc2lvbnMgPSBvcHRpb25zLmluZGV4RXhwcmVzc2lvbnMgPT09IHVuZGVmaW5lZD8gcGFyc2VyT3B0aW9ucy5pbmRleEV4cHJlc3Npb25zOiBvcHRpb25zLmluZGV4RXhwcmVzc2lvbnM7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24oIF9vcHRpb25zICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIG9wdGlvbnMgPSBfb3B0aW9ucyB8fCB7fTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbml0IHBhcnNlciBvcHRpb25zXHJcbiAgICAgICAgdXBkYXRlUGFyc2VyT3B0aW9ucyggb3B0aW9ucyApO1xyXG4gICAgXHJcbiAgICAgICAgdmFyIGNvbW1hbmQgPSBvcHRpb25zLmNvbW1hbmQgfHwgJ2Z1bGxSZW5kZXInO1xyXG4gICAgICAgIHN3aXRjaCAoIGNvbW1hbmQgKSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ3ByZWxvYWQnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NQcmVsb2FkKFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuY2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5mYWlsQ2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kZWNsYXJlZFJlbW90ZVBhZ2VVcmxzIHx8IFtdLFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuaTE4bixcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLm5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5tYXhGb2xkZXJEaWN0aW9uYXJpZXNcclxuICAgICAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIGNhc2UgJ2Z1bGxSZW5kZXInOlxyXG4gICAgICAgICAgICBjYXNlICdwYXJ0aWFsUmVuZGVyJzpcclxuICAgICAgICAgICAgICAgIHJldHVybiBwcm9jZXNzUmVuZGVyKFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbW1hbmQgPT09ICdwYXJ0aWFsUmVuZGVyJz8gb3B0aW9ucy50YXJnZXQ6IHBhcnNlck9wdGlvbnMucm9vdCxcclxuICAgICAgICAgICAgICAgICAgICBvcHRpb25zLmRpY3Rpb25hcnlFeHRlbnNpb24sXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5ub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLFxyXG4gICAgICAgICAgICAgICAgICAgIHBhcnNlck9wdGlvbnMuaW5kZXhFeHByZXNzaW9ucyAmJiBjb21tYW5kID09PSAnZnVsbFJlbmRlcicsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5nb1RvVVJMSGFzaCA9PT0gdW5kZWZpbmVkPyBjb250ZXh0Lm5leHRSdW5Db3VudGVyKCkgPT09IDE6IGZhbHNlXHJcbiAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBjYXNlICd1cGRhdGUnOlxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NVcGRhdGUoIFxyXG4gICAgICAgICAgICAgICAgICAgIG9wdGlvbnMuZGljdGlvbmFyeUNoYW5nZXMsXHJcbiAgICAgICAgICAgICAgICAgICAgb3B0aW9ucy5kaWN0aW9uYXJ5QWN0aW9uc1xyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuICAgICAgICAgICAgICAgIHRocm93ICdVbmtub3duIGNvbW1hbmQ6ICcgKyBjb21tYW5kO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzUHJlbG9hZCA9IGZ1bmN0aW9uKCBjYWxsYmFjaywgZmFpbENhbGxiYWNrLCBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLCBpMThuLCBub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLCBtYXhGb2xkZXJEaWN0aW9uYXJpZXMgKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgcGFyc2VyUHJlbG9hZGVyID0gbmV3IFBhcnNlclByZWxvYWRlciggXHJcbiAgICAgICAgICAgIHBhcnNlck9wdGlvbnMsIFxyXG4gICAgICAgICAgICBjYWxsYmFjaywgXHJcbiAgICAgICAgICAgIGZhaWxDYWxsYmFjaywgXHJcbiAgICAgICAgICAgIGRlY2xhcmVkUmVtb3RlUGFnZVVybHMsIFxyXG4gICAgICAgICAgICBpMThuLCBcclxuICAgICAgICAgICAgbm90UmVtb3ZlR2VuZXJhdGVkVGFncywgXHJcbiAgICAgICAgICAgIG1heEZvbGRlckRpY3Rpb25hcmllc1xyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHBhcnNlclByZWxvYWRlci5ydW4oKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHBhcnNlclByZWxvYWRlcjtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzUmVuZGVyID0gZnVuY3Rpb24oIHRhcmdldCwgZGljdGlvbmFyeUV4dGVuc2lvbiwgbm90UmVtb3ZlR2VuZXJhdGVkVGFncywgcmVzZXRJbmRleCwgZ29Ub1VSTEhhc2ggKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgcGFyc2VyUmVuZGVyZXIgPSBuZXcgUGFyc2VyUmVuZGVyZXIoIFxyXG4gICAgICAgICAgICBwYXJzZXJPcHRpb25zLCBcclxuICAgICAgICAgICAgdGFyZ2V0LCBcclxuICAgICAgICAgICAgZGljdGlvbmFyeUV4dGVuc2lvbiwgXHJcbiAgICAgICAgICAgIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsIFxyXG4gICAgICAgICAgICByZXNldEluZGV4LFxyXG4gICAgICAgICAgICBnb1RvVVJMSGFzaFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHBhcnNlclJlbmRlcmVyLnJ1bigpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiBwYXJzZXJSZW5kZXJlcjtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzVXBkYXRlID0gZnVuY3Rpb24oIGRpY3Rpb25hcnlDaGFuZ2VzLCBkaWN0aW9uYXJ5QWN0aW9ucyApIHtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgcGFyc2VyVXBkYXRlciA9IG5ldyBQYXJzZXJVcGRhdGVyKCBcclxuICAgICAgICAgICAgZGljdGlvbmFyeUNoYW5nZXMsXHJcbiAgICAgICAgICAgIGRpY3Rpb25hcnlBY3Rpb25zLFxyXG4gICAgICAgICAgICBwYXJzZXJPcHRpb25zXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcGFyc2VyVXBkYXRlci5ydW4oKTtcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4gcGFyc2VyVXBkYXRlcjtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBnZXRPcHRpb25zID0gZnVuY3Rpb24oKXtcclxuICAgICAgICByZXR1cm4gcGFyc2VyT3B0aW9ucztcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJ1bjogcnVuLFxyXG4gICAgICAgIGdldE9wdGlvbnM6IGdldE9wdGlvbnNcclxuICAgIH07XHJcbiAgICBcclxuICAgIHJldHVybiBzZWxmO1xyXG59KSgpO1xyXG4iLCIvKiBcclxuICAgIENsYXNzIFBhcnNlck5vZGVSZW5kZXJlclxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XHJcbnZhciBsb2cgPSByZXF1aXJlKCAnLi4vbG9nSGVscGVyLmpzJyApO1xyXG52YXIgTm9kZUF0dHJpYnV0ZXMgPSByZXF1aXJlKCAnLi9ub2RlQXR0cmlidXRlcy5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUNhY2hlID0gcmVxdWlyZSggJy4uL2NhY2hlL2F0dHJpYnV0ZUNhY2hlLmpzJyApO1xyXG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9hdHRyaWJ1dGVJbmRleC5qcycgKTtcclxudmFyIEF1dG9EZWZpbmVIZWxwZXIgPSByZXF1aXJlKCAnLi9hdXRvRGVmaW5lSGVscGVyLmpzJyApO1xyXG52YXIgZXZhbHVhdGVIZWxwZXIgPSByZXF1aXJlKCAnLi4vZXhwcmVzc2lvbnMvZXZhbHVhdGVIZWxwZXIuanMnICk7XHJcbnZhciBMb29wID0gcmVxdWlyZSggJy4vbG9vcC5qcycgKTtcclxuXHJcbnZhciBJMThORG9tYWluID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvSTE4Ti9pMThuRG9tYWluLmpzJyApO1xyXG52YXIgSTE4Tkxhbmd1YWdlID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvSTE4Ti9pMThuTGFuZ3VhZ2UuanMnICk7XHJcbnZhciBNRVRBTERlZmluZU1hY3JvID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvTUVUQUwvbWV0YWxEZWZpbmVNYWNyby5qcycgKTtcclxudmFyIE1FVEFMVXNlTWFjcm8gPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9NRVRBTC9tZXRhbFVzZU1hY3JvLmpzJyApO1xyXG52YXIgVEFMQXR0cmlidXRlcyA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxBdHRyaWJ1dGVzLmpzJyApO1xyXG52YXIgVEFMQ29uZGl0aW9uID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbENvbmRpdGlvbi5qcycgKTtcclxudmFyIFRBTENvbnRlbnQgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsQ29udGVudC5qcycgKTtcclxudmFyIFRBTERlZmluZSA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxEZWZpbmUuanMnICk7XHJcbnZhciBUQUxPbWl0VGFnID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbE9taXRUYWcuanMnICk7XHJcbnZhciBUQUxPbkVycm9yID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvVEFML3RhbE9uRXJyb3IuanMnICk7XHJcbnZhciBUQUxSZXBlYXQgPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9UQUwvdGFsUmVwZWF0LmpzJyApO1xyXG52YXIgVEFMUmVwbGFjZSA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxSZXBsYWNlLmpzJyApO1xyXG52YXIgVEFMRGVjbGFyZSA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC90YWxEZWNsYXJlLmpzJyApO1xyXG52YXIgY29udGVudEhlbHBlciA9IHJlcXVpcmUoICcuLi9hdHRyaWJ1dGVzL1RBTC9jb250ZW50SGVscGVyLmpzJyApO1xyXG5cclxudmFyIFBhcnNlck5vZGVSZW5kZXJlciA9IGZ1bmN0aW9uKCBfdGFyZ2V0LCBfc2NvcGUsIF9pbmRleEV4cHJlc3Npb25zICkge1xyXG4gICAgXHJcbiAgICB2YXIgdGFyZ2V0ID0gX3RhcmdldDsgXHJcbiAgICB2YXIgc2NvcGUgPSBfc2NvcGU7XHJcbiAgICB2YXIgaW5kZXhFeHByZXNzaW9ucyA9IF9pbmRleEV4cHJlc3Npb25zO1xyXG4gICAgXHJcbiAgICB2YXIgdGFncyA9IGNvbnRleHQuZ2V0VGFncygpO1xyXG4gICAgXHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBwcm9jZXNzKCB0YXJnZXQgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oIG5vZGUgKSB7XHJcblxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIEdldCB0aGUgYXR0cmlidXRlcyBmcm9tIHRoZSBub2RlXHJcbiAgICAgICAgICAgIHZhciBhdHRyaWJ1dGVzID0gbmV3IE5vZGVBdHRyaWJ1dGVzKCBub2RlLCBpbmRleEV4cHJlc3Npb25zICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzY29wZS5zdGFydEVsZW1lbnQoKTtcclxuXHJcbiAgICAgICAgICAgIC8vIFByb2Nlc3MgaW5zdHJ1Y3Rpb25zXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsUmVwZWF0ICE9IG51bGwgPyBcclxuICAgICAgICAgICAgICAgIHByb2Nlc3NMb29wKCBub2RlLCBhdHRyaWJ1dGVzICk6XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzRWxlbWVudCggbm9kZSwgYXR0cmlidXRlcyApO1xyXG5cclxuICAgICAgICAgICAgc2NvcGUuZW5kRWxlbWVudCgpO1xyXG5cclxuICAgICAgICB9IGNhdGNoICggZSApIHtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIFRyeSB0byB0cmVhdCBlcnJvclxyXG4gICAgICAgICAgICBpZiAoICEgdHJlYXRFcnJvciggbm9kZSwgZSApICkge1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzTG9vcE5leHRTaWJsaW5nID0gZnVuY3Rpb24oIG5vZGUgKXtcclxuXHJcbiAgICAgICAgdmFyIGNvdW50ZXIgPSAtMTtcclxuICAgICAgICB2YXIgbmV4dFNpYmxpbmcgPSBub2RlO1xyXG4gICAgICAgIGRvIHtcclxuICAgICAgICAgICAgKytjb3VudGVyO1xyXG4gICAgICAgICAgICBuZXh0U2libGluZyA9IG5leHRTaWJsaW5nLm5leHRFbGVtZW50U2libGluZztcclxuICAgICAgICAgICAgaWYgKCAhIG5leHRTaWJsaW5nICl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIG5leHRTaWJsaW5nOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvdW50ZXI6IGNvdW50ZXJcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IHdoaWxlICggbmV4dFNpYmxpbmcuaGFzQXR0cmlidXRlKCB0YWdzLnFkdXAgKSApO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBuZXh0U2libGluZzogbmV4dFNpYmxpbmcsXHJcbiAgICAgICAgICAgIGNvdW50ZXI6IGNvdW50ZXJcclxuICAgICAgICB9O1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NMb29wID0gZnVuY3Rpb24oIG5vZGUsIGF0dHJpYnV0ZXMgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUHJvY2VzcyByZXBlYXRcclxuICAgICAgICAvL3ZhciB0YWxSZXBlYXQgPSBUQUxSZXBlYXQuYnVpbGQoIGF0dHJpYnV0ZXMudGFsUmVwZWF0ICk7XHJcbiAgICAgICAgdmFyIHRhbFJlcGVhdCA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxSZXBlYXQsIFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbFJlcGVhdCwgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICB2YXIgbG9vcCA9IHRhbFJlcGVhdC5wcm9jZXNzKCBzY29wZSwgbm9kZSApO1xyXG5cclxuICAgICAgICAvLyBDaGVjayBkZWZhdWx0XHJcbiAgICAgICAgaWYgKCBldmFsdWF0ZUhlbHBlci5pc0RlZmF1bHQoIGxvb3AuZ2V0SXRlbXMoKSApICl7XHJcbiAgICAgICAgICAgIHByb2Nlc3NFbGVtZW50KCBub2RlLCBhdHRyaWJ1dGVzICk7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBDb25maWd1cmUgdGhlIG5vZGUgdG8gY2xvbmUgaXQgbGF0ZXJcclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggdGFncy50YWxSZXBlYXQgKTtcclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggJ3N0eWxlJyApO1xyXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCB0YWdzLnFkdXAsIDEgKTtcclxuICAgICAgICB2YXIgbm9kZUlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoICdpZCcgKTtcclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggJ2lkJyApO1xyXG4gICAgICAgIHZhciBub2RlRGF0YUlkID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhZ3MuaWQgKTtcclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggdGFncy5pZCApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBuZXh0U2libGluZ0RhdGEgPSBwcm9jZXNzTG9vcE5leHRTaWJsaW5nKCBub2RlICk7XHJcbiAgICAgICAgdmFyIG5leHRTaWJsaW5nID0gbmV4dFNpYmxpbmdEYXRhLm5leHRTaWJsaW5nO1xyXG4gICAgICAgIGxvb3Auc2V0T2Zmc2V0KCBuZXh0U2libGluZ0RhdGEuY291bnRlciApO1xyXG4gICAgICAgIC8vbG9nLndhcm4oICdsb29wIGNvdW50ZXI6ICcgKyBuZXh0U2libGluZ0RhdGEuY291bnRlciApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBhdXRvRGVmaW5lSGVscGVyO1xyXG4gICAgICAgIHdoaWxlICggYXV0b0RlZmluZUhlbHBlciA9IGxvb3AucmVwZWF0KCkgKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBzY29wZS5zdGFydEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIENsb25lIGFuZCBjb25maWd1cmUgdGhlIG5vZGVcclxuICAgICAgICAgICAgdmFyIHRtcE5vZGUgPSBQYXJzZXJOb2RlUmVuZGVyZXIuY2xvbmVBbmRDb25maWd1cmVOb2RlKCBub2RlLCBpbmRleEV4cHJlc3Npb25zLCB0YWdzLCBub2RlRGF0YUlkICk7XHJcblxyXG4gICAgICAgICAgICAvLyBJbnNlcnQgaXRcclxuICAgICAgICAgICAgdmFyIHBhcmVudE5vZGUgPSBub2RlLnBhcmVudE5vZGU7XHJcbiAgICAgICAgICAgIHBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKCB0bXBOb2RlLCBuZXh0U2libGluZyApO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgLy8gUHJvY2VzcyBpdFxyXG4gICAgICAgICAgICBpZiAoICEgcHJvY2Vzc0VsZW1lbnQoIHRtcE5vZGUsIGF0dHJpYnV0ZXMsIGF1dG9EZWZpbmVIZWxwZXIgKSApIHtcclxuICAgICAgICAgICAgICAgIHNjb3BlLmVuZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgc2NvcGUuZW5kRWxlbWVudCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gQ29uZmlndXJlIHJlcGVhdCBub2RlICh0aGUgb3JpZ2luYWwpIHRvIGVuYWJsZSBmdXR1cmUgcmVldmFsdWF0aW9uXHJcbiAgICAgICAgbm9kZS5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xyXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCB0YWdzLnRhbFJlcGVhdCwgYXR0cmlidXRlcy50YWxSZXBlYXQgKTtcclxuICAgICAgICBpZiAoIG5vZGVJZCAhPT0gJycgJiYgbm9kZUlkICE9IG51bGwgKXtcclxuICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoICdpZCcsIG5vZGVJZCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBpZiAoIG5vZGVEYXRhSWQgIT09ICcnICYmIG5vZGVEYXRhSWQgIT0gbnVsbCApe1xyXG4gICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggdGFncy5pZCwgbm9kZURhdGFJZCApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggdGFncy5xZHVwICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB0cmVhdEVycm9yID0gZnVuY3Rpb24oIG5vZGUsIGV4Y2VwdGlvbiApIHtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgLy8gU2V0IHRoZSBlcnJvciB2YXJpYWJsZVxyXG4gICAgICAgICAgICB2YXIgdGVtcGxhdGVFcnJvciA9IHtcclxuICAgICAgICAgICAgICAgIHR5cGU6IGV4Y2VwdGlvbi5uYW1lLFxyXG4gICAgICAgICAgICAgICAgdmFsdWU6IGV4Y2VwdGlvbi5tZXNzYWdlLFxyXG4gICAgICAgICAgICAgICAgdHJhY2ViYWNrOiBleGNlcHRpb24uc3RhY2tcclxuICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgc2NvcGUuc2V0KCBcclxuICAgICAgICAgICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLnRlbXBsYXRlRXJyb3JWYXJOYW1lLCBcclxuICAgICAgICAgICAgICAgIHRlbXBsYXRlRXJyb3IgXHJcbiAgICAgICAgICAgICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBFeGl0IGlmIHRoZXJlIGlzIG5vIG9uLWVycm9yIGV4cHJlc3Npb24gZGVmaW5lZFxyXG4gICAgICAgICAgICB2YXIgY29udGVudCA9IHNjb3BlLmdldCggY29udGV4dC5nZXRDb25mKCkub25FcnJvclZhck5hbWUgKTtcclxuICAgICAgICAgICAgaWYgKCBjb250ZW50ID09IG51bGwgKSB7XHJcbiAgICAgICAgICAgICAgICBsb2cuZmF0YWwoIGV4Y2VwdGlvbiApO1xyXG4gICAgICAgICAgICAgICAgc2NvcGUuZW5kRWxlbWVudCgpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBsb2cuZXJyb3IoIGV4Y2VwdGlvbiApO1xyXG4gICAgICAgICAgICBzY29wZS5lbmRFbGVtZW50KCk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBjb250ZW50SGVscGVyLnVwZGF0ZU5vZGUoIFxyXG4gICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICBzY29wZS5nZXQoIGNvbnRleHQuZ2V0Q29uZigpLm9uRXJyb3JTdHJ1Y3R1cmVWYXJOYW1lICksIFxyXG4gICAgICAgICAgICAgICAgY29udGVudCBcclxuICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIHJldHVybiBjb250ZW50O1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGNhdGNoICggZSApIHtcclxuICAgICAgICAgICAgbG9nLmZhdGFsKCBlICk7XHJcbiAgICAgICAgICAgIHNjb3BlLmVuZEVsZW1lbnQoKTtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc0VsZW1lbnQgPSBmdW5jdGlvbiggbm9kZSwgYXR0cmlidXRlcywgX2F1dG9EZWZpbmVIZWxwZXIgKSB7XHJcblxyXG4gICAgICAgIC8vIElmIGl0IGlzIGRlZmluZWQgYSBtZXRhbEZpbGxTbG90IG9yIGEgbWV0YWxEZWZpbmVNYWNybyBkbyBub3RoaW5nXHJcbiAgICAgICAgaWYgKCBhdHRyaWJ1dGVzLm1ldGFsRmlsbFNsb3QgfHwgISBwcm9jZXNzTUVUQUxEZWZpbmVNYWNybyhcclxuICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMubWV0YWxEZWZpbmVNYWNybyBcclxuICAgICAgICApICkge1xyXG4gICAgICAgICAgICAvLyBTdG9wIHByb2Nlc3NpbmcgdGhlIHJlc3Qgb2YgdGhpcyBub2RlIGFzIGl0IGlzIGludmlzaWJsZVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBhdXRvRGVmaW5lSGVscGVyID0gX2F1dG9EZWZpbmVIZWxwZXIgfHwgbmV3IEF1dG9EZWZpbmVIZWxwZXIoIG5vZGUgKTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoICEgcHJvY2Vzc0RlY2xhcmUoIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbERlY2xhcmUsXHJcbiAgICAgICAgICAgIGF1dG9EZWZpbmVIZWxwZXJcclxuICAgICAgICApICkge1xyXG4gICAgICAgICAgICAvLyBTdG9wIHByb2Nlc3NpbmcgdGhlIHJlc3Qgb2YgdGhpcyBub2RlIGFzIGl0IGlzIGludmlzaWJsZVxyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHByb2Nlc3NPbkVycm9yKCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlcy50YWxPbkVycm9yLFxyXG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBwcm9jZXNzSTE4bkxhbmd1YWdlKCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgYXR0cmlidXRlcy5pMThuTGFuZ3VhZ2UsXHJcbiAgICAgICAgICAgIGF1dG9EZWZpbmVIZWxwZXJcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHByb2Nlc3NJMThuRG9tYWluKFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBhdHRyaWJ1dGVzLmkxOG5Eb21haW4sIFxyXG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBwcm9jZXNzQXV0b0RlZmluZSggXHJcbiAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICBhdXRvRGVmaW5lSGVscGVyXHJcbiAgICAgICAgKTtcclxuICAgICAgICBcclxuICAgICAgICBQYXJzZXJOb2RlUmVuZGVyZXIucHJvY2Vzc0RlZmluZSggXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsRGVmaW5lLCAgXHJcbiAgICAgICAgICAgIGZhbHNlLFxyXG4gICAgICAgICAgICBzY29wZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9uc1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHByb2Nlc3NDb25kaXRpb24oXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsQ29uZGl0aW9uIFxyXG4gICAgICAgICkgKSB7XHJcbiAgICAgICAgICAgIC8vIFN0b3AgcHJvY2Vzc2luZyB0aGUgcmVzdCBvZiB0aGlzIG5vZGUgYXMgaXQgaXMgaW52aXNpYmxlXHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBvbWl0dGVkVGFnID0gcHJvY2Vzc09taXRUYWcoXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMudGFsT21pdFRhZyBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICB2YXIgcmVwbGFjZWQgPSBwcm9jZXNzUmVwbGFjZShcclxuICAgICAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlcy50YWxSZXBsYWNlIFxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGlmICggISBvbWl0dGVkVGFnICYmICEgcmVwbGFjZWQgKSB7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBwcm9jZXNzQXR0cmlidXRlcyhcclxuICAgICAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbEF0dHJpYnV0ZXMgXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBpZiAoICEgcHJvY2Vzc0NvbnRlbnQoXHJcbiAgICAgICAgICAgICAgICAgICAgbm9kZSwgXHJcbiAgICAgICAgICAgICAgICAgICAgYXR0cmlidXRlcy50YWxDb250ZW50ICkgKSB7XHJcblxyXG4gICAgICAgICAgICAgICAgZGVmYXVsdENvbnRlbnQoIG5vZGUgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgcHJvY2Vzc01FVEFMVXNlTWFjcm8oXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZXMubWV0YWxVc2VNYWNybywgXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVzLnRhbERlZmluZSxcclxuICAgICAgICAgICAgICAgIGF1dG9EZWZpbmVIZWxwZXJcclxuICAgICAgICApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgZGVmYXVsdENvbnRlbnQgPSBmdW5jdGlvbiggbm9kZSApIHtcclxuXHJcbiAgICAgICAgdmFyIGNoaWxkTm9kZXMgPSBub2RlLmNoaWxkTm9kZXM7XHJcbiAgICAgICAgaWYgKCAhIGNoaWxkTm9kZXMgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGNoaWxkTm9kZXMubGVuZ3RoOyBpKysgKSB7XHJcbiAgICAgICAgICAgIHZhciBjdXJyZW50Q2hpbGROb2RlID0gY2hpbGROb2Rlc1sgaSBdO1xyXG5cclxuICAgICAgICAgICAgLy8gQ2hlY2sgaWYgbm9kZSBpcyBFTEVNRU5UX05PREUgYW5kIG5vdCBwYXJzZWQgeWV0XHJcbiAgICAgICAgICAgIGlmICggY3VycmVudENoaWxkTm9kZSAmJiBjdXJyZW50Q2hpbGROb2RlLm5vZGVUeXBlID09PSAxXHJcbiAgICAgICAgICAgICAgICAgICAgJiYgISBjdXJyZW50Q2hpbGROb2RlLmdldEF0dHJpYnV0ZSggdGFncy5xZHVwICkgKSB7XHJcbiAgICAgICAgICAgICAgICBwcm9jZXNzKCBjdXJyZW50Q2hpbGROb2RlICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc09uRXJyb3IgPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nLCBhdXRvRGVmaW5lSGVscGVyICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGFsT25FcnJvciA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxPbkVycm9yLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxPbkVycm9yLnB1dFRvQXV0b0RlZmluZUhlbHBlciggYXV0b0RlZmluZUhlbHBlciApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NBdXRvRGVmaW5lID0gZnVuY3Rpb24oIG5vZGUsIGF1dG9EZWZpbmVIZWxwZXIgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHN0cmluZyA9IGF1dG9EZWZpbmVIZWxwZXIudXBkYXRlTm9kZSggbm9kZSApO1xyXG4gICAgICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHRhbERlZmluZSA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxEZWZpbmUsIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbERlZmluZS5wcm9jZXNzKCBzY29wZSwgZmFsc2UgKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NJMThuRG9tYWluID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZywgYXV0b0RlZmluZUhlbHBlciApIHtcclxuXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApIHtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIGkxOG5Eb21haW4gPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgSTE4TkRvbWFpbiwgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gaTE4bkRvbWFpbi5wdXRUb0F1dG9EZWZpbmVIZWxwZXIoIHNjb3BlLCBhdXRvRGVmaW5lSGVscGVyICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc0kxOG5MYW5ndWFnZSA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcsIGF1dG9EZWZpbmVIZWxwZXIgKSB7XHJcblxyXG4gICAgICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciBpMThuTGFuZ3VhZ2UgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgSTE4Tkxhbmd1YWdlLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiBpMThuTGFuZ3VhZ2UucHV0VG9BdXRvRGVmaW5lSGVscGVyKCBhdXRvRGVmaW5lSGVscGVyICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc0RlY2xhcmUgPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nLCBhdXRvRGVmaW5lSGVscGVyICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0YWxEZWNsYXJlID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIFRBTERlY2xhcmUsIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbERlY2xhcmUucHJvY2Vzcyggc2NvcGUsIGF1dG9EZWZpbmVIZWxwZXIgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzTUVUQUxEZWZpbmVNYWNybyA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcgKSB7XHJcblxyXG4gICAgICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0cnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgLy8gTm8gc2Vuc2UgdG8gY2FjaGUgbWFjcm8gZGVmaW5pdGlvbnMhXHJcbiAgICAgICAgdmFyIG1ldGFsRGVmaW5lTWFjcm8gPSBNRVRBTERlZmluZU1hY3JvLmJ1aWxkKCBzdHJpbmcgKTtcclxuICAgICAgICByZXR1cm4gbWV0YWxEZWZpbmVNYWNyby5wcm9jZXNzKCBzY29wZSwgbm9kZSApO1xyXG4gICAgfTtcclxuXHJcbiAgICB2YXIgcHJvY2Vzc01FVEFMVXNlTWFjcm8gPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nLCBzdHJpbmdEZWZpbmUsIGF1dG9EZWZpbmVIZWxwZXIgKSB7XHJcblxyXG4gICAgICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gTm8gc2Vuc2UgdG8gY2FjaGUgbWFjcm8gdXNlcyFcclxuICAgICAgICB2YXIgbWV0YWxVc2VNYWNybyA9IE1FVEFMVXNlTWFjcm8uYnVpbGQoIHN0cmluZywgc3RyaW5nRGVmaW5lLCBzY29wZSApO1xyXG4gICAgICAgIHZhciBuZXdOb2RlID0gbWV0YWxVc2VNYWNyby5wcm9jZXNzKCBzY29wZSwgbm9kZSwgYXV0b0RlZmluZUhlbHBlciwgaW5kZXhFeHByZXNzaW9ucyApO1xyXG4gICAgICAgIG5ld05vZGUuc2V0QXR0cmlidXRlKCB0YWdzLnFkdXAsIDEgKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJbmRleCBub2RlXHJcbiAgICAgICAgaWYgKCBpbmRleEV4cHJlc3Npb25zICl7XHJcbiAgICAgICAgICAgIGF0dHJpYnV0ZUluZGV4LmFkZCggbm9kZSwgbWV0YWxVc2VNYWNybywgc2NvcGUgKTtcclxuICAgICAgICB9XHJcbiAgICBcclxuICAgICAgICAvLyBQcm9jZXNzIG5ldyBub2RlXHJcbiAgICAgICAgcmV0dXJuIHByb2Nlc3MoIG5ld05vZGUgKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NDb25kaXRpb24gPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0YWxDb25kaXRpb24gPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMQ29uZGl0aW9uLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGVcclxuICAgICAgICApO1xyXG4gICAgICAgIHJldHVybiB0YWxDb25kaXRpb24ucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzUmVwbGFjZSA9IGZ1bmN0aW9uKCBub2RlLCBzdHJpbmcgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIHN0cmluZyApe1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciB0YWxSZXBsYWNlID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIFRBTFJlcGxhY2UsIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbFJlcGxhY2UucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NPbWl0VGFnID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZyApIHtcclxuXHJcbiAgICAgICAgaWYgKCBzdHJpbmcgPT0gbnVsbCApIHtcclxuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdmFyIHRhbE9taXRUYWcgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICAgICAgVEFMT21pdFRhZywgXHJcbiAgICAgICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgICAgIG5vZGUsXHJcbiAgICAgICAgICAgIGluZGV4RXhwcmVzc2lvbnMsXHJcbiAgICAgICAgICAgIHNjb3BlXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdGFsT21pdFRhZy5wcm9jZXNzKCBzY29wZSwgbm9kZSwgc2VsZiApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHByb2Nlc3NDb250ZW50ID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZyApIHtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoICEgc3RyaW5nICl7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHZhciB0YWxDb250ZW50ID0gYXR0cmlidXRlQ2FjaGUuZ2V0QnlBdHRyaWJ1dGVDbGFzcyggXHJcbiAgICAgICAgICAgIFRBTENvbnRlbnQsIFxyXG4gICAgICAgICAgICBzdHJpbmcsIFxyXG4gICAgICAgICAgICBub2RlLFxyXG4gICAgICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgICAgICBzY29wZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIHRhbENvbnRlbnQucHJvY2Vzcyggc2NvcGUsIG5vZGUgKTtcclxuICAgIH07XHJcbiAgXHJcbiAgICB2YXIgcHJvY2Vzc0F0dHJpYnV0ZXMgPSBmdW5jdGlvbiggbm9kZSwgc3RyaW5nICkge1xyXG5cclxuICAgICAgICBpZiAoICEgc3RyaW5nICkge1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB2YXIgdGFsQXR0cmlidXRlcyA9IGF0dHJpYnV0ZUNhY2hlLmdldEJ5QXR0cmlidXRlQ2xhc3MoIFxyXG4gICAgICAgICAgICBUQUxBdHRyaWJ1dGVzLCBcclxuICAgICAgICAgICAgc3RyaW5nLCBcclxuICAgICAgICAgICAgbm9kZSxcclxuICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9ucyxcclxuICAgICAgICAgICAgc2NvcGUgXHJcbiAgICAgICAgKTtcclxuICAgICAgICByZXR1cm4gdGFsQXR0cmlidXRlcy5wcm9jZXNzKCBzY29wZSwgbm9kZSApO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHNlbGYgPSB7XHJcbiAgICAgICAgcnVuOiBydW4sXHJcbiAgICAgICAgZGVmYXVsdENvbnRlbnQ6IGRlZmF1bHRDb250ZW50XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufTtcclxuXHJcblBhcnNlck5vZGVSZW5kZXJlci5wcm9jZXNzRGVmaW5lID0gZnVuY3Rpb24oIG5vZGUsIHN0cmluZywgZm9yY2VHbG9iYWwsIHNjb3BlLCBpbmRleEV4cHJlc3Npb25zICkge1xyXG5cclxuICAgIGlmICggISBzdHJpbmcgKSB7XHJcbiAgICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIHZhciB0YWxEZWZpbmUgPSBhdHRyaWJ1dGVDYWNoZS5nZXRCeUF0dHJpYnV0ZUNsYXNzKCBcclxuICAgICAgICBUQUxEZWZpbmUsIFxyXG4gICAgICAgIHN0cmluZywgXHJcbiAgICAgICAgbm9kZSxcclxuICAgICAgICBpbmRleEV4cHJlc3Npb25zLFxyXG4gICAgICAgIHNjb3BlXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIHRhbERlZmluZS5wcm9jZXNzKCBzY29wZSwgZm9yY2VHbG9iYWwgKTtcclxufTtcclxuXHJcblBhcnNlck5vZGVSZW5kZXJlci5jbG9uZUFuZENvbmZpZ3VyZU5vZGUgPSBmdW5jdGlvbiggbm9kZSwgaW5kZXhFeHByZXNzaW9ucywgdGFncywgbm9kZURhdGFJZCApIHtcclxuICAgIFxyXG4gICAgLy8gQ2xvbmUgbm9kZVxyXG4gICAgdmFyIHRtcE5vZGUgPSBub2RlLmNsb25lTm9kZSggdHJ1ZSApO1xyXG4gICAgaWYgKCAnZm9ybScgaW4gdG1wTm9kZSApIHtcclxuICAgICAgICB0bXBOb2RlLmNoZWNrZWQgPSBmYWxzZTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBTZXQgaWQgYW5kIHJlbGF0ZWQgaWQgaWYgbmVlZGVkXHJcbiAgICBpZiAoIGluZGV4RXhwcmVzc2lvbnMgKXtcclxuICAgICAgICB0bXBOb2RlLnNldEF0dHJpYnV0ZSggdGFncy5pZCwgY29udGV4dC5uZXh0RXhwcmVzc2lvbkNvdW50ZXIoKSApO1xyXG4gICAgICAgIHRtcE5vZGUuc2V0QXR0cmlidXRlKCB0YWdzLnJlbGF0ZWRJZCwgbm9kZURhdGFJZCApO1xyXG4gICAgfVxyXG4gICAgXHJcbiAgICByZXR1cm4gdG1wTm9kZTtcclxufTtcclxuXHJcblBhcnNlck5vZGVSZW5kZXJlci5jb25maWd1cmVOb2RlRm9yTmV3SXRlbSA9IGZ1bmN0aW9uKCB0bXBOb2RlLCB0YWdzLCBwYXJlbnROb2RlLCBpbmRleEl0ZW0sIGluZGV4VG9Vc2UgKSB7XHJcbiAgICBcclxuICAgIC8vIFJlbW92ZSBhdHRyaWJ1dGVzXHJcbiAgICB0bXBOb2RlLnJlbW92ZUF0dHJpYnV0ZSggdGFncy50YWxSZXBlYXQgKTtcclxuICAgIHRtcE5vZGUucmVtb3ZlQXR0cmlidXRlKCAnc3R5bGUnICk7XHJcbiAgICB0bXBOb2RlLnNldEF0dHJpYnV0ZSggdGFncy5xZHVwLCAxICk7XHJcbiAgICBcclxuICAgIC8vIENvbmZpZ3VyZSBsb29wIGF0dHJpYnV0ZXNcclxuICAgIExvb3Auc2V0QXV0b0RlZmluZUF0dHJpYnV0ZSggXHJcbiAgICAgICAgdG1wTm9kZSwgXHJcbiAgICAgICAgaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlLmdldFZhck5hbWUoKSwgXHJcbiAgICAgICAgaW5kZXhUb1VzZSxcclxuICAgICAgICBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UuZ2V0RXhwcmVzc2lvblN0cmluZygpLCBcclxuICAgICAgICBwYXJlbnROb2RlLmNoaWxkRWxlbWVudENvdW50LCBcclxuICAgICAgICAwXHJcbiAgICApO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQYXJzZXJOb2RlUmVuZGVyZXI7XHJcbiIsIi8qIFxyXG4gICAgQ2xhc3MgUGFyc2VyUHJlbG9hZGVyXHJcbiovXHJcblwidXNlIHN0cmljdFwiO1xyXG5cclxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcclxudmFyIGxvZyA9IHJlcXVpcmUoICcuLi9sb2dIZWxwZXIuanMnICk7XHJcbnZhciBub2RlUmVtb3ZlciA9IHJlcXVpcmUoICcuL25vZGVSZW1vdmVyLmpzJyApO1xyXG52YXIgU2NvcGUgPSByZXF1aXJlKCAnLi4vc2NvcGVzL3Njb3BlLmpzJyApO1xyXG52YXIgaTE4bkhlbHBlciA9IHJlcXVpcmUoICcuLi9pMThuL2kxOG5IZWxwZXIuanMnICk7XHJcbnZhciByZXNvbHZlciA9IHJlcXVpcmUoICcuLi9yZXNvbHZlci5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUluZGV4ID0gcmVxdWlyZSggJy4uL2F0dHJpYnV0ZXMvYXR0cmlidXRlSW5kZXguanMnICk7XHJcblxyXG52YXIgUGFyc2VyUHJlbG9hZGVyID0gZnVuY3Rpb24oIF9wYXJzZXJPcHRpb25zLCBfY2FsbGJhY2ssIF9mYWlsQ2FsbGJhY2ssIF9kZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLCBfaTE4biwgX25vdFJlbW92ZUdlbmVyYXRlZFRhZ3MsIF9tYXhGb2xkZXJEaWN0aW9uYXJpZXMgKSB7XHJcbiAgICBcclxuICAgIHZhciBwYXJzZXJPcHRpb25zID0gX3BhcnNlck9wdGlvbnM7XHJcbiAgICB2YXIgY2FsbGJhY2sgPSBfY2FsbGJhY2s7XHJcbiAgICB2YXIgZmFpbENhbGxiYWNrID0gX2ZhaWxDYWxsYmFjaztcclxuICAgIHZhciBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzID0gX2RlY2xhcmVkUmVtb3RlUGFnZVVybHM7XHJcbiAgICB2YXIgaTE4biA9IF9pMThuO1xyXG4gICAgdmFyIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MgPSBfbm90UmVtb3ZlR2VuZXJhdGVkVGFncztcclxuICAgIHZhciBtYXhGb2xkZXJEaWN0aW9uYXJpZXMgPSBfbWF4Rm9sZGVyRGljdGlvbmFyaWVzO1xyXG4gICAgXHJcbiAgICB2YXIgcnVuID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKCAhIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MgKXtcclxuICAgICAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZUdlbmVyYXRlZE5vZGVzKCBwYXJzZXJPcHRpb25zLnJvb3QgKTtcclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVJbmRleC5yZW1vdmVNdWx0aXBsZU5vZGVzKFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZUdlbmVyYXRlZE5vZGVzKCBwYXJzZXJPcHRpb25zLnJvb3QgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHZhciBzY29wZSA9IG5ldyBTY29wZSggXHJcbiAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnksIFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5RXh0ZW5zaW9uLCBcclxuICAgICAgICAgICAgICAgIHRydWUgXHJcbiAgICAgICAgICAgICk7XHJcblxyXG4gICAgICAgICAgICBzY29wZS5sb2FkRm9sZGVyRGljdGlvbmFyaWVzQXN5bmMoIFxyXG4gICAgICAgICAgICAgICAgbWF4Rm9sZGVyRGljdGlvbmFyaWVzLCBcclxuICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbixcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5zZXRGb2xkZXJEaWN0aW9uYXJpZXMoIHNjb3BlLmZvbGRlckRpY3Rpb25hcmllcyApO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpMThuSGVscGVyLmxvYWRBc3luY0F1dG8oIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGkxOG4sXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXNvbHZlci5sb2FkUmVtb3RlUGFnZXMoIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNjb3BlLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRlY2xhcmVkUmVtb3RlUGFnZVVybHMsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2ssXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmFpbENhbGxiYWNrXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgICAgICAgICBmYWlsQ2FsbGJhY2tcclxuICAgICAgICAgICAgICAgICAgICApO1xyXG4gICAgICAgICAgICAgICAgfSBcclxuICAgICAgICAgICAgKTtcclxuXHJcbiAgICAgICAgfSBjYXRjaCggZSApe1xyXG4gICAgICAgICAgICBsb2cuZmF0YWwoICdFeGl0aW5nIGluaXQgbWV0aG9kIG9mIFpQVCB3aXRoIGVycm9yczogJyArIGUgKTtcclxuICAgICAgICAgICAgdGhyb3cgZTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIFxyXG4gICAgdmFyIHNlbGYgPSB7XHJcbiAgICAgICAgcnVuOiBydW5cclxuICAgIH07XHJcbiAgICBcclxuICAgIHJldHVybiBzZWxmO1xyXG59O1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBQYXJzZXJQcmVsb2FkZXI7XHJcbiIsIi8qIFxyXG4gICAgQ2xhc3MgUGFyc2VyUmVuZGVyZXJcclxuKi9cclxuXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuLi9jb250ZXh0LmpzJyApO1xyXG52YXIgbG9nID0gcmVxdWlyZSggJy4uL2xvZ0hlbHBlci5qcycgKTtcclxudmFyIGF0dHJpYnV0ZUNhY2hlID0gcmVxdWlyZSggJy4uL2NhY2hlL2F0dHJpYnV0ZUNhY2hlLmpzJyApO1xyXG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9hdHRyaWJ1dGVJbmRleC5qcycgKTtcclxudmFyIG5vZGVSZW1vdmVyID0gcmVxdWlyZSggJy4vbm9kZVJlbW92ZXIuanMnICk7XHJcbnZhciBzY29wZUJ1aWxkZXIgPSByZXF1aXJlKCAnLi4vc2NvcGVzL3Njb3BlQnVpbGRlci5qcycgKTtcclxudmFyIFBhcnNlck5vZGVSZW5kZXJlciA9IHJlcXVpcmUoICcuL3BhcnNlck5vZGVSZW5kZXJlci5qcycgKTtcclxuXHJcbnZhciBQYXJzZXJSZW5kZXJlciA9IGZ1bmN0aW9uKCBfcGFyc2VyT3B0aW9ucywgX3RhcmdldCwgX2RpY3Rpb25hcnlFeHRlbnNpb24sIF9ub3RSZW1vdmVHZW5lcmF0ZWRUYWdzLCBfcmVzZXRJbmRleCwgX2dvVG9VUkxIYXNoICkge1xyXG4gICAgXHJcbiAgICB2YXIgcGFyc2VyT3B0aW9ucyA9IF9wYXJzZXJPcHRpb25zO1xyXG4gICAgdmFyIHRhcmdldCA9IF90YXJnZXQ7XHJcbiAgICB2YXIgZGljdGlvbmFyeUV4dGVuc2lvbiA9IF9kaWN0aW9uYXJ5RXh0ZW5zaW9uO1xyXG4gICAgdmFyIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MgPSBfbm90UmVtb3ZlR2VuZXJhdGVkVGFncztcclxuICAgIHZhciByZXNldEluZGV4ID0gX3Jlc2V0SW5kZXg7XHJcbiAgICB2YXIgZ29Ub1VSTEhhc2ggPSBfZ29Ub1VSTEhhc2g7XHJcbiAgICBcclxuICAgIHZhciBydW4gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIHByb2Nlc3MoKTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBwcm9jZXNzID0gZnVuY3Rpb24oKXtcclxuXHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgaWYgKCAhIHRhcmdldCApe1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgJ1VuYWJsZSB0byBwcm9jZXNzIG51bGwgcm9vdCBvciB0YXJnZXQhJztcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCAhIG5vdFJlbW92ZUdlbmVyYXRlZFRhZ3MgKXtcclxuICAgICAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZUdlbmVyYXRlZE5vZGVzKCB0YXJnZXQgKTtcclxuICAgICAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgICAgICBhdHRyaWJ1dGVJbmRleC5yZW1vdmVNdWx0aXBsZU5vZGVzKFxyXG4gICAgICAgICAgICAgICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZUdlbmVyYXRlZE5vZGVzKCB0YXJnZXQgKVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgICAgICovXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmICggcmVzZXRJbmRleCApe1xyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5kZXgucmVzZXQoKTtcclxuICAgICAgICAgICAgICAgIGF0dHJpYnV0ZUNhY2hlLnJlc2V0KCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHByb2Nlc3NBbGxUYXJnZXRFbGVtZW50cygpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKCBnb1RvVVJMSGFzaCApe1xyXG4gICAgICAgICAgICAgICAgcHJvY2Vzc0dvVG9VUkxIYXNoKCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgfSBjYXRjaCggZSApe1xyXG4gICAgICAgICAgICBsb2cuZmF0YWwoICdFeGl0aW5nIHJ1biBtZXRob2Qgb2YgWlBUIHdpdGggZXJyb3JzOiAnICsgZSApO1xyXG4gICAgICAgICAgICBjb250ZXh0LmVycm9yRnVuY3Rpb24oIGUgKTtcclxuICAgICAgICAgICAgLy90aHJvdyBlO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHByb2Nlc3NBbGxUYXJnZXRFbGVtZW50cyA9IGZ1bmN0aW9uKCkge1xyXG5cclxuICAgICAgICAvLyBJcyBtdWx0aXJvb3Q/XHJcbiAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCB0YXJnZXQgKSApeyBcclxuICAgICAgICAgICAgLy8gVGhlcmUgYXJlIHNldmVyYWwgcm9vdHNcclxuICAgICAgICAgICAgZm9yICggdmFyIGMgPSAwOyBjIDwgdGFyZ2V0Lmxlbmd0aDsgYysrICkge1xyXG4gICAgICAgICAgICAgICAgcHJvY2VzczFUYXJnZXQoIHRhcmdldFsgYyBdICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAvLyBUaGVyZSBpcyBvbmx5IG9uZSByb290XHJcbiAgICAgICAgICAgIHByb2Nlc3MxVGFyZ2V0KCB0YXJnZXQgKTtcclxuICAgICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBwcm9jZXNzMVRhcmdldCA9IGZ1bmN0aW9uKCBjdXJyZW50VGFyZ2V0ICkge1xyXG5cclxuICAgICAgICB2YXIgcGFyc2VyTm9kZVJlbmRlcmVyID0gbmV3IFBhcnNlck5vZGVSZW5kZXJlciggXHJcbiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXQsIFxyXG4gICAgICAgICAgICBzY29wZUJ1aWxkZXIuYnVpbGQoIFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucywgXHJcbiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0LCBcclxuICAgICAgICAgICAgICAgIGRpY3Rpb25hcnlFeHRlbnNpb24sXHJcbiAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLmNvbW1hbmQgPT09ICdwYXJ0aWFsUmVuZGVyJ1xyXG4gICAgICAgICAgICApLFxyXG4gICAgICAgICAgICBwYXJzZXJPcHRpb25zLmluZGV4RXhwcmVzc2lvbnNcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBwYXJzZXJOb2RlUmVuZGVyZXIucnVuKCk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgcHJvY2Vzc0dvVG9VUkxIYXNoID0gZnVuY3Rpb24oKXtcclxuICAgICAgICBcclxuICAgICAgICB2YXIgaWQgPSBkZWNvZGVVUkkoIHdpbmRvdy5sb2NhdGlvbi5oYXNoICkuc3Vic3RyKCAxICk7XHJcbiAgICAgICAgaWYgKCAhIGlkICl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGVsZW1lbnQgPSB3aW5kb3cuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoIGlkICk7XHJcbiAgICAgICAgaWYgKCAhIGVsZW1lbnQgKXtcclxuICAgICAgICAgICAgbG9nLndhcm4oICdVbmFibGUgdG8gZ28gdG8gVVJMIGhhc2guIEVsZW1lbnQgd2l0aCBpZCBcIicgKyBpZCArICdcIiBub3QgZm91bmQhJyApO1xyXG4gICAgICAgICAgICByZXR1cm47XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBHbyB0byBoYXNoXHJcbiAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnIycgKyBpZDtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJ1bjogcnVuXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGFyc2VyUmVuZGVyZXI7XHJcbiIsIi8qIFxyXG4gICAgQ2xhc3MgUGFyc2VyVXBkYXRlclxyXG4qL1xyXG5cInVzZSBzdHJpY3RcIjtcclxuXHJcbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XHJcbnZhciBsb2cgPSByZXF1aXJlKCAnLi4vbG9nSGVscGVyLmpzJyApO1xyXG52YXIgYXR0cmlidXRlSW5kZXggPSByZXF1aXJlKCAnLi4vYXR0cmlidXRlcy9hdHRyaWJ1dGVJbmRleC5qcycgKTtcclxudmFyIHNjb3BlQnVpbGRlciA9IHJlcXVpcmUoICcuLi9zY29wZXMvc2NvcGVCdWlsZGVyLmpzJyApO1xyXG52YXIgUGFyc2VyTm9kZVJlbmRlcmVyID0gcmVxdWlyZSggJy4vcGFyc2VyTm9kZVJlbmRlcmVyLmpzJyApO1xyXG52YXIgbm9kZVJlbW92ZXIgPSByZXF1aXJlKCAnLi9ub2RlUmVtb3Zlci5qcycgKTtcclxudmFyIHV0aWxzID0gcmVxdWlyZSggJy4uL3V0aWxzLmpzJyApO1xyXG52YXIgZGljdGlvbmFyeUFjdGlvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9kaWN0aW9uYXJ5QWN0aW9ucy9kaWN0aW9uYXJ5QWN0aW9uQnVpbGRlci5qcycgKTtcclxudmFyIEFic3RyYWN0QXJyYXlBY3Rpb24gPSByZXF1aXJlKCAnLi9kaWN0aW9uYXJ5QWN0aW9ucy9hYnN0cmFjdEFycmF5QWN0aW9uLmpzJyApO1xyXG5cclxudmFyIFBhcnNlclVwZGF0ZXIgPSBmdW5jdGlvbiggX2RpY3Rpb25hcnlDaGFuZ2VzLCBfZGljdGlvbmFyeUFjdGlvbnMsIF9wYXJzZXJPcHRpb25zICkge1xyXG4gICAgXHJcbiAgICB2YXIgZGljdGlvbmFyeUNoYW5nZXMgPSBfZGljdGlvbmFyeUNoYW5nZXM7XHJcbiAgICB2YXIgZGljdGlvbmFyeUFjdGlvbnMgPSBfZGljdGlvbmFyeUFjdGlvbnM7XHJcbiAgICB2YXIgcGFyc2VyT3B0aW9ucyA9IF9wYXJzZXJPcHRpb25zO1xyXG4gICAgXHJcbiAgICB2YXIgc2NvcGVNYXAgPSB7fTtcclxuICAgIHZhciBub2RlQXR0cmlidXRlcywgXHJcbiAgICAgICAgc3RhdGlzdGljcztcclxuICAgIHZhciBkaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcztcclxuICAgIFxyXG4gICAgdmFyIGluaXRpYWxpemVEaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgZGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMgPSBbXTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoICEgZGljdGlvbmFyeUFjdGlvbnMgKXtcclxuICAgICAgICAgICAgcmV0dXJuO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBkaWN0aW9uYXJ5QWN0aW9ucy5sZW5ndGg7ICsraSApe1xyXG4gICAgICAgICAgICB2YXIgYWN0aW9uID0gZGljdGlvbmFyeUFjdGlvbnNbIGkgXTtcclxuICAgICAgICAgICAgdmFyIG5ld0FjdGlvbkluc3RhbmNlID0gZGljdGlvbmFyeUFjdGlvbkJ1aWxkZXIuYnVpbGQoIGFjdGlvbiwgcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5ICk7XHJcbiAgICAgICAgICAgIGlmICggQXJyYXkuaXNBcnJheSggbmV3QWN0aW9uSW5zdGFuY2UgKSApe1xyXG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeUFjdGlvbnNJbnN0YW5jZXMgPSBkaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcy5jb25jYXQoIG5ld0FjdGlvbkluc3RhbmNlICk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBkaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcy5wdXNoKCBuZXdBY3Rpb25JbnN0YW5jZSApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIGluaXRpYWxpemVEaWN0aW9uYXJ5QWN0aW9uc0luc3RhbmNlcygpO1xyXG4gICAgXHJcbiAgICB2YXIgZ2V0U3RhdGlzdGljcyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgcmV0dXJuIHN0YXRpc3RpY3M7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciB1cGRhdGVEaWN0aW9uYXJ5Rm9yRGljdGlvbmFyeUNoYW5nZXMgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggZGljdGlvbmFyeUNoYW5nZXMgKXtcclxuICAgICAgICAgICAgdXRpbHMuZXh0ZW5kKCBwYXJzZXJPcHRpb25zLmRpY3Rpb25hcnksIGRpY3Rpb25hcnlDaGFuZ2VzICk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIGFkZFVwZGF0ZWRUb1N0YXRpc3RpY3MgPSBmdW5jdGlvbigpe1xyXG4gICAgICAgICsrc3RhdGlzdGljcy50b3RhbFVwZGF0ZXM7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgYWRkUmVtb3ZlZFRvU3RhdGlzdGljcyA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgKytzdGF0aXN0aWNzLnJlbW92ZWROb2RlVXBkYXRlcztcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciBydW4gPSBmdW5jdGlvbigpe1xyXG4gICAgICAgIFxyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIC8vIENoZWNrIHRoZSBpbmRleCB3YXMgYnVpbHRcclxuICAgICAgICAgICAgaWYgKCAhIHBhcnNlck9wdGlvbnMuaW5kZXhFeHByZXNzaW9ucyApe1xyXG4gICAgICAgICAgICAgICAgdGhyb3cgJ1VuYWJsZSB0byB1cGRhdGUsIG5vIGluZGV4IGJ1aWx0ISBTZXQgaW5kZXhFeHByZXNzaW9ucyB0byB0cnVlISc7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgIC8vIEluaXQgc29tZSB2YXJzXHJcbiAgICAgICAgICAgIG5vZGVBdHRyaWJ1dGVzID0ge307XHJcbiAgICAgICAgICAgIHN0YXRpc3RpY3MgPSB7XHJcbiAgICAgICAgICAgICAgICB0b3RhbFVwZGF0ZXM6IDAsXHJcbiAgICAgICAgICAgICAgICByZW1vdmVkTm9kZVVwZGF0ZXM6IDBcclxuICAgICAgICAgICAgfTtcclxuXHJcbiAgICAgICAgICAgIC8vIERvIGFsbCByZXF1aXJlZCBIVE1MIHVwZGF0ZXNcclxuICAgICAgICAgICAgdXBkYXRlSFRNTCgpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICB9IGNhdGNoKCBlICl7XHJcbiAgICAgICAgICAgIGxvZy5mYXRhbCggJ0V4aXRpbmcgcnVuIG1ldGhvZCBvZiB1cGRhdGUgY29tbWFuZCBvZiBaUFQgd2l0aCBlcnJvcnM6ICcgKyBlICk7XHJcbiAgICAgICAgICAgIGNvbnRleHQuZXJyb3JGdW5jdGlvbiggZSApO1xyXG4gICAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgdmFyIHVwZGF0ZUhUTUwgPSBmdW5jdGlvbigpe1xyXG5cclxuICAgICAgICBpZiAoIHVwZGF0ZUhUTUxGcm9tQWN0aW9ucyggMCApICl7XHJcbiAgICAgICAgICAgIHVwZGF0ZUhUTUxGcm9tVmFyQ2hhbmdlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHVwZGF0ZUhUTUxGcm9tQWN0aW9ucyA9IGZ1bmN0aW9uKCBpbml0aWFsICl7XHJcblxyXG4gICAgICAgIGZvciAoIHZhciBpID0gaW5pdGlhbDsgaSA8IGRpY3Rpb25hcnlBY3Rpb25zSW5zdGFuY2VzLmxlbmd0aDsgKytpICl7XHJcbiAgICAgICAgICAgIHZhciBhY3Rpb25JbnN0YW5jZSA9IGRpY3Rpb25hcnlBY3Rpb25zSW5zdGFuY2VzWyBpIF07XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBVcGRhdGUgZGljdGlvbmFyeSB1c2luZyBhY3Rpb25cclxuICAgICAgICAgICAgYWN0aW9uSW5zdGFuY2UudXBkYXRlRGljdGlvbmFyeSggcGFyc2VyT3B0aW9ucy5kaWN0aW9uYXJ5ICk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBHZXQgdGhlIGxpc3Qgb2YgY2hhbmdlcyByZWxhdGVkIHRvIHZhck5hbWVcclxuICAgICAgICAgICAgdmFyIGxpc3QgPSBhdHRyaWJ1dGVJbmRleC5nZXRWYXJzTGlzdCggYWN0aW9uSW5zdGFuY2UuaWQgKTtcclxuICAgICAgICAgICAgaWYgKCAhIGxpc3QgKXtcclxuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAvLyBJdGVyYXRlIGxpc3QgYW5kIHVwZGF0ZSBIVE1MIGlmIHJlcXVpcmVkXHJcbiAgICAgICAgICAgIGlmICggISB1cGRhdGVIVE1MRnJvbVZhcnNMaXN0KCBhY3Rpb25JbnN0YW5jZSwgaSwgMCwgbGlzdCApICl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgLypcclxuICAgICAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgbGlzdC5sZW5ndGg7IGorKyApIHtcclxuICAgICAgICAgICAgICAgIHZhciBpbmRleEl0ZW0gPSBsaXN0WyBqIF07XHJcbiAgICAgICAgICAgICAgICBpZiAoICEgYWN0aW9uSW5zdGFuY2UuYXR0cmlidXRlSW5zdGFuY2VJc1JlbGF0ZWQoIGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZSApICl7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKCAhIHV0aWxzLmlzRnVuY3Rpb24oIGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZS51cGRhdGFibGVGcm9tQWN0aW9uICkgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB8fCBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UudXBkYXRhYmxlRnJvbUFjdGlvbiggc2VsZiwgZmluZE5vZGVCeUlkKCBpbmRleEl0ZW0ubm9kZUlkICkgKSApe1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBidWlsZERhdGFGcm9tVmFyQ2hhbmdlRXhjbHVkaW5nKCBhY3Rpb25JbnN0YW5jZS5pZCApO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgaWYgKCAhIGFjdGlvbkluc3RhbmNlLnVwZGF0ZUhUTUwoIFxyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4SXRlbSwgXHJcbiAgICAgICAgICAgICAgICAgICAgc2VsZiwgXHJcbiAgICAgICAgICAgICAgICAgICAgYWN0aW9uSW5zdGFuY2UsIFxyXG4gICAgICAgICAgICAgICAgICAgIHsgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGFjdGlvbkluc3RhbmNlOiBhY3Rpb25JbnN0YW5jZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgaTogaSwgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGxpc3Q6IGxpc3QsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGluaXRpYWxKOiBqIFxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICkgKXtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgdXBkYXRlSFRNTEZyb21WYXJzTGlzdCA9IGZ1bmN0aW9uKCBhY3Rpb25JbnN0YW5jZSwgaSwgaW5pdGlhbEosIGxpc3QgKXtcclxuICAgICAgICBcclxuICAgICAgICAvLyBJdGVyYXRlIGxpc3QgYW5kIHVwZGF0ZSBIVE1MIGlmIHJlcXVpcmVkXHJcbiAgICAgICAgZm9yICggdmFyIGogPSBpbml0aWFsSjsgaiA8IGxpc3QubGVuZ3RoOyBqKysgKSB7XHJcbiAgICAgICAgICAgIHZhciBpbmRleEl0ZW0gPSBsaXN0WyBqIF07XHJcbiAgICAgICAgICAgIGlmICggISBhY3Rpb25JbnN0YW5jZS5hdHRyaWJ1dGVJbnN0YW5jZUlzUmVsYXRlZCggaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlICkgKXtcclxuICAgICAgICAgICAgICAgIGlmICggISB1dGlscy5pc0Z1bmN0aW9uKCBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UudXBkYXRhYmxlRnJvbUFjdGlvbiApIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICB8fCBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2UudXBkYXRhYmxlRnJvbUFjdGlvbiggc2VsZiwgZmluZE5vZGVCeUlkKCBpbmRleEl0ZW0ubm9kZUlkICkgKSApe1xyXG4gICAgICAgICAgICAgICAgICAgIGJ1aWxkRGF0YUZyb21WYXJDaGFuZ2VFeGNsdWRpbmcoIGFjdGlvbkluc3RhbmNlLmlkICk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYgKCAhIGFjdGlvbkluc3RhbmNlLnVwZGF0ZUhUTUwoIFxyXG4gICAgICAgICAgICAgICAgaW5kZXhJdGVtLCBcclxuICAgICAgICAgICAgICAgIHNlbGYsIFxyXG4gICAgICAgICAgICAgICAgYWN0aW9uSW5zdGFuY2UsIFxyXG4gICAgICAgICAgICAgICAgeyBcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25JbnN0YW5jZTogYWN0aW9uSW5zdGFuY2UsXHJcbiAgICAgICAgICAgICAgICAgICAgaTogaSwgXHJcbiAgICAgICAgICAgICAgICAgICAgaW5pdGlhbEo6IGosXHJcbiAgICAgICAgICAgICAgICAgICAgbGlzdDogbGlzdFxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICApICl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgY29udGludWVVcGRhdGVIVE1MID0gZnVuY3Rpb24oIGNvbnRpbnVlRGF0YSApe1xyXG5cclxuICAgICAgICB1cGRhdGVIVE1MRnJvbVZhcnNMaXN0KFxyXG4gICAgICAgICAgICBjb250aW51ZURhdGEuYWN0aW9uSW5zdGFuY2UsIFxyXG4gICAgICAgICAgICBjb250aW51ZURhdGEuaSwgXHJcbiAgICAgICAgICAgIGNvbnRpbnVlRGF0YS5pbml0aWFsSiArIDEsIFxyXG4gICAgICAgICAgICBjb250aW51ZURhdGEubGlzdFxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCB1cGRhdGVIVE1MRnJvbUFjdGlvbnMoIGNvbnRpbnVlRGF0YS5pICsgMSApICl7XHJcbiAgICAgICAgICAgIHVwZGF0ZUhUTUxGcm9tVmFyQ2hhbmdlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHJ1bkFuaW1hdGlvbiA9IGZ1bmN0aW9uKCBhY3Rpb25JbnN0YW5jZSwgbm9kZSwgY2FsbGJhY2sgKXtcclxuICAgICAgICBcclxuICAgICAgICAvLyBCdWlsZCBjb21iaW5lZENhbGxiYWNrIGNvbWJpbmluZyBjYWxsYmFjayBhbmQgYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2tcclxuICAgICAgICB2YXIgY29tYmluZWRDYWxsYmFjayA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgICAgICAgICBpZiAoIGNhbGxiYWNrICl7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcclxuICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGV4dC5nZXRBbmltYXRpb25NYW5hZ2VyKCkucmVzZXQoIG5vZGUgKTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIGlmICggYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2sgKXtcclxuICAgICAgICAgICAgICAgICAgICBhY3Rpb25JbnN0YW5jZS5hbmltYXRpb25DYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9O1xyXG4gICAgICAgIFxyXG4gICAgICAgIC8vIEdldCBhbmltYXRpb24gbWFuYWdlciB0byBydW4gYW5pbWF0aW9uXHJcbiAgICAgICAgY29udGV4dC5nZXRBbmltYXRpb25NYW5hZ2VyKCkuYW5pbWF0ZSggYWN0aW9uSW5zdGFuY2UsIG5vZGUsIGNvbWJpbmVkQ2FsbGJhY2sgKTtcclxuICAgIH07XHJcbiAgICAvKlxyXG4gICAgdmFyIHJ1bkFuaW1hdGlvbiA9IGZ1bmN0aW9uKCBhY3Rpb25JbnN0YW5jZSwgbm9kZSwgY2FsbGJhY2sgKXtcclxuICAgICAgICBcclxuICAgICAgICAvLyBCdWlsZCBjb21iaW5lZENhbGxiYWNrIGNvbWJpbmluZyBjYWxsYmFjayBhbmQgYWN0aW9uSW5zdGFuY2UuYW5pbWF0aW9uQ2FsbGJhY2tcclxuICAgICAgICB2YXIgY29tYmluZWRDYWxsYmFjayA9ICEgY2FsbGJhY2sgJiYgISBhY3Rpb25JbnN0YW5jZS5hbmltYXRpb25DYWxsYmFjaz8gXHJcbiAgICAgICAgICAgIHVuZGVmaW5lZDpcclxuICAgICAgICAgICAgZnVuY3Rpb24oKXtcclxuICAgICAgICAgICAgICAgIGlmICggY2FsbGJhY2sgKXtcclxuICAgICAgICAgICAgICAgICAgICBjYWxsYmFjaygpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgaWYgKCBhY3Rpb25JbnN0YW5jZS5hbmltYXRpb25DYWxsYmFjayApe1xyXG4gICAgICAgICAgICAgICAgICAgIGFjdGlvbkluc3RhbmNlLmFuaW1hdGlvbkNhbGxiYWNrKCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IGFuaW1hdGlvbiBtYW5hZ2VyIHRvIHJ1biBhbmltYXRpb25cclxuICAgICAgICBjb250ZXh0LmdldEFuaW1hdGlvbk1hbmFnZXIoKS5hbmltYXRlKCBhY3Rpb25JbnN0YW5jZSwgbm9kZSwgY29tYmluZWRDYWxsYmFjayApO1xyXG4gICAgfTtcclxuICAgICovXHJcbiAgICBcclxuICAgIHZhciB1cGRhdGVIVE1MRnJvbVZhckNoYW5nZSA9IGZ1bmN0aW9uKCl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gVXBkYXRlIGRpY3Rpb25hcnlcclxuICAgICAgICB1cGRhdGVEaWN0aW9uYXJ5Rm9yRGljdGlvbmFyeUNoYW5nZXMoKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBCdWlsZCBkYXRhXHJcbiAgICAgICAgZm9yICggdmFyIHZhck5hbWUgaW4gZGljdGlvbmFyeUNoYW5nZXMgKXtcclxuICAgICAgICAgICAgYnVpbGREYXRhRnJvbVZhckNoYW5nZSggdmFyTmFtZSApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICAvLyBVcGRhdGUgYXR0cmlidXRlc1xyXG4gICAgICAgIGZvciAoIHZhciBpIGluIG5vZGVBdHRyaWJ1dGVzICkge1xyXG4gICAgICAgICAgICB2YXIgY3VycmVudE5vZGVBdHRyaWJ1dGVMaXN0ID0gbm9kZUF0dHJpYnV0ZXNbIGkgXTtcclxuICAgICAgICAgICAgZm9yICggdmFyIGogaW4gY3VycmVudE5vZGVBdHRyaWJ1dGVMaXN0ICl7XHJcbiAgICAgICAgICAgICAgICB1cGRhdGVBdHRyaWJ1dGUoIGN1cnJlbnROb2RlQXR0cmlidXRlTGlzdFsgaiBdICk7ICAgXHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgYnVpbGREYXRhRnJvbVZhckNoYW5nZSA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IHRoZSBsaXN0IG9mIGNoYW5nZXMgcmVsYXRlZCB0byB2YXJOYW1lXHJcbiAgICAgICAgdmFyIGxpc3QgPSBhdHRyaWJ1dGVJbmRleC5nZXRWYXJzTGlzdCggdmFyTmFtZSApO1xyXG4gICAgICAgIGJ1aWxkRGF0YUZyb21MaXN0KCB2YXJOYW1lLCBsaXN0ICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgYnVpbGREYXRhRnJvbVZhckNoYW5nZUV4Y2x1ZGluZyA9IGZ1bmN0aW9uKCB2YXJOYW1lICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gR2V0IHRoZSBsaXN0IG9mIGNoYW5nZXMgcmVsYXRlZCB0byB2YXJOYW1lXHJcbiAgICAgICAgdmFyIGxpc3QgPSBhdHRyaWJ1dGVJbmRleC5nZXRWYXJzTGlzdCggdmFyTmFtZSApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHZhciBmaWx0ZXJlZCA9IGxpc3QuZmlsdGVyKFxyXG4gICAgICAgICAgICBmdW5jdGlvbiggaW5kZXhJdGVtLCBpbmRleCwgYXJyICl7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gISBBYnN0cmFjdEFycmF5QWN0aW9uLnN0YXRpY0F0dHJpYnV0ZUluc3RhbmNlSXNSZWxhdGVkKFxyXG4gICAgICAgICAgICAgICAgICAgIGluZGV4SXRlbS5hdHRyaWJ1dGVJbnN0YW5jZVxyXG4gICAgICAgICAgICAgICAgKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYnVpbGREYXRhRnJvbUxpc3QoIHZhck5hbWUsIGZpbHRlcmVkICk7XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgYnVpbGREYXRhRnJvbUxpc3QgPSBmdW5jdGlvbiggdmFyTmFtZSwgbGlzdCApe1xyXG4gICAgICAgIFxyXG4gICAgICAgIGlmICggISBsaXN0ICl7XHJcbiAgICAgICAgICAgIHJldHVybjtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gQnVpbGQgZGF0YSBhYm91dCBhbGwgY2hhbmdlc1xyXG4gICAgICAgIHZhciBsZW5ndGggPSBsaXN0Lmxlbmd0aDtcclxuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKyApIHtcclxuICAgICAgICAgICAgYWRkTmV3Tm9kZUF0dHJpYnV0ZSggdmFyTmFtZSwgbGlzdFsgaSBdICk7XHJcbiAgICAgICAgICAgIC8qXHJcbiAgICAgICAgICAgIGlmICggISBhZGROZXdOb2RlQXR0cmlidXRlKCB2YXJOYW1lLCBsaXN0WyBpIF0gKSApe1xyXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlSW5kZXgucmVtb3ZlVmFyKCB2YXJOYW1lLCBsaXN0WyBpIF0ubm9kZUlkICk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgKi9cclxuICAgICAgICB9XHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICB2YXIgZmluZE5vZGVCeUlkID0gZnVuY3Rpb24gKCBub2RlSWQgKSB7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHdpbmRvdy5kb2N1bWVudC5xdWVyeVNlbGVjdG9yKCBcclxuICAgICAgICAgICAgJ1snICsgY29udGV4dC5nZXRUYWdzKCkuaWQgKyAnPVwiJyArIG5vZGVJZCArICdcIl0nIFxyXG4gICAgICAgICk7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBhZGROZXdOb2RlQXR0cmlidXRlID0gZnVuY3Rpb24oIHZhck5hbWUsIGluZGV4SXRlbSApe1xyXG5cclxuICAgICAgICB2YXIgYXR0cmlidXRlSW5zdGFuY2UgPSBpbmRleEl0ZW0uYXR0cmlidXRlSW5zdGFuY2U7XHJcbiAgICAgICAgdmFyIG5vZGUgPSBmaW5kTm9kZUJ5SWQoIGluZGV4SXRlbS5ub2RlSWQgKTtcclxuICAgICAgICBpZiAoICEgbm9kZSApe1xyXG4gICAgICAgICAgICAvLyBSZW1vdmVkIG5vZGUhXHJcbiAgICAgICAgICAgICsrc3RhdGlzdGljcy5yZW1vdmVkTm9kZVVwZGF0ZXM7XHJcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEFkZCBkYXRhIHRvIG5vZGVEYXRhXHJcbiAgICAgICAgdmFyIHRoaXNOb2RlRGF0YSA9IG5vZGVBdHRyaWJ1dGVzWyBpbmRleEl0ZW0ubm9kZUlkIF07XHJcbiAgICAgICAgaWYgKCAhIHRoaXNOb2RlRGF0YSApe1xyXG4gICAgICAgICAgICB0aGlzTm9kZURhdGEgPSB7fTtcclxuICAgICAgICAgICAgbm9kZUF0dHJpYnV0ZXNbIGluZGV4SXRlbS5ub2RlSWQgXSA9IHRoaXNOb2RlRGF0YTtcclxuICAgICAgICB9XHJcbiAgICAgICAgdmFyIGVsZW1lbnRJZCA9IGluZGV4SXRlbS5ncm91cElkPyBcclxuICAgICAgICAgICAgYXR0cmlidXRlSW5zdGFuY2UudHlwZSArICcvJyArIGluZGV4SXRlbS5ncm91cElkOiBcclxuICAgICAgICAgICAgYXR0cmlidXRlSW5zdGFuY2UudHlwZTtcclxuICAgICAgICB0aGlzTm9kZURhdGFbIGVsZW1lbnRJZCBdID0gaW5kZXhJdGVtO1xyXG5cclxuICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgIH07XHJcbiAgICBcclxuICAgIHZhciB1cGRhdGVBdHRyaWJ1dGUgPSBmdW5jdGlvbiggaW5kZXhJdGVtICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIGF0dHJpYnV0ZUluc3RhbmNlID0gaW5kZXhJdGVtLmF0dHJpYnV0ZUluc3RhbmNlO1xyXG4gICAgICAgIHZhciBub2RlID0gZmluZE5vZGVCeUlkKCBpbmRleEl0ZW0ubm9kZUlkICk7XHJcbiAgICAgICAgaWYgKCAhIG5vZGUgKXtcclxuICAgICAgICAgICAgLy8gUmVtb3ZlZCBub2RlIVxyXG4gICAgICAgICAgICArK3N0YXRpc3RpY3MucmVtb3ZlZE5vZGVVcGRhdGVzO1xyXG4gICAgICAgICAgICByZXR1cm4gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgICAgICsrc3RhdGlzdGljcy50b3RhbFVwZGF0ZXM7XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHNjb3BlID0gZ2V0Tm9kZVNjb3BlKCBub2RlLCBpbmRleEl0ZW0ubm9kZUlkICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXR0cmlidXRlSW5zdGFuY2UudXBkYXRlKCBzZWxmLCBub2RlLCBzY29wZSwgaW5kZXhJdGVtICk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHRydWU7XHJcbiAgICB9O1xyXG5cclxuICAgIHZhciBnZXROb2RlU2NvcGUgPSBmdW5jdGlvbiggbm9kZSwgbm9kZUlkICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgaWYgKCAhIG5vZGVJZCApe1xyXG4gICAgICAgICAgICBub2RlSWQgPSBub2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgXHJcbiAgICAgICAgdmFyIHRoaXNTY29wZSA9IHNjb3BlTWFwWyBub2RlSWQgXTtcclxuICAgICAgICBcclxuICAgICAgICBpZiAoICEgdGhpc1Njb3BlICl7XHJcbiAgICAgICAgICAgIHRoaXNTY29wZSA9IHNjb3BlQnVpbGRlci5idWlsZCggXHJcbiAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLCBcclxuICAgICAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICAgICAgdW5kZWZpbmVkLFxyXG4gICAgICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICAgICApO1xyXG4gICAgICAgICAgICBzY29wZU1hcFsgbm9kZUlkIF0gPSB0aGlzU2NvcGU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICByZXR1cm4gdGhpc1Njb3BlO1xyXG4gICAgfTtcclxuICAgIFxyXG4gICAgdmFyIHVwZGF0ZU5vZGUgPSBmdW5jdGlvbiggbm9kZSwgbXVzdFJlbW92ZUdlbmVyYXRlZE5vZGVzICl7XHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gUmVtb3ZlIHJlbGF0ZWQgdG8gbm9kZSBub2Rlc1xyXG4gICAgICAgIG5vZGVSZW1vdmVyLnJlbW92ZU11bHRpcGxlTm9kZXMoIG5vZGUsIG11c3RSZW1vdmVHZW5lcmF0ZWROb2RlcyApO1xyXG4gICAgICAgIC8qXHJcbiAgICAgICAgYXR0cmlidXRlSW5kZXgucmVtb3ZlTXVsdGlwbGVOb2RlcyhcclxuICAgICAgICAgICAgbm9kZVJlbW92ZXIucmVtb3ZlTXVsdGlwbGVOb2Rlcyggbm9kZSwgbXVzdFJlbW92ZUdlbmVyYXRlZE5vZGVzIClcclxuICAgICAgICApO1xyXG4gICAgICAgICovXHJcbiAgICAgICAgXHJcbiAgICAgICAgLy8gSW5zdGFuY2UgYW5kIGludm9rZSBwYXJzZXJOb2RlUmVuZGVyZXIgdG8gdXBkYXRlIG5vZGVcclxuICAgICAgICB2YXIgcGFyc2VyTm9kZVJlbmRlcmVyID0gbmV3IFBhcnNlck5vZGVSZW5kZXJlciggXHJcbiAgICAgICAgICAgIG5vZGUsIFxyXG4gICAgICAgICAgICBzY29wZUJ1aWxkZXIuYnVpbGQoIFxyXG4gICAgICAgICAgICAgICAgcGFyc2VyT3B0aW9ucywgXHJcbiAgICAgICAgICAgICAgICBub2RlLCBcclxuICAgICAgICAgICAgICAgIHVuZGVmaW5lZCxcclxuICAgICAgICAgICAgICAgIHRydWVcclxuICAgICAgICAgICAgKSxcclxuICAgICAgICAgICAgdHJ1ZVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcGFyc2VyTm9kZVJlbmRlcmVyLnJ1bigpO1xyXG4gICAgfTtcclxuICAgIC8qXHJcbiAgICB2YXIgZGVsZXRlTm9kZSA9IGZ1bmN0aW9uKCBub2RlICl7XHJcbiAgICAgICAgbm9kZS5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCBub2RlICk7XHJcbiAgICB9O1xyXG4gICAgKi9cclxuICAgIHZhciBzZWxmID0ge1xyXG4gICAgICAgIHJ1bjogcnVuLFxyXG4gICAgICAgIHVwZGF0ZU5vZGU6IHVwZGF0ZU5vZGUsXHJcbiAgICAgICAgLy9kZWxldGVOb2RlOiBkZWxldGVOb2RlLFxyXG4gICAgICAgIGZpbmROb2RlQnlJZDogZmluZE5vZGVCeUlkLFxyXG4gICAgICAgIGdldE5vZGVTY29wZTogZ2V0Tm9kZVNjb3BlLFxyXG4gICAgICAgIGdldFN0YXRpc3RpY3M6IGdldFN0YXRpc3RpY3MsXHJcbiAgICAgICAgYWRkVXBkYXRlZFRvU3RhdGlzdGljczogYWRkVXBkYXRlZFRvU3RhdGlzdGljcyxcclxuICAgICAgICBhZGRSZW1vdmVkVG9TdGF0aXN0aWNzOiBhZGRSZW1vdmVkVG9TdGF0aXN0aWNzLFxyXG4gICAgICAgIHJ1bkFuaW1hdGlvbjogcnVuQW5pbWF0aW9uLFxyXG4gICAgICAgIGNvbnRpbnVlVXBkYXRlSFRNTDogY29udGludWVVcGRhdGVIVE1MXHJcbiAgICB9O1xyXG4gICAgXHJcbiAgICByZXR1cm4gc2VsZjtcclxufTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gUGFyc2VyVXBkYXRlcjtcclxuIiwiLyogXG4gICAgcmVzb2x2ZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4vdXRpbHMuanMnICk7XG52YXIgY29udGV4dCA9IHJlcXVpcmUoICcuL2NvbnRleHQuanMnICk7XG52YXIgZXhwcmVzc2lvbkJ1aWxkZXIgPSByZXF1aXJlKCAnLi9leHByZXNzaW9ucy9leHByZXNzaW9uQnVpbGRlci5qcycgKTtcblxubW9kdWxlLmV4cG9ydHMgPSAoZnVuY3Rpb24oICkge1xuICAgIFwidXNlIHN0cmljdFwiO1xuICAgIFxuICAgIHZhciBtYWNyb3MgPSB7fTtcbiAgICB2YXIgcmVtb3RlUGFnZXMgPSB7fTtcbiAgICBcbiAgICB2YXIgZ2V0Tm9kZSA9IGZ1bmN0aW9uKCBtYWNyb0tleSwgc2NvcGUgKSB7XG4gICAgICAgIFxuICAgICAgICB2YXIgbm9kZSA9IG1hY3Jvc1sgbWFjcm9LZXkgXTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBub2RlICl7XG4gICAgICAgICAgICBub2RlID0gbG9hZE5vZGUoIG1hY3JvS2V5LCBzY29wZSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gbm9kZT8gbm9kZS5jbG9uZU5vZGUoIHRydWUgKTogdW5kZWZpbmVkO1xuICAgIH07XG4gICAgLypcbiAgICB2YXIgaXNSZW1vdGUgPSBmdW5jdGlvbiggbWFjcm9LZXkgKXtcbiAgICAgICAgcmV0dXJuIC0xICE9IG1hY3JvS2V5LmluZGV4T2YoIGNvbnRleHQuZ2V0Q29uZigpLm1hY3JvRGVsaW1pdGVyICk7XG4gICAgfTsqL1xuICAgIFxuICAgIHZhciBnZXRNYWNyb0RhdGFVc2luZ0V4cHJlc3Npb24gPSBmdW5jdGlvbiAoIG1hY3JvS2V5RXhwcmVzc2lvbiwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBtYWNyb0tleSA9IG1hY3JvS2V5RXhwcmVzc2lvbi5ldmFsdWF0ZSggc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBtYWNyb0tleSApe1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBtYWNyb0lkOiBudWxsLFxuICAgICAgICAgICAgICAgIHVybDogbnVsbFxuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGdldE1hY3JvRGF0YSggbWFjcm9LZXksIHNjb3BlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0TWFjcm9EYXRhVXNpbmdFeHByZXNzaW9uU3RyaW5nID0gZnVuY3Rpb24gKCBtYWNyb0tleUV4cHJlc3Npb25TdHJpbmcsIHNjb3BlICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgbWFjcm9LZXlFeHByZXNzaW9uID0gZXhwcmVzc2lvbkJ1aWxkZXIuYnVpbGQoIG1hY3JvS2V5RXhwcmVzc2lvblN0cmluZyApO1xuICAgICAgICByZXR1cm4gZ2V0TWFjcm9EYXRhVXNpbmdFeHByZXNzaW9uKCBtYWNyb0tleUV4cHJlc3Npb24sIHNjb3BlICk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0TWFjcm9EYXRhID0gZnVuY3Rpb24gKCBtYWNyb0tleSwgc2NvcGUgKXtcblxuICAgICAgICB2YXIgaW5kZXggPSBtYWNyb0tleS5pbmRleE9mKCBjb250ZXh0LmdldENvbmYoKS5tYWNyb0RlbGltaXRlciApO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuIGluZGV4ID09PSAtMT9cbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBtYWNyb0lkOiBtYWNyb0tleSxcbiAgICAgICAgICAgICAgICB1cmw6IG51bGxcbiAgICAgICAgICAgIH06XG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgbWFjcm9JZDogbWFjcm9LZXkuc3Vic3RyaW5nKCAwLCBpbmRleCApLFxuICAgICAgICAgICAgICAgIHVybDogYnVpbGRVUkwgKCBtYWNyb0tleS5zdWJzdHJpbmcoIDEgKyBpbmRleCApIClcbiAgICAgICAgICAgIH07XG4gICAgfTtcbiAgICBcbiAgICB2YXIgYnVpbERlZmluZU1hY3JvU2VsZWN0b3IgPSBmdW5jdGlvbiggbWFjcm9JZCApe1xuICAgICAgICByZXR1cm4gXCJbXCIgKyBmaWx0ZXJTZWxlY3RvciggY29udGV4dC5nZXRUYWdzKCkubWV0YWxEZWZpbmVNYWNybyApICsgXCI9J1wiICsgbWFjcm9JZCArIFwiJ11cIjtcbiAgICB9O1xuICAgIFxuICAgIHZhciBsb2FkTm9kZSA9IGZ1bmN0aW9uKCBtYWNyb0tleSwgc2NvcGUgKXtcblxuICAgICAgICB2YXIgbWFjcm9EYXRhID0gZ2V0TWFjcm9EYXRhKCBtYWNyb0tleSwgc2NvcGUgKTtcblxuICAgICAgICBpZiAoIG1hY3JvRGF0YS51cmwgKXtcbiAgICAgICAgICAgIC8vIE5vZGUgaXMgaW4gYW5vdGhlciBwYWdlXG4gICAgICAgICAgICByZXR1cm4gbG9hZFJlbW90ZU5vZGUoIG1hY3JvS2V5LCBtYWNyb0RhdGEgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTm8gdXJsIHNldFxuICAgICAgICB2YXIgdXJsSW5TY29wZSA9IHNjb3BlLmdldCggY29udGV4dC5nZXRDb25mKCkuZXh0ZXJuYWxNYWNyb1VybFZhck5hbWUgKTtcbiAgICAgICAgaWYgKCB1cmxJblNjb3BlICl7XG4gICAgICAgICAgICAvLyBUcnkgdG8gZmluZCBub2RlIGluIGFub3RoZXIgcGFnZSBidXQgdXNpbmcgYSBwcmV2aW91c2x5IGRlZmluZWQgdXJsXG4gICAgICAgICAgICBtYWNyb0RhdGEudXJsID0gdXJsSW5TY29wZTtcbiAgICAgICAgICAgIHZhciByZW1vdGVOb2RlID0gbG9hZFJlbW90ZU5vZGUoIG1hY3JvS2V5LCBtYWNyb0RhdGEgKTtcbiAgICAgICAgICAgIGlmICggcmVtb3RlTm9kZSApe1xuICAgICAgICAgICAgICAgIC8vIE5vZGUgaXMgZm91bmQgaW4gYW5vdGhlciBwYWdlXG4gICAgICAgICAgICAgICAgcmV0dXJuIHJlbW90ZU5vZGU7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIE5vZGUgaXMgaW4gdGhpcyBwYWdlXG4gICAgICAgIHZhciBtYWNyb0lkID0gbWFjcm9EYXRhLm1hY3JvSWQ7XG4gICAgICAgIHZhciBzZWxlY3RvciA9IGJ1aWxEZWZpbmVNYWNyb1NlbGVjdG9yKCBtYWNyb0lkICk7XG4gICAgICAgIHZhciBub2RlID0gd2luZG93LmRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIHNlbGVjdG9yICk7XG5cbiAgICAgICAgaWYgKCAhIG5vZGUgKXtcbiAgICAgICAgICAgIHRocm93IFwiTm9kZSB1c2luZyBzZWxlY3RvciAnXCIgKyBzZWxlY3RvciArIFwiJyBpcyBudWxsIVwiO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIGNvbmZpZ3VyZU5vZGUoIFxuICAgICAgICAgICAgbm9kZS5jbG9uZU5vZGUoIHRydWUgKSwgXG4gICAgICAgICAgICBtYWNyb0lkLFxuICAgICAgICAgICAgbWFjcm9LZXkgKTtcbiAgICAgICAgXG4gICAgfTtcbiAgICB2YXIgbG9hZFJlbW90ZU5vZGUgPSBmdW5jdGlvbiggbWFjcm9LZXksIG1hY3JvRGF0YSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIGVsZW1lbnQgPSByZW1vdGVQYWdlc1sgbWFjcm9EYXRhLnVybCBdO1xuICAgICAgICBcbiAgICAgICAgaWYgKCAhIGVsZW1lbnQgKXtcbiAgICAgICAgICAgIHRocm93ICdNYWNyb3MgaW4gVVJMICcgKyBtYWNyb0RhdGEudXJsICsgJyBub3QgcHJlbG9hZGVkISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHZhciBzZWxlY3RvciA9IGJ1aWxEZWZpbmVNYWNyb1NlbGVjdG9yKCBtYWNyb0RhdGEubWFjcm9JZCApO1xuICAgICAgICB2YXIgbm9kZSA9IGVsZW1lbnQucXVlcnlTZWxlY3Rvciggc2VsZWN0b3IgKTtcbiAgICAgICAgXG4gICAgICAgIGlmICggISBub2RlICl7XG4gICAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gY29uZmlndXJlTm9kZSggXG4gICAgICAgICAgICAgICAgICAgIG5vZGUuY2xvbmVOb2RlKCB0cnVlICksIFxuICAgICAgICAgICAgICAgICAgICBtYWNyb0RhdGEubWFjcm9JZCxcbiAgICAgICAgICAgICAgICAgICAgbWFjcm9LZXkgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciBidWlsZFJlbW90ZVBhZ2VVcmxMaXN0ID0gZnVuY3Rpb24oIHNjb3BlLCBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzICl7XG4gICAgICAgIFxuICAgICAgICB2YXIgcmVtb3RlUGFnZVVybHMgPSBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLnNsaWNlKCk7XG4gICAgICAgIFxuICAgICAgICB2YXIgbGlzdCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoIFxuICAgICAgICAgICAgXCJbXCIgKyBmaWx0ZXJTZWxlY3RvciggY29udGV4dC5nZXRUYWdzKCkubWV0YWxVc2VNYWNybyApICsgXCJdXCJcbiAgICAgICAgKTtcbiAgICAgICAgdmFyIGN1cnJlbnRNYWNyb1VzZTtcbiAgICAgICAgdmFyIHBvcyA9IDA7XG4gICAgICAgIHdoaWxlICggY3VycmVudE1hY3JvVXNlID0gbGlzdFsgcG9zKysgXSApIHtcbiAgICAgICAgICAgIHZhciBtYWNyb0tleUV4cHJlc3Npb25TdHJpbmcgPSBjdXJyZW50TWFjcm9Vc2UuZ2V0QXR0cmlidXRlKCBjb250ZXh0LmdldFRhZ3MoKS5tZXRhbFVzZU1hY3JvICk7XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgdmFyIG1hY3JvRGF0YSA9IGdldE1hY3JvRGF0YVVzaW5nRXhwcmVzc2lvblN0cmluZyggbWFjcm9LZXlFeHByZXNzaW9uU3RyaW5nLCBzY29wZSApO1xuXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IG1hY3JvRGF0YS51cmw7XG4gICAgICAgICAgICAgICAgaWYgKCB1cmwgJiYgcmVtb3RlUGFnZVVybHMuaW5kZXhPZiggdXJsICkgPT09IC0xICl7XG4gICAgICAgICAgICAgICAgICAgIHJlbW90ZVBhZ2VVcmxzLnB1c2goIHVybCApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0gY2F0Y2ggKCBleGNlcHRpb24gKXtcbiAgICAgICAgICAgICAgICAvLyBNYWNyb2RhdGEgY291bGQgbm90IGJlIHJlc29sdmVkLCBkbyBub3RoaW5nXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgXG4gICAgICAgIHJldHVybiByZW1vdGVQYWdlVXJscztcbiAgICB9O1xuICAgIFxuICAgIC8vIEFkZCBwcmVmZml4IGlmIHRoZSBVUkwgaXMgbm90IGFic29sdXRlXG4gICAgdmFyIGJ1aWxkVVJMID0gZnVuY3Rpb24oIFVSTCApe1xuICAgICAgICByZXR1cm4gVVJMLnN0YXJ0c1dpdGgoICcvJyApPyBVUkw6IGNvbnRleHQuZ2V0Q29uZigpLmV4dGVybmFsTWFjcm9QcmVmaXhVUkwgKyBVUkw7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgbG9hZFJlbW90ZVBhZ2VzID0gZnVuY3Rpb24oIHNjb3BlLCBkZWNsYXJlZFJlbW90ZVBhZ2VVcmxzLCBjYWxsYmFjaywgZmFpbENhbGxiYWNrICl7XG5cbiAgICAgICAgdmFyIHJlbW90ZVBhZ2VVcmxzID0gYnVpbGRSZW1vdGVQYWdlVXJsTGlzdCggc2NvcGUsIGRlY2xhcmVkUmVtb3RlUGFnZVVybHMgKTtcbiAgICAgICAgdmFyIHBlbmRpbmcgPSByZW1vdGVQYWdlVXJscy5sZW5ndGg7XG4gICAgICAgIHJlbW90ZVBhZ2VzID0ge307XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgcGVuZGluZyApe1xuICAgICAgICAgICAgaWYgKCBjYWxsYmFjayAmJiB1dGlscy5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICl7XG4gICAgICAgICAgICAgICAgY2FsbGJhY2soKTsgICBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGMgPSAwOyBjIDwgcmVtb3RlUGFnZVVybHMubGVuZ3RoOyBjKysgKSB7XG4gICAgICAgICAgICB2YXIgY3VycmVudFBhZ2VVcmwgPSBidWlsZFVSTCggcmVtb3RlUGFnZVVybHNbIGMgXSApO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICAvKiBqc2hpbnQgbG9vcGZ1bmM6IHRydWUgKi9cbiAgICAgICAgICAgIHV0aWxzLmFqYXgoXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICB1cmw6IGN1cnJlbnRQYWdlVXJsLFxuICAgICAgICAgICAgICAgICAgICAvL2RhdGFUeXBlOiAnaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgIGRvbmU6IGZ1bmN0aW9uKCBodG1sICkge1xuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGVsZW1lbnQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCAnZGl2JyApO1xuICAgICAgICAgICAgICAgICAgICAgICAgZWxlbWVudC5pbm5lckhUTUwgPSBodG1sO1xuICAgICAgICAgICAgICAgICAgICAgICAgcmVtb3RlUGFnZXNbIHRoaXMudXJsIF0gPSBlbGVtZW50O1xuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCAtLXBlbmRpbmcgPT0gMCAmJiBjYWxsYmFjayAmJiB1dGlscy5pc0Z1bmN0aW9uKCBjYWxsYmFjayApICl7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgZmFpbDogZnVuY3Rpb24oIGpxWEhSLCB0ZXh0U3RhdHVzLCBlcnJvciApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQuYXN5bmNFcnJvciggY3VycmVudFBhZ2VVcmwsIGVycm9yLCBmYWlsQ2FsbGJhY2sgKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICAvKlxuICAgICAgICAgICAgJC5hamF4KHtcbiAgICAgICAgICAgICAgICB1cmw6IGN1cnJlbnRQYWdlVXJsLFxuICAgICAgICAgICAgICAgIGRhdGFUeXBlOiAnaHRtbCdcbiAgICAgICAgICAgIH0pLmRvbmUoIGZ1bmN0aW9uKCBodG1sICkge1xuICAgICAgICAgICAgICAgIHZhciBlbGVtZW50ID0gJCggJzxkaXY+PC9kaXY+JyApO1xuICAgICAgICAgICAgICAgIGVsZW1lbnQuaHRtbCggaHRtbCApO1xuICAgICAgICAgICAgICAgIHJlbW90ZVBhZ2VzWyB0aGlzLnVybCBdID0gZWxlbWVudDtcbiAgICAgICAgICAgICAgICBpZiAoIC0tcGVuZGluZyA9PSAwICYmIGNhbGxiYWNrICYmIHV0aWxzLmlzRnVuY3Rpb24oIGNhbGxiYWNrICkgKXtcbiAgICAgICAgICAgICAgICAgICAgY2FsbGJhY2soKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9KS5mYWlsKCBmdW5jdGlvbigganFYSFIsIHRleHRTdGF0dXMsIGVycm9yICkge1xuICAgICAgICAgICAgICAgIGNvbnRleHQuYXN5bmNFcnJvciggY3VycmVudFBhZ2VVcmwsIGVycm9yLCBmYWlsQ2FsbGJhY2sgKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgKi9cbiAgICAgICAgfVxuICAgIH07XG4gICAgICAgICAgICAgICAgICBcbiAgICB2YXIgY29uZmlndXJlTm9kZSA9IGZ1bmN0aW9uKCBub2RlLCBtYWNyb0lkLCBtYWNyb0tleSApe1xuICAgICAgICBub2RlLnJlbW92ZUF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkubWV0YWxEZWZpbmVNYWNybyApO1xuICAgICAgICBub2RlLnNldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkubWV0YWxNYWNybywgbWFjcm9JZCApO1xuICAgICAgICBcbiAgICAgICAgbWFjcm9zWyBtYWNyb0tleSBdID0gbm9kZTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBub2RlO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldE1hY3JvS2V5ID0gZnVuY3Rpb24oIG1hY3JvS2V5RXhwcmVzc2lvbiwgc2NvcGUgKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBtYWNyb0RhdGEgPSBnZXRNYWNyb0RhdGFVc2luZ0V4cHJlc3Npb24oIG1hY3JvS2V5RXhwcmVzc2lvbiwgc2NvcGUgKTtcbiAgICAgICAgXG4gICAgICAgIHJldHVybiBtYWNyb0RhdGEudXJsPyBtYWNyb0RhdGEubWFjcm9JZCArIGNvbnRleHQuZ2V0Q29uZigpLm1hY3JvRGVsaW1pdGVyICsgbWFjcm9EYXRhLnVybDogbWFjcm9EYXRhLm1hY3JvSWQ7XG4gICAgfTtcbiAgICBcbiAgICAvLyBNdXN0IGZpbHRlciB0byByZXBsYWNlIDogYnkgXFxcXDpcbiAgICB2YXIgZmlsdGVyU2VsZWN0b3IgPSBmdW5jdGlvbiggc2VsZWN0b3IgKXtcbiAgICAgICAgcmV0dXJuIHNlbGVjdG9yLnJlcGxhY2UoIC86L2dpLCAnXFxcXDonICk7XG4gICAgfTtcbiAgICBcbiAgICByZXR1cm4ge1xuICAgICAgICBnZXROb2RlOiBnZXROb2RlLFxuICAgICAgICAvL2lzUmVtb3RlOiBpc1JlbW90ZSxcbiAgICAgICAgbG9hZFJlbW90ZVBhZ2VzOiBsb2FkUmVtb3RlUGFnZXMsXG4gICAgICAgIGdldE1hY3JvRGF0YTogZ2V0TWFjcm9EYXRhLFxuICAgICAgICBnZXRNYWNyb0tleTogZ2V0TWFjcm9LZXksXG4gICAgICAgIGZpbHRlclNlbGVjdG9yOiBmaWx0ZXJTZWxlY3RvclxuICAgIH07XG59KSgpO1xuIiwiLyogXG4gICAgUmVhY3RpdmVEaWN0aW9uYXJ5IGNsYXNzIFxuKi9cblwidXNlIHN0cmljdFwiO1xuXG52YXIgenB0ID0gcmVxdWlyZSggJy4uL21haW4uanMnICk7XG5cbnZhciBSZWFjdGl2ZURpY3Rpb25hcnkgPSBmdW5jdGlvbiggX25vblJlYWN0aXZlRGljdGlvbmFyeSwgX2luaXRpYWxBdXRvQ29tbWl0ICkge1xuICAgIFxuICAgIC8vIEluaXQgc29tZSB2YXJzXG4gICAgdmFyIHNlbGYgPSB0aGlzO1xuICAgIHRoaXMuX3ByaXZhdGVTY29wZSA9IHtcbiAgICAgICAgbm9uUmVhY3RpdmVEaWN0aW9uYXJ5OiBfbm9uUmVhY3RpdmVEaWN0aW9uYXJ5LFxuICAgICAgICBhdXRvQ29tbWl0OiB0cnVlLFxuICAgICAgICBkaWN0aW9uYXJ5Q2hhbmdlczoge30sXG4gICAgICAgIGRpY3Rpb25hcnlBY3Rpb25zOiBbXSxcbiAgICAgICAgY29tbWl0OiBmdW5jdGlvbigpe1xuICAgICAgICAgICAgenB0LnJ1bih7XG4gICAgICAgICAgICAgICAgY29tbWFuZDogJ3VwZGF0ZScsXG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeUNoYW5nZXM6IHNlbGYuX3ByaXZhdGVTY29wZS5kaWN0aW9uYXJ5Q2hhbmdlcyxcbiAgICAgICAgICAgICAgICBkaWN0aW9uYXJ5QWN0aW9uczogc2VsZi5fcHJpdmF0ZVNjb3BlLmRpY3Rpb25hcnlBY3Rpb25zXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIHNlbGYuX3ByaXZhdGVTY29wZS5kaWN0aW9uYXJ5Q2hhbmdlcyA9IHt9O1xuICAgICAgICAgICAgc2VsZi5fcHJpdmF0ZVNjb3BlLmRpY3Rpb25hcnlBY3Rpb25zID0gW107XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gRGVmaW5lIHNvbWUgbWV0aG9kc1xuICAgIHRoaXMuX2dldE5vblJlYWN0aXZlRGljdGlvbmFyeSA9IGZ1bmN0aW9uKCl7XG4gICAgICAgIHJldHVybiB0aGlzLl9wcml2YXRlU2NvcGUubm9uUmVhY3RpdmVEaWN0aW9uYXJ5O1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5faXNBdXRvQ29tbWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuX3ByaXZhdGVTY29wZS5hdXRvQ29tbWl0O1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5fc2V0QXV0b0NvbW1pdCA9IGZ1bmN0aW9uKCBfYXV0b0NvbW1pdCApe1xuICAgICAgICB0aGlzLl9wcml2YXRlU2NvcGUuYXV0b0NvbW1pdCA9IF9hdXRvQ29tbWl0O1xuICAgIH07XG4gICAgXG4gICAgdGhpcy5fY29tbWl0ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgdGhpcy5fcHJpdmF0ZVNjb3BlLmNvbW1pdCgpO1xuICAgIH07XG5cbiAgICB0aGlzLl9hZGRBY3Rpb25zID0gZnVuY3Rpb24oIGRpY3Rpb25hcnlBY3Rpb25zICl7XG4gICAgICAgIFxuICAgICAgICAvLyBSZWNvcmQgdGhpcyBhY3Rpb25zIHRvIGNvbW1pdCBpdCBsYXRlclxuICAgICAgICBzZWxmLl9wcml2YXRlU2NvcGUuZGljdGlvbmFyeUFjdGlvbnMgPSBzZWxmLl9wcml2YXRlU2NvcGUuZGljdGlvbmFyeUFjdGlvbnMuY29uY2F0KCBkaWN0aW9uYXJ5QWN0aW9ucyApO1xuICAgICAgICBcbiAgICAgICAgLy8gQ29tbWl0IHRoZSBjaGFuZ2Ugb25seSBpZiBhdXRvQ29tbWl0IGlzIG9uXG4gICAgICAgIGlmICggc2VsZi5faXNBdXRvQ29tbWl0KCkgKXtcbiAgICAgICAgICAgIHNlbGYuX3ByaXZhdGVTY29wZS5jb21taXQoKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdGhpcy5fYWRkVmFyaWFibGUgPSBmdW5jdGlvbigga2V5LCB2YWx1ZSApe1xuICAgICAgICBcbiAgICAgICAgLy8gU2V0IHRoZSB2YWx1ZSBpbiBub25SZWFjdGl2ZURpY3Rpb25hcnlcbiAgICAgICAgc2VsZi5fcHJpdmF0ZVNjb3BlLm5vblJlYWN0aXZlRGljdGlvbmFyeVsga2V5IF0gPSB2YWx1ZTtcbiAgICAgICAgXG4gICAgICAgIC8vIERlZmluZSBnZXR0ZXIgYW5kIHNldHRlclxuICAgICAgICB0aGlzLl9kZWZpbmVQcm9wZXJ0eSggXG4gICAgICAgICAgICB0aGlzLl9wcml2YXRlU2NvcGUubm9uUmVhY3RpdmVEaWN0aW9uYXJ5LCBcbiAgICAgICAgICAgIGtleSBcbiAgICAgICAgKTtcbiAgICB9O1xuXG4gICAgdGhpcy5fZGVmaW5lUHJvcGVydHkgPSBmdW5jdGlvbiggZGljdGlvbmFyeSwga2V5ICl7XG5cbiAgICAgICAgLy8gRGVmaW5lIHByb3BlcnR5IHRvIHNldCBnZXR0ZXIgYW5kIHNldHRlclxuICAgICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoXG4gICAgICAgICAgICBzZWxmLCBcbiAgICAgICAgICAgIGtleSwgXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICBjb25maWd1cmFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgZ2V0OiBmdW5jdGlvbiAoKSB7IFxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZGljdGlvbmFyeVsga2V5IF07XG4gICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICggdmFsdWUgKSB7XG4gICAgICAgICAgICAgICAgICAgIC8vIFJlY29yZCB0aGlzIGNoYW5nZSB0byBjb21taXQgaXQgbGF0ZXJcbiAgICAgICAgICAgICAgICAgICAgc2VsZi5fcHJpdmF0ZVNjb3BlLmRpY3Rpb25hcnlDaGFuZ2VzWyBrZXkgXSA9IHZhbHVlO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIENvbW1pdCB0aGUgY2hhbmdlIG9ubHkgaWYgYXV0b0NvbW1pdCBpcyBvblxuICAgICAgICAgICAgICAgICAgICBpZiAoIHNlbGYuX2lzQXV0b0NvbW1pdCgpICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBzZWxmLl9wcml2YXRlU2NvcGUuY29tbWl0KCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgfTtcbiAgICBcbiAgICAvLyBJbml0aWFsaXplXG4gICAgdGhpcy5faW5pdGlhbGl6ZSA9IGZ1bmN0aW9uKCBkaWN0aW9uYXJ5ICl7XG4gICAgICAgIFxuICAgICAgICAvLyBJbml0aWFsaXplIGF1dG9Db21taXRcbiAgICAgICAgaWYgKCBfaW5pdGlhbEF1dG9Db21taXQgIT09IHVuZGVmaW5lZCApe1xuICAgICAgICAgICAgdGhpcy5fc2V0QXV0b0NvbW1pdCggX2luaXRpYWxBdXRvQ29tbWl0ICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIEl0ZXJhdGUgcHJvcGVydGllcyBpbiBkaWN0aW9uYXJ5IHRvIGRlZmluZSBzZXR0ZXJzIGFuZCBnZXR0ZXJzXG4gICAgICAgIHZhciBrZXlzID0gT2JqZWN0LmtleXMoIGRpY3Rpb25hcnkgKTtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwga2V5cy5sZW5ndGg7IGkrKyApe1xuICAgICAgICAgICAgdmFyIGtleSA9IGtleXNbIGkgXTtcbiAgICAgICAgICAgIHZhciBwcm9wZXJ0eSA9IE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoIGRpY3Rpb25hcnksIGtleSApO1xuICAgICAgICAgICAgaWYgKCBwcm9wZXJ0eSAmJiBwcm9wZXJ0eS5jb25maWd1cmFibGUgPT09IGZhbHNlICkge1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvLyBEZWZpbmUgZ2V0dGVyIGFuZCBzZXR0ZXJcbiAgICAgICAgICAgIChmdW5jdGlvbigga2V5ICkge1xuICAgICAgICAgICAgICAgIHNlbGYuX2RlZmluZVByb3BlcnR5KCBkaWN0aW9uYXJ5LCBrZXkgKTtcbiAgICAgICAgICAgIH0pKCBrZXkgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgdGhpcy5faW5pdGlhbGl6ZSggdGhpcy5fcHJpdmF0ZVNjb3BlLm5vblJlYWN0aXZlRGljdGlvbmFyeSApO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSBSZWFjdGl2ZURpY3Rpb25hcnk7XG4iLCIvKiBcbiAgICBDbGFzcyBTY29wZSBcbiovXG5cInVzZSBzdHJpY3RcIjtcblxudmFyIGNvbnRleHQgPSByZXF1aXJlKCAnLi4vY29udGV4dC5qcycgKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBsb2FkanMgPSByZXF1aXJlKCAnbG9hZGpzJyApO1xuXG52YXIgU2NvcGUgPSBmdW5jdGlvbiggX2RpY3Rpb25hcnksIF9kaWN0aW9uYXJ5RXh0ZW5zaW9uLCBhZGRDb21tb25WYXJzLCBfZm9sZGVyRGljdGlvbmFyaWVzICkge1xuICAgIFxuICAgIHRoaXMuZGljdGlvbmFyeSA9IF9kaWN0aW9uYXJ5IHx8IHt9O1xuICAgIHRoaXMuZGljdGlvbmFyeUV4dGVuc2lvbiA9IF9kaWN0aW9uYXJ5RXh0ZW5zaW9uIHx8IHt9O1xuICAgIHRoaXMudmFycyA9IHt9O1xuICAgIHRoaXMuY2hhbmdlc1N0YWNrID0gW107XG4gICAgdGhpcy5ub2NhbGxWYXJzID0ge307XG4gICAgdGhpcy5mb2xkZXJEaWN0aW9uYXJpZXMgPSBfZm9sZGVyRGljdGlvbmFyaWVzIHx8IFtdO1xuICAgIHRoaXMuZ2xvYmFsVmFyc0V4cHJlc3Npb25zID0ge307XG4gICAgXG4gICAgaWYgKCBhZGRDb21tb25WYXJzICl7XG4gICAgICAgIHRoaXMuc2V0Q29tbW9uVmFycygpO1xuICAgIH1cbiAgICB0aGlzLnNldE1hbmRhdG9yeVZhcnMoKTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5zZXRNYW5kYXRvcnlWYXJzID0gZnVuY3Rpb24oKXtcblxuICAgIC8vIFJlZ2lzdGVyIG5vdGhpbmcgdmFyXG4gICAgdGhpcy5zZXRWYXIoIFxuICAgICAgICBjb250ZXh0LmdldENvbmYoKS5ub3RoaW5nVmFyTmFtZSwgXG4gICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLm5vdGhpbmdWYXJWYWx1ZSBcbiAgICApO1xuICAgIFxuICAgIC8vIFJlZ2lzdGVyIGRlZmF1bHQgdmFyXG4gICAgdGhpcy5zZXRWYXIoIFxuICAgICAgICBjb250ZXh0LmdldENvbmYoKS5kZWZhdWx0VmFyTmFtZSwgXG4gICAgICAgIGNvbnRleHQuZ2V0Q29uZigpLmRlZmF1bHRWYXJWYWx1ZSBcbiAgICApO1xufTtcblxuU2NvcGUucHJvdG90eXBlLnNldENvbW1vblZhcnMgPSBmdW5jdGlvbigpe1xuICAgIFxuICAgIC8vIFJlZ2lzdGVyIHdpbmRvdyBvYmplY3QgaWYgaXQgZXhpc3RzXG4gICAgaWYgKCB3aW5kb3cgKXtcbiAgICAgICAgdGhpcy5zZXRWYXIoIFxuICAgICAgICAgICAgY29udGV4dC5nZXRDb25mKCkud2luZG93VmFyTmFtZSwgXG4gICAgICAgICAgICB3aW5kb3cgXG4gICAgICAgICk7XG4gICAgfVxuXG4gICAgLy8gUmVnaXN0ZXIgY29udGV4dFxuICAgIHRoaXMuc2V0VmFyKCBcbiAgICAgICAgY29udGV4dC5nZXRDb25mKCkuY29udGV4dFZhck5hbWUsIFxuICAgICAgICBjb250ZXh0IFxuICAgICk7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuc3RhcnRFbGVtZW50ID0gZnVuY3Rpb24oKXtcbiAgICBcbiAgICB2YXIgdmFycyA9IHtcbiAgICAgICAgdmFyc1RvVW5zZXQ6IFtdLFxuICAgICAgICB2YXJzVG9TZXQ6IHt9LFxuICAgICAgICBleHByZXNzaW9uczoge30sXG4gICAgICAgIGltcGxpZWREZWNsYXJlZFZhcnM6IFtdXG4gICAgfTtcblxuICAgIHRoaXMuY2hhbmdlc1N0YWNrLnB1c2goIHZhcnMgKTtcblxuICAgIHJldHVybiB2YXJzO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmN1cnJlbnRWYXJzID0gZnVuY3Rpb24oKXtcbiAgICByZXR1cm4gdGhpcy5jaGFuZ2VzU3RhY2tbIHRoaXMuY2hhbmdlc1N0YWNrLmxlbmd0aCAtIDEgXTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5zZXRWYXIgPSBmdW5jdGlvbiggbmFtZSwgdmFsdWUgKSB7XG4gICAgdGhpcy52YXJzWyBuYW1lIF0gPSB2YWx1ZTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5nZXRXaXRob3V0RXZhbHVhdGluZyA9IGZ1bmN0aW9uKCBuYW1lICkge1xuICAgIFxuICAgIHZhciB2YWx1ZTtcbiAgICBcbiAgICB2YWx1ZSA9IHRoaXMudmFyc1sgbmFtZSBdO1xuICAgIGlmICggdmFsdWUgIT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIFxuICAgIHZhbHVlID0gdGhpcy5kaWN0aW9uYXJ5RXh0ZW5zaW9uWyBuYW1lIF07XG4gICAgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgXG4gICAgdmFsdWUgPSB0aGlzLmRpY3Rpb25hcnlbIG5hbWUgXTtcbiAgICBpZiAoIHZhbHVlICE9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBcbiAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmZvbGRlckRpY3Rpb25hcmllcy5sZW5ndGg7ICsraSApe1xuICAgICAgICB2YWx1ZSA9IHRoaXMuZm9sZGVyRGljdGlvbmFyaWVzWyBpIF1bIG5hbWUgXTtcbiAgICAgICAgaWYgKCB2YWx1ZSAhPT0gdW5kZWZpbmVkICl7XG4gICAgICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHVuZGVmaW5lZDtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5nZXQgPSBmdW5jdGlvbiggbmFtZSApIHtcblxuICAgIHZhciB2YWx1ZSA9IHRoaXMuZ2V0V2l0aG91dEV2YWx1YXRpbmcoIG5hbWUgKTtcbiAgICBcbiAgICBpZiAoICEgdGhpcy5ub2NhbGxWYXJzWyBuYW1lIF0gKXtcbiAgICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gdmFsdWUgJiYgdXRpbHMuaXNGdW5jdGlvbiggdmFsdWUuZXZhbHVhdGUgKT9cbiAgICAgICAgdmFsdWUuZXZhbHVhdGUoIHRoaXMgKTogXG4gICAgICAgICdFcnJvciBldmFsdWF0aW5nIHByb3BlcnR5IFwiJyArIG5hbWUgKyAnXCI6ICcgKyB2YWx1ZTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS51bnNldCA9IGZ1bmN0aW9uKCBuYW1lICkge1xuICAgIGRlbGV0ZSB0aGlzLnZhcnNbIG5hbWUgXTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5lbmRFbGVtZW50ID0gZnVuY3Rpb24gKCApIHtcblxuICAgIHZhciB2YXJzID0gdGhpcy5jaGFuZ2VzU3RhY2sucG9wKCk7IFxuXG4gICAgdmFyIHZhcnNUb1Vuc2V0ID0gdmFycy52YXJzVG9VbnNldDtcbiAgICB2YXIgdmFyc1RvU2V0ID0gdmFycy52YXJzVG9TZXQ7IFxuXG4gICAgZm9yICggdmFyIGkgPSAwOyBpIDwgdmFyc1RvVW5zZXQubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdGhpcy51bnNldCggdmFyc1RvVW5zZXRbIGkgXSApO1xuICAgIH1cblxuICAgIGZvciAoIHZhciBuYW1lIGluIHZhcnNUb1NldCApe1xuICAgICAgICB2YXIgdmFsdWUgPSB2YXJzVG9TZXRbIG5hbWUgXTtcbiAgICAgICAgdGhpcy5zZXRWYXIoIG5hbWUsIHZhbHVlICk7XG4gICAgfVxufTtcblxuU2NvcGUucHJvdG90eXBlLnNldCA9IGZ1bmN0aW9uICggbmFtZSwgdmFsdWUsIGlzR2xvYmFsLCBub2NhbGwsIF9leHByZXNzaW9uICkge1xuICAgIFxuICAgIHZhciBleHByZXNzaW9uID0gX2V4cHJlc3Npb24gPT09IHVuZGVmaW5lZD8gbnVsbDogX2V4cHJlc3Npb247XG4gICAgXG4gICAgaWYgKCAhIGlzR2xvYmFsICl7XG5cbiAgICAgICAgLy8gTG9jYWwgdmFyc1xuICAgICAgICB2YXIgdmFycyA9IHRoaXMuY3VycmVudFZhcnMoKTtcbiAgICAgICAgdmFyIGN1cnJlbnRWYWx1ZSA9IHRoaXMuZ2V0V2l0aG91dEV2YWx1YXRpbmcoIG5hbWUgKTtcblxuICAgICAgICBpZiAoIGN1cnJlbnRWYWx1ZSAhPSBudWxsICl7XG4gICAgICAgICAgICB2YXJzLnZhcnNUb1NldFsgbmFtZSBdID0gY3VycmVudFZhbHVlO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICB2YXJzLnZhcnNUb1Vuc2V0LnB1c2goIG5hbWUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdmFycy5leHByZXNzaW9uc1sgbmFtZSBdID0gZXhwcmVzc2lvbjtcbiAgICAgICAgXG4gICAgICAgIGlmICggdGhpcy5pc1N0cmljdE1vZGUoKSApe1xuICAgICAgICAgICAgdmFycy5pbXBsaWVkRGVjbGFyZWRWYXJzLnB1c2goIG5hbWUgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICB9IGVsc2Uge1xuICAgICAgICBcbiAgICAgICAgLy8gR2xvYmFsIHZhcnNcbiAgICAgICAgdGhpcy5nbG9iYWxWYXJzRXhwcmVzc2lvbnNbIG5hbWUgXSA9IGV4cHJlc3Npb247IFxuICAgIH1cbiAgICBcbiAgICAvLyBDb21tb24gdG8gZ2xvYmFsIGFuZCBsb2NhbCB2YXJzXG4gICAgdGhpcy5zZXRWYXIoIG5hbWUsIHZhbHVlICk7XG4gICAgXG4gICAgLy8gQWRkIHRvIG5vY2FsbFZhcnMgaWYgbmVlZGVkXG4gICAgaWYgKCBub2NhbGwgKXtcbiAgICAgICAgdGhpcy5ub2NhbGxWYXJzWyBuYW1lIF0gPSB0cnVlO1xuICAgIH1cbn07XG5cblNjb3BlLnByb3RvdHlwZS5sb2FkRm9sZGVyRGljdGlvbmFyaWVzQXN5bmMgPSBmdW5jdGlvbiAoIG1heEZvbGRlckRpY3Rpb25hcmllcywgbG9jYXRpb24sIGNhbGxiYWNrICkge1xuICAgIFxuICAgIGlmICggISBtYXhGb2xkZXJEaWN0aW9uYXJpZXMgKSB7XG4gICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgdmFyIHVybExpc3QgPSB0aGlzLmJ1aWxkVXJsTGlzdE9mRm9sZGVyRGljdGlvbmFyaWVzKCBtYXhGb2xkZXJEaWN0aW9uYXJpZXMsIGxvY2F0aW9uICk7XG4gICAgdGhpcy5sb2FkRm9sZGVyRGljdGlvbmFyeShcbiAgICAgICAgbWF4Rm9sZGVyRGljdGlvbmFyaWVzLFxuICAgICAgICBjYWxsYmFjayxcbiAgICAgICAgdXJsTGlzdCwgXG4gICAgICAgIDBcbiAgICApO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmxvYWRGb2xkZXJEaWN0aW9uYXJ5ID0gZnVuY3Rpb24gKCBtYXhGb2xkZXJEaWN0aW9uYXJpZXMsIGNhbGxiYWNrLCB1cmxMaXN0LCBpICkge1xuICAgIFxuICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgXG4gICAgdmFyIGxvYWRqc0NhbGxiYWNrID0gZnVuY3Rpb24oIHVybCwgc3VjY2VzcyApe1xuICAgICAgICBcbiAgICAgICAgLy8gVHJlYXQganMgZmlsZSBvbmx5IGlmIGxvYWQgaXMgc3VjZXNzZnVsbFxuICAgICAgICBpZiAoIHN1Y2Nlc3MgJiYgd2luZG93LmZvbGRlckRpY3Rpb25hcnkgKXtcbiAgICAgICAgICAgIGluc3RhbmNlLmZvbGRlckRpY3Rpb25hcmllcy5wdXNoKCB3aW5kb3cuZm9sZGVyRGljdGlvbmFyeSApO1xuICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgLy8gUnVuIGNhbGxiYWNrIGFuZCByZXR1cm4gaWYgdGhlIHVybExpc3QgaXMgb3ZlclxuICAgICAgICBpZiAoIGkgPT09IHVybExpc3QubGVuZ3RoKXtcbiAgICAgICAgICAgIGNhbGxiYWNrKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBDb250aW51ZSwgdGhlIHVybExpc3QgaXMgbm90IG92ZXJcbiAgICAgICAgaW5zdGFuY2UubG9hZEZvbGRlckRpY3Rpb25hcnkoXG4gICAgICAgICAgICBtYXhGb2xkZXJEaWN0aW9uYXJpZXMsIFxuICAgICAgICAgICAgY2FsbGJhY2ssXG4gICAgICAgICAgICB1cmxMaXN0LCBcbiAgICAgICAgICAgIGlcbiAgICAgICAgKTtcbiAgICB9O1xuICAgIFxuICAgIHZhciB1cmwgPSB1cmxMaXN0WyBpKysgXTtcbiAgICBsb2FkanMoXG4gICAgICAgIHVybCwgXG4gICAgICAgIHtcbiAgICAgICAgICAgIHN1Y2Nlc3M6IGZ1bmN0aW9uKCkgeyBcbiAgICAgICAgICAgICAgICBsb2FkanNDYWxsYmFjayggdXJsLCB0cnVlICk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgZXJyb3I6IGZ1bmN0aW9uKCkgeyBcbiAgICAgICAgICAgICAgICBsb2FkanNDYWxsYmFjayggdXJsLCBmYWxzZSApO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgKTtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5idWlsZFVybExpc3RPZkZvbGRlckRpY3Rpb25hcmllcyA9IGZ1bmN0aW9uICggbWF4Rm9sZGVyRGljdGlvbmFyaWVzLCBsb2NhdGlvbiApIHtcbiAgICBcbiAgICB2YXIgcmVzdWx0ID0gW107XG4gICAgXG4gICAgdmFyIGMgPSAwO1xuICAgIHZhciBwYXRoID0gbG9jYXRpb24ucGF0aG5hbWU7XG4gICAgdmFyIGxhc3RJbmRleCA9IHBhdGgubGFzdEluZGV4T2YoICcvJyApO1xuICAgIHdoaWxlICggbGFzdEluZGV4ICE9PSAtMSAmJiArK2MgPD0gbWF4Rm9sZGVyRGljdGlvbmFyaWVzICl7XG4gICAgICAgIHZhciBwYXJlbnQgPSBwYXRoLnN1YnN0ciggMCwgbGFzdEluZGV4ICk7XG4gICAgICAgIHJlc3VsdC5wdXNoKCBcbiAgICAgICAgICAgIGxvY2F0aW9uLm9yaWdpbiArIHBhcmVudCArICcvJyArICdmb2xkZXJEaWN0aW9uYXJ5LmpzJyBcbiAgICAgICAgKTtcbiAgICAgICAgbGFzdEluZGV4ID0gcGFyZW50Lmxhc3RJbmRleE9mKCAnLycgKTtcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHJlc3VsdDtcbn07XG5cblNjb3BlLnByb3RvdHlwZS5pc1N0cmljdE1vZGUgPSBmdW5jdGlvbigpe1xuICAgIHJldHVybiBjb250ZXh0LmlzU3RyaWN0TW9kZSgpIHx8IHRoaXMuZ2V0KCBjb250ZXh0LmdldENvbmYoKS5zdHJpY3RNb2RlVmFyTmFtZSApO1xufTtcblxuU2NvcGUucHJvdG90eXBlLmlzVmFsaWRWYXJpYWJsZSA9IGZ1bmN0aW9uKCBuYW1lICl7XG4gICAgXG4gICAgLy8gSWYgc3RyaWN0IG1vZGUgaXMgb2ZmIGFsbCB2YXJpYWJsZSBhcmUgdmFsaWRcbiAgICBpZiAoICEgdGhpcy5pc1N0cmljdE1vZGUoKSApe1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgXG4gICAgLy8gSWYgdGhlIHZhcmlhYmxlIGlzIGRlY2xhcmVkIHJldHVybiB0cnVlXG4gICAgdmFyIGRlY2xhcmVkID0gdGhpcy5nZXQoIGNvbnRleHQuZ2V0Q29uZigpLmRlY2xhcmVkVmFyc1Zhck5hbWUgKTtcbiAgICB2YXIgaXNEZWNsYXJlZCA9IGRlY2xhcmVkICYmIGRlY2xhcmVkLmluZGV4T2Y/IFxuICAgICAgICBkZWNsYXJlZC5pbmRleE9mKCBuYW1lICkgIT09IC0xOiBcbiAgICAgICAgZmFsc2U7XG4gICAgaWYgKCBpc0RlY2xhcmVkICl7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgIH1cbiAgICBcbiAgICAvLyBDaGVjayBpZiB0aGUgdmFyaWFibGUgaXMgaW1wbGljaXRseSBkZWNsYXJlZFxuICAgIGZvciAoIHZhciBpID0gdGhpcy5jaGFuZ2VzU3RhY2subGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkgKXtcbiAgICAgICAgdmFyIHZhcnMgPSB0aGlzLmNoYW5nZXNTdGFja1sgaSBdO1xuICAgICAgICB2YXIgaXNJbXBsaWVkID0gdmFycy5pbXBsaWVkRGVjbGFyZWRWYXJzLmluZGV4T2YoIG5hbWUgKSAhPT0gLTE7XG4gICAgICAgIGlmICggaXNJbXBsaWVkICl7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuZ2V0VmFyRXhwcmVzc2lvbiA9IGZ1bmN0aW9uICggbmFtZSApIHtcbiAgICBcbiAgICB2YXIgZXhwcmVzc2lvbiA9IHRoaXMuZ2V0RXhwcmVzc2lvbkZyb21Mb2NhbCggbmFtZSApO1xuICAgIHJldHVybiBleHByZXNzaW9uICE9PSB1bmRlZmluZWQ/IGV4cHJlc3Npb246IHRoaXMuZ2xvYmFsVmFyc0V4cHJlc3Npb25zWyBuYW1lIF07XG59O1xuXG5TY29wZS5wcm90b3R5cGUuZ2V0RXhwcmVzc2lvbkZyb21Mb2NhbCA9IGZ1bmN0aW9uICggbmFtZSApIHtcblxuICAgIGZvciAoIHZhciBpID0gdGhpcy5jaGFuZ2VzU3RhY2subGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkgKXtcbiAgICAgICAgdmFyIHZhcnMgPSB0aGlzLmNoYW5nZXNTdGFja1sgaSBdO1xuICAgICAgICB2YXIgZXhwcmVzc2lvbiA9IHZhcnMuZXhwcmVzc2lvbnNbIG5hbWUgXTtcbiAgICAgICAgaWYgKCBleHByZXNzaW9uICE9PSB1bmRlZmluZWQgKXtcbiAgICAgICAgICAgIHJldHVybiBleHByZXNzaW9uO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB1bmRlZmluZWQ7XG59O1xuXG5TY29wZS5wcm90b3R5cGUuaXNMb2NhbFZhciA9IGZ1bmN0aW9uICggbmFtZSApIHtcbiAgICByZXR1cm4gdGhpcy52YXJzWyBuYW1lIF0gIT09IHVuZGVmaW5lZDtcbn07XG5cbm1vZHVsZS5leHBvcnRzID0gU2NvcGU7XG4iLCIvKiBcbiAgICBzY29wZUJ1aWxkZXIgc2luZ2xldG9uIGNsYXNzXG4qL1xuXCJ1c2Ugc3RyaWN0XCI7XG5cbnZhciBjb250ZXh0ID0gcmVxdWlyZSggJy4uL2NvbnRleHQuanMnICk7XG52YXIgU2NvcGUgPSByZXF1aXJlKCAnLi9zY29wZS5qcycgKTtcbnZhciB1dGlscyA9IHJlcXVpcmUoICcuLi91dGlscy5qcycgKTtcbnZhciBQYXJzZXJOb2RlUmVuZGVyZXIgPSByZXF1aXJlKCAnLi4vcGFyc2Vycy9wYXJzZXJOb2RlUmVuZGVyZXIuanMnICk7XG5cbm1vZHVsZS5leHBvcnRzID0gKGZ1bmN0aW9uKCkge1xuICAgIFxuICAgIHZhciBrZXlMZW5ndGggPSA2O1xuICAgIFxuICAgIHZhciBidWlsZCA9IGZ1bmN0aW9uKCBwYXJzZXJPcHRpb25zLCB0YXJnZXQsIGRpY3Rpb25hcnlFeHRlbnNpb24sIG11c3RVcGRhdGUgKSB7XG5cbiAgICAgICAgdmFyIHNjb3BlID0gbmV3IFNjb3BlKCBcbiAgICAgICAgICAgIHBhcnNlck9wdGlvbnMuZGljdGlvbmFyeSwgXG4gICAgICAgICAgICBkaWN0aW9uYXJ5RXh0ZW5zaW9uLCBcbiAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICBjb250ZXh0LmdldEZvbGRlckRpY3Rpb25hcmllcygpXG4gICAgICAgICk7XG4gICAgICAgIFxuICAgICAgICBpZiAoIG11c3RVcGRhdGUgKXtcbiAgICAgICAgICAgIHVwZGF0ZSggcGFyc2VyT3B0aW9ucywgdGFyZ2V0LCBzY29wZSApO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gc2NvcGU7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgdXBkYXRlID0gZnVuY3Rpb24oIHBhcnNlck9wdGlvbnMsIHRhcmdldCwgc2NvcGUgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgcm9vdCBrZXlcbiAgICAgICAgdmFyIHJvb3RNYXAgPSBtYXJrQWxsUm9vdHMoIHBhcnNlck9wdGlvbnMgKTtcbiAgICAgICAgdmFyIHJvb3RLZXlUYWcgPSBnZXRSb290S2V5VGFnKCk7XG4gICAgICAgIHZhciByb290ID0gZ2V0Um9vdCggcGFyc2VyT3B0aW9ucywgdGFyZ2V0LCByb290TWFwICk7XG4gICAgICAgIHZhciByb290S2V5ID0gIHJvb3QuZ2V0QXR0cmlidXRlKCByb290S2V5VGFnICk7XG4gICAgICAgIFxuICAgICAgICB2YXIgdGFsRGVmaW5lVGFnID0gY29udGV4dC5nZXRUYWdzKCkudGFsRGVmaW5lO1xuICAgICAgICB2YXIgdGFsQXV0b0RlZmluZVRhZyA9IGNvbnRleHQuZ2V0VGFncygpLnRhbEF1dG9EZWZpbmU7XG4gICAgICAgIFxuICAgICAgICB2YXIgbm9kZSA9IHRhcmdldC5wYXJlbnROb2RlO1xuICAgICAgICB2YXIgYyA9IDA7XG4gICAgICAgIHZhciBpdGVtc0xpc3QgPSBbXTtcbiAgICAgICAgXG4gICAgICAgIGRvIHtcbiAgICAgICAgICAgIC8vIEFkZCB0YWxEZWZpbmVcbiAgICAgICAgICAgIHZhciB0YWxEZWZpbmUgPSBub2RlLmdldEF0dHJpYnV0ZSggdGFsRGVmaW5lVGFnICk7XG4gICAgICAgICAgICBpZiAoIHRhbERlZmluZSApe1xuICAgICAgICAgICAgICAgIGl0ZW1zTGlzdC5wdXNoKCB0YWxEZWZpbmUgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gQWRkIHRhbEF1dG9EZWZpbmVcbiAgICAgICAgICAgIHZhciB0YWxBdXRvRGVmaW5lID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHRhbEF1dG9EZWZpbmVUYWcgKTtcbiAgICAgICAgICAgIGlmICggdGFsQXV0b0RlZmluZSApe1xuICAgICAgICAgICAgICAgIGl0ZW1zTGlzdC5wdXNoKCB0YWxBdXRvRGVmaW5lICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBcbiAgICAgICAgICAgIHZhciBub2RlS2V5ID0gbm9kZS5nZXRBdHRyaWJ1dGUoIHJvb3RLZXlUYWcgKTtcbiAgICAgICAgICAgIGlmICggbm9kZUtleSAmJiBub2RlS2V5ID09PSByb290S2V5ICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHByb2Nlc3NMaXN0T2ZEZWZpbmVzKCBcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUsIFxuICAgICAgICAgICAgICAgICAgICBpdGVtc0xpc3QsIFxuICAgICAgICAgICAgICAgICAgICBub2RlLFxuICAgICAgICAgICAgICAgICAgICBwYXJzZXJPcHRpb25zLmluZGV4RXhwcmVzc2lvbnNcbiAgICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBub2RlID0gbm9kZS5wYXJlbnROb2RlO1xuICAgICAgICAgICAgXG4gICAgICAgIH0gd2hpbGUgKCBub2RlLm5vZGVUeXBlICE9PSA5ICYmICsrYyA8IDEwMCApO1xuICAgICAgICBcbiAgICAgICAgdGhyb3cgJ0Vycm9yIHRyeWluZyB0byB1cGRhdGUgc2NvcGU6IHJvb3Qgbm90IGZvdW5kISc7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgcHJvY2Vzc0xpc3RPZkRlZmluZXMgPSBmdW5jdGlvbiggc2NvcGUsIGl0ZW1zTGlzdCwgbm9kZSwgaW5kZXhFeHByZXNzaW9ucyApe1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGMgPSBpdGVtc0xpc3QubGVuZ3RoIC0gMTsgYyA+PSAwOyBjLS0gKSB7XG4gICAgICAgICAgICB2YXIgdGFsRGVmaW5lID0gaXRlbXNMaXN0WyBjIF07XG4gICAgICAgICAgICBQYXJzZXJOb2RlUmVuZGVyZXIucHJvY2Vzc0RlZmluZShcbiAgICAgICAgICAgICAgICBub2RlLCBcbiAgICAgICAgICAgICAgICB0YWxEZWZpbmUsIFxuICAgICAgICAgICAgICAgIHRydWUsXG4gICAgICAgICAgICAgICAgc2NvcGUsXG4gICAgICAgICAgICAgICAgaW5kZXhFeHByZXNzaW9uc1xuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgIH07XG4gICAgXG4gICAgdmFyIGdldFJvb3QgPSBmdW5jdGlvbiggcGFyc2VyT3B0aW9ucywgdGFyZ2V0LCByb290TWFwICl7XG4gICAgICAgIFxuICAgICAgICBpZiAoICEgQXJyYXkuaXNBcnJheSggcGFyc2VyT3B0aW9ucy5yb290ICkgKXsgXG4gICAgICAgICAgICByZXR1cm4gcGFyc2VyT3B0aW9ucy5yb290O1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICB2YXIgcm9vdEtleVRhZyA9IGdldFJvb3RLZXlUYWcoKTtcbiAgICAgICAgdmFyIG5vZGUgPSB0YXJnZXQ7XG4gICAgICAgIHZhciBjID0gMDtcbiAgICAgICAgZG8ge1xuICAgICAgICAgICAgdmFyIHJvb3RLZXkgPSAgbm9kZS5nZXRBdHRyaWJ1dGUoIHJvb3RLZXlUYWcgKTtcbiAgICAgICAgICAgIGlmICggcm9vdEtleSApe1xuICAgICAgICAgICAgICAgIHJldHVybiByb290TWFwWyByb290S2V5IF07XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG5cbiAgICAgICAgfSB3aGlsZSAoIG5vZGUubm9kZVR5cGUgIT09IDkgJiYgKytjIDwgMTAwICk7XG4gICAgICAgIFxuICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIGdldCByb290OiBub3QgZm91bmQhJztcbiAgICB9O1xuICAgIFxuICAgIHZhciBtYXJrQWxsUm9vdHMgPSBmdW5jdGlvbiggcGFyc2VyT3B0aW9ucyApe1xuXG4gICAgICAgIHZhciByb290TWFwID0ge307XG4gICAgICAgIHZhciByb290ID0gcGFyc2VyT3B0aW9ucy5yb290O1xuXG4gICAgICAgIC8vIElzIG11bHRpcm9vdD9cbiAgICAgICAgaWYgKCBBcnJheS5pc0FycmF5KCByb290ICkgKXsgXG4gICAgICAgICAgICAvLyBUaGVyZSBhcmUgc2V2ZXJhbCByb290c1xuICAgICAgICAgICAgZm9yICggdmFyIGMgPSAwOyBjIDwgcm9vdC5sZW5ndGg7IGMrKyApIHtcbiAgICAgICAgICAgICAgICBtYXJrQXNSb290KCByb290WyBjIF0sIHJvb3RNYXAgKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIC8vIFRoZXJlIGlzIG9ubHkgb25lIHJvb3RcbiAgICAgICAgICAgIG1hcmtBc1Jvb3QoIHJvb3QsIHJvb3RNYXAgKTtcbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiByb290TWFwO1xuICAgIH07XG4gICAgXG4gICAgdmFyIG1hcmtBc1Jvb3QgPSBmdW5jdGlvbiggbm9kZSwgcm9vdE1hcCApe1xuICAgICAgICBcbiAgICAgICAgLy8gQnVpbGQgdGhlIGtleVxuICAgICAgICB2YXIga2V5ID0gYnVpbGRLZXkoKTtcblxuICAgICAgICAvLyBQdXQgYSBjb3B5IG9mIHNjb3BlIGludG8gdGhlIGNhY2hlXG4gICAgICAgIHJvb3RNYXBbIGtleSBdID0gbm9kZTtcblxuICAgICAgICAvLyBTYXZlIHRoZSBrZXkgYXMgYW4gYXR0cmlidXRlIG9mIHRoZSBub2RlXG4gICAgICAgIG5vZGUuc2V0QXR0cmlidXRlKCBnZXRSb290S2V5VGFnKCksIGtleSApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGJ1aWxkS2V5ID0gZnVuY3Rpb24oKXtcbiAgICAgICAgcmV0dXJuIHV0aWxzLmdlbmVyYXRlSWQoIGtleUxlbmd0aCApO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGdldFJvb3RLZXlUYWcgPSBmdW5jdGlvbigpe1xuICAgICAgICByZXR1cm4gY29udGV4dC5nZXRUYWdzKCkucm9vdEtleTtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGJ1aWxkOiBidWlsZFxuICAgIH07XG59KSgpO1xuIiwiLypcbiAgICB1dGlscyBzaW5nbGV0b24gY2xhc3NcbiovXG5tb2R1bGUuZXhwb3J0cyA9IChmdW5jdGlvbigpIHtcbiAgICBcInVzZSBzdHJpY3RcIjtcbiAgICBcbiAgICB2YXIgZ2VuZXJhdGVJZCA9IGZ1bmN0aW9uICggbGVuLCBfY2hhclNldCApIHtcbiAgICAgICAgXG4gICAgICAgIHZhciBjaGFyU2V0ID0gX2NoYXJTZXQgfHwgJ0FCQ0RFRkdISUpLTE1OT1BRUlNUVVZXWFlaYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5JztcbiAgICAgICAgdmFyIHJlc3VsdCA9ICcnO1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCBsZW47IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBwb3MgPSBNYXRoLmZsb29yKCBNYXRoLnJhbmRvbSgpICogY2hhclNldC5sZW5ndGggKTtcbiAgICAgICAgICAgIHJlc3VsdCArPSBjaGFyU2V0LnN1YnN0cmluZyggcG9zLCBwb3MgKyAxICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9O1xuICAgIFxuICAgIC8vdmFyIGlzQXJyYXkgPSBBcnJheS5pc0FycmF5O1xuICAgIFxuICAgIHZhciBpc0Z1bmN0aW9uID0gZnVuY3Rpb24gaXNGdW5jdGlvbiggb2JqICkge1xuXG4gICAgICAgIC8vIFN1cHBvcnQ6IENocm9tZSA8PTU3LCBGaXJlZm94IDw9NTJcbiAgICAgICAgLy8gSW4gc29tZSBicm93c2VycywgdHlwZW9mIHJldHVybnMgXCJmdW5jdGlvblwiIGZvciBIVE1MIDxvYmplY3Q+IGVsZW1lbnRzXG4gICAgICAgIC8vIChpLmUuLCBgdHlwZW9mIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoIFwib2JqZWN0XCIgKSA9PT0gXCJmdW5jdGlvblwiYCkuXG4gICAgICAgIC8vIFdlIGRvbid0IHdhbnQgdG8gY2xhc3NpZnkgKmFueSogRE9NIG5vZGUgYXMgYSBmdW5jdGlvbi5cbiAgICAgICAgcmV0dXJuIHR5cGVvZiBvYmogPT09IFwiZnVuY3Rpb25cIiAmJiB0eXBlb2Ygb2JqLm5vZGVUeXBlICE9PSBcIm51bWJlclwiO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGlzUGxhaW5PYmplY3QgPSBmdW5jdGlvbiggb2JqICkge1xuICAgICAgICB2YXIgcHJvdG8sIEN0b3I7XG5cbiAgICAgICAgLy8gRGV0ZWN0IG9idmlvdXMgbmVnYXRpdmVzXG4gICAgICAgIC8vIFVzZSB0b1N0cmluZyBpbnN0ZWFkIG9mIGpRdWVyeS50eXBlIHRvIGNhdGNoIGhvc3Qgb2JqZWN0c1xuICAgICAgICBpZiAoICFvYmogfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKCBvYmogKSAhPT0gXCJbb2JqZWN0IE9iamVjdF1cIiApIHtcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgfVxuXG4gICAgICAgIHByb3RvID0gZ2V0UHJvdG8oIG9iaiApO1xuXG4gICAgICAgIC8vIE9iamVjdHMgd2l0aCBubyBwcm90b3R5cGUgKGUuZy4sIGBPYmplY3QuY3JlYXRlKCBudWxsIClgKSBhcmUgcGxhaW5cbiAgICAgICAgaWYgKCAhcHJvdG8gKSB7XG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIE9iamVjdHMgd2l0aCBwcm90b3R5cGUgYXJlIHBsYWluIGlmZiB0aGV5IHdlcmUgY29uc3RydWN0ZWQgYnkgYSBnbG9iYWwgT2JqZWN0IGZ1bmN0aW9uXG4gICAgICAgIEN0b3IgPSBoYXNPd24uY2FsbCggcHJvdG8sIFwiY29uc3RydWN0b3JcIiApICYmIHByb3RvLmNvbnN0cnVjdG9yO1xuICAgICAgICByZXR1cm4gdHlwZW9mIEN0b3IgPT09IFwiZnVuY3Rpb25cIiAmJiBmblRvU3RyaW5nLmNhbGwoIEN0b3IgKSA9PT0gT2JqZWN0RnVuY3Rpb25TdHJpbmc7XG4gICAgfTtcbiAgICB2YXIgZ2V0UHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2Y7XG4gICAgdmFyIGNsYXNzMnR5cGUgPSB7fTtcbiAgICB2YXIgaGFzT3duID0gY2xhc3MydHlwZS5oYXNPd25Qcm9wZXJ0eTtcbiAgICB2YXIgZm5Ub1N0cmluZyA9IGhhc093bi50b1N0cmluZztcbiAgICB2YXIgT2JqZWN0RnVuY3Rpb25TdHJpbmcgPSBmblRvU3RyaW5nLmNhbGwoIE9iamVjdCApO1xuICAgIFxuICAgIHZhciBkZWVwRXh0ZW5kID0gZnVuY3Rpb24oIG91dCApIHtcbiAgICAgICAgb3V0ID0gb3V0IHx8IHt9O1xuXG4gICAgICAgIGZvciAoIHZhciBpID0gMTsgaSA8IGFyZ3VtZW50cy5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBvYmogPSBhcmd1bWVudHNbIGkgXTtcblxuICAgICAgICAgICAgaWYgKCAhIG9iaiApe1xuICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IgKCB2YXIga2V5IGluIG9iaiApIHtcbiAgICAgICAgICAgICAgICBpZiAoIG9iai5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICggdHlwZW9mIG9ialsga2V5IF0gPT09ICdvYmplY3QnICl7XG4gICAgICAgICAgICAgICAgICAgICAgICBvdXRbIGtleSBdID0gZGVlcEV4dGVuZCggb3V0WyBrZXkgXSwgb2JqWyBrZXkgXSApO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgb3V0WyBrZXkgXSA9IG9ialsga2V5IF07XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV4dGVuZCA9IGZ1bmN0aW9uKG91dCkge1xuICAgICAgICBvdXQgPSBvdXQgfHwge307XG5cbiAgICAgICAgZm9yICggdmFyIGkgPSAxOyBpIDwgYXJndW1lbnRzLmxlbmd0aDsgaSsrICkge1xuICAgICAgICAgICAgaWYgKCAhIGFyZ3VtZW50c1sgaSBdICl7XG4gICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZvciAoIHZhciBrZXkgaW4gYXJndW1lbnRzWyBpIF0gKSB7XG4gICAgICAgICAgICAgICAgaWYgKCBhcmd1bWVudHNbIGkgXS5oYXNPd25Qcm9wZXJ0eSgga2V5ICkgKXtcbiAgICAgICAgICAgICAgICAgICAgb3V0WyBrZXkgXSA9IGFyZ3VtZW50c1sgaSBdWyBrZXkgXTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gb3V0O1xuICAgIH07XG4gICAgXG4gICAgdmFyIGFqYXggPSBmdW5jdGlvbiggY29uZiApe1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgY29uZiBvYmplY3RcbiAgICAgICAgaWYgKCAhIGNvbmYgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gcHJvY2VzcyBhamF4OiBubyBhcmd1bWVudHMhJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoICEgY29uZi51cmwgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gcHJvY2VzcyBhamF4OiBubyBVUkwgZGVmaW5lZCEnO1xuICAgICAgICB9XG4gICAgICAgIGlmICggISBjb25mLmRvbmUgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gcHJvY2VzcyBhamF4OiBubyBkb25lIGNhbGxiYWNrIGRlZmluZWQhJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRG8gaXQhXG4gICAgICAgIHZhciBvUmVxID0gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBvUmVxLmFkZEV2ZW50TGlzdGVuZXIoIFxuICAgICAgICAgICAgJ2xvYWQnLFxuICAgICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDQwMCApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2VzcyFcbiAgICAgICAgICAgICAgICAgICAgY29uZi5kb25lKCBcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbmYucGFyc2VKU09OP1xuICAgICAgICAgICAgICAgICAgICAgICAgSlNPTi5wYXJzZSggb1JlcS5yZXNwb25zZVRleHQgKTpcbiAgICAgICAgICAgICAgICAgICAgICAgIG9SZXEucmVzcG9uc2VUZXh0XG4gICAgICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gV2UgcmVhY2hlZCBvdXIgdGFyZ2V0IHNlcnZlciwgYnV0IGl0IHJldHVybmVkIGFuIGVycm9yXG4gICAgICAgICAgICAgICAgICAgIGNvbmYuZmFpbCggdW5kZWZpbmVkLCB1bmRlZmluZWQsIHRoaXMuc3RhdHVzVGV4dCApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCBjb25mLmZhaWwgKXtcbiAgICAgICAgICAgIG9SZXEuYWRkRXZlbnRMaXN0ZW5lciggJ2Vycm9yJywgY29uZi5mYWlsICk7XG4gICAgICAgIH1cbiAgICAgICAgb1JlcS5vcGVuKCAnR0VUJywgY29uZi51cmwgKTtcbiAgICAgICAgb1JlcS5zZW5kKCk7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2V0SlNPTiA9IGZ1bmN0aW9uKCBjb25mICl7XG4gICAgICAgIFxuICAgICAgICBjb25mLnBhcnNlSlNPTiA9IHRydWU7XG4gICAgICAgIGFqYXgoIGNvbmYgKTtcbiAgICB9O1xuICAgIFxuICAgIC8qXG4gICAgdmFyIGdldEpTT04gPSBmdW5jdGlvbiggY29uZiApe1xuICAgICAgICBcbiAgICAgICAgLy8gQ2hlY2sgY29uZiBvYmplY3RcbiAgICAgICAgaWYgKCAhIGNvbmYgKXtcbiAgICAgICAgICAgIHRocm93ICdFcnJvciB0cnlpbmcgdG8gZ2V0SlNPTjogbm8gYXJndW1lbnRzISc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCAhIGNvbmYudXJsICl7XG4gICAgICAgICAgICB0aHJvdyAnRXJyb3IgdHJ5aW5nIHRvIGdldEpTT046IG5vIFVSTCBkZWZpbmVkISc7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCAhIGNvbmYuZG9uZSApe1xuICAgICAgICAgICAgdGhyb3cgJ0Vycm9yIHRyeWluZyB0byBnZXRKU09OOiBubyBkb25lIGNhbGxiYWNrIGRlZmluZWQhJztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gRG8gaXQhXG4gICAgICAgIHZhciBvUmVxID0gbmV3IHdpbmRvdy5YTUxIdHRwUmVxdWVzdCgpO1xuICAgICAgICBvUmVxLmFkZEV2ZW50TGlzdGVuZXIoIFxuICAgICAgICAgICAgJ2xvYWQnLFxuICAgICAgICAgICAgZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICBpZiAoIHRoaXMuc3RhdHVzID49IDIwMCAmJiB0aGlzLnN0YXR1cyA8IDQwMCApIHtcbiAgICAgICAgICAgICAgICAgICAgLy8gU3VjY2VzcyFcbiAgICAgICAgICAgICAgICAgICAgY29uZi5kb25lKCBcbiAgICAgICAgICAgICAgICAgICAgICAgIEpTT04ucGFyc2UoIFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9SZXEucmVzcG9uc2VUZXh0IFxuICAgICAgICAgICAgICAgICAgICAgICAgKSBcbiAgICAgICAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAvLyBXZSByZWFjaGVkIG91ciB0YXJnZXQgc2VydmVyLCBidXQgaXQgcmV0dXJuZWQgYW4gZXJyb3JcbiAgICAgICAgICAgICAgICAgICAgY29uZi5mYWlsKCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgdGhpcy5zdGF0dXNUZXh0ICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICBpZiAoIGNvbmYuZmFpbCApe1xuICAgICAgICAgICAgb1JlcS5hZGRFdmVudExpc3RlbmVyKCAnZXJyb3InLCBjb25mLmZhaWwgKTtcbiAgICAgICAgfVxuICAgICAgICBvUmVxLm9wZW4oICdHRVQnLCBjb25mLnVybCApO1xuICAgICAgICBvUmVxLnNlbmQoKTtcbiAgICB9O1xuICAgICovXG4gICAgLypcbiAgICB2YXIgZ2V0Tm9kZUlkID0gZnVuY3Rpb24gKCBub2RlICl7XG4gICAgICAgIHJldHVybiBub2RlLmdldEF0dHJpYnV0ZSggY29udGV4dC5nZXRUYWdzKCkuaWQgKTtcbiAgICB9O1xuICAgICovXG4gICAgdmFyIGRlZXBFcXVhbCA9IGZ1bmN0aW9uKCB4LCB5ICkge1xuICAgICAgICByZXR1cm4gKHggJiYgeSAmJiB0eXBlb2YgeCA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIHkgPT09ICdvYmplY3QnKSA/XG4gICAgICAgICAgICAoT2JqZWN0LmtleXMoeCkubGVuZ3RoID09PSBPYmplY3Qua2V5cyh5KS5sZW5ndGgpICYmIE9iamVjdC5rZXlzKHgpLnJlZHVjZShmdW5jdGlvbihpc0VxdWFsLCBrZXkpIHtyZXR1cm4gaXNFcXVhbCAmJiBkZWVwRXF1YWwoeFtrZXldLCB5W2tleV0pO30sIHRydWUpOlxuICAgICAgICAgICAgKHggPT09IHkpO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGNvcHlBcnJheSA9IGZ1bmN0aW9uKCBhcnJheVRvQ29weSApe1xuICAgICAgICBcbiAgICAgICAgdmFyIHJlc3VsdCA9IFtdO1xuICAgICAgICBcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgYXJyYXlUb0NvcHkubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIHJlc3VsdC5wdXNoKCBhcnJheVRvQ29weVsgaSBdICk7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfTtcbiAgICBcbiAgICB2YXIgZ2VuZXJpY1RvU3RyaW5nID0gZnVuY3Rpb24oIGVsZW1lbnQgKXtcbiAgICBcbiAgICAgICAgaWYgKCBlbGVtZW50ID09IHVuZGVmaW5lZCApe1xuICAgICAgICAgICAgcmV0dXJuICd1bmRlZmluZWQnO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBpZiAoIEFycmF5LmlzQXJyYXkoIGVsZW1lbnQgKSApe1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9ICdBcnJheVsgJztcbiAgICAgICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IGVsZW1lbnQubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgICAgICB2YXIgc2VwYXJhdG9yID0gaSA9PT0gMD8gJyc6ICcsICc7XG4gICAgICAgICAgICAgICAgcmVzdWx0ICs9IHNlcGFyYXRvciArIGdlbmVyaWNUb1N0cmluZyggZWxlbWVudFsgaSBdICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXN1bHQgKz0gJyBdJztcbiAgICAgICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIGlmICggaXNQbGFpbk9iamVjdCggZWxlbWVudCApICl7XG4gICAgICAgICAgICByZXR1cm4gSlNPTi5zdHJpbmdpZnkoIGVsZW1lbnQgKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgLy8gTXVzdCBiZSBudW1lcmljIG9yIHN0cmluZ1xuICAgICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9O1xuICAgIFxuICAgIHJldHVybiB7XG4gICAgICAgIGdlbmVyYXRlSWQ6IGdlbmVyYXRlSWQsXG4gICAgICAgIC8vaXNBcnJheTogaXNBcnJheSxcbiAgICAgICAgaXNGdW5jdGlvbjogaXNGdW5jdGlvbixcbiAgICAgICAgaXNQbGFpbk9iamVjdDogaXNQbGFpbk9iamVjdCxcbiAgICAgICAgZGVlcEV4dGVuZDogZGVlcEV4dGVuZCxcbiAgICAgICAgZXh0ZW5kOiBleHRlbmQsXG4gICAgICAgIGdldEpTT046IGdldEpTT04sXG4gICAgICAgIGFqYXg6IGFqYXgsXG4gICAgICAgIGRlZXBFcXVhbDogZGVlcEVxdWFsLFxuICAgICAgICBjb3B5QXJyYXk6IGNvcHlBcnJheSxcbiAgICAgICAgZ2VuZXJpY1RvU3RyaW5nOiBnZW5lcmljVG9TdHJpbmdcbiAgICAgICAgLy9nZXROb2RlSWQ6IGdldE5vZGVJZFxuICAgIH07XG59KSgpO1xuIiwiLy8gZ2VuZXJhdGVkIGJ5IGdlbnZlcnNpb25cbm1vZHVsZS5leHBvcnRzID0gJzAuNDAuMydcbiIsIi8qISB6emRvbSAtIHYwLjIuMCAtIDIwMjAtMTEtMTIgMTM6MzI6NTEgKi9cbi8qKlxuICogQSBuYW1lc3BhY2UuXG4gKiBAY29uc3RcbiAqL1xudmFyIHp6RE9NID0ge307XG5cbi8qXG4gICAgenogZnVuY3Rpb25cbiAgICBcbiAgICB6eiggJyMnLCAnaWQnICk7XG4gICAgenooICcuJywgJ2NsYXNzTmFtZScgKTtcbiAgICB6eiggJ3QnLCAndGFnTmFtZScgKTtcbiAgICB6eiggJ3RuJywgJ25hbWVzcGFjZScsICd0YWdOYW1lJyApO1xuICAgIHp6KCAnbicsICduYW1lJyApO1xuICAgIHp6KCAncycsICdzdHJpbmcgc2VsZWN0b3InICk7XG4gICAgenooIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAnaWQnICkgKTsgLy8gRWxlbWVudFxuICAgIHp6KCBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKCAnY2xhc3NOYW1lJyApICk7IC8vIEhUTUxDb2xsZWN0aW9uXG4gICAgenooIGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCAnbmFtZScgKSApOyAvLyBOb2RlTGlzdFxuICAgIHp6KCAndGFibGUuY2xhc3NOYW1lIHRyIHRkJyApOyAvLyBTdHJpbmcgc2VsZWN0b3JcbiAgICB6eiggJzxkaXY+TmV3IGRpdjwvZGl2PicgKTsgLy8gSFRNTCBjb2RlIGluIHN0cmluZ1xuKi9cbi8qKlxuICogQHBhcmFtIHtzdHJpbmd8RWxlbWVudHxIVE1MQ29sbGVjdGlvbnxOb2RlTGlzdH0geFxuICogQHBhcmFtIHtzdHJpbmc9fSBzMVxuICogQHBhcmFtIHtzdHJpbmc9fSBzMiBcbiAqL1xuenpET00uenogPSBmdW5jdGlvbiggeCwgczEsIHMyICl7XG4gICAgXG4gICAgLy8gUmVkZWZpbmUgeCBpZiBhIHNlbGVjdG9yIGlkIGlzIGZvdW5kXG4gICAgaWYgKCBzMSApe1xuICAgICAgICBzd2l0Y2ggKCB4ICl7XG4gICAgICAgIGNhc2UgJyMnOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCBzMSApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJy4nOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoIHMxICk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndCc6XG4gICAgICAgICAgICB4ID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUoIHMxICk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAndG4nOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lTlMoIHMxLCBzMiB8fCAnJyApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ24nOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlOYW1lKCBzMSApO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ3MnOlxuICAgICAgICAgICAgeCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoIHMxICk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93ICdVbnN1cHBvcnRlZCBzZWxlY3RvciBpZCBmb3VuZCBydW5uaW5nIHp6IGZ1bmN0aW9uOiAnICsgeDtcbiAgICAgICAgfVxuICAgIH1cbiAgICBcbiAgICAvLyBJcyBpdCBhbiBFbGVtZW50P1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEVsZW1lbnQgKXtcbiAgICAgICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggeCApO1xuICAgIH1cbiAgICBcbiAgICAvLyBJcyBpdCBhbiBIVE1MQ29sbGVjdGlvbiBvciBhIE5vZGVMaXN0P1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEhUTUxDb2xsZWN0aW9uIHx8IHggaW5zdGFuY2VvZiBOb2RlTGlzdCApe1xuICAgICAgICByZXR1cm4genpET00uX2J1aWxkKCB4ICk7XG4gICAgfVxuICAgIFxuICAgIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICl7XG4gICAgICAgIHggPSB4LnRyaW0oKTtcbiAgICAgICAgcmV0dXJuIHp6RE9NLl9idWlsZChcbiAgICAgICAgICAgIHguY2hhckF0KCAwICkgPT09ICc8Jz8gLy8gSXMgaXQgSFRNTCBjb2RlP1xuICAgICAgICAgICAgICAgIHp6RE9NLl9odG1sVG9FbGVtZW50KCB4ICk6XG4gICAgICAgICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCggeCApIC8vIE11c3QgYmUgYSBzdGFuZGFyZCBzZWxlY3RvclxuICAgICAgICApO1xuICAgIH1cbiAgICBcbiAgICB0aHJvdyAnVW5zdXBwb3J0ZWQgc2VsZWN0b3IgdHlwZSBmb3VuZCBydW5uaW5nIHp6IGZ1bmN0aW9uLic7XG59O1xuXG4vLyBCdWlsZCBhcmdzIGFycmF5IHdpdGggdG9JbnNlcnQgYXMgZmlyc3QgcG9zaXRpb24gYW5kIHRoZW4gdGhlIGFyZ3VtZW50cyBvZiB0aGlzIGZ1bmN0aW9uXG56ekRPTS5fYXJncyA9IGZ1bmN0aW9uKCBwcmV2aW91c0FyZ3MsIHRvSW5zZXJ0ICl7XG4gICAgdmFyIHJlc3VsdCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCBwcmV2aW91c0FyZ3MgKTtcbiAgICByZXN1bHQucHVzaCggdG9JbnNlcnQgKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufTtcblxuenpET00uX2J1aWxkID0gZnVuY3Rpb24gKCB4ICkge1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEVsZW1lbnQgKXtcbiAgICAgICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggeCApO1xuICAgIH1cbiAgICBpZiAoIHggaW5zdGFuY2VvZiBIVE1MQ29sbGVjdGlvbiB8fCB4IGluc3RhbmNlb2YgTm9kZUxpc3QgKXtcbiAgICAgICAgeCA9IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKCB4ICk7XG4gICAgfVxuICAgIHJldHVybiB4Lmxlbmd0aCA9PT0gMT8gbmV3IHp6RE9NLlNTKCB4WyAwIF0gKTogbmV3IHp6RE9NLk1NKCB4ICk7XG59O1xuXG56ekRPTS5fZ2V0RXJyb3IgPSBmdW5jdGlvbiAoIG1ldGhvZCApIHtcbiAgICByZXR1cm4gJ01ldGhvZCBcIicgKyBtZXRob2QgKyAnXCIgbm90IHJlYWR5IGZvciB0aGF0IHR5cGUhJztcbn07XG5cbnp6RE9NLl9odG1sVG9FbGVtZW50ID0gZnVuY3Rpb24gKCBodG1sICkge1xuICAgIHZhciB0ZW1wbGF0ZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoICd0ZW1wbGF0ZScgKTtcbiAgICB0ZW1wbGF0ZS5pbm5lckhUTUwgPSBodG1sLnRyaW0oKTtcbiAgICByZXR1cm4gdGVtcGxhdGUuY29udGVudC5jaGlsZEVsZW1lbnRDb3VudCA9PT0gMT9cbiAgICAgICAgdGVtcGxhdGUuY29udGVudC5maXJzdENoaWxkOlxuICAgICAgICB0ZW1wbGF0ZS5jb250ZW50LmNoaWxkTm9kZXM7XG59O1xuXG4vLyBSZWdpc3RlciB6eiBmdW5jdGlvblxudmFyIHp6O1xuKGZ1bmN0aW9uKCkgeyBcbiAgICB6eiA9IHp6RE9NLnp6OyBcbn0pKCk7XG5cbnp6RE9NLl9ldmVudHMgPSB7fTtcblxuenpET00uX2FkZEV2ZW50TGlzdGVuZXIgPSBmdW5jdGlvbiggc3MsIGV2ZW50TmFtZSwgbGlzdGVuZXIsIHVzZUNhcHR1cmUgKXtcbiAgICB2YXIgZWwgPSBzcy5lbDtcbiAgICB2YXIgZWxJZCA9IHNzLl9nZXRFbElkKCk7XG4gICAgdmFyIHRoaXNFdmVudHMgPSB6ekRPTS5fZXZlbnRzWyBlbElkIF07XG4gICAgaWYgKCAhIHRoaXNFdmVudHMgKXtcbiAgICAgICAgdGhpc0V2ZW50cyA9IHt9O1xuICAgICAgICB6ekRPTS5fZXZlbnRzWyBlbElkIF0gPSB0aGlzRXZlbnRzO1xuICAgIH1cbiAgICB2YXIgdGhpc0xpc3RlbmVycyA9IHRoaXNFdmVudHNbIGV2ZW50TmFtZSBdO1xuICAgIGlmICggISB0aGlzTGlzdGVuZXJzICl7XG4gICAgICAgIHRoaXNMaXN0ZW5lcnMgPSBbXTtcbiAgICAgICAgdGhpc0V2ZW50c1sgZXZlbnROYW1lIF0gPSB0aGlzTGlzdGVuZXJzO1xuICAgIH1cbiAgICB0aGlzTGlzdGVuZXJzLnB1c2goIGxpc3RlbmVyICk7XG4gICAgXG4gICAgLy8gYWRkRXZlbnRMaXN0ZW5lclxuICAgIGVsLmFkZEV2ZW50TGlzdGVuZXIoIGV2ZW50TmFtZSwgbGlzdGVuZXIsIHVzZUNhcHR1cmUgKTtcbn07XG5cbi8vVE9ETyBtdXN0IHJlbW92ZSBhbGwgbGlzdGVuZXJzIHdoZW4gYW4gZWxlbWVudCBpcyByZW1vdmVkXG56ekRPTS5fcmVtb3ZlRXZlbnRMaXN0ZW5lciA9IGZ1bmN0aW9uKCBzcywgZXZlbnROYW1lLCBsaXN0ZW5lciwgdXNlQ2FwdHVyZSApe1xuICAgIHZhciBlbCA9IHNzLmVsO1xuICAgIHZhciBlbElkID0gc3MuX2dldEVsSWQoKTtcbiAgICB2YXIgdGhpc0V2ZW50cyA9IHp6RE9NLl9ldmVudHNbIGVsSWQgXTtcbiAgICBpZiAoICEgdGhpc0V2ZW50cyApe1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIFxuICAgIGlmICggISBldmVudE5hbWUgKXsgXG4gICAgICAgIC8vIE11c3QgcmVtb3ZlIGFsbCBldmVudHNcbiAgICAgICAgZm9yICggdmFyIGN1cnJlbnRFdmVudE5hbWUgaW4gdGhpc0V2ZW50cyApe1xuICAgICAgICAgICAgdmFyIGN1cnJlbnRMaXN0ZW5lcnMgPSB0aGlzRXZlbnRzWyBjdXJyZW50RXZlbnROYW1lIF07XG4gICAgICAgICAgICB6ekRPTS5fcmVtb3ZlTGlzdGVuZXJzKCBlbCwgY3VycmVudExpc3RlbmVycywgbnVsbCwgdXNlQ2FwdHVyZSwgY3VycmVudEV2ZW50TmFtZSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgLy8gTXVzdCByZW1vdmUgbGlzdGVuZXJzIG9mIG9ubHkgb25lIGV2ZW50XG4gICAgdmFyIHRoaXNMaXN0ZW5lcnMgPSB0aGlzRXZlbnRzWyBldmVudE5hbWUgXTtcbiAgICB6ekRPTS5fcmVtb3ZlTGlzdGVuZXJzKCBlbCwgdGhpc0xpc3RlbmVycywgbGlzdGVuZXIsIHVzZUNhcHR1cmUsIGV2ZW50TmFtZSApO1xufTtcblxuLy9UT0RPIHRlc3QgYWxsIHRoZSBsaXN0ZW5lcnMgYXJlIHJlbW92ZWRcbnp6RE9NLl9yZW1vdmVMaXN0ZW5lcnMgPSBmdW5jdGlvbiggZWwsIHRoaXNMaXN0ZW5lcnMsIGxpc3RlbmVyLCB1c2VDYXB0dXJlLCBldmVudE5hbWUgKXtcbiAgICBpZiAoICEgdGhpc0xpc3RlbmVycyApe1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXNMaXN0ZW5lcnMubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgdmFyIGN1cnJlbnRMaXN0ZW5lciA9IHRoaXNMaXN0ZW5lcnNbIGkgXTtcbiAgICAgICAgaWYgKCAhIGxpc3RlbmVyIHx8IGN1cnJlbnRMaXN0ZW5lciA9PT0gbGlzdGVuZXIgKXtcbiAgICAgICAgICAgIHRoaXNMaXN0ZW5lcnMuc3BsaWNlKCBpLCAxICk7IC8vIERlbGV0ZSBsaXN0ZW5lciBhdCBpIHBvc2l0aW9uXG4gICAgICAgICAgICBlbC5yZW1vdmVFdmVudExpc3RlbmVyKCBldmVudE5hbWUsIGN1cnJlbnRMaXN0ZW5lciwgdXNlQ2FwdHVyZSApO1xuICAgICAgICAgICAgaWYgKCBsaXN0ZW5lciApe1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH0gXG59O1xuLyogRW5kIG9mIGV2ZW50cyAqL1xuXG56ekRPTS5fZGQgPSB7fTtcblxuenpET00uX2dldERlZmF1bHREaXNwbGF5ID0gZnVuY3Rpb24oIGVsICkge1xuICAgIHZhciBub2RlTmFtZSA9IGVsLm5vZGVOYW1lO1xuICAgIHZhciBkaXNwbGF5ID0genpET00uX2RkWyBub2RlTmFtZSBdO1xuXG4gICAgaWYgKCBkaXNwbGF5ICkge1xuICAgICAgICByZXR1cm4gZGlzcGxheTtcbiAgICB9XG5cbiAgICB2YXIgZG9jID0gZWwub3duZXJEb2N1bWVudDtcbiAgICB2YXIgdGVtcCA9IGRvYy5ib2R5LmFwcGVuZENoaWxkKCBkb2MuY3JlYXRlRWxlbWVudCggbm9kZU5hbWUgKSApO1xuICAgIGRpc3BsYXkgPSBnZXRDb21wdXRlZFN0eWxlKCB0ZW1wIClbICdkaXNwbGF5JyBdO1xuXG4gICAgdGVtcC5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKCB0ZW1wICk7XG5cbiAgICBpZiAoIGRpc3BsYXkgPT09ICdub25lJyApIHtcbiAgICAgICAgZGlzcGxheSA9ICdibG9jayc7XG4gICAgfVxuICAgIHp6RE9NLl9kZFsgbm9kZU5hbWUgXSA9IGRpc3BsYXk7XG5cbiAgICByZXR1cm4gZGlzcGxheTtcbn07XG4vKiBFbmQgb2YgdmlzaWJsZSAqL1xuXG4vKiBJdCBkZXBlbmRzIG9uIGZvcm1zIHBsdWdpbiEgKi9cbi8vIFNlcmlhbGl6ZSBhIHNzIGluc3RhbmNlLCBhIG1tIGluc3RhbmNlIG9yIGFuIG9iamVjdCBpbnRvIGEgcXVlcnkgc3RyaW5nXG56ekRPTS5fcGFyYW1JdGVtID0gZnVuY3Rpb24oIHIsIGtleSwgdmFsdWUgKSB7XG4gICAgci5wdXNoKCBcbiAgICAgICAgZW5jb2RlVVJJQ29tcG9uZW50KCBrZXkgKSArICc9JyArIGVuY29kZVVSSUNvbXBvbmVudCggdmFsdWUgPT0gbnVsbD8gJyc6IHZhbHVlIClcbiAgICApO1xufTtcbi8qKiBAbm9jb2xsYXBzZSAqL1xuenpET00ucGFyYW0gPSBmdW5jdGlvbiggeCApIHtcblx0XG4gICAgaWYgKCB4ID09IG51bGwgKSB7XG4gICAgICAgIHJldHVybiAnJztcbiAgICB9XG5cbiAgICB2YXIgciA9IFtdO1xuICAgIFxuICAgIGlmICggeCBpbnN0YW5jZW9mIHp6RE9NLlNTICl7XG4gICAgICAgIHp6RE9NLl9wYXJhbUl0ZW0oIHIsIHguYXR0ciggJ25hbWUnICksIHgudmFsKCkgKTtcbiAgICB9IGVsc2UgaWYgKCB4IGluc3RhbmNlb2YgenpET00uTU0gKXtcbiAgICAgICAgZm9yICggdmFyIGMgPSAwOyBjIDwgeC5saXN0Lmxlbmd0aDsgKytjICl7XG4gICAgICAgICAgICB2YXIgc3MgPSB4Lmxpc3RbIGMgXTtcbiAgICAgICAgICAgIHp6RE9NLl9wYXJhbUl0ZW0oIHIsIHNzLmF0dHIoICduYW1lJyApLCBzcy52YWwoKSApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdvYmplY3QnICl7ICBcbiAgICAgICAgZm9yICggdmFyIGkgaW4geCApIHtcbiAgICAgICAgICAgIHp6RE9NLl9wYXJhbUl0ZW0oIHIsIGksIHhbIGkgXSApO1xuICAgICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgenpET00uX2dldEVycm9yKCAncGFyYW0nICk7XG4gICAgfVxuXG4gICAgcmV0dXJuIHIuam9pbiggJyYnICk7XG59O1xuLyogZW5kIG9mIHV0aWxzICovXG5cbi8qKiBAY29uc3RydWN0b3IgKi9cbnp6RE9NLlNTID0gZnVuY3Rpb24gKCBfZWwgKSB7XG4gICAgdGhpcy5lbCA9IF9lbDtcbiAgICB0aGlzLm5vZGVzID0gWyBfZWwgXTtcbiAgICBcbiAgICAvLyBBcnJheSBsaWtlXG4gICAgdGhpcy5sZW5ndGggPSAxO1xuICAgIHRoaXNbIDAgXSA9IF9lbDtcbn07XG5cbi8qIE1ldGhvZHMgTk9UIGluY2x1ZGVkIGluIGpxdWVyeSAqL1xuenpET00uU1MucHJvdG90eXBlLl9nY3MgPSBmdW5jdGlvbiAoIHNlbGYsIHByb3BlcnR5ICkge1xuICAgIHZhciB4ID0gZ2V0Q29tcHV0ZWRTdHlsZSggc2VsZi5lbCwgbnVsbCApWyBwcm9wZXJ0eSBdLnJlcGxhY2UoICdweCcsICcnICk7XG4gICAgcmV0dXJuIGlzTmFOKCB4ICk/IHg6IHBhcnNlRmxvYXQoIHggKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5fZ2V0RWxJZCA9IGZ1bmN0aW9uKCl7XG4gICAgdmFyIGVsSWQgPSB0aGlzLmVsLmdldEF0dHJpYnV0ZSggJ2RhdGEtZWxJZCcgKTtcbiAgICBpZiAoICEgZWxJZCApe1xuICAgICAgICAvLyBHZW5lcmF0ZSBhIHJhbmRvbSBzdHJpbmcgd2l0aCA0IGNoYXJzXG4gICAgICAgIGVsSWQgPSBNYXRoLmZsb29yKCAoIDEgKyBNYXRoLnJhbmRvbSgpICkgKiAweDEwMDAwIClcbiAgICAgICAgICAgIC50b1N0cmluZyggMTYgKVxuICAgICAgICAgICAgLnN1YnN0cmluZyggMSApO1xuICAgICAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSggJ2RhdGEtZWxJZCcsIGVsSWQgKTtcbiAgICB9XG4gICAgcmV0dXJuIGVsSWQ7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX2luc2VydEhlbHBlciA9IGZ1bmN0aW9uICggcG9zaXRpb24sIHggKSB7XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgRWxlbWVudCApe1xuICAgICAgICB0aGlzLmVsLmluc2VydEFkamFjZW50RWxlbWVudCggcG9zaXRpb24sIHggKTtcbiAgICB9IGVsc2UgaWYgKCB4IGluc3RhbmNlb2YgenpET00uU1MgKXtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRBZGphY2VudEVsZW1lbnQoIHBvc2l0aW9uLCB4LmVsICk7XG4gICAgfSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICkge1xuICAgICAgICB0aGlzLmVsLmluc2VydEFkamFjZW50SFRNTCggcG9zaXRpb24sIHggKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyAnSW5zZXJ0IG9wZXJhdGlvbiBub3QgcmVhZHkgZm9yIHRoYXQgdHlwZSEnO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5faXRlcmF0ZSA9IGZ1bmN0aW9uKCB2YWx1ZSwgZm4gKXtcbiAgICBpZiAoIEFycmF5LmlzQXJyYXkoIHZhbHVlICkgKXtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgdmFsdWUubGVuZ3RoOyArK2kgKXtcbiAgICAgICAgICAgIGZuKCB0aGlzLCB2YWx1ZVsgaSBdICk7XG4gICAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgICBmbiggdGhpcywgdmFsdWUgKTsgICBcbiAgICB9XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuX291dGVyID0gZnVuY3Rpb24gKCBwcm9wZXJ0eSwgbGlua2VkMSwgbGlua2VkMiwgd2l0aE1hcmdpbiApIHtcbiAgICBpZiAoIHRoaXMuZWxbICdvZmZzZXQnICsgcHJvcGVydHkgXSApIHtcbiAgICAgICAgcmV0dXJuIHp6RE9NLlNTLl9vdXRlckNhbGMoIHRoaXMsIHByb3BlcnR5LCBsaW5rZWQxLCBsaW5rZWQyLCB3aXRoTWFyZ2luICk7XG4gICAgfVxuICAgIFxuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICByZXR1cm4gdGhpcy5fc3dhcCggXG4gICAgICAgIHRoaXMuZWwsIFxuICAgICAgICBmdW5jdGlvbigpe1xuICAgICAgICAgICAgcmV0dXJuIHp6RE9NLlNTLl9vdXRlckNhbGMoIHNlbGYsIHByb3BlcnR5LCBsaW5rZWQxLCBsaW5rZWQyLCB3aXRoTWFyZ2luICk7XG4gICAgICAgIH0gXG4gICAgKTtcbn07XG5cbnp6RE9NLlNTLl9vdXRlckNhbGMgPSBmdW5jdGlvbiAoIHNzLCBwcm9wZXJ0eSwgbGlua2VkMSwgbGlua2VkMiwgd2l0aE1hcmdpbiApIHtcbiAgICB2YXIgdmFsdWUgPSBzcy5fZ2NzKCBzcywgcHJvcGVydHkudG9Mb3dlckNhc2UoKSApO1xuICAgIHZhciBwYWRkaW5nID0gc3MuX2djcyggc3MsICdwYWRkaW5nJyArIGxpbmtlZDEgKSArIHNzLl9nY3MoIHNzLCAncGFkZGluZycgKyBsaW5rZWQyICk7XG4gICAgdmFyIGJvcmRlciA9IHNzLl9nY3MoIHNzLCAnYm9yZGVyJyArIGxpbmtlZDEgKyAnV2lkdGgnICkgKyBzcy5fZ2NzKCBzcywgJ2JvcmRlcicgKyBsaW5rZWQyICsgJ1dpZHRoJyApO1xuICAgIFxuICAgIHZhciB0b3RhbCA9IHZhbHVlICsgcGFkZGluZyArIGJvcmRlcjtcbiAgICBcbiAgICAvLyBObyBtYXJnaW5cbiAgICBpZiAoICEgd2l0aE1hcmdpbiApe1xuICAgICAgICByZXR1cm4gdG90YWw7XG4gICAgfVxuICAgIFxuICAgIHZhciBtYXJnaW4gPSBzcy5fZ2NzKCBzcywgJ21hcmdpbicgKyBsaW5rZWQxICkgKyBzcy5fZ2NzKCBzcywgJ21hcmdpbicgKyBsaW5rZWQyICk7XG4gICAgcmV0dXJuIHRvdGFsICsgbWFyZ2luO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLl9zZXRDc3NVc2luZ0tleVZhbHVlID0gZnVuY3Rpb24gKCBrZXksIHZhbHVlICkge1xuICAgIGlmICggdHlwZW9mIHZhbHVlID09PSAnZnVuY3Rpb24nICkge1xuICAgICAgICB2YWx1ZSA9IHZhbHVlLmNhbGwoIHRoaXMuZWwsIHRoaXMuX2kgPT09IHVuZGVmaW5lZD8gMDogdGhpcy5faSwgdGhpcyApO1xuICAgIH1cbiAgICB0aGlzLmVsLnN0eWxlWyBrZXkgXSA9IFxuICAgICAgICB0eXBlb2YgdmFsdWUgPT09ICdzdHJpbmcnICYmICEgL14tP1xcZCtcXC4/XFxkKiQvLnRlc3QoIHZhbHVlICk/IC8vIGlmIGl0IGlzIGEgc3RyaW5nIGFuZCBpcyBub3QgYSBmbG9hdCBudW1iZXJcbiAgICAgICAgICAgIHZhbHVlOiBcbiAgICAgICAgICAgIHZhbHVlICsgJ3B4Jztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5fc2V0Q3NzVXNpbmdPYmplY3QgPSBmdW5jdGlvbiAoIG9iamVjdCApIHtcbiAgICBmb3IgKCB2YXIga2V5IGluIG9iamVjdCApIHtcbiAgICAgICAgdGhpcy5fc2V0Q3NzVXNpbmdLZXlWYWx1ZSgga2V5LCBvYmplY3RbIGtleSBdICk7XG4gICAgfVxufTtcblxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvcGVydHlcbiAqIEBwYXJhbSB7c3RyaW5nfEZ1bmN0aW9uPX0gdmFsdWVcbiAqL1xuenpET00uU1MucHJvdG90eXBlLl9zdHlsZVByb3BlcnR5ID0gZnVuY3Rpb24gKCBwcm9wZXJ0eSwgdmFsdWUgKSB7XG4gICAgLy8gZ2V0XG4gICAgaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHZhciBzZWxmID0gdGhpcztcbiAgICAgICAgdmFsdWUgPSB0aGlzLl9nY3MoIHRoaXMsIHByb3BlcnR5ICk7XG4gICAgICAgIHJldHVybiBwYXJzZUZsb2F0KCBcbiAgICAgICAgICAgIHZhbHVlICE9PSAnYXV0byc/IFxuICAgICAgICAgICAgICAgIHZhbHVlOiBcbiAgICAgICAgICAgICAgICB0aGlzLl9zd2FwKCBcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5lbCwgXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2VsZi5fZ2NzKCBzZWxmLCBwcm9wZXJ0eSApO1xuICAgICAgICAgICAgICAgICAgICB9IFxuICAgICAgICAgICAgICAgIClcbiAgICAgICAgKTtcbiAgICB9XG5cbiAgICAvLyBzZXRcbiAgICB0aGlzLl9zZXRDc3NVc2luZ0tleVZhbHVlKCBwcm9wZXJ0eSwgdmFsdWUgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5fc3dhcCA9IGZ1bmN0aW9uKCBfZWwsIGNhbGxiYWNrICkge1xuICAgIHZhciBvbGQgPSB7fTtcbiAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgZGlzcGxheTogJ2Jsb2NrJyxcbiAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgICAgIHZpc2liaWxpdHk6ICdoaWRkZW4nXG4gICAgfTtcblxuICAgIC8vIFJlbWVtYmVyIHRoZSBvbGQgdmFsdWVzIGFuZCBpbnNlcnQgdGhlIG5ldyBvbmVzXG4gICAgZm9yICggdmFyIG5hbWUgaW4gb3B0aW9ucyApIHtcbiAgICAgICAgb2xkWyBuYW1lIF0gPSBfZWwuc3R5bGVbIG5hbWUgXTtcbiAgICAgICAgX2VsLnN0eWxlWyBuYW1lIF0gPSBvcHRpb25zWyBuYW1lIF07XG4gICAgfVxuXG4gICAgdmFyIHZhbCA9IGNhbGxiYWNrLmNhbGwoIF9lbCApO1xuXG4gICAgLy8gUmV2ZXJ0IHRoZSBvbGQgdmFsdWVzXG4gICAgZm9yICggbmFtZSBpbiBvcHRpb25zICkge1xuICAgICAgICBfZWwuc3R5bGVbIG5hbWUgXSA9IG9sZFsgbmFtZSBdO1xuICAgIH1cblxuICAgIHJldHVybiB2YWw7XG59O1xuXG4vKiBNZXRob2RzIGluY2x1ZGVkIGluIGpxdWVyeSAqL1xuenpET00uU1MucHJvdG90eXBlLmFkZENsYXNzID0gZnVuY3Rpb24gKCBuYW1lICkge1xuICAgIHJldHVybiB0aGlzLl9pdGVyYXRlKFxuICAgICAgICBuYW1lLFxuICAgICAgICBmdW5jdGlvbiggc2VsZiwgdiApe1xuICAgICAgICAgICAgc2VsZi5lbC5jbGFzc0xpc3QuYWRkKCB2ICk7IFxuICAgICAgICB9XG4gICAgKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5hZnRlciA9IGZ1bmN0aW9uICggeCApIHtcbiAgICByZXR1cm4gdGhpcy5faW5zZXJ0SGVscGVyKCAnYWZ0ZXJlbmQnLCB4ICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24gKCB4ICkge1xuICAgIGlmICggeCBpbnN0YW5jZW9mIEVsZW1lbnQgKXtcbiAgICAgICAgdGhpcy5lbC5hcHBlbmRDaGlsZCggeCApO1xuICAgIH0gZWxzZSBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5TUyApe1xuICAgICAgICB0aGlzLmVsLmFwcGVuZENoaWxkKCB4LmVsICk7XG4gICAgfSBlbHNlIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICkge1xuICAgICAgICB0aGlzLmVsLmluc2VydEFkamFjZW50SFRNTCggJ2JlZm9yZWVuZCcsIHggKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICdhcHBlbmQnICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmFwcGVuZFRvID0gZnVuY3Rpb24gKCB4ICkge1xuICAgIC8vIERvIG5vdGhpbmcgYW5kIHJldHVybiB0aGlzIGlmIGl0IGlzIG51bGxcbiAgICBpZiAoIHggPT0gbnVsbCApe1xuICAgICAgICByZXR1cm4gdGhpczsgICAgXG4gICAgfVxuICAgIFxuICAgIC8vIElzIGl0IGEgRWxlbWVudD9cbiAgICBpZiAoIHggaW5zdGFuY2VvZiBFbGVtZW50ICl7XG4gICAgICAgIHguYXBwZW5kQ2hpbGQoIHRoaXMuZWwgKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIFxuICAgIC8vIElzIGl0IGEgc3RyaW5nP1xuICAgIGlmICggdHlwZW9mIHggPT09ICdzdHJpbmcnICl7XG4gICAgICAgIHggPSB6ekRPTS5fYnVpbGQoXG4gICAgICAgICAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCB4IClcbiAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgLy8gSXMgaXQgYSB6ekRPTS5TUz9cbiAgICBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5TUyApIHtcbiAgICAgICAgeC5lbC5hcHBlbmRDaGlsZCggdGhpcy5lbCApO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgXG4gICAgLy8gSXMgaXQgYSB6ekRPTS5NTT9cbiAgICBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5NTSApIHtcbiAgICAgICAgZm9yICggdmFyIGkgPSAwOyBpIDwgeC5ub2Rlcy5sZW5ndGg7ICsraSApe1xuICAgICAgICAgICAgeC5ub2Rlc1sgaSBdLmFwcGVuZENoaWxkKCB0aGlzLmVsLmNsb25lTm9kZSggdHJ1ZSApICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfSBcbiAgICBcbiAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICdpcycgKTtcbn07XG5cbi8vVE9ETyBhZGQgc3VwcG9ydCBvZiBmdW5jdGlvbiB0eXBlIGluIHZhbHVlXG4vKipcbiAqIEBwYXJhbSB7c3RyaW5nfE9iamVjdH0geFxuICogQHBhcmFtIHtzdHJpbmc9fSB2YWx1ZVxuICovXG56ekRPTS5TUy5wcm90b3R5cGUuYXR0ciA9IGZ1bmN0aW9uICggeCwgdmFsdWUgKSB7XG4gICAgLy8gc2V0IHVzaW5nIG9iamVjdFxuICAgIGlmICggdHlwZW9mIHggPT09ICdvYmplY3QnICl7XG4gICAgICAgIGZvciAoIHZhciBrZXkgaW4geCApIHtcbiAgICAgICAgICAgIHRoaXMuYXR0cigga2V5LCB4WyBrZXkgXSApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBcbiAgICAvLyBnZXRcbiAgICBpZiAoIHZhbHVlID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwuZ2V0QXR0cmlidXRlKCB4ICk7XG4gICAgfVxuICAgIFxuICAgIC8vIHJlbW92ZSBhdHRyXG4gICAgaWYgKCB2YWx1ZSA9PT0gbnVsbCApe1xuICAgICAgICByZXR1cm4gdGhpcy5yZW1vdmVBdHRyKCB4ICk7ICAgIFxuICAgIH1cbiAgICBcbiAgICAvLyBzZXRcbiAgICB0aGlzLmVsLnNldEF0dHJpYnV0ZSggeCwgdmFsdWUgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5iZWZvcmUgPSBmdW5jdGlvbiAoIHggKSB7XG4gICAgcmV0dXJuIHRoaXMuX2luc2VydEhlbHBlciggJ2JlZm9yZWJlZ2luJywgeCApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmNoaWxkcmVuID0gZnVuY3Rpb24gKCBzZWxlY3RvciApIHtcbiAgICByZXR1cm4genpET00uX2J1aWxkKCBcbiAgICAgICAgc2VsZWN0b3I/XG4gICAgICAgICAgICBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoXG4gICAgICAgICAgICAgICAgdGhpcy5lbC5jaGlsZHJlbiwgXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24oIGNoaWxkICl7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZC5tYXRjaGVzKCBzZWxlY3RvciApO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICk6XG4gICAgICAgICAgICB0aGlzLmVsLmNoaWxkcmVuIFxuICAgICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuY2xvbmUgPSBmdW5jdGlvbiAoICApIHtcbiAgICByZXR1cm4gbmV3IHp6RE9NLlNTKCB0aGlzLmVsLmNsb25lTm9kZSggdHJ1ZSApICk7XG59O1xuXG4vL1RPRE8gYWRkIHN1cHBvcnQgb2YgZnVuY3Rpb24gdHlwZSBpbiB2YWx1ZVxuLyoqXG4gKiBAcGFyYW0ge3N0cmluZ3xPYmplY3R9IHgxXG4gKiBAcGFyYW0ge3N0cmluZ3xudW1iZXI9fSB4MlxuICovXG56ekRPTS5TUy5wcm90b3R5cGUuY3NzID0gZnVuY3Rpb24gKCB4MSwgeDIgKSB7XG4gICAgdmFyIG51bWJlciA9IGFyZ3VtZW50cy5sZW5ndGg7XG4gICAgXG4gICAgaWYgKCBudW1iZXIgPT09IDEgKXtcbiAgICAgICAgaWYgKCAhIHgxICl7XG4gICAgICAgICAgICB0aHJvdyAnTnVsbCB2YWx1ZSBub3QgYWxsb3dlZCBpbiBjc3MgbWV0aG9kISc7XG4gICAgICAgIH1cbiAgICAgICAgXG4gICAgICAgIC8vIGdldFxuICAgICAgICBpZiAoIHR5cGVvZiB4MSA9PT0gJ3N0cmluZycgKSB7XG4gICAgICAgICAgICByZXR1cm4gZ2V0Q29tcHV0ZWRTdHlsZSggdGhpcy5lbCApWyB4MSBdO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICAvLyBzZXQgdXNpbmcgb2JqZWN0XG4gICAgICAgIGlmICggdHlwZW9mIHgxID09PSAnb2JqZWN0JyApe1xuICAgICAgICAgICAgdGhpcy5fc2V0Q3NzVXNpbmdPYmplY3QoIHgxICk7XG4gICAgICAgICAgICByZXR1cm4gdGhpcztcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgdGhyb3cgJ1dyb25nIHR5cGUgb3IgYXJndW1lbnQgaW4gY3NzIG1ldGhvZCEnO1xuICAgIH1cbiAgICBcbiAgICAvLyBzZXQgdXNpbmcga2V5IHZhbHVlIHBhaXJcbiAgICBpZiAoIG51bWJlciA9PT0gMiApe1xuICAgICAgICB0aGlzLl9zZXRDc3NVc2luZ0tleVZhbHVlKCB4MSwgeDIgKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIFxuICAgIHRocm93ICdXcm9uZyBudW1iZXIgb2YgYXJndW1lbnRzIGluIGNzcyBtZXRob2QhJztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5lYWNoID0gZnVuY3Rpb24gKCBlYWNoRm4gKSB7XG4gICAgZWFjaEZuLmNhbGwoIHRoaXMuZWwsIDAsIHRoaXMsIHRoaXMubm9kZXMgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5lbXB0eSA9IGZ1bmN0aW9uICggICkge1xuICAgIHdoaWxlKCB0aGlzLmVsLmZpcnN0Q2hpbGQgKXtcbiAgICAgICAgdGhpcy5lbC5yZW1vdmVDaGlsZCggdGhpcy5lbC5maXJzdENoaWxkICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmZpbHRlciA9IGZ1bmN0aW9uICggeCApIHtcbiAgICBpZiAoIHR5cGVvZiB4ID09PSAnc3RyaW5nJyApeyAvLyBJcyBhIHN0cmluZyBzZWxlY3RvclxuICAgICAgICByZXR1cm4genpET00uX2J1aWxkKCBcbiAgICAgICAgICAgIHRoaXMuZWwubWF0Y2hlcyggeCApPyBbIHRoaXMuZWwgXTogW11cbiAgICAgICAgKTtcbiAgICB9XG4gICAgXG4gICAgaWYgKCB0eXBlb2YgeCA9PT0gJ2Z1bmN0aW9uJyApeyAvLyBJcyBhIGZ1bmN0aW9uXG4gICAgICAgIHJldHVybiB6ekRPTS5fYnVpbGQoXG4gICAgICAgICAgICB4LmNhbGwoIHRoaXMuZWwsIHRoaXMuX2kgPT09IHVuZGVmaW5lZD8gMDogdGhpcy5faSwgdGhpcyApPyBbIHRoaXMuZWwgXTogW11cbiAgICAgICAgKTtcbiAgICB9ICBcbiAgICBcbiAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICdmaWx0ZXInICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuZmluZCA9IGZ1bmN0aW9uICggc2VsZWN0b3IgKSB7XG4gICAgcmV0dXJuIHp6RE9NLl9idWlsZCggXG4gICAgICAgIHRoaXMuZWwucXVlcnlTZWxlY3RvckFsbCggc2VsZWN0b3IgKVxuICAgICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaGFzQ2xhc3MgPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG4gICAgcmV0dXJuIHRoaXMuZWwuY2xhc3NMaXN0LmNvbnRhaW5zKCBuYW1lICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaGVpZ2h0ID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICByZXR1cm4gdGhpcy5fc3R5bGVQcm9wZXJ0eSggJ2hlaWdodCcsIHZhbHVlICk7XG59O1xuXG4vL1RPRE8gYWRkIHN1cHBvcnQgb2YgZnVuY3Rpb24gdHlwZSBpbiB2YWx1ZVxuenpET00uU1MucHJvdG90eXBlLmh0bWwgPSBmdW5jdGlvbiAoIHZhbHVlICkge1xuICAgIC8vIGdldFxuICAgIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gdGhpcy5lbC5pbm5lckhUTUw7XG4gICAgfVxuXG4gICAgLy8gc2V0XG4gICAgdGhpcy5lbC5pbm5lckhUTUwgPSB2YWx1ZTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5pbmRleCA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoICEgdGhpcy5lbCApe1xuICAgICAgICByZXR1cm4gLTE7XG4gICAgfVxuICAgIFxuICAgIHZhciBpID0gMDtcbiAgICB2YXIgY3VycmVudEVsID0gdGhpcy5lbDtcbiAgICBkbyB7XG4gICAgICAgIGkrKztcbiAgICB9IHdoaWxlICggY3VycmVudEVsID0gY3VycmVudEVsLnByZXZpb3VzRWxlbWVudFNpYmxpbmcgKTtcbiAgICBcbiAgICByZXR1cm4gaTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5pcyA9IGZ1bmN0aW9uICggeCApIHtcbiAgICBpZiAoIHggPT0gbnVsbCApe1xuICAgICAgICByZXR1cm4gZmFsc2U7ICAgIFxuICAgIH1cbiAgICBcbiAgICBpZiAoIHggaW5zdGFuY2VvZiBFbGVtZW50ICl7XG4gICAgICAgIHJldHVybiB0aGlzLmVsID09PSB4O1xuICAgIH1cbiAgICBcbiAgICBpZiAoIHggaW5zdGFuY2VvZiB6ekRPTS5TUyApIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwgPT09IHguZWw7XG4gICAgfSBcblxuICAgIGlmICggeCBpbnN0YW5jZW9mIHp6RE9NLk1NICkge1xuICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB4Lm5vZGVzLmxlbmd0aDsgKytpICl7XG4gICAgICAgICAgICBpZiAoIHRoaXMuZWwgPT09IHgubm9kZXNbIGkgXSApe1xuICAgICAgICAgICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9IFxuXG4gICAgaWYgKCB0eXBlb2YgeCA9PT0gJ3N0cmluZycgKXtcbiAgICAgICAgcmV0dXJuIHRoaXMuZWwubWF0Y2hlcyggeCApO1xuICAgIH1cbiAgICBcbiAgICByZXR1cm4gZmFsc2U7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUubmV4dCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IHp6RE9NLlNTKCB0aGlzLmVsLm5leHRFbGVtZW50U2libGluZyApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLm9mZnNldCA9IGZ1bmN0aW9uICggYyApIHtcbiAgICBcbiAgICAvLyBzZXQgdG9wIGFuZCBsZWZ0IHVzaW5nIGNzc1xuICAgIGlmICggYyApe1xuICAgICAgICB0aGlzLl9zdHlsZVByb3BlcnR5KCAndG9wJywgYy50b3AgKTtcbiAgICAgICAgdGhpcy5fc3R5bGVQcm9wZXJ0eSggJ2xlZnQnLCBjLmxlZnQgKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIFxuICAgIC8vIGdldFxuICAgIHZhciByZWN0ID0gdGhpcy5lbC5nZXRCb3VuZGluZ0NsaWVudFJlY3QoKTtcbiAgICByZXR1cm4ge1xuICAgICAgICB0b3A6IHJlY3QudG9wICsgZG9jdW1lbnQuYm9keS5zY3JvbGxUb3AsXG4gICAgICAgIGxlZnQ6IHJlY3QubGVmdCArIGRvY3VtZW50LmJvZHkuc2Nyb2xsTGVmdFxuICAgIH07XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUub2Zmc2V0UGFyZW50ID0gZnVuY3Rpb24gKCkge1xuICAgIHZhciBvZmZzZXRQYXJlbnQgPSB0aGlzLmVsLm9mZnNldFBhcmVudDtcbiAgICByZXR1cm4gb2Zmc2V0UGFyZW50PyBuZXcgenpET00uU1MoIG9mZnNldFBhcmVudCApOiB0aGlzO1xufTtcblxuLyoqXG4gKiBAcGFyYW0ge2Jvb2xlYW49fSB3aXRoTWFyZ2luXG4gKi9cbnp6RE9NLlNTLnByb3RvdHlwZS5vdXRlckhlaWdodCA9IGZ1bmN0aW9uICggd2l0aE1hcmdpbiApIHtcbiAgICByZXR1cm4gdGhpcy5fb3V0ZXIoICdIZWlnaHQnLCAnVG9wJywgJ0JvdHRvbScsIHdpdGhNYXJnaW4gKTtcbn07XG5cbi8qKlxuICogQHBhcmFtIHtib29sZWFuPX0gd2l0aE1hcmdpblxuICovXG56ekRPTS5TUy5wcm90b3R5cGUub3V0ZXJXaWR0aCA9IGZ1bmN0aW9uICggd2l0aE1hcmdpbiApIHtcbiAgICByZXR1cm4gdGhpcy5fb3V0ZXIoICdXaWR0aCcsICdMZWZ0JywgJ1JpZ2h0Jywgd2l0aE1hcmdpbiApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnBhcmVudCA9IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4gbmV3IHp6RE9NLlNTKCB0aGlzLmVsLnBhcmVudE5vZGUgKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5wb3NpdGlvbiA9IGZ1bmN0aW9uICggcmVsYXRpdmVUb1ZpZXdwb3J0ICkge1xuICAgIHJldHVybiByZWxhdGl2ZVRvVmlld3BvcnQ/XG4gICAgICAgIHRoaXMuZWwuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk6XG4gICAgICAgIHsgXG4gICAgICAgICAgICBsZWZ0OiB0aGlzLmVsLm9mZnNldExlZnQsIFxuICAgICAgICAgICAgdG9wOiB0aGlzLmVsLm9mZnNldFRvcFxuICAgICAgICB9O1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnByZXBlbmQgPSBmdW5jdGlvbiAoIHggKSB7XG4gICAgaWYgKCB4IGluc3RhbmNlb2YgRWxlbWVudCApe1xuICAgICAgICB0aGlzLmVsLmluc2VydEJlZm9yZSggeCwgdGhpcy5lbC5maXJzdENoaWxkICk7XG4gICAgfSBlbHNlIGlmICggeCBpbnN0YW5jZW9mIHp6RE9NLlNTICl7XG4gICAgICAgIHRoaXMuZWwuaW5zZXJ0QmVmb3JlKCB4LmVsLCB0aGlzLmVsLmZpcnN0Q2hpbGQgKTtcbiAgICB9IGVsc2UgaWYgKCB0eXBlb2YgeCA9PT0gJ3N0cmluZycgKXtcbiAgICAgICAgdGhpcy5lbC5pbnNlcnRBZGphY2VudEhUTUwoICdhZnRlcmJlZ2luJywgeCApO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IHp6RE9NLl9nZXRFcnJvciggJ3ByZXBlbmQnICk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnByZXYgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuIG5ldyB6ekRPTS5TUyggdGhpcy5lbC5wcmV2aW91c0VsZW1lbnRTaWJsaW5nICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24gKCkge1xuICAgIHRoaXMuZWwucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCggdGhpcy5lbCApO1xuICAgIHJldHVybiB0aGlzO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnJlbW92ZUF0dHIgPSBmdW5jdGlvbiAoIG5hbWUgKSB7XG4gICAgdGhpcy5lbC5yZW1vdmVBdHRyaWJ1dGUoIG5hbWUgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5yZW1vdmVDbGFzcyA9IGZ1bmN0aW9uICggbmFtZSApIHtcbiAgICBpZiAoICEgbmFtZSApe1xuICAgICAgICB0aGlzLmVsLmNsYXNzTmFtZSA9ICcnO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgXG4gICAgcmV0dXJuIHRoaXMuX2l0ZXJhdGUoXG4gICAgICAgIG5hbWUsXG4gICAgICAgIGZ1bmN0aW9uKCBzZWxmLCB2ICl7XG4gICAgICAgICAgICBzZWxmLmVsLmNsYXNzTGlzdC5yZW1vdmUoIHYgKTtcbiAgICAgICAgfVxuICAgICk7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUucmVwbGFjZVdpdGggPSBmdW5jdGlvbiAoIHZhbHVlICkge1xuICAgIHRoaXMuZWwub3V0ZXJIVE1MID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUuc2libGluZ3MgPSBmdW5jdGlvbiAoIHNlbGVjdG9yICkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICB2YXIgbm9kZXMgPSBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwoIFxuICAgICAgICB0aGlzLmVsLnBhcmVudE5vZGUuY2hpbGRyZW4sIFxuICAgICAgICBzZWxlY3Rvcj9cbiAgICAgICAgICAgIGZ1bmN0aW9uKCBjaGlsZCApe1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZCAhPT0gc2VsZi5lbCAmJiBjaGlsZC5tYXRjaGVzKCBzZWxlY3RvciApO1xuICAgICAgICAgICAgfTpcbiAgICAgICAgICAgIGZ1bmN0aW9uKCBjaGlsZCApe1xuICAgICAgICAgICAgICAgIHJldHVybiBjaGlsZCAhPT0gc2VsZi5lbDtcbiAgICAgICAgICAgIH1cbiAgICApO1xuICAgIHJldHVybiB6ekRPTS5fYnVpbGQoIG5vZGVzICk7XG59O1xuXG4vL1RPRE8gYWRkIHN1cHBvcnQgb2YgZnVuY3Rpb24gdHlwZSBpbiB2YWx1ZVxuenpET00uU1MucHJvdG90eXBlLnRleHQgPSBmdW5jdGlvbiAoIHZhbHVlICkge1xuICAgIC8vIGdldFxuICAgIGlmICggdmFsdWUgPT09IHVuZGVmaW5lZCApe1xuICAgICAgICByZXR1cm4gdGhpcy5lbC50ZXh0Q29udGVudDtcbiAgICB9XG5cbiAgICAvLyBzZXRcbiAgICB0aGlzLmVsLnRleHRDb250ZW50ID0gdmFsdWU7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUudG9nZ2xlQ2xhc3MgPSBmdW5jdGlvbiAoIG5hbWUsIHN0YXRlICkge1xuICAgIHJldHVybiB0aGlzLl9pdGVyYXRlKFxuICAgICAgICBuYW1lLFxuICAgICAgICBzdGF0ZSA9PT0gdW5kZWZpbmVkP1xuICAgICAgICAgICAgZnVuY3Rpb24oIHNlbGYsIHYgKXtcbiAgICAgICAgICAgICAgICBzZWxmLmVsLmNsYXNzTGlzdC50b2dnbGUoIHYgKTtcbiAgICAgICAgICAgIH06XG4gICAgICAgICAgICBmdW5jdGlvbiggc2VsZiwgdiApe1xuICAgICAgICAgICAgICAgIHNlbGYuZWwuY2xhc3NMaXN0LnRvZ2dsZSggdiwgc3RhdGUgKTtcbiAgICAgICAgICAgIH1cbiAgICApO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLndpZHRoID0gZnVuY3Rpb24gKCB2YWx1ZSApIHtcbiAgICByZXR1cm4gdGhpcy5fc3R5bGVQcm9wZXJ0eSggJ3dpZHRoJywgdmFsdWUgKTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5vZmYgPSBmdW5jdGlvbiAoIGV2ZW50TmFtZSwgbGlzdGVuZXIsIHVzZUNhcHR1cmUgKSB7XG4gICAgenpET00uX3JlbW92ZUV2ZW50TGlzdGVuZXIoIHRoaXMsIGV2ZW50TmFtZSwgbGlzdGVuZXIsIHVzZUNhcHR1cmUgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5vbiA9IGZ1bmN0aW9uICggZXZlbnROYW1lLCBsaXN0ZW5lciwgZGF0YSwgdXNlQ2FwdHVyZSApIHtcbiAgICB6ekRPTS5fYWRkRXZlbnRMaXN0ZW5lciggXG4gICAgICAgIHRoaXMsIFxuICAgICAgICBldmVudE5hbWUsIFxuICAgICAgICBkYXRhPyBcbiAgICAgICAgICAgIGZ1bmN0aW9uKCBlICl7XG4gICAgICAgICAgICAgICAgZS5kYXRhID0gZGF0YTtcbiAgICAgICAgICAgICAgICByZXR1cm4gbGlzdGVuZXIuY2FsbCggZS5jdXJyZW50VGFyZ2V0LCBlICk7XG4gICAgICAgICAgICB9OlxuICAgICAgICAgICAgbGlzdGVuZXIsIFxuICAgICAgICB1c2VDYXB0dXJlIFxuICAgICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG56ekRPTS5TUy5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uICggZXZlbnROYW1lICkge1xuICAgIHZhciBldmVudCA9IGRvY3VtZW50LmNyZWF0ZUV2ZW50KCAnSFRNTEV2ZW50cycgKTtcbiAgICBldmVudC5pbml0RXZlbnQoIGV2ZW50TmFtZSwgdHJ1ZSwgZmFsc2UgKTtcbiAgICB0aGlzLmVsLmRpc3BhdGNoRXZlbnQoIGV2ZW50ICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuLyogRW5kIG9mIGV2ZW50cyAqL1xuXG56ekRPTS5TUy5wcm90b3R5cGUuaGlkZSA9IGZ1bmN0aW9uICgpIHtcbiAgICBpZiAoIHRoaXMuaXNWaXNpYmxlKCkgKXtcbiAgICAgICAgdGhpcy5hdHRyKCBcbiAgICAgICAgICAgICdkYXRhLWRpc3BsYXknLCBcbiAgICAgICAgICAgIGdldENvbXB1dGVkU3R5bGUoIHRoaXMuZWwsIG51bGwgKVsgJ2Rpc3BsYXknIF1cbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5lbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5pc1Zpc2libGUgPSBmdW5jdGlvbiAoKSB7XG4gICAgcmV0dXJuICEhIHRoaXMuZWwub2Zmc2V0UGFyZW50O1xuICAgIC8vcmV0dXJuIGdldENvbXB1dGVkU3R5bGUoIHRoaXMuZWwsIG51bGwgKS5nZXRQcm9wZXJ0eVZhbHVlKCAnZGlzcGxheScgKSAhPT0gJ25vbmUnO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLnNob3cgPSBmdW5jdGlvbiAoKSB7XG4gICAgaWYgKCAhIHRoaXMuaXNWaXNpYmxlKCkgKXtcbiAgICAgICAgdmFyIGRpc3BsYXkgPSB0aGlzLmF0dHIoICdkYXRhLWRpc3BsYXknICk7XG4gICAgICAgIHRoaXMuZWwuc3R5bGUuZGlzcGxheSA9IGRpc3BsYXk/IGRpc3BsYXk6IHp6RE9NLl9nZXREZWZhdWx0RGlzcGxheSggdGhpcy5lbCApO1xuICAgIH1cbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS50b2dnbGUgPSBmdW5jdGlvbiAoIHN0YXRlICkge1xuICAgIHZhciB2YWx1ZSA9IHN0YXRlICE9PSB1bmRlZmluZWQ/ICEgc3RhdGU6IHRoaXMuaXNWaXNpYmxlKCk7XG4gICAgcmV0dXJuIHZhbHVlPyB0aGlzLmhpZGUoKTogdGhpcy5zaG93KCk7XG59O1xuLyogRW5kIG9mIHZpc2libGUgKi9cblxuenpET00uU1MucHJvdG90eXBlLmNoZWNrZWQgPSBmdW5jdGlvbiAoIGNoZWNrICkge1xuICAgIGlmICggdGhpcy5lbC5ub2RlTmFtZSAhPT0gJ0lOUFVUJyB8fCAoIHRoaXMuZWwudHlwZSAhPT0gJ2NoZWNrYm94JyAmJiB0aGlzLmVsLnR5cGUgIT09ICdyYWRpbycpICkge1xuICAgICAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICdjaGVja2VkJyApO1xuICAgIH1cbiAgICBcbiAgICAvLyBnZXRcbiAgICBpZiAoIGNoZWNrID09PSB1bmRlZmluZWQgKXtcbiAgICAgICAgcmV0dXJuICEhIHRoaXMuZWwuY2hlY2tlZDtcbiAgICB9XG4gICAgXG4gICAgLy8gc2V0XG4gICAgdGhpcy5lbC5jaGVja2VkID0gY2hlY2s7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vKipcbiAqIEBwYXJhbSB7QXJyYXk8Pz58U3RyaW5nPX0gdmFsdWVcbiAqL1xuenpET00uU1MucHJvdG90eXBlLnZhbCA9IGZ1bmN0aW9uICggdmFsdWUgKSB7XG4gICAgLy8gZ2V0XG4gICAgaWYgKCB2YWx1ZSA9PT0gdW5kZWZpbmVkICl7XG4gICAgICAgIHN3aXRjaCAoIHRoaXMuZWwubm9kZU5hbWUgKSB7XG4gICAgICAgIGNhc2UgJ0lOUFVUJzpcbiAgICAgICAgY2FzZSAnVEVYVEFSRUEnOlxuICAgICAgICBjYXNlICdCVVRUT04nOlxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZWwudmFsdWU7XG4gICAgICAgIGNhc2UgJ1NFTEVDVCc6XG4gICAgICAgICAgICB2YXIgdmFsdWVzID0gW107XG4gICAgICAgICAgICBmb3IgKCB2YXIgaSA9IDA7IGkgPCB0aGlzLmVsLmxlbmd0aDsgKytpICkge1xuICAgICAgICAgICAgICAgIGlmICggdGhpcy5lbFsgaSBdLnNlbGVjdGVkICkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZXMucHVzaCggdGhpcy5lbFsgaSBdLnZhbHVlICk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHZhbHVlcy5sZW5ndGggPiAxPyB2YWx1ZXM6IHZhbHVlc1sgMCBdO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgenpET00uX2dldEVycm9yKCAndmFsJyApO1xuICAgICAgICB9XG4gICAgfVxuICAgIFxuICAgIC8vIHNldFxuICAgIHN3aXRjaCAoIHRoaXMuZWwubm9kZU5hbWUgKSB7XG4gICAgY2FzZSAnSU5QVVQnOlxuICAgIGNhc2UgJ1RFWFRBUkVBJzpcbiAgICBjYXNlICdCVVRUT04nOlxuICAgICAgICB0aGlzLmVsLnZhbHVlID0gdmFsdWU7XG4gICAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ1NFTEVDVCc6XG4gICAgICAgIGlmICggdHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJyB8fCB0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICkge1xuICAgICAgICAgICAgdmFsdWUgPSBbIHZhbHVlIF07XG4gICAgICAgIH1cbiAgICAgICAgZm9yICggaSA9IDA7IGkgPCB0aGlzLmVsLmxlbmd0aDsgKytpICkge1xuICAgICAgICAgICAgZm9yICggdmFyIGogPSAwOyBqIDwgdmFsdWUubGVuZ3RoOyArK2ogKSB7XG4gICAgICAgICAgICAgICAgdGhpcy5lbFsgaSBdLnNlbGVjdGVkID0gJyc7XG4gICAgICAgICAgICAgICAgaWYgKCB0aGlzLmVsWyBpIF0udmFsdWUgPT09IHZhbHVlWyBqIF0gKSB7XG4gICAgICAgICAgICAgICAgICAgIHRoaXMuZWxbIGkgXS5zZWxlY3RlZCA9ICdzZWxlY3RlZCc7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBicmVhaztcbiAgICBkZWZhdWx0OlxuICAgICAgICB0aHJvdyB6ekRPTS5fZ2V0RXJyb3IoICd2YWwnICk7XG4gICAgfVxuICAgIFxuICAgIHJldHVybiB0aGlzO1xufTtcbi8qIEVuZCBvZiBmb3JtcyAqL1xuXG56ekRPTS5TUy5wcm90b3R5cGUuZ2V0WENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiAoIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGllbnRXaWR0aCAtIHRoaXMub3V0ZXJXaWR0aCgpICkgLyAyO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmdldFlDZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICByZXR1cm4gKCBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xpZW50SGVpZ2h0IC0gdGhpcy5vdXRlckhlaWdodCgpICkgLyAyO1xufTtcblxuenpET00uU1MucHJvdG90eXBlLmdldENlbnRlciA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB7XG4gICAgICAgIGxlZnQ6IHRoaXMuZ2V0WENlbnRlcigpLFxuICAgICAgICB0b3A6IHRoaXMuZ2V0WUNlbnRlcigpXG4gICAgfTtcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5jZW50ZXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLm9mZnNldCggXG4gICAgICAgIHRoaXMuZ2V0Q2VudGVyKCkgXG4gICAgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5jZW50ZXJYID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jc3MoICdsZWZ0JywgdGhpcy5nZXRYQ2VudGVyKCkgKTtcbiAgICByZXR1cm4gdGhpcztcbn07XG5cbnp6RE9NLlNTLnByb3RvdHlwZS5jZW50ZXJZID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5jc3MoICd0b3AnLCB0aGlzLmdldFlDZW50ZXIoKSApO1xuICAgIHJldHVybiB0aGlzO1xufTtcbi8qIEVuZCBvZiBjZW50ZXIgKi9cblxuLyoqIEBjb25zdHJ1Y3RvciAqL1xuenpET00uTU0gPSBmdW5jdGlvbiAoIF9ub2RlcyApIHsgICAgXG4gICAgdGhpcy5saXN0ID0gW107XG4gICAgdGhpcy5ub2RlcyA9IF9ub2RlcztcbiAgICB0aGlzLmxlbmd0aCA9IF9ub2Rlcy5sZW5ndGg7XG4gICAgXG4gICAgLy8gSW5pdCBub2Rlc1xuICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMubGVuZ3RoOyBpKysgKSB7XG4gICAgICAgIHZhciBlbCA9IHRoaXMubm9kZXNbIGkgXTtcbiAgICAgICAgdGhpc1sgaSBdID0gZWw7IC8vIGZvciBhcnJheSBsaWtlXG4gICAgICAgIHZhciBzcyA9IG5ldyB6ekRPTS5TUyggZWwgKTtcbiAgICAgICAgdGhpcy5saXN0LnB1c2goIHNzICk7XG4gICAgICAgIHNzLl9pID0gaTsgLy8gZm9yIGluZGV4IGluIGZ1bmN0aW9uc1xuICAgIH1cbn07XG5cbi8qXG5VbmlmeSB0aGUgZGVmaW5pdGlvbiBvZiBhIGZ1bmN0aW9uIG9mIHp6RE9NLlNTLnByb3RvdHlwZSBhbmQgYSBkZWZpbml0aW9uIG9mIHp6RE9NLk1NLnByb3RvdHlwZS4gRXhhbXBsZTpcblxuICAgIHp6RE9NLmFkZCggXG4gICAgICAgIHp6RE9NLlNTLnByb3RvdHlwZS5teUN1c3RvbUZ1bmN0aW9uID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgIC4uLlxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgICAgIH0sXG4gICAgICAgIHp6RE9NLk1NLmNvbnN0cnVjdG9ycy5jb25jYXRcbiAgICApO1xuKTtcbiovXG4vKipcbiAqIEBwYXJhbSB7RnVuY3Rpb259IHNzUHJvdG90eXBlXG4gKiBAcGFyYW0ge0Z1bmN0aW9uPX0gY29uc3RydWN0b3JcbiAqL1xuenpET00uYWRkID0gZnVuY3Rpb24oIHNzUHJvdG90eXBlLCBjb25zdHJ1Y3RvciApe1xuICAgIGZvciAoIHZhciBpZCBpbiB6ekRPTS5TUy5wcm90b3R5cGUgKXtcbiAgICAgICAgdmFyIGN1cnJlbnQgPSB6ekRPTS5TUy5wcm90b3R5cGVbIGlkIF07XG4gICAgICAgIGlmICggc3NQcm90b3R5cGUgPT09IGN1cnJlbnQgKXtcbiAgICAgICAgICAgIHZhciBjbG9zdXJlID0gZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICB2YXIgZnVuY3Rpb25JZCA9IGlkO1xuICAgICAgICAgICAgICAgIHJldHVybiBjb25zdHJ1Y3Rvcj8gY29uc3RydWN0b3IoIGZ1bmN0aW9uSWQgKTogenpET00uTU0uY29uc3RydWN0b3JzLmRlZmF1bHQoIGZ1bmN0aW9uSWQgKTtcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICB6ekRPTS5NTS5wcm90b3R5cGVbIGlkIF0gPSBjbG9zdXJlKCk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9XG4gICAgXG4gICAgdGhyb3cgJ0Vycm9yIHJlZ2lzdGVyaW5nIHp6RE9NLk1NOiB6ekRPTS5TUyBub3QgZm91bmQuJztcbn07XG5cbnp6RE9NLk1NLmNvbnN0cnVjdG9ycyA9IHt9O1xuenpET00uTU0uY29uc3RydWN0b3JzLmJvb2xlYW5PciA9IGZ1bmN0aW9uKCBmdW5jdGlvbklkICl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBzcyA9IHRoaXMubGlzdFsgaSBdO1xuICAgICAgICAgICAgdmFyIHggPSBzc1sgZnVuY3Rpb25JZCBdLmFwcGx5KCBzcywgYXJndW1lbnRzICk7XG4gICAgICAgICAgICBpZiAoIHggKXtcbiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfTtcbn07XG56ekRPTS5NTS5jb25zdHJ1Y3RvcnMuY29uY2F0ID0gZnVuY3Rpb24oIGZ1bmN0aW9uSWQgKXtcbiAgICByZXR1cm4gZnVuY3Rpb24oKXtcbiAgICAgICAgdmFyIG5ld05vZGVzID0gW107XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBzcyA9IHRoaXMubGlzdFsgaSBdO1xuICAgICAgICAgICAgdmFyIHggPSBzc1sgZnVuY3Rpb25JZCBdLmFwcGx5KCBzcywgYXJndW1lbnRzICk7XG4gICAgICAgICAgICBuZXdOb2RlcyA9IG5ld05vZGVzLmNvbmNhdCggeC5ub2RlcyApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB6ekRPTS5fYnVpbGQoIG5ld05vZGVzICk7XG4gICAgfTtcbn07XG56ekRPTS5NTS5jb25zdHJ1Y3RvcnMuZGVmYXVsdCA9IGZ1bmN0aW9uKCBmdW5jdGlvbklkICl7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCl7XG4gICAgICAgIGZvciAoIHZhciBpID0gMDsgaSA8IHRoaXMubGlzdC5sZW5ndGg7IGkrKyApIHtcbiAgICAgICAgICAgIHZhciBzcyA9IHRoaXMubGlzdFsgaSBdO1xuICAgICAgICAgICAgdmFyIHIgPSBzc1sgZnVuY3Rpb25JZCBdLmFwcGx5KCBzcywgYXJndW1lbnRzICk7XG4gICAgICAgICAgICBpZiAoIGkgPT09IDAgJiYgISAoIHIgaW5zdGFuY2VvZiB6ekRPTS5TUyApICl7XG4gICAgICAgICAgICAgICAgcmV0dXJuIHI7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfTtcbn07XG5cbi8vIEluaXQgcHJvdG90eXBlIGZ1bmN0aW9ucyBmcm9tIHp6RE9NLlNTXG56ekRPTS5NTS5pbml0ID0gZnVuY3Rpb24oKXtcbiAgICAvLyBDb25jYXQgZnVuY3Rpb25zXG4gICAgdmFyIGNvbmNhdEYgPSBbXG4gICAgICAgICdjaGlsZHJlbicsXG4gICAgICAgICdjbG9uZScsXG4gICAgICAgICdmaWx0ZXInLFxuICAgICAgICAnZmluZCcsXG4gICAgICAgICduZXh0JyxcbiAgICAgICAgJ29mZnNldFBhcmVudCcsXG4gICAgICAgICdwYXJlbnQnLFxuICAgICAgICAncHJldicsXG4gICAgICAgICdzaWJsaW5ncydcbiAgICBdO1xuICAgIC8vIEJvb2xlYW4gZnVuY3Rpb25zXG4gICAgdmFyIGJvb2xlYW5PckYgPSBbXG4gICAgICAgICdoYXNDbGFzcycsXG4gICAgICAgICdpcydcbiAgICBdO1xuICAgIGZvciAoIHZhciBpZCBpbiB6ekRPTS5TUy5wcm90b3R5cGUgKXtcbiAgICAgICAgdmFyIGNsb3N1cmUgPSBmdW5jdGlvbigpe1xuICAgICAgICAgICAgdmFyIGZ1bmN0aW9uSWQgPSBpZDtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKCBjb25jYXRGLmluZGV4T2YoIGZ1bmN0aW9uSWQgKSAhPT0gLTEgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4genpET00uTU0uY29uc3RydWN0b3JzLmNvbmNhdCggZnVuY3Rpb25JZCApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKCBib29sZWFuT3JGLmluZGV4T2YoIGZ1bmN0aW9uSWQgKSAhPT0gLTEgKXtcbiAgICAgICAgICAgICAgICByZXR1cm4genpET00uTU0uY29uc3RydWN0b3JzLmJvb2xlYW5PciggZnVuY3Rpb25JZCApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIHp6RE9NLk1NLmNvbnN0cnVjdG9ycy5kZWZhdWx0KCBmdW5jdGlvbklkICk7XG4gICAgICAgIH07XG4gICAgICAgIHp6RE9NLk1NLnByb3RvdHlwZVsgaWQgXSA9IGNsb3N1cmUoKTtcbiAgICB9XG59KCk7XG5cbi8qIE1ldGhvZHMgaW5jbHVkZWQgaW4ganF1ZXJ5ICovXG56ekRPTS5NTS5wcm90b3R5cGUuZWFjaCA9IGZ1bmN0aW9uICggZWFjaEZuICkge1xuICAgIHZhciBzZWxmID0gdGhpcztcbiAgICBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKCBcbiAgICAgICAgdGhpcy5saXN0LCBcbiAgICAgICAgZnVuY3Rpb24oIGN1cnJlbnRWYWx1ZSwgaW5kZXggKXtcbiAgICAgICAgICAgIGVhY2hGbi5jYWxsKCBjdXJyZW50VmFsdWUuZWwsIGluZGV4LCBjdXJyZW50VmFsdWUsIHNlbGYubm9kZXMgKTtcbiAgICAgICAgfVxuICAgICk7XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG4vLyBSZWdpc3RlciB6ekRPTSBpZiB3ZSBhcmUgdXNpbmcgTm9kZVxuaWYgKCB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0JyAmJiBtb2R1bGUuZXhwb3J0cyApIHtcbiAgICBtb2R1bGUuZXhwb3J0cyA9IHp6RE9NO1xufVxuIiwidmFyIHp6RE9NID0gcmVxdWlyZSgnLi9idWlsZC96ekRPTS1jbG9zdXJlcy1mdWxsLmpzJyk7XG5tb2R1bGUuZXhwb3J0cyA9IHp6RE9NLnp6O1xuIiwidmFyIFF1bml0ID0gcmVxdWlyZSggJ3F1bml0JyApO1xudmFyIHp6ID0gcmVxdWlyZSggJ3p6ZG9tJyApO1xudmFyIHpwdCA9IHJlcXVpcmUoICd6cHQnICk7XG52YXIgYmx1ZVJvdXRlciA9IHJlcXVpcmUoICcuLi8uLi9idWlsZC9ibHVlUm91dGVyLmpzJyApO1xuXG4vLyBJbml0IHJvdXRlclxuY29uc3QgaW5pdFJvdXRlciA9ICgpID0+IHtcbiAgICAvLyBJbml0aWFsaXplIHBhZ2VzXG4gICAgY29uc3QgcGFnZXMgPSB7fTtcblxuICAgIC8vIExvYWQganMgb2YgcGFnZXNcbiAgICBjb25zdCBkaWN0aW9uYXJ5ID0ge307XG4gICAgcGFnZXNbICdyZW5kZXJXaXRob3V0V2FpdGluZycgXSA9IHJlcXVpcmUoICcuL3BhZ2VzL3JlbmRlcldpdGhvdXRXYWl0aW5nLmpzJyApKCBkaWN0aW9uYXJ5ICk7XG4gICAgcGFnZXNbICdyZW5kZXJXYWl0aW5nRm9yU2VydmVyJyBdID0gcmVxdWlyZSggJy4vcGFnZXMvcmVuZGVyV2FpdGluZ0ZvclNlcnZlci5qcycgKSggZGljdGlvbmFyeSApO1xuXG4gICAgLy8gSW5pdGlhbGl6ZSBvcHRpb25zOiBubyBhbmltYXRpb25zXG4gICAgbGV0IGluaXRpYWxpemVaUFQgPSB0cnVlO1xuICAgIGxldCBvcHRpb25zID0ge1xuICAgICAgICBldmVudHNCeVBhZ2U6IHBhZ2VzLFxuICAgICAgICByb3V0ZXM6IHJlcXVpcmUoICcuL3JvdXRlc0lubGluZUZvclJlbmRlci5qcycgKVxuICAgIH07XG5cbiAgICAvLyBBZGQgcmVuZGVyRnVuY3Rpb25cbiAgICBvcHRpb25zLnJlbmRlckZ1bmN0aW9uID0gKCBwYWdlICkgPT4ge1xuICAgICAgICBpZiAoIGluaXRpYWxpemVaUFQgKXtcbiAgICAgICAgICAgIHpwdC5ydW4oe1xuICAgICAgICAgICAgICAgICdyb290JzogZG9jdW1lbnQuYm9keSxcbiAgICAgICAgICAgICAgICAnZGljdGlvbmFyeSc6IGRpY3Rpb25hcnlcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgaW5pdGlhbGl6ZVpQVCA9IGZhbHNlO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgenB0LnJ1bih7XG4gICAgICAgICAgICAgICAgJ2NvbW1hbmQnOiAncGFydGlhbFJlbmRlcicsXG4gICAgICAgICAgICAgICAgJ3RhcmdldCc6IHBhZ2VbICdlbCcgXVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgLy8gQ3JlYXRlIG5ldyByb3V0ZXIgaW5zdGFuY2VcbiAgICByZXR1cm4gbmV3IGJsdWVSb3V0ZXIucm91dGVyKCBvcHRpb25zICk7XG59O1xuXG4vLyBJbml0IHJvdXRlclxuY29uc3Qgcm91dGVyID0gaW5pdFJvdXRlcigpO1xuXG4vLyBVbml0IHRlc3RzXG5yZXF1aXJlKCAnLi9yZW5kZXIuanMnICkoKTtcblxuIiwiLyogcmVuZGVyV2l0aG91dFdhaXRpbmcgcGFnZSAqL1xubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoIGRpY3Rpb25hcnkgKSB7XG4gICAgXG4gICAgdmFyIHpwdCA9IHJlcXVpcmUoICd6cHQnICk7XG5cbiAgICBjb25zdCBwYWdlID0ge307XG5cbiAgICBwYWdlWyAncHJlSW5pdCcgXSA9IGZ1bmN0aW9uKCBldmVudCApe1xuXG4gICAgICAgIGRpY3Rpb25hcnlbICdzdWNjZXNzTWVzc2FnZUZyb21TZXJ2ZXInIF0gPSAnTG9hZGluZy4uLic7XG4gICAgfTtcblxuICAgIHBhZ2VbICdpbml0JyBdID0gZnVuY3Rpb24oIGV2ZW50ICl7XG5cbiAgICAgICAgc2V0VGltZW91dChcbiAgICAgICAgICAgIGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgZGljdGlvbmFyeVsgJ3N1Y2Nlc3NNZXNzYWdlRnJvbVNlcnZlcicgXSA9ICdJdCB3b3JrcyEnO1xuICAgICAgICAgICAgICAgIHpwdC5ydW4oe1xuICAgICAgICAgICAgICAgICAgICAnY29tbWFuZCc6ICdwYXJ0aWFsUmVuZGVyJyxcbiAgICAgICAgICAgICAgICAgICAgJ3RhcmdldCc6IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCAncmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlJyApXG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgMzAwXG4gICAgICAgICk7XG4gICAgfTtcblxuICAgIHJldHVybiBwYWdlO1xufTtcbiIsIi8qIHJlbmRlcldpdGhvdXRXYWl0aW5nIHBhZ2UgKi9cblxubW9kdWxlLmV4cG9ydHMgPSBmdW5jdGlvbiAoIGRpY3Rpb25hcnkgKSB7XG5cbiAgICBjb25zdCBwYWdlID0ge307XG5cbiAgICBwYWdlWyAncHJlSW5pdCcgXSA9IGZ1bmN0aW9uKCBldmVudCApe1xuICAgICAgICAvL2FsZXJ0KCAnRVZFTlRfUFJFX0lOSVQnICk7XG5cbiAgICAgICAgZGljdGlvbmFyeVsgJ3N1Y2Nlc3NNZXNzYWdlJyBdID0gJ0l0IHdvcmtzISc7XG4gICAgfTtcblxuICAgIHJldHVybiBwYWdlO1xufTtcbiIsIi8vIFRlc3RzIGZvciBldmVudHNcblxudmFyIHp6ID0gcmVxdWlyZSggJ3p6ZG9tJyApO1xudmFyIHV0aWxzID0gcmVxdWlyZSggJy4vdXRpbHMuanMnICk7XG52YXIgUXVuaXQgPSByZXF1aXJlKCAncXVuaXQnICk7XG5cbi8vIFVuaXQgdGVzdHNcbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gKCkge1xuXG4gICAgLy8gTm9uIHdhaXRpbmcgcmVuZGVyIHRlc3RcbiAgICBRVW5pdC50ZXN0KCBcIk5vbiB3YWl0aW5nIHJlbmRlciB0ZXN0XCIsIGFzeW5jIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYSByZWZlcmVuY2UgdG8gZmluaXNoIHRoZSBxdW5pdCB0ZXN0IGxhdGVyXG4gICAgICAgIHZhciBkb25lID0gYXNzZXJ0LmFzeW5jKCk7XG5cbiAgICAgICAgLy8gR28gdG8gcGFnZSByZW5kZXJXaXRob3V0V2FpdGluZ1xuICAgICAgICB6eignI2hvbWVfcmVuZGVyV2l0aG91dFdhaXRpbmdMaW5rJykuZWwuY2xpY2soKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG4gICAgICAgIGFzc2VydC5lcXVhbCggenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19wJykudGV4dCgpLnRyaW0oKSAsIFwiVGhpcyBpcyBQYWdlIHJlbmRlciB3aXRob3V0IHdhaXRpbmdcIiApO1xuXG4gICAgICAgIC8vIENoZWNrIHRoYXQgcmVuZGVyIGlzIG9rXG4gICAgICAgIGFzc2VydC5lcXVhbCggenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19tZXNzYWdlJykudGV4dCgpLnRyaW0oKSAsIFwiSXQgd29ya3MhXCIgKTtcblxuICAgICAgICAvLyBHbyB0byBob21lIHBhZ2VcbiAgICAgICAgenooJyNyZW5kZXJXaXRob3V0V2FpdGluZ19ob21lTGluaycpLmVsLmNsaWNrKCk7XG4gICAgICAgIGF3YWl0IHV0aWxzLndhaXRTaG9ydCgpO1xuXG4gICAgICAgIC8vIEZpbmlzaCBxdW5pdCB0ZXN0XG4gICAgICAgIGRvbmUoKTtcbiAgICB9KTtcblxuICAgIC8vIFdhaXRpbmcgZm9yIHNlcnZlciByZW5kZXIgdGVzdFxuICAgIFFVbml0LnRlc3QoIFwiV2FpdGluZyBmb3Igc2VydmVyIHJlbmRlciB0ZXN0XCIsIGFzeW5jIGZ1bmN0aW9uKCBhc3NlcnQgKSB7XG4gICAgICAgIFxuICAgICAgICAvLyBHZXQgYSByZWZlcmVuY2UgdG8gZmluaXNoIHRoZSBxdW5pdCB0ZXN0IGxhdGVyXG4gICAgICAgIHZhciBkb25lID0gYXNzZXJ0LmFzeW5jKCk7XG5cbiAgICAgICAgLy8gR28gdG8gcGFnZSByZW5kZXJXaXRob3V0V2FpdGluZ1xuICAgICAgICB6eignI2hvbWVfcmVuZGVyV2FpdGluZ0ZvclNlcnZlckxpbmsnKS5lbC5jbGljaygpO1xuICAgICAgICBhd2FpdCB1dGlscy53YWl0U2hvcnQoKTtcbiAgICAgICAgYXNzZXJ0LmVxdWFsKCB6eignI3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXJfcCcpLnRleHQoKS50cmltKCkgLCBcIlRoaXMgaXMgUGFnZSByZW5kZXIgd2FpdGluZyBmb3Igc2VydmVyXCIgKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG4gICAgICAgIFxuICAgICAgICAvLyBDaGVjayB0aGF0IHJlbmRlciBpcyBva1xuICAgICAgICBhc3NlcnQuZXF1YWwoIHp6KCcjcmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlJykudGV4dCgpLnRyaW0oKSAsIFwiSXQgd29ya3MhXCIgKTtcblxuICAgICAgICAvLyBHbyB0byBob21lIHBhZ2VcbiAgICAgICAgenooJyNyZW5kZXJXYWl0aW5nRm9yU2VydmVyX2hvbWVMaW5rJykuZWwuY2xpY2soKTtcbiAgICAgICAgYXdhaXQgdXRpbHMud2FpdFNob3J0KCk7XG5cbiAgICAgICAgLy8gRmluaXNoIHF1bml0IHRlc3RcbiAgICAgICAgZG9uZSgpO1xuICAgIH0pO1xuXG59O1xuIiwiLy8gUm91dGVzIGZvciBpbmxpbmUgY29udGVudCBmb3IgcmVuZGVyIHRlc3RzXG5cbmNvbnN0IHJvdXRlcyA9IFtcbiAgICAvLyBIb21lIHBhZ2VcbiAgICB7XG4gICAgICAgIGlkOiAnW2hvbWVdJyxcbiAgICAgICAgY29udGVudDogYFxuPGgxPkJsdWUgcm91dGVyIHRlc3Q8L2gxPlxuXG48ZGl2IGNsYXNzPVwicGFnZS1jb250ZW50XCI+XG48aDM+SG9tZSBwYWdlPC9oMz5cbjxwPlxuICAgIFRoaXMgaXMgSG9tZSBwYWdlXG48L3A+XG5cbjx1bCBpZD1cImhvbWVfbGlua3NcIj5cbiAgICA8bGk+XG4gICAgICAgIDxhIGhyZWY9XCIhcmVuZGVyV2l0aG91dFdhaXRpbmdcIiBpZD1cImhvbWVfcmVuZGVyV2l0aG91dFdhaXRpbmdMaW5rXCI+UGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nPC9hPi4gR28gdG8gcGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nLlxuICAgIDwvbGk+XG4gICAgPGxpPlxuICAgICAgICA8YSBocmVmPVwiIXJlbmRlcldhaXRpbmdGb3JTZXJ2ZXJcIiBpZD1cImhvbWVfcmVuZGVyV2FpdGluZ0ZvclNlcnZlckxpbmtcIj5QYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXI8L2E+LiBHbyB0byBwYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXIuXG4gICAgPC9saT5cbjwvdWw+XG48L2Rpdj5cbmBcbiAgICB9LFxuICAgIC8vIHBhZ2UgcmVuZGVyIHdpdGhvdXQgd2FpdGluZ1xuICAgIHtcbiAgICAgICAgaWQ6ICdyZW5kZXJXaXRob3V0V2FpdGluZycsXG4gICAgICAgIGNvbnRlbnQ6IGBcbjxoMT5CbHVlIHJvdXRlciB0ZXN0PC9oMT5cblxuPGRpdj5cbjxhIGhyZWY9XCIhXCIgaWQ9XCJyZW5kZXJXaXRob3V0V2FpdGluZ19ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPlBhZ2UgcmVuZGVyPC9oMz5cbjxwIGlkPVwicmVuZGVyV2l0aG91dFdhaXRpbmdfcFwiPlxuICAgIFRoaXMgaXMgUGFnZSByZW5kZXIgd2l0aG91dCB3YWl0aW5nXG48L3A+XG5cbjxoMiBpZD1cInJlbmRlcldpdGhvdXRXYWl0aW5nX21lc3NhZ2VcIiBkYXRhLWNvbnRlbnQ9XCJzdWNjZXNzTWVzc2FnZVwiPlxuICAgIE5vdCB3b3JraW5nIVxuPC9oMj5cbjwvZGl2PlxuYFxuICAgIH0sXG4gICAgLy8gcGFnZSByZW5kZXIgd2FpdGluZyBmb3Igc2VydmVyXG4gICAge1xuICAgICAgICBpZDogJ3JlbmRlcldhaXRpbmdGb3JTZXJ2ZXInLFxuICAgICAgICBjb250ZW50OiBgXG48aDE+Qmx1ZSByb3V0ZXIgdGVzdDwvaDE+XG5cbjxkaXY+XG48YSBocmVmPVwiIVwiIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPlBhZ2UgcmVuZGVyPC9oMz5cbjxwIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9wXCI+XG4gICAgVGhpcyBpcyBQYWdlIHJlbmRlciB3YWl0aW5nIGZvciBzZXJ2ZXJcbjwvcD5cblxuPGgyIGlkPVwicmVuZGVyV2FpdGluZ0ZvclNlcnZlcl9tZXNzYWdlXCIgZGF0YS1jb250ZW50PVwic3VjY2Vzc01lc3NhZ2VGcm9tU2VydmVyXCI+XG4gICAgTm90IHdvcmtpbmchXG48L2gyPlxuPC9kaXY+XG5gXG4gICAgfSxcbiAgICAvLyBEZWZhdWx0IHJvdXRlICg0MDQgcGFnZSlcbiAgICB7XG4gICAgICAgIGlkOiAnWzQwNF0nLFxuICAgICAgICBjb250ZW50OiBgXG48aDE+Qmx1ZSByb3V0ZXIgdGVzdDwvaDE+XG5cbjxkaXY+XG48YSBocmVmPVwiIVwiIGlkPVwiZTQwNF9ob21lTGlua1wiPkhvbWU8L2E+XG48L2Rpdj5cblxuPGRpdiBjbGFzcz1cInBhZ2UtY29udGVudFwiPlxuPGgzPjQwNCBwYWdlPC9oMz5cbjxwPlxuICAgIFNvcnJ5XG48L3A+XG48cCBpZD1cImU0MDRfcFwiPlxuICAgIFJlcXVlc3RlZCBjb250ZW50IG5vdCBmb3VuZC5cbjwvcD5cbjwvZGl2PlxuYFxuICAgIH1cbl07XG5cbm1vZHVsZS5leHBvcnRzID0gcm91dGVzO1xuXG5cbiIsImNvbnN0IHV0aWxzID0ge307XG5cbnV0aWxzLndhaXRTaG9ydCA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiB1dGlscy53YWl0KCAxMDAwICk7XG59O1xuXG51dGlscy53YWl0ID0gZnVuY3Rpb24oIHRpbWVvdXQgKSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKCByZXNvbHZlID0+IHtcbiAgICAgICAgc2V0VGltZW91dCggcmVzb2x2ZSwgdGltZW91dCApO1xuICAgIH0pO1xufTtcblxubW9kdWxlLmV4cG9ydHMgPSB1dGlscztcblxuIl19
